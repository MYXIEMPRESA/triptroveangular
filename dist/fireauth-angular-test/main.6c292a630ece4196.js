(self.webpackChunkfireauth_angular_test=self.webpackChunkfireauth_angular_test||[]).push([[179],{6304:(Hn,we,ft)=>{"use strict";ft.d(we,{Dh:()=>ue,GT:()=>ye,cc:()=>re,hO:()=>Le,on:()=>Pt,pX:()=>lt,xv:()=>be});var M=ft(8926),mt=ft(120),It=ft(9015);Hn=ft.hmd(Hn);const vt=["ngOnDestroy"],lt=(Te,Fn,Ce,me={})=>new Proxy(Te,{get:(tt,Xt)=>Ce.runOutsideAngular(()=>{var Ve;if(Te[Xt])return!(null===(Ve=me?.spy)||void 0===Ve)&&Ve.get&&me.spy.get(Xt,Te[Xt]),Te[Xt];if(vt.indexOf(Xt)>-1)return()=>{};const Gt=Fn.toPromise().then(Ct=>{const ge=Ct&&Ct[Xt];return"function"==typeof ge?ge.bind(Ct):ge&&ge.then?ge.then(en=>Ce.run(()=>en)):Ce.run(()=>ge)});return new Proxy(()=>{},{get:(Ct,ge)=>Gt[ge],apply:(Ct,ge,en)=>Gt.then(Ui=>{var cs;const Go=Ui&&Ui(...en);return!(null===(cs=me?.spy)||void 0===cs)&&cs.apply&&me.spy.apply(Xt,en,Go),Go})})})}),ye=(Te,Fn)=>{Fn.forEach(Ce=>{Object.getOwnPropertyNames(Ce.prototype||Ce).forEach(me=>{Object.defineProperty(Te.prototype,me,Object.getOwnPropertyDescriptor(Ce.prototype||Ce,me))})})};class ke{constructor(Fn){return Fn}}const ue=new M.OlP("angularfire2.app.options"),be=new M.OlP("angularfire2.app.name");function Pt(Te,Fn,Ce){const tt="object"==typeof Ce&&Ce||{};tt.name=tt.name||"string"==typeof Ce&&Ce||"[DEFAULT]";const Ve=mt.Z.apps.filter(Gt=>Gt&&Gt.name===tt.name)[0]||Fn.runOutsideAngular(()=>mt.Z.initializeApp(Te,tt));try{JSON.stringify(Te)!==JSON.stringify(Ve.options)&&Et("error",`${Ve.name} Firebase App already initialized with different options${Hn.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new ke(Ve)}const Et=(Te,...Fn)=>{(0,M.X6Q)()&&typeof console<"u"&&console[Te](...Fn)},Yt={provide:ke,useFactory:Pt,deps:[ue,M.R0b,[new M.FiY,be]]};let Le=(()=>{class Te{constructor(Ce){mt.Z.registerVersion("angularfire",It.q4.full,"core"),mt.Z.registerVersion("angularfire",It.q4.full,"app-compat"),mt.Z.registerVersion("angular",M.q4F.full,Ce.toString())}static initializeApp(Ce,me){return{ngModule:Te,providers:[{provide:ue,useValue:Ce},{provide:be,useValue:me}]}}}return Te.\u0275fac=function(Ce){return new(Ce||Te)(M.LFG(M.Lbi))},Te.\u0275mod=M.oAB({type:Te}),Te.\u0275inj=M.cJS({providers:[Yt]}),Te})();function re(Te,Fn,Ce,me,tt){const[,Xt,Ve]=globalThis.\u0275AngularfireInstanceCache.find(Gt=>Gt[0]===Te)||[];if(Xt)return function tn(Te,Fn){try{return Te.toString()===Fn.toString()}catch{return Te===Fn}}(tt,Ve)||(rn("error",`${Fn} was already initialized on the ${Ce} Firebase App with different settings.${We?" You may need to reload as Firebase is not HMR aware.":""}`),rn("warn",{is:tt,was:Ve})),Xt;{const Gt=me();return globalThis.\u0275AngularfireInstanceCache.push([Te,Gt,tt]),Gt}}const We=!!Hn.hot,rn=(Te,...Fn)=>{(0,M.X6Q)()&&typeof console<"u"&&console[Te](...Fn)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},9015:(Hn,we,ft)=>{"use strict";ft.d(we,{q4:()=>Ld,iC:()=>De,HU:()=>Uh,vb:()=>Su,JM:()=>hp,u3:()=>nc});var M=ft(8926),mt=ft(4097),It=ft(5861),vt=ft(1571),lt=ft(229),ye=ft(6820),ke=ft(7879);const ue=(U,V)=>V.some(W=>U instanceof W);let be,Pt;const Le=new WeakMap,re=new WeakMap,tn=new WeakMap,We=new WeakMap,rn=new WeakMap;let Ce={get(U,V,W){if(U instanceof IDBTransaction){if("done"===V)return re.get(U);if("objectStoreNames"===V)return U.objectStoreNames||tn.get(U);if("store"===V)return W.objectStoreNames[1]?void 0:W.objectStore(W.objectStoreNames[0])}return Ve(U[V])},set:(U,V,W)=>(U[V]=W,!0),has:(U,V)=>U instanceof IDBTransaction&&("done"===V||"store"===V)||V in U};function Xt(U){return"function"==typeof U?function tt(U){return U!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Yt(){return Pt||(Pt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(U)?function(...V){return U.apply(Gt(this),V),Ve(Le.get(this))}:function(...V){return Ve(U.apply(Gt(this),V))}:function(V,...W){const ut=U.call(Gt(this),V,...W);return tn.set(ut,V.sort?V.sort():[V]),Ve(ut)}}(U):(U instanceof IDBTransaction&&function Fn(U){if(re.has(U))return;const V=new Promise((W,ut)=>{const Mt=()=>{U.removeEventListener("complete",Lt),U.removeEventListener("error",se),U.removeEventListener("abort",se)},Lt=()=>{W(),Mt()},se=()=>{ut(U.error||new DOMException("AbortError","AbortError")),Mt()};U.addEventListener("complete",Lt),U.addEventListener("error",se),U.addEventListener("abort",se)});re.set(U,V)}(U),ue(U,function Et(){return be||(be=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(U,Ce):U)}function Ve(U){if(U instanceof IDBRequest)return function Te(U){const V=new Promise((W,ut)=>{const Mt=()=>{U.removeEventListener("success",Lt),U.removeEventListener("error",se)},Lt=()=>{W(Ve(U.result)),Mt()},se=()=>{ut(U.error),Mt()};U.addEventListener("success",Lt),U.addEventListener("error",se)});return V.then(W=>{W instanceof IDBCursor&&Le.set(W,U)}).catch(()=>{}),rn.set(V,U),V}(U);if(We.has(U))return We.get(U);const V=Xt(U);return V!==U&&(We.set(U,V),rn.set(V,U)),V}const Gt=U=>rn.get(U),en=["get","getKey","getAll","getAllKeys","count"],Ui=["put","add","delete","clear"],cs=new Map;function Go(U,V){if(!(U instanceof IDBDatabase)||V in U||"string"!=typeof V)return;if(cs.get(V))return cs.get(V);const W=V.replace(/FromIndex$/,""),ut=V!==W,Mt=Ui.includes(W);if(!(W in(ut?IDBIndex:IDBObjectStore).prototype)||!Mt&&!en.includes(W))return;const Lt=function(){var se=(0,It.Z)(function*(on,...nn){const xn=this.transaction(on,Mt?"readwrite":"readonly");let mr=xn.store;return ut&&(mr=mr.index(nn.shift())),(yield Promise.all([mr[W](...nn),Mt&&xn.done]))[0]});return function(nn){return se.apply(this,arguments)}}();return cs.set(V,Lt),Lt}!function me(U){Ce=U(Ce)}(U=>({...U,get:(V,W,ut)=>Go(V,W)||U.get(V,W,ut),has:(V,W)=>!!Go(V,W)||U.has(V,W)}));const us="@firebase/installations",Yr="0.6.4",Ne=1e4,vs=`w:${Yr}`,Wt="FIS_v2",Kt="https://firebaseinstallations.googleapis.com/v1",pe=36e5,In=new lt.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function qr(U){return U instanceof lt.ZR&&U.code.includes("request-failed")}function wi({projectId:U}){return`${Kt}/projects/${U}/installations`}function tr(U){return{token:U.token,requestStatus:2,expiresIn:gt(U.expiresIn),creationTime:Date.now()}}function Tn(U,V){return pn.apply(this,arguments)}function pn(){return(pn=(0,It.Z)(function*(U,V){const ut=(yield V.json()).error;return In.create("request-failed",{requestName:U,serverCode:ut.code,serverMessage:ut.message,serverStatus:ut.status})})).apply(this,arguments)}function hi({apiKey:U}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":U})}function et(U){return nt.apply(this,arguments)}function nt(){return(nt=(0,It.Z)(function*(U){const V=yield U();return V.status>=500&&V.status<600?U():V})).apply(this,arguments)}function gt(U){return Number(U.replace("s","000"))}function Pe(){return(Pe=(0,It.Z)(function*({appConfig:U,heartbeatServiceProvider:V},{fid:W}){const ut=wi(U),Mt=hi(U),Lt=V.getImmediate({optional:!0});if(Lt){const xn=yield Lt.getHeartbeatsHeader();xn&&Mt.append("x-firebase-client",xn)}const on={method:"POST",headers:Mt,body:JSON.stringify({fid:W,authVersion:Wt,appId:U.appId,sdkVersion:vs})},nn=yield et(()=>fetch(ut,on));if(nn.ok){const xn=yield nn.json();return{fid:xn.fid||W,registrationStatus:2,refreshToken:xn.refreshToken,authToken:tr(xn.authToken)}}throw yield Tn("Create Installation",nn)})).apply(this,arguments)}function Ge(U){return new Promise(V=>{setTimeout(V,U)})}const Xe=/^[cdef][\w-]{21}$/,Ze="";function Ie(){try{const U=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(U),U[0]=112+U[0]%16;const W=function gn(U){return function ae(U){return btoa(String.fromCharCode(...U)).replace(/\+/g,"-").replace(/\//g,"_")}(U).substr(0,22)}(U);return Xe.test(W)?W:Ze}catch{return Ze}}function ur(U){return`${U.appName}!${U.appId}`}const yn=new Map;function Fr(U,V){const W=ur(U);Vi(W,V),function Ur(U,V){const W=function dr(){return!Ar&&"BroadcastChannel"in self&&(Ar=new BroadcastChannel("[Firebase] FID Change"),Ar.onmessage=U=>{Vi(U.data.key,U.data.fid)}),Ar}();W&&W.postMessage({key:U,fid:V}),function Fl(){0===yn.size&&Ar&&(Ar.close(),Ar=null)}()}(W,V)}function Vi(U,V){const W=yn.get(U);if(W)for(const ut of W)ut(V)}let Ar=null;const er="firebase-installations-database",Rs=1,no="firebase-installations-store";let ds=null;function Ft(){return ds||(ds=function Ct(U,V,{blocked:W,upgrade:ut,blocking:Mt,terminated:Lt}={}){const se=indexedDB.open(U,V),on=Ve(se);return ut&&se.addEventListener("upgradeneeded",nn=>{ut(Ve(se.result),nn.oldVersion,nn.newVersion,Ve(se.transaction))}),W&&se.addEventListener("blocked",()=>W()),on.then(nn=>{Lt&&nn.addEventListener("close",()=>Lt()),Mt&&nn.addEventListener("versionchange",()=>Mt())}).catch(()=>{}),on}(er,Rs,{upgrade:(U,V)=>{0===V&&U.createObjectStore(no)}})),ds}function Ht(U,V){return te.apply(this,arguments)}function te(){return(te=(0,It.Z)(function*(U,V){const W=ur(U),Mt=(yield Ft()).transaction(no,"readwrite"),Lt=Mt.objectStore(no),se=yield Lt.get(W);return yield Lt.put(V,W),yield Mt.done,(!se||se.fid!==V.fid)&&Fr(U,V.fid),V})).apply(this,arguments)}function le(U){return _e.apply(this,arguments)}function _e(){return(_e=(0,It.Z)(function*(U){const V=ur(U),ut=(yield Ft()).transaction(no,"readwrite");yield ut.objectStore(no).delete(V),yield ut.done})).apply(this,arguments)}function ve(U,V){return xe.apply(this,arguments)}function xe(){return(xe=(0,It.Z)(function*(U,V){const W=ur(U),Mt=(yield Ft()).transaction(no,"readwrite"),Lt=Mt.objectStore(no),se=yield Lt.get(W),on=V(se);return void 0===on?yield Lt.delete(W):yield Lt.put(on,W),yield Mt.done,on&&(!se||se.fid!==on.fid)&&Fr(U,on.fid),on})).apply(this,arguments)}function it(U){return at.apply(this,arguments)}function at(){return at=(0,It.Z)(function*(U){let V;const W=yield ve(U.appConfig,ut=>{const Mt=function ht(U){return Or(U||{fid:Ie(),registrationStatus:0})}(ut),Lt=function Bt(U,V){if(0===V.registrationStatus){if(!navigator.onLine)return{installationEntry:V,registrationPromise:Promise.reject(In.create("app-offline"))};const W={fid:V.fid,registrationStatus:1,registrationTime:Date.now()},ut=function kt(U,V){return ee.apply(this,arguments)}(U,W);return{installationEntry:W,registrationPromise:ut}}return 1===V.registrationStatus?{installationEntry:V,registrationPromise:Ke(U)}:{installationEntry:V}}(U,Mt);return V=Lt.registrationPromise,Lt.installationEntry});return W.fid===Ze?{installationEntry:yield V}:{installationEntry:W,registrationPromise:V}}),at.apply(this,arguments)}function ee(){return ee=(0,It.Z)(function*(U,V){try{const W=yield function oe(U,V){return Pe.apply(this,arguments)}(U,V);return Ht(U.appConfig,W)}catch(W){throw qr(W)&&409===W.customData.serverCode?yield le(U.appConfig):yield Ht(U.appConfig,{fid:V.fid,registrationStatus:0}),W}}),ee.apply(this,arguments)}function Ke(U){return Nn.apply(this,arguments)}function Nn(){return(Nn=(0,It.Z)(function*(U){let V=yield yr(U.appConfig);for(;1===V.registrationStatus;)yield Ge(100),V=yield yr(U.appConfig);if(0===V.registrationStatus){const{installationEntry:W,registrationPromise:ut}=yield it(U);return ut||W}return V})).apply(this,arguments)}function yr(U){return ve(U,V=>{if(!V)throw In.create("installation-not-found");return Or(V)})}function Or(U){return function Qr(U){return 1===U.registrationStatus&&U.registrationTime+Ne<Date.now()}(U)?{fid:U.fid,registrationStatus:0}:U}function ir(){return(ir=(0,It.Z)(function*({appConfig:U,heartbeatServiceProvider:V},W){const ut=function ji(U,{fid:V}){return`${wi(U)}/${V}/authTokens:generate`}(U,W),Mt=function ce(U,{refreshToken:V}){const W=hi(U);return W.append("Authorization",function Qt(U){return`${Wt} ${U}`}(V)),W}(U,W),Lt=V.getImmediate({optional:!0});if(Lt){const xn=yield Lt.getHeartbeatsHeader();xn&&Mt.append("x-firebase-client",xn)}const on={method:"POST",headers:Mt,body:JSON.stringify({installation:{sdkVersion:vs,appId:U.appId}})},nn=yield et(()=>fetch(ut,on));if(nn.ok)return tr(yield nn.json());throw yield Tn("Generate Auth Token",nn)})).apply(this,arguments)}function or(U){return qs.apply(this,arguments)}function qs(){return qs=(0,It.Z)(function*(U,V=!1){let W;const ut=yield ve(U.appConfig,Lt=>{if(!sr(Lt))throw In.create("not-registered");const se=Lt.authToken;if(!V&&function ai(U){return 2===U.requestStatus&&!function Hi(U){const V=Date.now();return V<U.creationTime||U.creationTime+U.expiresIn<V+pe}(U)}(se))return Lt;if(1===se.requestStatus)return W=function ne(U,V){return Vt.apply(this,arguments)}(U,V),Lt;{if(!navigator.onLine)throw In.create("app-offline");const on=function Ti(U){const V={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},U),{authToken:V})}(Lt);return W=function zn(U,V){return vr.apply(this,arguments)}(U,on),on}});return W?yield W:ut.authToken}),qs.apply(this,arguments)}function Vt(){return(Vt=(0,It.Z)(function*(U,V){let W=yield Re(U.appConfig);for(;1===W.authToken.requestStatus;)yield Ge(100),W=yield Re(U.appConfig);const ut=W.authToken;return 0===ut.requestStatus?or(U,V):ut})).apply(this,arguments)}function Re(U){return ve(U,V=>{if(!sr(V))throw In.create("not-registered");return function zr(U){return 1===U.requestStatus&&U.requestTime+Ne<Date.now()}(V.authToken)?Object.assign(Object.assign({},V),{authToken:{requestStatus:0}}):V})}function vr(){return vr=(0,It.Z)(function*(U,V){try{const W=yield function Pr(U,V){return ir.apply(this,arguments)}(U,V),ut=Object.assign(Object.assign({},V),{authToken:W});return yield Ht(U.appConfig,ut),W}catch(W){if(!qr(W)||401!==W.customData.serverCode&&404!==W.customData.serverCode){const ut=Object.assign(Object.assign({},V),{authToken:{requestStatus:0}});yield Ht(U.appConfig,ut)}else yield le(U.appConfig);throw W}}),vr.apply(this,arguments)}function sr(U){return void 0!==U&&2===U.registrationStatus}function gl(){return(gl=(0,It.Z)(function*(U){const V=U,{installationEntry:W,registrationPromise:ut}=yield it(V);return ut?ut.catch(console.error):or(V).catch(console.error),W.fid})).apply(this,arguments)}function cd(){return cd=(0,It.Z)(function*(U,V=!1){const W=U;return yield function bs(U){return Ba.apply(this,arguments)}(W),(yield or(W,V)).token}),cd.apply(this,arguments)}function Ba(){return(Ba=(0,It.Z)(function*(U){const{registrationPromise:V}=yield it(U);V&&(yield V)})).apply(this,arguments)}function hd(U){return In.create("missing-app-config-values",{valueName:U})}const Mn="installations",ia=U=>{const V=U.getProvider("app").getImmediate(),W=function Va(U){if(!U||!U.options)throw hd("App Configuration");if(!U.name)throw hd("App Name");const V=["projectId","apiKey","appId"];for(const W of V)if(!U.options[W])throw hd(W);return{appName:U.name,projectId:U.options.projectId,apiKey:U.options.apiKey,appId:U.options.appId}}(V);return{app:V,appConfig:W,heartbeatServiceProvider:(0,vt._getProvider)(V,"heartbeat"),_delete:()=>Promise.resolve()}},Ho=U=>{const V=U.getProvider("app").getImmediate(),W=(0,vt._getProvider)(V,Mn).getImmediate();return{getId:()=>function pl(U){return gl.apply(this,arguments)}(W),getToken:Mt=>function mh(U){return cd.apply(this,arguments)}(W,Mt)}};(function su(){(0,vt._registerComponent)(new ye.wA(Mn,ia,"PUBLIC")),(0,vt._registerComponent)(new ye.wA("installations-internal",Ho,"PRIVATE"))})(),(0,vt.registerVersion)(us,Yr),(0,vt.registerVersion)(us,Yr,"esm2017");const au="@firebase/remote-config",vo=new lt.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Ae{constructor(V,W,ut,Mt){this.client=V,this.storage=W,this.storageCache=ut,this.logger=Mt}isCachedDataFresh(V,W){if(!W)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const ut=Date.now()-W,Mt=ut<=V;return this.logger.debug(`Config fetch cache check. Cache age millis: ${ut}. Cache max age millis (minimumFetchIntervalMillis setting): ${V}. Is cache hit: ${Mt}.`),Mt}fetch(V){var W=this;return(0,It.Z)(function*(){const[ut,Mt]=yield Promise.all([W.storage.getLastSuccessfulFetchTimestampMillis(),W.storage.getLastSuccessfulFetchResponse()]);if(Mt&&W.isCachedDataFresh(V.cacheMaxAgeMillis,ut))return Mt;V.eTag=Mt&&Mt.eTag;const Lt=yield W.client.fetch(V),se=[W.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===Lt.status&&se.push(W.storage.setLastSuccessfulFetchResponse(Lt)),yield Promise.all(se),Lt})()}}function br(U=navigator){return U.languages&&U.languages[0]||U.language}class Tr{constructor(V,W,ut,Mt,Lt,se){this.firebaseInstallations=V,this.sdkVersion=W,this.namespace=ut,this.projectId=Mt,this.apiKey=Lt,this.appId=se}fetch(V){var W=this;return(0,It.Z)(function*(){const[ut,Mt]=yield Promise.all([W.firebaseInstallations.getId(),W.firebaseInstallations.getToken()]),se=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${W.projectId}/namespaces/${W.namespace}:fetch?key=${W.apiKey}`,on={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":V.eTag||"*"},nn={sdk_version:W.sdkVersion,app_instance_id:ut,app_instance_id_token:Mt,app_id:W.appId,language_code:br()},xn={method:"POST",headers:on,body:JSON.stringify(nn)},mr=fetch(se,xn),hr=new Promise((Zo,Ta)=>{V.signal.addEventListener(()=>{const Au=new Error("The operation was aborted.");Au.name="AbortError",Ta(Au)})});let mi;try{yield Promise.race([mr,hr]),mi=yield mr}catch(Zo){let Ta="fetch-client-network";throw"AbortError"===Zo?.name&&(Ta="fetch-timeout"),vo.create(Ta,{originalErrorMessage:Zo?.message})}let Co=mi.status;const oo=mi.headers.get("ETag")||void 0;let Oa,_o;if(200===mi.status){let Zo;try{Zo=yield mi.json()}catch(Ta){throw vo.create("fetch-client-parse",{originalErrorMessage:Ta?.message})}Oa=Zo.entries,_o=Zo.state}if("INSTANCE_STATE_UNSPECIFIED"===_o?Co=500:"NO_CHANGE"===_o?Co=304:("NO_TEMPLATE"===_o||"EMPTY_CONFIG"===_o)&&(Oa={}),304!==Co&&200!==Co)throw vo.create("fetch-status",{httpStatus:Co});return{status:Co,eTag:oo,config:Oa}})()}}class Ye{constructor(V,W){this.client=V,this.storage=W}fetch(V){var W=this;return(0,It.Z)(function*(){const ut=(yield W.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return W.attemptFetch(V,ut)})()}attemptFetch(V,{throttleEndTimeMillis:W,backoffCount:ut}){var Mt=this;return(0,It.Z)(function*(){yield function Jr(U,V){return new Promise((W,ut)=>{const Mt=Math.max(V-Date.now(),0),Lt=setTimeout(W,Mt);U.addEventListener(()=>{clearTimeout(Lt),ut(vo.create("fetch-throttle",{throttleEndTimeMillis:V}))})})}(V.signal,W);try{const Lt=yield Mt.client.fetch(V);return yield Mt.storage.deleteThrottleMetadata(),Lt}catch(Lt){if(!function dn(U){if(!(U instanceof lt.ZR&&U.customData))return!1;const V=Number(U.customData.httpStatus);return 429===V||500===V||503===V||504===V}(Lt))throw Lt;const se={throttleEndTimeMillis:Date.now()+(0,lt.$s)(ut),backoffCount:ut+1};return yield Mt.storage.setThrottleMetadata(se),Mt.attemptFetch(V,se)}})()}}class ja{constructor(V,W,ut,Mt,Lt){this.app=V,this._client=W,this._storageCache=ut,this._storage=Mt,this._logger=Lt,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Zr(U,V){const W=U.target.error||void 0;return vo.create(V,{originalErrorMessage:W&&W?.message})}const ni="app_namespace_store";class ar{constructor(V,W,ut,Mt=function pd(){return new Promise((U,V)=>{try{const W=indexedDB.open("firebase_remote_config",1);W.onerror=ut=>{V(Zr(ut,"storage-open"))},W.onsuccess=ut=>{U(ut.target.result)},W.onupgradeneeded=ut=>{0===ut.oldVersion&&ut.target.result.createObjectStore(ni,{keyPath:"compositeKey"})}}catch(W){V(vo.create("storage-open",{originalErrorMessage:W?.message}))}})}()){this.appId=V,this.appName=W,this.namespace=ut,this.openDbPromise=Mt}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(V){return this.set("last_fetch_status",V)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(V){return this.set("last_successful_fetch_timestamp_millis",V)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(V){return this.set("last_successful_fetch_response",V)}getActiveConfig(){return this.get("active_config")}setActiveConfig(V){return this.set("active_config",V)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(V){return this.set("active_config_etag",V)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(V){return this.set("throttle_metadata",V)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(V){var W=this;return(0,It.Z)(function*(){const ut=yield W.openDbPromise;return new Promise((Mt,Lt)=>{const on=ut.transaction([ni],"readonly").objectStore(ni),nn=W.createCompositeKey(V);try{const xn=on.get(nn);xn.onerror=mr=>{Lt(Zr(mr,"storage-get"))},xn.onsuccess=mr=>{const hr=mr.target.result;Mt(hr?hr.value:void 0)}}catch(xn){Lt(vo.create("storage-get",{originalErrorMessage:xn?.message}))}})})()}set(V,W){var ut=this;return(0,It.Z)(function*(){const Mt=yield ut.openDbPromise;return new Promise((Lt,se)=>{const nn=Mt.transaction([ni],"readwrite").objectStore(ni),xn=ut.createCompositeKey(V);try{const mr=nn.put({compositeKey:xn,value:W});mr.onerror=hr=>{se(Zr(hr,"storage-set"))},mr.onsuccess=()=>{Lt()}}catch(mr){se(vo.create("storage-set",{originalErrorMessage:mr?.message}))}})})()}delete(V){var W=this;return(0,It.Z)(function*(){const ut=yield W.openDbPromise;return new Promise((Mt,Lt)=>{const on=ut.transaction([ni],"readwrite").objectStore(ni),nn=W.createCompositeKey(V);try{const xn=on.delete(nn);xn.onerror=mr=>{Lt(Zr(mr,"storage-delete"))},xn.onsuccess=()=>{Mt()}}catch(xn){Lt(vo.create("storage-delete",{originalErrorMessage:xn?.message}))}})})()}createCompositeKey(V){return[this.appId,this.appName,this.namespace,V].join()}}class Ws{constructor(V){this.storage=V}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var V=this;return(0,It.Z)(function*(){const W=V.storage.getLastFetchStatus(),ut=V.storage.getLastSuccessfulFetchTimestampMillis(),Mt=V.storage.getActiveConfig(),Lt=yield W;Lt&&(V.lastFetchStatus=Lt);const se=yield ut;se&&(V.lastSuccessfulFetchTimestampMillis=se);const on=yield Mt;on&&(V.activeConfig=on)})()}setLastFetchStatus(V){return this.lastFetchStatus=V,this.storage.setLastFetchStatus(V)}setLastSuccessfulFetchTimestampMillis(V){return this.lastSuccessfulFetchTimestampMillis=V,this.storage.setLastSuccessfulFetchTimestampMillis(V)}setActiveConfig(V){return this.activeConfig=V,this.storage.setActiveConfig(V)}}function cu(){return $a.apply(this,arguments)}function $a(){return($a=(0,It.Z)(function*(){if(!(0,lt.hl)())return!1;try{return yield(0,lt.eu)()}catch{return!1}})).apply(this,arguments)}!function Cc(){(0,vt._registerComponent)(new ye.wA("remote-config",function U(V,{instanceIdentifier:W}){const ut=V.getProvider("app").getImmediate(),Mt=V.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw vo.create("registration-window");if(!(0,lt.hl)())throw vo.create("indexed-db-unavailable");const{projectId:Lt,apiKey:se,appId:on}=ut.options;if(!Lt)throw vo.create("registration-project-id");if(!se)throw vo.create("registration-api-key");if(!on)throw vo.create("registration-app-id");const nn=new ar(on,ut.name,W=W||"firebase"),xn=new Ws(nn),mr=new ke.Yd(au);mr.logLevel=ke.in.ERROR;const hr=new Tr(Mt,vt.SDK_VERSION,W,Lt,se,on),mi=new Ye(hr,nn),Co=new Ae(mi,nn,xn,mr),oo=new ja(ut,Co,xn,nn,mr);return function Fe(U){const V=(0,lt.m9)(U);V._initializePromise||(V._initializePromise=V._storageCache.loadFromStorage().then(()=>{V._isInitializationComplete=!0}))}(oo),oo},"PUBLIC").setMultipleInstances(!0)),(0,vt.registerVersion)(au,"0.4.4"),(0,vt.registerVersion)(au,"0.4.4","esm2017")}();const fo=(U,V)=>V.some(W=>U instanceof W);let bn,Hf;const Ro=new WeakMap,sa=new WeakMap,Yn=new WeakMap,go=new WeakMap,zl=new WeakMap;let Wi={get(U,V,W){if(U instanceof IDBTransaction){if("done"===V)return sa.get(U);if("objectStoreNames"===V)return U.objectStoreNames||Yn.get(U);if("store"===V)return W.objectStoreNames[1]?void 0:W.objectStore(W.objectStoreNames[0])}return aa(U[V])},set:(U,V,W)=>(U[V]=W,!0),has:(U,V)=>U instanceof IDBTransaction&&("done"===V||"store"===V)||V in U};function Fi(U){return"function"==typeof U?function uu(U){return U!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function po(){return Hf||(Hf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(U)?function(...V){return U.apply(bo(this),V),aa(Ro.get(this))}:function(...V){return aa(U.apply(bo(this),V))}:function(V,...W){const ut=U.call(bo(this),V,...W);return Yn.set(ut,V.sort?V.sort():[V]),aa(ut)}}(U):(U instanceof IDBTransaction&&function Ms(U){if(sa.has(U))return;const V=new Promise((W,ut)=>{const Mt=()=>{U.removeEventListener("complete",Lt),U.removeEventListener("error",se),U.removeEventListener("abort",se)},Lt=()=>{W(),Mt()},se=()=>{ut(U.error||new DOMException("AbortError","AbortError")),Mt()};U.addEventListener("complete",Lt),U.addEventListener("error",se),U.addEventListener("abort",se)});sa.set(U,V)}(U),fo(U,function oa(){return bn||(bn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(U,Wi):U)}function aa(U){if(U instanceof IDBRequest)return function gd(U){const V=new Promise((W,ut)=>{const Mt=()=>{U.removeEventListener("success",Lt),U.removeEventListener("error",se)},Lt=()=>{W(aa(U.result)),Mt()},se=()=>{ut(U.error),Mt()};U.addEventListener("success",Lt),U.addEventListener("error",se)});return V.then(W=>{W instanceof IDBCursor&&Ro.set(W,U)}).catch(()=>{}),zl.set(V,U),V}(U);if(go.has(U))return go.get(U);const V=Fi(U);return V!==U&&(go.set(U,V),zl.set(V,U)),V}const bo=U=>zl.get(U);function Un(U,V,{blocked:W,upgrade:ut,blocking:Mt,terminated:Lt}={}){const se=indexedDB.open(U,V),on=aa(se);return ut&&se.addEventListener("upgradeneeded",nn=>{ut(aa(se.result),nn.oldVersion,nn.newVersion,aa(se.transaction))}),W&&se.addEventListener("blocked",()=>W()),on.then(nn=>{Lt&&nn.addEventListener("close",()=>Lt()),Mt&&nn.addEventListener("versionchange",()=>Mt())}).catch(()=>{}),on}function du(U,{blocked:V}={}){const W=indexedDB.deleteDatabase(U);return V&&W.addEventListener("blocked",()=>V()),aa(W).then(()=>{})}const _l=["get","getKey","getAll","getAllKeys","count"],Ga=["put","add","delete","clear"],la=new Map;function hu(U,V){if(!(U instanceof IDBDatabase)||V in U||"string"!=typeof V)return;if(la.get(V))return la.get(V);const W=V.replace(/FromIndex$/,""),ut=V!==W,Mt=Ga.includes(W);if(!(W in(ut?IDBIndex:IDBObjectStore).prototype)||!Mt&&!_l.includes(W))return;const Lt=function(){var se=(0,It.Z)(function*(on,...nn){const xn=this.transaction(on,Mt?"readwrite":"readonly");let mr=xn.store;return ut&&(mr=mr.index(nn.shift())),(yield Promise.all([mr[W](...nn),Mt&&xn.done]))[0]});return function(nn){return se.apply(this,arguments)}}();return la.set(V,Lt),Lt}!function Bl(U){Wi=U(Wi)}(U=>({...U,get:(V,W,ut)=>hu(V,W)||U.get(V,W,ut),has:(V,W)=>!!hu(V,W)||U.has(V,W)}));const yl="/firebase-messaging-sw.js",cg="/firebase-cloud-messaging-push-scope",vl="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",vh="https://fcmregistrations.googleapis.com/v1",Ki="google.c.a.c_id",qy="google.c.a.c_l",pw="google.c.a.ts";var qf=function(U){return U.PUSH_RECEIVED="push-received",U.NOTIFICATION_CLICKED="notification-clicked",U}(qf||{});function Ps(U){const V=new Uint8Array(U);return btoa(String.fromCharCode(...V)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function jm(U){const W=(U+"=".repeat((4-U.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),ut=atob(W),Mt=new Uint8Array(ut.length);for(let Lt=0;Lt<ut.length;++Lt)Mt[Lt]=ut.charCodeAt(Lt);return Mt}const fu="fcm_token_details_db",Ha=5,f0="fcm_token_object_Store";function dg(){return dg=(0,It.Z)(function*(U){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(Lt=>Lt.name).includes(fu))return null;let V=null;return(yield Un(fu,Ha,{upgrade:(ut=(0,It.Z)(function*(Mt,Lt,se,on){var nn;if(Lt<2||!Mt.objectStoreNames.contains(f0))return;const xn=on.objectStore(f0),mr=yield xn.index("fcmSenderId").get(U);if(yield xn.clear(),mr)if(2===Lt){const hr=mr;if(!hr.auth||!hr.p256dh||!hr.endpoint)return;V={token:hr.fcmToken,createTime:null!==(nn=hr.createTime)&&void 0!==nn?nn:Date.now(),subscriptionOptions:{auth:hr.auth,p256dh:hr.p256dh,endpoint:hr.endpoint,swScope:hr.swScope,vapidKey:"string"==typeof hr.vapidKey?hr.vapidKey:Ps(hr.vapidKey)}}}else if(3===Lt){const hr=mr;V={token:hr.fcmToken,createTime:hr.createTime,subscriptionOptions:{auth:Ps(hr.auth),p256dh:Ps(hr.p256dh),endpoint:hr.endpoint,swScope:hr.swScope,vapidKey:Ps(hr.vapidKey)}}}else if(4===Lt){const hr=mr;V={token:hr.fcmToken,createTime:hr.createTime,subscriptionOptions:{auth:Ps(hr.auth),p256dh:Ps(hr.p256dh),endpoint:hr.endpoint,swScope:hr.swScope,vapidKey:Ps(hr.vapidKey)}}}}),function(Lt,se,on,nn){return ut.apply(this,arguments)})})).close(),yield du(fu),yield du("fcm_vapid_details_db"),yield du("undefined"),function xh(U){if(!U||!U.subscriptionOptions)return!1;const{subscriptionOptions:V}=U;return"number"==typeof U.createTime&&U.createTime>0&&"string"==typeof U.token&&U.token.length>0&&"string"==typeof V.auth&&V.auth.length>0&&"string"==typeof V.p256dh&&V.p256dh.length>0&&"string"==typeof V.endpoint&&V.endpoint.length>0&&"string"==typeof V.swScope&&V.swScope.length>0&&"string"==typeof V.vapidKey&&V.vapidKey.length>0}(V)?V:null;var ut}),dg.apply(this,arguments)}const $m="firebase-messaging-database",md=1,xa="firebase-messaging-store";let Zf=null;function Ul(){return Zf||(Zf=Un($m,md,{upgrade:(U,V)=>{0===V&&U.createObjectStore(xa)}})),Zf}function ca(U){return pu.apply(this,arguments)}function pu(){return pu=(0,It.Z)(function*(U){const V=Ch(U),ut=yield(yield Ul()).transaction(xa).objectStore(xa).get(V);if(ut)return ut;{const Mt=yield function Zy(U){return dg.apply(this,arguments)}(U.appConfig.senderId);if(Mt)return yield wh(U,Mt),Mt}}),pu.apply(this,arguments)}function wh(U,V){return qo.apply(this,arguments)}function qo(){return(qo=(0,It.Z)(function*(U,V){const W=Ch(U),Mt=(yield Ul()).transaction(xa,"readwrite");return yield Mt.objectStore(xa).put(V,W),yield Mt.done,V})).apply(this,arguments)}function Qo(){return(Qo=(0,It.Z)(function*(U){const V=Ch(U),ut=(yield Ul()).transaction(xa,"readwrite");yield ut.objectStore(xa).delete(V),yield ut.done})).apply(this,arguments)}function Ch({appConfig:U}){return U.appId}const Lo=new lt.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function hg(U,V){return Mc.apply(this,arguments)}function Mc(){return(Mc=(0,It.Z)(function*(U,V){const W=yield $l(U),ut=Gl(V),Mt={method:"POST",headers:W,body:JSON.stringify(ut)};let Lt;try{Lt=yield(yield fetch(jl(U.appConfig),Mt)).json()}catch(se){throw Lo.create("token-subscribe-failed",{errorInfo:se?.toString()})}if(Lt.error)throw Lo.create("token-subscribe-failed",{errorInfo:Lt.error.message});if(!Lt.token)throw Lo.create("token-subscribe-no-token");return Lt.token})).apply(this,arguments)}function Vl(){return(Vl=(0,It.Z)(function*(U,V){const W=yield $l(U),ut=Gl(V.subscriptionOptions),Mt={method:"PATCH",headers:W,body:JSON.stringify(ut)};let Lt;try{Lt=yield(yield fetch(`${jl(U.appConfig)}/${V.token}`,Mt)).json()}catch(se){throw Lo.create("token-update-failed",{errorInfo:se?.toString()})}if(Lt.error)throw Lo.create("token-update-failed",{errorInfo:Lt.error.message});if(!Lt.token)throw Lo.create("token-update-no-token");return Lt.token})).apply(this,arguments)}function qa(U,V){return Pc.apply(this,arguments)}function Pc(){return(Pc=(0,It.Z)(function*(U,V){const ut={method:"DELETE",headers:yield $l(U)};try{const Lt=yield(yield fetch(`${jl(U.appConfig)}/${V}`,ut)).json();if(Lt.error)throw Lo.create("token-unsubscribe-failed",{errorInfo:Lt.error.message})}catch(Mt){throw Lo.create("token-unsubscribe-failed",{errorInfo:Mt?.toString()})}})).apply(this,arguments)}function jl({projectId:U}){return`${vh}/projects/${U}/registrations`}function $l(U){return Za.apply(this,arguments)}function Za(){return(Za=(0,It.Z)(function*({appConfig:U,installations:V}){const W=yield V.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":U.apiKey,"x-goog-firebase-installations-auth":`FIS ${W}`})})).apply(this,arguments)}function Gl({p256dh:U,auth:V,endpoint:W,vapidKey:ut}){const Mt={web:{endpoint:W,auth:V,p256dh:U}};return ut!==vl&&(Mt.web.applicationPubKey=ut),Mt}const Mh=6048e5;function Hm(){return Hm=(0,It.Z)(function*(U){const V=yield function yd(U,V){return Oh.apply(this,arguments)}(U.swRegistration,U.vapidKey),W={vapidKey:U.vapidKey,swScope:U.swRegistration.scope,endpoint:V.endpoint,auth:Ps(V.getKey("auth")),p256dh:Ps(V.getKey("p256dh"))},ut=yield ca(U.firebaseDependencies);if(ut){if(function fg(U,V){return V.vapidKey===U.vapidKey&&V.endpoint===U.endpoint&&V.auth===U.auth&&V.p256dh===U.p256dh}(ut.subscriptionOptions,W))return Date.now()>=ut.createTime+Mh?function Wm(U,V){return Km.apply(this,arguments)}(U,{token:ut.token,createTime:Date.now(),subscriptionOptions:W}):ut.token;try{yield qa(U.firebaseDependencies,ut.token)}catch(Mt){console.warn(Mt)}return Ph(U.firebaseDependencies,W)}return Ph(U.firebaseDependencies,W)}),Hm.apply(this,arguments)}function Zm(){return Zm=(0,It.Z)(function*(U){const V=yield ca(U.firebaseDependencies);V&&(yield qa(U.firebaseDependencies,V.token),yield function _d(U){return Qo.apply(this,arguments)}(U.firebaseDependencies));const W=yield U.swRegistration.pushManager.getSubscription();return!W||W.unsubscribe()}),Zm.apply(this,arguments)}function Km(){return Km=(0,It.Z)(function*(U,V){try{const W=yield function Gm(U,V){return Vl.apply(this,arguments)}(U.firebaseDependencies,V),ut=Object.assign(Object.assign({},V),{token:W,createTime:Date.now()});return yield wh(U.firebaseDependencies,ut),W}catch(W){throw yield function qm(U){return Zm.apply(this,arguments)}(U),W}}),Km.apply(this,arguments)}function Ph(U,V){return Eh.apply(this,arguments)}function Eh(){return(Eh=(0,It.Z)(function*(U,V){const ut={token:yield hg(U,V),createTime:Date.now(),subscriptionOptions:V};return yield wh(U,ut),ut.token})).apply(this,arguments)}function Oh(){return(Oh=(0,It.Z)(function*(U,V){return(yield U.pushManager.getSubscription())||U.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:jm(V)})})).apply(this,arguments)}function Kf(U){const V={from:U.from,collapseKey:U.collapse_key,messageId:U.fcmMessageId};return function vd(U,V){if(!V.notification)return;U.notification={};const W=V.notification.title;W&&(U.notification.title=W);const ut=V.notification.body;ut&&(U.notification.body=ut);const Mt=V.notification.image;Mt&&(U.notification.image=Mt);const Lt=V.notification.icon;Lt&&(U.notification.icon=Lt)}(V,U),function pg(U,V){V.data&&(U.data=V.data)}(V,U),function bd(U,V){var W,ut,Mt,Lt,se;if(!(V.fcmOptions||null!==(W=V.notification)&&void 0!==W&&W.click_action))return;U.fcmOptions={};const on=null!==(Mt=null===(ut=V.fcmOptions)||void 0===ut?void 0:ut.link)&&void 0!==Mt?Mt:null===(Lt=V.notification)||void 0===Lt?void 0:Lt.click_action;on&&(U.fcmOptions.link=on);const nn=null===(se=V.fcmOptions)||void 0===se?void 0:se.analytics_label;nn&&(U.fcmOptions.analyticsLabel=nn)}(V,U),V}function Yf(U,V){const W=[];for(let ut=0;ut<U.length;ut++)W.push(U.charAt(ut)),ut<V.length&&W.push(V.charAt(ut));return W.join("")}function Ec(U){return Lo.create("missing-app-config-values",{valueName:U})}Yf("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Yf("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class gg{constructor(V,W,ut){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const Mt=function Th(U){if(!U||!U.options)throw Ec("App Configuration Object");if(!U.name)throw Ec("App Name");const V=["projectId","apiKey","appId","messagingSenderId"],{options:W}=U;for(const ut of V)if(!W[ut])throw Ec(ut);return{appName:U.name,projectId:W.projectId,apiKey:W.apiKey,appId:W.appId,senderId:W.messagingSenderId}}(V);this.firebaseDependencies={app:V,appConfig:Mt,installations:W,analyticsProvider:ut}}_delete(){return Promise.resolve()}}function mu(){return(mu=(0,It.Z)(function*(U){try{U.swRegistration=yield navigator.serviceWorker.register(yl,{scope:cg}),U.swRegistration.update().catch(()=>{})}catch(V){throw Lo.create("failed-service-worker-registration",{browserErrorMessage:V?.message})}})).apply(this,arguments)}function wa(){return(wa=(0,It.Z)(function*(U,V){if(!V&&!U.swRegistration&&(yield function gu(U){return mu.apply(this,arguments)}(U)),V||!U.swRegistration){if(!(V instanceof ServiceWorkerRegistration))throw Lo.create("invalid-sw-registration");U.swRegistration=V}})).apply(this,arguments)}function Oc(){return(Oc=(0,It.Z)(function*(U,V){V?U.vapidKey=V:U.vapidKey||(U.vapidKey=vl)})).apply(this,arguments)}function Sh(){return Sh=(0,It.Z)(function*(U,V){if(!navigator)throw Lo.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Lo.create("permission-blocked");return yield function wd(U,V){return Oc.apply(this,arguments)}(U,V?.vapidKey),yield function Ih(U,V){return wa.apply(this,arguments)}(U,V?.serviceWorkerRegistration),function Wf(U){return Hm.apply(this,arguments)}(U)}),Sh.apply(this,arguments)}function vn(){return(vn=(0,It.Z)(function*(U,V,W){const ut=function mg(U){switch(U){case qf.NOTIFICATION_CLICKED:return"notification_open";case qf.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(V);(yield U.firebaseDependencies.analyticsProvider.get()).logEvent(ut,{message_id:W[Ki],message_name:W[qy],message_time:W[pw],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function Hl(){return Hl=(0,It.Z)(function*(U,V){const W=V.data;if(!W.isFirebaseMessaging)return;U.onMessageHandler&&W.messageType===qf.PUSH_RECEIVED&&("function"==typeof U.onMessageHandler?U.onMessageHandler(Kf(W)):U.onMessageHandler.next(Kf(W)));const ut=W.data;(function xd(U){return"object"==typeof U&&!!U&&Ki in U})(ut)&&"1"===ut["google.c.a.e"]&&(yield function Ym(U,V,W){return vn.apply(this,arguments)}(U,W.messageType,ut))}),Hl.apply(this,arguments)}const Ah="@firebase/messaging",Tc=U=>{const V=new gg(U.getProvider("app").getImmediate(),U.getProvider("installations-internal").getImmediate(),U.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",W=>function Md(U,V){return Hl.apply(this,arguments)}(V,W)),V},Xm=U=>{const V=U.getProvider("messaging").getImmediate();return{getToken:ut=>function Cd(U,V){return Sh.apply(this,arguments)}(V,ut)}};function Xf(){return _u.apply(this,arguments)}function _u(){return(_u=(0,It.Z)(function*(){try{yield(0,lt.eu)()}catch{return!1}return typeof window<"u"&&(0,lt.hl)()&&(0,lt.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function zi(){(0,vt._registerComponent)(new ye.wA("messaging",Tc,"PUBLIC")),(0,vt._registerComponent)(new ye.wA("messaging-internal",Xm,"PRIVATE")),(0,vt.registerVersion)(Ah,"0.12.4"),(0,vt.registerVersion)(Ah,"0.12.4","esm2017")}();const Es="analytics",Jf="firebase_id",tp="origin",Pd=6e4,Wa="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",bu="https://www.googletagmanager.com/gtag/js",No=new ke.Yd("@firebase/analytics"),xo=new lt.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function ep(U){if(!U.startsWith(bu)){const V=xo.create("invalid-gtag-resource",{gtagURL:U});return No.warn(V.message),""}return U}function xu(U){return Promise.all(U.map(V=>V.catch(W=>W)))}function Sc(){return(Sc=(0,It.Z)(function*(U,V,W,ut,Mt,Lt){const se=ut[Mt];try{if(se)yield V[se];else{const nn=(yield xu(W)).find(xn=>xn.measurementId===Mt);nn&&(yield V[nn.appId])}}catch(on){No.error(on)}U("config",Mt,Lt)})).apply(this,arguments)}function Ks(){return(Ks=(0,It.Z)(function*(U,V,W,ut,Mt){try{let Lt=[];if(Mt&&Mt.send_to){let se=Mt.send_to;Array.isArray(se)||(se=[se]);const on=yield xu(W);for(const nn of se){const xn=on.find(hr=>hr.measurementId===nn),mr=xn&&V[xn.appId];if(!mr){Lt=[];break}Lt.push(mr)}}0===Lt.length&&(Lt=Object.values(V)),yield Promise.all(Lt),U("event",ut,Mt||{})}catch(Lt){No.error(Lt)}})).apply(this,arguments)}const ri=30,fs=new class Od{constructor(V={},W=1e3){this.throttleMetadata=V,this.intervalMillis=W}getThrottleMetadata(V){return this.throttleMetadata[V]}setThrottleMetadata(V,W){this.throttleMetadata[V]=W}deleteThrottleMetadata(V){delete this.throttleMetadata[V]}};function t_(U){return new Headers({Accept:"application/json","x-goog-api-key":U})}function Ka(){return(Ka=(0,It.Z)(function*(U){var V;const{appId:W,apiKey:ut}=U,Mt={method:"GET",headers:t_(ut)},Lt=Wa.replace("{app-id}",W),se=yield fetch(Lt,Mt);if(200!==se.status&&304!==se.status){let on="";try{const nn=yield se.json();null!==(V=nn.error)&&void 0!==V&&V.message&&(on=nn.error.message)}catch{}throw xo.create("config-fetch-failed",{httpStatus:se.status,responseMessage:on})}return se.json()})).apply(this,arguments)}function ip(){return(ip=(0,It.Z)(function*(U,V=fs,W){const{appId:ut,apiKey:Mt,measurementId:Lt}=U.options;if(!ut)throw xo.create("no-app-id");if(!Mt){if(Lt)return{measurementId:Lt,appId:ut};throw xo.create("no-api-key")}const se=V.getThrottleMetadata(ut)||{backoffCount:0,throttleEndTimeMillis:Date.now()},on=new bl;return setTimeout((0,It.Z)(function*(){on.abort()}),void 0!==W?W:Pd),yg({appId:ut,apiKey:Mt,measurementId:Lt},se,on,V)})).apply(this,arguments)}function yg(U,V,W){return vg.apply(this,arguments)}function vg(){return vg=(0,It.Z)(function*(U,{throttleEndTimeMillis:V,backoffCount:W},ut,Mt=fs){var Lt;const{appId:se,measurementId:on}=U;try{yield function Rh(U,V){return new Promise((W,ut)=>{const Mt=Math.max(V-Date.now(),0),Lt=setTimeout(W,Mt);U.addEventListener(()=>{clearTimeout(Lt),ut(xo.create("fetch-throttle",{throttleEndTimeMillis:V}))})})}(ut,V)}catch(nn){if(on)return No.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${on} provided in the "measurementId" field in the local Firebase config. [${nn?.message}]`),{appId:se,measurementId:on};throw nn}try{const nn=yield function rp(U){return Ka.apply(this,arguments)}(U);return Mt.deleteThrottleMetadata(se),nn}catch(nn){const xn=nn;if(!function Ls(U){if(!(U instanceof lt.ZR&&U.customData))return!1;const V=Number(U.customData.httpStatus);return 429===V||500===V||503===V||504===V}(xn)){if(Mt.deleteThrottleMetadata(se),on)return No.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${on} provided in the "measurementId" field in the local Firebase config. [${xn?.message}]`),{appId:se,measurementId:on};throw nn}const mr=503===Number(null===(Lt=xn?.customData)||void 0===Lt?void 0:Lt.httpStatus)?(0,lt.$s)(W,Mt.intervalMillis,ri):(0,lt.$s)(W,Mt.intervalMillis),hr={throttleEndTimeMillis:Date.now()+mr,backoffCount:W+1};return Mt.setThrottleMetadata(se,hr),No.debug(`Calling attemptFetch again in ${mr} millis`),yg(U,hr,ut,Mt)}}),vg.apply(this,arguments)}class bl{constructor(){this.listeners=[]}addEventListener(V){this.listeners.push(V)}abort(){this.listeners.forEach(V=>V())}}let Td,kc;function Ca(){return(Ca=(0,It.Z)(function*(U,V,W,ut,Mt){if(Mt&&Mt.global)U("event",W,ut);else{const Lt=yield V;U("event",W,Object.assign(Object.assign({},ut),{send_to:Lt}))}})).apply(this,arguments)}function Mu(){return(Mu=(0,It.Z)(function*(){if(!(0,lt.hl)())return No.warn(xo.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,lt.eu)()}catch(U){return No.warn(xo.create("indexeddb-unavailable",{errorInfo:U?.toString()}).message),!1}return!0})).apply(this,arguments)}function ql(){return ql=(0,It.Z)(function*(U,V,W,ut,Mt,Lt,se){var on;const nn=function kh(U){return ip.apply(this,arguments)}(U);nn.then(Co=>{W[Co.measurementId]=Co.appId,U.options.measurementId&&Co.measurementId!==U.options.measurementId&&No.warn(`The measurement ID in the local Firebase config (${U.options.measurementId}) does not match the measurement ID fetched from the server (${Co.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(Co=>No.error(Co)),V.push(nn);const xn=function n_(){return Mu.apply(this,arguments)}().then(Co=>{if(Co)return ut.getId()}),[mr,hr]=yield Promise.all([nn,xn]);(function Me(U){const V=window.document.getElementsByTagName("script");for(const W of Object.values(V))if(W.src&&W.src.includes(bu)&&W.src.includes(U))return W;return null})(Lt)||function Wy(U,V){const W=function Dh(U,V){let W;return window.trustedTypes&&(W=window.trustedTypes.createPolicy(U,V)),W}("firebase-js-sdk-policy",{createScriptURL:ep}),ut=document.createElement("script"),Mt=`${bu}?l=${U}&id=${V}`;ut.src=W?W?.createScriptURL(Mt):Mt,ut.async=!0,document.head.appendChild(ut)}(Lt,mr.measurementId),kc&&(Mt("consent","default",kc),function Rc(U){kc=U}(void 0)),Mt("js",new Date);const mi=null!==(on=se?.config)&&void 0!==on?on:{};return mi[tp]="firebase",mi.update=!0,null!=hr&&(mi[Jf]=hr),Mt("config",mr.measurementId,mi),Td&&(Mt("set",Td),function xl(U){Td=U}(void 0)),mr.measurementId}),ql.apply(this,arguments)}class bg{constructor(V){this.app=V}_delete(){return delete ro[this.app.options.appId],Promise.resolve()}}let ro={},Eu=[];const Yi={};let xg,Os,Zl="dataLayer",Je=!1;function $r(U,V,W){!function Pa(){const U=[];if((0,lt.ru)()&&U.push("This is a browser extension environment."),(0,lt.zI)()||U.push("Cookies are not available."),U.length>0){const V=U.map((ut,Mt)=>`(${Mt+1}) ${ut}`).join(" "),W=xo.create("invalid-analytics-context",{errorInfo:V});No.warn(W.message)}}();const ut=U.options.appId;if(!ut)throw xo.create("no-app-id");if(!U.options.apiKey){if(!U.options.measurementId)throw xo.create("no-api-key");No.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${U.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=ro[ut])throw xo.create("already-exists",{id:ut});if(!Je){!function Ed(U){let V=[];Array.isArray(window[U])?V=window[U]:window[U]=V}(Zl);const{wrappedGtag:Lt,gtagCore:se}=function np(U,V,W,ut,Mt){let Lt=function(...se){window[ut].push(arguments)};return window[Mt]&&"function"==typeof window[Mt]&&(Lt=window[Mt]),window[Mt]=function Jm(U,V,W,ut){function Lt(){return Lt=(0,It.Z)(function*(se,...on){try{if("event"===se){const[nn,xn]=on;yield function Qm(U,V,W,ut,Mt){return Ks.apply(this,arguments)}(U,V,W,nn,xn)}else if("config"===se){const[nn,xn]=on;yield function wu(U,V,W,ut,Mt,Lt){return Sc.apply(this,arguments)}(U,V,W,ut,nn,xn)}else if("consent"===se){const[nn]=on;U("consent","update",nn)}else if("get"===se){const[nn,xn,mr]=on;U("get",nn,xn,mr)}else if("set"===se){const[nn]=on;U("set",nn)}else U(se,...on)}catch(nn){No.error(nn)}}),Lt.apply(this,arguments)}return function Mt(se){return Lt.apply(this,arguments)}}(Lt,U,V,W),{gtagCore:Lt,wrappedGtag:window[Mt]}}(ro,Eu,Yi,Zl,"gtag");Os=Lt,xg=se,Je=!0}return ro[ut]=function Pu(U,V,W,ut,Mt,Lt,se){return ql.apply(this,arguments)}(U,Eu,Yi,V,xg,Zl,W),new bg(U)}function Sd(){return Ts.apply(this,arguments)}function Ts(){return(Ts=(0,It.Z)(function*(){if((0,lt.ru)()||!(0,lt.zI)()||!(0,lt.hl)())return!1;try{return yield(0,lt.eu)()}catch{return!1}})).apply(this,arguments)}const i_="@firebase/analytics";!function Fh(){(0,vt._registerComponent)(new ye.wA(Es,(V,{options:W})=>$r(V.getProvider("app").getImmediate(),V.getProvider("installations-internal").getImmediate(),W),"PUBLIC")),(0,vt._registerComponent)(new ye.wA("analytics-internal",function U(V){try{const W=V.getProvider(Es).getImmediate();return{logEvent:(ut,Mt,Lt)=>function r_(U,V,W,ut){U=(0,lt.m9)(U),function Id(U,V,W,ut,Mt){return Ca.apply(this,arguments)}(Os,ro[U.app.options.appId],V,W,ut).catch(Mt=>No.error(Mt))}(W,ut,Mt,Lt)}}catch(W){throw xo.create("interop-component-reg-failed",{reason:W})}},"PRIVATE")),(0,vt.registerVersion)(i_,"0.10.0"),(0,vt.registerVersion)(i_,"0.10.0","esm2017")}();var ps=ft(7394);class ap extends ps.w0{constructor(V,W){super()}schedule(V,W=0){return this}}const ha={setInterval(U,V,...W){const{delegate:ut}=ha;return ut?.setInterval?ut.setInterval(U,V,...W):setInterval(U,V,...W)},clearInterval(U){const{delegate:V}=ha;return(V?.clearInterval||clearInterval)(U)},delegate:void 0};var Xl=ft(9039);class Dd extends ap{constructor(V,W){super(V,W),this.scheduler=V,this.work=W,this.pending=!1}schedule(V,W=0){var ut;if(this.closed)return this;this.state=V;const Mt=this.id,Lt=this.scheduler;return null!=Mt&&(this.id=this.recycleAsyncId(Lt,Mt,W)),this.pending=!0,this.delay=W,this.id=null!==(ut=this.id)&&void 0!==ut?ut:this.requestAsyncId(Lt,this.id,W),this}requestAsyncId(V,W,ut=0){return ha.setInterval(V.flush.bind(V,this),ut)}recycleAsyncId(V,W,ut=0){if(null!=ut&&this.delay===ut&&!1===this.pending)return W;null!=W&&ha.clearInterval(W)}execute(V,W){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ut=this._execute(V,W);if(ut)return ut;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(V,W){let Mt,ut=!1;try{this.work(V)}catch(Lt){ut=!0,Mt=Lt||new Error("Scheduled action threw falsy error")}if(ut)return this.unsubscribe(),Mt}unsubscribe(){if(!this.closed){const{id:V,scheduler:W}=this,{actions:ut}=W;this.work=this.state=this.scheduler=null,this.pending=!1,(0,Xl.P)(ut,this),null!=V&&(this.id=this.recycleAsyncId(W,V,null)),this.delay=null,super.unsubscribe()}}}var kd=ft(4552);class Qa{constructor(V,W=Qa.now){this.schedulerActionCtor=V,this.now=W}schedule(V,W=0,ut){return new this.schedulerActionCtor(this,V).schedule(ut,W)}}Qa.now=kd.l.now;class lp extends Qa{constructor(V,W=Qa.now){super(V,W),this.actions=[],this._active=!1}flush(V){const{actions:W}=this;if(this._active)return void W.push(V);let ut;this._active=!0;do{if(ut=V.execute(V.state,V.delay))break}while(V=W.shift());if(this._active=!1,ut){for(;V=W.shift();)V.unsubscribe();throw ut}}}const cp=new class wl extends lp{}(class Xa extends Dd{constructor(V,W){super(V,W),this.scheduler=V,this.work=W}schedule(V,W=0){return W>0?super.schedule(V,W):(this.delay=W,this.state=V,this.scheduler.flush(this),this)}execute(V,W){return W>0||this.closed?super.execute(V,W):this._execute(V,W)}requestAsyncId(V,W,ut=0){return null!=ut&&ut>0||null==ut&&this.delay>0?super.requestAsyncId(V,W,ut):(V.flush(this),0)}}),Ys=new lp(Dd);var Cl=ft(5592),Rd=ft(9397),up=ft(5137),Tu=ft(3093);const Ld=new M.GfV("7.6.1"),wo="__angularfire_symbol__analyticsIsSupportedValue",zh="__angularfire_symbol__analyticsIsSupported",Iu="__angularfire_symbol__remoteConfigIsSupportedValue",Ea="__angularfire_symbol__remoteConfigIsSupported",Nd="__angularfire_symbol__messagingIsSupportedValue",dp="__angularfire_symbol__messagingIsSupported";function hp(U,V,W){if(V){if(1===V.length)return V[0];const Lt=V.filter(se=>se.app===W);if(1===Lt.length)return Lt[0]}return W.container.getProvider(U).getImmediate({optional:!0})}globalThis[zh]||(globalThis[zh]=Sd().then(U=>globalThis[wo]=U).catch(()=>globalThis[wo]=!1)),globalThis[dp]||(globalThis[dp]=Xf().then(U=>globalThis[Nd]=U).catch(()=>globalThis[Nd]=!1)),globalThis[Ea]||(globalThis[Ea]=cu().then(U=>globalThis[Iu]=U).catch(()=>globalThis[Iu]=!1));const Su=(U,V)=>{const W=V?[V]:(0,mt.C6)(),ut=[];return W.forEach(Mt=>{Mt.container.getProvider(U).instances.forEach(se=>{ut.includes(se)||ut.push(se)})}),ut};function Nc(){}class es{constructor(V,W=cp){this.zone=V,this.delegate=W}now(){return this.delegate.now()}schedule(V,W,ut){const Mt=this.zone;return this.delegate.schedule(function(se){Mt.runGuarded(()=>{V.apply(this,[se])})},W,ut)}}class fa{constructor(V){this.zone=V,this.task=null}call(V,W){const ut=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Nc,{},Nc,Nc)),W.pipe((0,Rd.b)({next:ut,complete:ut,error:ut})).subscribe(V).add(ut)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Uh=(()=>{class U{constructor(W){this.ngZone=W,this.outsideAngular=W.runOutsideAngular(()=>new es(Zone.current)),this.insideAngular=W.run(()=>new es(Zone.current,Ys)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return U.\u0275fac=function(W){return new(W||U)(M.LFG(M.R0b))},U.\u0275prov=M.Yz7({token:U,factory:U.\u0275fac,providedIn:"root"}),U})();function Ql(){const U=globalThis.\u0275AngularFireScheduler;if(!U)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return U}function Fo(U){return Ql().ngZone.run(()=>U())}function De(U){return Ql(),function ec(U){return function(W){return(W=W.lift(new fa(U.ngZone))).pipe((0,up.R)(U.outsideAngular),(0,Tu.Q)(U.insideAngular))}}(Ql())(U)}const zd=(U,V)=>function(){const ut=arguments;return V&&setTimeout(()=>{"scheduled"===V.state&&V.invoke()},10),Fo(()=>U.apply(void 0,ut))},nc=(U,V)=>function(){let W;const ut=arguments;for(let Lt=0;Lt<arguments.length;Lt++)"function"==typeof ut[Lt]&&(V&&(W||(W=Fo(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Nc,{},Nc,Nc)))),ut[Lt]=zd(ut[Lt],W));const Mt=function Ml(U){return Ql().ngZone.runOutsideAngular(()=>U())}(()=>U.apply(this,ut));if(!V){if(Mt instanceof Cl.y){const Lt=Ql();return Mt.pipe((0,up.R)(Lt.outsideAngular),(0,Tu.Q)(Lt.insideAngular))}return Fo(()=>Mt)}return Mt instanceof Cl.y?Mt.pipe(De):Mt instanceof Promise?Fo(()=>new Promise((Lt,se)=>Mt.then(on=>Fo(()=>Lt(on)),on=>Fo(()=>se(on))))):"function"==typeof Mt&&W?function(){return setTimeout(()=>{W&&"scheduled"===W.state&&W.invoke()},10),Mt.apply(this,arguments)}:Fo(()=>Mt)}},6710:(Hn,we,ft)=>{"use strict";ft.d(we,{$:()=>yl,A:()=>Et,D:()=>re,I:()=>dd,J:()=>ia,L:()=>ws,N:()=>ve,P:()=>Pu,Q:()=>ar,R:()=>Ky,U:()=>Zi,V:()=>cu,W:()=>$a,X:()=>ba,Y:()=>oa,Z:()=>po,_:()=>zl,a:()=>yu,a0:()=>vl,a1:()=>Ki,a2:()=>ug,a3:()=>f0,a4:()=>dg,a5:()=>$m,a6:()=>xa,a7:()=>Ul,a8:()=>pu,a9:()=>qo,aA:()=>Ct,aB:()=>Mg,aC:()=>le,aD:()=>xe,aE:()=>lp,aF:()=>Ad,aG:()=>Lh,aH:()=>qi,aL:()=>Ic,aO:()=>bn,aa:()=>_d,ab:()=>Ch,ac:()=>Dt,ad:()=>Gm,ae:()=>qa,af:()=>jl,ai:()=>Mh,aj:()=>Hm,ak:()=>qm,an:()=>uu,ao:()=>vd,aq:()=>Oc,ar:()=>Ah,as:()=>en,at:()=>Or,au:()=>Ke,av:()=>me,aw:()=>Mt,ax:()=>Tu,ay:()=>Qr,az:()=>tt,b:()=>Jo,c:()=>Os,d:()=>$r,e:()=>ts,f:()=>i_,g:()=>Xl,h:()=>ps,i:()=>_g,j:()=>kd,k:()=>xn,l:()=>da,m:()=>mi,o:()=>s_,p:()=>ue,r:()=>Cu,s:()=>Ma,u:()=>n_});var M=ft(5861),mt=ft(229),It=ft(1571),vt=ft(7582),lt=ft(7879),ye=ft(6820);const ue={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Et={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const re=function Yt(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},tn=function Le(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},We=new mt.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Te=new lt.Yd("@firebase/auth");function Ce(z,...D){Te.logLevel<=lt.in.ERROR&&Te.error(`Auth (${It.SDK_VERSION}): ${z}`,...D)}function me(z,...D){throw Gt(z,...D)}function tt(z,...D){return Gt(z,...D)}function Xt(z,D,R){const j=Object.assign(Object.assign({},tn()),{[D]:R});return new mt.LL("auth","Firebase",j).create(D,{appName:z.name})}function Ve(z,D,R){if(!(D instanceof R))throw R.name!==D.constructor.name&&me(z,"argument-error"),Xt(z,"argument-error",`Type of ${D.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Gt(z,...D){if("string"!=typeof z){const R=D[0],j=[...D.slice(1)];return j[0]&&(j[0].appName=z.name),z._errorFactory.create(R,...j)}return We.create(z,...D)}function Ct(z,D,...R){if(!z)throw Gt(D,...R)}function ge(z){const D="INTERNAL ASSERTION FAILED: "+z;throw Ce(D),new Error(D)}function en(z,D){z||ge(D)}function Ui(){var z;return typeof self<"u"&&(null===(z=self.location)||void 0===z?void 0:z.href)||""}function cs(){return"http:"===Go()||"https:"===Go()}function Go(){var z;return typeof self<"u"&&(null===(z=self.location)||void 0===z?void 0:z.protocol)||null}class Ne{constructor(D,R){this.shortDelay=D,this.longDelay=R,en(R>D,"Short delay should be less than long delay!"),this.isMobile=(0,mt.uI)()||(0,mt.b$)()}get(){return function us(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(cs()||(0,mt.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function vs(z,D){en(z.emulator,"Emulator should always be set here");const{url:R}=z.emulator;return D?`${R}${D.startsWith("/")?D.slice(1):D}`:R}class Wt{static initialize(D,R,j){this.fetchImpl=D,R&&(this.headersImpl=R),j&&(this.responseImpl=j)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void ge("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void ge("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void ge("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Kt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},pe=new Ne(3e4,6e4);function _t(z,D){return z.tenantId&&!D.tenantId?Object.assign(Object.assign({},D),{tenantId:z.tenantId}):D}function he(z,D,R,j){return Ue.apply(this,arguments)}function Ue(){return(Ue=(0,M.Z)(function*(z,D,R,j,G={}){return In(z,G,(0,M.Z)(function*(){let Q={},St={};j&&("GET"===D?St=j:Q={body:JSON.stringify(j)});const jt=(0,mt.xO)(Object.assign({key:z.config.apiKey},St)).slice(1),He=yield z._getAdditionalHeaders();return He["Content-Type"]="application/json",z.languageCode&&(He["X-Firebase-Locale"]=z.languageCode),Wt.fetch()(Tn(z,z.config.apiHost,R,jt),Object.assign({method:D,headers:He,referrerPolicy:"no-referrer"},Q))}))})).apply(this,arguments)}function In(z,D,R){return qr.apply(this,arguments)}function qr(){return(qr=(0,M.Z)(function*(z,D,R){z._canInitEmulator=!1;const j=Object.assign(Object.assign({},Kt),D);try{const G=new pn(z),Q=yield Promise.race([R(),G.promise]);G.clearNetworkTimeout();const St=yield Q.json();if("needConfirmation"in St)throw hi(z,"account-exists-with-different-credential",St);if(Q.ok&&!("errorMessage"in St))return St;{const jt=Q.ok?St.errorMessage:St.error.message,[He,un]=jt.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===He)throw hi(z,"credential-already-in-use",St);if("EMAIL_EXISTS"===He)throw hi(z,"email-already-in-use",St);if("USER_DISABLED"===He)throw hi(z,"user-disabled",St);const sn=j[He]||He.toLowerCase().replace(/[_\s]+/g,"-");if(un)throw Xt(z,sn,un);me(z,sn)}}catch(G){if(G instanceof mt.ZR)throw G;me(z,"network-request-failed",{message:String(G)})}})).apply(this,arguments)}function wi(z,D,R,j){return tr.apply(this,arguments)}function tr(){return(tr=(0,M.Z)(function*(z,D,R,j,G={}){const Q=yield he(z,D,R,j,G);return"mfaPendingCredential"in Q&&me(z,"multi-factor-auth-required",{_serverResponse:Q}),Q})).apply(this,arguments)}function Tn(z,D,R,j){const G=`${D}${R}?${j}`;return z.config.emulator?vs(z.config,G):`${z.config.apiScheme}://${G}`}class pn{constructor(D){this.auth=D,this.timer=null,this.promise=new Promise((R,j)=>{this.timer=setTimeout(()=>j(tt(this.auth,"network-request-failed")),pe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function hi(z,D,R){const j={appName:z.name};R.email&&(j.email=R.email),R.phoneNumber&&(j.phoneNumber=R.phoneNumber);const G=tt(z,D,j);return G.customData._tokenResponse=R,G}function et(){return(et=(0,M.Z)(function*(z,D){return he(z,"POST","/v1/accounts:delete",D)})).apply(this,arguments)}function gt(){return(gt=(0,M.Z)(function*(z,D){return he(z,"POST","/v1/accounts:update",D)})).apply(this,arguments)}function oe(){return(oe=(0,M.Z)(function*(z,D){return he(z,"POST","/v1/accounts:lookup",D)})).apply(this,arguments)}function Pe(z){if(z)try{const D=new Date(Number(z));if(!isNaN(D.getTime()))return D.toUTCString()}catch{}}function Xe(){return(Xe=(0,M.Z)(function*(z,D=!1){const R=(0,mt.m9)(z),j=yield R.getIdToken(D),G=Ie(j);Ct(G&&G.exp&&G.auth_time&&G.iat,R.auth,"internal-error");const Q="object"==typeof G.firebase?G.firebase:void 0,St=Q?.sign_in_provider;return{claims:G,token:j,authTime:Pe(Ze(G.auth_time)),issuedAtTime:Pe(Ze(G.iat)),expirationTime:Pe(Ze(G.exp)),signInProvider:St||null,signInSecondFactor:Q?.sign_in_second_factor||null}})).apply(this,arguments)}function Ze(z){return 1e3*Number(z)}function Ie(z){const[D,R,j]=z.split(".");if(void 0===D||void 0===R||void 0===j)return Ce("JWT malformed, contained fewer than 3 sections"),null;try{const G=(0,mt.tV)(R);return G?JSON.parse(G):(Ce("Failed to decode base64 JWT payload"),null)}catch(G){return Ce("Caught error parsing JWT payload as JSON",G?.toString()),null}}function ur(z,D){return yn.apply(this,arguments)}function yn(){return(yn=(0,M.Z)(function*(z,D,R=!1){if(R)return D;try{return yield D}catch(j){throw j instanceof mt.ZR&&function Fr({code:z}){return"auth/user-disabled"===z||"auth/user-token-expired"===z}(j)&&z.auth.currentUser===z&&(yield z.auth.signOut()),j}})).apply(this,arguments)}class Xr{constructor(D){this.user=D,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(D){var R;if(D){const j=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),j}{this.errorBackoff=3e4;const G=(null!==(R=this.user.stsTokenManager.expirationTime)&&void 0!==R?R:0)-Date.now()-3e5;return Math.max(0,G)}}schedule(D=!1){var R=this;if(!this.isRunning)return;const j=this.getInterval(D);this.timerId=setTimeout((0,M.Z)(function*(){yield R.iteration()}),j)}iteration(){var D=this;return(0,M.Z)(function*(){try{yield D.user.getIdToken(!0)}catch(R){return void("auth/network-request-failed"===R?.code&&D.schedule(!0))}D.schedule()})()}}class Sn{constructor(D,R){this.createdAt=D,this.lastLoginAt=R,this._initializeTime()}_initializeTime(){this.lastSignInTime=Pe(this.lastLoginAt),this.creationTime=Pe(this.createdAt)}_copy(D){this.createdAt=D.createdAt,this.lastLoginAt=D.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Vi(z){return Ur.apply(this,arguments)}function Ur(){return Ur=(0,M.Z)(function*(z){var D;const R=z.auth,j=yield z.getIdToken(),G=yield ur(z,function Qt(z,D){return oe.apply(this,arguments)}(R,{idToken:j}));Ct(G?.users.length,R,"internal-error");const Q=G.users[0];z._notifyReloadListener(Q);const St=null!==(D=Q.providerUserInfo)&&void 0!==D&&D.length?function er(z){return z.map(D=>{var{providerId:R}=D,j=(0,vt._T)(D,["providerId"]);return{providerId:R,uid:j.rawId||"",displayName:j.displayName||null,email:j.email||null,phoneNumber:j.phoneNumber||null,photoURL:j.photoUrl||null}})}(Q.providerUserInfo):[],jt=function Fl(z,D){return[...z.filter(j=>!D.some(G=>G.providerId===j.providerId)),...D]}(z.providerData,St),sn=!!z.isAnonymous&&!(z.email&&Q.passwordHash||jt?.length),ti={uid:Q.localId,displayName:Q.displayName||null,photoURL:Q.photoUrl||null,email:Q.email||null,emailVerified:Q.emailVerified||!1,phoneNumber:Q.phoneNumber||null,tenantId:Q.tenantId||null,providerData:jt,metadata:new Sn(Q.createdAt,Q.lastLoginAt),isAnonymous:sn};Object.assign(z,ti)}),Ur.apply(this,arguments)}function dr(){return(dr=(0,M.Z)(function*(z){const D=(0,mt.m9)(z);yield Vi(D),yield D.auth._persistUserIfCurrent(D),D.auth._notifyListenersIfCurrent(D)})).apply(this,arguments)}function no(){return(no=(0,M.Z)(function*(z,D){const R=yield In(z,{},(0,M.Z)(function*(){const j=(0,mt.xO)({grant_type:"refresh_token",refresh_token:D}).slice(1),{tokenApiHost:G,apiKey:Q}=z.config,St=Tn(z,G,"/v1/token",`key=${Q}`),jt=yield z._getAdditionalHeaders();return jt["Content-Type"]="application/x-www-form-urlencoded",Wt.fetch()(St,{method:"POST",headers:jt,body:j})}));return{accessToken:R.access_token,expiresIn:R.expires_in,refreshToken:R.refresh_token}})).apply(this,arguments)}class ds{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(D){Ct(D.idToken,"internal-error"),Ct(typeof D.idToken<"u","internal-error"),Ct(typeof D.refreshToken<"u","internal-error");const R="expiresIn"in D&&typeof D.expiresIn<"u"?Number(D.expiresIn):function gn(z){const D=Ie(z);return Ct(D,"internal-error"),Ct(typeof D.exp<"u","internal-error"),Ct(typeof D.iat<"u","internal-error"),Number(D.exp)-Number(D.iat)}(D.idToken);this.updateTokensAndExpiration(D.idToken,D.refreshToken,R)}getToken(D,R=!1){var j=this;return(0,M.Z)(function*(){return Ct(!j.accessToken||j.refreshToken,D,"user-token-expired"),R||!j.accessToken||j.isExpired?j.refreshToken?(yield j.refresh(D,j.refreshToken),j.accessToken):null:j.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(D,R){var j=this;return(0,M.Z)(function*(){const{accessToken:G,refreshToken:Q,expiresIn:St}=yield function Rs(z,D){return no.apply(this,arguments)}(D,R);j.updateTokensAndExpiration(G,Q,Number(St))})()}updateTokensAndExpiration(D,R,j){this.refreshToken=R||null,this.accessToken=D||null,this.expirationTime=Date.now()+1e3*j}static fromJSON(D,R){const{refreshToken:j,accessToken:G,expirationTime:Q}=R,St=new ds;return j&&(Ct("string"==typeof j,"internal-error",{appName:D}),St.refreshToken=j),G&&(Ct("string"==typeof G,"internal-error",{appName:D}),St.accessToken=G),Q&&(Ct("number"==typeof Q,"internal-error",{appName:D}),St.expirationTime=Q),St}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(D){this.accessToken=D.accessToken,this.refreshToken=D.refreshToken,this.expirationTime=D.expirationTime}_clone(){return Object.assign(new ds,this.toJSON())}_performRefresh(){return ge("not implemented")}}function Ft(z,D){Ct("string"==typeof z||typeof z>"u","internal-error",{appName:D})}class Ht{constructor(D){var{uid:R,auth:j,stsTokenManager:G}=D,Q=(0,vt._T)(D,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Xr(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=R,this.auth=j,this.stsTokenManager=G,this.accessToken=G.accessToken,this.displayName=Q.displayName||null,this.email=Q.email||null,this.emailVerified=Q.emailVerified||!1,this.phoneNumber=Q.phoneNumber||null,this.photoURL=Q.photoURL||null,this.isAnonymous=Q.isAnonymous||!1,this.tenantId=Q.tenantId||null,this.providerData=Q.providerData?[...Q.providerData]:[],this.metadata=new Sn(Q.createdAt||void 0,Q.lastLoginAt||void 0)}getIdToken(D){var R=this;return(0,M.Z)(function*(){const j=yield ur(R,R.stsTokenManager.getToken(R.auth,D));return Ct(j,R.auth,"internal-error"),R.accessToken!==j&&(R.accessToken=j,yield R.auth._persistUserIfCurrent(R),R.auth._notifyListenersIfCurrent(R)),j})()}getIdTokenResult(D){return function ae(z){return Xe.apply(this,arguments)}(this,D)}reload(){return function Ar(z){return dr.apply(this,arguments)}(this)}_assign(D){this!==D&&(Ct(this.uid===D.uid,this.auth,"internal-error"),this.displayName=D.displayName,this.photoURL=D.photoURL,this.email=D.email,this.emailVerified=D.emailVerified,this.phoneNumber=D.phoneNumber,this.isAnonymous=D.isAnonymous,this.tenantId=D.tenantId,this.providerData=D.providerData.map(R=>Object.assign({},R)),this.metadata._copy(D.metadata),this.stsTokenManager._assign(D.stsTokenManager))}_clone(D){const R=new Ht(Object.assign(Object.assign({},this),{auth:D,stsTokenManager:this.stsTokenManager._clone()}));return R.metadata._copy(this.metadata),R}_onReload(D){Ct(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=D,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(D){this.reloadListener?this.reloadListener(D):this.reloadUserInfo=D}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(D,R=!1){var j=this;return(0,M.Z)(function*(){let G=!1;D.idToken&&D.idToken!==j.stsTokenManager.accessToken&&(j.stsTokenManager.updateFromServerResponse(D),G=!0),R&&(yield Vi(j)),yield j.auth._persistUserIfCurrent(j),G&&j.auth._notifyListenersIfCurrent(j)})()}delete(){var D=this;return(0,M.Z)(function*(){const R=yield D.getIdToken();return yield ur(D,function ce(z,D){return et.apply(this,arguments)}(D.auth,{idToken:R})),D.stsTokenManager.clearRefreshToken(),D.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(D=>Object.assign({},D)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(D,R){var j,G,Q,St,jt,He,un,sn;const ti=null!==(j=R.displayName)&&void 0!==j?j:void 0,ns=null!==(G=R.email)&&void 0!==G?G:void 0,gs=null!==(Q=R.phoneNumber)&&void 0!==Q?Q:void 0,jh=null!==(St=R.photoURL)&&void 0!==St?St:void 0,mw=null!==(jt=R.tenantId)&&void 0!==jt?jt:void 0,$h=null!==(He=R._redirectEventId)&&void 0!==He?He:void 0,Ci=null!==(un=R.createdAt)&&void 0!==un?un:void 0,Dr=null!==(sn=R.lastLoginAt)&&void 0!==sn?sn:void 0,{uid:a_,emailVerified:pa,isAnonymous:l_,providerData:el,stsTokenManager:Gh}=R;Ct(a_&&Gh,D,"internal-error");const p0=ds.fromJSON(this.name,Gh);Ct("string"==typeof a_,D,"internal-error"),Ft(ti,D.name),Ft(ns,D.name),Ct("boolean"==typeof pa,D,"internal-error"),Ct("boolean"==typeof l_,D,"internal-error"),Ft(gs,D.name),Ft(jh,D.name),Ft(mw,D.name),Ft($h,D.name),Ft(Ci,D.name),Ft(Dr,D.name);const Du=new Ht({uid:a_,auth:D,email:ns,emailVerified:pa,displayName:ti,isAnonymous:l_,photoURL:jh,phoneNumber:gs,tenantId:mw,stsTokenManager:p0,createdAt:Ci,lastLoginAt:Dr});return el&&Array.isArray(el)&&(Du.providerData=el.map(rc=>Object.assign({},rc))),$h&&(Du._redirectEventId=$h),Du}static _fromIdTokenResponse(D,R,j=!1){return(0,M.Z)(function*(){const G=new ds;G.updateFromServerResponse(R);const Q=new Ht({uid:R.localId,auth:D,stsTokenManager:G,isAnonymous:j});return yield Vi(Q),Q})()}}const te=new Map;function le(z){en(z instanceof Function,"Expected a class definition");let D=te.get(z);return D?(en(D instanceof z,"Instance stored in cache mismatched with class"),D):(D=new z,te.set(z,D),D)}const ve=(()=>{class z{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,M.Z)(function*(){return!0})()}_set(R,j){var G=this;return(0,M.Z)(function*(){G.storage[R]=j})()}_get(R){var j=this;return(0,M.Z)(function*(){const G=j.storage[R];return void 0===G?null:G})()}_remove(R){var j=this;return(0,M.Z)(function*(){delete j.storage[R]})()}_addListener(R,j){}_removeListener(R,j){}}return z.type="NONE",z})();function xe(z,D,R){return`firebase:${z}:${D}:${R}`}class it{constructor(D,R,j){this.persistence=D,this.auth=R,this.userKey=j;const{config:G,name:Q}=this.auth;this.fullUserKey=xe(this.userKey,G.apiKey,Q),this.fullPersistenceKey=xe("persistence",G.apiKey,Q),this.boundEventHandler=R._onStorageEvent.bind(R),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(D){return this.persistence._set(this.fullUserKey,D.toJSON())}getCurrentUser(){var D=this;return(0,M.Z)(function*(){const R=yield D.persistence._get(D.fullUserKey);return R?Ht._fromJSON(D.auth,R):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(D){var R=this;return(0,M.Z)(function*(){if(R.persistence===D)return;const j=yield R.getCurrentUser();return yield R.removeCurrentUser(),R.persistence=D,j?R.setCurrentUser(j):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(D,R,j="authUser"){return(0,M.Z)(function*(){if(!R.length)return new it(le(ve),D,j);const G=(yield Promise.all(R.map(function(){var un=(0,M.Z)(function*(sn){if(yield sn._isAvailable())return sn});return function(sn){return un.apply(this,arguments)}}()))).filter(un=>un);let Q=G[0]||le(ve);const St=xe(j,D.config.apiKey,D.name);let jt=null;for(const un of R)try{const sn=yield un._get(St);if(sn){const ti=Ht._fromJSON(D,sn);un!==Q&&(jt=ti),Q=un;break}}catch{}const He=G.filter(un=>un._shouldAllowMigration);return Q._shouldAllowMigration&&He.length?(Q=He[0],jt&&(yield Q._set(St,jt.toJSON())),yield Promise.all(R.map(function(){var un=(0,M.Z)(function*(sn){if(sn!==Q)try{yield sn._remove(St)}catch{}});return function(sn){return un.apply(this,arguments)}}())),new it(Q,D,j)):new it(Q,D,j)})()}}function at(z){const D=z.toLowerCase();if(D.includes("opera/")||D.includes("opr/")||D.includes("opios/"))return"Opera";if(ee(D))return"IEMobile";if(D.includes("msie")||D.includes("trident/"))return"IE";if(D.includes("edge/"))return"Edge";if(ht(D))return"Firefox";if(D.includes("silk/"))return"Silk";if(Nn(D))return"Blackberry";if(yr(D))return"Webos";if(Bt(D))return"Safari";if((D.includes("chrome/")||kt(D))&&!D.includes("edge/"))return"Chrome";if(Ke(D))return"Android";{const j=z.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===j?.length)return j[1]}return"Other"}function ht(z=(0,mt.z$)()){return/firefox\//i.test(z)}function Bt(z=(0,mt.z$)()){const D=z.toLowerCase();return D.includes("safari/")&&!D.includes("chrome/")&&!D.includes("crios/")&&!D.includes("android")}function kt(z=(0,mt.z$)()){return/crios\//i.test(z)}function ee(z=(0,mt.z$)()){return/iemobile/i.test(z)}function Ke(z=(0,mt.z$)()){return/android/i.test(z)}function Nn(z=(0,mt.z$)()){return/blackberry/i.test(z)}function yr(z=(0,mt.z$)()){return/webos/i.test(z)}function Or(z=(0,mt.z$)()){return/iphone|ipad|ipod/i.test(z)||/macintosh/i.test(z)&&/mobile/i.test(z)}function Qr(z=(0,mt.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(z)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(z)}function ji(z=(0,mt.z$)()){return Or(z)||Ke(z)||yr(z)||Nn(z)||/windows phone/i.test(z)||ee(z)}function qs(z,D=[]){let R;switch(z){case"Browser":R=at((0,mt.z$)());break;case"Worker":R=`${at((0,mt.z$)())}-${z}`;break;default:R=z}const j=D.length?D.join(","):"FirebaseCore-web";return`${R}/JsCore/${It.SDK_VERSION}/${j}`}function Vt(){return(Vt=(0,M.Z)(function*(z){return(yield he(z,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Re(z,D){return zn.apply(this,arguments)}function zn(){return(zn=(0,M.Z)(function*(z,D){return he(z,"GET","/v2/recaptchaConfig",_t(z,D))})).apply(this,arguments)}function vr(z){return void 0!==z&&void 0!==z.getResponse}function sr(z){return void 0!==z&&void 0!==z.enterprise}class ai{constructor(D){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===D.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=D.recaptchaKey.split("/")[3],this.emailPasswordEnabled=D.recaptchaEnforcementState.some(R=>"EMAIL_PASSWORD_PROVIDER"===R.provider&&"OFF"!==R.enforcementState)}}function Ti(z){return new Promise((D,R)=>{const j=document.createElement("script");j.setAttribute("src",z),j.onload=D,j.onerror=G=>{const Q=tt("internal-error");Q.customData=G,R(Q)},j.type="text/javascript",j.charset="UTF-8",function Hi(){var z,D;return null!==(D=null===(z=document.getElementsByTagName("head"))||void 0===z?void 0:z[0])&&void 0!==D?D:document}().appendChild(j)})}function zr(z){return`__${z}${Math.floor(1e6*Math.random())}`}class cd{constructor(D){this.type="recaptcha-enterprise",this.auth=qi(D)}verify(D="verify",R=!1){var j=this;return(0,M.Z)(function*(){function Q(){return Q=(0,M.Z)(function*(jt){if(!R){if(null==jt.tenantId&&null!=jt._agentRecaptchaConfig)return jt._agentRecaptchaConfig.siteKey;if(null!=jt.tenantId&&void 0!==jt._tenantRecaptchaConfigs[jt.tenantId])return jt._tenantRecaptchaConfigs[jt.tenantId].siteKey}return new Promise(function(){var He=(0,M.Z)(function*(un,sn){Re(jt,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(ti=>{if(void 0!==ti.recaptchaKey){const ns=new ai(ti);return null==jt.tenantId?jt._agentRecaptchaConfig=ns:jt._tenantRecaptchaConfigs[jt.tenantId]=ns,un(ns.siteKey)}sn(new Error("recaptcha Enterprise site key undefined"))}).catch(ti=>{sn(ti)})});return function(un,sn){return He.apply(this,arguments)}}())}),Q.apply(this,arguments)}function St(jt,He,un){const sn=window.grecaptcha;sr(sn)?sn.enterprise.ready(()=>{sn.enterprise.execute(jt,{action:D}).then(ti=>{He(ti)}).catch(()=>{He("NO_RECAPTCHA")})}):un(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((jt,He)=>{(function G(jt){return Q.apply(this,arguments)})(j.auth).then(un=>{if(!R&&sr(window.grecaptcha))St(un,jt,He);else{if(typeof window>"u")return void He(new Error("RecaptchaVerifier is only supported in browser"));Ti("https://www.google.com/recaptcha/enterprise.js?render="+un).then(()=>{St(un,jt,He)}).catch(sn=>{He(sn)})}}).catch(un=>{He(un)})})})()}}function bs(z,D,R){return Ba.apply(this,arguments)}function Ba(){return(Ba=(0,M.Z)(function*(z,D,R,j=!1){const G=new cd(z);let Q;try{Q=yield G.verify(R)}catch{Q=yield G.verify(R,!0)}const St=Object.assign({},D);return Object.assign(St,j?{captchaResp:Q}:{captchaResponse:Q}),Object.assign(St,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(St,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),St})).apply(this,arguments)}class ag{constructor(D){this.auth=D,this.queue=[]}pushCallback(D,R){const j=Q=>new Promise((St,jt)=>{try{St(D(Q))}catch(He){jt(He)}});j.onAbort=R,this.queue.push(j);const G=this.queue.length-1;return()=>{this.queue[G]=()=>Promise.resolve()}}runMiddleware(D){var R=this;return(0,M.Z)(function*(){if(R.auth.currentUser===D)return;const j=[];try{for(const G of R.queue)yield G(D),G.onAbort&&j.push(G.onAbort)}catch(G){j.reverse();for(const Q of j)try{Q()}catch{}throw R.auth._errorFactory.create("login-blocked",{originalMessage:G?.message})}})()}}class ml{constructor(D,R,j,G){this.app=D,this.heartbeatServiceProvider=R,this.appCheckServiceProvider=j,this.config=G,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lg(this),this.idTokenSubscription=new lg(this),this.beforeStateQueue=new ag(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=We,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=D.name,this.clientVersion=G.sdkClientVersion}_initializeWithPersistence(D,R){var j=this;return R&&(this._popupRedirectResolver=le(R)),this._initializationPromise=this.queue((0,M.Z)(function*(){var G,Q;if(!j._deleted&&(j.persistenceManager=yield it.create(j,D),!j._deleted)){if(null!==(G=j._popupRedirectResolver)&&void 0!==G&&G._shouldInitProactively)try{yield j._popupRedirectResolver._initialize(j)}catch{}yield j.initializeCurrentUser(R),j.lastNotifiedUid=(null===(Q=j.currentUser)||void 0===Q?void 0:Q.uid)||null,!j._deleted&&(j._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var D=this;return(0,M.Z)(function*(){if(D._deleted)return;const R=yield D.assertedPersistence.getCurrentUser();if(D.currentUser||R){if(D.currentUser&&R&&D.currentUser.uid===R.uid)return D._currentUser._assign(R),void(yield D.currentUser.getIdToken());yield D._updateCurrentUser(R,!0)}})()}initializeCurrentUser(D){var R=this;return(0,M.Z)(function*(){var j;const G=yield R.assertedPersistence.getCurrentUser();let Q=G,St=!1;if(D&&R.config.authDomain){yield R.getOrInitRedirectPersistenceManager();const jt=null===(j=R.redirectUser)||void 0===j?void 0:j._redirectEventId,He=Q?._redirectEventId,un=yield R.tryRedirectSignIn(D);(!jt||jt===He)&&un?.user&&(Q=un.user,St=!0)}if(!Q)return R.directlySetCurrentUser(null);if(!Q._redirectEventId){if(St)try{yield R.beforeStateQueue.runMiddleware(Q)}catch(jt){Q=G,R._popupRedirectResolver._overrideRedirectResult(R,()=>Promise.reject(jt))}return Q?R.reloadAndSetCurrentUserOrClear(Q):R.directlySetCurrentUser(null)}return Ct(R._popupRedirectResolver,R,"argument-error"),yield R.getOrInitRedirectPersistenceManager(),R.redirectUser&&R.redirectUser._redirectEventId===Q._redirectEventId?R.directlySetCurrentUser(Q):R.reloadAndSetCurrentUserOrClear(Q)})()}tryRedirectSignIn(D){var R=this;return(0,M.Z)(function*(){let j=null;try{j=yield R._popupRedirectResolver._completeRedirectFn(R,D,!0)}catch{yield R._setRedirectUser(null)}return j})()}reloadAndSetCurrentUserOrClear(D){var R=this;return(0,M.Z)(function*(){try{yield Vi(D)}catch(j){if("auth/network-request-failed"!==j?.code)return R.directlySetCurrentUser(null)}return R.directlySetCurrentUser(D)})()}useDeviceLanguage(){this.languageCode=function Yr(){if(typeof navigator>"u")return null;const z=navigator;return z.languages&&z.languages[0]||z.language||null}()}_delete(){var D=this;return(0,M.Z)(function*(){D._deleted=!0})()}updateCurrentUser(D){var R=this;return(0,M.Z)(function*(){const j=D?(0,mt.m9)(D):null;return j&&Ct(j.auth.config.apiKey===R.config.apiKey,R,"invalid-user-token"),R._updateCurrentUser(j&&j._clone(R))})()}_updateCurrentUser(D,R=!1){var j=this;return(0,M.Z)(function*(){if(!j._deleted)return D&&Ct(j.tenantId===D.tenantId,j,"tenant-id-mismatch"),R||(yield j.beforeStateQueue.runMiddleware(D)),j.queue((0,M.Z)(function*(){yield j.directlySetCurrentUser(D),j.notifyAuthListeners()}))})()}signOut(){var D=this;return(0,M.Z)(function*(){return yield D.beforeStateQueue.runMiddleware(null),(D.redirectPersistenceManager||D._popupRedirectResolver)&&(yield D._setRedirectUser(null)),D._updateCurrentUser(null,!0)})()}setPersistence(D){var R=this;return this.queue((0,M.Z)(function*(){yield R.assertedPersistence.setPersistence(le(D))}))}initializeRecaptchaConfig(){var D=this;return(0,M.Z)(function*(){const R=yield Re(D,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),j=new ai(R);null==D.tenantId?D._agentRecaptchaConfig=j:D._tenantRecaptchaConfigs[D.tenantId]=j,j.emailPasswordEnabled&&new cd(D).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(D){this._errorFactory=new mt.LL("auth","Firebase",D())}onAuthStateChanged(D,R,j){return this.registerStateListener(this.authStateSubscription,D,R,j)}beforeAuthStateChanged(D,R){return this.beforeStateQueue.pushCallback(D,R)}onIdTokenChanged(D,R,j){return this.registerStateListener(this.idTokenSubscription,D,R,j)}toJSON(){var D;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(D=this._currentUser)||void 0===D?void 0:D.toJSON()}}_setRedirectUser(D,R){var j=this;return(0,M.Z)(function*(){const G=yield j.getOrInitRedirectPersistenceManager(R);return null===D?G.removeCurrentUser():G.setCurrentUser(D)})()}getOrInitRedirectPersistenceManager(D){var R=this;return(0,M.Z)(function*(){if(!R.redirectPersistenceManager){const j=D&&le(D)||R._popupRedirectResolver;Ct(j,R,"argument-error"),R.redirectPersistenceManager=yield it.create(R,[le(j._redirectPersistence)],"redirectUser"),R.redirectUser=yield R.redirectPersistenceManager.getCurrentUser()}return R.redirectPersistenceManager})()}_redirectUserForId(D){var R=this;return(0,M.Z)(function*(){var j,G;return R._isInitialized&&(yield R.queue((0,M.Z)(function*(){}))),(null===(j=R._currentUser)||void 0===j?void 0:j._redirectEventId)===D?R._currentUser:(null===(G=R.redirectUser)||void 0===G?void 0:G._redirectEventId)===D?R.redirectUser:null})()}_persistUserIfCurrent(D){var R=this;return(0,M.Z)(function*(){if(D===R.currentUser)return R.queue((0,M.Z)(function*(){return R.directlySetCurrentUser(D)}))})()}_notifyListenersIfCurrent(D){D===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var D,R;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const j=null!==(R=null===(D=this.currentUser)||void 0===D?void 0:D.uid)&&void 0!==R?R:null;this.lastNotifiedUid!==j&&(this.lastNotifiedUid=j,this.authStateSubscription.next(this.currentUser))}registerStateListener(D,R,j,G){if(this._deleted)return()=>{};const Q="function"==typeof R?R:R.next.bind(R),St=this._isInitialized?Promise.resolve():this._initializationPromise;return Ct(St,this,"internal-error"),St.then(()=>Q(this.currentUser)),"function"==typeof R?D.addObserver(R,j,G):D.addObserver(R)}directlySetCurrentUser(D){var R=this;return(0,M.Z)(function*(){R.currentUser&&R.currentUser!==D&&R._currentUser._stopProactiveRefresh(),D&&R.isProactiveRefreshEnabled&&D._startProactiveRefresh(),R.currentUser=D,D?yield R.assertedPersistence.setCurrentUser(D):yield R.assertedPersistence.removeCurrentUser()})()}queue(D){return this.operations=this.operations.then(D,D),this.operations}get assertedPersistence(){return Ct(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(D){!D||this.frameworks.includes(D)||(this.frameworks.push(D),this.frameworks.sort(),this.clientVersion=qs(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var D=this;return(0,M.Z)(function*(){var R;const j={"X-Client-Version":D.clientVersion};D.app.options.appId&&(j["X-Firebase-gmpid"]=D.app.options.appId);const G=yield null===(R=D.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===R?void 0:R.getHeartbeatsHeader();G&&(j["X-Firebase-Client"]=G);const Q=yield D._getAppCheckToken();return Q&&(j["X-Firebase-AppCheck"]=Q),j})()}_getAppCheckToken(){var D=this;return(0,M.Z)(function*(){var R;const j=yield null===(R=D.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===R?void 0:R.getToken();return j?.error&&function Fn(z,...D){Te.logLevel<=lt.in.WARN&&Te.warn(`Auth (${It.SDK_VERSION}): ${z}`,...D)}(`Error while retrieving App Check token: ${j.error}`),j?.token})()}}function qi(z){return(0,mt.m9)(z)}class lg{constructor(D){this.auth=D,this.observer=null,this.addObserver=(0,mt.ne)(R=>this.observer=R)}get next(){return Ct(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function dd(z,D,R){const j=qi(z);Ct(j._canInitEmulator,j,"emulator-config-failed"),Ct(/^https?:\/\//.test(D),j,"invalid-emulator-scheme");const G=!!R?.disableWarnings,Q=Va(D),{host:St,port:jt}=function hd(z){const D=Va(z),R=/(\/\/)?([^?#/]+)/.exec(z.substr(D.length));if(!R)return{host:"",port:null};const j=R[2].split("@").pop()||"",G=/^(\[[^\]]+\])(:|$)/.exec(j);if(G){const Q=G[1];return{host:Q,port:Mn(j.substr(Q.length+1))}}{const[Q,St]=j.split(":");return{host:Q,port:Mn(St)}}}(D);j.config.emulator={url:`${Q}//${St}${null===jt?"":`:${jt}`}/`},j.settings.appVerificationDisabledForTesting=!0,j.emulatorConfig=Object.freeze({host:St,port:jt,protocol:Q.replace(":",""),options:Object.freeze({disableWarnings:G})}),G||function ei(){function z(){const D=document.createElement("p"),R=D.style;D.innerText="Running in emulator mode. Do not use with production credentials.",R.position="fixed",R.width="100%",R.backgroundColor="#ffffff",R.border=".1em solid #000000",R.color="#b50000",R.bottom="0px",R.left="0px",R.margin="0px",R.zIndex="10000",R.textAlign="center",D.classList.add("firebase-emulator-warning"),document.body.appendChild(D)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",z):z())}()}function Va(z){const D=z.indexOf(":");return D<0?"":z.substr(0,D+1)}function Mn(z){if(!z)return null;const D=Number(z);return isNaN(D)?null:D}class ia{constructor(D,R){this.providerId=D,this.signInMethod=R}toJSON(){return ge("not implemented")}_getIdTokenResponse(D){return ge("not implemented")}_linkToIdToken(D,R){return ge("not implemented")}_getReauthenticationResolver(D){return ge("not implemented")}}function Ho(z,D){return su.apply(this,arguments)}function su(){return(su=(0,M.Z)(function*(z,D){return he(z,"POST","/v1/accounts:resetPassword",_t(z,D))})).apply(this,arguments)}function au(z,D){return $f.apply(this,arguments)}function $f(){return($f=(0,M.Z)(function*(z,D){return he(z,"POST","/v1/accounts:update",D)})).apply(this,arguments)}function xs(){return(xs=(0,M.Z)(function*(z,D){return he(z,"POST","/v1/accounts:update",_t(z,D))})).apply(this,arguments)}function _h(z,D){return vo.apply(this,arguments)}function vo(){return(vo=(0,M.Z)(function*(z,D){return wi(z,"POST","/v1/accounts:signInWithPassword",_t(z,D))})).apply(this,arguments)}function lu(z,D){return Gf.apply(this,arguments)}function Gf(){return(Gf=(0,M.Z)(function*(z,D){return he(z,"POST","/v1/accounts:sendOobCode",_t(z,D))})).apply(this,arguments)}function fd(){return(fd=(0,M.Z)(function*(z,D){return lu(z,D)})).apply(this,arguments)}function yh(z,D){return de.apply(this,arguments)}function de(){return(de=(0,M.Z)(function*(z,D){return lu(z,D)})).apply(this,arguments)}function Cn(z,D){return ki.apply(this,arguments)}function ki(){return(ki=(0,M.Z)(function*(z,D){return lu(z,D)})).apply(this,arguments)}function Fe(){return(Fe=(0,M.Z)(function*(z,D){return lu(z,D)})).apply(this,arguments)}function Zs(){return(Zs=(0,M.Z)(function*(z,D){return wi(z,"POST","/v1/accounts:signInWithEmailLink",_t(z,D))})).apply(this,arguments)}function $i(){return($i=(0,M.Z)(function*(z,D){return wi(z,"POST","/v1/accounts:signInWithEmailLink",_t(z,D))})).apply(this,arguments)}class Yo extends ia{constructor(D,R,j,G=null){super("password",j),this._email=D,this._password=R,this._tenantId=G}static _fromEmailAndPassword(D,R){return new Yo(D,R,"password")}static _fromEmailAndCode(D,R,j=null){return new Yo(D,R,"emailLink",j)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(D){const R="string"==typeof D?JSON.parse(D):D;if(R?.email&&R?.password){if("password"===R.signInMethod)return this._fromEmailAndPassword(R.email,R.password);if("emailLink"===R.signInMethod)return this._fromEmailAndCode(R.email,R.password,R.tenantId)}return null}_getIdTokenResponse(D){var R=this;return(0,M.Z)(function*(){var j;switch(R.signInMethod){case"password":const G={returnSecureToken:!0,email:R._email,password:R._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(j=D._getRecaptchaConfig())&&void 0!==j&&j.emailPasswordEnabled){const Q=yield bs(D,G,"signInWithPassword");return _h(D,Q)}return _h(D,G).catch(function(){var Q=(0,M.Z)(function*(St){if("auth/missing-recaptcha-token"===St.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const jt=yield bs(D,G,"signInWithPassword");return _h(D,jt)}return Promise.reject(St)});return function(St){return Q.apply(this,arguments)}}());case"emailLink":return function wc(z,D){return Zs.apply(this,arguments)}(D,{email:R._email,oobCode:R._password});default:me(D,"internal-error")}})()}_linkToIdToken(D,R){var j=this;return(0,M.Z)(function*(){switch(j.signInMethod){case"password":return au(D,{idToken:R,returnSecureToken:!0,email:j._email,password:j._password});case"emailLink":return function Wn(z,D){return $i.apply(this,arguments)}(D,{idToken:R,email:j._email,oobCode:j._password});default:me(D,"internal-error")}})()}_getReauthenticationResolver(D){return this._getIdTokenResponse(D)}}function ho(z,D){return Do.apply(this,arguments)}function Do(){return(Do=(0,M.Z)(function*(z,D){return wi(z,"POST","/v1/accounts:signInWithIdp",_t(z,D))})).apply(this,arguments)}class ws extends ia{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(D){const R=new ws(D.providerId,D.signInMethod);return D.idToken||D.accessToken?(D.idToken&&(R.idToken=D.idToken),D.accessToken&&(R.accessToken=D.accessToken),D.nonce&&!D.pendingToken&&(R.nonce=D.nonce),D.pendingToken&&(R.pendingToken=D.pendingToken)):D.oauthToken&&D.oauthTokenSecret?(R.accessToken=D.oauthToken,R.secret=D.oauthTokenSecret):me("argument-error"),R}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(D){const R="string"==typeof D?JSON.parse(D):D,{providerId:j,signInMethod:G}=R,Q=(0,vt._T)(R,["providerId","signInMethod"]);if(!j||!G)return null;const St=new ws(j,G);return St.idToken=Q.idToken||void 0,St.accessToken=Q.accessToken||void 0,St.secret=Q.secret,St.nonce=Q.nonce,St.pendingToken=Q.pendingToken||null,St}_getIdTokenResponse(D){return ho(D,this.buildRequest())}_linkToIdToken(D,R){const j=this.buildRequest();return j.idToken=R,ho(D,j)}_getReauthenticationResolver(D){const R=this.buildRequest();return R.autoCreate=!1,ho(D,R)}buildRequest(){const D={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)D.pendingToken=this.pendingToken;else{const R={};this.idToken&&(R.id_token=this.idToken),this.accessToken&&(R.access_token=this.accessToken),this.secret&&(R.oauth_token_secret=this.secret),R.providerId=this.providerId,this.nonce&&!this.pendingToken&&(R.nonce=this.nonce),D.postBody=(0,mt.xO)(R)}return D}}function br(){return(br=(0,M.Z)(function*(z,D){return he(z,"POST","/v1/accounts:sendVerificationCode",_t(z,D))})).apply(this,arguments)}function Jr(){return(Jr=(0,M.Z)(function*(z,D){return wi(z,"POST","/v1/accounts:signInWithPhoneNumber",_t(z,D))})).apply(this,arguments)}function Ye(){return(Ye=(0,M.Z)(function*(z,D){const R=yield wi(z,"POST","/v1/accounts:signInWithPhoneNumber",_t(z,D));if(R.temporaryProof)throw hi(z,"account-exists-with-different-credential",R);return R})).apply(this,arguments)}const Ai={USER_NOT_FOUND:"user-not-found"};function ja(){return(ja=(0,M.Z)(function*(z,D){return wi(z,"POST","/v1/accounts:signInWithPhoneNumber",_t(z,Object.assign(Object.assign({},D),{operation:"REAUTH"})),Ai)})).apply(this,arguments)}class Zr extends ia{constructor(D){super("phone","phone"),this.params=D}static _fromVerification(D,R){return new Zr({verificationId:D,verificationCode:R})}static _fromTokenResponse(D,R){return new Zr({phoneNumber:D,temporaryProof:R})}_getIdTokenResponse(D){return function Tr(z,D){return Jr.apply(this,arguments)}(D,this._makeVerificationRequest())}_linkToIdToken(D,R){return function dn(z,D){return Ye.apply(this,arguments)}(D,Object.assign({idToken:R},this._makeVerificationRequest()))}_getReauthenticationResolver(D){return function Cs(z,D){return ja.apply(this,arguments)}(D,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:D,phoneNumber:R,verificationId:j,verificationCode:G}=this.params;return D&&R?{temporaryProof:D,phoneNumber:R}:{sessionInfo:j,code:G}}toJSON(){const D={providerId:this.providerId};return this.params.phoneNumber&&(D.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(D.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(D.verificationCode=this.params.verificationCode),this.params.verificationId&&(D.verificationId=this.params.verificationId),D}static fromJSON(D){"string"==typeof D&&(D=JSON.parse(D));const{verificationId:R,verificationCode:j,phoneNumber:G,temporaryProof:Q}=D;return j||R||G||Q?new Zr({verificationId:R,verificationCode:j,phoneNumber:G,temporaryProof:Q}):null}}class Xo{constructor(D){var R,j,G,Q,St,jt;const He=(0,mt.zd)((0,mt.pd)(D)),un=null!==(R=He.apiKey)&&void 0!==R?R:null,sn=null!==(j=He.oobCode)&&void 0!==j?j:null,ti=function ni(z){switch(z){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(G=He.mode)&&void 0!==G?G:null);Ct(un&&sn&&ti,"argument-error"),this.apiKey=un,this.operation=ti,this.code=sn,this.continueUrl=null!==(Q=He.continueUrl)&&void 0!==Q?Q:null,this.languageCode=null!==(St=He.languageCode)&&void 0!==St?St:null,this.tenantId=null!==(jt=He.tenantId)&&void 0!==jt?jt:null}static parseLink(D){const R=function ko(z){const D=(0,mt.zd)((0,mt.pd)(z)).link,R=D?(0,mt.zd)((0,mt.pd)(D)).deep_link_id:null,j=(0,mt.zd)((0,mt.pd)(z)).deep_link_id;return(j?(0,mt.zd)((0,mt.pd)(j)).link:null)||j||R||D||z}(D);try{return new Xo(R)}catch{return null}}}let ar=(()=>{class z{constructor(){this.providerId=z.PROVIDER_ID}static credential(R,j){return Yo._fromEmailAndPassword(R,j)}static credentialWithLink(R,j){const G=Xo.parseLink(j);return Ct(G,"argument-error"),Yo._fromEmailAndCode(R,G.code,G.tenantId)}}return z.PROVIDER_ID="password",z.EMAIL_PASSWORD_SIGN_IN_METHOD="password",z.EMAIL_LINK_SIGN_IN_METHOD="emailLink",z})();class Ws{constructor(D){this.providerId=D,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(D){this.defaultLanguageCode=D}setCustomParameters(D){return this.customParameters=D,this}getCustomParameters(){return this.customParameters}}class Cc extends Ws{constructor(){super(...arguments),this.scopes=[]}addScope(D){return this.scopes.includes(D)||this.scopes.push(D),this}getScopes(){return[...this.scopes]}}class ba extends Cc{static credentialFromJSON(D){const R="string"==typeof D?JSON.parse(D):D;return Ct("providerId"in R&&"signInMethod"in R,"argument-error"),ws._fromParams(R)}credential(D){return this._credential(Object.assign(Object.assign({},D),{nonce:D.rawNonce}))}_credential(D){return Ct(D.idToken||D.accessToken,"argument-error"),ws._fromParams(Object.assign(Object.assign({},D),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(D){return ba.oauthCredentialFromTaggedObject(D)}static credentialFromError(D){return ba.oauthCredentialFromTaggedObject(D.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:D}){if(!D)return null;const{oauthIdToken:R,oauthAccessToken:j,oauthTokenSecret:G,pendingToken:Q,nonce:St,providerId:jt}=D;if(!j&&!G&&!R&&!Q||!jt)return null;try{return new ba(jt)._credential({idToken:R,accessToken:j,nonce:St,pendingToken:Q})}catch{return null}}}let Zi=(()=>{class z extends Cc{constructor(){super("facebook.com")}static credential(R){return ws._fromParams({providerId:z.PROVIDER_ID,signInMethod:z.FACEBOOK_SIGN_IN_METHOD,accessToken:R})}static credentialFromResult(R){return z.credentialFromTaggedObject(R)}static credentialFromError(R){return z.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R||!("oauthAccessToken"in R)||!R.oauthAccessToken)return null;try{return z.credential(R.oauthAccessToken)}catch{return null}}}return z.FACEBOOK_SIGN_IN_METHOD="facebook.com",z.PROVIDER_ID="facebook.com",z})(),cu=(()=>{class z extends Cc{constructor(){super("google.com"),this.addScope("profile")}static credential(R,j){return ws._fromParams({providerId:z.PROVIDER_ID,signInMethod:z.GOOGLE_SIGN_IN_METHOD,idToken:R,accessToken:j})}static credentialFromResult(R){return z.credentialFromTaggedObject(R)}static credentialFromError(R){return z.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R)return null;const{oauthIdToken:j,oauthAccessToken:G}=R;if(!j&&!G)return null;try{return z.credential(j,G)}catch{return null}}}return z.GOOGLE_SIGN_IN_METHOD="google.com",z.PROVIDER_ID="google.com",z})(),$a=(()=>{class z extends Cc{constructor(){super("github.com")}static credential(R){return ws._fromParams({providerId:z.PROVIDER_ID,signInMethod:z.GITHUB_SIGN_IN_METHOD,accessToken:R})}static credentialFromResult(R){return z.credentialFromTaggedObject(R)}static credentialFromError(R){return z.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R||!("oauthAccessToken"in R)||!R.oauthAccessToken)return null;try{return z.credential(R.oauthAccessToken)}catch{return null}}}return z.GITHUB_SIGN_IN_METHOD="github.com",z.PROVIDER_ID="github.com",z})();class bn extends ia{constructor(D,R){super(D,D),this.pendingToken=R}_getIdTokenResponse(D){return ho(D,this.buildRequest())}_linkToIdToken(D,R){const j=this.buildRequest();return j.idToken=R,ho(D,j)}_getReauthenticationResolver(D){const R=this.buildRequest();return R.autoCreate=!1,ho(D,R)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(D){const R="string"==typeof D?JSON.parse(D):D,{providerId:j,signInMethod:G,pendingToken:Q}=R;return j&&G&&Q&&j===G?new bn(j,Q):null}static _create(D,R){return new bn(D,R)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class oa extends Ws{constructor(D){Ct(D.startsWith("saml."),"argument-error"),super(D)}static credentialFromResult(D){return oa.samlCredentialFromTaggedObject(D)}static credentialFromError(D){return oa.samlCredentialFromTaggedObject(D.customData||{})}static credentialFromJSON(D){const R=bn.fromJSON(D);return Ct(R,"argument-error"),R}static samlCredentialFromTaggedObject({_tokenResponse:D}){if(!D)return null;const{pendingToken:R,providerId:j}=D;if(!R||!j)return null;try{return bn._create(j,R)}catch{return null}}}let po=(()=>{class z extends Cc{constructor(){super("twitter.com")}static credential(R,j){return ws._fromParams({providerId:z.PROVIDER_ID,signInMethod:z.TWITTER_SIGN_IN_METHOD,oauthToken:R,oauthTokenSecret:j})}static credentialFromResult(R){return z.credentialFromTaggedObject(R)}static credentialFromError(R){return z.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R)return null;const{oauthAccessToken:j,oauthTokenSecret:G}=R;if(!j||!G)return null;try{return z.credential(j,G)}catch{return null}}}return z.TWITTER_SIGN_IN_METHOD="twitter.com",z.PROVIDER_ID="twitter.com",z})();function Ro(z,D){return sa.apply(this,arguments)}function sa(){return(sa=(0,M.Z)(function*(z,D){return wi(z,"POST","/v1/accounts:signUp",_t(z,D))})).apply(this,arguments)}class Yn{constructor(D){this.user=D.user,this.providerId=D.providerId,this._tokenResponse=D._tokenResponse,this.operationType=D.operationType}static _fromIdTokenResponse(D,R,j,G=!1){return(0,M.Z)(function*(){const Q=yield Ht._fromIdTokenResponse(D,j,G),St=go(j);return new Yn({user:Q,providerId:St,_tokenResponse:j,operationType:R})})()}static _forOperation(D,R,j){return(0,M.Z)(function*(){yield D._updateTokensIfNecessary(j,!0);const G=go(j);return new Yn({user:D,providerId:G,_tokenResponse:j,operationType:R})})()}}function go(z){return z.providerId?z.providerId:"phoneNumber"in z?"phone":null}function zl(z){return gd.apply(this,arguments)}function gd(){return(gd=(0,M.Z)(function*(z){var D;const R=qi(z);if(yield R._initializationPromise,null!==(D=R.currentUser)&&void 0!==D&&D.isAnonymous)return new Yn({user:R.currentUser,providerId:null,operationType:"signIn"});const j=yield Ro(R,{returnSecureToken:!0}),G=yield Yn._fromIdTokenResponse(R,"signIn",j,!0);return yield R._updateCurrentUser(G.user),G})).apply(this,arguments)}class Ms extends mt.ZR{constructor(D,R,j,G){var Q;super(R.code,R.message),this.operationType=j,this.user=G,Object.setPrototypeOf(this,Ms.prototype),this.customData={appName:D.name,tenantId:null!==(Q=D.tenantId)&&void 0!==Q?Q:void 0,_serverResponse:R.customData._serverResponse,operationType:j}}static _fromErrorAndOperation(D,R,j,G){return new Ms(D,R,j,G)}}function Wi(z,D,R,j){return("reauthenticate"===D?R._getReauthenticationResolver(z):R._getIdTokenResponse(z)).catch(Q=>{throw"auth/multi-factor-auth-required"===Q.code?Ms._fromErrorAndOperation(z,Q,D,j):Q})}function Bl(z){return new Set(z.map(({providerId:D})=>D).filter(D=>!!D))}function uu(z,D){return Fi.apply(this,arguments)}function Fi(){return Fi=(0,M.Z)(function*(z,D){const R=(0,mt.m9)(z);yield Un(!0,R,D);const{providerUserInfo:j}=yield function nt(z,D){return gt.apply(this,arguments)}(R.auth,{idToken:yield R.getIdToken(),deleteProvider:[D]}),G=Bl(j||[]);return R.providerData=R.providerData.filter(Q=>G.has(Q.providerId)),G.has("phone")||(R.phoneNumber=null),yield R.auth._persistUserIfCurrent(R),R}),Fi.apply(this,arguments)}function aa(z,D){return bo.apply(this,arguments)}function bo(){return(bo=(0,M.Z)(function*(z,D,R=!1){const j=yield ur(z,D._linkToIdToken(z.auth,yield z.getIdToken()),R);return Yn._forOperation(z,"link",j)})).apply(this,arguments)}function Un(z,D,R){return du.apply(this,arguments)}function du(){return(du=(0,M.Z)(function*(z,D,R){yield Vi(D);const G=!1===z?"provider-already-linked":"no-such-provider";Ct(Bl(D.providerData).has(R)===z,D.auth,G)})).apply(this,arguments)}function _l(z,D){return Ga.apply(this,arguments)}function Ga(){return(Ga=(0,M.Z)(function*(z,D,R=!1){const{auth:j}=z,G="reauthenticate";try{const Q=yield ur(z,Wi(j,G,D,z),R);Ct(Q.idToken,j,"internal-error");const St=Ie(Q.idToken);Ct(St,j,"internal-error");const{sub:jt}=St;return Ct(z.uid===jt,j,"user-mismatch"),Yn._forOperation(z,G,Q)}catch(Q){throw"auth/user-not-found"===Q?.code&&me(j,"user-mismatch"),Q}})).apply(this,arguments)}function la(z,D){return hu.apply(this,arguments)}function hu(){return(hu=(0,M.Z)(function*(z,D,R=!1){const j="signIn",G=yield Wi(z,j,D),Q=yield Yn._fromIdTokenResponse(z,j,G);return R||(yield z._updateCurrentUser(Q.user)),Q})).apply(this,arguments)}function yl(z,D){return cg.apply(this,arguments)}function cg(){return(cg=(0,M.Z)(function*(z,D){return la(qi(z),D)})).apply(this,arguments)}function vl(z,D){return vh.apply(this,arguments)}function vh(){return(vh=(0,M.Z)(function*(z,D){const R=(0,mt.m9)(z);return yield Un(!1,R,D.providerId),aa(R,D)})).apply(this,arguments)}function Ki(z,D){return qy.apply(this,arguments)}function qy(){return(qy=(0,M.Z)(function*(z,D){return _l((0,mt.m9)(z),D)})).apply(this,arguments)}function bh(){return(bh=(0,M.Z)(function*(z,D){return wi(z,"POST","/v1/accounts:signInWithCustomToken",_t(z,D))})).apply(this,arguments)}function ug(z,D){return qf.apply(this,arguments)}function qf(){return qf=(0,M.Z)(function*(z,D){const R=qi(z),j=yield function pw(z,D){return bh.apply(this,arguments)}(R,{token:D,returnSecureToken:!0}),G=yield Yn._fromIdTokenResponse(R,"signIn",j);return yield R._updateCurrentUser(G.user),G}),qf.apply(this,arguments)}class Ps{constructor(D,R){this.factorId=D,this.uid=R.mfaEnrollmentId,this.enrollmentTime=new Date(R.enrolledAt).toUTCString(),this.displayName=R.displayName}static _fromServerResponse(D,R){return"phoneInfo"in R?jm._fromServerResponse(D,R):"totpInfo"in R?fu._fromServerResponse(D,R):me(D,"internal-error")}}class jm extends Ps{constructor(D){super("phone",D),this.phoneNumber=D.phoneInfo}static _fromServerResponse(D,R){return new jm(R)}}class fu extends Ps{constructor(D){super("totp",D)}static _fromServerResponse(D,R){return new fu(R)}}function Ha(z,D,R){var j;Ct((null===(j=R.url)||void 0===j?void 0:j.length)>0,z,"invalid-continue-uri"),Ct(typeof R.dynamicLinkDomain>"u"||R.dynamicLinkDomain.length>0,z,"invalid-dynamic-link-domain"),D.continueUrl=R.url,D.dynamicLinkDomain=R.dynamicLinkDomain,D.canHandleCodeInApp=R.handleCodeInApp,R.iOS&&(Ct(R.iOS.bundleId.length>0,z,"missing-ios-bundle-id"),D.iOSBundleId=R.iOS.bundleId),R.android&&(Ct(R.android.packageName.length>0,z,"missing-android-pkg-name"),D.androidInstallApp=R.android.installApp,D.androidMinimumVersionCode=R.android.minimumVersion,D.androidPackageName=R.android.packageName)}function f0(z,D,R){return Zy.apply(this,arguments)}function Zy(){return Zy=(0,M.Z)(function*(z,D,R){var j;const G=qi(z),Q={requestType:"PASSWORD_RESET",email:D,clientType:"CLIENT_TYPE_WEB"};if(null!==(j=G._getRecaptchaConfig())&&void 0!==j&&j.emailPasswordEnabled){const St=yield bs(G,Q,"getOobCode",!0);R&&Ha(G,St,R),yield yh(G,St)}else R&&Ha(G,Q,R),yield yh(G,Q).catch(function(){var St=(0,M.Z)(function*(jt){if("auth/missing-recaptcha-token"!==jt.code)return Promise.reject(jt);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const He=yield bs(G,Q,"getOobCode",!0);R&&Ha(G,He,R),yield yh(G,He)}});return function(jt){return St.apply(this,arguments)}}())}),Zy.apply(this,arguments)}function dg(z,D,R){return xh.apply(this,arguments)}function xh(){return(xh=(0,M.Z)(function*(z,D,R){yield Ho((0,mt.m9)(z),{oobCode:D,newPassword:R})})).apply(this,arguments)}function $m(z,D){return md.apply(this,arguments)}function md(){return md=(0,M.Z)(function*(z,D){yield function Hy(z,D){return xs.apply(this,arguments)}((0,mt.m9)(z),{oobCode:D})}),md.apply(this,arguments)}function xa(z,D){return Zf.apply(this,arguments)}function Zf(){return(Zf=(0,M.Z)(function*(z,D){const R=(0,mt.m9)(z),j=yield Ho(R,{oobCode:D}),G=j.requestType;switch(Ct(G,R,"internal-error"),G){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Ct(j.newEmail,R,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Ct(j.mfaInfo,R,"internal-error");default:Ct(j.email,R,"internal-error")}let Q=null;return j.mfaInfo&&(Q=Ps._fromServerResponse(qi(R),j.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===j.requestType?j.newEmail:j.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===j.requestType?j.email:j.newEmail)||null,multiFactorInfo:Q},operation:G}})).apply(this,arguments)}function Ul(z,D){return ca.apply(this,arguments)}function ca(){return(ca=(0,M.Z)(function*(z,D){const{data:R}=yield xa((0,mt.m9)(z),D);return R.email})).apply(this,arguments)}function pu(z,D,R){return wh.apply(this,arguments)}function wh(){return wh=(0,M.Z)(function*(z,D,R){var j;const G=qi(z),Q={returnSecureToken:!0,email:D,password:R,clientType:"CLIENT_TYPE_WEB"};let St;if(null!==(j=G._getRecaptchaConfig())&&void 0!==j&&j.emailPasswordEnabled){const un=yield bs(G,Q,"signUpPassword");St=Ro(G,un)}else St=Ro(G,Q).catch(function(){var un=(0,M.Z)(function*(sn){if("auth/missing-recaptcha-token"===sn.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const ti=yield bs(G,Q,"signUpPassword");return Ro(G,ti)}return Promise.reject(sn)});return function(sn){return un.apply(this,arguments)}}());const jt=yield St.catch(un=>Promise.reject(un)),He=yield Yn._fromIdTokenResponse(G,"signIn",jt);return yield G._updateCurrentUser(He.user),He}),wh.apply(this,arguments)}function qo(z,D,R){return yl((0,mt.m9)(z),ar.credential(D,R))}function _d(z,D,R){return Qo.apply(this,arguments)}function Qo(){return Qo=(0,M.Z)(function*(z,D,R){var j;const G=qi(z),Q={requestType:"EMAIL_SIGNIN",email:D,clientType:"CLIENT_TYPE_WEB"};function St(jt,He){Ct(He.handleCodeInApp,G,"argument-error"),He&&Ha(G,jt,He)}if(null!==(j=G._getRecaptchaConfig())&&void 0!==j&&j.emailPasswordEnabled){const jt=yield bs(G,Q,"getOobCode",!0);St(jt,R),yield Cn(G,jt)}else St(Q,R),yield Cn(G,Q).catch(function(){var jt=(0,M.Z)(function*(He){if("auth/missing-recaptcha-token"!==He.code)return Promise.reject(He);{console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const un=yield bs(G,Q,"getOobCode",!0);St(un,R),yield Cn(G,un)}});return function(He){return jt.apply(this,arguments)}}())}),Qo.apply(this,arguments)}function Ch(z,D){const R=Xo.parseLink(D);return"EMAIL_SIGNIN"===R?.operation}function Dt(z,D,R){return Lo.apply(this,arguments)}function Lo(){return(Lo=(0,M.Z)(function*(z,D,R){const j=(0,mt.m9)(z),G=ar.credentialWithLink(D,R||Ui());return Ct(G._tenantId===(j.tenantId||null),j,"tenant-id-mismatch"),yl(j,G)})).apply(this,arguments)}function Mc(){return(Mc=(0,M.Z)(function*(z,D){return he(z,"POST","/v1/accounts:createAuthUri",_t(z,D))})).apply(this,arguments)}function Gm(z,D){return Vl.apply(this,arguments)}function Vl(){return Vl=(0,M.Z)(function*(z,D){const j={identifier:D,continueUri:cs()?Ui():"http://localhost"},{signinMethods:G}=yield function hg(z,D){return Mc.apply(this,arguments)}((0,mt.m9)(z),j);return G||[]}),Vl.apply(this,arguments)}function qa(z,D){return Pc.apply(this,arguments)}function Pc(){return Pc=(0,M.Z)(function*(z,D){const R=(0,mt.m9)(z),G={requestType:"VERIFY_EMAIL",idToken:yield z.getIdToken()};D&&Ha(R.auth,G,D);const{email:Q}=yield function Um(z,D){return fd.apply(this,arguments)}(R.auth,G);Q!==z.email&&(yield z.reload())}),Pc.apply(this,arguments)}function jl(z,D,R){return $l.apply(this,arguments)}function $l(){return $l=(0,M.Z)(function*(z,D,R){const j=(0,mt.m9)(z),Q={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield z.getIdToken(),newEmail:D};R&&Ha(j.auth,Q,R);const{email:St}=yield function wt(z,D){return Fe.apply(this,arguments)}(j.auth,Q);St!==z.email&&(yield z.reload())}),$l.apply(this,arguments)}function Gl(){return(Gl=(0,M.Z)(function*(z,D){return he(z,"POST","/v1/accounts:update",D)})).apply(this,arguments)}function Mh(z,D){return Wf.apply(this,arguments)}function Wf(){return Wf=(0,M.Z)(function*(z,{displayName:D,photoURL:R}){if(void 0===D&&void 0===R)return;const j=(0,mt.m9)(z),Q={idToken:yield j.getIdToken(),displayName:D,photoUrl:R,returnSecureToken:!0},St=yield ur(j,function Za(z,D){return Gl.apply(this,arguments)}(j.auth,Q));j.displayName=St.displayName||null,j.photoURL=St.photoUrl||null;const jt=j.providerData.find(({providerId:He})=>"password"===He);jt&&(jt.displayName=j.displayName,jt.photoURL=j.photoURL),yield j._updateTokensIfNecessary(St)}),Wf.apply(this,arguments)}function Hm(z,D){return Zm((0,mt.m9)(z),D,null)}function qm(z,D){return Zm((0,mt.m9)(z),null,D)}function Zm(z,D,R){return Wm.apply(this,arguments)}function Wm(){return(Wm=(0,M.Z)(function*(z,D,R){const{auth:j}=z,Q={idToken:yield z.getIdToken(),returnSecureToken:!0};D&&(Q.email=D),R&&(Q.password=R);const St=yield ur(z,au(j,Q));yield z._updateTokensIfNecessary(St,!0)})).apply(this,arguments)}class Ph{constructor(D,R,j={}){this.isNewUser=D,this.providerId=R,this.profile=j}}class Eh extends Ph{constructor(D,R,j,G){super(D,R,j),this.username=G}}class yd extends Ph{constructor(D,R){super(D,"facebook.com",R)}}class Oh extends Eh{constructor(D,R){super(D,"github.com",R,"string"==typeof R?.login?R?.login:null)}}class fg extends Ph{constructor(D,R){super(D,"google.com",R)}}class Kf extends Eh{constructor(D,R,j){super(D,"twitter.com",R,j)}}function vd(z){const{user:D,_tokenResponse:R}=z;return D.isAnonymous&&!R?{providerId:null,isNewUser:!1,profile:null}:function Km(z){var D,R;if(!z)return null;const{providerId:j}=z,G=z.rawUserInfo?JSON.parse(z.rawUserInfo):{},Q=z.isNewUser||"identitytoolkit#SignupNewUserResponse"===z.kind;if(!j&&z?.idToken){const St=null===(R=null===(D=Ie(z.idToken))||void 0===D?void 0:D.firebase)||void 0===R?void 0:R.sign_in_provider;if(St)return new Ph(Q,"anonymous"!==St&&"custom"!==St?St:null)}if(!j)return null;switch(j){case"facebook.com":return new yd(Q,G);case"github.com":return new Oh(Q,G);case"google.com":return new fg(Q,G);case"twitter.com":return new Kf(Q,G,z.screenName||null);case"custom":case"anonymous":return new Ph(Q,null);default:return new Ph(Q,j,G)}}(R)}class wa{constructor(D,R,j){this.type=D,this.credential=R,this.auth=j}static _fromIdtoken(D,R){return new wa("enroll",D,R)}static _fromMfaPendingCredential(D){return new wa("signin",D)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(D){var R,j;if(D?.multiFactorSession){if(null!==(R=D.multiFactorSession)&&void 0!==R&&R.pendingCredential)return wa._fromMfaPendingCredential(D.multiFactorSession.pendingCredential);if(null!==(j=D.multiFactorSession)&&void 0!==j&&j.idToken)return wa._fromIdtoken(D.multiFactorSession.idToken)}return null}}class wd{constructor(D,R,j){this.session=D,this.hints=R,this.signInResolver=j}static _fromError(D,R){const j=qi(D),G=R.customData._serverResponse,Q=(G.mfaInfo||[]).map(jt=>Ps._fromServerResponse(j,jt));Ct(G.mfaPendingCredential,j,"internal-error");const St=wa._fromMfaPendingCredential(G.mfaPendingCredential);return new wd(St,Q,function(){var jt=(0,M.Z)(function*(He){const un=yield He._process(j,St);delete G.mfaInfo,delete G.mfaPendingCredential;const sn=Object.assign(Object.assign({},G),{idToken:un.idToken,refreshToken:un.refreshToken});switch(R.operationType){case"signIn":const ti=yield Yn._fromIdTokenResponse(j,R.operationType,sn);return yield j._updateCurrentUser(ti.user),ti;case"reauthenticate":return Ct(R.user,j,"internal-error"),Yn._forOperation(R.user,R.operationType,sn);default:me(j,"internal-error")}});return function(He){return jt.apply(this,arguments)}}())}resolveSignIn(D){var R=this;return(0,M.Z)(function*(){return R.signInResolver(D)})()}}function Oc(z,D){var R;const j=(0,mt.m9)(z),G=D;return Ct(D.customData.operationType,j,"argument-error"),Ct(null===(R=G.customData._serverResponse)||void 0===R?void 0:R.mfaPendingCredential,j,"argument-error"),wd._fromError(j,G)}class Md{constructor(D){this.user=D,this.enrolledFactors=[],D._onReload(R=>{R.mfaInfo&&(this.enrolledFactors=R.mfaInfo.map(j=>Ps._fromServerResponse(D.auth,j)))})}static _fromUser(D){return new Md(D)}getSession(){var D=this;return(0,M.Z)(function*(){return wa._fromIdtoken(yield D.user.getIdToken(),D.user.auth)})()}enroll(D,R){var j=this;return(0,M.Z)(function*(){const G=D,Q=yield j.getSession(),St=yield ur(j.user,G._process(j.user.auth,Q,R));return yield j.user._updateTokensIfNecessary(St),j.user.reload()})()}unenroll(D){var R=this;return(0,M.Z)(function*(){const j="string"==typeof D?D:D.uid,G=yield R.user.getIdToken();try{const Q=yield ur(R.user,function mg(z,D){return he(z,"POST","/v2/accounts/mfaEnrollment:withdraw",_t(z,D))}(R.user.auth,{idToken:G,mfaEnrollmentId:j}));R.enrolledFactors=R.enrolledFactors.filter(({uid:St})=>St!==j),yield R.user._updateTokensIfNecessary(Q),yield R.user.reload()}catch(Q){throw Q}})()}}const Hl=new WeakMap;function Ah(z){const D=(0,mt.m9)(z);return Hl.has(D)||Hl.set(D,Md._fromUser(D)),Hl.get(D)}const hs="__sak";class Tc{constructor(D,R){this.storageRetriever=D,this.type=R}_isAvailable(){try{return this.storage?(this.storage.setItem(hs,"1"),this.storage.removeItem(hs),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(D,R){return this.storage.setItem(D,JSON.stringify(R)),Promise.resolve()}_get(D){const R=this.storage.getItem(D);return Promise.resolve(R?JSON.parse(R):null)}_remove(D){return this.storage.removeItem(D),Promise.resolve()}get storage(){return this.storageRetriever()}}const Jo=(()=>{class z extends Tc{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(R,j)=>this.onStorageEvent(R,j),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Xm(){const z=(0,mt.z$)();return Bt(z)||Or(z)}()&&function or(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=ji(),this._shouldAllowMigration=!0}forAllChangedKeys(R){for(const j of Object.keys(this.listeners)){const G=this.storage.getItem(j),Q=this.localCache[j];G!==Q&&R(j,Q,G)}}onStorageEvent(R,j=!1){if(!R.key)return void this.forAllChangedKeys((jt,He,un)=>{this.notifyListeners(jt,un)});const G=R.key;if(j?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const jt=this.storage.getItem(G);if(R.newValue!==jt)null!==R.newValue?this.storage.setItem(G,R.newValue):this.storage.removeItem(G);else if(this.localCache[G]===R.newValue&&!j)return}const Q=()=>{const jt=this.storage.getItem(G);!j&&this.localCache[G]===jt||this.notifyListeners(G,jt)},St=this.storage.getItem(G);!function ir(){return(0,mt.w1)()&&10===document.documentMode}()||St===R.newValue||R.newValue===R.oldValue?Q():setTimeout(Q,10)}notifyListeners(R,j){this.localCache[R]=j;const G=this.listeners[R];if(G)for(const Q of Array.from(G))Q(j&&JSON.parse(j))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((R,j,G)=>{this.onStorageEvent(new StorageEvent("storage",{key:R,oldValue:j,newValue:G}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(R,j){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[R]||(this.listeners[R]=new Set,this.localCache[R]=this.storage.getItem(R)),this.listeners[R].add(j)}_removeListener(R,j){this.listeners[R]&&(this.listeners[R].delete(j),0===this.listeners[R].size&&delete this.listeners[R]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(R,j){var G=()=>super._set,Q=this;return(0,M.Z)(function*(){yield G().call(Q,R,j),Q.localCache[R]=JSON.stringify(j)})()}_get(R){var j=()=>super._get,G=this;return(0,M.Z)(function*(){const Q=yield j().call(G,R);return G.localCache[R]=JSON.stringify(Q),Q})()}_remove(R){var j=()=>super._remove,G=this;return(0,M.Z)(function*(){yield j().call(G,R),delete G.localCache[R]})()}}return z.type="LOCAL",z})(),yu=(()=>{class z extends Tc{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(R,j){}_removeListener(R,j){}}return z.type="SESSION",z})();let ua=(()=>{class z{constructor(R){this.eventTarget=R,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(R){const j=this.receivers.find(Q=>Q.isListeningto(R));if(j)return j;const G=new z(R);return this.receivers.push(G),G}isListeningto(R){return this.eventTarget===R}handleEvent(R){var j=this;return(0,M.Z)(function*(){const G=R,{eventId:Q,eventType:St,data:jt}=G.data,He=j.handlersMap[St];if(!He?.size)return;G.ports[0].postMessage({status:"ack",eventId:Q,eventType:St});const un=Array.from(He).map(function(){var ti=(0,M.Z)(function*(ns){return ns(G.origin,jt)});return function(ns){return ti.apply(this,arguments)}}()),sn=yield function vu(z){return Promise.all(z.map(function(){var D=(0,M.Z)(function*(R){try{return{fulfilled:!0,value:yield R}}catch(j){return{fulfilled:!1,reason:j}}});return function(R){return D.apply(this,arguments)}}()))}(un);G.ports[0].postMessage({status:"done",eventId:Q,eventType:St,response:sn})})()}_subscribe(R,j){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[R]||(this.handlersMap[R]=new Set),this.handlersMap[R].add(j)}_unsubscribe(R,j){this.handlersMap[R]&&j&&this.handlersMap[R].delete(j),(!j||0===this.handlersMap[R].size)&&delete this.handlersMap[R],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return z.receivers=[],z})();function Ic(z="",D=10){let R="";for(let j=0;j<D;j++)R+=Math.floor(10*Math.random());return z+R}class gw{constructor(D){this.target=D,this.handlers=new Set}removeMessageHandler(D){D.messageChannel&&(D.messageChannel.port1.removeEventListener("message",D.onMessage),D.messageChannel.port1.close()),this.handlers.delete(D)}_send(D,R,j=50){var G=this;return(0,M.Z)(function*(){const Q=typeof MessageChannel<"u"?new MessageChannel:null;if(!Q)throw new Error("connection_unavailable");let St,jt;return new Promise((He,un)=>{const sn=Ic("",20);Q.port1.start();const ti=setTimeout(()=>{un(new Error("unsupported_event"))},j);jt={messageChannel:Q,onMessage(ns){const gs=ns;if(gs.data.eventId===sn)switch(gs.data.status){case"ack":clearTimeout(ti),St=setTimeout(()=>{un(new Error("timeout"))},3e3);break;case"done":clearTimeout(St),He(gs.data.response);break;default:clearTimeout(ti),clearTimeout(St),un(new Error("invalid_response"))}}},G.handlers.add(jt),Q.port1.addEventListener("message",jt.onMessage),G.target.postMessage({eventType:D,eventId:sn,data:R},[Q.port2])}).finally(()=>{jt&&G.removeMessageHandler(jt)})})()}}function mo(){return window}function Jf(){return typeof mo().WorkerGlobalScope<"u"&&"function"==typeof mo().importScripts}function Pd(){return(Pd=(0,M.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const No="firebaseLocalStorageDb",xo="firebaseLocalStorage",ep="fbase_key";class xu{constructor(D){this.request=D}toPromise(){return new Promise((D,R)=>{this.request.addEventListener("success",()=>{D(this.request.result)}),this.request.addEventListener("error",()=>{R(this.request.error)})})}}function Dh(z,D){return z.transaction([xo],D?"readwrite":"readonly").objectStore(xo)}function Ed(){const z=indexedDB.open(No,1);return new Promise((D,R)=>{z.addEventListener("error",()=>{R(z.error)}),z.addEventListener("upgradeneeded",()=>{const j=z.result;try{j.createObjectStore(xo,{keyPath:ep})}catch(G){R(G)}}),z.addEventListener("success",(0,M.Z)(function*(){const j=z.result;j.objectStoreNames.contains(xo)?D(j):(j.close(),yield function Wy(){const z=indexedDB.deleteDatabase(No);return new xu(z).toPromise()}(),D(yield Ed()))}))})}function wu(z,D,R){return Sc.apply(this,arguments)}function Sc(){return(Sc=(0,M.Z)(function*(z,D,R){const j=Dh(z,!0).put({[ep]:D,value:R});return new xu(j).toPromise()})).apply(this,arguments)}function Ks(){return(Ks=(0,M.Z)(function*(z,D){const R=Dh(z,!1).get(D),j=yield new xu(R).toPromise();return void 0===j?null:j.value})).apply(this,arguments)}function Jm(z,D){const R=Dh(z,!0).delete(D);return new xu(R).toPromise()}const _g=(()=>{class z{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var R=this;return(0,M.Z)(function*(){return R.db||(R.db=yield Ed()),R.db})()}_withRetries(R){var j=this;return(0,M.Z)(function*(){let G=0;for(;;)try{const Q=yield j._openDb();return yield R(Q)}catch(Q){if(G++>3)throw Q;j.db&&(j.db.close(),j.db=void 0)}})()}initializeServiceWorkerMessaging(){var R=this;return(0,M.Z)(function*(){return Jf()?R.initializeReceiver():R.initializeSender()})()}initializeReceiver(){var R=this;return(0,M.Z)(function*(){R.receiver=ua._getInstance(function bu(){return Jf()?self:null}()),R.receiver._subscribe("keyChanged",function(){var j=(0,M.Z)(function*(G,Q){return{keyProcessed:(yield R._poll()).includes(Q.key)}});return function(G,Q){return j.apply(this,arguments)}}()),R.receiver._subscribe("ping",function(){var j=(0,M.Z)(function*(G,Q){return["keyChanged"]});return function(G,Q){return j.apply(this,arguments)}}())})()}initializeSender(){var R=this;return(0,M.Z)(function*(){var j,G;if(R.activeServiceWorker=yield function tp(){return Pd.apply(this,arguments)}(),!R.activeServiceWorker)return;R.sender=new gw(R.activeServiceWorker);const Q=yield R.sender._send("ping",{},800);Q&&null!==(j=Q[0])&&void 0!==j&&j.fulfilled&&null!==(G=Q[0])&&void 0!==G&&G.value.includes("keyChanged")&&(R.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(R){var j=this;return(0,M.Z)(function*(){if(j.sender&&j.activeServiceWorker&&function Wa(){var z;return(null===(z=navigator?.serviceWorker)||void 0===z?void 0:z.controller)||null}()===j.activeServiceWorker)try{yield j.sender._send("keyChanged",{key:R},j.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,M.Z)(function*(){try{if(!indexedDB)return!1;const R=yield Ed();return yield wu(R,hs,"1"),yield Jm(R,hs),!0}catch{}return!1})()}_withPendingWrite(R){var j=this;return(0,M.Z)(function*(){j.pendingWrites++;try{yield R()}finally{j.pendingWrites--}})()}_set(R,j){var G=this;return(0,M.Z)(function*(){return G._withPendingWrite((0,M.Z)(function*(){return yield G._withRetries(Q=>wu(Q,R,j)),G.localCache[R]=j,G.notifyServiceWorker(R)}))})()}_get(R){var j=this;return(0,M.Z)(function*(){const G=yield j._withRetries(Q=>function Qm(z,D){return Ks.apply(this,arguments)}(Q,R));return j.localCache[R]=G,G})()}_remove(R){var j=this;return(0,M.Z)(function*(){return j._withPendingWrite((0,M.Z)(function*(){return yield j._withRetries(G=>Jm(G,R)),delete j.localCache[R],j.notifyServiceWorker(R)}))})()}_poll(){var R=this;return(0,M.Z)(function*(){const j=yield R._withRetries(St=>{const jt=Dh(St,!1).getAll();return new xu(jt).toPromise()});if(!j)return[];if(0!==R.pendingWrites)return[];const G=[],Q=new Set;for(const{fbase_key:St,value:jt}of j)Q.add(St),JSON.stringify(R.localCache[St])!==JSON.stringify(jt)&&(R.notifyListeners(St,jt),G.push(St));for(const St of Object.keys(R.localCache))R.localCache[St]&&!Q.has(St)&&(R.notifyListeners(St,null),G.push(St));return G})()}notifyListeners(R,j){this.localCache[R]=j;const G=this.listeners[R];if(G)for(const Q of Array.from(G))Q(j)}startPolling(){var R=this;this.stopPolling(),this.pollTimer=setInterval((0,M.Z)(function*(){return R._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(R,j){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[R]||(this.listeners[R]=new Set,this._get(R)),this.listeners[R].add(j)}_removeListener(R,j){this.listeners[R]&&(this.listeners[R].delete(j),0===this.listeners[R].size&&delete this.listeners[R]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return z.type="LOCAL",z})(),kh=1e12;class ip{constructor(D){this.auth=D,this.counter=kh,this._widgets=new Map}render(D,R){const j=this.counter;return this._widgets.set(j,new yg(D,this.auth.name,R||{})),this.counter++,j}reset(D){var R;const j=D||kh;null===(R=this._widgets.get(j))||void 0===R||R.delete(),this._widgets.delete(j)}getResponse(D){var R;return(null===(R=this._widgets.get(D||kh))||void 0===R?void 0:R.getResponse())||""}execute(D){var R=this;return(0,M.Z)(function*(){var j;return null===(j=R._widgets.get(D||kh))||void 0===j||j.execute(),""})()}}class yg{constructor(D,R,j){this.params=j,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const G="string"==typeof D?document.getElementById(D):D;Ct(G,"argument-error",{appName:R}),this.container=G,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function vg(z){const D=[],R="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let j=0;j<z;j++)D.push(R.charAt(Math.floor(62*Math.random())));return D.join("")}(50);const{callback:D,"expired-callback":R}=this.params;if(D)try{D(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,R)try{R()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Rh=zr("rcb"),Ls=new Ne(3e4,6e4);class Td{constructor(){var D;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(D=mo().grecaptcha)||void 0===D||!D.render)}load(D,R=""){return Ct(function Id(z){return z.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(z)}(R),D,"argument-error"),this.shouldResolveImmediately(R)&&vr(mo().grecaptcha)?Promise.resolve(mo().grecaptcha):new Promise((j,G)=>{const Q=mo().setTimeout(()=>{G(tt(D,"network-request-failed"))},Ls.get());mo()[Rh]=()=>{mo().clearTimeout(Q),delete mo()[Rh];const jt=mo().grecaptcha;if(!jt||!vr(jt))return void G(tt(D,"internal-error"));const He=jt.render;jt.render=(un,sn)=>{const ti=He(un,sn);return this.counter++,ti},this.hostLanguage=R,j(jt)},Ti(`https://www.google.com/recaptcha/api.js??${(0,mt.xO)({onload:Rh,render:"explicit",hl:R})}`).catch(()=>{clearTimeout(Q),G(tt(D,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(D){var R;return!(null===(R=mo().grecaptcha)||void 0===R||!R.render)&&(D===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Ca{load(D){return(0,M.Z)(function*(){return new ip(D)})()}clearedOneInstance(){}}const e_="recaptcha",op={theme:"light",type:"image"};class Ky{constructor(D,R=Object.assign({},op),j){this.parameters=R,this.type=e_,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=qi(j),this.isInvisible="invisible"===this.parameters.size,Ct(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const G="string"==typeof D?document.getElementById(D):D;Ct(G,this.auth,"argument-error"),this.container=G,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Ca:new Td,this.validateStartingState()}verify(){var D=this;return(0,M.Z)(function*(){D.assertNotDestroyed();const R=yield D.render(),j=D.getAssertedRecaptcha();return j.getResponse(R)||new Promise(Q=>{const St=jt=>{jt&&(D.tokenChangeListeners.delete(St),Q(jt))};D.tokenChangeListeners.add(St),D.isInvisible&&j.execute(R)})})()}render(){try{this.assertNotDestroyed()}catch(D){return Promise.reject(D)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(D=>{throw this.renderPromise=null,D})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(D=>{this.container.removeChild(D)})}validateStartingState(){Ct(!this.parameters.sitekey,this.auth,"argument-error"),Ct(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Ct(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(D){return R=>{if(this.tokenChangeListeners.forEach(j=>j(R)),"function"==typeof D)D(R);else if("string"==typeof D){const j=mo()[D];"function"==typeof j&&j(R)}}}assertNotDestroyed(){Ct(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var D=this;return(0,M.Z)(function*(){if(yield D.init(),!D.widgetId){let R=D.container;if(!D.isInvisible){const j=document.createElement("div");R.appendChild(j),R=j}D.widgetId=D.getAssertedRecaptcha().render(R,D.parameters)}return D.widgetId})()}init(){var D=this;return(0,M.Z)(function*(){Ct(cs()&&!Jf(),D.auth,"internal-error"),yield function Ac(){let z=null;return new Promise(D=>{"complete"!==document.readyState?(z=()=>D(),window.addEventListener("load",z)):D()}).catch(D=>{throw z&&window.removeEventListener("load",z),D})}(),D.recaptcha=yield D._recaptchaLoader.load(D.auth,D.auth.languageCode||void 0);const R=yield function ne(z){return Vt.apply(this,arguments)}(D.auth);Ct(R,D.auth,"internal-error"),D.parameters.sitekey=R})()}getAssertedRecaptcha(){return Ct(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Dc{constructor(D,R){this.verificationId=D,this.onConfirmation=R}confirm(D){const R=Zr._fromVerification(this.verificationId,D);return this.onConfirmation(R)}}function Ma(z,D,R){return Wr.apply(this,arguments)}function Wr(){return(Wr=(0,M.Z)(function*(z,D,R){const j=qi(z),G=yield Rc(j,D,(0,mt.m9)(R));return new Dc(G,Q=>yl(j,Q))})).apply(this,arguments)}function da(z,D,R){return Ns.apply(this,arguments)}function Ns(){return(Ns=(0,M.Z)(function*(z,D,R){const j=(0,mt.m9)(z);yield Un(!1,j,"phone");const G=yield Rc(j.auth,D,(0,mt.m9)(R));return new Dc(G,Q=>vl(j,Q))})).apply(this,arguments)}function Cu(z,D,R){return kc.apply(this,arguments)}function kc(){return(kc=(0,M.Z)(function*(z,D,R){const j=(0,mt.m9)(z),G=yield Rc(j.auth,D,(0,mt.m9)(R));return new Dc(G,Q=>Ki(j,Q))})).apply(this,arguments)}function Rc(z,D,R){return xl.apply(this,arguments)}function xl(){return xl=(0,M.Z)(function*(z,D,R){var j;const G=yield R.verify();try{let Q;if(Ct("string"==typeof G,z,"argument-error"),Ct(R.type===e_,z,"argument-error"),Q="string"==typeof D?{phoneNumber:D}:D,"session"in Q){const St=Q.session;if("phoneNumber"in Q)return Ct("enroll"===St.type,z,"internal-error"),(yield function Cd(z,D){return he(z,"POST","/v2/accounts/mfaEnrollment:start",_t(z,D))}(z,{idToken:St.credential,phoneEnrollmentInfo:{phoneNumber:Q.phoneNumber,recaptchaToken:G}})).phoneSessionInfo.sessionInfo;{Ct("signin"===St.type,z,"internal-error");const jt=(null===(j=Q.multiFactorHint)||void 0===j?void 0:j.uid)||Q.multiFactorUid;return Ct(jt,z,"missing-multi-factor-info"),(yield function Od(z,D){return he(z,"POST","/v2/accounts/mfaSignIn:start",_t(z,D))}(z,{mfaPendingCredential:St.credential,mfaEnrollmentId:jt,phoneSignInInfo:{recaptchaToken:G}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:St}=yield function Ae(z,D){return br.apply(this,arguments)}(z,{phoneNumber:Q.phoneNumber,recaptchaToken:G});return St}}finally{R._reset()}}),xl.apply(this,arguments)}function n_(z,D){return Mu.apply(this,arguments)}function Mu(){return(Mu=(0,M.Z)(function*(z,D){yield aa((0,mt.m9)(z),D)})).apply(this,arguments)}let Pu=(()=>{class z{constructor(R){this.providerId=z.PROVIDER_ID,this.auth=qi(R)}verifyPhoneNumber(R,j){return Rc(this.auth,R,(0,mt.m9)(j))}static credential(R,j){return Zr._fromVerification(R,j)}static credentialFromResult(R){return z.credentialFromTaggedObject(R)}static credentialFromError(R){return z.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R)return null;const{phoneNumber:j,temporaryProof:G}=R;return j&&G?Zr._fromTokenResponse(j,G):null}}return z.PROVIDER_ID="phone",z.PHONE_SIGN_IN_METHOD="phone",z})();function ql(z,D){return D?le(D):(Ct(z._popupRedirectResolver,z,"argument-error"),z._popupRedirectResolver)}class bg extends ia{constructor(D){super("custom","custom"),this.params=D}_getIdTokenResponse(D){return ho(D,this._buildIdpRequest())}_linkToIdToken(D,R){return ho(D,this._buildIdpRequest(R))}_getReauthenticationResolver(D){return ho(D,this._buildIdpRequest())}_buildIdpRequest(D){const R={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return D&&(R.idToken=D),R}}function ro(z){return la(z.auth,new bg(z),z.bypassAuthState)}function Eu(z){const{auth:D,user:R}=z;return Ct(R,D,"internal-error"),_l(R,new bg(z),z.bypassAuthState)}function Yi(z){return Zl.apply(this,arguments)}function Zl(){return(Zl=(0,M.Z)(function*(z){const{auth:D,user:R}=z;return Ct(R,D,"internal-error"),aa(R,new bg(z),z.bypassAuthState)})).apply(this,arguments)}class Wl{constructor(D,R,j,G,Q=!1){this.auth=D,this.resolver=j,this.user=G,this.bypassAuthState=Q,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(R)?R:[R]}execute(){var D=this;return new Promise(function(){var R=(0,M.Z)(function*(j,G){D.pendingPromise={resolve:j,reject:G};try{D.eventManager=yield D.resolver._initialize(D.auth),yield D.onExecution(),D.eventManager.registerConsumer(D)}catch(Q){D.reject(Q)}});return function(j,G){return R.apply(this,arguments)}}())}onAuthEvent(D){var R=this;return(0,M.Z)(function*(){const{urlResponse:j,sessionId:G,postBody:Q,tenantId:St,error:jt,type:He}=D;if(jt)return void R.reject(jt);const un={auth:R.auth,requestUri:j,sessionId:G,tenantId:St||void 0,postBody:Q||void 0,user:R.user,bypassAuthState:R.bypassAuthState};try{R.resolve(yield R.getIdpTask(He)(un))}catch(sn){R.reject(sn)}})()}onError(D){this.reject(D)}getIdpTask(D){switch(D){case"signInViaPopup":case"signInViaRedirect":return ro;case"linkViaPopup":case"linkViaRedirect":return Yi;case"reauthViaPopup":case"reauthViaRedirect":return Eu;default:me(this.auth,"internal-error")}}resolve(D){en(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(D),this.unregisterAndCleanUp()}reject(D){en(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(D),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const xg=new Ne(2e3,1e4);function Os(z,D,R){return Je.apply(this,arguments)}function Je(){return(Je=(0,M.Z)(function*(z,D,R){const j=qi(z);Ve(z,D,Ws);const G=ql(j,R);return new Yl(j,"signInViaPopup",D,G).executeNotNull()})).apply(this,arguments)}function ts(z,D,R){return Pa.apply(this,arguments)}function Pa(){return(Pa=(0,M.Z)(function*(z,D,R){const j=(0,mt.m9)(z);Ve(j.auth,D,Ws);const G=ql(j.auth,R);return new Yl(j.auth,"reauthViaPopup",D,G,j).executeNotNull()})).apply(this,arguments)}function $r(z,D,R){return Kl.apply(this,arguments)}function Kl(){return(Kl=(0,M.Z)(function*(z,D,R){const j=(0,mt.m9)(z);Ve(j.auth,D,Ws);const G=ql(j.auth,R);return new Yl(j.auth,"linkViaPopup",D,G,j).executeNotNull()})).apply(this,arguments)}let Yl=(()=>{class z extends Wl{constructor(R,j,G,Q,St){super(R,j,Q,St),this.provider=G,this.authWindow=null,this.pollId=null,z.currentPopupAction&&z.currentPopupAction.cancel(),z.currentPopupAction=this}executeNotNull(){var R=this;return(0,M.Z)(function*(){const j=yield R.execute();return Ct(j,R.auth,"internal-error"),j})()}onExecution(){var R=this;return(0,M.Z)(function*(){en(1===R.filter.length,"Popup operations only handle one event");const j=Ic();R.authWindow=yield R.resolver._openPopup(R.auth,R.provider,R.filter[0],j),R.authWindow.associatedEvent=j,R.resolver._originValidation(R.auth).catch(G=>{R.reject(G)}),R.resolver._isIframeWebStorageSupported(R.auth,G=>{G||R.reject(tt(R.auth,"web-storage-unsupported"))}),R.pollUserCancellation()})()}get eventId(){var R;return(null===(R=this.authWindow)||void 0===R?void 0:R.associatedEvent)||null}cancel(){this.reject(tt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,z.currentPopupAction=null}pollUserCancellation(){const R=()=>{var j,G;this.pollId=null!==(G=null===(j=this.authWindow)||void 0===j?void 0:j.window)&&void 0!==G&&G.closed?window.setTimeout(()=>{this.pollId=null,this.reject(tt(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(R,xg.get())};R()}}return z.currentPopupAction=null,z})();const Sd="pendingRedirect",Ts=new Map;class io extends Wl{constructor(D,R,j=!1){super(D,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],R,void 0,j),this.eventId=null}execute(){var D=()=>super.execute,R=this;return(0,M.Z)(function*(){let j=Ts.get(R.auth._key());if(!j){try{const Q=(yield function sp(z,D){return Ya.apply(this,arguments)}(R.resolver,R.auth))?yield D().call(R):null;j=()=>Promise.resolve(Q)}catch(G){j=()=>Promise.reject(G)}Ts.set(R.auth._key(),j)}return R.bypassAuthState||Ts.set(R.auth._key(),()=>Promise.resolve(null)),j()})()}onAuthEvent(D){var R=()=>super.onAuthEvent,j=this;return(0,M.Z)(function*(){if("signInViaRedirect"===D.type)return R().call(j,D);if("unknown"!==D.type){if(D.eventId){const G=yield j.auth._redirectUserForId(D.eventId);if(G)return j.user=G,R().call(j,D);j.resolve(null)}}else j.resolve(null)})()}onExecution(){return(0,M.Z)(function*(){})()}cleanUp(){}}function Ya(){return(Ya=(0,M.Z)(function*(z,D){const R=wg(D),j=r_(z);if(!(yield j._isAvailable()))return!1;const G="true"===(yield j._get(R));return yield j._remove(R),G})).apply(this,arguments)}function Ou(z,D){return Lc.apply(this,arguments)}function Lc(){return(Lc=(0,M.Z)(function*(z,D){return r_(z)._set(wg(D),"true")})).apply(this,arguments)}function Lh(){Ts.clear()}function Ad(z,D){Ts.set(z._key(),D)}function r_(z){return le(z._redirectPersistence)}function wg(z){return xe(Sd,z.config.apiKey,z.name)}function i_(z,D,R){return function Nh(z,D,R){return Fh.apply(this,arguments)}(z,D,R)}function Fh(){return(Fh=(0,M.Z)(function*(z,D,R){const j=qi(z);Ve(z,D,Ws),yield j._initializationPromise;const G=ql(j,R);return yield Ou(G,j),G._openRedirect(j,D,"signInViaRedirect")})).apply(this,arguments)}function ps(z,D,R){return function ap(z,D,R){return ha.apply(this,arguments)}(z,D,R)}function ha(){return(ha=(0,M.Z)(function*(z,D,R){const j=(0,mt.m9)(z);Ve(j.auth,D,Ws),yield j.auth._initializationPromise;const G=ql(j.auth,R);yield Ou(G,j.auth);const Q=yield cp(j);return G._openRedirect(j.auth,D,"reauthViaRedirect",Q)})).apply(this,arguments)}function Xl(z,D,R){return function Dd(z,D,R){return Xa.apply(this,arguments)}(z,D,R)}function Xa(){return(Xa=(0,M.Z)(function*(z,D,R){const j=(0,mt.m9)(z);Ve(j.auth,D,Ws),yield j.auth._initializationPromise;const G=ql(j.auth,R);yield Un(!1,j,D.providerId),yield Ou(G,j.auth);const Q=yield cp(j);return G._openRedirect(j.auth,D,"linkViaRedirect",Q)})).apply(this,arguments)}function kd(z,D){return Qa.apply(this,arguments)}function Qa(){return(Qa=(0,M.Z)(function*(z,D){return yield qi(z)._initializationPromise,lp(z,D,!1)})).apply(this,arguments)}function lp(z,D){return wl.apply(this,arguments)}function wl(){return(wl=(0,M.Z)(function*(z,D,R=!1){const j=qi(z),G=ql(j,D),St=yield new io(j,G,R).execute();return St&&!R&&(delete St.user._redirectEventId,yield j._persistUserIfCurrent(St.user),yield j._setRedirectUser(null,D)),St})).apply(this,arguments)}function cp(z){return Cg.apply(this,arguments)}function Cg(){return(Cg=(0,M.Z)(function*(z){const D=Ic(`${z.uid}:::`);return z._redirectEventId=D,yield z.auth._setRedirectUser(z),yield z.auth._persistUserIfCurrent(z),D})).apply(this,arguments)}class Mg{constructor(D){this.auth=D,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(D){this.consumers.add(D),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,D)&&(this.sendToConsumer(this.queuedRedirectEvent,D),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(D){this.consumers.delete(D)}onEvent(D){if(this.hasEventBeenHandled(D))return!1;let R=!1;return this.consumers.forEach(j=>{this.isEventForConsumer(D,j)&&(R=!0,this.sendToConsumer(D,j),this.saveEventToCache(D))}),this.hasHandledPotentialRedirect||!function up(z){switch(z.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Rd(z);default:return!1}}(D)||(this.hasHandledPotentialRedirect=!0,R||(this.queuedRedirectEvent=D,R=!0)),R}sendToConsumer(D,R){var j;if(D.error&&!Rd(D)){const G=(null===(j=D.error.code)||void 0===j?void 0:j.split("auth/")[1])||"internal-error";R.onError(tt(this.auth,G))}else R.onAuthEvent(D)}isEventForConsumer(D,R){const j=null===R.eventId||!!D.eventId&&D.eventId===R.eventId;return R.filter.includes(D.type)&&j}hasEventBeenHandled(D){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Cl(D))}saveEventToCache(D){this.cachedEventUids.add(Cl(D)),this.lastProcessedEventTime=Date.now()}}function Cl(z){return[z.type,z.eventId,z.sessionId,z.tenantId].filter(D=>D).join("-")}function Rd({type:z,error:D}){return"unknown"===z&&"auth/no-auth-event"===D?.code}function Tu(z){return Ld.apply(this,arguments)}function Ld(){return(Ld=(0,M.Z)(function*(z,D={}){return he(z,"GET","/v1/projects",D)})).apply(this,arguments)}const wo=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zh=/^https?/;function Ea(){return(Ea=(0,M.Z)(function*(z){if(z.config.emulator)return;const{authorizedDomains:D}=yield Tu(z);for(const R of D)try{if(Nd(R))return}catch{}me(z,"unauthorized-domain")})).apply(this,arguments)}function Nd(z){const D=Ui(),{protocol:R,hostname:j}=new URL(D);if(z.startsWith("chrome-extension://")){const St=new URL(z);return""===St.hostname&&""===j?"chrome-extension:"===R&&z.replace("chrome-extension://","")===D.replace("chrome-extension://",""):"chrome-extension:"===R&&St.hostname===j}if(!zh.test(R))return!1;if(wo.test(z))return j===z;const G=z.replace(/\./g,"\\.");return new RegExp("^(.+\\."+G+"|"+G+")$","i").test(j)}const dp=new Ne(3e4,6e4);function Ja(){const z=mo().___jsl;if(z?.H)for(const D of Object.keys(z.H))if(z.H[D].r=z.H[D].r||[],z.H[D].L=z.H[D].L||[],z.H[D].r=[...z.H[D].L],z.CP)for(let R=0;R<z.CP.length;R++)z.CP[R]=null}let Bh=null;const hp=new Ne(5e3,15e3),Su="__/auth/iframe",Nc="emulator/auth/iframe",es={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fa=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Uh(z){const D=z.config;Ct(D.authDomain,z,"auth-domain-config-required");const R=D.emulator?vs(D,Nc):`https://${z.config.authDomain}/${Su}`,j={apiKey:D.apiKey,appName:z.name,v:It.SDK_VERSION},G=fa.get(z.config.apiHost);G&&(j.eid=G);const Q=z._getFrameworks();return Q.length&&(j.fw=Q.join(",")),`${R}?${(0,mt.xO)(j).slice(1)}`}function Ml(){return Ml=(0,M.Z)(function*(z){const D=yield function Pg(z){return Bh=Bh||function Fd(z){return new Promise((D,R)=>{var j,G,Q;function St(){Ja(),gapi.load("gapi.iframes",{callback:()=>{D(gapi.iframes.getContext())},ontimeout:()=>{Ja(),R(tt(z,"network-request-failed"))},timeout:dp.get()})}if(null!==(G=null===(j=mo().gapi)||void 0===j?void 0:j.iframes)&&void 0!==G&&G.Iframe)D(gapi.iframes.getContext());else{if(null===(Q=mo().gapi)||void 0===Q||!Q.load){const jt=zr("iframefcb");return mo()[jt]=()=>{gapi.load?St():R(tt(z,"network-request-failed"))},Ti(`https://apis.google.com/js/api.js?onload=${jt}`).catch(He=>R(He))}St()}}).catch(D=>{throw Bh=null,D})}(z),Bh}(z),R=mo().gapi;return Ct(R,z,"internal-error"),D.open({where:document.body,url:Uh(z),messageHandlersFilter:R.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:es,dontclear:!0},j=>new Promise(function(){var G=(0,M.Z)(function*(Q,St){yield j.restyle({setHideOnLeave:!1});const jt=tt(z,"network-request-failed"),He=mo().setTimeout(()=>{St(jt)},hp.get());function un(){mo().clearTimeout(He),Q(j)}j.ping(un).then(un,()=>{St(jt)})});return function(Q,St){return G.apply(this,arguments)}}()))}),Ml.apply(this,arguments)}const Fo={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class zd{constructor(D){this.window=D,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const V="__/auth/handler",W="emulator/auth/handler",ut=encodeURIComponent("fac");function Mt(z,D,R,j,G,Q){return Lt.apply(this,arguments)}function Lt(){return(Lt=(0,M.Z)(function*(z,D,R,j,G,Q){Ct(z.config.authDomain,z,"auth-domain-config-required"),Ct(z.config.apiKey,z,"invalid-api-key");const St={apiKey:z.config.apiKey,appName:z.name,authType:R,redirectUrl:j,v:It.SDK_VERSION,eventId:G};if(D instanceof Ws){D.setDefaultLanguage(z.languageCode),St.providerId=D.providerId||"",(0,mt.xb)(D.getCustomParameters())||(St.customParameters=JSON.stringify(D.getCustomParameters()));for(const[sn,ti]of Object.entries(Q||{}))St[sn]=ti}if(D instanceof Cc){const sn=D.getScopes().filter(ti=>""!==ti);sn.length>0&&(St.scopes=sn.join(","))}z.tenantId&&(St.tid=z.tenantId);const jt=St;for(const sn of Object.keys(jt))void 0===jt[sn]&&delete jt[sn];const He=yield z._getAppCheckToken(),un=He?`#${ut}=${encodeURIComponent(He)}`:"";return`${function se({config:z}){return z.emulator?vs(z,W):`https://${z.authDomain}/${V}`}(z)}?${(0,mt.xO)(jt).slice(1)}${un}`})).apply(this,arguments)}const on="webStorageSupport",xn=class nn{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yu,this._completeRedirectFn=lp,this._overrideRedirectResult=Ad}_openPopup(D,R,j,G){var Q=this;return(0,M.Z)(function*(){var St;en(null===(St=Q.eventManagers[D._key()])||void 0===St?void 0:St.manager,"_initialize() not called before _openPopup()");const jt=yield Mt(D,R,j,Ui(),G);return function nc(z,D,R,j=500,G=600){const Q=Math.max((window.screen.availHeight-G)/2,0).toString(),St=Math.max((window.screen.availWidth-j)/2,0).toString();let jt="";const He=Object.assign(Object.assign({},Fo),{width:j.toString(),height:G.toString(),top:Q,left:St}),un=(0,mt.z$)().toLowerCase();R&&(jt=kt(un)?"_blank":R),ht(un)&&(D=D||"http://localhost",He.scrollbars="yes");const sn=Object.entries(He).reduce((ns,[gs,jh])=>`${ns}${gs}=${jh},`,"");if(function Pr(z=(0,mt.z$)()){var D;return Or(z)&&!(null===(D=window.navigator)||void 0===D||!D.standalone)}(un)&&"_self"!==jt)return function U(z,D){const R=document.createElement("a");R.href=z,R.target=D;const j=document.createEvent("MouseEvent");j.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),R.dispatchEvent(j)}(D||"",jt),new zd(null);const ti=window.open(D||"",jt,sn);Ct(ti,z,"popup-blocked");try{ti.focus()}catch{}return new zd(ti)}(D,jt,Ic())})()}_openRedirect(D,R,j,G){var Q=this;return(0,M.Z)(function*(){return yield Q._originValidation(D),function Es(z){mo().location.href=z}(yield Mt(D,R,j,Ui(),G)),new Promise(()=>{})})()}_initialize(D){const R=D._key();if(this.eventManagers[R]){const{manager:G,promise:Q}=this.eventManagers[R];return G?Promise.resolve(G):(en(Q,"If manager is not set, promise should be"),Q)}const j=this.initAndGetManager(D);return this.eventManagers[R]={promise:j},j.catch(()=>{delete this.eventManagers[R]}),j}initAndGetManager(D){var R=this;return(0,M.Z)(function*(){const j=yield function Ql(z){return Ml.apply(this,arguments)}(D),G=new Mg(D);return j.register("authEvent",Q=>(Ct(Q?.authEvent,D,"invalid-auth-event"),{status:G.onEvent(Q.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),R.eventManagers[D._key()]={manager:G},R.iframes[D._key()]=j,G})()}_isIframeWebStorageSupported(D,R){this.iframes[D._key()].send(on,{type:on},G=>{var Q;const St=null===(Q=G?.[0])||void 0===Q?void 0:Q[on];void 0!==St&&R(!!St),me(D,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(D){const R=D._key();return this.originValidationPromises[R]||(this.originValidationPromises[R]=function Iu(z){return Ea.apply(this,arguments)}(D)),this.originValidationPromises[R]}get _shouldInitProactively(){return ji()||Bt()||Or()}};class mr{constructor(D){this.factorId=D}_process(D,R,j){switch(R.type){case"enroll":return this._finalizeEnroll(D,R.credential,j);case"signin":return this._finalizeSignIn(D,R.credential);default:return ge("unexpected MultiFactorSessionType")}}}class hr extends mr{constructor(D){super("phone"),this.credential=D}static _fromCredential(D){return new hr(D)}_finalizeEnroll(D,R,j){return function Sh(z,D){return he(z,"POST","/v2/accounts/mfaEnrollment:finalize",_t(z,D))}(D,{idToken:R,displayName:j,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(D,R){return function fs(z,D){return he(z,"POST","/v2/accounts/mfaSignIn:finalize",_t(z,D))}(D,{mfaPendingCredential:R,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let mi=(()=>{class z{constructor(){}static assertion(R){return hr._fromCredential(R)}}return z.FACTOR_ID="phone",z})();var Zo="@firebase/auth";class Au{constructor(D){this.auth=D,this.internalListeners=new Map}getUid(){var D;return this.assertAuthConfigured(),(null===(D=this.auth.currentUser)||void 0===D?void 0:D.uid)||null}getToken(D){var R=this;return(0,M.Z)(function*(){return R.assertAuthConfigured(),yield R.auth._initializationPromise,R.auth.currentUser?{accessToken:yield R.auth.currentUser.getIdToken(D)}:null})()}addAuthTokenListener(D){if(this.assertAuthConfigured(),this.internalListeners.has(D))return;const R=this.auth.onIdTokenChanged(j=>{D(j?.stsTokenManager.accessToken||null)});this.internalListeners.set(D,R),this.updateProactiveRefresh()}removeAuthTokenListener(D){this.assertAuthConfigured();const R=this.internalListeners.get(D);R&&(this.internalListeners.delete(D),R(),this.updateProactiveRefresh())}assertAuthConfigured(){Ct(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Eg=(0,mt.Pz)("authIdTokenMaxAge")||300;let o_=null;const Xs=z=>function(){var D=(0,M.Z)(function*(R){const j=R&&(yield R.getIdTokenResult()),G=j&&((new Date).getTime()-Date.parse(j.issuedAtTime))/1e3;if(G&&G>Eg)return;const Q=j?.token;o_!==Q&&(o_=Q,yield fetch(z,{method:Q?"POST":"DELETE",headers:Q?{Authorization:`Bearer ${Q}`}:{}}))});return function(R){return D.apply(this,arguments)}}();function s_(z=(0,It.getApp)()){const D=(0,It._getProvider)(z,"auth");if(D.isInitialized())return D.getImmediate();const R=function Ua(z,D){const R=(0,It._getProvider)(z,"auth");if(R.isInitialized()){const G=R.getImmediate(),Q=R.getOptions();if((0,mt.vZ)(Q,D??{}))return G;me(G,"already-initialized")}return R.initialize({options:D})}(z,{popupRedirectResolver:xn,persistence:[_g,Jo,yu]}),j=(0,mt.Pz)("authTokenSyncURL");if(j){const Q=Xs(j);(function Yf(z,D,R){(0,mt.m9)(z).beforeAuthStateChanged(D,R)})(R,Q,()=>Q(R.currentUser)),function xd(z,D,R,j){(0,mt.m9)(z).onIdTokenChanged(D,R,j)}(R,St=>Q(St))}const G=(0,mt.q4)("auth");return G&&dd(R,`http://${G}`),R}!function tl(z){(0,It._registerComponent)(new ye.wA("auth",(D,{options:R})=>{const j=D.getProvider("app").getImmediate(),G=D.getProvider("heartbeat"),Q=D.getProvider("app-check-internal"),{apiKey:St,authDomain:jt}=j.options;Ct(St&&!St.includes(":"),"invalid-api-key",{appName:j.name});const He={apiKey:St,authDomain:jt,clientPlatform:z,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qs(z)},un=new ml(j,G,Q,He);return function ud(z,D){const R=D?.persistence||[],j=(Array.isArray(R)?R:[R]).map(le);D?.errorMap&&z._updateErrorMap(D.errorMap),z._initializeWithPersistence(j,D?.popupRedirectResolver)}(un,R),un},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((D,R,j)=>{D.getProvider("auth-internal").initialize()})),(0,It._registerComponent)(new ye.wA("auth-internal",D=>{const R=qi(D.getProvider("auth").getImmediate());return new Au(R)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,It.registerVersion)(Zo,"0.23.2",function Vh(z){switch(z){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(z)),(0,It.registerVersion)(Zo,"0.23.2","esm2017")}("Browser")},229:(Hn,we,ft)=>{"use strict";ft.d(we,{$s:()=>le,BH:()=>Xt,L:()=>be,LL:()=>Ue,P0:()=>Ce,Pz:()=>tt,Sg:()=>Ve,UG:()=>ge,US:()=>ye,ZB:()=>Yt,ZR:()=>he,aH:()=>me,b$:()=>cs,eu:()=>Kt,hl:()=>Wt,jU:()=>en,m9:()=>xe,ne:()=>ur,pd:()=>Ie,q4:()=>Fn,r3:()=>nt,ru:()=>Ui,tV:()=>Pt,uI:()=>Ct,vZ:()=>Pe,w1:()=>us,xO:()=>Xe,xb:()=>Qt,z$:()=>Gt,zI:()=>pe,zd:()=>Ze});const vt=function(it){const at=[];let ht=0;for(let Bt=0;Bt<it.length;Bt++){let kt=it.charCodeAt(Bt);kt<128?at[ht++]=kt:kt<2048?(at[ht++]=kt>>6|192,at[ht++]=63&kt|128):55296==(64512&kt)&&Bt+1<it.length&&56320==(64512&it.charCodeAt(Bt+1))?(kt=65536+((1023&kt)<<10)+(1023&it.charCodeAt(++Bt)),at[ht++]=kt>>18|240,at[ht++]=kt>>12&63|128,at[ht++]=kt>>6&63|128,at[ht++]=63&kt|128):(at[ht++]=kt>>12|224,at[ht++]=kt>>6&63|128,at[ht++]=63&kt|128)}return at},ye={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(it,at){if(!Array.isArray(it))throw Error("encodeByteArray takes an array as a parameter");this.init_();const ht=at?this.byteToCharMapWebSafe_:this.byteToCharMap_,Bt=[];for(let kt=0;kt<it.length;kt+=3){const ee=it[kt],Ke=kt+1<it.length,Nn=Ke?it[kt+1]:0,yr=kt+2<it.length,Or=yr?it[kt+2]:0;let ir=(15&Nn)<<2|Or>>6,ji=63&Or;yr||(ji=64,Ke||(ir=64)),Bt.push(ht[ee>>2],ht[(3&ee)<<4|Nn>>4],ht[ir],ht[ji])}return Bt.join("")},encodeString(it,at){return this.HAS_NATIVE_SUPPORT&&!at?btoa(it):this.encodeByteArray(vt(it),at)},decodeString(it,at){return this.HAS_NATIVE_SUPPORT&&!at?atob(it):function(it){const at=[];let ht=0,Bt=0;for(;ht<it.length;){const kt=it[ht++];if(kt<128)at[Bt++]=String.fromCharCode(kt);else if(kt>191&&kt<224){const ee=it[ht++];at[Bt++]=String.fromCharCode((31&kt)<<6|63&ee)}else if(kt>239&&kt<365){const yr=((7&kt)<<18|(63&it[ht++])<<12|(63&it[ht++])<<6|63&it[ht++])-65536;at[Bt++]=String.fromCharCode(55296+(yr>>10)),at[Bt++]=String.fromCharCode(56320+(1023&yr))}else{const ee=it[ht++],Ke=it[ht++];at[Bt++]=String.fromCharCode((15&kt)<<12|(63&ee)<<6|63&Ke)}}return at.join("")}(this.decodeStringToByteArray(it,at))},decodeStringToByteArray(it,at){this.init_();const ht=at?this.charToByteMapWebSafe_:this.charToByteMap_,Bt=[];for(let kt=0;kt<it.length;){const ee=ht[it.charAt(kt++)],Nn=kt<it.length?ht[it.charAt(kt)]:0;++kt;const Or=kt<it.length?ht[it.charAt(kt)]:64;++kt;const Pr=kt<it.length?ht[it.charAt(kt)]:64;if(++kt,null==ee||null==Nn||null==Or||null==Pr)throw new ke;Bt.push(ee<<2|Nn>>4),64!==Or&&(Bt.push(Nn<<4&240|Or>>2),64!==Pr&&Bt.push(Or<<6&192|Pr))}return Bt},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let it=0;it<this.ENCODED_VALS.length;it++)this.byteToCharMap_[it]=this.ENCODED_VALS.charAt(it),this.charToByteMap_[this.byteToCharMap_[it]]=it,this.byteToCharMapWebSafe_[it]=this.ENCODED_VALS_WEBSAFE.charAt(it),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[it]]=it,it>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(it)]=it,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(it)]=it)}}};class ke extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const be=function(it){return function(it){const at=vt(it);return ye.encodeByteArray(at,!0)}(it).replace(/\./g,"")},Pt=function(it){try{return ye.decodeString(it,!0)}catch(at){console.error("base64Decode failed: ",at)}return null};function Yt(it,at){if(!(at instanceof Object))return at;switch(at.constructor){case Date:return new Date(at.getTime());case Object:void 0===it&&(it={});break;case Array:it=[];break;default:return at}for(const ht in at)!at.hasOwnProperty(ht)||!Le(ht)||(it[ht]=Yt(it[ht],at[ht]));return it}function Le(it){return"__proto__"!==it}const Te=()=>{try{return function re(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const it=process.env.__FIREBASE_DEFAULTS__;return it?JSON.parse(it):void 0})()||(()=>{if(typeof document>"u")return;let it;try{it=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const at=it&&Pt(it[1]);return at&&JSON.parse(at)})()}catch(it){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${it}`)}},Fn=it=>{var at,ht;return null===(ht=null===(at=Te())||void 0===at?void 0:at.emulatorHosts)||void 0===ht?void 0:ht[it]},Ce=it=>{const at=Fn(it);if(!at)return;const ht=at.lastIndexOf(":");if(ht<=0||ht+1===at.length)throw new Error(`Invalid host ${at} with no separate hostname and port!`);const Bt=parseInt(at.substring(ht+1),10);return"["===at[0]?[at.substring(1,ht-1),Bt]:[at.substring(0,ht),Bt]},me=()=>{var it;return null===(it=Te())||void 0===it?void 0:it.config},tt=it=>{var at;return null===(at=Te())||void 0===at?void 0:at[`_${it}`]};class Xt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((at,ht)=>{this.resolve=at,this.reject=ht})}wrapCallback(at){return(ht,Bt)=>{ht?this.reject(ht):this.resolve(Bt),"function"==typeof at&&(this.promise.catch(()=>{}),1===at.length?at(ht):at(ht,Bt))}}}function Ve(it,at){if(it.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const Bt=at||"demo-project",kt=it.iat||0,ee=it.sub||it.user_id;if(!ee)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Ke=Object.assign({iss:`https://securetoken.google.com/${Bt}`,aud:Bt,iat:kt,exp:kt+3600,auth_time:kt,sub:ee,user_id:ee,firebase:{sign_in_provider:"custom",identities:{}}},it);return[be(JSON.stringify({alg:"none",type:"JWT"})),be(JSON.stringify(Ke)),""].join(".")}function Gt(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ct(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Gt())}function ge(){var it;const at=null===(it=Te())||void 0===it?void 0:it.forceEnvironment;if("node"===at)return!0;if("browser"===at)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function en(){return"object"==typeof self&&self.self===self}function Ui(){const it="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof it&&void 0!==it.id}function cs(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function us(){const it=Gt();return it.indexOf("MSIE ")>=0||it.indexOf("Trident/")>=0}function Wt(){try{return"object"==typeof indexedDB}catch{return!1}}function Kt(){return new Promise((it,at)=>{try{let ht=!0;const Bt="validate-browser-context-for-indexeddb-analytics-module",kt=self.indexedDB.open(Bt);kt.onsuccess=()=>{kt.result.close(),ht||self.indexedDB.deleteDatabase(Bt),it(!0)},kt.onupgradeneeded=()=>{ht=!1},kt.onerror=()=>{var ee;at((null===(ee=kt.error)||void 0===ee?void 0:ee.message)||"")}}catch(ht){at(ht)}})}function pe(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class he extends Error{constructor(at,ht,Bt){super(ht),this.code=at,this.customData=Bt,this.name="FirebaseError",Object.setPrototypeOf(this,he.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ue.prototype.create)}}class Ue{constructor(at,ht,Bt){this.service=at,this.serviceName=ht,this.errors=Bt}create(at,...ht){const Bt=ht[0]||{},kt=`${this.service}/${at}`,ee=this.errors[at],Ke=ee?function In(it,at){return it.replace(qr,(ht,Bt)=>{const kt=at[Bt];return null!=kt?String(kt):`<${Bt}?>`})}(ee,Bt):"Error";return new he(kt,`${this.serviceName}: ${Ke} (${kt}).`,Bt)}}const qr=/\{\$([^}]+)}/g;function nt(it,at){return Object.prototype.hasOwnProperty.call(it,at)}function Qt(it){for(const at in it)if(Object.prototype.hasOwnProperty.call(it,at))return!1;return!0}function Pe(it,at){if(it===at)return!0;const ht=Object.keys(it),Bt=Object.keys(at);for(const kt of ht){if(!Bt.includes(kt))return!1;const ee=it[kt],Ke=at[kt];if(Ge(ee)&&Ge(Ke)){if(!Pe(ee,Ke))return!1}else if(ee!==Ke)return!1}for(const kt of Bt)if(!ht.includes(kt))return!1;return!0}function Ge(it){return null!==it&&"object"==typeof it}function Xe(it){const at=[];for(const[ht,Bt]of Object.entries(it))Array.isArray(Bt)?Bt.forEach(kt=>{at.push(encodeURIComponent(ht)+"="+encodeURIComponent(kt))}):at.push(encodeURIComponent(ht)+"="+encodeURIComponent(Bt));return at.length?"&"+at.join("&"):""}function Ze(it){const at={};return it.replace(/^\?/,"").split("&").forEach(Bt=>{if(Bt){const[kt,ee]=Bt.split("=");at[decodeURIComponent(kt)]=decodeURIComponent(ee)}}),at}function Ie(it){const at=it.indexOf("?");if(!at)return"";const ht=it.indexOf("#",at);return it.substring(at,ht>0?ht:void 0)}function ur(it,at){const ht=new yn(it,at);return ht.subscribe.bind(ht)}class yn{constructor(at,ht){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=ht,this.task.then(()=>{at(this)}).catch(Bt=>{this.error(Bt)})}next(at){this.forEachObserver(ht=>{ht.next(at)})}error(at){this.forEachObserver(ht=>{ht.error(at)}),this.close(at)}complete(){this.forEachObserver(at=>{at.complete()}),this.close()}subscribe(at,ht,Bt){let kt;if(void 0===at&&void 0===ht&&void 0===Bt)throw new Error("Missing Observer.");kt=function Xr(it,at){if("object"!=typeof it||null===it)return!1;for(const ht of at)if(ht in it&&"function"==typeof it[ht])return!0;return!1}(at,["next","error","complete"])?at:{next:at,error:ht,complete:Bt},void 0===kt.next&&(kt.next=Sn),void 0===kt.error&&(kt.error=Sn),void 0===kt.complete&&(kt.complete=Sn);const ee=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?kt.error(this.finalError):kt.complete()}catch{}}),this.observers.push(kt),ee}unsubscribeOne(at){void 0===this.observers||void 0===this.observers[at]||(delete this.observers[at],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(at){if(!this.finalized)for(let ht=0;ht<this.observers.length;ht++)this.sendOne(ht,at)}sendOne(at,ht){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[at])try{ht(this.observers[at])}catch(Bt){typeof console<"u"&&console.error&&console.error(Bt)}})}close(at){this.finalized||(this.finalized=!0,void 0!==at&&(this.finalError=at),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Sn(){}const ds=1e3,Ft=2,Ht=144e5,te=.5;function le(it,at=ds,ht=Ft){const Bt=at*Math.pow(ht,it),kt=Math.round(te*Bt*(Math.random()-.5)*2);return Math.min(Ht,Bt+kt)}function xe(it){return it&&it._delegate?it._delegate:it}},1505:(Hn,we,ft)=>{"use strict";var M=ft(8926);let mt=null;function It(){return mt}class lt{}const ye=new M.OlP("DocumentToken");let ke=(()=>{class o{historyGo(i){throw new Error("Not implemented")}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:function(){return(0,M.f3M)(be)},providedIn:"platform"})}return o})();const ue=new M.OlP("Location Initialized");let be=(()=>{class o extends ke{constructor(){super(),this._doc=(0,M.f3M)(ye),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return It().getBaseHref(this._doc)}onPopState(i){const a=It().getGlobalEventTarget(this._doc,"window");return a.addEventListener("popstate",i,!1),()=>a.removeEventListener("popstate",i)}onHashChange(i){const a=It().getGlobalEventTarget(this._doc,"window");return a.addEventListener("hashchange",i,!1),()=>a.removeEventListener("hashchange",i)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(i){this._location.pathname=i}pushState(i,a,h){this._history.pushState(i,a,h)}replaceState(i,a,h){this._history.replaceState(i,a,h)}forward(){this._history.forward()}back(){this._history.back()}historyGo(i=0){this._history.go(i)}getState(){return this._history.state}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:function(){return new o},providedIn:"platform"})}return o})();function Pt(o,n){if(0==o.length)return n;if(0==n.length)return o;let i=0;return o.endsWith("/")&&i++,n.startsWith("/")&&i++,2==i?o+n.substring(1):1==i?o+n:o+"/"+n}function Et(o){const n=o.match(/#|\?|$/),i=n&&n.index||o.length;return o.slice(0,i-("/"===o[i-1]?1:0))+o.slice(i)}function Yt(o){return o&&"?"!==o[0]?"?"+o:o}let Le=(()=>{class o{historyGo(i){throw new Error("Not implemented")}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:function(){return(0,M.f3M)(tn)},providedIn:"root"})}return o})();const re=new M.OlP("appBaseHref");let tn=(()=>{class o extends Le{constructor(i,a){super(),this._platformLocation=i,this._removeListenerFns=[],this._baseHref=a??this._platformLocation.getBaseHrefFromDOM()??(0,M.f3M)(ye).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}prepareExternalUrl(i){return Pt(this._baseHref,i)}path(i=!1){const a=this._platformLocation.pathname+Yt(this._platformLocation.search),h=this._platformLocation.hash;return h&&i?`${a}${h}`:a}pushState(i,a,h,_){const x=this.prepareExternalUrl(h+Yt(_));this._platformLocation.pushState(i,a,x)}replaceState(i,a,h,_){const x=this.prepareExternalUrl(h+Yt(_));this._platformLocation.replaceState(i,a,x)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(i=0){this._platformLocation.historyGo?.(i)}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(ke),M.LFG(re,8))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),We=(()=>{class o extends Le{constructor(i,a){super(),this._platformLocation=i,this._baseHref="",this._removeListenerFns=[],null!=a&&(this._baseHref=a)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}path(i=!1){let a=this._platformLocation.hash;return null==a&&(a="#"),a.length>0?a.substring(1):a}prepareExternalUrl(i){const a=Pt(this._baseHref,i);return a.length>0?"#"+a:a}pushState(i,a,h,_){let x=this.prepareExternalUrl(h+Yt(_));0==x.length&&(x=this._platformLocation.pathname),this._platformLocation.pushState(i,a,x)}replaceState(i,a,h,_){let x=this.prepareExternalUrl(h+Yt(_));0==x.length&&(x=this._platformLocation.pathname),this._platformLocation.replaceState(i,a,x)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(i=0){this._platformLocation.historyGo?.(i)}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(ke),M.LFG(re,8))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})(),rn=(()=>{class o{constructor(i){this._subject=new M.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=i;const a=this._locationStrategy.getBaseHref();this._basePath=function me(o){if(new RegExp("^(https?:)?//").test(o)){const[,i]=o.split(/\/\/[^\/]+/);return i}return o}(Et(Ce(a))),this._locationStrategy.onPopState(h=>{this._subject.emit({url:this.path(!0),pop:!0,state:h.state,type:h.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(i=!1){return this.normalize(this._locationStrategy.path(i))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(i,a=""){return this.path()==this.normalize(i+Yt(a))}normalize(i){return o.stripTrailingSlash(function Fn(o,n){if(!o||!n.startsWith(o))return n;const i=n.substring(o.length);return""===i||["/",";","?","#"].includes(i[0])?i:n}(this._basePath,Ce(i)))}prepareExternalUrl(i){return i&&"/"!==i[0]&&(i="/"+i),this._locationStrategy.prepareExternalUrl(i)}go(i,a="",h=null){this._locationStrategy.pushState(h,"",i,a),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+Yt(a)),h)}replaceState(i,a="",h=null){this._locationStrategy.replaceState(h,"",i,a),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+Yt(a)),h)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(i=0){this._locationStrategy.historyGo?.(i)}onUrlChange(i){return this._urlChangeListeners.push(i),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(a=>{this._notifyUrlChangeListeners(a.url,a.state)})),()=>{const a=this._urlChangeListeners.indexOf(i);this._urlChangeListeners.splice(a,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(i="",a){this._urlChangeListeners.forEach(h=>h(i,a))}subscribe(i,a,h){return this._subject.subscribe({next:i,error:a,complete:h})}static#t=this.normalizeQueryParams=Yt;static#e=this.joinWithSlash=Pt;static#n=this.stripTrailingSlash=Et;static#r=this.\u0275fac=function(a){return new(a||o)(M.LFG(Le))};static#i=this.\u0275prov=M.Yz7({token:o,factory:function(){return function Te(){return new rn((0,M.LFG)(Le))}()},providedIn:"root"})}return o})();function Ce(o){return o.replace(/\/index.html$/,"")}function pl(o,n){n=encodeURIComponent(n);for(const i of o.split(";")){const a=i.indexOf("="),[h,_]=-1==a?[i,""]:[i.slice(0,a),i.slice(a+1)];if(h.trim()===n)return decodeURIComponent(_)}return null}const gl=/\s+/,mh=[];let cd=(()=>{class o{constructor(i,a,h,_){this._iterableDiffers=i,this._keyValueDiffers=a,this._ngEl=h,this._renderer=_,this.initialClasses=mh,this.stateMap=new Map}set klass(i){this.initialClasses=null!=i?i.trim().split(gl):mh}set ngClass(i){this.rawClass="string"==typeof i?i.trim().split(gl):i}ngDoCheck(){for(const a of this.initialClasses)this._updateState(a,!0);const i=this.rawClass;if(Array.isArray(i)||i instanceof Set)for(const a of i)this._updateState(a,!0);else if(null!=i)for(const a of Object.keys(i))this._updateState(a,!!i[a]);this._applyStateDiff()}_updateState(i,a){const h=this.stateMap.get(i);void 0!==h?(h.enabled!==a&&(h.changed=!0,h.enabled=a),h.touched=!0):this.stateMap.set(i,{enabled:a,changed:!0,touched:!0})}_applyStateDiff(){for(const i of this.stateMap){const a=i[0],h=i[1];h.changed?(this._toggleClass(a,h.enabled),h.changed=!1):h.touched||(h.enabled&&this._toggleClass(a,!1),this.stateMap.delete(a)),h.touched=!1}}_toggleClass(i,a){(i=i.trim()).length>0&&i.split(gl).forEach(h=>{a?this._renderer.addClass(this._ngEl.nativeElement,h):this._renderer.removeClass(this._ngEl.nativeElement,h)})}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(M.ZZ4),M.Y36(M.aQg),M.Y36(M.SBq),M.Y36(M.Qsj))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return o})();class ag{constructor(n,i,a,h){this.$implicit=n,this.ngForOf=i,this.index=a,this.count=h}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ml=(()=>{class o{set ngForOf(i){this._ngForOf=i,this._ngForOfDirty=!0}set ngForTrackBy(i){this._trackByFn=i}get ngForTrackBy(){return this._trackByFn}constructor(i,a,h){this._viewContainer=i,this._template=a,this._differs=h,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(i){i&&(this._template=i)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const i=this._ngForOf;!this._differ&&i&&(this._differ=this._differs.find(i).create(this.ngForTrackBy))}if(this._differ){const i=this._differ.diff(this._ngForOf);i&&this._applyChanges(i)}}_applyChanges(i){const a=this._viewContainer;i.forEachOperation((h,_,x)=>{if(null==h.previousIndex)a.createEmbeddedView(this._template,new ag(h.item,this._ngForOf,-1,-1),null===x?void 0:x);else if(null==x)a.remove(null===_?void 0:_);else if(null!==_){const S=a.get(_);a.move(S,x),qi(S,h)}});for(let h=0,_=a.length;h<_;h++){const S=a.get(h).context;S.index=h,S.count=_,S.ngForOf=this._ngForOf}i.forEachIdentityChange(h=>{qi(a.get(h.currentIndex),h)})}static ngTemplateContextGuard(i,a){return!0}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(M.s_b),M.Y36(M.Rgc),M.Y36(M.ZZ4))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return o})();function qi(o,n){o.context.$implicit=n.item}let Ua=(()=>{class o{constructor(i,a){this._viewContainer=i,this._context=new ud,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=a}set ngIf(i){this._context.$implicit=this._context.ngIf=i,this._updateView()}set ngIfThen(i){dd("ngIfThen",i),this._thenTemplateRef=i,this._thenViewRef=null,this._updateView()}set ngIfElse(i){dd("ngIfElse",i),this._elseTemplateRef=i,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(i,a){return!0}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(M.s_b),M.Y36(M.Rgc))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return o})();class ud{constructor(){this.$implicit=null,this.ngIf=null}}function dd(o,n){if(n&&!n.createEmbeddedView)throw new Error(`${o} must be a TemplateRef, but received '${(0,M.AaK)(n)}'.`)}let au=(()=>{class o{constructor(i,a,h){this._ngEl=i,this._differs=a,this._renderer=h,this._ngStyle=null,this._differ=null}set ngStyle(i){this._ngStyle=i,!this._differ&&i&&(this._differ=this._differs.find(i).create())}ngDoCheck(){if(this._differ){const i=this._differ.diff(this._ngStyle);i&&this._applyChanges(i)}}_setStyle(i,a){const[h,_]=i.split("."),x=-1===h.indexOf("-")?void 0:M.JOm.DashCase;null!=a?this._renderer.setStyle(this._ngEl.nativeElement,h,_?`${a}${_}`:a,x):this._renderer.removeStyle(this._ngEl.nativeElement,h,x)}_applyChanges(i){i.forEachRemovedItem(a=>this._setStyle(a.key,null)),i.forEachAddedItem(a=>this._setStyle(a.key,a.currentValue)),i.forEachChangedItem(a=>this._setStyle(a.key,a.currentValue))}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(M.SBq),M.Y36(M.aQg),M.Y36(M.Qsj))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return o})(),Ai=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=M.oAB({type:o});static#n=this.\u0275inj=M.cJS({})}return o})();function Xo(o){return"server"===o}let Cc=(()=>{class o{static#t=this.\u0275prov=(0,M.Yz7)({token:o,providedIn:"root",factory:()=>new ba((0,M.LFG)(ye),window)})}return o})();class ba{constructor(n,i){this.document=n,this.window=i,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const i=function Zi(o,n){const i=o.getElementById(n)||o.getElementsByName(n)[0];if(i)return i;if("function"==typeof o.createTreeWalker&&o.body&&"function"==typeof o.body.attachShadow){const a=o.createTreeWalker(o.body,NodeFilter.SHOW_ELEMENT);let h=a.currentNode;for(;h;){const _=h.shadowRoot;if(_){const x=_.getElementById(n)||_.querySelector(`[name="${n}"]`);if(x)return x}h=a.nextNode()}}return null}(this.document,n);i&&(this.scrollToElement(i),i.focus())}setHistoryScrollRestoration(n){this.supportsScrolling()&&(this.window.history.scrollRestoration=n)}scrollToElement(n){const i=n.getBoundingClientRect(),a=i.left+this.window.pageXOffset,h=i.top+this.window.pageYOffset,_=this.offset();this.window.scrollTo(a-_[0],h-_[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class $a{}class fg extends lt{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Kf extends fg{static makeCurrent(){!function vt(o){mt||(mt=o)}(new Kf)}onAndCancel(n,i,a){return n.addEventListener(i,a),()=>{n.removeEventListener(i,a)}}dispatchEvent(n,i){n.dispatchEvent(i)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,i){return(i=i||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,i){return"window"===i?window:"document"===i?n:"body"===i?n.body:null}getBaseHref(n){const i=function pg(){return vd=vd||document.querySelector("base"),vd?vd.getAttribute("href"):null}();return null==i?null:function xd(o){bd=bd||document.createElement("a"),bd.setAttribute("href",o);const n=bd.pathname;return"/"===n.charAt(0)?n:`/${n}`}(i)}resetBaseElement(){vd=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return pl(document.cookie,n)}}let bd,vd=null,Th=(()=>{class o{build(){return new XMLHttpRequest}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();const Ec=new M.OlP("EventManagerPlugins");let gg=(()=>{class o{constructor(i,a){this._zone=a,this._eventNameToPlugin=new Map,i.forEach(h=>{h.manager=this}),this._plugins=i.slice().reverse()}addEventListener(i,a,h){return this._findPluginFor(a).addEventListener(i,a,h)}getZone(){return this._zone}_findPluginFor(i){let a=this._eventNameToPlugin.get(i);if(a)return a;if(a=this._plugins.find(_=>_.supports(i)),!a)throw new M.vHH(5101,!1);return this._eventNameToPlugin.set(i,a),a}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(Ec),M.LFG(M.R0b))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();class gu{constructor(n){this._doc=n}}const mu="ng-app-id";let Ih=(()=>{class o{constructor(i,a,h,_={}){this.doc=i,this.appId=a,this.nonce=h,this.platformId=_,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Xo(_),this.resetHostNodes()}addStyles(i){for(const a of i)1===this.changeUsageCount(a,1)&&this.onStyleAdded(a)}removeStyles(i){for(const a of i)this.changeUsageCount(a,-1)<=0&&this.onStyleRemoved(a)}ngOnDestroy(){const i=this.styleNodesInDOM;i&&(i.forEach(a=>a.remove()),i.clear());for(const a of this.getAllStyles())this.onStyleRemoved(a);this.resetHostNodes()}addHost(i){this.hostNodes.add(i);for(const a of this.getAllStyles())this.addStyleToHost(i,a)}removeHost(i){this.hostNodes.delete(i)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(i){for(const a of this.hostNodes)this.addStyleToHost(a,i)}onStyleRemoved(i){const a=this.styleRef;a.get(i)?.elements?.forEach(h=>h.remove()),a.delete(i)}collectServerRenderedStyles(){const i=this.doc.head?.querySelectorAll(`style[${mu}="${this.appId}"]`);if(i?.length){const a=new Map;return i.forEach(h=>{null!=h.textContent&&a.set(h.textContent,h)}),a}return null}changeUsageCount(i,a){const h=this.styleRef;if(h.has(i)){const _=h.get(i);return _.usage+=a,_.usage}return h.set(i,{usage:a,elements:[]}),a}getStyleElement(i,a){const h=this.styleNodesInDOM,_=h?.get(a);if(_?.parentNode===i)return h.delete(a),_.removeAttribute(mu),_;{const x=this.doc.createElement("style");return this.nonce&&x.setAttribute("nonce",this.nonce),x.textContent=a,this.platformIsServer&&x.setAttribute(mu,this.appId),x}}addStyleToHost(i,a){const h=this.getStyleElement(i,a);i.appendChild(h);const _=this.styleRef,x=_.get(a)?.elements;x?x.push(h):_.set(a,{elements:[h],usage:1})}resetHostNodes(){const i=this.hostNodes;i.clear(),i.add(this.doc.head)}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(ye),M.LFG(M.AFp),M.LFG(M.Ojb,8),M.LFG(M.Lbi))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();const wa={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},wd=/%COMP%/g,vn=new M.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function Hl(o,n){return n.map(i=>i.replace(wd,o))}let Ah=(()=>{class o{constructor(i,a,h,_,x,S,L,B=null){this.eventManager=i,this.sharedStylesHost=a,this.appId=h,this.removeStylesOnCompDestroy=_,this.doc=x,this.platformId=S,this.ngZone=L,this.nonce=B,this.rendererByCompId=new Map,this.platformIsServer=Xo(S),this.defaultRenderer=new hs(i,x,L,this.platformIsServer)}createRenderer(i,a){if(!i||!a)return this.defaultRenderer;this.platformIsServer&&a.encapsulation===M.ifc.ShadowDom&&(a={...a,encapsulation:M.ifc.Emulated});const h=this.getOrCreateRenderer(i,a);return h instanceof Jo?h.applyToHost(i):h instanceof _u&&h.applyStyles(),h}getOrCreateRenderer(i,a){const h=this.rendererByCompId;let _=h.get(a.id);if(!_){const x=this.doc,S=this.ngZone,L=this.eventManager,B=this.sharedStylesHost,H=this.removeStylesOnCompDestroy,Y=this.platformIsServer;switch(a.encapsulation){case M.ifc.Emulated:_=new Jo(L,B,a,this.appId,H,x,S,Y);break;case M.ifc.ShadowDom:return new Xf(L,B,i,a,x,S,this.nonce,Y);default:_=new _u(L,B,a,H,x,S,Y)}h.set(a.id,_)}return _}ngOnDestroy(){this.rendererByCompId.clear()}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(gg),M.LFG(Ih),M.LFG(M.AFp),M.LFG(vn),M.LFG(ye),M.LFG(M.Lbi),M.LFG(M.R0b),M.LFG(M.Ojb))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();class hs{constructor(n,i,a,h){this.eventManager=n,this.doc=i,this.ngZone=a,this.platformIsServer=h,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,i){return i?this.doc.createElementNS(wa[i]||i,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,i){(zi(n)?n.content:n).appendChild(i)}insertBefore(n,i,a){n&&(zi(n)?n.content:n).insertBefore(i,a)}removeChild(n,i){n&&n.removeChild(i)}selectRootElement(n,i){let a="string"==typeof n?this.doc.querySelector(n):n;if(!a)throw new M.vHH(-5104,!1);return i||(a.textContent=""),a}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,i,a,h){if(h){i=h+":"+i;const _=wa[h];_?n.setAttributeNS(_,i,a):n.setAttribute(i,a)}else n.setAttribute(i,a)}removeAttribute(n,i,a){if(a){const h=wa[a];h?n.removeAttributeNS(h,i):n.removeAttribute(`${a}:${i}`)}else n.removeAttribute(i)}addClass(n,i){n.classList.add(i)}removeClass(n,i){n.classList.remove(i)}setStyle(n,i,a,h){h&(M.JOm.DashCase|M.JOm.Important)?n.style.setProperty(i,a,h&M.JOm.Important?"important":""):n.style[i]=a}removeStyle(n,i,a){a&M.JOm.DashCase?n.style.removeProperty(i):n.style[i]=""}setProperty(n,i,a){n[i]=a}setValue(n,i){n.nodeValue=i}listen(n,i,a){if("string"==typeof n&&!(n=It().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${i}`);return this.eventManager.addEventListener(n,i,this.decoratePreventDefault(a))}decoratePreventDefault(n){return i=>{if("__ngUnwrap__"===i)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(i)):n(i))&&i.preventDefault()}}}function zi(o){return"TEMPLATE"===o.tagName&&void 0!==o.content}class Xf extends hs{constructor(n,i,a,h,_,x,S,L){super(n,_,x,L),this.sharedStylesHost=i,this.hostEl=a,this.shadowRoot=a.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const B=Hl(h.id,h.styles);for(const H of B){const Y=document.createElement("style");S&&Y.setAttribute("nonce",S),Y.textContent=H,this.shadowRoot.appendChild(Y)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,i){return super.appendChild(this.nodeOrShadowRoot(n),i)}insertBefore(n,i,a){return super.insertBefore(this.nodeOrShadowRoot(n),i,a)}removeChild(n,i){return super.removeChild(this.nodeOrShadowRoot(n),i)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class _u extends hs{constructor(n,i,a,h,_,x,S,L){super(n,_,x,S),this.sharedStylesHost=i,this.removeStylesOnCompDestroy=h,this.styles=L?Hl(L,a.styles):a.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class Jo extends _u{constructor(n,i,a,h,_,x,S,L){const B=h+"-"+a.id;super(n,i,a,_,x,S,L,B),this.contentAttr=function mg(o){return"_ngcontent-%COMP%".replace(wd,o)}(B),this.hostAttr=function Md(o){return"_nghost-%COMP%".replace(wd,o)}(B)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,i){const a=super.createElement(n,i);return super.setAttribute(a,this.contentAttr,""),a}}let Qf=(()=>{class o extends gu{constructor(i){super(i)}supports(i){return!0}addEventListener(i,a,h){return i.addEventListener(a,h,!1),()=>this.removeEventListener(i,a,h)}removeEventListener(i,a,h){return i.removeEventListener(a,h)}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(ye))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();const yu=["alt","control","meta","shift"],vu={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ua={alt:o=>o.altKey,control:o=>o.ctrlKey,meta:o=>o.metaKey,shift:o=>o.shiftKey};let Ic=(()=>{class o extends gu{constructor(i){super(i)}supports(i){return null!=o.parseEventName(i)}addEventListener(i,a,h){const _=o.parseEventName(a),x=o.eventCallback(_.fullKey,h,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>It().onAndCancel(i,_.domEventName,x))}static parseEventName(i){const a=i.toLowerCase().split("."),h=a.shift();if(0===a.length||"keydown"!==h&&"keyup"!==h)return null;const _=o._normalizeKey(a.pop());let x="",S=a.indexOf("code");if(S>-1&&(a.splice(S,1),x="code."),yu.forEach(B=>{const H=a.indexOf(B);H>-1&&(a.splice(H,1),x+=B+".")}),x+=_,0!=a.length||0===_.length)return null;const L={};return L.domEventName=h,L.fullKey=x,L}static matchEventFullKeyCode(i,a){let h=vu[i.key]||i.key,_="";return a.indexOf("code.")>-1&&(h=i.code,_="code."),!(null==h||!h)&&(h=h.toLowerCase()," "===h?h="space":"."===h&&(h="dot"),yu.forEach(x=>{x!==h&&(0,ua[x])(i)&&(_+=x+".")}),_+=h,_===a)}static eventCallback(i,a,h){return _=>{o.matchEventFullKeyCode(_,i)&&h.runGuarded(()=>a(_))}}static _normalizeKey(i){return"esc"===i?"escape":i}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(ye))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();const No=(0,M.eFA)(M._c5,"browser",[{provide:M.Lbi,useValue:"browser"},{provide:M.g9A,useValue:function tp(){Kf.makeCurrent()},multi:!0},{provide:ye,useFactory:function Wa(){return(0,M.RDi)(document),document},deps:[]}]),lr=new M.OlP(""),xo=[{provide:M.rWj,useClass:class Yf{addToWindow(n){M.dqk.getAngularTestability=(a,h=!0)=>{const _=n.findTestabilityInTree(a,h);if(null==_)throw new M.vHH(5103,!1);return _},M.dqk.getAllAngularTestabilities=()=>n.getAllTestabilities(),M.dqk.getAllAngularRootElements=()=>n.getAllRootElements(),M.dqk.frameworkStabilizers||(M.dqk.frameworkStabilizers=[]),M.dqk.frameworkStabilizers.push(a=>{const h=M.dqk.getAllAngularTestabilities();let _=h.length,x=!1;const S=function(L){x=x||L,_--,0==_&&a(x)};h.forEach(L=>{L.whenStable(S)})})}findTestabilityInTree(n,i,a){return null==i?null:n.getTestability(i)??(a?It().isShadowRoot(i)?this.findTestabilityInTree(n,i.host,!0):this.findTestabilityInTree(n,i.parentElement,!0):null)}},deps:[]},{provide:M.lri,useClass:M.dDg,deps:[M.R0b,M.eoX,M.rWj]},{provide:M.dDg,useClass:M.dDg,deps:[M.R0b,M.eoX,M.rWj]}],ep=[{provide:M.zSh,useValue:"root"},{provide:M.qLn,useFactory:function Pd(){return new M.qLn},deps:[]},{provide:Ec,useClass:Qf,multi:!0,deps:[ye,M.R0b,M.Lbi]},{provide:Ec,useClass:Ic,multi:!0,deps:[ye]},Ah,Ih,gg,{provide:M.FYo,useExisting:Ah},{provide:$a,useClass:Th,deps:[]},[]];let xu=(()=>{class o{constructor(i){}static withServerTransition(i){return{ngModule:o,providers:[{provide:M.AFp,useValue:i.appId}]}}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(lr,12))};static#e=this.\u0275mod=M.oAB({type:o});static#n=this.\u0275inj=M.cJS({providers:[...ep,...xo],imports:[Ai,M.hGG]})}return o})(),Sc=(()=>{class o{constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(ye))};static#e=this.\u0275prov=M.Yz7({token:o,factory:function(a){let h=null;return h=a?new a:function wu(){return new Sc((0,M.LFG)(ye))}(),h},providedIn:"root"})}return o})();typeof window<"u"&&window;var Ma=ft(6304),Wr=ft(9015),da=ft(4097);class Ns{constructor(n){return n}}class Cu{constructor(){return(0,da.C6)()}}const xl=new M.OlP("angularfire2._apps"),n_={provide:Ns,useFactory:function Rc(o){return o&&1===o.length?o[0]:new Ns((0,da.Mq)())},deps:[[new M.FiY,xl]]},Mu={provide:Cu,deps:[[new M.FiY,xl]]};function Pu(o){return(n,i)=>{const a=n.runOutsideAngular(()=>o(i));return new Ns(a)}}let ql=(()=>{class o{constructor(i){(0,da.KN)("angularfire",Wr.q4.full,"core"),(0,da.KN)("angularfire",Wr.q4.full,"app"),(0,da.KN)("angular",M.q4F.full,i.toString())}}return o.\u0275fac=function(i){return new(i||o)(M.LFG(M.Lbi))},o.\u0275mod=M.oAB({type:o}),o.\u0275inj=M.cJS({providers:[n_,Mu]}),o})();function bg(o,...n){return{ngModule:ql,providers:[{provide:xl,useFactory:Pu(o),multi:!0,deps:[M.R0b,M.zs3,Wr.HU,...n]}]}}const Zl=(0,Wr.u3)(da.ZF,!0);var Je=ft(5861),ts=ft(1571),Pa=ft(6820),$r=ft(229),Kl=ft(7879);const Yl=new Map,Sd={activated:!1,tokenObservers:[]},Ts={initialized:!1,enabled:!1};function io(o){return Yl.get(o)||Object.assign({},Sd)}function Ya(){return Ts}const Ou="https://content-firebaseappcheck.googleapis.com/v1",Ad="exchangeDebugToken",r_={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class i_{constructor(n,i,a,h,_){if(this.operation=n,this.retryPolicy=i,this.getWaitDuration=a,this.lowerBound=h,this.upperBound=_,this.pending=null,this.nextErrorWaitInterval=h,h>_)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(n){var i=this;return(0,Je.Z)(function*(){i.stop();try{i.pending=new $r.BH,yield function Nh(o){return new Promise(n=>{setTimeout(n,o)})}(i.getNextRun(n)),i.pending.resolve(),yield i.pending.promise,i.pending=new $r.BH,yield i.operation(),i.pending.resolve(),yield i.pending.promise,i.process(!0).catch(()=>{})}catch(a){i.retryPolicy(a)?i.process(!1).catch(()=>{}):i.stop()}})()}getNextRun(n){if(n)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const i=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),i}}}const ps=new $r.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function ha(o){if(!io(o).activated)throw ps.create("use-before-activation",{appName:o.name})}function Xa(o,n){return kd.apply(this,arguments)}function kd(){return(kd=(0,Je.Z)(function*({url:o,body:n},i){const a={"Content-Type":"application/json"},h=i.getImmediate({optional:!0});if(h){const Y=yield h.getHeartbeatsHeader();Y&&(a["X-Firebase-Client"]=Y)}const _={method:"POST",body:JSON.stringify(n),headers:a};let x,S;try{x=yield fetch(o,_)}catch(Y){throw ps.create("fetch-network-error",{originalErrorMessage:Y?.message})}if(200!==x.status)throw ps.create("fetch-status-error",{httpStatus:x.status});try{S=yield x.json()}catch(Y){throw ps.create("fetch-parse-error",{originalErrorMessage:Y?.message})}const L=S.ttl.match(/^([\d.]+)(s)$/);if(!L||!L[2]||isNaN(Number(L[1])))throw ps.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${S.ttl}`});const B=1e3*Number(L[1]),H=Date.now();return{token:S.token,expireTimeMillis:H+B,issuedAtTimeMillis:H}})).apply(this,arguments)}function wl(o,n){const{projectId:i,appId:a,apiKey:h}=o.options;return{url:`${Ou}/projects/${i}/apps/${a}:${Ad}?key=${h}`,body:{debug_token:n}}}const cp="firebase-app-check-database",Cg=1,Ys="firebase-app-check-store";let Cl=null;function Iu(){return(Iu=(0,Je.Z)(function*(o,n){const a=(yield function Rd(){return Cl||(Cl=new Promise((o,n)=>{try{const i=indexedDB.open(cp,Cg);i.onsuccess=a=>{o(a.target.result)},i.onerror=a=>{var h;n(ps.create("storage-open",{originalErrorMessage:null===(h=a.target.error)||void 0===h?void 0:h.message}))},i.onupgradeneeded=a=>{0===a.oldVersion&&a.target.result.createObjectStore(Ys,{keyPath:"compositeKey"})}}catch(i){n(ps.create("storage-open",{originalErrorMessage:i?.message}))}}),Cl)}()).transaction(Ys,"readwrite"),_=a.objectStore(Ys).put({compositeKey:o,value:n});return new Promise((x,S)=>{_.onsuccess=L=>{x()},a.onerror=L=>{var B;S(ps.create("storage-set",{originalErrorMessage:null===(B=L.target.error)||void 0===B?void 0:B.message}))}})})).apply(this,arguments)}const Ja=new Kl.Yd("@firebase/app-check");function Pg(o,n){return(0,$r.hl)()?function Tu(o,n){return function zh(o,n){return Iu.apply(this,arguments)}(function dp(o){return`${o.options.appId}-${o.name}`}(o),n)}(o,n).catch(i=>{Ja.warn(`Failed to write token to IndexedDB. Error: ${i}`)}):Promise.resolve()}function Nc(){return Ya().enabled}function es(){return fa.apply(this,arguments)}function fa(){return(fa=(0,Je.Z)(function*(){const o=Ya();if(o.enabled&&o.token)return o.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const Ql={error:"UNKNOWN_ERROR"};function Ml(o){return $r.US.encodeString(JSON.stringify(o),!1)}function Fo(o){return Jl.apply(this,arguments)}function Jl(){return(Jl=(0,Je.Z)(function*(o,n=!1){const i=o.app;ha(i);const a=io(i);let _,h=a.token;if(h&&!W(h)&&(a.token=void 0,h=void 0),!h){const L=yield a.cachedTokenPromise;L&&(W(L)?h=L:yield Pg(i,void 0))}if(!n&&h&&W(h))return{token:h.token};let S,x=!1;if(Nc()){a.exchangeTokenPromise||(a.exchangeTokenPromise=Xa(wl(i,yield es()),o.heartbeatServiceProvider).finally(()=>{a.exchangeTokenPromise=void 0}),x=!0);const L=yield a.exchangeTokenPromise;return yield Pg(i,L),a.token=L,{token:L.token}}try{a.exchangeTokenPromise||(a.exchangeTokenPromise=a.provider.getToken().finally(()=>{a.exchangeTokenPromise=void 0}),x=!0),h=yield io(i).exchangeTokenPromise}catch(L){"appCheck/throttled"===L.code?Ja.warn(L.message):Ja.error(L),_=L}return h?_?S=W(h)?{token:h.token,internalError:_}:ut(_):(S={token:h.token},a.token=h,yield Pg(i,h)):S=ut(_),x&&function V(o,n){const i=io(o).tokenObservers;for(const a of i)try{"EXTERNAL"===a.type&&null!=n.error?a.error(n.error):a.next(n)}catch{}}(i,S),S})).apply(this,arguments)}function tc(o){return De.apply(this,arguments)}function De(){return(De=(0,Je.Z)(function*(o){const n=o.app;ha(n);const{provider:i}=io(n);if(Nc()){const a=yield es(),{token:h}=yield Xa(wl(n,a),o.heartbeatServiceProvider);return{token:h}}{const{token:a}=yield i.getToken();return{token:a}}})).apply(this,arguments)}function zd(o,n){const i=io(o),a=i.tokenObservers.filter(h=>h.next!==n);0===a.length&&i.tokenRefresher&&i.tokenRefresher.isRunning()&&i.tokenRefresher.stop(),i.tokenObservers=a}function nc(o){const{app:n}=o,i=io(n);let a=i.tokenRefresher;a||(a=function U(o){const{app:n}=o;return new i_((0,Je.Z)(function*(){let a;if(a=io(n).token?yield Fo(o,!0):yield Fo(o),a.error)throw a.error;if(a.internalError)throw a.internalError}),()=>!0,()=>{const i=io(n);if(i.token){let a=i.token.issuedAtTimeMillis+.5*(i.token.expireTimeMillis-i.token.issuedAtTimeMillis)+3e5;return a=Math.min(a,i.token.expireTimeMillis-3e5),Math.max(0,a-Date.now())}return 0},r_.RETRIAL_MIN_WAIT,r_.RETRIAL_MAX_WAIT)}(o),i.tokenRefresher=a),!a.isRunning()&&i.isTokenAutoRefreshEnabled&&a.start()}function W(o){return o.expireTimeMillis-Date.now()>0}function ut(o){return{token:Ml(Ql),error:o}}class Mt{constructor(n,i){this.app=n,this.heartbeatServiceProvider=i}_delete(){const{tokenObservers:n}=io(this.app);for(const i of n)zd(this.app,i.next);return Promise.resolve()}}const St="app-check-internal";!function jt(){(0,ts._registerComponent)(new Pa.wA("app-check",o=>function Lt(o,n){return new Mt(o,n)}(o.getProvider("app").getImmediate(),o.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((o,n,i)=>{o.getProvider(St).initialize()})),(0,ts._registerComponent)(new Pa.wA(St,o=>function se(o){return{getToken:n=>Fo(o,n),getLimitedUseToken:()=>tc(o),addTokenListener:n=>function ec(o,n,i,a){const{app:h}=o,_=io(h);if(_.tokenObservers=[..._.tokenObservers,{next:i,error:a,type:n}],_.token&&W(_.token)){const S=_.token;Promise.resolve().then(()=>{i({token:S.token}),nc(o)}).catch(()=>{})}_.cachedTokenPromise.then(()=>nc(o))}(o,"INTERNAL",n),removeTokenListener:n=>zd(o.app,n)}}(o.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,ts.registerVersion)("@firebase/app-check","0.8.0")}();class sn{constructor(){return(0,Wr.vb)("app-check")}}typeof window<"u"&&window;var rc=ft(6710);class Xy{constructor(n){return n}}class g0{constructor(){return(0,Wr.vb)("auth")}}const Qy=new M.OlP("angularfire2.auth-instances");function m0(o){return(n,i)=>{const a=n.runOutsideAngular(()=>o(i));return new Xy(a)}}const _0={provide:g0,deps:[[new M.FiY,Qy]]},y0={provide:Xy,useFactory:function ku(o,n){const i=(0,Wr.JM)("auth",o,n);return i&&new Xy(i)},deps:[[new M.FiY,Qy],Ns]};let eP=(()=>{class o{constructor(){(0,da.KN)("angularfire",Wr.q4.full,"auth")}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=M.oAB({type:o}),o.\u0275inj=M.cJS({providers:[y0,_0]}),o})();function Mo(o,...n){return{ngModule:eP,providers:[{provide:Qy,useFactory:m0(o),multi:!0,deps:[M.R0b,M.zs3,Wr.HU,Cu,[new M.FiY,sn],...n]}]}}const iP=(0,Wr.u3)(rc.o,!0);var an,Hh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ia={},Pl=Pl||{},pr=Hh||self;function Ru(o){var n=typeof o;return"array"==(n="object"!=n?n:o?Array.isArray(o)?"array":n:"null")||"object"==n&&"number"==typeof o.length}function ga(o){var n=typeof o;return"object"==n&&null!=o||"function"==n}var E0="closure_uid_"+(1e9*Math.random()>>>0),bw=0;function O0(o,n,i){return o.call.apply(o.bind,arguments)}function mP(o,n,i){if(!o)throw Error();if(2<arguments.length){var a=Array.prototype.slice.call(arguments,2);return function(){var h=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(h,a),o.apply(n,h)}}return function(){return o.apply(n,arguments)}}function Xi(o,n,i){return(Xi=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?O0:mP).apply(null,arguments)}function zo(o,n){var i=Array.prototype.slice.call(arguments,1);return function(){var a=i.slice();return a.push.apply(a,arguments),o.apply(this,a)}}function ci(o,n){function i(){}i.prototype=n.prototype,o.$=n.prototype,o.prototype=new i,o.prototype.constructor=o,o.ac=function(a,h,_){for(var x=Array(arguments.length-2),S=2;S<arguments.length;S++)x[S-2]=arguments[S];return n.prototype[h].apply(a,x)}}function qh(){this.s=this.s,this.o=this.o}qh.prototype.s=!1,qh.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function P0(o){Object.prototype.hasOwnProperty.call(o,E0)&&o[E0]||(o[E0]=++bw)}(this)},qh.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const xw=Array.prototype.indexOf?function(o,n){return Array.prototype.indexOf.call(o,n,void 0)}:function(o,n){if("string"==typeof o)return"string"!=typeof n||1!=n.length?-1:o.indexOf(n,0);for(let i=0;i<o.length;i++)if(i in o&&o[i]===n)return i;return-1};function f_(o){const n=o.length;if(0<n){const i=Array(n);for(let a=0;a<n;a++)i[a]=o[a];return i}return[]}function Di(o,n){for(let i=1;i<arguments.length;i++){const a=arguments[i];if(Ru(a)){const h=o.length||0,_=a.length||0;o.length=h+_;for(let x=0;x<_;x++)o[h+x]=a[x]}else o.push(a)}}function Is(o,n){this.type=o,this.g=this.target=n,this.defaultPrevented=!1}Is.prototype.h=function(){this.defaultPrevented=!0};var pp=function(){if(!pr.addEventListener||!Object.defineProperty)return!1;var o=!1,n=Object.defineProperty({},"passive",{get:function(){o=!0}});try{pr.addEventListener("test",()=>{},n),pr.removeEventListener("test",()=>{},n)}catch{}return o}();function p_(o){return/^[\s\xa0]*$/.test(o)}function Og(){var o=pr.navigator;return o&&(o=o.userAgent)?o:""}function zc(o){return-1!=Og().indexOf(o)}function fi(o){return fi[" "](o),o}fi[" "]=function(){};var ev,o,Lu=zc("Opera"),Tg=zc("Trident")||zc("MSIE"),yP=zc("Edge"),Ig=yP||Tg,ui=zc("Gecko")&&!(-1!=Og().toLowerCase().indexOf("webkit")&&!zc("Edge"))&&!(zc("Trident")||zc("MSIE"))&&!zc("Edge"),I0=-1!=Og().toLowerCase().indexOf("webkit")&&!zc("Edge");function rl(){var o=pr.document;return o?o.documentMode:void 0}t:{var g_="",nv=(o=Og(),ui?/rv:([^\);]+)(\)|;)/.exec(o):yP?/Edge\/([\d\.]+)/.exec(o):Tg?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(o):I0?/WebKit\/(\S+)/.exec(o):Lu?/(?:Version)[ \/]?(\S+)/.exec(o):void 0);if(nv&&(g_=nv?nv[1]:""),Tg){var Bn=rl();if(null!=Bn&&Bn>parseFloat(g_)){ev=String(Bn);break t}}ev=g_}var S0=pr.document&&Tg&&(rl()||parseInt(ev,10))||void 0;function Wh(o,n){if(Is.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var i=this.type=o.type,a=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=n,n=o.relatedTarget){if(ui){t:{try{fi(n.nodeName);var h=!0;break t}catch{}h=!1}h||(n=null)}}else"mouseover"==i?n=o.fromElement:"mouseout"==i&&(n=o.toElement);this.relatedTarget=n,a?(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==o.clientX?o.clientX:o.pageX,this.clientY=void 0!==o.clientY?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType="string"==typeof o.pointerType?o.pointerType:ww[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Wh.$.h.call(this)}}ci(Wh,Is);var ww={2:"touch",3:"pen",4:"mouse"};Wh.prototype.h=function(){Wh.$.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var gp="closure_listenable_"+(1e6*Math.random()|0),m_=0;function vP(o,n,i,a,h){this.listener=o,this.proxy=null,this.src=n,this.type=i,this.capture=!!a,this.la=h,this.key=++m_,this.fa=this.ia=!1}function __(o){o.fa=!0,o.listener=null,o.proxy=null,o.src=null,o.la=null}function A0(o,n,i){for(const a in o)n.call(i,o[a],a,o)}function qn(o){const n={};for(const i in o)n[i]=o[i];return n}const rv="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Nu(o,n){let i,a;for(let h=1;h<arguments.length;h++){for(i in a=arguments[h],a)o[i]=a[i];for(let _=0;_<rv.length;_++)i=rv[_],Object.prototype.hasOwnProperty.call(a,i)&&(o[i]=a[i])}}function mp(o){this.src=o,this.g={},this.h=0}function y_(o,n){var i=n.type;if(i in o.g){var _,a=o.g[i],h=xw(a,n);(_=0<=h)&&Array.prototype.splice.call(a,h,1),_&&(__(n),0==o.g[i].length&&(delete o.g[i],o.h--))}}function Kh(o,n,i,a){for(var h=0;h<o.length;++h){var _=o[h];if(!_.fa&&_.listener==n&&_.capture==!!i&&_.la==a)return h}return-1}mp.prototype.add=function(o,n,i,a,h){var _=o.toString();(o=this.g[_])||(o=this.g[_]=[],this.h++);var x=Kh(o,n,a,h);return-1<x?(n=o[x],i||(n.ia=!1)):((n=new vP(n,this.src,_,!!a,h)).ia=i,o.push(n)),n};var D0="closure_lm_"+(1e6*Math.random()|0),k0={};function bP(o,n,i,a,h){if(a&&a.once)return Mw(o,n,i,a,h);if(Array.isArray(n)){for(var _=0;_<n.length;_++)bP(o,n[_],i,a,h);return null}return i=iv(i),o&&o[gp]?o.O(n,i,ga(a)?!!a.capture:!!a,h):Cw(o,n,i,!1,a,h)}function Cw(o,n,i,a,h,_){if(!n)throw Error("Invalid event type");var x=ga(h)?!!h.capture:!!h,S=v_(o);if(S||(o[D0]=S=new mp(o)),(i=S.add(n,i,a,x,_)).proxy)return i;if(a=function R0(){const n=gr;return function o(i){return n.call(o.src,o.listener,i)}}(),i.proxy=a,a.src=o,a.listener=i,o.addEventListener)pp||(h=x),void 0===h&&(h=!1),o.addEventListener(n.toString(),a,h);else if(o.attachEvent)o.attachEvent(L0(n.toString()),a);else{if(!o.addListener||!o.removeListener)throw Error("addEventListener and attachEvent are unavailable.");o.addListener(a)}return i}function Mw(o,n,i,a,h){if(Array.isArray(n)){for(var _=0;_<n.length;_++)Mw(o,n[_],i,a,h);return null}return i=iv(i),o&&o[gp]?o.P(n,i,ga(a)?!!a.capture:!!a,h):Cw(o,n,i,!0,a,h)}function _p(o,n,i,a,h){if(Array.isArray(n))for(var _=0;_<n.length;_++)_p(o,n[_],i,a,h);else a=ga(a)?!!a.capture:!!a,i=iv(i),o&&o[gp]?(o=o.i,(n=String(n).toString())in o.g&&-1<(i=Kh(_=o.g[n],i,a,h))&&(__(_[i]),Array.prototype.splice.call(_,i,1),0==_.length&&(delete o.g[n],o.h--))):o&&(o=v_(o))&&(n=o.g[n.toString()],o=-1,n&&(o=Kh(n,i,a,h)),(i=-1<o?n[o]:null)&&El(i))}function El(o){if("number"!=typeof o&&o&&!o.fa){var n=o.src;if(n&&n[gp])y_(n.i,o);else{var i=o.type,a=o.proxy;n.removeEventListener?n.removeEventListener(i,a,o.capture):n.detachEvent?n.detachEvent(L0(i),a):n.addListener&&n.removeListener&&n.removeListener(a),(i=v_(n))?(y_(i,o),0==i.h&&(i.src=null,n[D0]=null)):__(o)}}}function L0(o){return o in k0?k0[o]:k0[o]="on"+o}function gr(o,n){if(o.fa)o=!0;else{n=new Wh(n,this);var i=o.listener,a=o.la||o.src;o.ia&&El(o),o=i.call(a,n)}return o}function v_(o){return(o=o[D0])instanceof mp?o:null}var il="__closure_events_fn_"+(1e9*Math.random()>>>0);function iv(o){return"function"==typeof o?o:(o[il]||(o[il]=function(n){return o.handleEvent(n)}),o[il])}function Fs(){qh.call(this),this.i=new mp(this),this.S=this,this.J=null}function Js(o,n){var i,a=o.J;if(a)for(i=[];a;a=a.J)i.push(a);if(o=o.S,a=n.type||n,"string"==typeof n)n=new Is(n,o);else if(n instanceof Is)n.target=n.target||o;else{var h=n;Nu(n=new Is(a,o),h)}if(h=!0,i)for(var _=i.length-1;0<=_;_--){var x=n.g=i[_];h=ov(x,a,!0,n)&&h}if(h=ov(x=n.g=o,a,!0,n)&&h,h=ov(x,a,!1,n)&&h,i)for(_=0;_<i.length;_++)h=ov(x=n.g=i[_],a,!1,n)&&h}function ov(o,n,i,a){if(!(n=o.i.g[String(n)]))return!0;n=n.concat();for(var h=!0,_=0;_<n.length;++_){var x=n[_];if(x&&!x.fa&&x.capture==i){var S=x.listener,L=x.la||x.src;x.ia&&y_(o.i,x),h=!1!==S.call(L,a)&&h}}return h&&!a.defaultPrevented}ci(Fs,qh),Fs.prototype[gp]=!0,Fs.prototype.removeEventListener=function(o,n,i,a){_p(this,o,n,i,a)},Fs.prototype.N=function(){if(Fs.$.N.call(this),this.i){var n,o=this.i;for(n in o.g){for(var i=o.g[n],a=0;a<i.length;a++)__(i[a]);delete o.g[n],o.h--}}this.J=null},Fs.prototype.O=function(o,n,i,a){return this.i.add(String(o),n,!1,i,a)},Fs.prototype.P=function(o,n,i,a){return this.i.add(String(o),n,!0,i,a)};var N0=pr.JSON.stringify;function Yh(){var o=Sa;let n=null;return o.g&&(n=o.g,o.g=o.g.next,o.g||(o.h=null),n.next=null),n}var Pw=new class xP{constructor(n,i){this.i=n,this.j=i,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new AS,o=>o.reset());class AS{constructor(){this.next=this.g=this.h=null}set(n,i){this.h=n,this.g=i,this.next=null}reset(){this.next=this.g=this.h=null}}function wP(o){var n=1;o=o.split(":");const i=[];for(;0<n&&o.length;)i.push(o.shift()),n--;return o.length&&i.push(o.join(":")),i}function x_(o){pr.setTimeout(()=>{throw o},0)}let F0,Bc=!1,Sa=new class b_{constructor(){this.h=this.g=null}add(n,i){const a=Pw.get();a.set(n,i),this.h?this.h.next=a:this.g=a,this.h=a}},Ew=()=>{const o=pr.Promise.resolve(void 0);F0=()=>{o.then(z0)}};var z0=()=>{for(var o;o=Yh();){try{o.h.call(o.g)}catch(i){x_(i)}var n=Pw;n.j(o),100>n.h&&(n.h++,o.next=n.g,n.g=o)}Bc=!1};function w_(o,n){Fs.call(this),this.h=o||1,this.g=n||pr,this.j=Xi(this.qb,this),this.l=Date.now()}function B0(o){o.ga=!1,o.T&&(o.g.clearTimeout(o.T),o.T=null)}function C_(o,n,i){if("function"==typeof o)i&&(o=Xi(o,i));else{if(!o||"function"!=typeof o.handleEvent)throw Error("Invalid listener argument");o=Xi(o.handleEvent,o)}return 2147483647<Number(n)?-1:pr.setTimeout(o,n||0)}function Fu(o){o.g=C_(()=>{o.g=null,o.i&&(o.i=!1,Fu(o))},o.j);const n=o.h;o.h=null,o.m.apply(null,n)}ci(w_,Fs),(an=w_.prototype).ga=!1,an.T=null,an.qb=function(){if(this.ga){var o=Date.now()-this.l;0<o&&o<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-o):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Js(this,"tick"),this.ga&&(B0(this),this.start()))}},an.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},an.N=function(){w_.$.N.call(this),B0(this),delete this.g};class M_ extends qh{constructor(n,i){super(),this.m=n,this.j=i,this.h=null,this.i=!1,this.g=null}l(n){this.h=arguments,this.g?this.i=!0:Fu(this)}N(){super.N(),this.g&&(pr.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Xh(o){qh.call(this),this.h=o,this.g={}}ci(Xh,qh);var U0=[];function V0(o,n,i,a){Array.isArray(i)||(i&&(U0[0]=i.toString()),i=U0);for(var h=0;h<i.length;h++){var _=bP(n,i[h],a||o.handleEvent,!1,o.h||o);if(!_)break;o.g[_.key]=_}}function CP(o){A0(o.g,function(n,i){this.g.hasOwnProperty(i)&&El(n)},o),o.g={}}function j0(){this.g=!0}function ta(o,n,i,a){o.info(function(){return"XMLHTTP TEXT ("+n+"): "+function CT(o,n){if(!o.g)return n;if(!n)return null;try{var i=JSON.parse(n);if(i)for(o=0;o<i.length;o++)if(Array.isArray(i[o])){var a=i[o];if(!(2>a.length)){var h=a[1];if(Array.isArray(h)&&!(1>h.length)){var _=h[0];if("noop"!=_&&"stop"!=_&&"close"!=_)for(var x=1;x<h.length;x++)h[x]=""}}}return N0(i)}catch{return n}}(o,i)+(a?" "+a:"")})}Xh.prototype.N=function(){Xh.$.N.call(this),CP(this)},Xh.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},j0.prototype.Ea=function(){this.g=!1},j0.prototype.info=function(){};var yp={},$0=null;function P_(){return $0=$0||new Fs}function MP(o){Is.call(this,yp.Ta,o)}function ol(o){const n=P_();Js(n,new MP(n))}function Ow(o,n){Is.call(this,yp.STAT_EVENT,o),this.stat=n}function Dn(o){const n=P_();Js(n,new Ow(n,o))}function G0(o,n){Is.call(this,yp.Ua,o),this.size=n}function ms(o,n){if("function"!=typeof o)throw Error("Fn must not be null and must be a function");return pr.setTimeout(function(){o()},n)}yp.Ta="serverreachability",ci(MP,Is),yp.STAT_EVENT="statevent",ci(Ow,Is),yp.Ua="timingevent",ci(G0,Is);var Uc={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},vp={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function H0(){}function Z0(){}H0.prototype.h=null;var Y0,Sg={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function W0(){Is.call(this,"d")}function K0(){Is.call(this,"c")}function Ag(){}function Zn(o,n,i,a){this.l=o,this.j=n,this.m=i,this.W=a||1,this.U=new Xh(this),this.P=E_,this.V=new w_(o=Ig?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Tw}function Tw(){this.i=null,this.g="",this.h=!1}ci(W0,Is),ci(K0,Is),ci(Ag,H0),Ag.prototype.g=function(){return new XMLHttpRequest},Ag.prototype.i=function(){return{}},Y0=new Ag;var E_=45e3,bp={},Qh={};function av(o,n,i){o.L=1,o.v=tf(bt(n)),o.s=i,o.S=!0,X0(o,null)}function X0(o,n){o.G=Date.now(),Dg(o),o.A=bt(o.v);var i=o.A,a=o.W;Array.isArray(a)||(a=[String(a)]),Ir(i.i,"t",a),o.C=0,i=o.l.J,o.h=new Tw,o.g=Lw(o.l,i?n:null,!o.s),0<o.O&&(o.M=new M_(Xi(o.Pa,o,o.g),o.O)),V0(o.U,o.g,"readystatechange",o.nb),n=o.I?qn(o.I):{},o.s?(o.u||(o.u="POST"),n["Content-Type"]="application/x-www-form-urlencoded",o.g.ha(o.A,o.u,o.s,n)):(o.u="GET",o.g.ha(o.A,o.u,null,n)),ol(),function xT(o,n,i,a,h,_){o.info(function(){if(o.g)if(_)for(var x="",S=_.split("&"),L=0;L<S.length;L++){var B=S[L].split("=");if(1<B.length){var H=B[0];B=B[1];var Y=H.split("_");x=2<=Y.length&&"type"==Y[1]?x+(H+"=")+B+"&":x+(H+"=redacted&")}}else x=null;else x=_;return"XMLHTTP REQ ("+a+") [attempt "+h+"]: "+n+"\n"+i+"\n"+x})}(o.j,o.u,o.A,o.m,o.W,o.s)}function lv(o){return!!o.g&&"GET"==o.u&&2!=o.L&&o.l.Ha}function cv(o,n,i){let h,a=!0;for(;!o.J&&o.C<i.length;){if(h=PP(o,i),h==Qh){4==n&&(o.o=4,Dn(14),a=!1),ta(o.j,o.m,null,"[Incomplete Response]");break}if(h==bp){o.o=4,Dn(15),ta(o.j,o.m,i,"[Invalid Chunk]"),a=!1;break}ta(o.j,o.m,h,null),Iw(o,h)}lv(o)&&h!=Qh&&h!=bp&&(o.h.g="",o.C=0),4!=n||0!=i.length||o.h.h||(o.o=1,Dn(16),a=!1),o.i=o.i&&a,a?0<i.length&&!o.ba&&(o.ba=!0,(n=o.l).g==o&&n.ca&&!n.M&&(n.l.info("Great, no buffering proxy detected. Bytes received: "+i.length),Rw(n),n.M=!0,Dn(11))):(ta(o.j,o.m,i,"[Invalid Chunked Response]"),kr(o),O_(o))}function PP(o,n){var i=o.C,a=n.indexOf("\n",i);return-1==a?Qh:(i=Number(n.substring(i,a)),isNaN(i)?bp:(a+=1)+i>n.length?Qh:(n=n.slice(a,a+i),o.C=a+i,n))}function Dg(o){o.Y=Date.now()+o.P,Q0(o,o.P)}function Q0(o,n){if(null!=o.B)throw Error("WatchDog timer not null");o.B=ms(Xi(o.lb,o),n)}function kg(o){o.B&&(pr.clearTimeout(o.B),o.B=null)}function O_(o){0==o.l.H||o.J||Ep(o.l,o)}function kr(o){kg(o);var n=o.M;n&&"function"==typeof n.sa&&n.sa(),o.M=null,B0(o.V),CP(o.U),o.g&&(n=o.g,o.g=null,n.abort(),n.sa())}function Iw(o,n){try{var i=o.l;if(0!=i.H&&(i.g==o||ix(i.i,o)))if(!o.K&&ix(i.i,o)&&3==i.H){try{var a=i.Ja.g.parse(n)}catch{a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!i.u){if(i.g){if(!(i.g.G+3e3<o.G))break t;dx(i),Po(i)}yv(i),Dn(18)}}else i.Fa=h[1],0<i.Fa-i.V&&37500>h[2]&&i.G&&0==i.A&&!i.v&&(i.v=ms(Xi(i.ib,i),6e3));if(1>=I_(i.i)&&i.oa){try{i.oa()}catch{}i.oa=void 0}}else Aa(i,11)}else if((o.K||i.g==o)&&dx(i),!p_(n))for(h=i.Ja.g.parse(n),n=0;n<h.length;n++){let B=h[n];if(i.V=B[0],B=B[1],2==i.H)if("c"==B[0]){i.K=B[1],i.pa=B[2];const H=B[3];null!=H&&(i.ra=H,i.l.info("VER="+i.ra));const Y=B[4];null!=Y&&(i.Ga=Y,i.l.info("SVER="+i.Ga));const pt=B[5];null!=pt&&"number"==typeof pt&&0<pt&&(i.L=a=1.5*pt,i.l.info("backChannelRequestTimeoutMs_="+a)),a=i;const xt=o.g;if(xt){const At=xt.g?xt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(At){var _=a.i;_.g||-1==At.indexOf("spdy")&&-1==At.indexOf("quic")&&-1==At.indexOf("h2")||(_.j=_.l,_.g=new Set,_.h&&(sc(_,_.h),_.h=null))}if(a.F){const Ut=xt.g?xt.g.getResponseHeader("X-HTTP-Session-Id"):null;Ut&&(a.Da=Ut,Ii(a.I,a.F,Ut))}}i.H=3,i.h&&i.h.Ba(),i.ca&&(i.S=Date.now()-o.G,i.l.info("Handshake RTT: "+i.S+"ms"));var x=o;if((a=i).wa=hx(a,a.J?a.pa:null,a.Y),x.K){_i(a.i,x);var S=x,L=a.L;L&&S.setTimeout(L),S.B&&(kg(S),Dg(S)),a.g=x}else _v(a);0<i.j.length&&gv(i)}else"stop"!=B[0]&&"close"!=B[0]||Aa(i,7);else 3==i.H&&("stop"==B[0]||"close"==B[0]?"stop"==B[0]?Aa(i,7):ux(i):"noop"!=B[0]&&i.h&&i.h.Aa(B),i.A=0)}ol()}catch{}}function Aw(o,n){if(o.forEach&&"function"==typeof o.forEach)o.forEach(n,void 0);else if(Ru(o)||"string"==typeof o)Array.prototype.forEach.call(o,n,void 0);else for(var i=function Rg(o){if(o.ta&&"function"==typeof o.ta)return o.ta();if(!o.Z||"function"!=typeof o.Z){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(Ru(o)||"string"==typeof o){var n=[];o=o.length;for(var i=0;i<o;i++)n.push(i);return n}n=[],i=0;for(const a in o)n[i++]=a;return n}}}(o),a=function Sw(o){if(o.Z&&"function"==typeof o.Z)return o.Z();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if("string"==typeof o)return o.split("");if(Ru(o)){for(var n=[],i=o.length,a=0;a<i;a++)n.push(o[a]);return n}for(a in n=[],i=0,o)n[i++]=o[a];return n}(o),h=a.length,_=0;_<h;_++)n.call(void 0,a[_],i&&i[_],o)}(an=Zn.prototype).setTimeout=function(o){this.P=o},an.nb=function(o){o=o.target;const n=this.M;n&&3==al(o)?n.l():this.Pa(o)},an.Pa=function(o){try{if(o==this.g)t:{const H=al(this.g);var n=this.g.Ia();if(this.g.da(),!(3>H)&&(3!=H||Ig||this.g&&(this.h.h||this.g.ja()||kw(this.g)))){this.J||4!=H||7==n||ol(),kg(this);var i=this.g.da();this.ca=i;e:if(lv(this)){var a=kw(this.g);o="";var h=a.length,_=4==al(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){kr(this),O_(this);var x="";break e}this.h.i=new pr.TextDecoder}for(n=0;n<h;n++)this.h.h=!0,o+=this.h.i.decode(a[n],{stream:_&&n==h-1});a.splice(0,h),this.h.g+=o,this.C=0,x=this.h.g}else x=this.g.ja();if(this.i=200==i,function sv(o,n,i,a,h,_,x){o.info(function(){return"XMLHTTP RESP ("+a+") [ attempt "+h+"]: "+n+"\n"+i+"\n"+_+" "+x})}(this.j,this.u,this.A,this.m,this.W,H,i),this.i){if(this.aa&&!this.K){e:{if(this.g){var S,L=this.g;if((S=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p_(S)){var B=S;break e}}B=null}if(!(i=B)){this.i=!1,this.o=3,Dn(12),kr(this),O_(this);break t}ta(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Iw(this,i)}this.S?(cv(this,H,x),Ig&&this.i&&3==H&&(V0(this.U,this.V,"tick",this.mb),this.V.start())):(ta(this.j,this.m,x,null),Iw(this,x)),4==H&&kr(this),this.i&&!this.J&&(4==H?Ep(this.l,this):(this.i=!1,Dg(this)))}else(function lf(o){const n={};o=(o.g&&2<=al(o)&&o.g.getAllResponseHeaders()||"").split("\r\n");for(let a=0;a<o.length;a++){if(p_(o[a]))continue;var i=wP(o[a]);const h=i[0];if("string"!=typeof(i=i[1]))continue;i=i.trim();const _=n[h]||[];n[h]=_,_.push(i)}!function jn(o,n){for(const i in o)n.call(void 0,o[i],i,o)}(n,function(a){return a.join(", ")})})(this.g),400==i&&0<x.indexOf("Unknown SID")?(this.o=3,Dn(12)):(this.o=0,Dn(13)),kr(this),O_(this)}}}catch{}},an.mb=function(){if(this.g){var o=al(this.g),n=this.g.ja();this.C<n.length&&(kg(this),cv(this,o,n),this.i&&4!=o&&Dg(this))}},an.cancel=function(){this.J=!0,kr(this)},an.lb=function(){this.B=null;const o=Date.now();0<=o-this.Y?(function wT(o,n){o.info(function(){return"TIMEOUT: "+n})}(this.j,this.A),2!=this.L&&(ol(),Dn(17)),kr(this),this.o=2,O_(this)):Q0(this,this.Y-o)};var xp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Jh(o){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,o instanceof Jh){this.h=o.h,J0(this,o.j),this.s=o.s,this.g=o.g,Bo(this,o.m),this.l=o.l;var n=o.i,i=new Cp;i.i=n.i,n.g&&(i.g=new Map(n.g),i.h=n.h),uv(this,i),this.o=o.o}else o&&(n=String(o).match(xp))?(this.h=!1,J0(this,n[1]||"",!0),this.s=dt(n[2]||""),this.g=dt(n[3]||"",!0),Bo(this,n[4]),this.l=dt(n[5]||"",!0),uv(this,n[6]||"",!0),this.o=dt(n[7]||"")):(this.h=!1,this.i=new Cp(null,this.h))}function bt(o){return new Jh(o)}function J0(o,n,i){o.j=i?dt(n,!0):n,o.j&&(o.j=o.j.replace(/:$/,""))}function Bo(o,n){if(n){if(n=Number(n),isNaN(n)||0>n)throw Error("Bad port number "+n);o.m=n}else o.m=null}function uv(o,n,i){n instanceof Cp?(o.i=n,function TP(o,n){n&&!o.j&&(ef(o),o.i=null,o.g.forEach(function(i,a){var h=a.toLowerCase();a!=h&&(oc(this,a),Ir(this,h,i))},o)),o.j=n}(o.i,o.h)):(i||(n=dv(n,OP)),o.i=new Cp(n,o.h))}function Ii(o,n,i){o.i.set(n,i)}function tf(o){return Ii(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function dt(o,n){return o?n?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function dv(o,n,i){return"string"==typeof o?(o=encodeURI(o).replace(n,EP),i&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function EP(o){return"%"+((o=o.charCodeAt(0))>>4&15).toString(16)+(15&o).toString(16)}Jh.prototype.toString=function(){var o=[],n=this.j;n&&o.push(dv(n,Vc,!0),":");var i=this.g;return(i||"file"==n)&&(o.push("//"),(n=this.s)&&o.push(dv(n,Vc,!0),"@"),o.push(encodeURIComponent(String(i)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(i=this.m)&&o.push(":",String(i))),(i=this.l)&&(this.g&&"/"!=i.charAt(0)&&o.push("/"),o.push(dv(i,"/"==i.charAt(0)?tx:T_,!0))),(i=this.i.toString())&&o.push("?",i),(i=this.o)&&o.push("#",dv(i,wp)),o.join("")};var Vc=/[#\/\?@]/g,T_=/[#\?:]/g,tx=/[#\?]/g,OP=/[#\?@]/g,wp=/#/g;function Cp(o,n){this.h=this.g=null,this.i=o||null,this.j=!!n}function ef(o){o.g||(o.g=new Map,o.h=0,o.i&&function sl(o,n){if(o){o=o.split("&");for(var i=0;i<o.length;i++){var a=o[i].indexOf("="),h=null;if(0<=a){var _=o[i].substring(0,a);h=o[i].substring(a+1)}else _=o[i];n(_,h?decodeURIComponent(h.replace(/\+/g," ")):"")}}}(o.i,function(n,i){o.add(decodeURIComponent(n.replace(/\+/g," ")),i)}))}function oc(o,n){ef(o),n=nf(o,n),o.g.has(n)&&(o.i=null,o.h-=o.g.get(n).length,o.g.delete(n))}function hv(o,n){return ef(o),n=nf(o,n),o.g.has(n)}function Ir(o,n,i){oc(o,n),0<i.length&&(o.i=null,o.g.set(nf(o,n),f_(i)),o.h+=i.length)}function nf(o,n){return n=String(n),o.j&&(n=n.toLowerCase()),n}function nx(o){this.l=o||rx,o=pr.PerformanceNavigationTiming?0<(o=pr.performance.getEntriesByType("navigation")).length&&("hq"==o[0].nextHopProtocol||"h2"==o[0].nextHopProtocol):!!(pr.g&&pr.g.Ka&&pr.g.Ka()&&pr.g.Ka().ec),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(an=Cp.prototype).add=function(o,n){ef(this),this.i=null,o=nf(this,o);var i=this.g.get(o);return i||this.g.set(o,i=[]),i.push(n),this.h+=1,this},an.forEach=function(o,n){ef(this),this.g.forEach(function(i,a){i.forEach(function(h){o.call(n,h,a,this)},this)},this)},an.ta=function(){ef(this);const o=Array.from(this.g.values()),n=Array.from(this.g.keys()),i=[];for(let a=0;a<n.length;a++){const h=o[a];for(let _=0;_<h.length;_++)i.push(n[a])}return i},an.Z=function(o){ef(this);let n=[];if("string"==typeof o)hv(this,o)&&(n=n.concat(this.g.get(nf(this,o))));else{o=Array.from(this.g.values());for(let i=0;i<o.length;i++)n=n.concat(o[i])}return n},an.set=function(o,n){return ef(this),this.i=null,hv(this,o=nf(this,o))&&(this.h-=this.g.get(o).length),this.g.set(o,[n]),this.h+=1,this},an.get=function(o,n){return o&&0<(o=this.Z(o)).length?String(o[0]):n},an.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],n=Array.from(this.g.keys());for(var i=0;i<n.length;i++){var a=n[i];const _=encodeURIComponent(String(a)),x=this.Z(a);for(a=0;a<x.length;a++){var h=_;""!==x[a]&&(h+="="+encodeURIComponent(String(x[a]))),o.push(h)}}return this.i=o.join("&")};var rx=10;function IP(o){return!!o.h||!!o.g&&o.g.size>=o.j}function I_(o){return o.h?1:o.g?o.g.size:0}function ix(o,n){return o.h?o.h==n:!!o.g&&o.g.has(n)}function sc(o,n){o.g?o.g.add(n):o.h=n}function _i(o,n){o.h&&o.h==n?o.h=null:o.g&&o.g.has(n)&&o.g.delete(n)}function zu(o){if(null!=o.h)return o.i.concat(o.h.F);if(null!=o.g&&0!==o.g.size){let n=o.i;for(const i of o.g.values())n=n.concat(i.F);return n}return f_(o.i)}nx.prototype.cancel=function(){if(this.i=zu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const o of this.g.values())o.cancel();this.g.clear()}};var Bd=class{stringify(o){return pr.JSON.stringify(o,void 0)}parse(o){return pr.JSON.parse(o,void 0)}};function ea(){this.g=new Bd}function fv(o,n,i){const a=i||"";try{Aw(o,function(h,_){let x=h;ga(h)&&(x=N0(h)),n.push(a+_+"="+encodeURIComponent(x))})}catch(h){throw n.push(a+"type="+encodeURIComponent("_badmap")),h}}function Bu(o,n,i,a,h){try{n.onload=null,n.onerror=null,n.onabort=null,n.ontimeout=null,h(a)}catch{}}function na(o){this.l=o.fc||null,this.j=o.ob||!1}function ma(o,n){Fs.call(this),this.F=o,this.u=n,this.m=void 0,this.readyState=S_,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ci(na,H0),na.prototype.g=function(){return new ma(this.l,this.j)},na.prototype.i=function(o){return function(){return o}}({}),ci(ma,Fs);var S_=0;function ox(o){o.j.read().then(o.Xa.bind(o)).catch(o.ka.bind(o))}function Mp(o){o.readyState=4,o.l=null,o.j=null,o.A=null,sf(o)}function sf(o){o.onreadystatechange&&o.onreadystatechange.call(o)}(an=ma.prototype).open=function(o,n){if(this.readyState!=S_)throw this.abort(),Error("Error reopening a connection");this.C=o,this.B=n,this.readyState=1,sf(this)},an.send=function(o){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const n={headers:this.v,method:this.C,credentials:this.m,cache:void 0};o&&(n.body=o),(this.F||pr).fetch(new Request(this.B,n)).then(this.$a.bind(this),this.ka.bind(this))},an.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Mp(this)),this.readyState=S_},an.$a=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,sf(this)),this.g&&(this.readyState=3,sf(this),this.g)))if("arraybuffer"===this.responseType)o.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof pr.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ox(this)}else o.text().then(this.Za.bind(this),this.ka.bind(this))},an.Xa=function(o){if(this.g){if(this.u&&o.value)this.response.push(o.value);else if(!this.u){var n=o.value?o.value:new Uint8Array(0);(n=this.A.decode(n,{stream:!o.done}))&&(this.response=this.responseText+=n)}o.done?Mp(this):sf(this),3==this.readyState&&ox(this)}},an.Za=function(o){this.g&&(this.response=this.responseText=o,Mp(this))},an.Ya=function(o){this.g&&(this.response=o,Mp(this))},an.ka=function(){this.g&&Mp(this)},an.setRequestHeader=function(o,n){this.v.append(o,n)},an.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},an.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],n=this.h.entries();for(var i=n.next();!i.done;)o.push((i=i.value)[0]+": "+i[1]),i=n.next();return o.join("\r\n")},Object.defineProperty(ma.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(o){this.m=o?"include":"same-origin"}});var Dw=pr.JSON.parse;function Mi(o){Fs.call(this),this.headers=new Map,this.u=o||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Ud,this.L=this.M=!1}ci(Mi,Fs);var Ud="",SP=/^https?$/i,sx=["POST","PUT"];function pv(o,n){o.h=!1,o.g&&(o.l=!0,o.g.abort(),o.l=!1),o.j=n,o.m=5,lx(o),ra(o)}function lx(o){o.F||(o.F=!0,Js(o,"complete"),Js(o,"error"))}function A_(o){if(o.h&&typeof Pl<"u"&&(!o.C[1]||4!=al(o)||2!=o.da()))if(o.v&&4==al(o))C_(o.La,0,o);else if(Js(o,"readystatechange"),4==al(o)){o.h=!1;try{const x=o.da();t:switch(x){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break t;default:n=!1}var i;if(!(i=n)){var a;if(a=0===x){var h=String(o.I).match(xp)[1]||null;!h&&pr.self&&pr.self.location&&(h=pr.self.location.protocol.slice(0,-1)),a=!SP.test(h?h.toLowerCase():"")}i=a}if(i)Js(o,"complete"),Js(o,"success");else{o.m=6;try{var _=2<al(o)?o.g.statusText:""}catch{_=""}o.j=_+" ["+o.da()+"]",lx(o)}}finally{ra(o)}}}function ra(o,n){if(o.g){af(o);const i=o.g,a=o.C[0]?()=>{}:null;o.g=null,o.C=null,n||Js(o,"ready");try{i.onreadystatechange=a}catch{}}}function af(o){o.g&&o.L&&(o.g.ontimeout=null),o.A&&(pr.clearTimeout(o.A),o.A=null)}function al(o){return o.g?o.g.readyState:0}function kw(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.K){case Ud:case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function D_(o){let n="";return A0(o,function(i,a){n+=a,n+=":",n+=i,n+="\r\n"}),n}function Pp(o,n,i){t:{for(a in i){var a=!1;break t}a=!0}a||(i=D_(i),"string"==typeof o?null!=i&&encodeURIComponent(String(i)):Ii(o,n,i))}function k_(o,n,i){return i&&i.internalChannelParams&&i.internalChannelParams[o]||n}function cx(o){this.Ga=0,this.j=[],this.l=new j0,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=k_("failFast",!1,o),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=k_("baseRetryDelayMs",5e3,o),this.hb=k_("retryDelaySeedMs",1e4,o),this.eb=k_("forwardChannelMaxRetries",2,o),this.xa=k_("forwardChannelRequestTimeoutMs",2e4,o),this.va=o&&o.xmlHttpFactory||void 0,this.Ha=o&&o.dc||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.i=new nx(o&&o.concurrentRequestLimit),this.Ja=new ea,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=o&&o.bc||!1,o&&o.Ea&&this.l.Ea(),o&&o.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&o&&o.detectBufferingProxy||!1,this.qa=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.qa=o.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function ux(o){if(AP(o),3==o.H){var n=o.W++,i=bt(o.I);if(Ii(i,"SID",o.K),Ii(i,"RID",n),Ii(i,"TYPE","terminate"),Uu(o,i),(n=new Zn(o,o.l,n)).L=2,n.v=tf(bt(i)),i=!1,pr.navigator&&pr.navigator.sendBeacon)try{i=pr.navigator.sendBeacon(n.v.toString(),"")}catch{}!i&&pr.Image&&((new Image).src=n.v,i=!0),i||(n.g=Lw(n.l,null),n.g.ha(n.v)),n.G=Date.now(),Dg(n)}kn(o)}function Po(o){o.g&&(Rw(o),o.g.cancel(),o.g=null)}function AP(o){Po(o),o.u&&(pr.clearTimeout(o.u),o.u=null),dx(o),o.i.cancel(),o.m&&("number"==typeof o.m&&pr.clearTimeout(o.m),o.m=null)}function gv(o){if(!IP(o.i)&&!o.m){o.m=!0;var n=o.Na;F0||Ew(),Bc||(F0(),Bc=!0),Sa.add(n,o),o.C=0}}function DP(o,n){var i;i=n?n.m:o.W++;const a=bt(o.I);Ii(a,"SID",o.K),Ii(a,"RID",i),Ii(a,"AID",o.V),Uu(o,a),o.o&&o.s&&Pp(a,o.o,o.s),i=new Zn(o,o.l,i,o.C+1),null===o.o&&(i.I=o.s),n&&(o.j=n.F.concat(o.j)),n=Lg(o,i,1e3),i.setTimeout(Math.round(.5*o.xa)+Math.round(.5*o.xa*Math.random())),sc(o.i,i),av(i,a,n)}function Uu(o,n){o.na&&A0(o.na,function(i,a){Ii(n,a,i)}),o.h&&Aw({},function(i,a){Ii(n,a,i)})}function Lg(o,n,i){i=Math.min(o.j.length,i);var a=o.h?Xi(o.h.Va,o.h,o):null;t:{var h=o.j;let _=-1;for(;;){const x=["count="+i];-1==_?0<i?(_=h[0].g,x.push("ofs="+_)):_=0:x.push("ofs="+_);let S=!0;for(let L=0;L<i;L++){let B=h[L].g;const H=h[L].map;if(B-=_,0>B)_=Math.max(0,h[L].g-100),S=!1;else try{fv(H,x,"req"+B+"_")}catch{a&&a(H)}}if(S){a=x.join("&");break t}}}return o=o.j.splice(0,i),n.F=o,a}function _v(o){if(!o.g&&!o.u){o.ba=1;var n=o.Ma;F0||Ew(),Bc||(F0(),Bc=!0),Sa.add(n,o),o.A=0}}function yv(o){return!(o.g||o.u||3<=o.A||(o.ba++,o.u=ms(Xi(o.Ma,o),vv(o,o.A)),o.A++,0))}function Rw(o){null!=o.B&&(pr.clearTimeout(o.B),o.B=null)}function kP(o){o.g=new Zn(o,o.l,"rpc",o.ba),null===o.o&&(o.g.I=o.s),o.g.O=0;var n=bt(o.wa);Ii(n,"RID","rpc"),Ii(n,"SID",o.K),Ii(n,"AID",o.V),Ii(n,"CI",o.G?"0":"1"),!o.G&&o.qa&&Ii(n,"TO",o.qa),Ii(n,"TYPE","xmlhttp"),Uu(o,n),o.o&&o.s&&Pp(n,o.o,o.s),o.L&&o.g.setTimeout(o.L);var i=o.g;o=o.pa,i.L=1,i.v=tf(bt(n)),i.s=null,i.S=!0,X0(i,o)}function dx(o){null!=o.v&&(pr.clearTimeout(o.v),o.v=null)}function Ep(o,n){var i=null;if(o.g==n){dx(o),Rw(o),o.g=null;var a=2}else{if(!ix(o.i,n))return;i=n.F,_i(o.i,n),a=1}if(0!=o.H)if(n.i)if(1==a){i=n.s?n.s.length:0,n=Date.now()-n.G;var h=o.C;Js(a=P_(),new G0(a,i)),gv(o)}else _v(o);else if(3==(h=n.o)||0==h&&0<n.ca||!(1==a&&function mv(o,n){return!(I_(o.i)>=o.i.j-(o.m?1:0)||(o.m?(o.j=n.F.concat(o.j),0):1==o.H||2==o.H||o.C>=(o.cb?0:o.eb)||(o.m=ms(Xi(o.Na,o,n),vv(o,o.C)),o.C++,0)))}(o,n)||2==a&&yv(o)))switch(i&&0<i.length&&(n=o.i,n.i=n.i.concat(i)),h){case 1:Aa(o,5);break;case 4:Aa(o,10);break;case 3:Aa(o,6);break;default:Aa(o,2)}}function vv(o,n){let i=o.ab+Math.floor(Math.random()*o.hb);return o.isActive()||(i*=2),i*n}function Aa(o,n){if(o.l.info("Error code "+n),2==n){var i=null;o.h&&(i=null);var a=Xi(o.pb,o);i||(i=new Jh("//www.google.com/images/cleardot.gif"),pr.location&&"http"==pr.location.protocol||J0(i,"https"),tf(i)),function rf(o,n){const i=new j0;if(pr.Image){const a=new Image;a.onload=zo(Bu,i,a,"TestLoadImage: loaded",!0,n),a.onerror=zo(Bu,i,a,"TestLoadImage: error",!1,n),a.onabort=zo(Bu,i,a,"TestLoadImage: abort",!1,n),a.ontimeout=zo(Bu,i,a,"TestLoadImage: timeout",!1,n),pr.setTimeout(function(){a.ontimeout&&a.ontimeout()},1e4),a.src=o}else n(!1)}(i.toString(),a)}else Dn(2);o.H=0,o.h&&o.h.za(n),kn(o),AP(o)}function kn(o){if(o.H=0,o.ma=[],o.h){const n=zu(o.i);(0!=n.length||0!=o.j.length)&&(Di(o.ma,n),Di(o.ma,o.j),o.i.i.length=0,f_(o.j),o.j.length=0),o.h.ya()}}function hx(o,n,i){var a=i instanceof Jh?bt(i):new Jh(i);if(""!=a.g)n&&(a.g=n+"."+a.g),Bo(a,a.m);else{var h=pr.location;a=h.protocol,n=n?n+"."+h.hostname:h.hostname,h=+h.port;var _=new Jh(null);a&&J0(_,a),n&&(_.g=n),h&&Bo(_,h),i&&(_.l=i),a=_}return n=o.Da,(i=o.F)&&n&&Ii(a,i,n),Ii(a,"VER",o.ra),Uu(o,a),a}function Lw(o,n,i){if(n&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return(n=new Mi(i&&o.Ha&&!o.va?new na({ob:!0}):o.va)).Oa(o.J),n}function bv(){}function yo(){if(Tg&&!(10<=Number(S0)))throw Error("Environmental error: no available transport.")}function Pi(o,n){Fs.call(this),this.g=new cx(n),this.l=o,this.h=n&&n.messageUrlParams||null,o=n&&n.messageHeaders||null,n&&n.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.s=o,o=n&&n.initMessageHeaders||null,n&&n.messageContentType&&(o?o["X-WebChannel-Content-Type"]=n.messageContentType:o={"X-WebChannel-Content-Type":n.messageContentType}),n&&n.Ca&&(o?o["X-WebChannel-Client-Profile"]=n.Ca:o={"X-WebChannel-Client-Profile":n.Ca}),this.g.U=o,(o=n&&n.cc)&&!p_(o)&&(this.g.o=o),this.A=n&&n.supportsCrossDomainXhr||!1,this.v=n&&n.sendRawJson||!1,(n=n&&n.httpSessionIdParam)&&!p_(n)&&(this.g.F=n,null!==(o=this.h)&&n in o&&n in(o=this.h)&&delete o[n]),this.j=new Ji(this)}function ii(o){W0.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var n=o.__sm__;if(n){t:{for(const i in n){o=i;break t}o=void 0}(this.i=o)&&(o=this.i,n=null!==n&&o in n?n[o]:void 0),this.data=n}else this.data=o}function Da(){K0.call(this),this.status=1}function Ji(o){this.g=o}function yi(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function xv(o,n,i){i||(i=0);var a=Array(16);if("string"==typeof n)for(var h=0;16>h;++h)a[h]=n.charCodeAt(i++)|n.charCodeAt(i++)<<8|n.charCodeAt(i++)<<16|n.charCodeAt(i++)<<24;else for(h=0;16>h;++h)a[h]=n[i++]|n[i++]<<8|n[i++]<<16|n[i++]<<24;var _=o.g[3],x=(n=o.g[0])+(_^(i=o.g[1])&((h=o.g[2])^_))+a[0]+3614090360&4294967295;x=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=(i=(h=(_=(n=i+(x<<7&4294967295|x>>>25))+((x=_+(h^n&(i^h))+a[1]+3905402710&4294967295)<<12&4294967295|x>>>20))+((x=h+(i^_&(n^i))+a[2]+606105819&4294967295)<<17&4294967295|x>>>15))+((x=i+(n^h&(_^n))+a[3]+3250441966&4294967295)<<22&4294967295|x>>>10))+((x=n+(_^i&(h^_))+a[4]+4118548399&4294967295)<<7&4294967295|x>>>25))+((x=_+(h^n&(i^h))+a[5]+1200080426&4294967295)<<12&4294967295|x>>>20))+((x=h+(i^_&(n^i))+a[6]+2821735955&4294967295)<<17&4294967295|x>>>15))+((x=i+(n^h&(_^n))+a[7]+4249261313&4294967295)<<22&4294967295|x>>>10))+((x=n+(_^i&(h^_))+a[8]+1770035416&4294967295)<<7&4294967295|x>>>25))+((x=_+(h^n&(i^h))+a[9]+2336552879&4294967295)<<12&4294967295|x>>>20))+((x=h+(i^_&(n^i))+a[10]+4294925233&4294967295)<<17&4294967295|x>>>15))+((x=i+(n^h&(_^n))+a[11]+2304563134&4294967295)<<22&4294967295|x>>>10))+((x=n+(_^i&(h^_))+a[12]+1804603682&4294967295)<<7&4294967295|x>>>25))+((x=_+(h^n&(i^h))+a[13]+4254626195&4294967295)<<12&4294967295|x>>>20))+((x=h+(i^_&(n^i))+a[14]+2792965006&4294967295)<<17&4294967295|x>>>15))+((x=i+(n^h&(_^n))+a[15]+1236535329&4294967295)<<22&4294967295|x>>>10))+((x=n+(h^_&(i^h))+a[1]+4129170786&4294967295)<<5&4294967295|x>>>27))+((x=_+(i^h&(n^i))+a[6]+3225465664&4294967295)<<9&4294967295|x>>>23))+((x=h+(n^i&(_^n))+a[11]+643717713&4294967295)<<14&4294967295|x>>>18))+((x=i+(_^n&(h^_))+a[0]+3921069994&4294967295)<<20&4294967295|x>>>12))+((x=n+(h^_&(i^h))+a[5]+3593408605&4294967295)<<5&4294967295|x>>>27))+((x=_+(i^h&(n^i))+a[10]+38016083&4294967295)<<9&4294967295|x>>>23))+((x=h+(n^i&(_^n))+a[15]+3634488961&4294967295)<<14&4294967295|x>>>18))+((x=i+(_^n&(h^_))+a[4]+3889429448&4294967295)<<20&4294967295|x>>>12))+((x=n+(h^_&(i^h))+a[9]+568446438&4294967295)<<5&4294967295|x>>>27))+((x=_+(i^h&(n^i))+a[14]+3275163606&4294967295)<<9&4294967295|x>>>23))+((x=h+(n^i&(_^n))+a[3]+4107603335&4294967295)<<14&4294967295|x>>>18))+((x=i+(_^n&(h^_))+a[8]+1163531501&4294967295)<<20&4294967295|x>>>12))+((x=n+(h^_&(i^h))+a[13]+2850285829&4294967295)<<5&4294967295|x>>>27))+((x=_+(i^h&(n^i))+a[2]+4243563512&4294967295)<<9&4294967295|x>>>23))+((x=h+(n^i&(_^n))+a[7]+1735328473&4294967295)<<14&4294967295|x>>>18))+((x=i+(_^n&(h^_))+a[12]+2368359562&4294967295)<<20&4294967295|x>>>12))+((x=n+(i^h^_)+a[5]+4294588738&4294967295)<<4&4294967295|x>>>28))+((x=_+(n^i^h)+a[8]+2272392833&4294967295)<<11&4294967295|x>>>21))+((x=h+(_^n^i)+a[11]+1839030562&4294967295)<<16&4294967295|x>>>16))+((x=i+(h^_^n)+a[14]+4259657740&4294967295)<<23&4294967295|x>>>9))+((x=n+(i^h^_)+a[1]+2763975236&4294967295)<<4&4294967295|x>>>28))+((x=_+(n^i^h)+a[4]+1272893353&4294967295)<<11&4294967295|x>>>21))+((x=h+(_^n^i)+a[7]+4139469664&4294967295)<<16&4294967295|x>>>16))+((x=i+(h^_^n)+a[10]+3200236656&4294967295)<<23&4294967295|x>>>9))+((x=n+(i^h^_)+a[13]+681279174&4294967295)<<4&4294967295|x>>>28))+((x=_+(n^i^h)+a[0]+3936430074&4294967295)<<11&4294967295|x>>>21))+((x=h+(_^n^i)+a[3]+3572445317&4294967295)<<16&4294967295|x>>>16))+((x=i+(h^_^n)+a[6]+76029189&4294967295)<<23&4294967295|x>>>9))+((x=n+(i^h^_)+a[9]+3654602809&4294967295)<<4&4294967295|x>>>28))+((x=_+(n^i^h)+a[12]+3873151461&4294967295)<<11&4294967295|x>>>21))+((x=h+(_^n^i)+a[15]+530742520&4294967295)<<16&4294967295|x>>>16))+((x=i+(h^_^n)+a[2]+3299628645&4294967295)<<23&4294967295|x>>>9))+((x=n+(h^(i|~_))+a[0]+4096336452&4294967295)<<6&4294967295|x>>>26))+((x=_+(i^(n|~h))+a[7]+1126891415&4294967295)<<10&4294967295|x>>>22))+((x=h+(n^(_|~i))+a[14]+2878612391&4294967295)<<15&4294967295|x>>>17))+((x=i+(_^(h|~n))+a[5]+4237533241&4294967295)<<21&4294967295|x>>>11))+((x=n+(h^(i|~_))+a[12]+1700485571&4294967295)<<6&4294967295|x>>>26))+((x=_+(i^(n|~h))+a[3]+2399980690&4294967295)<<10&4294967295|x>>>22))+((x=h+(n^(_|~i))+a[10]+4293915773&4294967295)<<15&4294967295|x>>>17))+((x=i+(_^(h|~n))+a[1]+2240044497&4294967295)<<21&4294967295|x>>>11))+((x=n+(h^(i|~_))+a[8]+1873313359&4294967295)<<6&4294967295|x>>>26))+((x=_+(i^(n|~h))+a[15]+4264355552&4294967295)<<10&4294967295|x>>>22))+((x=h+(n^(_|~i))+a[6]+2734768916&4294967295)<<15&4294967295|x>>>17))+((x=i+(_^(h|~n))+a[13]+1309151649&4294967295)<<21&4294967295|x>>>11))+((_=(n=i+((x=n+(h^(i|~_))+a[4]+4149444226&4294967295)<<6&4294967295|x>>>26))+((x=_+(i^(n|~h))+a[11]+3174756917&4294967295)<<10&4294967295|x>>>22))^((h=_+((x=h+(n^(_|~i))+a[2]+718787259&4294967295)<<15&4294967295|x>>>17))|~n))+a[9]+3951481745&4294967295,o.g[0]=o.g[0]+n&4294967295,o.g[1]=o.g[1]+(h+(x<<21&4294967295|x>>>11))&4294967295,o.g[2]=o.g[2]+h&4294967295,o.g[3]=o.g[3]+_&4294967295}function pi(o,n){this.h=n;for(var i=[],a=!0,h=o.length-1;0<=h;h--){var _=0|o[h];a&&_==n||(i[h]=_,a=!1)}this.g=i}(an=Mi.prototype).Oa=function(o){this.M=o},an.ha=function(o,n,i,a){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+o);n=n?n.toUpperCase():"GET",this.I=o,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Y0.g(),this.C=function q0(o){return o.h||(o.h=o.i())}(this.u?this.u:Y0),this.g.onreadystatechange=Xi(this.La,this);try{this.G=!0,this.g.open(n,String(o),!0),this.G=!1}catch(_){return void pv(this,_)}if(o=i||"",i=new Map(this.headers),a)if(Object.getPrototypeOf(a)===Object.prototype)for(var h in a)i.set(h,a[h]);else{if("function"!=typeof a.keys||"function"!=typeof a.get)throw Error("Unknown input type for opt_headers: "+String(a));for(const _ of a.keys())i.set(_,a.get(_))}a=Array.from(i.keys()).find(_=>"content-type"==_.toLowerCase()),h=pr.FormData&&o instanceof pr.FormData,!(0<=xw(sx,n))||a||h||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_,x]of i)this.g.setRequestHeader(_,x);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{af(this),0<this.B&&((this.L=function ax(o){return Tg&&"number"==typeof o.timeout&&void 0!==o.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Xi(this.ua,this)):this.A=C_(this.ua,this.B,this)),this.v=!0,this.g.send(o),this.v=!1}catch(_){pv(this,_)}},an.ua=function(){typeof Pl<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Js(this,"timeout"),this.abort(8))},an.abort=function(o){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=o||7,Js(this,"complete"),Js(this,"abort"),ra(this))},an.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ra(this,!0)),Mi.$.N.call(this)},an.La=function(){this.s||(this.G||this.v||this.l?A_(this):this.kb())},an.kb=function(){A_(this)},an.isActive=function(){return!!this.g},an.da=function(){try{return 2<al(this)?this.g.status:-1}catch{return-1}},an.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},an.Wa=function(o){if(this.g){var n=this.g.responseText;return o&&0==n.indexOf(o)&&(n=n.substring(o.length)),Dw(n)}},an.Ia=function(){return this.m},an.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(an=cx.prototype).ra=8,an.H=1,an.Na=function(o){if(this.m)if(this.m=null,1==this.H){if(!o){this.W=Math.floor(1e5*Math.random()),o=this.W++;const h=new Zn(this,this.l,o);let _=this.s;if(this.U&&(_?(_=qn(_),Nu(_,this.U)):_=this.U),null!==this.o||this.O||(h.I=_,_=null),this.P)t:{for(var n=0,i=0;i<this.j.length;i++){var a=this.j[i];if(void 0===(a="__data__"in a.map&&"string"==typeof(a=a.map.__data__)?a.length:void 0))break;if(4096<(n+=a)){n=i;break t}if(4096===n||i===this.j.length-1){n=i+1;break t}}n=1e3}else n=1e3;n=Lg(this,h,n),Ii(i=bt(this.I),"RID",o),Ii(i,"CVER",22),this.F&&Ii(i,"X-HTTP-Session-Id",this.F),Uu(this,i),_&&(this.O?n="headers="+encodeURIComponent(String(D_(_)))+"&"+n:this.o&&Pp(i,this.o,_)),sc(this.i,h),this.bb&&Ii(i,"TYPE","init"),this.P?(Ii(i,"$req",n),Ii(i,"SID","null"),h.aa=!0,av(h,i,null)):av(h,i,n),this.H=2}}else 3==this.H&&(o?DP(this,o):0==this.j.length||IP(this.i)||DP(this))},an.Ma=function(){if(this.u=null,kP(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var o=2*this.S;this.l.info("BP detection timer enabled: "+o),this.B=ms(Xi(this.jb,this),o)}},an.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Dn(10),Po(this),kP(this))},an.ib=function(){null!=this.v&&(this.v=null,Po(this),yv(this),Dn(19))},an.pb=function(o){o?(this.l.info("Successfully pinged google.com"),Dn(2)):(this.l.info("Failed to ping google.com"),Dn(1))},an.isActive=function(){return!!this.h&&this.h.isActive(this)},(an=bv.prototype).Ba=function(){},an.Aa=function(){},an.za=function(){},an.ya=function(){},an.isActive=function(){return!0},an.Va=function(){},yo.prototype.g=function(o,n){return new Pi(o,n)},ci(Pi,Fs),Pi.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var o=this.g,n=this.l,i=this.h||void 0;Dn(0),o.Y=n,o.na=i||{},o.G=o.aa,o.I=hx(o,null,o.Y),gv(o)},Pi.prototype.close=function(){ux(this.g)},Pi.prototype.u=function(o){var n=this.g;if("string"==typeof o){var i={};i.__data__=o,o=i}else this.v&&((i={}).__data__=N0(o),o=i);n.j.push(new class{constructor(o,n){this.g=o,this.map=n}}(n.fb++,o)),3==n.H&&gv(n)},Pi.prototype.N=function(){this.g.h=null,delete this.j,ux(this.g),delete this.g,Pi.$.N.call(this)},ci(ii,W0),ci(Da,K0),ci(Ji,bv),Ji.prototype.Ba=function(){Js(this.g,"a")},Ji.prototype.Aa=function(o){Js(this.g,new ii(o))},Ji.prototype.za=function(o){Js(this.g,new Da)},Ji.prototype.ya=function(){Js(this.g,"b")},ci(yi,function RP(){this.blockSize=-1}),yi.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},yi.prototype.j=function(o,n){void 0===n&&(n=o.length);for(var i=n-this.blockSize,a=this.m,h=this.h,_=0;_<n;){if(0==h)for(;_<=i;)xv(this,o,_),_+=this.blockSize;if("string"==typeof o){for(;_<n;)if(a[h++]=o.charCodeAt(_++),h==this.blockSize){xv(this,a),h=0;break}}else for(;_<n;)if(a[h++]=o[_++],h==this.blockSize){xv(this,a),h=0;break}}this.h=h,this.i+=n},yi.prototype.l=function(){var o=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);o[0]=128;for(var n=1;n<o.length-8;++n)o[n]=0;var i=8*this.i;for(n=o.length-8;n<o.length;++n)o[n]=255&i,i/=256;for(this.j(o),o=Array(16),n=i=0;4>n;++n)for(var a=0;32>a;a+=8)o[i++]=this.g[n]>>>a&255;return o};var ac={};function Op(o){return-128<=o&&128>o?function T0(o,n){var i=ac;return Object.prototype.hasOwnProperty.call(i,o)?i[o]:i[o]=n(o)}(o,function(n){return new pi([0|n],0>n?-1:0)}):new pi([0|o],0>o?-1:0)}function Xn(o){if(isNaN(o)||!isFinite(o))return Vd;if(0>o)return Ei(Xn(-o));for(var n=[],i=1,a=0;o>=i;a++)n[a]=o/i|0,i*=Vu;return new pi(n,0)}var Vu=4294967296,Vd=Op(0),Nw=Op(1),Fw=Op(16777216);function jd(o){if(0!=o.h)return!1;for(var n=0;n<o.g.length;n++)if(0!=o.g[n])return!1;return!0}function Ol(o){return-1==o.h}function Ei(o){for(var n=o.g.length,i=[],a=0;a<n;a++)i[a]=~o.g[a];return new pi(i,~o.h).add(Nw)}function jc(o,n){return o.add(Ei(n))}function Ng(o,n){for(;(65535&o[n])!=o[n];)o[n+1]+=o[n]>>>16,o[n]&=65535,n++}function Fg(o,n){this.g=o,this.h=n}function Wo(o,n){if(jd(n))throw Error("division by zero");if(jd(o))return new Fg(Vd,Vd);if(Ol(o))return n=Wo(Ei(o),n),new Fg(Ei(n.g),Ei(n.h));if(Ol(n))return n=Wo(o,Ei(n)),new Fg(Ei(n.g),n.h);if(30<o.g.length){if(Ol(o)||Ol(n))throw Error("slowDivide_ only works with positive integers.");for(var i=Nw,a=n;0>=a.X(o);)i=zw(i),a=zw(a);var h=Tp(i,1),_=Tp(a,1);for(a=Tp(a,2),i=Tp(i,2);!jd(a);){var x=_.add(a);0>=x.X(o)&&(h=h.add(i),_=x),a=Tp(a,1),i=Tp(i,1)}return n=jc(o,h.R(n)),new Fg(h,n)}for(h=Vd;0<=o.X(n);){for(i=Math.max(1,Math.floor(o.ea()/n.ea())),a=48>=(a=Math.ceil(Math.log(i)/Math.LN2))?1:Math.pow(2,a-48),x=(_=Xn(i)).R(n);Ol(x)||0<x.X(o);)x=(_=Xn(i-=a)).R(n);jd(_)&&(_=Nw),h=h.add(_),o=jc(o,x)}return new Fg(h,o)}function zw(o){for(var n=o.g.length+1,i=[],a=0;a<n;a++)i[a]=o.D(a)<<1|o.D(a-1)>>>31;return new pi(i,o.h)}function Tp(o,n){var i=n>>5;n%=32;for(var a=o.g.length-i,h=[],_=0;_<a;_++)h[_]=0<n?o.D(_+i)>>>n|o.D(_+i+1)<<32-n:o.D(_+i);return new pi(h,o.h)}(an=pi.prototype).ea=function(){if(Ol(this))return-Ei(this).ea();for(var o=0,n=1,i=0;i<this.g.length;i++){var a=this.D(i);o+=(0<=a?a:Vu+a)*n,n*=Vu}return o},an.toString=function(o){if(2>(o=o||10)||36<o)throw Error("radix out of range: "+o);if(jd(this))return"0";if(Ol(this))return"-"+Ei(this).toString(o);for(var n=Xn(Math.pow(o,6)),i=this,a="";;){var h=Wo(i,n).g,_=((0<(i=jc(i,h.R(n))).g.length?i.g[0]:i.h)>>>0).toString(o);if(jd(i=h))return _+a;for(;6>_.length;)_="0"+_;a=_+a}},an.D=function(o){return 0>o?0:o<this.g.length?this.g[o]:this.h},an.X=function(o){return Ol(o=jc(this,o))?-1:jd(o)?0:1},an.abs=function(){return Ol(this)?Ei(this):this},an.add=function(o){for(var n=Math.max(this.g.length,o.g.length),i=[],a=0,h=0;h<=n;h++){var _=a+(65535&this.D(h))+(65535&o.D(h)),x=(_>>>16)+(this.D(h)>>>16)+(o.D(h)>>>16);a=x>>>16,i[h]=(x&=65535)<<16|(_&=65535)}return new pi(i,-2147483648&i[i.length-1]?-1:0)},an.R=function(o){if(jd(this)||jd(o))return Vd;if(Ol(this))return Ol(o)?Ei(this).R(Ei(o)):Ei(Ei(this).R(o));if(Ol(o))return Ei(this.R(Ei(o)));if(0>this.X(Fw)&&0>o.X(Fw))return Xn(this.ea()*o.ea());for(var n=this.g.length+o.g.length,i=[],a=0;a<2*n;a++)i[a]=0;for(a=0;a<this.g.length;a++)for(var h=0;h<o.g.length;h++){var _=this.D(a)>>>16,x=65535&this.D(a),S=o.D(h)>>>16,L=65535&o.D(h);i[2*a+2*h]+=x*L,Ng(i,2*a+2*h),i[2*a+2*h+1]+=_*L,Ng(i,2*a+2*h+1),i[2*a+2*h+1]+=x*S,Ng(i,2*a+2*h+1),i[2*a+2*h+2]+=_*S,Ng(i,2*a+2*h+2)}for(a=0;a<n;a++)i[a]=i[2*a+1]<<16|i[2*a];for(a=n;a<2*n;a++)i[a]=0;return new pi(i,0)},an.gb=function(o){return Wo(this,o).h},an.and=function(o){for(var n=Math.max(this.g.length,o.g.length),i=[],a=0;a<n;a++)i[a]=this.D(a)&o.D(a);return new pi(i,this.h&o.h)},an.or=function(o){for(var n=Math.max(this.g.length,o.g.length),i=[],a=0;a<n;a++)i[a]=this.D(a)|o.D(a);return new pi(i,this.h|o.h)},an.xor=function(o){for(var n=Math.max(this.g.length,o.g.length),i=[],a=0;a<n;a++)i[a]=this.D(a)^o.D(a);return new pi(i,this.h^o.h)},yo.prototype.createWebChannel=yo.prototype.g,Pi.prototype.send=Pi.prototype.u,Pi.prototype.open=Pi.prototype.m,Pi.prototype.close=Pi.prototype.close,Uc.NO_ERROR=0,Uc.TIMEOUT=8,Uc.HTTP_ERROR=6,vp.COMPLETE="complete",Z0.EventType=Sg,Sg.OPEN="a",Sg.CLOSE="b",Sg.ERROR="c",Sg.MESSAGE="d",Fs.prototype.listen=Fs.prototype.O,Mi.prototype.listenOnce=Mi.prototype.P,Mi.prototype.getLastError=Mi.prototype.Sa,Mi.prototype.getLastErrorCode=Mi.prototype.Ia,Mi.prototype.getStatus=Mi.prototype.da,Mi.prototype.getResponseJson=Mi.prototype.Wa,Mi.prototype.getResponseText=Mi.prototype.ja,Mi.prototype.send=Mi.prototype.ha,Mi.prototype.setWithCredentials=Mi.prototype.Oa,yi.prototype.digest=yi.prototype.l,yi.prototype.reset=yi.prototype.reset,yi.prototype.update=yi.prototype.j,pi.prototype.add=pi.prototype.add,pi.prototype.multiply=pi.prototype.R,pi.prototype.modulo=pi.prototype.gb,pi.prototype.compare=pi.prototype.X,pi.prototype.toNumber=pi.prototype.ea,pi.prototype.toString=pi.prototype.toString,pi.prototype.getBits=pi.prototype.D,pi.fromNumber=Xn,pi.fromString=function R_(o,n){if(0==o.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==o.charAt(0))return Ei(R_(o.substring(1),n));if(0<=o.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=Xn(Math.pow(n,8)),a=Vd,h=0;h<o.length;h+=8){var _=Math.min(8,o.length-h),x=parseInt(o.substring(h,h+_),n);8>_?(_=Xn(Math.pow(n,_)),a=a.R(_).add(Xn(x))):a=(a=a.R(i)).add(Xn(x))}return a};var LP=Ia.createWebChannelTransport=function(){return new yo},MT=Ia.getStatEventTarget=function(){return P_()},zg=Ia.ErrorCode=Uc,NP=Ia.EventType=vp,fx=Ia.Event=yp,Bw=Ia.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Uw=Ia.FetchXmlHttpFactory=na,$c=Ia.WebChannel=Z0,FP=Ia.XhrIo=Mi,zP=Ia.Md5=yi,ju=Ia.Integer=pi;const wv="@firebase/firestore";class so{constructor(n){this.uid=n}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(n){return n.uid===this.uid}}so.UNAUTHENTICATED=new so(null),so.GOOGLE_CREDENTIALS=new so("google-credentials-uid"),so.FIRST_PARTY=new so("first-party-uid"),so.MOCK_USER=new so("mock-user");let _a="9.23.0";const Tl=new Kl.Yd("@firebase/firestore");function px(){return Tl.logLevel}function ze(o,...n){if(Tl.logLevel<=Kl.in.DEBUG){const i=n.map(Ip);Tl.debug(`Firestore (${_a}): ${o}`,...i)}}function rs(o,...n){if(Tl.logLevel<=Kl.in.ERROR){const i=n.map(Ip);Tl.error(`Firestore (${_a}): ${o}`,...i)}}function lc(o,...n){if(Tl.logLevel<=Kl.in.WARN){const i=n.map(Ip);Tl.warn(`Firestore (${_a}): ${o}`,...i)}}function Ip(o){if("string"==typeof o)return o;try{return JSON.stringify(o)}catch{return o}}function wn(o="Unexpected state"){const n=`FIRESTORE (${_a}) INTERNAL ASSERTION FAILED: `+o;throw rs(n),new Error(n)}function $n(o,n){o||wn()}function _n(o,n){return o}const Jt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends $r.ZR{constructor(n,i){super(n,i),this.code=n,this.message=i,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ss{constructor(){this.promise=new Promise((n,i)=>{this.resolve=n,this.reject=i})}}class gx{constructor(n,i){this.user=i,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${n}`)}}class UP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(n,i){n.enqueueRetryable(()=>i(so.UNAUTHENTICATED))}shutdown(){}}class cf{constructor(n){this.token=n,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(n,i){this.changeListener=i,n.enqueueRetryable(()=>i(this.token.user))}shutdown(){this.changeListener=null}}class Uo{constructor(n){this.t=n,this.currentUser=so.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(n,i){var a=this;let h=this.i;const _=B=>this.i!==h?(h=this.i,i(B)):Promise.resolve();let x=new Ss;this.o=()=>{this.i++,this.currentUser=this.u(),x.resolve(),x=new Ss,n.enqueueRetryable(()=>_(this.currentUser))};const S=()=>{const B=x;n.enqueueRetryable((0,Je.Z)(function*(){yield B.promise,yield _(a.currentUser)}))},L=B=>{ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=B,this.auth.addAuthTokenListener(this.o),S()};this.t.onInit(B=>L(B)),setTimeout(()=>{if(!this.auth){const B=this.t.getImmediate({optional:!0});B?L(B):(ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),x.resolve(),x=new Ss)}},0),S()}getToken(){const n=this.i,i=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(i).then(a=>this.i!==n?(ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?($n("string"==typeof a.accessToken),new gx(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const n=this.auth&&this.auth.getUid();return $n(null===n||"string"==typeof n),new so(n)}}class PT{constructor(n,i,a){this.h=n,this.l=i,this.m=a,this.type="FirstParty",this.user=so.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const n=this.p();return n&&this.g.set("Authorization",n),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class VP{constructor(n,i,a){this.h=n,this.l=i,this.m=a}getToken(){return Promise.resolve(new PT(this.h,this.l,this.m))}start(n,i){n.enqueueRetryable(()=>i(so.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Vw{constructor(n){this.value=n,this.type="AppCheck",this.headers=new Map,n&&n.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class jw{constructor(n){this.I=n,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(n,i){const a=_=>{null!=_.error&&ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${_.error.message}`);const x=_.token!==this.T;return this.T=_.token,ze("FirebaseAppCheckTokenProvider",`Received ${x?"new":"existing"} token.`),x?i(_.token):Promise.resolve()};this.o=_=>{n.enqueueRetryable(()=>a(_))};const h=_=>{ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=_,this.appCheck.addTokenListener(this.o)};this.I.onInit(_=>h(_)),setTimeout(()=>{if(!this.appCheck){const _=this.I.getImmediate({optional:!0});_?h(_):ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const n=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(n).then(i=>i?($n("string"==typeof i.token),this.T=i.token,new Vw(i.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function jP(o){const n=typeof self<"u"&&(self.crypto||self.msCrypto),i=new Uint8Array(o);if(n&&"function"==typeof n.getRandomValues)n.getRandomValues(i);else for(let a=0;a<o;a++)i[a]=Math.floor(256*Math.random());return i}class Gw{static A(){const i=62*Math.floor(256/62);let a="";for(;a.length<20;){const h=jP(40);for(let _=0;_<h.length;++_)a.length<20&&h[_]<i&&(a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(h[_]%62))}return a}}function Br(o,n){return o<n?-1:o>n?1:0}function uf(o,n,i){return o.length===n.length&&o.every((a,h)=>i(a,n[h]))}class An{constructor(n,i){if(this.seconds=n,this.nanoseconds=i,i<0)throw new Se(Jt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(i>=1e9)throw new Se(Jt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+i);if(n<-62135596800)throw new Se(Jt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n);if(n>=253402300800)throw new Se(Jt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n)}static now(){return An.fromMillis(Date.now())}static fromDate(n){return An.fromMillis(n.getTime())}static fromMillis(n){const i=Math.floor(n/1e3),a=Math.floor(1e6*(n-1e3*i));return new An(i,a)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(n){return this.seconds===n.seconds?Br(this.nanoseconds,n.nanoseconds):Br(this.seconds,n.seconds)}isEqual(n){return n.seconds===this.seconds&&n.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Rn{constructor(n){this.timestamp=n}static fromTimestamp(n){return new Rn(n)}static min(){return new Rn(new An(0,0))}static max(){return new Rn(new An(253402300799,999999999))}compareTo(n){return this.timestamp._compareTo(n.timestamp)}isEqual(n){return this.timestamp.isEqual(n.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class $d{constructor(n,i,a){void 0===i?i=0:i>n.length&&wn(),void 0===a?a=n.length-i:a>n.length-i&&wn(),this.segments=n,this.offset=i,this.len=a}get length(){return this.len}isEqual(n){return 0===$d.comparator(this,n)}child(n){const i=this.segments.slice(this.offset,this.limit());return n instanceof $d?n.forEach(a=>{i.push(a)}):i.push(n),this.construct(i)}limit(){return this.offset+this.length}popFirst(n){return this.construct(this.segments,this.offset+(n=void 0===n?1:n),this.length-n)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(n){return this.segments[this.offset+n]}isEmpty(){return 0===this.length}isPrefixOf(n){if(n.length<this.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==n.get(i))return!1;return!0}isImmediateParentOf(n){if(this.length+1!==n.length)return!1;for(let i=0;i<this.length;i++)if(this.get(i)!==n.get(i))return!1;return!0}forEach(n){for(let i=this.offset,a=this.limit();i<a;i++)n(this.segments[i])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(n,i){const a=Math.min(n.length,i.length);for(let h=0;h<a;h++){const _=n.get(h),x=i.get(h);if(_<x)return-1;if(_>x)return 1}return n.length<i.length?-1:n.length>i.length?1:0}}class oi extends $d{construct(n,i,a){return new oi(n,i,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...n){const i=[];for(const a of n){if(a.indexOf("//")>=0)throw new Se(Jt.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);i.push(...a.split("/").filter(h=>h.length>0))}return new oi(i)}static emptyPath(){return new oi([])}}const $P=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _s extends $d{construct(n,i,a){return new _s(n,i,a)}static isValidIdentifier(n){return $P.test(n)}canonicalString(){return this.toArray().map(n=>(n=n.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_s.isValidIdentifier(n)||(n="`"+n+"`"),n)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new _s(["__name__"])}static fromServerFormat(n){const i=[];let a="",h=0;const _=()=>{if(0===a.length)throw new Se(Jt.INVALID_ARGUMENT,`Invalid field path (${n}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);i.push(a),a=""};let x=!1;for(;h<n.length;){const S=n[h];if("\\"===S){if(h+1===n.length)throw new Se(Jt.INVALID_ARGUMENT,"Path has trailing escape character: "+n);const L=n[h+1];if("\\"!==L&&"."!==L&&"`"!==L)throw new Se(Jt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+n);a+=L,h+=2}else"`"===S?(x=!x,h++):"."!==S||x?(a+=S,h++):(_(),h++)}if(_(),x)throw new Se(Jt.INVALID_ARGUMENT,"Unterminated ` in path: "+n);return new _s(i)}static emptyPath(){return new _s([])}}class hn{constructor(n){this.path=n}static fromPath(n){return new hn(oi.fromString(n))}static fromName(n){return new hn(oi.fromString(n).popFirst(5))}static empty(){return new hn(oi.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(n){return this.path.length>=2&&this.path.get(this.path.length-2)===n}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(n){return null!==n&&0===oi.comparator(this.path,n.path)}toString(){return this.path.toString()}static comparator(n,i){return oi.comparator(n.path,i.path)}static isDocumentKey(n){return n.length%2==0}static fromSegments(n){return new hn(new oi(n.slice()))}}function Ug(o){return new Il(o.readTime,o.key,-1)}class Il{constructor(n,i,a){this.readTime=n,this.documentKey=i,this.largestBatchId=a}static min(){return new Il(Rn.min(),hn.empty(),-1)}static max(){return new Il(Rn.max(),hn.empty(),-1)}}function F_(o,n){let i=o.readTime.compareTo(n.readTime);return 0!==i?i:(i=hn.comparator(o.documentKey,n.documentKey),0!==i?i:Br(o.largestBatchId,n.largestBatchId))}const Mv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class z_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(n){this.onCommittedListeners.push(n)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(n=>n())}}function hf(o){return _x.apply(this,arguments)}function _x(){return _x=(0,Je.Z)(function*(o){if(o.code!==Jt.FAILED_PRECONDITION||o.message!==Mv)throw o;ze("LocalStore","Unexpectedly lost primary lease")}),_x.apply(this,arguments)}class qt{constructor(n){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,n(i=>{this.isDone=!0,this.result=i,this.nextCallback&&this.nextCallback(i)},i=>{this.isDone=!0,this.error=i,this.catchCallback&&this.catchCallback(i)})}catch(n){return this.next(void 0,n)}next(n,i){return this.callbackAttached&&wn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(n,this.result):new qt((a,h)=>{this.nextCallback=_=>{this.wrapSuccess(n,_).next(a,h)},this.catchCallback=_=>{this.wrapFailure(i,_).next(a,h)}})}toPromise(){return new Promise((n,i)=>{this.next(n,i)})}wrapUserFunction(n){try{const i=n();return i instanceof qt?i:qt.resolve(i)}catch(i){return qt.reject(i)}}wrapSuccess(n,i){return n?this.wrapUserFunction(()=>n(i)):qt.resolve(i)}wrapFailure(n,i){return n?this.wrapUserFunction(()=>n(i)):qt.reject(i)}static resolve(n){return new qt((i,a)=>{i(n)})}static reject(n){return new qt((i,a)=>{a(n)})}static waitFor(n){return new qt((i,a)=>{let h=0,_=0,x=!1;n.forEach(S=>{++h,S.next(()=>{++_,x&&_===h&&i()},L=>a(L))}),x=!0,_===h&&i()})}static or(n){let i=qt.resolve(!1);for(const a of n)i=i.next(h=>h?qt.resolve(h):a());return i}static forEach(n,i){const a=[];return n.forEach((h,_)=>{a.push(i.call(this,h,_))}),this.waitFor(a)}static mapArray(n,i){return new qt((a,h)=>{const _=n.length,x=new Array(_);let S=0;for(let L=0;L<_;L++){const B=L;i(n[B]).next(H=>{x[B]=H,++S,S===_&&a(x)},H=>h(H))}})}static doWhile(n,i){return new qt((a,h)=>{const _=()=>{!0===n()?i().next(()=>{_()},h):a()};_()})}}function Ap(o){return"IndexedDbTransactionError"===o.name}let cc=(()=>{class o{constructor(i,a){this.previousValue=i,a&&(a.sequenceNumberHandler=h=>this.ot(h),this.ut=h=>a.writeSequenceNumber(h))}ot(i){return this.previousValue=Math.max(i,this.previousValue),this.previousValue}next(){const i=++this.previousValue;return this.ut&&this.ut(i),i}}return o.ct=-1,o})();function Ov(o){return null==o}function Tv(o){return 0===o&&1/o==-1/0}function WP(o){let n=0;for(const i in o)Object.prototype.hasOwnProperty.call(o,i)&&n++;return n}function qu(o,n){for(const i in o)Object.prototype.hasOwnProperty.call(o,i)&&n(i,o[i])}function U_(o){for(const n in o)if(Object.prototype.hasOwnProperty.call(o,n))return!1;return!0}class lo{constructor(n,i){this.comparator=n,this.root=i||Ra.EMPTY}insert(n,i){return new lo(this.comparator,this.root.insert(n,i,this.comparator).copy(null,null,Ra.BLACK,null,null))}remove(n){return new lo(this.comparator,this.root.remove(n,this.comparator).copy(null,null,Ra.BLACK,null,null))}get(n){let i=this.root;for(;!i.isEmpty();){const a=this.comparator(n,i.key);if(0===a)return i.value;a<0?i=i.left:a>0&&(i=i.right)}return null}indexOf(n){let i=0,a=this.root;for(;!a.isEmpty();){const h=this.comparator(n,a.key);if(0===h)return i+a.left.size;h<0?a=a.left:(i+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(n){return this.root.inorderTraversal(n)}forEach(n){this.inorderTraversal((i,a)=>(n(i,a),!1))}toString(){const n=[];return this.inorderTraversal((i,a)=>(n.push(`${i}:${a}`),!1)),`{${n.join(", ")}}`}reverseTraversal(n){return this.root.reverseTraversal(n)}getIterator(){return new Hg(this.root,null,this.comparator,!1)}getIteratorFrom(n){return new Hg(this.root,n,this.comparator,!1)}getReverseIterator(){return new Hg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(n){return new Hg(this.root,n,this.comparator,!0)}}class Hg{constructor(n,i,a,h){this.isReverse=h,this.nodeStack=[];let _=1;for(;!n.isEmpty();)if(_=i?a(n.key,i):1,i&&h&&(_*=-1),_<0)n=this.isReverse?n.left:n.right;else{if(0===_){this.nodeStack.push(n);break}this.nodeStack.push(n),n=this.isReverse?n.right:n.left}}getNext(){let n=this.nodeStack.pop();const i={key:n.key,value:n.value};if(this.isReverse)for(n=n.left;!n.isEmpty();)this.nodeStack.push(n),n=n.right;else for(n=n.right;!n.isEmpty();)this.nodeStack.push(n),n=n.left;return i}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const n=this.nodeStack[this.nodeStack.length-1];return{key:n.key,value:n.value}}}class Ra{constructor(n,i,a,h,_){this.key=n,this.value=i,this.color=a??Ra.RED,this.left=h??Ra.EMPTY,this.right=_??Ra.EMPTY,this.size=this.left.size+1+this.right.size}copy(n,i,a,h,_){return new Ra(n??this.key,i??this.value,a??this.color,h??this.left,_??this.right)}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,i,a){let h=this;const _=a(n,h.key);return h=_<0?h.copy(null,null,null,h.left.insert(n,i,a),null):0===_?h.copy(null,i,null,null,null):h.copy(null,null,null,null,h.right.insert(n,i,a)),h.fixUp()}removeMin(){if(this.left.isEmpty())return Ra.EMPTY;let n=this;return n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.removeMin(),null),n.fixUp()}remove(n,i){let a,h=this;if(i(n,h.key)<0)h.left.isEmpty()||h.left.isRed()||h.left.left.isRed()||(h=h.moveRedLeft()),h=h.copy(null,null,null,h.left.remove(n,i),null);else{if(h.left.isRed()&&(h=h.rotateRight()),h.right.isEmpty()||h.right.isRed()||h.right.left.isRed()||(h=h.moveRedRight()),0===i(n,h.key)){if(h.right.isEmpty())return Ra.EMPTY;a=h.right.min(),h=h.copy(a.key,a.value,null,null,h.right.removeMin())}h=h.copy(null,null,null,null,h.right.remove(n,i))}return h.fixUp()}isRed(){return this.color}fixUp(){let n=this;return n.right.isRed()&&!n.left.isRed()&&(n=n.rotateLeft()),n.left.isRed()&&n.left.left.isRed()&&(n=n.rotateRight()),n.left.isRed()&&n.right.isRed()&&(n=n.colorFlip()),n}moveRedLeft(){let n=this.colorFlip();return n.right.left.isRed()&&(n=n.copy(null,null,null,null,n.right.rotateRight()),n=n.rotateLeft(),n=n.colorFlip()),n}moveRedRight(){let n=this.colorFlip();return n.left.left.isRed()&&(n=n.rotateRight(),n=n.colorFlip()),n}rotateLeft(){const n=this.copy(null,null,Ra.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight(){const n=this.copy(null,null,Ra.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip(){const n=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,i)}checkMaxDepth(){const n=this.check();return Math.pow(2,n)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw wn();const n=this.left.check();if(n!==this.right.check())throw wn();return n+(this.isRed()?0:1)}}Ra.EMPTY=null,Ra.RED=!0,Ra.BLACK=!1,Ra.EMPTY=new class{constructor(){this.size=0}get key(){throw wn()}get value(){throw wn()}get color(){throw wn()}get left(){throw wn()}get right(){throw wn()}copy(o,n,i,a,h){return this}insert(o,n,i){return new Ra(o,n)}remove(o,n){return this}isEmpty(){return!0}inorderTraversal(o){return!1}reverseTraversal(o){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Oo{constructor(n){this.comparator=n,this.data=new lo(this.comparator)}has(n){return null!==this.data.get(n)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(n){return this.data.indexOf(n)}forEach(n){this.data.inorderTraversal((i,a)=>(n(i),!1))}forEachInRange(n,i){const a=this.data.getIteratorFrom(n[0]);for(;a.hasNext();){const h=a.getNext();if(this.comparator(h.key,n[1])>=0)return;i(h.key)}}forEachWhile(n,i){let a;for(a=void 0!==i?this.data.getIteratorFrom(i):this.data.getIterator();a.hasNext();)if(!n(a.getNext().key))return}firstAfterOrEqual(n){const i=this.data.getIteratorFrom(n);return i.hasNext()?i.getNext().key:null}getIterator(){return new V_(this.data.getIterator())}getIteratorFrom(n){return new V_(this.data.getIteratorFrom(n))}add(n){return this.copy(this.data.remove(n).insert(n,!0))}delete(n){return this.has(n)?this.copy(this.data.remove(n)):this}isEmpty(){return this.data.isEmpty()}unionWith(n){let i=this;return i.size<n.size&&(i=n,n=this),n.forEach(a=>{i=i.add(a)}),i}isEqual(n){if(!(n instanceof Oo)||this.size!==n.size)return!1;const i=this.data.getIterator(),a=n.data.getIterator();for(;i.hasNext();){const h=i.getNext().key,_=a.getNext().key;if(0!==this.comparator(h,_))return!1}return!0}toArray(){const n=[];return this.forEach(i=>{n.push(i)}),n}toString(){const n=[];return this.forEach(i=>n.push(i)),"SortedSet("+n.toString()+")"}copy(n){const i=new Oo(this.comparator);return i.data=n,i}}class V_{constructor(n){this.iter=n}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class cl{constructor(n){this.fields=n,n.sort(_s.comparator)}static empty(){return new cl([])}unionWith(n){let i=new Oo(_s.comparator);for(const a of this.fields)i=i.add(a);for(const a of n)i=i.add(a);return new cl(i.toArray())}covers(n){for(const i of this.fields)if(i.isPrefixOf(n))return!0;return!1}isEqual(n){return uf(this.fields,n.fields,(i,a)=>i.isEqual(a))}}class Dv extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ys{constructor(n){this.binaryString=n}static fromBase64String(n){const i=function(a){try{return atob(a)}catch(h){throw typeof DOMException<"u"&&h instanceof DOMException?new Dv("Invalid base64 string: "+h):h}}(n);return new ys(i)}static fromUint8Array(n){const i=function(a){let h="";for(let _=0;_<a.length;++_)h+=String.fromCharCode(a[_]);return h}(n);return new ys(i)}[Symbol.iterator](){let n=0;return{next:()=>n<this.binaryString.length?{value:this.binaryString.charCodeAt(n++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(n){return Br(this.binaryString,n.binaryString)}isEqual(n){return this.binaryString===n.binaryString}}ys.EMPTY_BYTE_STRING=new ys("");const kv=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pf(o){if($n(!!o),"string"==typeof o){let n=0;const i=kv.exec(o);if($n(!!i),i[1]){let h=i[1];h=(h+"000000000").substr(0,9),n=Number(h)}const a=new Date(o);return{seconds:Math.floor(a.getTime()/1e3),nanos:n}}return{seconds:Vo(o.seconds),nanos:Vo(o.nanos)}}function Vo(o){return"number"==typeof o?o:"string"==typeof o?Number(o):0}function Zu(o){return"string"==typeof o?ys.fromBase64String(o):ys.fromUint8Array(o)}function Rv(o){var n,i;return"server_timestamp"===(null===(i=((null===(n=o?.mapValue)||void 0===n?void 0:n.fields)||{}).__type__)||void 0===i?void 0:i.stringValue)}function Lv(o){const n=o.mapValue.fields.__previous_value__;return Rv(n)?Lv(n):n}function qd(o){const n=pf(o.mapValue.fields.__local_write_time__.timestampValue);return new An(n.seconds,n.nanos)}class KP{constructor(n,i,a,h,_,x,S,L,B){this.databaseId=n,this.appId=i,this.persistenceKey=a,this.host=h,this.ssl=_,this.forceLongPolling=x,this.autoDetectLongPolling=S,this.longPollingOptions=L,this.useFetchStreams=B}}class Al{constructor(n,i){this.projectId=n,this.database=i||"(default)"}static empty(){return new Al("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(n){return n instanceof Al&&n.projectId===this.projectId&&n.database===this.database}}const Dp={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function kp(o){return"nullValue"in o?0:"booleanValue"in o?1:"integerValue"in o||"doubleValue"in o?2:"timestampValue"in o?3:"stringValue"in o?5:"bytesValue"in o?6:"referenceValue"in o?7:"geoPointValue"in o?8:"arrayValue"in o?9:"mapValue"in o?Rv(o)?4:Xw(o)?9007199254740991:10:wn()}function uc(o,n){if(o===n)return!0;const i=kp(o);if(i!==kp(n))return!1;switch(i){case 0:case 9007199254740991:return!0;case 1:return o.booleanValue===n.booleanValue;case 4:return qd(o).isEqual(qd(n));case 3:return function(a,h){if("string"==typeof a.timestampValue&&"string"==typeof h.timestampValue&&a.timestampValue.length===h.timestampValue.length)return a.timestampValue===h.timestampValue;const _=pf(a.timestampValue),x=pf(h.timestampValue);return _.seconds===x.seconds&&_.nanos===x.nanos}(o,n);case 5:return o.stringValue===n.stringValue;case 6:return h=n,Zu(o.bytesValue).isEqual(Zu(h.bytesValue));case 7:return o.referenceValue===n.referenceValue;case 8:return function(a,h){return Vo(a.geoPointValue.latitude)===Vo(h.geoPointValue.latitude)&&Vo(a.geoPointValue.longitude)===Vo(h.geoPointValue.longitude)}(o,n);case 2:return function(a,h){if("integerValue"in a&&"integerValue"in h)return Vo(a.integerValue)===Vo(h.integerValue);if("doubleValue"in a&&"doubleValue"in h){const _=Vo(a.doubleValue),x=Vo(h.doubleValue);return _===x?Tv(_)===Tv(x):isNaN(_)&&isNaN(x)}return!1}(o,n);case 9:return uf(o.arrayValue.values||[],n.arrayValue.values||[],uc);case 10:return function(a,h){const _=a.mapValue.fields||{},x=h.mapValue.fields||{};if(WP(_)!==WP(x))return!1;for(const S in _)if(_.hasOwnProperty(S)&&(void 0===x[S]||!uc(_[S],x[S])))return!1;return!0}(o,n);default:return wn()}var h}function Nv(o,n){return void 0!==(o.values||[]).find(i=>uc(i,n))}function dc(o,n){if(o===n)return 0;const i=kp(o),a=kp(n);if(i!==a)return Br(i,a);switch(i){case 0:case 9007199254740991:return 0;case 1:return Br(o.booleanValue,n.booleanValue);case 2:return function(h,_){const x=Vo(h.integerValue||h.doubleValue),S=Vo(_.integerValue||_.doubleValue);return x<S?-1:x>S?1:x===S?0:isNaN(x)?isNaN(S)?0:-1:1}(o,n);case 3:return Fv(o.timestampValue,n.timestampValue);case 4:return Fv(qd(o),qd(n));case 5:return Br(o.stringValue,n.stringValue);case 6:return function(h,_){const x=Zu(h),S=Zu(_);return x.compareTo(S)}(o.bytesValue,n.bytesValue);case 7:return function(h,_){const x=h.split("/"),S=_.split("/");for(let L=0;L<x.length&&L<S.length;L++){const B=Br(x[L],S[L]);if(0!==B)return B}return Br(x.length,S.length)}(o.referenceValue,n.referenceValue);case 8:return function(h,_){const x=Br(Vo(h.latitude),Vo(_.latitude));return 0!==x?x:Br(Vo(h.longitude),Vo(_.longitude))}(o.geoPointValue,n.geoPointValue);case 9:return function(h,_){const x=h.values||[],S=_.values||[];for(let L=0;L<x.length&&L<S.length;++L){const B=dc(x[L],S[L]);if(B)return B}return Br(x.length,S.length)}(o.arrayValue,n.arrayValue);case 10:return function(h,_){if(h===Dp.mapValue&&_===Dp.mapValue)return 0;if(h===Dp.mapValue)return 1;if(_===Dp.mapValue)return-1;const x=h.fields||{},S=Object.keys(x),L=_.fields||{},B=Object.keys(L);S.sort(),B.sort();for(let H=0;H<S.length&&H<B.length;++H){const Y=Br(S[H],B[H]);if(0!==Y)return Y;const pt=dc(x[S[H]],L[B[H]]);if(0!==pt)return pt}return Br(S.length,B.length)}(o.mapValue,n.mapValue);default:throw wn()}}function Fv(o,n){if("string"==typeof o&&"string"==typeof n&&o.length===n.length)return Br(o,n);const i=pf(o),a=pf(n),h=Br(i.seconds,a.seconds);return 0!==h?h:Br(i.nanos,a.nanos)}function gf(o){return Kw(o)}function Kw(o){return"nullValue"in o?"null":"booleanValue"in o?""+o.booleanValue:"integerValue"in o?""+o.integerValue:"doubleValue"in o?""+o.doubleValue:"timestampValue"in o?function(a){const h=pf(a);return`time(${h.seconds},${h.nanos})`}(o.timestampValue):"stringValue"in o?o.stringValue:"bytesValue"in o?Zu(o.bytesValue).toBase64():"referenceValue"in o?hn.fromName(o.referenceValue).toString():"geoPointValue"in o?`geo(${(n=o.geoPointValue).latitude},${n.longitude})`:"arrayValue"in o?function(a){let h="[",_=!0;for(const x of a.values||[])_?_=!1:h+=",",h+=Kw(x);return h+"]"}(o.arrayValue):"mapValue"in o?function(a){const h=Object.keys(a.fields||{}).sort();let _="{",x=!0;for(const S of h)x?x=!1:_+=",",_+=`${S}:${Kw(a.fields[S])}`;return _+"}"}(o.mapValue):wn();var n}function Yw(o){return!!o&&"integerValue"in o}function zv(o){return!!o&&"arrayValue"in o}function YP(o){return!!o&&"nullValue"in o}function XP(o){return!!o&&"doubleValue"in o&&isNaN(Number(o.doubleValue))}function Ox(o){return!!o&&"mapValue"in o}function j_(o){if(o.geoPointValue)return{geoPointValue:Object.assign({},o.geoPointValue)};if(o.timestampValue&&"object"==typeof o.timestampValue)return{timestampValue:Object.assign({},o.timestampValue)};if(o.mapValue){const n={mapValue:{fields:{}}};return qu(o.mapValue.fields,(i,a)=>n.mapValue.fields[i]=j_(a)),n}if(o.arrayValue){const n={arrayValue:{values:[]}};for(let i=0;i<(o.arrayValue.values||[]).length;++i)n.arrayValue.values[i]=j_(o.arrayValue.values[i]);return n}return Object.assign({},o)}function Xw(o){return"__max__"===(((o.mapValue||{}).fields||{}).__type__||{}).stringValue}class co{constructor(n){this.value=n}static empty(){return new co({mapValue:{}})}field(n){if(n.isEmpty())return this.value;{let i=this.value;for(let a=0;a<n.length-1;++a)if(i=(i.mapValue.fields||{})[n.get(a)],!Ox(i))return null;return i=(i.mapValue.fields||{})[n.lastSegment()],i||null}}set(n,i){this.getFieldsMap(n.popLast())[n.lastSegment()]=j_(i)}setAll(n){let i=_s.emptyPath(),a={},h=[];n.forEach((x,S)=>{if(!i.isImmediateParentOf(S)){const L=this.getFieldsMap(i);this.applyChanges(L,a,h),a={},h=[],i=S.popLast()}x?a[S.lastSegment()]=j_(x):h.push(S.lastSegment())});const _=this.getFieldsMap(i);this.applyChanges(_,a,h)}delete(n){const i=this.field(n.popLast());Ox(i)&&i.mapValue.fields&&delete i.mapValue.fields[n.lastSegment()]}isEqual(n){return uc(this.value,n.value)}getFieldsMap(n){let i=this.value;i.mapValue.fields||(i.mapValue={fields:{}});for(let a=0;a<n.length;++a){let h=i.mapValue.fields[n.get(a)];Ox(h)&&h.mapValue.fields||(h={mapValue:{fields:{}}},i.mapValue.fields[n.get(a)]=h),i=h}return i.mapValue.fields}applyChanges(n,i,a){qu(i,(h,_)=>n[h]=_);for(const h of a)delete n[h]}clone(){return new co(j_(this.value))}}function ST(o){const n=[];return qu(o.fields,(i,a)=>{const h=new _s([i]);if(Ox(a)){const _=ST(a.mapValue).fields;if(0===_.length)n.push(h);else for(const x of _)n.push(h.child(x))}else n.push(h)}),new cl(n)}class ao{constructor(n,i,a,h,_,x,S){this.key=n,this.documentType=i,this.version=a,this.readTime=h,this.createTime=_,this.data=x,this.documentState=S}static newInvalidDocument(n){return new ao(n,0,Rn.min(),Rn.min(),Rn.min(),co.empty(),0)}static newFoundDocument(n,i,a,h){return new ao(n,1,i,Rn.min(),a,h,0)}static newNoDocument(n,i){return new ao(n,2,i,Rn.min(),Rn.min(),co.empty(),0)}static newUnknownDocument(n,i){return new ao(n,3,i,Rn.min(),Rn.min(),co.empty(),2)}convertToFoundDocument(n,i){return!this.createTime.isEqual(Rn.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=n),this.version=n,this.documentType=1,this.data=i,this.documentState=0,this}convertToNoDocument(n){return this.version=n,this.documentType=2,this.data=co.empty(),this.documentState=0,this}convertToUnknownDocument(n){return this.version=n,this.documentType=3,this.data=co.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Rn.min(),this}setReadTime(n){return this.readTime=n,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(n){return n instanceof ao&&this.key.isEqual(n.key)&&this.version.isEqual(n.version)&&this.documentType===n.documentType&&this.documentState===n.documentState&&this.data.isEqual(n.data)}mutableCopy(){return new ao(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Hc{constructor(n,i){this.position=n,this.inclusive=i}}function QP(o,n,i){let a=0;for(let h=0;h<o.position.length;h++){const _=n[h],x=o.position[h];if(a=_.field.isKeyField()?hn.comparator(hn.fromName(x.referenceValue),i.key):dc(x,i.data.field(_.field)),"desc"===_.dir&&(a*=-1),0!==a)break}return a}function Tx(o,n){if(null===o)return null===n;if(null===n||o.inclusive!==n.inclusive||o.position.length!==n.position.length)return!1;for(let i=0;i<o.position.length;i++)if(!uc(o.position[i],n.position[i]))return!1;return!0}class Rp{constructor(n,i="asc"){this.field=n,this.dir=i}}function Zd(o,n){return o.dir===n.dir&&o.field.isEqual(n.field)}class $_{}class xr extends $_{constructor(n,i,a){super(),this.field=n,this.op=i,this.value=a}static create(n,i,a){return n.isKeyField()?"in"===i||"not-in"===i?this.createKeyFieldInFilter(n,i,a):new Yg(n,i,a):"array-contains"===i?new Bv(n,a):"in"===i?new Ix(n,a):"not-in"===i?new JP(n,a):"array-contains-any"===i?new Jw(n,a):new xr(n,i,a)}static createKeyFieldInFilter(n,i,a){return"in"===i?new G_(n,a):new Xg(n,a)}matches(n){const i=n.data.field(this.field);return"!="===this.op?null!==i&&this.matchesComparison(dc(i,this.value)):null!==i&&kp(this.value)===kp(i)&&this.matchesComparison(dc(i,this.value))}matchesComparison(n){switch(this.op){case"<":return n<0;case"<=":return n<=0;case"==":return 0===n;case"!=":return 0!==n;case">":return n>0;case">=":return n>=0;default:return wn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class vi extends $_{constructor(n,i){super(),this.filters=n,this.op=i,this.lt=null}static create(n,i){return new vi(n,i)}matches(n){return si(this)?void 0===this.filters.find(i=>!i.matches(n)):void 0!==this.filters.find(i=>i.matches(n))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((n,i)=>n.concat(i.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const n=this.ft(i=>i.isInequality());return null!==n?n.field:null}ft(n){for(const i of this.getFlattenedFilters())if(n(i))return i;return null}}function si(o){return"and"===o.op}function mf(o){return function qc(o){for(const n of o.filters)if(n instanceof vi)return!1;return!0}(o)&&si(o)}function Wd(o){if(o instanceof xr)return o.field.canonicalString()+o.op.toString()+gf(o.value);if(mf(o))return o.filters.map(n=>Wd(n)).join(",");{const n=o.filters.map(i=>Wd(i)).join(",");return`${o.op}(${n})`}}function Kd(o,n){return o instanceof xr?(i=o,(a=n)instanceof xr&&i.op===a.op&&i.field.isEqual(a.field)&&uc(i.value,a.value)):o instanceof vi?function(i,a){return a instanceof vi&&i.op===a.op&&i.filters.length===a.filters.length&&i.filters.reduce((h,_,x)=>h&&Kd(_,a.filters[x]),!0)}(o,n):void wn();var i,a}function Lp(o){return o instanceof xr?`${(n=o).field.canonicalString()} ${n.op} ${gf(n.value)}`:o instanceof vi?function(n){return n.op.toString()+" {"+n.getFilters().map(Lp).join(" ,")+"}"}(o):"Filter";var n}class Yg extends xr{constructor(n,i,a){super(n,i,a),this.key=hn.fromName(a.referenceValue)}matches(n){const i=hn.comparator(n.key,this.key);return this.matchesComparison(i)}}class G_ extends xr{constructor(n,i){super(n,"in",i),this.keys=Np(0,i)}matches(n){return this.keys.some(i=>i.isEqual(n.key))}}class Xg extends xr{constructor(n,i){super(n,"not-in",i),this.keys=Np(0,i)}matches(n){return!this.keys.some(i=>i.isEqual(n.key))}}function Np(o,n){var i;return((null===(i=n.arrayValue)||void 0===i?void 0:i.values)||[]).map(a=>hn.fromName(a.referenceValue))}class Bv extends xr{constructor(n,i){super(n,"array-contains",i)}matches(n){const i=n.data.field(this.field);return zv(i)&&Nv(i.arrayValue,this.value)}}class Ix extends xr{constructor(n,i){super(n,"in",i)}matches(n){const i=n.data.field(this.field);return null!==i&&Nv(this.value.arrayValue,i)}}class JP extends xr{constructor(n,i){super(n,"not-in",i)}matches(n){if(Nv(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const i=n.data.field(this.field);return null!==i&&!Nv(this.value.arrayValue,i)}}class Jw extends xr{constructor(n,i){super(n,"array-contains-any",i)}matches(n){const i=n.data.field(this.field);return!(!zv(i)||!i.arrayValue.values)&&i.arrayValue.values.some(a=>Nv(this.value.arrayValue,a))}}class Yd{constructor(n,i=null,a=[],h=[],_=null,x=null,S=null){this.path=n,this.collectionGroup=i,this.orderBy=a,this.filters=h,this.limit=_,this.startAt=x,this.endAt=S,this.dt=null}}function Uv(o,n=null,i=[],a=[],h=null,_=null,x=null){return new Yd(o,n,i,a,h,_,x)}function _f(o){const n=_n(o);if(null===n.dt){let i=n.path.canonicalString();null!==n.collectionGroup&&(i+="|cg:"+n.collectionGroup),i+="|f:",i+=n.filters.map(a=>Wd(a)).join(","),i+="|ob:",i+=n.orderBy.map(a=>{return(h=a).field.canonicalString()+h.dir;var h}).join(","),Ov(n.limit)||(i+="|l:",i+=n.limit),n.startAt&&(i+="|lb:",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(a=>gf(a)).join(",")),n.endAt&&(i+="|ub:",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(a=>gf(a)).join(",")),n.dt=i}return n.dt}function Qg(o,n){if(o.limit!==n.limit||o.orderBy.length!==n.orderBy.length)return!1;for(let i=0;i<o.orderBy.length;i++)if(!Zd(o.orderBy[i],n.orderBy[i]))return!1;if(o.filters.length!==n.filters.length)return!1;for(let i=0;i<o.filters.length;i++)if(!Kd(o.filters[i],n.filters[i]))return!1;return o.collectionGroup===n.collectionGroup&&!!o.path.isEqual(n.path)&&!!Tx(o.startAt,n.startAt)&&Tx(o.endAt,n.endAt)}function H_(o){return hn.isDocumentKey(o.path)&&null===o.collectionGroup&&0===o.filters.length}class yf{constructor(n,i=null,a=[],h=[],_=null,x="F",S=null,L=null){this.path=n,this.collectionGroup=i,this.explicitOrderBy=a,this.filters=h,this.limit=_,this.limitType=x,this.startAt=S,this.endAt=L,this.wt=null,this._t=null}}function Bs(o){return new yf(o)}function tC(o){return 0===o.filters.length&&null===o.limit&&null==o.startAt&&null==o.endAt&&(0===o.explicitOrderBy.length||1===o.explicitOrderBy.length&&o.explicitOrderBy[0].field.isKeyField())}function Fp(o){const n=_n(o);if(null===n.wt){n.wt=[];const i=function Jg(o){for(const n of o.filters){const i=n.getFirstInequalityField();if(null!==i)return i}return null}(n),a=function Ax(o){return o.explicitOrderBy.length>0?o.explicitOrderBy[0].field:null}(n);if(null!==i&&null===a)i.isKeyField()||n.wt.push(new Rp(i)),n.wt.push(new Rp(_s.keyField(),"asc"));else{let h=!1;for(const _ of n.explicitOrderBy)n.wt.push(_),_.field.isKeyField()&&(h=!0);if(!h){const _=n.explicitOrderBy.length>0?n.explicitOrderBy[n.explicitOrderBy.length-1].dir:"asc";n.wt.push(new Rp(_s.keyField(),_))}}}return n.wt}function To(o){const n=_n(o);if(!n._t)if("F"===n.limitType)n._t=Uv(n.path,n.collectionGroup,Fp(n),n.filters,n.limit,n.startAt,n.endAt);else{const i=[];for(const _ of Fp(n))i.push(new Rp(_.field,"desc"===_.dir?"asc":"desc"));const a=n.endAt?new Hc(n.endAt.position,n.endAt.inclusive):null,h=n.startAt?new Hc(n.startAt.position,n.startAt.inclusive):null;n._t=Uv(n.path,n.collectionGroup,i,n.filters,n.limit,a,h)}return n._t}function dl(o,n,i){return new yf(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),n,i,o.startAt,o.endAt)}function zp(o,n){return Qg(To(o),To(n))&&o.limitType===n.limitType}function Bp(o){return`${_f(To(o))}|lt:${o.limitType}`}function Vv(o){return`Query(target=${function(n){let i=n.path.canonicalString();return null!==n.collectionGroup&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(a=>Lp(a)).join(", ")}]`),Ov(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(a=>{return`${(h=a).field.canonicalString()} (${h.dir})`;var h}).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(a=>gf(a)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(a=>gf(a)).join(",")),`Target(${i})`}(To(o))}; limitType=${o.limitType})`}function Zc(o,n){return n.isFoundDocument()&&function(i,a){const h=a.key.path;return null!==i.collectionGroup?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(h):hn.isDocumentKey(i.path)?i.path.isEqual(h):i.path.isImmediateParentOf(h)}(o,n)&&function(i,a){for(const h of Fp(i))if(!h.field.isKeyField()&&null===a.data.field(h.field))return!1;return!0}(o,n)&&function(i,a){for(const h of i.filters)if(!h.matches(a))return!1;return!0}(o,n)&&(a=n,!((i=o).startAt&&!function(h,_,x){const S=QP(h,_,x);return h.inclusive?S<=0:S<0}(i.startAt,Fp(i),a)||i.endAt&&!function(h,_,x){const S=QP(h,_,x);return h.inclusive?S>=0:S>0}(i.endAt,Fp(i),a)));var i,a}function nE(o){return(n,i)=>{let a=!1;for(const h of Fp(o)){const _=jv(h,n,i);if(0!==_)return _;a=a||h.field.isKeyField()}return 0}}function jv(o,n,i){const a=o.field.isKeyField()?hn.comparator(n.key,i.key):function(h,_,x){const S=_.data.field(h),L=x.data.field(h);return null!==S&&null!==L?dc(S,L):wn()}(o.field,n,i);switch(o.dir){case"asc":return a;case"desc":return-1*a;default:return wn()}}class vf{constructor(n,i){this.mapKeyFn=n,this.equalsFn=i,this.inner={},this.innerSize=0}get(n){const i=this.mapKeyFn(n),a=this.inner[i];if(void 0!==a)for(const[h,_]of a)if(this.equalsFn(h,n))return _}has(n){return void 0!==this.get(n)}set(n,i){const a=this.mapKeyFn(n),h=this.inner[a];if(void 0===h)return this.inner[a]=[[n,i]],void this.innerSize++;for(let _=0;_<h.length;_++)if(this.equalsFn(h[_][0],n))return void(h[_]=[n,i]);h.push([n,i]),this.innerSize++}delete(n){const i=this.mapKeyFn(n),a=this.inner[i];if(void 0===a)return!1;for(let h=0;h<a.length;h++)if(this.equalsFn(a[h][0],n))return 1===a.length?delete this.inner[i]:a.splice(h,1),this.innerSize--,!0;return!1}forEach(n){qu(this.inner,(i,a)=>{for(const[h,_]of a)n(h,_)})}isEmpty(){return U_(this.inner)}size(){return this.innerSize}}const W_=new lo(hn.comparator);function Us(){return W_}const kx=new lo(hn.comparator);function tm(...o){let n=kx;for(const i of o)n=n.insert(i.key,i);return n}function em(o){let n=kx;return o.forEach((i,a)=>n=n.insert(i,a.overlayedDocument)),n}function hc(){return $v()}function eC(){return $v()}function $v(){return new vf(o=>o.toString(),(o,n)=>o.isEqual(n))}const Gv=new lo(hn.comparator),Qd=new Oo(hn.comparator);function Hr(...o){let n=Qd;for(const i of o)n=n.add(i);return n}const nC=new Oo(Br);function Rx(o,n){if(o.useProto3Json){if(isNaN(n))return{doubleValue:"NaN"};if(n===1/0)return{doubleValue:"Infinity"};if(n===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Tv(n)?"-0":n}}function rC(o){return{integerValue:""+o}}function Lx(o,n){return function qw(o){return"number"==typeof o&&Number.isInteger(o)&&!Tv(o)&&o<=Number.MAX_SAFE_INTEGER&&o>=Number.MIN_SAFE_INTEGER}(n)?rC(n):Rx(o,n)}class Ku{constructor(){this._=void 0}}function rE(o,n,i){return o instanceof nm?function(a,h){const _={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return h&&Rv(h)&&(h=Lv(h)),h&&(_.fields.__previous_value__=h),{mapValue:_}}(i,n):o instanceof La?Nx(o,n):o instanceof Yu?bf(o,n):function(a,h){const _=iC(a,h),x=Up(_)+Up(a.gt);return Yw(_)&&Yw(a.gt)?rC(x):Rx(a.serializer,x)}(o,n)}function iE(o,n,i){return o instanceof La?Nx(o,n):o instanceof Yu?bf(o,n):i}function iC(o,n){return o instanceof fc?Yw(i=n)||(a=i)&&"doubleValue"in a?n:{integerValue:0}:null;var a,i}class nm extends Ku{}class La extends Ku{constructor(n){super(),this.elements=n}}function Nx(o,n){const i=Y_(n);for(const a of o.elements)i.some(h=>uc(h,a))||i.push(a);return{arrayValue:{values:i}}}class Yu extends Ku{constructor(n){super(),this.elements=n}}function bf(o,n){let i=Y_(n);for(const a of o.elements)i=i.filter(h=>!uc(h,a));return{arrayValue:{values:i}}}class fc extends Ku{constructor(n,i){super(),this.serializer=n,this.gt=i}}function Up(o){return Vo(o.integerValue||o.doubleValue)}function Y_(o){return zv(o)&&o.arrayValue.values?o.arrayValue.values.slice():[]}class X_{constructor(n,i){this.version=n,this.transformResults=i}}class to{constructor(n,i){this.updateTime=n,this.exists=i}static none(){return new to}static exists(n){return new to(void 0,n)}static updateTime(n){return new to(n)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(n){return this.exists===n.exists&&(this.updateTime?!!n.updateTime&&this.updateTime.isEqual(n.updateTime):!n.updateTime)}}function Q_(o,n){return void 0!==o.updateTime?n.isFoundDocument()&&n.version.isEqual(o.updateTime):void 0===o.exists||o.exists===n.isFoundDocument()}class J_{}function Fx(o,n){if(!o.hasLocalMutations||n&&0===n.fields.length)return null;if(null===n)return o.isNoDocument()?new Jd(o.key,to.none()):new rm(o.key,o.data,to.none());{const i=o.data,a=co.empty();let h=new Oo(_s.comparator);for(let _ of n.fields)if(!h.has(_)){let x=i.field(_);null===x&&_.length>1&&(_=_.popLast(),x=i.field(_)),null===x?a.delete(_):a.set(_,x),h=h.add(_)}return new Dl(o.key,a,new cl(h.toArray()),to.none())}}function DT(o,n,i){o instanceof rm?function(a,h,_){const x=a.value.clone(),S=zx(a.fieldTransforms,h,_.transformResults);x.setAll(S),h.convertToFoundDocument(_.version,x).setHasCommittedMutations()}(o,n,i):o instanceof Dl?function(a,h,_){if(!Q_(a.precondition,h))return void h.convertToUnknownDocument(_.version);const x=zx(a.fieldTransforms,h,_.transformResults),S=h.data;S.setAll(oC(a)),S.setAll(x),h.convertToFoundDocument(_.version,S).setHasCommittedMutations()}(o,n,i):n.convertToNoDocument(i.version).setHasCommittedMutations()}function ty(o,n,i,a){return o instanceof rm?function(h,_,x,S){if(!Q_(h.precondition,_))return x;const L=h.value.clone(),B=Bx(h.fieldTransforms,S,_);return L.setAll(B),_.convertToFoundDocument(_.version,L).setHasLocalMutations(),null}(o,n,i,a):o instanceof Dl?function(h,_,x,S){if(!Q_(h.precondition,_))return x;const L=Bx(h.fieldTransforms,S,_),B=_.data;return B.setAll(oC(h)),B.setAll(L),_.convertToFoundDocument(_.version,B).setHasLocalMutations(),null===x?null:x.unionWith(h.fieldMask.fields).unionWith(h.fieldTransforms.map(H=>H.field))}(o,n,i,a):(x=i,Q_(o.precondition,_=n)?(_.convertToNoDocument(_.version).setHasLocalMutations(),null):x);var _,x}function oE(o,n){let i=null;for(const a of o.fieldTransforms){const h=n.data.field(a.field),_=iC(a.transform,h||null);null!=_&&(null===i&&(i=co.empty()),i.set(a.field,_))}return i||null}function qv(o,n){return o.type===n.type&&!!o.key.isEqual(n.key)&&!!o.precondition.isEqual(n.precondition)&&(a=n.fieldTransforms,!!(void 0===(i=o.fieldTransforms)&&void 0===a||i&&a&&uf(i,a,(h,_)=>function AT(o,n){return o.field.isEqual(n.field)&&(a=n.transform,(i=o.transform)instanceof La&&a instanceof La||i instanceof Yu&&a instanceof Yu?uf(i.elements,a.elements,uc):i instanceof fc&&a instanceof fc?uc(i.gt,a.gt):i instanceof nm&&a instanceof nm);var i,a}(h,_))))&&(0===o.type?o.value.isEqual(n.value):1!==o.type||o.data.isEqual(n.data)&&o.fieldMask.isEqual(n.fieldMask));var i,a}class rm extends J_{constructor(n,i,a,h=[]){super(),this.key=n,this.value=i,this.precondition=a,this.fieldTransforms=h,this.type=0}getFieldMask(){return null}}class Dl extends J_{constructor(n,i,a,h,_=[]){super(),this.key=n,this.data=i,this.fieldMask=a,this.precondition=h,this.fieldTransforms=_,this.type=1}getFieldMask(){return this.fieldMask}}function oC(o){const n=new Map;return o.fieldMask.fields.forEach(i=>{if(!i.isEmpty()){const a=o.data.field(i);n.set(i,a)}}),n}function zx(o,n,i){const a=new Map;$n(o.length===i.length);for(let h=0;h<i.length;h++){const _=o[h],x=_.transform,S=n.data.field(_.field);a.set(_.field,iE(x,S,i[h]))}return a}function Bx(o,n,i){const a=new Map;for(const h of o){const _=h.transform,x=i.data.field(h.field);a.set(h.field,rE(_,x,n))}return a}class Jd extends J_{constructor(n,i){super(),this.key=n,this.precondition=i,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ux extends J_{constructor(n,i){super(),this.key=n,this.precondition=i,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Vx{constructor(n,i,a,h){this.batchId=n,this.localWriteTime=i,this.baseMutations=a,this.mutations=h}applyToRemoteDocument(n,i){const a=i.mutationResults;for(let h=0;h<this.mutations.length;h++){const _=this.mutations[h];_.key.isEqual(n.key)&&DT(_,n,a[h])}}applyToLocalView(n,i){for(const a of this.baseMutations)a.key.isEqual(n.key)&&(i=ty(a,n,i,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(n.key)&&(i=ty(a,n,i,this.localWriteTime));return i}applyToLocalDocumentSet(n,i){const a=eC();return this.mutations.forEach(h=>{const _=n.get(h.key),x=_.overlayedDocument;let S=this.applyToLocalView(x,_.mutatedFields);S=i.has(h.key)?null:S;const L=Fx(x,S);null!==L&&a.set(h.key,L),x.isValidDocument()||x.convertToNoDocument(Rn.min())}),a}keys(){return this.mutations.reduce((n,i)=>n.add(i.key),Hr())}isEqual(n){return this.batchId===n.batchId&&uf(this.mutations,n.mutations,(i,a)=>qv(i,a))&&uf(this.baseMutations,n.baseMutations,(i,a)=>qv(i,a))}}class ey{constructor(n,i,a,h){this.batch=n,this.commitVersion=i,this.mutationResults=a,this.docVersions=h}static from(n,i,a){$n(n.mutations.length===a.length);let h=Gv;const _=n.mutations;for(let x=0;x<_.length;x++)h=h.insert(_[x].key,a[x].version);return new ey(n,i,a,h)}}class ny{constructor(n,i){this.largestBatchId=n,this.mutation=i}getKey(){return this.mutation.key}isEqual(n){return null!==n&&this.mutation===n.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Zv{constructor(n,i){this.count=n,this.unchangedNames=i}}var uo,Oi;function Kv(o){if(void 0===o)return rs("GRPC error has no .code"),Jt.UNKNOWN;switch(o){case uo.OK:return Jt.OK;case uo.CANCELLED:return Jt.CANCELLED;case uo.UNKNOWN:return Jt.UNKNOWN;case uo.DEADLINE_EXCEEDED:return Jt.DEADLINE_EXCEEDED;case uo.RESOURCE_EXHAUSTED:return Jt.RESOURCE_EXHAUSTED;case uo.INTERNAL:return Jt.INTERNAL;case uo.UNAVAILABLE:return Jt.UNAVAILABLE;case uo.UNAUTHENTICATED:return Jt.UNAUTHENTICATED;case uo.INVALID_ARGUMENT:return Jt.INVALID_ARGUMENT;case uo.NOT_FOUND:return Jt.NOT_FOUND;case uo.ALREADY_EXISTS:return Jt.ALREADY_EXISTS;case uo.PERMISSION_DENIED:return Jt.PERMISSION_DENIED;case uo.FAILED_PRECONDITION:return Jt.FAILED_PRECONDITION;case uo.ABORTED:return Jt.ABORTED;case uo.OUT_OF_RANGE:return Jt.OUT_OF_RANGE;case uo.UNIMPLEMENTED:return Jt.UNIMPLEMENTED;case uo.DATA_LOSS:return Jt.DATA_LOSS;default:return wn()}}(Oi=uo||(uo={}))[Oi.OK=0]="OK",Oi[Oi.CANCELLED=1]="CANCELLED",Oi[Oi.UNKNOWN=2]="UNKNOWN",Oi[Oi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oi[Oi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oi[Oi.NOT_FOUND=5]="NOT_FOUND",Oi[Oi.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oi[Oi.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oi[Oi.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oi[Oi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oi[Oi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oi[Oi.ABORTED=10]="ABORTED",Oi[Oi.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oi[Oi.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oi[Oi.INTERNAL=13]="INTERNAL",Oi[Oi.UNAVAILABLE=14]="UNAVAILABLE",Oi[Oi.DATA_LOSS=15]="DATA_LOSS";class im{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return xf}static getOrCreateInstance(){return null===xf&&(xf=new im),xf}onExistenceFilterMismatch(n){const i=Symbol();return this.onExistenceFilterMismatchCallbacks.set(i,n),()=>this.onExistenceFilterMismatchCallbacks.delete(i)}notifyOnExistenceFilterMismatch(n){this.onExistenceFilterMismatchCallbacks.forEach(i=>i(n))}}let xf=null;const sE=new ju([4294967295,4294967295],0);function aC(o){const n=function sC(){return new TextEncoder}().encode(o),i=new zP;return i.update(n),new Uint8Array(i.digest())}function Yv(o){const n=new DataView(o.buffer),i=n.getUint32(0,!0),a=n.getUint32(4,!0),h=n.getUint32(8,!0),_=n.getUint32(12,!0);return[new ju([i,a],0),new ju([h,_],0)]}class th{constructor(n,i,a){if(this.bitmap=n,this.padding=i,this.hashCount=a,i<0||i>=8)throw new Xv(`Invalid padding: ${i}`);if(a<0)throw new Xv(`Invalid hash count: ${a}`);if(n.length>0&&0===this.hashCount)throw new Xv(`Invalid hash count: ${a}`);if(0===n.length&&0!==i)throw new Xv(`Invalid padding when bitmap length is 0: ${i}`);this.It=8*n.length-i,this.Tt=ju.fromNumber(this.It)}Et(n,i,a){let h=n.add(i.multiply(ju.fromNumber(a)));return 1===h.compare(sE)&&(h=new ju([h.getBits(0),h.getBits(1)],0)),h.modulo(this.Tt).toNumber()}At(n){return 0!=(this.bitmap[Math.floor(n/8)]&1<<n%8)}vt(n){if(0===this.It)return!1;const i=aC(n),[a,h]=Yv(i);for(let _=0;_<this.hashCount;_++){const x=this.Et(a,h,_);if(!this.At(x))return!1}return!0}static create(n,i,a){const h=n%8==0?0:8-n%8,_=new Uint8Array(Math.ceil(n/8)),x=new th(_,h,i);return a.forEach(S=>x.insert(S)),x}insert(n){if(0===this.It)return;const i=aC(n),[a,h]=Yv(i);for(let _=0;_<this.hashCount;_++){const x=this.Et(a,h,_);this.Rt(x)}}Rt(n){const i=Math.floor(n/8);this.bitmap[i]|=1<<n%8}}class Xv extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Vp{constructor(n,i,a,h,_){this.snapshotVersion=n,this.targetChanges=i,this.targetMismatches=a,this.documentUpdates=h,this.resolvedLimboDocuments=_}static createSynthesizedRemoteEventForCurrentChange(n,i,a){const h=new Map;return h.set(n,bi.createSynthesizedTargetChangeForCurrentChange(n,i,a)),new Vp(Rn.min(),h,new lo(Br),Us(),Hr())}}class bi{constructor(n,i,a,h,_){this.resumeToken=n,this.current=i,this.addedDocuments=a,this.modifiedDocuments=h,this.removedDocuments=_}static createSynthesizedTargetChangeForCurrentChange(n,i,a){return new bi(a,i,Hr(),Hr(),Hr())}}class pc{constructor(n,i,a,h){this.Pt=n,this.removedTargetIds=i,this.key=a,this.bt=h}}class hl{constructor(n,i){this.targetId=n,this.Vt=i}}class Xu{constructor(n,i,a=ys.EMPTY_BYTE_STRING,h=null){this.state=n,this.targetIds=i,this.resumeToken=a,this.cause=h}}class Qu{constructor(){this.St=0,this.Dt=Qv(),this.Ct=ys.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(n){n.approximateByteSize()>0&&(this.Nt=!0,this.Ct=n)}Ot(){let n=Hr(),i=Hr(),a=Hr();return this.Dt.forEach((h,_)=>{switch(_){case 0:n=n.add(h);break;case 2:i=i.add(h);break;case 1:a=a.add(h);break;default:wn()}}),new bi(this.Ct,this.xt,n,i,a)}Ft(){this.Nt=!1,this.Dt=Qv()}Bt(n,i){this.Nt=!0,this.Dt=this.Dt.insert(n,i)}Lt(n){this.Nt=!0,this.Dt=this.Dt.remove(n)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class wf{constructor(n){this.Gt=n,this.Qt=new Map,this.jt=Us(),this.zt=jp(),this.Wt=new lo(Br)}Ht(n){for(const i of n.Pt)n.bt&&n.bt.isFoundDocument()?this.Jt(i,n.bt):this.Yt(i,n.key,n.bt);for(const i of n.removedTargetIds)this.Yt(i,n.key,n.bt)}Xt(n){this.forEachTarget(n,i=>{const a=this.Zt(i);switch(n.state){case 0:this.te(i)&&a.$t(n.resumeToken);break;case 1:a.Ut(),a.kt||a.Ft(),a.$t(n.resumeToken);break;case 2:a.Ut(),a.kt||this.removeTarget(i);break;case 3:this.te(i)&&(a.Kt(),a.$t(n.resumeToken));break;case 4:this.te(i)&&(this.ee(i),a.$t(n.resumeToken));break;default:wn()}})}forEachTarget(n,i){n.targetIds.length>0?n.targetIds.forEach(i):this.Qt.forEach((a,h)=>{this.te(h)&&i(h)})}ne(n){var i;const a=n.targetId,h=n.Vt.count,_=this.se(a);if(_){const x=_.target;if(H_(x))if(0===h){const S=new hn(x.path);this.Yt(a,S,ao.newNoDocument(S,Rn.min()))}else $n(1===h);else{const S=this.ie(a);if(S!==h){const L=this.re(n,S);0!==L&&(this.ee(a),this.Wt=this.Wt.insert(a,2===L?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(i=im.instance)||void 0===i||i.notifyOnExistenceFilterMismatch(function(B,H,Y){var pt,xt,At,Ut,Zt,qe;const fn={localCacheCount:H,existenceFilterCount:Y.count},$e=Y.unchangedNames;return $e&&(fn.bloomFilter={applied:0===B,hashCount:null!==(pt=$e?.hashCount)&&void 0!==pt?pt:0,bitmapLength:null!==(Ut=null===(At=null===(xt=$e?.bits)||void 0===xt?void 0:xt.bitmap)||void 0===At?void 0:At.length)&&void 0!==Ut?Ut:0,padding:null!==(qe=null===(Zt=$e?.bits)||void 0===Zt?void 0:Zt.padding)&&void 0!==qe?qe:0}),fn}(L,S,n.Vt))}}}}re(n,i){const{unchangedNames:a,count:h}=n.Vt;if(!a||!a.bits)return 1;const{bits:{bitmap:_="",padding:x=0},hashCount:S=0}=a;let L,B;try{L=Zu(_).toUint8Array()}catch(H){if(H instanceof Dv)return lc("Decoding the base64 bloom filter in existence filter failed ("+H.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw H}try{B=new th(L,x,S)}catch(H){return lc(H instanceof Xv?"BloomFilter error: ":"Applying bloom filter failed: ",H),1}return 0===B.It?1:h!==i-this.oe(n.targetId,B)?2:0}oe(n,i){const a=this.Gt.getRemoteKeysForTarget(n);let h=0;return a.forEach(_=>{const x=this.Gt.ue(),S=`projects/${x.projectId}/databases/${x.database}/documents/${_.path.canonicalString()}`;i.vt(S)||(this.Yt(n,_,null),h++)}),h}ce(n){const i=new Map;this.Qt.forEach((_,x)=>{const S=this.se(x);if(S){if(_.current&&H_(S.target)){const L=new hn(S.target.path);null!==this.jt.get(L)||this.ae(x,L)||this.Yt(x,L,ao.newNoDocument(L,n))}_.Mt&&(i.set(x,_.Ot()),_.Ft())}});let a=Hr();this.zt.forEach((_,x)=>{let S=!0;x.forEachWhile(L=>{const B=this.se(L);return!B||"TargetPurposeLimboResolution"===B.purpose||(S=!1,!1)}),S&&(a=a.add(_))}),this.jt.forEach((_,x)=>x.setReadTime(n));const h=new Vp(n,i,this.Wt,this.jt,a);return this.jt=Us(),this.zt=jp(),this.Wt=new lo(Br),h}Jt(n,i){if(!this.te(n))return;const a=this.ae(n,i.key)?2:0;this.Zt(n).Bt(i.key,a),this.jt=this.jt.insert(i.key,i),this.zt=this.zt.insert(i.key,this.he(i.key).add(n))}Yt(n,i,a){if(!this.te(n))return;const h=this.Zt(n);this.ae(n,i)?h.Bt(i,1):h.Lt(i),this.zt=this.zt.insert(i,this.he(i).delete(n)),a&&(this.jt=this.jt.insert(i,a))}removeTarget(n){this.Qt.delete(n)}ie(n){const i=this.Zt(n).Ot();return this.Gt.getRemoteKeysForTarget(n).size+i.addedDocuments.size-i.removedDocuments.size}qt(n){this.Zt(n).qt()}Zt(n){let i=this.Qt.get(n);return i||(i=new Qu,this.Qt.set(n,i)),i}he(n){let i=this.zt.get(n);return i||(i=new Oo(Br),this.zt=this.zt.insert(n,i)),i}te(n){const i=null!==this.se(n);return i||ze("WatchChangeAggregator","Detected inactive target",n),i}se(n){const i=this.Qt.get(n);return i&&i.kt?null:this.Gt.le(n)}ee(n){this.Qt.set(n,new Qu),this.Gt.getRemoteKeysForTarget(n).forEach(i=>{this.Yt(n,i,null)})}ae(n,i){return this.Gt.getRemoteKeysForTarget(n).has(i)}}function jp(){return new lo(hn.comparator)}function Qv(){return new lo(hn.comparator)}const aE={asc:"ASCENDING",desc:"DESCENDING"},$x={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lE={and:"AND",or:"OR"};class Ko{constructor(n,i){this.databaseId=n,this.useProto3Json=i}}function Gx(o,n){return o.useProto3Json||Ov(n)?n:{value:n}}function om(o,n){return o.useProto3Json?`${new Date(1e3*n.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+n.nanoseconds).slice(-9)}Z`:{seconds:""+n.seconds,nanos:n.nanoseconds}}function cE(o,n){return o.useProto3Json?n.toBase64():n.toUint8Array()}function uE(o,n){return om(o,n.toTimestamp())}function _r(o){return $n(!!o),Rn.fromTimestamp(function(n){const i=pf(n);return new An(i.seconds,i.nanos)}(o))}function Hx(o,n){return(i=o,new oi(["projects",i.projectId,"databases",i.database])).child("documents").child(n).canonicalString();var i}function lC(o){const n=oi.fromString(o);return $n(gE(n)),n}function eh(o,n){return Hx(o.databaseId,n.path)}function nh(o,n){const i=lC(n);if(i.get(1)!==o.databaseId.projectId)throw new Se(Jt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+i.get(1)+" vs "+o.databaseId.projectId);if(i.get(3)!==o.databaseId.database)throw new Se(Jt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+i.get(3)+" vs "+o.databaseId.database);return new hn(dC(i))}function cC(o,n){return Hx(o.databaseId,n)}function Jv(o){return new oi(["projects",o.databaseId.projectId,"databases",o.databaseId.database]).canonicalString()}function dC(o){return $n(o.length>4&&"documents"===o.get(4)),o.popFirst(5)}function kT(o,n,i){return{name:eh(o,n),fields:i.value.mapValue.fields}}function Wc(o,n){return{documents:[cC(o,n.path)]}}function gc(o,n){const i={structuredQuery:{}},a=n.path;null!==n.collectionGroup?(i.parent=cC(o,a),i.structuredQuery.from=[{collectionId:n.collectionGroup,allDescendants:!0}]):(i.parent=cC(o,a.popLast()),i.structuredQuery.from=[{collectionId:a.lastSegment()}]);const h=function(L){if(0!==L.length)return fE(vi.create(L,"and"))}(n.filters);h&&(i.structuredQuery.where=h);const _=function(L){if(0!==L.length)return L.map(B=>{return{field:oh((H=B).field),direction:RT(H.dir)};var H})}(n.orderBy);_&&(i.structuredQuery.orderBy=_);const x=Gx(o,n.limit);var S,L;return null!==x&&(i.structuredQuery.limit=x),n.startAt&&(i.structuredQuery.startAt={before:(S=n.startAt).inclusive,values:S.position}),n.endAt&&(i.structuredQuery.endAt={before:!(L=n.endAt).inclusive,values:L.position}),i}function gC(o){let n=function uC(o){const n=lC(o);return 4===n.length?oi.emptyPath():dC(n)}(o.parent);const i=o.structuredQuery,a=i.from?i.from.length:0;let h=null;if(a>0){$n(1===a);const H=i.from[0];H.allDescendants?h=H.collectionId:n=n.child(H.collectionId)}let _=[];i.where&&(_=function(H){const Y=hE(H);return Y instanceof vi&&mf(Y)?Y.getFilters():[Y]}(i.where));let x=[];i.orderBy&&(x=i.orderBy.map(H=>{return new Rp(sh((Y=H).field),function(pt){switch(pt){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(Y.direction));var Y}));let S=null;i.limit&&(S=function(H){let Y;return Y="object"==typeof H?H.value:H,Ov(Y)?null:Y}(i.limit));let L=null;var H;i.startAt&&(L=new Hc((H=i.startAt).values||[],!!H.before));let B=null;return i.endAt&&(B=function(H){return new Hc(H.values||[],!H.before)}(i.endAt)),function Sx(o,n,i,a,h,_,x,S){return new yf(o,n,i,a,h,_,x,S)}(n,h,x,_,S,"F",L,B)}function hE(o){return void 0!==o.unaryFilter?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=sh(n.unaryFilter.field);return xr.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=sh(n.unaryFilter.field);return xr.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const h=sh(n.unaryFilter.field);return xr.create(h,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const _=sh(n.unaryFilter.field);return xr.create(_,"!=",{nullValue:"NULL_VALUE"});default:return wn()}}(o):void 0!==o.fieldFilter?xr.create(sh((n=o).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return wn()}}(n.fieldFilter.op),n.fieldFilter.value):void 0!==o.compositeFilter?function(n){return vi.create(n.compositeFilter.filters.map(i=>hE(i)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return wn()}}(n.compositeFilter.op))}(o):wn();var n}function RT(o){return aE[o]}function LT(o){return $x[o]}function NT(o){return lE[o]}function oh(o){return{fieldPath:o.canonicalString()}}function sh(o){return _s.fromServerFormat(o.fieldPath)}function fE(o){return o instanceof xr?function(n){if("=="===n.op){if(XP(n.value))return{unaryFilter:{field:oh(n.field),op:"IS_NAN"}};if(YP(n.value))return{unaryFilter:{field:oh(n.field),op:"IS_NULL"}}}else if("!="===n.op){if(XP(n.value))return{unaryFilter:{field:oh(n.field),op:"IS_NOT_NAN"}};if(YP(n.value))return{unaryFilter:{field:oh(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:oh(n.field),op:LT(n.op),value:n.value}}}(o):o instanceof vi?function(n){const i=n.getFilters().map(a=>fE(a));return 1===i.length?i[0]:{compositeFilter:{op:NT(n.op),filters:i}}}(o):wn()}function pE(o){const n=[];return o.fields.forEach(i=>n.push(i.canonicalString())),{fieldPaths:n}}function gE(o){return o.length>=4&&"projects"===o.get(0)&&"databases"===o.get(2)}class Cf{constructor(n,i,a,h,_=Rn.min(),x=Rn.min(),S=ys.EMPTY_BYTE_STRING,L=null){this.target=n,this.targetId=i,this.purpose=a,this.sequenceNumber=h,this.snapshotVersion=_,this.lastLimboFreeSnapshotVersion=x,this.resumeToken=S,this.expectedCount=L}withSequenceNumber(n){return new Cf(this.target,this.targetId,this.purpose,n,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(n,i){return new Cf(this.target,this.targetId,this.purpose,this.sequenceNumber,i,this.lastLimboFreeSnapshotVersion,n,null)}withExpectedCount(n){return new Cf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,n)}withLastLimboFreeSnapshotVersion(n){return new Cf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,n,this.resumeToken,this.expectedCount)}}class mC{constructor(n){this.fe=n}}function am(o){const n=gC({parent:o.parent,structuredQuery:o.structuredQuery});return"LAST"===o.limitType?dl(n,n.limit,"L"):n}class Pf{constructor(){}_e(n,i){this.me(n,i),i.ge()}me(n,i){if("nullValue"in n)this.ye(i,5);else if("booleanValue"in n)this.ye(i,10),i.pe(n.booleanValue?1:0);else if("integerValue"in n)this.ye(i,15),i.pe(Vo(n.integerValue));else if("doubleValue"in n){const a=Vo(n.doubleValue);isNaN(a)?this.ye(i,13):(this.ye(i,15),Tv(a)?i.pe(0):i.pe(a))}else if("timestampValue"in n){const a=n.timestampValue;this.ye(i,20),"string"==typeof a?i.Ie(a):(i.Ie(`${a.seconds||""}`),i.pe(a.nanos||0))}else if("stringValue"in n)this.Te(n.stringValue,i),this.Ee(i);else if("bytesValue"in n)this.ye(i,30),i.Ae(Zu(n.bytesValue)),this.Ee(i);else if("referenceValue"in n)this.ve(n.referenceValue,i);else if("geoPointValue"in n){const a=n.geoPointValue;this.ye(i,45),i.pe(a.latitude||0),i.pe(a.longitude||0)}else"mapValue"in n?Xw(n)?this.ye(i,Number.MAX_SAFE_INTEGER):(this.Re(n.mapValue,i),this.Ee(i)):"arrayValue"in n?(this.Pe(n.arrayValue,i),this.Ee(i)):wn()}Te(n,i){this.ye(i,25),this.be(n,i)}be(n,i){i.Ie(n)}Re(n,i){const a=n.fields||{};this.ye(i,55);for(const h of Object.keys(a))this.Te(h,i),this.me(a[h],i)}Pe(n,i){const a=n.values||[];this.ye(i,50);for(const h of a)this.me(h,i)}ve(n,i){this.ye(i,37),hn.fromName(n).path.forEach(a=>{this.ye(i,60),this.be(a,i)})}ye(n,i){n.pe(i)}Ee(n){n.pe(2)}}Pf.Ve=new Pf;class xC{constructor(){this.rn=new sb}addToCollectionParentIndex(n,i){return this.rn.add(i),qt.resolve()}getCollectionParents(n,i){return qt.resolve(this.rn.getEntries(i))}addFieldIndex(n,i){return qt.resolve()}deleteFieldIndex(n,i){return qt.resolve()}getDocumentsMatchingTarget(n,i){return qt.resolve(null)}getIndexType(n,i){return qt.resolve(0)}getFieldIndexes(n,i){return qt.resolve([])}getNextCollectionGroupToUpdate(n){return qt.resolve(null)}getMinOffset(n,i){return qt.resolve(Il.min())}getMinOffsetFromCollectionGroup(n,i){return qt.resolve(Il.min())}updateCollectionGroup(n,i,a){return qt.resolve()}updateIndexEntries(n,i){return qt.resolve()}}class sb{constructor(){this.index={}}add(n){const i=n.lastSegment(),a=n.popLast(),h=this.index[i]||new Oo(oi.comparator),_=!h.has(a);return this.index[i]=h.add(a),_}has(n){const i=n.lastSegment(),a=n.popLast(),h=this.index[i];return h&&h.has(a)}getEntries(n){return(this.index[n]||new Oo(oi.comparator)).toArray()}}new Uint8Array(0);class os{constructor(n,i,a){this.cacheSizeCollectionThreshold=n,this.percentileToCollect=i,this.maximumSequenceNumbersToCollect=a}static withCacheSize(n){return new os(n,os.DEFAULT_COLLECTION_PERCENTILE,os.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}os.DEFAULT_COLLECTION_PERCENTILE=10,os.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,os.DEFAULT=new os(41943040,os.DEFAULT_COLLECTION_PERCENTILE,os.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),os.DISABLED=new os(-1,0,0);class _c{constructor(n){this.Nn=n}next(){return this.Nn+=2,this.Nn}static kn(){return new _c(0)}static Mn(){return new _c(-1)}}class bE{constructor(){this.changes=new vf(n=>n.toString(),(n,i)=>n.isEqual(i)),this.changesApplied=!1}addEntry(n){this.assertNotApplied(),this.changes.set(n.key,n)}removeEntry(n,i){this.assertNotApplied(),this.changes.set(n,ao.newInvalidDocument(n).setReadTime(i))}getEntry(n,i){this.assertNotApplied();const a=this.changes.get(i);return void 0!==a?qt.resolve(a):this.getFromCache(n,i)}getEntries(n,i){return this.getAllFromCache(n,i)}apply(n){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(n)}assertNotApplied(){}}class EC{constructor(n,i){this.overlayedDocument=n,this.mutatedFields=i}}class Xc{constructor(n,i,a,h){this.remoteDocumentCache=n,this.mutationQueue=i,this.documentOverlayCache=a,this.indexManager=h}getDocument(n,i){let a=null;return this.documentOverlayCache.getOverlay(n,i).next(h=>(a=h,this.remoteDocumentCache.getEntry(n,i))).next(h=>(null!==a&&ty(a.mutation,h,cl.empty(),An.now()),h))}getDocuments(n,i){return this.remoteDocumentCache.getEntries(n,i).next(a=>this.getLocalViewOfDocuments(n,a,Hr()).next(()=>a))}getLocalViewOfDocuments(n,i,a=Hr()){const h=hc();return this.populateOverlays(n,h,i).next(()=>this.computeViews(n,i,h,a).next(_=>{let x=tm();return _.forEach((S,L)=>{x=x.insert(S,L.overlayedDocument)}),x}))}getOverlayedDocuments(n,i){const a=hc();return this.populateOverlays(n,a,i).next(()=>this.computeViews(n,i,a,Hr()))}populateOverlays(n,i,a){const h=[];return a.forEach(_=>{i.has(_)||h.push(_)}),this.documentOverlayCache.getOverlays(n,h).next(_=>{_.forEach((x,S)=>{i.set(x,S)})})}computeViews(n,i,a,h){let _=Us();const x=$v(),S=$v();return i.forEach((L,B)=>{const H=a.get(B.key);h.has(B.key)&&(void 0===H||H.mutation instanceof Dl)?_=_.insert(B.key,B):void 0!==H?(x.set(B.key,H.mutation.getFieldMask()),ty(H.mutation,B,H.mutation.getFieldMask(),An.now())):x.set(B.key,cl.empty())}),this.recalculateAndSaveOverlays(n,_).next(L=>(L.forEach((B,H)=>x.set(B,H)),i.forEach((B,H)=>{var Y;return S.set(B,new EC(H,null!==(Y=x.get(B))&&void 0!==Y?Y:null))}),S))}recalculateAndSaveOverlays(n,i){const a=$v();let h=new lo((x,S)=>x-S),_=Hr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(n,i).next(x=>{for(const S of x)S.keys().forEach(L=>{const B=i.get(L);if(null===B)return;let H=a.get(L)||cl.empty();H=S.applyToLocalView(B,H),a.set(L,H);const Y=(h.get(S.batchId)||Hr()).add(L);h=h.insert(S.batchId,Y)})}).next(()=>{const x=[],S=h.getReverseIterator();for(;S.hasNext();){const L=S.getNext(),B=L.key,H=L.value,Y=eC();H.forEach(pt=>{if(!_.has(pt)){const xt=Fx(i.get(pt),a.get(pt));null!==xt&&Y.set(pt,xt),_=_.add(pt)}}),x.push(this.documentOverlayCache.saveOverlays(n,B,Y))}return qt.waitFor(x)}).next(()=>a)}recalculateAndSaveOverlaysForDocumentKeys(n,i){return this.remoteDocumentCache.getEntries(n,i).next(a=>this.recalculateAndSaveOverlays(n,a))}getDocumentsMatchingQuery(n,i,a){return hn.isDocumentKey((h=i).path)&&null===h.collectionGroup&&0===h.filters.length?this.getDocumentsMatchingDocumentQuery(n,i.path):function Dx(o){return null!==o.collectionGroup}(i)?this.getDocumentsMatchingCollectionGroupQuery(n,i,a):this.getDocumentsMatchingCollectionQuery(n,i,a);var h}getNextDocuments(n,i,a,h){return this.remoteDocumentCache.getAllFromCollectionGroup(n,i,a,h).next(_=>{const x=h-_.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(n,i,a.largestBatchId,h-_.size):qt.resolve(hc());let S=-1,L=_;return x.next(B=>qt.forEach(B,(H,Y)=>(S<Y.largestBatchId&&(S=Y.largestBatchId),_.get(H)?qt.resolve():this.remoteDocumentCache.getEntry(n,H).next(pt=>{L=L.insert(H,pt)}))).next(()=>this.populateOverlays(n,B,_)).next(()=>this.computeViews(n,L,B,Hr())).next(H=>({batchId:S,changes:em(H)})))})}getDocumentsMatchingDocumentQuery(n,i){return this.getDocument(n,new hn(i)).next(a=>{let h=tm();return a.isFoundDocument()&&(h=h.insert(a.key,a)),h})}getDocumentsMatchingCollectionGroupQuery(n,i,a){const h=i.collectionGroup;let _=tm();return this.indexManager.getCollectionParents(n,h).next(x=>qt.forEach(x,S=>{const L=(B=i,H=S.child(h),new yf(H,null,B.explicitOrderBy.slice(),B.filters.slice(),B.limit,B.limitType,B.startAt,B.endAt));var B,H;return this.getDocumentsMatchingCollectionQuery(n,L,a).next(B=>{B.forEach((H,Y)=>{_=_.insert(H,Y)})})}).next(()=>_))}getDocumentsMatchingCollectionQuery(n,i,a){let h;return this.documentOverlayCache.getOverlaysForCollection(n,i.path,a.largestBatchId).next(_=>(h=_,this.remoteDocumentCache.getDocumentsMatchingQuery(n,i,a,h))).next(_=>{h.forEach((S,L)=>{const B=L.getKey();null===_.get(B)&&(_=_.insert(B,ao.newInvalidDocument(B)))});let x=tm();return _.forEach((S,L)=>{const B=h.get(S);void 0!==B&&ty(B.mutation,L,cl.empty(),An.now()),Zc(i,L)&&(x=x.insert(S,L))}),x})}}class CE{constructor(n){this.serializer=n,this.cs=new Map,this.hs=new Map}getBundleMetadata(n,i){return qt.resolve(this.cs.get(i))}saveBundleMetadata(n,i){var a;return this.cs.set(i.id,{id:(a=i).id,version:a.version,createTime:_r(a.createTime)}),qt.resolve()}getNamedQuery(n,i){return qt.resolve(this.hs.get(i))}saveNamedQuery(n,i){return this.hs.set(i.name,{name:(a=i).name,query:am(a.bundledQuery),readTime:_r(a.readTime)}),qt.resolve();var a}}class ME{constructor(){this.overlays=new lo(hn.comparator),this.ls=new Map}getOverlay(n,i){return qt.resolve(this.overlays.get(i))}getOverlays(n,i){const a=hc();return qt.forEach(i,h=>this.getOverlay(n,h).next(_=>{null!==_&&a.set(h,_)})).next(()=>a)}saveOverlays(n,i,a){return a.forEach((h,_)=>{this.we(n,i,_)}),qt.resolve()}removeOverlaysForBatchId(n,i,a){const h=this.ls.get(a);return void 0!==h&&(h.forEach(_=>this.overlays=this.overlays.remove(_)),this.ls.delete(a)),qt.resolve()}getOverlaysForCollection(n,i,a){const h=hc(),_=i.length+1,x=new hn(i.child("")),S=this.overlays.getIteratorFrom(x);for(;S.hasNext();){const L=S.getNext().value,B=L.getKey();if(!i.isPrefixOf(B.path))break;B.path.length===_&&L.largestBatchId>a&&h.set(L.getKey(),L)}return qt.resolve(h)}getOverlaysForCollectionGroup(n,i,a,h){let _=new lo((B,H)=>B-H);const x=this.overlays.getIterator();for(;x.hasNext();){const B=x.getNext().value;if(B.getKey().getCollectionGroup()===i&&B.largestBatchId>a){let H=_.get(B.largestBatchId);null===H&&(H=hc(),_=_.insert(B.largestBatchId,H)),H.set(B.getKey(),B)}}const S=hc(),L=_.getIterator();for(;L.hasNext()&&(L.getNext().value.forEach((B,H)=>S.set(B,H)),!(S.size()>=h)););return qt.resolve(S)}we(n,i,a){const h=this.overlays.get(a.key);if(null!==h){const x=this.ls.get(h.largestBatchId).delete(a.key);this.ls.set(h.largestBatchId,x)}this.overlays=this.overlays.insert(a.key,new ny(i,a));let _=this.ls.get(i);void 0===_&&(_=Hr(),this.ls.set(i,_)),this.ls.set(i,_.add(a.key))}}class e1{constructor(){this.fs=new Oo(ss.ds),this.ws=new Oo(ss._s)}isEmpty(){return this.fs.isEmpty()}addReference(n,i){const a=new ss(n,i);this.fs=this.fs.add(a),this.ws=this.ws.add(a)}gs(n,i){n.forEach(a=>this.addReference(a,i))}removeReference(n,i){this.ys(new ss(n,i))}ps(n,i){n.forEach(a=>this.removeReference(a,i))}Is(n){const i=new hn(new oi([])),a=new ss(i,n),h=new ss(i,n+1),_=[];return this.ws.forEachInRange([a,h],x=>{this.ys(x),_.push(x.key)}),_}Ts(){this.fs.forEach(n=>this.ys(n))}ys(n){this.fs=this.fs.delete(n),this.ws=this.ws.delete(n)}Es(n){const i=new hn(new oi([])),a=new ss(i,n),h=new ss(i,n+1);let _=Hr();return this.ws.forEachInRange([a,h],x=>{_=_.add(x.key)}),_}containsKey(n){const i=new ss(n,0),a=this.fs.firstAfterOrEqual(i);return null!==a&&n.isEqual(a.key)}}class ss{constructor(n,i){this.key=n,this.As=i}static ds(n,i){return hn.comparator(n.key,i.key)||Br(n.As,i.As)}static _s(n,i){return Br(n.As,i.As)||hn.comparator(n.key,i.key)}}class ly{constructor(n,i){this.indexManager=n,this.referenceDelegate=i,this.mutationQueue=[],this.vs=1,this.Rs=new Oo(ss.ds)}checkEmpty(n){return qt.resolve(0===this.mutationQueue.length)}addMutationBatch(n,i,a,h){const _=this.vs;this.vs++;const x=new Vx(_,i,a,h);this.mutationQueue.push(x);for(const S of h)this.Rs=this.Rs.add(new ss(S.key,_)),this.indexManager.addToCollectionParentIndex(n,S.key.path.popLast());return qt.resolve(x)}lookupMutationBatch(n,i){return qt.resolve(this.Ps(i))}getNextMutationBatchAfterBatchId(n,i){const h=this.bs(i+1),_=h<0?0:h;return qt.resolve(this.mutationQueue.length>_?this.mutationQueue[_]:null)}getHighestUnacknowledgedBatchId(){return qt.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(n){return qt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(n,i){const a=new ss(i,0),h=new ss(i,Number.POSITIVE_INFINITY),_=[];return this.Rs.forEachInRange([a,h],x=>{const S=this.Ps(x.As);_.push(S)}),qt.resolve(_)}getAllMutationBatchesAffectingDocumentKeys(n,i){let a=new Oo(Br);return i.forEach(h=>{const _=new ss(h,0),x=new ss(h,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([_,x],S=>{a=a.add(S.As)})}),qt.resolve(this.Vs(a))}getAllMutationBatchesAffectingQuery(n,i){const a=i.path,h=a.length+1;let _=a;hn.isDocumentKey(_)||(_=_.child(""));const x=new ss(new hn(_),0);let S=new Oo(Br);return this.Rs.forEachWhile(L=>{const B=L.key.path;return!!a.isPrefixOf(B)&&(B.length===h&&(S=S.add(L.As)),!0)},x),qt.resolve(this.Vs(S))}Vs(n){const i=[];return n.forEach(a=>{const h=this.Ps(a);null!==h&&i.push(h)}),i}removeMutationBatch(n,i){$n(0===this.Ss(i.batchId,"removed")),this.mutationQueue.shift();let a=this.Rs;return qt.forEach(i.mutations,h=>{const _=new ss(h.key,i.batchId);return a=a.delete(_),this.referenceDelegate.markPotentiallyOrphaned(n,h.key)}).next(()=>{this.Rs=a})}Cn(n){}containsKey(n,i){const a=new ss(i,0),h=this.Rs.firstAfterOrEqual(a);return qt.resolve(i.isEqual(h&&h.key))}performConsistencyCheck(n){return qt.resolve()}Ss(n,i){return this.bs(n)}bs(n){return 0===this.mutationQueue.length?0:n-this.mutationQueue[0].batchId}Ps(n){const i=this.bs(n);return i<0||i>=this.mutationQueue.length?null:this.mutationQueue[i]}}class PE{constructor(n){this.Ds=n,this.docs=new lo(hn.comparator),this.size=0}setIndexManager(n){this.indexManager=n}addEntry(n,i){const a=i.key,h=this.docs.get(a),_=h?h.size:0,x=this.Ds(i);return this.docs=this.docs.insert(a,{document:i.mutableCopy(),size:x}),this.size+=x-_,this.indexManager.addToCollectionParentIndex(n,a.path.popLast())}removeEntry(n){const i=this.docs.get(n);i&&(this.docs=this.docs.remove(n),this.size-=i.size)}getEntry(n,i){const a=this.docs.get(i);return qt.resolve(a?a.document.mutableCopy():ao.newInvalidDocument(i))}getEntries(n,i){let a=Us();return i.forEach(h=>{const _=this.docs.get(h);a=a.insert(h,_?_.document.mutableCopy():ao.newInvalidDocument(h))}),qt.resolve(a)}getDocumentsMatchingQuery(n,i,a,h){let _=Us();const x=i.path,S=new hn(x.child("")),L=this.docs.getIteratorFrom(S);for(;L.hasNext();){const{key:B,value:{document:H}}=L.getNext();if(!x.isPrefixOf(B.path))break;B.path.length>x.length+1||F_(Ug(H),a)<=0||(h.has(H.key)||Zc(i,H))&&(_=_.insert(H.key,H.mutableCopy()))}return qt.resolve(_)}getAllFromCollectionGroup(n,i,a,h){wn()}Cs(n,i){return qt.forEach(this.docs,a=>i(a))}newChangeBuffer(n){return new EE(this)}getSize(n){return qt.resolve(this.size)}}class EE extends bE{constructor(n){super(),this.os=n}applyChanges(n){const i=[];return this.changes.forEach((a,h)=>{h.isValidDocument()?i.push(this.os.addEntry(n,h)):this.os.removeEntry(a)}),qt.waitFor(i)}getFromCache(n,i){return this.os.getEntry(n,i)}getAllFromCache(n,i){return this.os.getEntries(n,i)}}class VT{constructor(n){this.persistence=n,this.xs=new vf(i=>_f(i),Qg),this.lastRemoteSnapshotVersion=Rn.min(),this.highestTargetId=0,this.Ns=0,this.ks=new e1,this.targetCount=0,this.Ms=_c.kn()}forEachTarget(n,i){return this.xs.forEach((a,h)=>i(h)),qt.resolve()}getLastRemoteSnapshotVersion(n){return qt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(n){return qt.resolve(this.Ns)}allocateTargetId(n){return this.highestTargetId=this.Ms.next(),qt.resolve(this.highestTargetId)}setTargetsMetadata(n,i,a){return a&&(this.lastRemoteSnapshotVersion=a),i>this.Ns&&(this.Ns=i),qt.resolve()}Fn(n){this.xs.set(n.target,n);const i=n.targetId;i>this.highestTargetId&&(this.Ms=new _c(i),this.highestTargetId=i),n.sequenceNumber>this.Ns&&(this.Ns=n.sequenceNumber)}addTargetData(n,i){return this.Fn(i),this.targetCount+=1,qt.resolve()}updateTargetData(n,i){return this.Fn(i),qt.resolve()}removeTargetData(n,i){return this.xs.delete(i.target),this.ks.Is(i.targetId),this.targetCount-=1,qt.resolve()}removeTargets(n,i,a){let h=0;const _=[];return this.xs.forEach((x,S)=>{S.sequenceNumber<=i&&null===a.get(S.targetId)&&(this.xs.delete(x),_.push(this.removeMatchingKeysForTargetId(n,S.targetId)),h++)}),qt.waitFor(_).next(()=>h)}getTargetCount(n){return qt.resolve(this.targetCount)}getTargetData(n,i){const a=this.xs.get(i)||null;return qt.resolve(a)}addMatchingKeys(n,i,a){return this.ks.gs(i,a),qt.resolve()}removeMatchingKeys(n,i,a){this.ks.ps(i,a);const h=this.persistence.referenceDelegate,_=[];return h&&i.forEach(x=>{_.push(h.markPotentiallyOrphaned(n,x))}),qt.waitFor(_)}removeMatchingKeysForTargetId(n,i){return this.ks.Is(i),qt.resolve()}getMatchingKeysForTargetId(n,i){const a=this.ks.Es(i);return qt.resolve(a)}containsKey(n,i){return qt.resolve(this.ks.containsKey(i))}}class uh{constructor(n,i){this.$s={},this.overlays={},this.Os=new cc(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=n(this),this.Bs=new VT(this),this.indexManager=new xC,this.remoteDocumentCache=new PE(a=>this.referenceDelegate.Ls(a)),this.serializer=new mC(i),this.qs=new CE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(n){return this.indexManager}getDocumentOverlayCache(n){let i=this.overlays[n.toKey()];return i||(i=new ME,this.overlays[n.toKey()]=i),i}getMutationQueue(n,i){let a=this.$s[n.toKey()];return a||(a=new ly(i,this.referenceDelegate),this.$s[n.toKey()]=a),a}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(n,i,a){ze("MemoryPersistence","Starting transaction:",n);const h=new cy(this.Os.next());return this.referenceDelegate.Us(),a(h).next(_=>this.referenceDelegate.Ks(h).next(()=>_)).toPromise().then(_=>(h.raiseOnCommittedEvent(),_))}Gs(n,i){return qt.or(Object.values(this.$s).map(a=>()=>a.containsKey(n,i)))}}class cy extends z_{constructor(n){super(),this.currentSequenceNumber=n}}class db{constructor(n){this.persistence=n,this.Qs=new e1,this.js=null}static zs(n){return new db(n)}get Ws(){if(this.js)return this.js;throw wn()}addReference(n,i,a){return this.Qs.addReference(a,i),this.Ws.delete(a.toString()),qt.resolve()}removeReference(n,i,a){return this.Qs.removeReference(a,i),this.Ws.add(a.toString()),qt.resolve()}markPotentiallyOrphaned(n,i){return this.Ws.add(i.toString()),qt.resolve()}removeTarget(n,i){this.Qs.Is(i.targetId).forEach(h=>this.Ws.add(h.toString()));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(n,i.targetId).next(h=>{h.forEach(_=>this.Ws.add(_.toString()))}).next(()=>a.removeTargetData(n,i))}Us(){this.js=new Set}Ks(n){const i=this.persistence.getRemoteDocumentCache().newChangeBuffer();return qt.forEach(this.Ws,a=>{const h=hn.fromPath(a);return this.Hs(n,h).next(_=>{_||i.removeEntry(h,Rn.min())})}).next(()=>(this.js=null,i.apply(n)))}updateLimboDocument(n,i){return this.Hs(n,i).next(a=>{a?this.Ws.delete(i.toString()):this.Ws.add(i.toString())})}Ls(n){return 0}Hs(n,i){return qt.or([()=>qt.resolve(this.Qs.containsKey(i)),()=>this.persistence.getTargetCache().containsKey(n,i),()=>this.persistence.Gs(n,i)])}}class TC{constructor(n,i,a,h){this.targetId=n,this.fromCache=i,this.Fi=a,this.Bi=h}static Li(n,i){let a=Hr(),h=Hr();for(const _ of i.docChanges)switch(_.type){case 0:a=a.add(_.doc.key);break;case 1:h=h.add(_.doc.key)}return new TC(n,i.fromCache,a,h)}}class OE{constructor(){this.qi=!1}initialize(n,i){this.Ui=n,this.indexManager=i,this.qi=!0}getDocumentsMatchingQuery(n,i,a,h){return this.Ki(n,i).next(_=>_||this.Gi(n,i,h,a)).next(_=>_||this.Qi(n,i))}Ki(n,i){if(tC(i))return qt.resolve(null);let a=To(i);return this.indexManager.getIndexType(n,a).next(h=>0===h?null:(null!==i.limit&&1===h&&(i=dl(i,null,"F"),a=To(i)),this.indexManager.getDocumentsMatchingTarget(n,a).next(_=>{const x=Hr(..._);return this.Ui.getDocuments(n,x).next(S=>this.indexManager.getMinOffset(n,a).next(L=>{const B=this.ji(i,S);return this.zi(i,B,x,L.readTime)?this.Ki(n,dl(i,null,"F")):this.Wi(n,B,i,L)}))})))}Gi(n,i,a,h){return tC(i)||h.isEqual(Rn.min())?this.Qi(n,i):this.Ui.getDocuments(n,a).next(_=>{const x=this.ji(i,_);return this.zi(i,x,a,h)?this.Qi(n,i):(px()<=Kl.in.DEBUG&&ze("QueryEngine","Re-using previous result from %s to execute query: %s",h.toString(),Vv(i)),this.Wi(n,x,i,function Eo(o,n){const i=o.toTimestamp().seconds,a=o.toTimestamp().nanoseconds+1,h=Rn.fromTimestamp(1e9===a?new An(i+1,0):new An(i,a));return new Il(h,hn.empty(),n)}(h,-1)))})}ji(n,i){let a=new Oo(nE(n));return i.forEach((h,_)=>{Zc(n,_)&&(a=a.add(_))}),a}zi(n,i,a,h){if(null===n.limit)return!1;if(a.size!==i.size)return!0;const _="F"===n.limitType?i.last():i.first();return!!_&&(_.hasPendingWrites||_.version.compareTo(h)>0)}Qi(n,i){return px()<=Kl.in.DEBUG&&ze("QueryEngine","Using full collection scan to execute query:",Vv(i)),this.Ui.getDocumentsMatchingQuery(n,i,Il.min())}Wi(n,i,a,h){return this.Ui.getDocumentsMatchingQuery(n,a,h).next(_=>(i.forEach(x=>{_=_.insert(x.key,x)}),_))}}class If{constructor(n,i,a,h){this.persistence=n,this.Hi=i,this.serializer=h,this.Ji=new lo(Br),this.Yi=new vf(_=>_f(_),Qg),this.Xi=new Map,this.Zi=n.getRemoteDocumentCache(),this.Bs=n.getTargetCache(),this.qs=n.getBundleCache(),this.tr(a)}tr(n){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(n),this.indexManager=this.persistence.getIndexManager(n),this.mutationQueue=this.persistence.getMutationQueue(n,this.indexManager),this.localDocuments=new Xc(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(n){return this.persistence.runTransaction("Collect garbage","readwrite-primary",i=>n.collect(i,this.Ji))}}function i1(o,n){return qp.apply(this,arguments)}function qp(){return qp=(0,Je.Z)(function*(o,n){const i=_n(o);return yield i.persistence.runTransaction("Handle user change","readonly",a=>{let h;return i.mutationQueue.getAllMutationBatches(a).next(_=>(h=_,i.tr(n),i.mutationQueue.getAllMutationBatches(a))).next(_=>{const x=[],S=[];let L=Hr();for(const B of h){x.push(B.batchId);for(const H of B.mutations)L=L.add(H.key)}for(const B of _){S.push(B.batchId);for(const H of B.mutations)L=L.add(H.key)}return i.localDocuments.getDocuments(a,L).next(B=>({er:B,removedBatchIds:x,addedBatchIds:S}))})})}),qp.apply(this,arguments)}function IC(o){const n=_n(o);return n.persistence.runTransaction("Get last remote snapshot version","readonly",i=>n.Bs.getLastRemoteSnapshotVersion(i))}function yb(o,n){const i=_n(o);return i.persistence.runTransaction("Get next mutation batch","readonly",a=>(void 0===n&&(n=-1),i.mutationQueue.getNextMutationBatchAfterBatchId(a,n)))}function pm(o,n,i){return gm.apply(this,arguments)}function gm(){return gm=(0,Je.Z)(function*(o,n,i){const a=_n(o),h=a.Ji.get(n),_=i?"readwrite":"readwrite-primary";try{i||(yield a.persistence.runTransaction("Release target",_,x=>a.persistence.referenceDelegate.removeTarget(x,h)))}catch(x){if(!Ap(x))throw x;ze("LocalStore",`Failed to update sequence numbers for target ${n}: ${x}`)}a.Ji=a.Ji.remove(n),a.Yi.delete(h.target)}),gm.apply(this,arguments)}function vb(o,n,i){const a=_n(o);let h=Rn.min(),_=Hr();return a.persistence.runTransaction("Execute query","readonly",x=>function(S,L,B){const H=_n(S),Y=H.Yi.get(B);return void 0!==Y?qt.resolve(H.Ji.get(Y)):H.Bs.getTargetData(L,B)}(a,x,To(n)).next(S=>{if(S)return h=S.lastLimboFreeSnapshotVersion,a.Bs.getMatchingKeysForTargetId(x,S.targetId).next(L=>{_=L})}).next(()=>a.Hi.getDocumentsMatchingQuery(x,n,i?h:Rn.min(),i?_:Hr())).next(S=>(function bb(o,n,i){let a=o.Xi.get(n)||Rn.min();i.forEach((h,_)=>{_.readTime.compareTo(a)>0&&(a=_.readTime)}),o.Xi.set(n,a)}(a,function Z_(o){return o.collectionGroup||(o.path.length%2==1?o.path.lastSegment():o.path.get(o.path.length-2))}(n),S),{documents:S,ir:_})))}class d1{constructor(){this.activeTargetIds=function K_(){return nC}()}lr(n){this.activeTargetIds=this.activeTargetIds.add(n)}dr(n){this.activeTargetIds=this.activeTargetIds.delete(n)}hr(){const n={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(n)}}class f1{constructor(){this.Hr=new d1,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(n){}updateMutationState(n,i,a){}addLocalQueryTarget(n){return this.Hr.lr(n),this.Jr[n]||"not-current"}updateQueryState(n,i,a){this.Jr[n]=i}removeLocalQueryTarget(n){this.Hr.dr(n)}isLocalQueryTarget(n){return this.Hr.activeTargetIds.has(n)}clearQueryState(n){delete this.Jr[n]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(n){return this.Hr.activeTargetIds.has(n)}start(){return this.Hr=new d1,Promise.resolve()}handleUserChange(n,i,a){}setOnlineState(n){}shutdown(){}writeSequenceNumber(n){}notifyBundleLoaded(n){}}class GT{Yr(n){}shutdown(){}}class AE{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(n){this.so.push(n)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){ze("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const n of this.so)n(0)}no(){ze("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const n of this.so)n(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let xb=null;function fy(){return null===xb?xb=268435456+Math.round(2147483648*Math.random()):xb++,"0x"+xb.toString(16)}const DE={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class AC{constructor(n){this.ro=n.ro,this.oo=n.oo}uo(n){this.co=n}ao(n){this.ho=n}onMessage(n){this.lo=n}close(){this.oo()}send(n){this.ro(n)}fo(){this.co()}wo(n){this.ho(n)}_o(n){this.lo(n)}}const ya="WebChannelConnection";class kE extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId,this.mo=(n.ssl?"https":"http")+"://"+n.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(n,i,a,h,_){const x=fy(),S=this.To(n,i);ze("RestConnection",`Sending RPC '${n}' ${x}:`,S,a);const L={};return this.Eo(L,h,_),this.Ao(n,S,L,a).then(B=>(ze("RestConnection",`Received RPC '${n}' ${x}: `,B),B),B=>{throw lc("RestConnection",`RPC '${n}' ${x} failed with error: `,B,"url: ",S,"request:",a),B})}vo(n,i,a,h,_,x){return this.Io(n,i,a,h,_)}Eo(n,i,a){n["X-Goog-Api-Client"]="gl-js/ fire/"+_a,n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((h,_)=>n[_]=h),a&&a.headers.forEach((h,_)=>n[_]=h)}To(n,i){return`${this.mo}/v1/${i}:${DE[n]}`}}{constructor(n){super(n),this.forceLongPolling=n.forceLongPolling,this.autoDetectLongPolling=n.autoDetectLongPolling,this.useFetchStreams=n.useFetchStreams,this.longPollingOptions=n.longPollingOptions}Ao(n,i,a,h){const _=fy();return new Promise((x,S)=>{const L=new FP;L.setWithCredentials(!0),L.listenOnce(NP.COMPLETE,()=>{try{switch(L.getLastErrorCode()){case zg.NO_ERROR:const H=L.getResponseJson();ze(ya,`XHR for RPC '${n}' ${_} received:`,JSON.stringify(H)),x(H);break;case zg.TIMEOUT:ze(ya,`RPC '${n}' ${_} timed out`),S(new Se(Jt.DEADLINE_EXCEEDED,"Request time out"));break;case zg.HTTP_ERROR:const Y=L.getStatus();if(ze(ya,`RPC '${n}' ${_} failed with status:`,Y,"response text:",L.getResponseText()),Y>0){let pt=L.getResponseJson();Array.isArray(pt)&&(pt=pt[0]);const xt=pt?.error;if(xt&&xt.status&&xt.message){const At=function(Ut){const Zt=Ut.toLowerCase().replace(/_/g,"-");return Object.values(Jt).indexOf(Zt)>=0?Zt:Jt.UNKNOWN}(xt.status);S(new Se(At,xt.message))}else S(new Se(Jt.UNKNOWN,"Server responded with status "+L.getStatus()))}else S(new Se(Jt.UNAVAILABLE,"Connection failed."));break;default:wn()}}finally{ze(ya,`RPC '${n}' ${_} completed.`)}});const B=JSON.stringify(h);ze(ya,`RPC '${n}' ${_} sending request:`,h),L.send(i,"POST",B,a,15)})}Ro(n,i,a){const h=fy(),_=[this.mo,"/","google.firestore.v1.Firestore","/",n,"/channel"],x=LP(),S=MT(),L={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},B=this.longPollingOptions.timeoutSeconds;void 0!==B&&(L.longPollingTimeout=Math.round(1e3*B)),this.useFetchStreams&&(L.xmlHttpFactory=new Uw({})),this.Eo(L.initMessageHeaders,i,a),L.encodeInitMessageHeaders=!0;const H=_.join("");ze(ya,`Creating RPC '${n}' stream ${h}: ${H}`,L);const Y=x.createWebChannel(H,L);let pt=!1,xt=!1;const At=new AC({ro:Zt=>{xt?ze(ya,`Not sending because RPC '${n}' stream ${h} is closed:`,Zt):(pt||(ze(ya,`Opening RPC '${n}' stream ${h} transport.`),Y.open(),pt=!0),ze(ya,`RPC '${n}' stream ${h} sending:`,Zt),Y.send(Zt))},oo:()=>Y.close()}),Ut=(Zt,qe,fn)=>{Zt.listen(qe,$e=>{try{fn($e)}catch(cn){setTimeout(()=>{throw cn},0)}})};return Ut(Y,$c.EventType.OPEN,()=>{xt||ze(ya,`RPC '${n}' stream ${h} transport opened.`)}),Ut(Y,$c.EventType.CLOSE,()=>{xt||(xt=!0,ze(ya,`RPC '${n}' stream ${h} transport closed`),At.wo())}),Ut(Y,$c.EventType.ERROR,Zt=>{xt||(xt=!0,lc(ya,`RPC '${n}' stream ${h} transport errored:`,Zt),At.wo(new Se(Jt.UNAVAILABLE,"The operation could not be completed")))}),Ut(Y,$c.EventType.MESSAGE,Zt=>{var qe;if(!xt){const fn=Zt.data[0];$n(!!fn);const cn=fn.error||(null===(qe=fn[0])||void 0===qe?void 0:qe.error);if(cn){ze(ya,`RPC '${n}' stream ${h} received error:`,cn);const Mr=cn.status;let Cr=function(ks){const iu=uo[ks];if(void 0!==iu)return Kv(iu)}(Mr),Bi=cn.message;void 0===Cr&&(Cr=Jt.INTERNAL,Bi="Unknown error status: "+Mr+" with message "+cn.message),xt=!0,At.wo(new Se(Cr,Bi)),Y.close()}else ze(ya,`RPC '${n}' stream ${h} received:`,fn),At._o(fn)}}),Ut(S,fx.STAT_EVENT,Zt=>{Zt.stat===Bw.PROXY?ze(ya,`RPC '${n}' stream ${h} detected buffering proxy`):Zt.stat===Bw.NOPROXY&&ze(ya,`RPC '${n}' stream ${h} detected no buffering proxy`)}),setTimeout(()=>{At.fo()},0),At}}function p1(){return typeof document<"u"?document:null}function wb(o){return new Ko(o,!0)}class DC{constructor(n,i,a=1e3,h=1.5,_=6e4){this.ii=n,this.timerId=i,this.Po=a,this.bo=h,this.Vo=_,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(n){this.cancel();const i=Math.floor(this.So+this.ko()),a=Math.max(0,Date.now()-this.Co),h=Math.max(0,i-a);h>0&&ze("ExponentialBackoff",`Backing off for ${h} ms (base delay: ${this.So} ms, delay with jitter: ${i} ms, last attempt: ${a} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,h,()=>(this.Co=Date.now(),n())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class kC{constructor(n,i,a,h,_,x,S,L){this.ii=n,this.$o=a,this.Oo=h,this.connection=_,this.authCredentialsProvider=x,this.appCheckCredentialsProvider=S,this.listener=L,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new DC(n,i)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var n=this;return(0,Je.Z)(function*(){n.Uo()&&(yield n.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(n){this.Ho(),this.stream.send(n)}zo(){var n=this;return(0,Je.Z)(function*(){if(n.Ko())return n.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(n,i){var a=this;return(0,Je.Z)(function*(){a.Ho(),a.Jo(),a.qo.cancel(),a.Fo++,4!==n?a.qo.reset():i&&i.code===Jt.RESOURCE_EXHAUSTED?(rs(i.toString()),rs("Using maximum backoff delay to prevent overloading the backend."),a.qo.xo()):i&&i.code===Jt.UNAUTHENTICATED&&3!==a.state&&(a.authCredentialsProvider.invalidateToken(),a.appCheckCredentialsProvider.invalidateToken()),null!==a.stream&&(a.Yo(),a.stream.close(),a.stream=null),a.state=n,yield a.listener.ao(i)})()}Yo(){}auth(){this.state=1;const n=this.Xo(this.Fo),i=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,h])=>{this.Fo===i&&this.Zo(a,h)},a=>{n(()=>{const h=new Se(Jt.UNKNOWN,"Fetching auth token failed: "+a.message);return this.tu(h)})})}Zo(n,i){const a=this.Xo(this.Fo);this.stream=this.eu(n,i),this.stream.uo(()=>{a(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(h=>{a(()=>this.tu(h))}),this.stream.onMessage(h=>{a(()=>this.onMessage(h))})}Go(){var n=this;this.state=5,this.qo.No((0,Je.Z)(function*(){n.state=0,n.start()}))}tu(n){return ze("PersistentStream",`close with error: ${n}`),this.stream=null,this.close(4,n)}Xo(n){return i=>{this.ii.enqueueAndForget(()=>this.Fo===n?i():(ze("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Qc extends kC{constructor(n,i,a,h,_,x){super(n,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",i,a,h,x),this.serializer=_}eu(n,i){return this.connection.Ro("Listen",n,i)}onMessage(n){this.qo.reset();const i=function rh(o,n){let i;if("targetChange"in n){const a="NO_CHANGE"===(L=n.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===L?1:"REMOVE"===L?2:"CURRENT"===L?3:"RESET"===L?4:wn(),h=n.targetChange.targetIds||[],_=function(L,B){return L.useProto3Json?($n(void 0===B||"string"==typeof B),ys.fromBase64String(B||"")):($n(void 0===B||B instanceof Uint8Array),ys.fromUint8Array(B||new Uint8Array))}(o,n.targetChange.resumeToken),x=n.targetChange.cause,S=x&&function(L){const B=void 0===L.code?Jt.UNKNOWN:Kv(L.code);return new Se(B,L.message||"")}(x);i=new Xu(a,h,_,S||null)}else if("documentChange"in n){const a=n.documentChange,h=nh(o,a.document.name),_=_r(a.document.updateTime),x=a.document.createTime?_r(a.document.createTime):Rn.min(),S=new co({mapValue:{fields:a.document.fields}}),L=ao.newFoundDocument(h,_,x,S);i=new pc(a.targetIds||[],a.removedTargetIds||[],L.key,L)}else if("documentDelete"in n){const a=n.documentDelete,h=nh(o,a.document),_=a.readTime?_r(a.readTime):Rn.min(),x=ao.newNoDocument(h,_);i=new pc([],a.removedTargetIds||[],x.key,x)}else if("documentRemove"in n){const a=n.documentRemove,h=nh(o,a.document);i=new pc([],a.removedTargetIds||[],h,null)}else{if(!("filter"in n))return wn();{const a=n.filter,{count:h=0,unchangedNames:_}=a,x=new Zv(h,_);i=new hl(a.targetId,x)}}var L;return i}(this.serializer,n),a=function(h){if(!("targetChange"in h))return Rn.min();const _=h.targetChange;return _.targetIds&&_.targetIds.length?Rn.min():_.readTime?_r(_.readTime):Rn.min()}(n);return this.listener.nu(i,a)}su(n){const i={};i.database=Jv(this.serializer),i.addTarget=function(h,_){let x;const S=_.target;if(x=H_(S)?{documents:Wc(h,S)}:{query:gc(h,S)},x.targetId=_.targetId,_.resumeToken.approximateByteSize()>0){x.resumeToken=cE(h,_.resumeToken);const L=Gx(h,_.expectedCount);null!==L&&(x.expectedCount=L)}else if(_.snapshotVersion.compareTo(Rn.min())>0){x.readTime=om(h,_.snapshotVersion.toTimestamp());const L=Gx(h,_.expectedCount);null!==L&&(x.expectedCount=L)}return x}(this.serializer,n);const a=function dE(o,n){const i=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return wn()}}(n.purpose);return null==i?null:{"goog-listen-tags":i}}(0,n);a&&(i.labels=a),this.Wo(i)}iu(n){const i={};i.database=Jv(this.serializer),i.removeTarget=n,this.Wo(i)}}class LE extends kC{constructor(n,i,a,h,_,x){super(n,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,a,h,x),this.serializer=_,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(n,i){return this.connection.Ro("Write",n,i)}onMessage(n){if($n(!!n.streamToken),this.lastStreamToken=n.streamToken,this.ru){this.qo.reset();const i=function ih(o,n){return o&&o.length>0?($n(void 0!==n),o.map(i=>function(a,h){let _=_r(a.updateTime?a.updateTime:h);return _.isEqual(Rn.min())&&(_=_r(h)),new X_(_,a.transformResults||[])}(i,n))):[]}(n.writeResults,n.commitTime),a=_r(n.commitTime);return this.listener.cu(a,i)}return $n(!n.writeResults||0===n.writeResults.length),this.ru=!0,this.listener.au()}hu(){const n={};n.database=Jv(this.serializer),this.Wo(n)}uu(n){const i={streamToken:this.lastStreamToken,writes:n.map(a=>function tb(o,n){let i;if(n instanceof rm)i={update:kT(o,n.key,n.value)};else if(n instanceof Jd)i={delete:eh(o,n.key)};else if(n instanceof Dl)i={update:kT(o,n.key,n.data),updateMask:pE(n.fieldMask)};else{if(!(n instanceof Ux))return wn();i={verify:eh(o,n.key)}}return n.fieldTransforms.length>0&&(i.updateTransforms=n.fieldTransforms.map(a=>function(h,_){const x=_.transform;if(x instanceof nm)return{fieldPath:_.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(x instanceof La)return{fieldPath:_.field.canonicalString(),appendMissingElements:{values:x.elements}};if(x instanceof Yu)return{fieldPath:_.field.canonicalString(),removeAllFromArray:{values:x.elements}};if(x instanceof fc)return{fieldPath:_.field.canonicalString(),increment:x.gt};throw wn()}(0,a))),n.precondition.isNone||(i.currentDocument=void 0!==(h=n.precondition).updateTime?{updateTime:uE(o,h.updateTime)}:void 0!==h.exists?{exists:h.exists}:wn()),i;var h}(this.serializer,a))};this.Wo(i)}}class NE extends class{}{constructor(n,i,a,h){super(),this.authCredentials=n,this.appCheckCredentials=i,this.connection=a,this.serializer=h,this.lu=!1}fu(){if(this.lu)throw new Se(Jt.FAILED_PRECONDITION,"The client has already been terminated.")}Io(n,i,a){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([h,_])=>this.connection.Io(n,i,a,h,_)).catch(h=>{throw"FirebaseError"===h.name?(h.code===Jt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new Se(Jt.UNKNOWN,h.toString())})}vo(n,i,a,h){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([_,x])=>this.connection.vo(n,i,a,_,x,h)).catch(_=>{throw"FirebaseError"===_.name?(_.code===Jt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),_):new Se(Jt.UNKNOWN,_.toString())})}terminate(){this.lu=!0}}class FE{constructor(n,i){this.asyncQueue=n,this.onlineStateHandler=i,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(n){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${n.toString()}`),this.yu("Offline")))}set(n){this.Tu(),this.wu=0,"Online"===n&&(this.mu=!1),this.yu(n)}yu(n){n!==this.state&&(this.state=n,this.onlineStateHandler(n))}pu(n){const i=`Could not reach Cloud Firestore backend. ${n}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(rs(i),this.mu=!1):ze("OnlineStateTracker",i)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class qT{constructor(n,i,a,h,_){var x=this;this.localStore=n,this.datastore=i,this.asyncQueue=a,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=_,this.Pu.Yr(S=>{a.enqueueAndForget((0,Je.Z)(function*(){var L;rd(x)&&(ze("RemoteStore","Restarting streams for network reachability change."),yield(L=(0,Je.Z)(function*(B){const H=_n(B);H.vu.add(4),yield py(H),H.bu.set("Unknown"),H.vu.delete(4),yield Wp(H)}),function(B){return L.apply(this,arguments)})(x))}))}),this.bu=new FE(a,h)}}function Wp(o){return RC.apply(this,arguments)}function RC(){return RC=(0,Je.Z)(function*(o){if(rd(o))for(const n of o.Ru)yield n(!0)}),RC.apply(this,arguments)}function py(o){return Mb.apply(this,arguments)}function Mb(){return Mb=(0,Je.Z)(function*(o){for(const n of o.Ru)yield n(!1)}),Mb.apply(this,arguments)}function mm(o,n){const i=_n(o);i.Au.has(n.targetId)||(i.Au.set(n.targetId,n),nd(i)?g1(i):Yp(i).Ko()&&Pb(i,n))}function gy(o,n){const i=_n(o),a=Yp(i);i.Au.delete(n),a.Ko()&&LC(i,n),0===i.Au.size&&(a.Ko()?a.jo():rd(i)&&i.bu.set("Unknown"))}function Pb(o,n){if(o.Vu.qt(n.targetId),n.resumeToken.approximateByteSize()>0||n.snapshotVersion.compareTo(Rn.min())>0){const i=o.remoteSyncer.getRemoteKeysForTarget(n.targetId).size;n=n.withExpectedCount(i)}Yp(o).su(n)}function LC(o,n){o.Vu.qt(n),Yp(o).iu(n)}function g1(o){o.Vu=new wf({getRemoteKeysForTarget:n=>o.remoteSyncer.getRemoteKeysForTarget(n),le:n=>o.Au.get(n)||null,ue:()=>o.datastore.serializer.databaseId}),Yp(o).start(),o.bu.gu()}function nd(o){return rd(o)&&!Yp(o).Uo()&&o.Au.size>0}function rd(o){return 0===_n(o).vu.size}function m1(o){o.Vu=void 0}function Kp(o){return Eb.apply(this,arguments)}function Eb(){return Eb=(0,Je.Z)(function*(o){o.Au.forEach((n,i)=>{Pb(o,n)})}),Eb.apply(this,arguments)}function ZT(o,n){return zE.apply(this,arguments)}function zE(){return zE=(0,Je.Z)(function*(o,n){m1(o),nd(o)?(o.bu.Iu(n),g1(o)):o.bu.set("Unknown")}),zE.apply(this,arguments)}function NC(o,n,i){return Ob.apply(this,arguments)}function Ob(){return Ob=(0,Je.Z)(function*(o,n,i){if(o.bu.set("Online"),n instanceof Xu&&2===n.state&&n.cause)try{yield(a=(0,Je.Z)(function*(h,_){const x=_.cause;for(const S of _.targetIds)h.Au.has(S)&&(yield h.remoteSyncer.rejectListen(S,x),h.Au.delete(S),h.Vu.removeTarget(S))}),function(h,_){return a.apply(this,arguments)})(o,n)}catch(a){ze("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),a),yield Tb(o,a)}else if(n instanceof pc?o.Vu.Ht(n):n instanceof hl?o.Vu.ne(n):o.Vu.Xt(n),!i.isEqual(Rn.min()))try{const a=yield IC(o.localStore);i.compareTo(a)>=0&&(yield function(h,_){const x=h.Vu.ce(_);return x.targetChanges.forEach((S,L)=>{if(S.resumeToken.approximateByteSize()>0){const B=h.Au.get(L);B&&h.Au.set(L,B.withResumeToken(S.resumeToken,_))}}),x.targetMismatches.forEach((S,L)=>{const B=h.Au.get(S);if(!B)return;h.Au.set(S,B.withResumeToken(ys.EMPTY_BYTE_STRING,B.snapshotVersion)),LC(h,S);const H=new Cf(B.target,S,L,B.sequenceNumber);Pb(h,H)}),h.remoteSyncer.applyRemoteEvent(x)}(o,i))}catch(a){ze("RemoteStore","Failed to raise snapshot:",a),yield Tb(o,a)}var a}),Ob.apply(this,arguments)}function Tb(o,n,i){return _m.apply(this,arguments)}function _m(){return _m=(0,Je.Z)(function*(o,n,i){if(!Ap(n))throw n;o.vu.add(1),yield py(o),o.bu.set("Offline"),i||(i=()=>IC(o.localStore)),o.asyncQueue.enqueueRetryable((0,Je.Z)(function*(){ze("RemoteStore","Retrying IndexedDB access"),yield i(),o.vu.delete(1),yield Wp(o)}))}),_m.apply(this,arguments)}function _1(o,n){return n().catch(i=>Tb(o,i,n))}function my(o){return y1.apply(this,arguments)}function y1(){return y1=(0,Je.Z)(function*(o){const n=_n(o),i=yc(n);let a=n.Eu.length>0?n.Eu[n.Eu.length-1].batchId:-1;for(;Ib(n);)try{const h=yield yb(n.localStore,a);if(null===h){0===n.Eu.length&&i.jo();break}a=h.batchId,v1(n,h)}catch(h){yield Tb(n,h)}ym(n)&&b1(n)}),y1.apply(this,arguments)}function Ib(o){return rd(o)&&o.Eu.length<10}function v1(o,n){o.Eu.push(n);const i=yc(o);i.Ko()&&i.ou&&i.uu(n.mutations)}function ym(o){return rd(o)&&!yc(o).Uo()&&o.Eu.length>0}function b1(o){yc(o).start()}function x1(o){return _y.apply(this,arguments)}function _y(){return _y=(0,Je.Z)(function*(o){yc(o).hu()}),_y.apply(this,arguments)}function BE(o){return w1.apply(this,arguments)}function w1(){return w1=(0,Je.Z)(function*(o){const n=yc(o);for(const i of o.Eu)n.uu(i.mutations)}),w1.apply(this,arguments)}function UE(o,n,i){return C1.apply(this,arguments)}function C1(){return C1=(0,Je.Z)(function*(o,n,i){const a=o.Eu.shift(),h=ey.from(a,n,i);yield _1(o,()=>o.remoteSyncer.applySuccessfulWrite(h)),yield my(o)}),C1.apply(this,arguments)}function VE(o,n){return Sb.apply(this,arguments)}function Sb(){return Sb=(0,Je.Z)(function*(o,n){var i;n&&yc(o).ou&&(yield(i=(0,Je.Z)(function*(a,h){if(function Wv(o){switch(o){default:return wn();case Jt.CANCELLED:case Jt.UNKNOWN:case Jt.DEADLINE_EXCEEDED:case Jt.RESOURCE_EXHAUSTED:case Jt.INTERNAL:case Jt.UNAVAILABLE:case Jt.UNAUTHENTICATED:return!1;case Jt.INVALID_ARGUMENT:case Jt.NOT_FOUND:case Jt.ALREADY_EXISTS:case Jt.PERMISSION_DENIED:case Jt.FAILED_PRECONDITION:case Jt.ABORTED:case Jt.OUT_OF_RANGE:case Jt.UNIMPLEMENTED:case Jt.DATA_LOSS:return!0}}(_=h.code)&&_!==Jt.ABORTED){const x=a.Eu.shift();yc(a).Qo(),yield _1(a,()=>a.remoteSyncer.rejectFailedWrite(x.batchId,h)),yield my(a)}var _}),function(a,h){return i.apply(this,arguments)})(o,n)),ym(o)&&b1(o)}),Sb.apply(this,arguments)}function FC(o,n){return M1.apply(this,arguments)}function M1(){return M1=(0,Je.Z)(function*(o,n){const i=_n(o);i.asyncQueue.verifyOperationInProgress(),ze("RemoteStore","RemoteStore received new credentials");const a=rd(i);i.vu.add(3),yield py(i),a&&i.bu.set("Unknown"),yield i.remoteSyncer.handleCredentialChange(n),i.vu.delete(3),yield Wp(i)}),M1.apply(this,arguments)}function zC(){return zC=(0,Je.Z)(function*(o,n){const i=_n(o);n?(i.vu.delete(2),yield Wp(i)):n||(i.vu.add(2),yield py(i),i.bu.set("Unknown"))}),zC.apply(this,arguments)}function Yp(o){return o.Su||(o.Su=function(n,i,a){const h=_n(n);return h.fu(),new Qc(i,h.connection,h.authCredentials,h.appCheckCredentials,h.serializer,a)}(o.datastore,o.asyncQueue,{uo:Kp.bind(null,o),ao:ZT.bind(null,o),nu:NC.bind(null,o)}),o.Ru.push(function(){var n=(0,Je.Z)(function*(i){i?(o.Su.Qo(),nd(o)?g1(o):o.bu.set("Unknown")):(yield o.Su.stop(),m1(o))});return function(i){return n.apply(this,arguments)}}())),o.Su}function yc(o){return o.Du||(o.Du=function(n,i,a){const h=_n(n);return h.fu(),new LE(i,h.connection,h.authCredentials,h.appCheckCredentials,h.serializer,a)}(o.datastore,o.asyncQueue,{uo:x1.bind(null,o),ao:VE.bind(null,o),au:BE.bind(null,o),cu:UE.bind(null,o)}),o.Ru.push(function(){var n=(0,Je.Z)(function*(i){i?(o.Du.Qo(),yield my(o)):(yield o.Du.stop(),o.Eu.length>0&&(ze("RemoteStore",`Stopping write stream with ${o.Eu.length} pending writes`),o.Eu=[]))});return function(i){return n.apply(this,arguments)}}())),o.Du}class Xp{constructor(n,i,a,h,_){this.asyncQueue=n,this.timerId=i,this.targetTimeMs=a,this.op=h,this.removalCallback=_,this.deferred=new Ss,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(x=>{})}static createAndSchedule(n,i,a,h,_){const x=Date.now()+a,S=new Xp(n,i,x,h,_);return S.start(a),S}start(n){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),n)}skipDelay(){return this.handleDelayElapsed()}cancel(n){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Se(Jt.CANCELLED,"Operation cancelled"+(n?": "+n:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(n=>this.deferred.resolve(n))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function dh(o,n){if(rs("AsyncQueue",`${n}: ${o}`),Ap(o))return new Se(Jt.UNAVAILABLE,`${n}: ${o}`);throw o}class Sf{constructor(n){this.comparator=n?(i,a)=>n(i,a)||hn.comparator(i.key,a.key):(i,a)=>hn.comparator(i.key,a.key),this.keyedMap=tm(),this.sortedSet=new lo(this.comparator)}static emptySet(n){return new Sf(n.comparator)}has(n){return null!=this.keyedMap.get(n)}get(n){return this.keyedMap.get(n)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(n){const i=this.keyedMap.get(n);return i?this.sortedSet.indexOf(i):-1}get size(){return this.sortedSet.size}forEach(n){this.sortedSet.inorderTraversal((i,a)=>(n(i),!1))}add(n){const i=this.delete(n.key);return i.copy(i.keyedMap.insert(n.key,n),i.sortedSet.insert(n,null))}delete(n){const i=this.get(n);return i?this.copy(this.keyedMap.remove(n),this.sortedSet.remove(i)):this}isEqual(n){if(!(n instanceof Sf)||this.size!==n.size)return!1;const i=this.sortedSet.getIterator(),a=n.sortedSet.getIterator();for(;i.hasNext();){const h=i.getNext().key,_=a.getNext().key;if(!h.isEqual(_))return!1}return!0}toString(){const n=[];return this.forEach(i=>{n.push(i.toString())}),0===n.length?"DocumentSet ()":"DocumentSet (\n  "+n.join("  \n")+"\n)"}copy(n,i){const a=new Sf;return a.comparator=this.comparator,a.keyedMap=n,a.sortedSet=i,a}}class E1{constructor(){this.Cu=new lo(hn.comparator)}track(n){const i=n.doc.key,a=this.Cu.get(i);a?0!==n.type&&3===a.type?this.Cu=this.Cu.insert(i,n):3===n.type&&1!==a.type?this.Cu=this.Cu.insert(i,{type:a.type,doc:n.doc}):2===n.type&&2===a.type?this.Cu=this.Cu.insert(i,{type:2,doc:n.doc}):2===n.type&&0===a.type?this.Cu=this.Cu.insert(i,{type:0,doc:n.doc}):1===n.type&&0===a.type?this.Cu=this.Cu.remove(i):1===n.type&&2===a.type?this.Cu=this.Cu.insert(i,{type:1,doc:a.doc}):0===n.type&&1===a.type?this.Cu=this.Cu.insert(i,{type:2,doc:n.doc}):wn():this.Cu=this.Cu.insert(i,n)}xu(){const n=[];return this.Cu.inorderTraversal((i,a)=>{n.push(a)}),n}}class Fa{constructor(n,i,a,h,_,x,S,L,B){this.query=n,this.docs=i,this.oldDocs=a,this.docChanges=h,this.mutatedKeys=_,this.fromCache=x,this.syncStateChanged=S,this.excludesMetadataChanges=L,this.hasCachedResults=B}static fromInitialDocuments(n,i,a,h,_){const x=[];return i.forEach(S=>{x.push({type:0,doc:S})}),new Fa(n,i,Sf.emptySet(i),x,a,h,!0,!1,_)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(n){if(!(this.fromCache===n.fromCache&&this.hasCachedResults===n.hasCachedResults&&this.syncStateChanged===n.syncStateChanged&&this.mutatedKeys.isEqual(n.mutatedKeys)&&zp(this.query,n.query)&&this.docs.isEqual(n.docs)&&this.oldDocs.isEqual(n.oldDocs)))return!1;const i=this.docChanges,a=n.docChanges;if(i.length!==a.length)return!1;for(let h=0;h<i.length;h++)if(i[h].type!==a[h].type||!i[h].doc.isEqual(a[h].doc))return!1;return!0}}class BC{constructor(){this.Nu=void 0,this.listeners=[]}}class jE{constructor(){this.queries=new vf(n=>Bp(n),zp),this.onlineState="Unknown",this.ku=new Set}}function Db(){return Db=(0,Je.Z)(function*(o,n){const i=_n(o),a=n.query;let h=!1,_=i.queries.get(a);if(_||(h=!0,_=new BC),h)try{_.Nu=yield i.onListen(a)}catch(x){const S=dh(x,`Initialization of query '${Vv(n.query)}' failed`);return void n.onError(S)}i.queries.set(a,_),_.listeners.push(n),n.Mu(i.onlineState),_.Nu&&n.$u(_.Nu)&&yy(i)}),Db.apply(this,arguments)}function O1(){return O1=(0,Je.Z)(function*(o,n){const i=_n(o),a=n.query;let h=!1;const _=i.queries.get(a);if(_){const x=_.listeners.indexOf(n);x>=0&&(_.listeners.splice(x,1),h=0===_.listeners.length)}if(h)return i.queries.delete(a),i.onUnlisten(a)}),O1.apply(this,arguments)}function T1(o,n){const i=_n(o);let a=!1;for(const h of n){const x=i.queries.get(h.query);if(x){for(const S of x.listeners)S.$u(h)&&(a=!0);x.Nu=h}}a&&yy(i)}function UC(o,n,i){const a=_n(o),h=a.queries.get(n);if(h)for(const _ of h.listeners)_.onError(i);a.queries.delete(n)}function yy(o){o.ku.forEach(n=>{n.next()})}class I1{constructor(n,i,a){this.query=n,this.Ou=i,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=a||{}}$u(n){if(!this.options.includeMetadataChanges){const a=[];for(const h of n.docChanges)3!==h.type&&a.push(h);n=new Fa(n.query,n.docs,n.oldDocs,a,n.mutatedKeys,n.fromCache,n.syncStateChanged,!0,n.hasCachedResults)}let i=!1;return this.Fu?this.Lu(n)&&(this.Ou.next(n),i=!0):this.qu(n,this.onlineState)&&(this.Uu(n),i=!0),this.Bu=n,i}onError(n){this.Ou.error(n)}Mu(n){this.onlineState=n;let i=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,n)&&(this.Uu(this.Bu),i=!0),i}qu(n,i){return!n.fromCache||(!this.options.Ku||!("Offline"!==i))&&(!n.docs.isEmpty()||n.hasCachedResults||"Offline"===i)}Lu(n){return n.docChanges.length>0||!!(n.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==n.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(n){n=Fa.fromInitialDocuments(n.query,n.docs,n.mutatedKeys,n.fromCache,n.hasCachedResults),this.Fu=!0,this.Ou.next(n)}}class jC{constructor(n){this.key=n}}class GE{constructor(n){this.key=n}}class $C{constructor(n,i){this.query=n,this.Yu=i,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Hr(),this.mutatedKeys=Hr(),this.tc=nE(n),this.ec=new Sf(this.tc)}get nc(){return this.Yu}sc(n,i){const a=i?i.ic:new E1,h=i?i.ec:this.ec;let _=i?i.mutatedKeys:this.mutatedKeys,x=h,S=!1;const L="F"===this.query.limitType&&h.size===this.query.limit?h.last():null,B="L"===this.query.limitType&&h.size===this.query.limit?h.first():null;if(n.inorderTraversal((H,Y)=>{const pt=h.get(H),xt=Zc(this.query,Y)?Y:null,At=!!pt&&this.mutatedKeys.has(pt.key),Ut=!!xt&&(xt.hasLocalMutations||this.mutatedKeys.has(xt.key)&&xt.hasCommittedMutations);let Zt=!1;pt&&xt?pt.data.isEqual(xt.data)?At!==Ut&&(a.track({type:3,doc:xt}),Zt=!0):this.rc(pt,xt)||(a.track({type:2,doc:xt}),Zt=!0,(L&&this.tc(xt,L)>0||B&&this.tc(xt,B)<0)&&(S=!0)):!pt&&xt?(a.track({type:0,doc:xt}),Zt=!0):pt&&!xt&&(a.track({type:1,doc:pt}),Zt=!0,(L||B)&&(S=!0)),Zt&&(xt?(x=x.add(xt),_=Ut?_.add(H):_.delete(H)):(x=x.delete(H),_=_.delete(H)))}),null!==this.query.limit)for(;x.size>this.query.limit;){const H="F"===this.query.limitType?x.last():x.first();x=x.delete(H.key),_=_.delete(H.key),a.track({type:1,doc:H})}return{ec:x,ic:a,zi:S,mutatedKeys:_}}rc(n,i){return n.hasLocalMutations&&i.hasCommittedMutations&&!i.hasLocalMutations}applyChanges(n,i,a){const h=this.ec;this.ec=n.ec,this.mutatedKeys=n.mutatedKeys;const _=n.ic.xu();_.sort((B,H)=>function(Y,pt){const xt=At=>{switch(At){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wn()}};return xt(Y)-xt(pt)}(B.type,H.type)||this.tc(B.doc,H.doc)),this.oc(a);const x=i?this.uc():[],S=0===this.Zu.size&&this.current?1:0,L=S!==this.Xu;return this.Xu=S,0!==_.length||L?{snapshot:new Fa(this.query,n.ec,h,_,n.mutatedKeys,0===S,L,!1,!!a&&a.resumeToken.approximateByteSize()>0),cc:x}:{cc:x}}Mu(n){return this.current&&"Offline"===n?(this.current=!1,this.applyChanges({ec:this.ec,ic:new E1,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(n){return!this.Yu.has(n)&&!!this.ec.has(n)&&!this.ec.get(n).hasLocalMutations}oc(n){n&&(n.addedDocuments.forEach(i=>this.Yu=this.Yu.add(i)),n.modifiedDocuments.forEach(i=>{}),n.removedDocuments.forEach(i=>this.Yu=this.Yu.delete(i)),this.current=n.current)}uc(){if(!this.current)return[];const n=this.Zu;this.Zu=Hr(),this.ec.forEach(a=>{this.ac(a.key)&&(this.Zu=this.Zu.add(a.key))});const i=[];return n.forEach(a=>{this.Zu.has(a)||i.push(new GE(a))}),this.Zu.forEach(a=>{n.has(a)||i.push(new jC(a))}),i}hc(n){this.Yu=n.ir,this.Zu=Hr();const i=this.sc(n.documents);return this.applyChanges(i,!0)}lc(){return Fa.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class HE{constructor(n,i,a){this.query=n,this.targetId=i,this.view=a}}class qE{constructor(n){this.key=n,this.fc=!1}}class Jc{constructor(n,i,a,h,_,x){this.localStore=n,this.remoteStore=i,this.eventManager=a,this.sharedClientState=h,this.currentUser=_,this.maxConcurrentLimboResolutions=x,this.dc={},this.wc=new vf(S=>Bp(S),zp),this._c=new Map,this.mc=new Set,this.gc=new lo(hn.comparator),this.yc=new Map,this.Ic=new e1,this.Tc={},this.Ec=new Map,this.Ac=_c.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function vm(o,n){return kb.apply(this,arguments)}function kb(){return kb=(0,Je.Z)(function*(o,n){const i=function z1(o){const n=_n(o);return n.remoteStore.remoteSyncer.applyRemoteEvent=KE.bind(null,n),n.remoteStore.remoteSyncer.getRemoteKeysForTarget=eO.bind(null,n),n.remoteStore.remoteSyncer.rejectListen=YE.bind(null,n),n.dc.nu=T1.bind(null,n.eventManager),n.dc.Pc=UC.bind(null,n.eventManager),n}(o);let a,h;const _=i.wc.get(n);if(_)a=_.targetId,i.sharedClientState.addLocalQueryTarget(a),h=_.view.lc();else{const x=yield function uy(o,n){const i=_n(o);return i.persistence.runTransaction("Allocate target","readwrite",a=>{let h;return i.Bs.getTargetData(a,n).next(_=>_?(h=_,qt.resolve(h)):i.Bs.allocateTargetId(a).next(x=>(h=new Cf(n,x,"TargetPurposeListen",a.currentSequenceNumber),i.Bs.addTargetData(a,h).next(()=>h))))}).then(a=>{const h=i.Ji.get(a.targetId);return(null===h||a.snapshotVersion.compareTo(h.snapshotVersion)>0)&&(i.Ji=i.Ji.insert(a.targetId,a),i.Yi.set(n,a.targetId)),a})}(i.localStore,To(n)),S=i.sharedClientState.addLocalQueryTarget(x.targetId);a=x.targetId,h=yield function S1(o,n,i,a,h){return ZE.apply(this,arguments)}(i,n,a,"current"===S,x.resumeToken),i.isPrimaryClient&&mm(i.remoteStore,x)}return h}),kb.apply(this,arguments)}function ZE(){return ZE=(0,Je.Z)(function*(o,n,i,a,h){o.Rc=(Y,pt,xt)=>{return(At=(0,Je.Z)(function*(Ut,Zt,qe,fn){let $e=Zt.view.sc(qe);$e.zi&&($e=yield vb(Ut.localStore,Zt.query,!1).then(({documents:Cr})=>Zt.view.sc(Cr,$e)));const cn=fn&&fn.targetChanges.get(Zt.targetId),Mr=Zt.view.applyChanges($e,Ut.isPrimaryClient,cn);return qC(Ut,Zt.targetId,Mr.cc),Mr.snapshot}),function(Ut,Zt,qe,fn){return At.apply(this,arguments)})(o,Y,pt,xt);var At};const _=yield vb(o.localStore,n,!0),x=new $C(n,_.ir),S=x.sc(_.documents),L=bi.createSynthesizedTargetChangeForCurrentChange(i,a&&"Offline"!==o.onlineState,h),B=x.applyChanges(S,o.isPrimaryClient,L);qC(o,i,B.cc);const H=new HE(n,i,x);return o.wc.set(n,H),o._c.has(i)?o._c.get(i).push(n):o._c.set(i,[n]),B.snapshot}),ZE.apply(this,arguments)}function YT(o,n){return WE.apply(this,arguments)}function WE(){return WE=(0,Je.Z)(function*(o,n){const i=_n(o),a=i.wc.get(n),h=i._c.get(a.targetId);if(h.length>1)return i._c.set(a.targetId,h.filter(_=>!zp(_,n))),void i.wc.delete(n);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||(yield pm(i.localStore,a.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(a.targetId),gy(i.remoteStore,a.targetId),hh(i,a.targetId)}).catch(hf))):(hh(i,a.targetId),yield pm(i.localStore,a.targetId,!0))}),WE.apply(this,arguments)}function GC(){return GC=(0,Je.Z)(function*(o,n,i){const a=function XC(o){const n=_n(o);return n.remoteStore.remoteSyncer.applySuccessfulWrite=XE.bind(null,n),n.remoteStore.remoteSyncer.rejectFailedWrite=XT.bind(null,n),n}(o);try{const h=yield function(_,x){const S=_n(_),L=An.now(),B=x.reduce((pt,xt)=>pt.add(xt.key),Hr());let H,Y;return S.persistence.runTransaction("Locally write mutations","readwrite",pt=>{let xt=Us(),At=Hr();return S.Zi.getEntries(pt,B).next(Ut=>{xt=Ut,xt.forEach((Zt,qe)=>{qe.isValidDocument()||(At=At.add(Zt))})}).next(()=>S.localDocuments.getOverlayedDocuments(pt,xt)).next(Ut=>{H=Ut;const Zt=[];for(const qe of x){const fn=oE(qe,H.get(qe.key).overlayedDocument);null!=fn&&Zt.push(new Dl(qe.key,fn,ST(fn.value.mapValue),to.exists(!0)))}return S.mutationQueue.addMutationBatch(pt,L,Zt,x)}).next(Ut=>{Y=Ut;const Zt=Ut.applyToLocalDocumentSet(H,At);return S.documentOverlayCache.saveOverlays(pt,Ut.batchId,Zt)})}).then(()=>({batchId:Y.batchId,changes:em(H)}))}(a.localStore,n);a.sharedClientState.addPendingMutation(h.batchId),function(_,x,S){let L=_.Tc[_.currentUser.toKey()];L||(L=new lo(Br)),L=L.insert(x,S),_.Tc[_.currentUser.toKey()]=L}(a,h.batchId,i),yield kl(a,h.changes),yield my(a.remoteStore)}catch(h){const _=dh(h,"Failed to persist write");i.reject(_)}}),GC.apply(this,arguments)}function KE(o,n){return Rb.apply(this,arguments)}function Rb(){return Rb=(0,Je.Z)(function*(o,n){const i=_n(o);try{const a=yield function TE(o,n){const i=_n(o),a=n.snapshotVersion;let h=i.Ji;return i.persistence.runTransaction("Apply remote event","readwrite-primary",_=>{const x=i.Zi.newChangeBuffer({trackRemovals:!0});h=i.Ji;const S=[];n.targetChanges.forEach((H,Y)=>{const pt=h.get(Y);if(!pt)return;S.push(i.Bs.removeMatchingKeys(_,H.removedDocuments,Y).next(()=>i.Bs.addMatchingKeys(_,H.addedDocuments,Y)));let xt=pt.withSequenceNumber(_.currentSequenceNumber);var At,Ut,Zt;null!==n.targetMismatches.get(Y)?xt=xt.withResumeToken(ys.EMPTY_BYTE_STRING,Rn.min()).withLastLimboFreeSnapshotVersion(Rn.min()):H.resumeToken.approximateByteSize()>0&&(xt=xt.withResumeToken(H.resumeToken,a)),h=h.insert(Y,xt),Ut=xt,Zt=H,(0===(At=pt).resumeToken.approximateByteSize()||Ut.snapshotVersion.toMicroseconds()-At.snapshotVersion.toMicroseconds()>=3e8||Zt.addedDocuments.size+Zt.modifiedDocuments.size+Zt.removedDocuments.size>0)&&S.push(i.Bs.updateTargetData(_,xt))});let L=Us(),B=Hr();if(n.documentUpdates.forEach(H=>{n.resolvedLimboDocuments.has(H)&&S.push(i.persistence.referenceDelegate.updateLimboDocument(_,H))}),S.push(function o1(o,n,i){let a=Hr(),h=Hr();return i.forEach(_=>a=a.add(_)),n.getEntries(o,a).next(_=>{let x=Us();return i.forEach((S,L)=>{const B=_.get(S);L.isFoundDocument()!==B.isFoundDocument()&&(h=h.add(S)),L.isNoDocument()&&L.version.isEqual(Rn.min())?(n.removeEntry(S,L.readTime),x=x.insert(S,L)):!B.isValidDocument()||L.version.compareTo(B.version)>0||0===L.version.compareTo(B.version)&&B.hasPendingWrites?(n.addEntry(L),x=x.insert(S,L)):ze("LocalStore","Ignoring outdated watch update for ",S,". Current version:",B.version," Watch version:",L.version)}),{nr:x,sr:h}})}(_,x,n.documentUpdates).next(H=>{L=H.nr,B=H.sr})),!a.isEqual(Rn.min())){const H=i.Bs.getLastRemoteSnapshotVersion(_).next(Y=>i.Bs.setTargetsMetadata(_,_.currentSequenceNumber,a));S.push(H)}return qt.waitFor(S).next(()=>x.apply(_)).next(()=>i.localDocuments.getLocalViewOfDocuments(_,L,B)).next(()=>L)}).then(_=>(i.Ji=h,_))}(i.localStore,n);n.targetChanges.forEach((h,_)=>{const x=i.yc.get(_);x&&($n(h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size<=1),h.addedDocuments.size>0?x.fc=!0:h.modifiedDocuments.size>0?$n(x.fc):h.removedDocuments.size>0&&($n(x.fc),x.fc=!1))}),yield kl(i,a,n)}catch(a){yield hf(a)}}),Rb.apply(this,arguments)}function xm(o,n,i){const a=_n(o);if(a.isPrimaryClient&&0===i||!a.isPrimaryClient&&1===i){const h=[];a.wc.forEach((_,x)=>{const S=x.view.Mu(n);S.snapshot&&h.push(S.snapshot)}),function(_,x){const S=_n(_);S.onlineState=x;let L=!1;S.queries.forEach((B,H)=>{for(const Y of H.listeners)Y.Mu(x)&&(L=!0)}),L&&yy(S)}(a.eventManager,n),h.length&&a.dc.nu(h),a.onlineState=n,a.isPrimaryClient&&a.sharedClientState.setOnlineState(n)}}function YE(o,n,i){return HC.apply(this,arguments)}function HC(){return HC=(0,Je.Z)(function*(o,n,i){const a=_n(o);a.sharedClientState.updateQueryState(n,"rejected",i);const h=a.yc.get(n),_=h&&h.key;if(_){let x=new lo(hn.comparator);x=x.insert(_,ao.newNoDocument(_,Rn.min()));const S=Hr().add(_),L=new Vp(Rn.min(),new Map,new lo(Br),x,S);yield KE(a,L),a.gc=a.gc.remove(_),a.yc.delete(n),Cm(a)}else yield pm(a.localStore,n,!1).then(()=>hh(a,n,i)).catch(hf)}),HC.apply(this,arguments)}function XE(o,n){return wm.apply(this,arguments)}function wm(){return wm=(0,Je.Z)(function*(o,n){const i=_n(o),a=n.batch.batchId;try{const h=yield function _b(o,n){const i=_n(o);return i.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const h=n.batch.keys(),_=i.Zi.newChangeBuffer({trackRemovals:!0});return function(x,S,L,B){const H=L.batch,Y=H.keys();let pt=qt.resolve();return Y.forEach(xt=>{pt=pt.next(()=>B.getEntry(S,xt)).next(At=>{const Ut=L.docVersions.get(xt);$n(null!==Ut),At.version.compareTo(Ut)<0&&(H.applyToRemoteDocument(At,L),At.isValidDocument()&&(At.setReadTime(L.commitVersion),B.addEntry(At)))})}),pt.next(()=>x.mutationQueue.removeMutationBatch(S,H))}(i,a,n,_).next(()=>_.apply(a)).next(()=>i.mutationQueue.performConsistencyCheck(a)).next(()=>i.documentOverlayCache.removeOverlaysForBatchId(a,h,n.batch.batchId)).next(()=>i.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,function(x){let S=Hr();for(let L=0;L<x.mutationResults.length;++L)x.mutationResults[L].transformResults.length>0&&(S=S.add(x.batch.mutations[L].key));return S}(n))).next(()=>i.localDocuments.getDocuments(a,h))})}(i.localStore,n);Lb(i,a,null),Vr(i,a),i.sharedClientState.updateMutationState(a,"acknowledged"),yield kl(i,h)}catch(h){yield hf(h)}}),wm.apply(this,arguments)}function XT(o,n,i){return A1.apply(this,arguments)}function A1(){return A1=(0,Je.Z)(function*(o,n,i){const a=_n(o);try{const h=yield function(_,x){const S=_n(_);return S.persistence.runTransaction("Reject batch","readwrite-primary",L=>{let B;return S.mutationQueue.lookupMutationBatch(L,x).next(H=>($n(null!==H),B=H.keys(),S.mutationQueue.removeMutationBatch(L,H))).next(()=>S.mutationQueue.performConsistencyCheck(L)).next(()=>S.documentOverlayCache.removeOverlaysForBatchId(L,B,x)).next(()=>S.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(L,B)).next(()=>S.localDocuments.getDocuments(L,B))})}(a.localStore,n);Lb(a,n,i),Vr(a,n),a.sharedClientState.updateMutationState(n,"rejected",i),yield kl(a,h)}catch(h){yield hf(h)}}),A1.apply(this,arguments)}function Vr(o,n){(o.Ec.get(n)||[]).forEach(i=>{i.resolve()}),o.Ec.delete(n)}function Lb(o,n,i){const a=_n(o);let h=a.Tc[a.currentUser.toKey()];if(h){const _=h.get(n);_&&(i?_.reject(i):_.resolve(),h=h.remove(n)),a.Tc[a.currentUser.toKey()]=h}}function hh(o,n,i=null){o.sharedClientState.removeLocalQueryTarget(n);for(const a of o._c.get(n))o.wc.delete(a),i&&o.dc.Pc(a,i);o._c.delete(n),o.isPrimaryClient&&o.Ic.Is(n).forEach(a=>{o.Ic.containsKey(a)||JE(o,a)})}function JE(o,n){o.mc.delete(n.path.canonicalString());const i=o.gc.get(n);null!==i&&(gy(o.remoteStore,i),o.gc=o.gc.remove(n),o.yc.delete(i),Cm(o))}function qC(o,n,i){for(const a of i)a instanceof jC?(o.Ic.addReference(a.key,n),Nb(o,a)):a instanceof GE?(ze("SyncEngine","Document no longer in limbo: "+a.key),o.Ic.removeReference(a.key,n),o.Ic.containsKey(a.key)||JE(o,a.key)):wn()}function Nb(o,n){const i=n.key,a=i.path.canonicalString();o.gc.get(i)||o.mc.has(a)||(ze("SyncEngine","New document in limbo: "+i),o.mc.add(a),Cm(o))}function Cm(o){for(;o.mc.size>0&&o.gc.size<o.maxConcurrentLimboResolutions;){const n=o.mc.values().next().value;o.mc.delete(n);const i=new hn(oi.fromString(n)),a=o.Ac.next();o.yc.set(a,new qE(i)),o.gc=o.gc.insert(i,a),mm(o.remoteStore,new Cf(To(Bs(i.path)),a,"TargetPurposeLimboResolution",cc.ct))}}function kl(o,n,i){return k1.apply(this,arguments)}function k1(){return k1=(0,Je.Z)(function*(o,n,i){const a=_n(o),h=[],_=[],x=[];var S;a.wc.isEmpty()||(a.wc.forEach((S,L)=>{x.push(a.Rc(L,n,i).then(B=>{if((B||i)&&a.isPrimaryClient&&a.sharedClientState.updateQueryState(L.targetId,B?.fromCache?"not-current":"current"),B){h.push(B);const H=TC.Li(L.targetId,B);_.push(H)}}))}),yield Promise.all(x),a.dc.nu(h),yield(S=(0,Je.Z)(function*(L,B){const H=_n(L);try{yield H.persistence.runTransaction("notifyLocalViewChanges","readwrite",Y=>qt.forEach(B,pt=>qt.forEach(pt.Fi,xt=>H.persistence.referenceDelegate.addReference(Y,pt.targetId,xt)).next(()=>qt.forEach(pt.Bi,xt=>H.persistence.referenceDelegate.removeReference(Y,pt.targetId,xt)))))}catch(Y){if(!Ap(Y))throw Y;ze("LocalStore","Failed to update sequence numbers: "+Y)}for(const Y of B){const pt=Y.targetId;if(!Y.fromCache){const xt=H.Ji.get(pt),Ut=xt.withLastLimboFreeSnapshotVersion(xt.snapshotVersion);H.Ji=H.Ji.insert(pt,Ut)}}}),function(L,B){return S.apply(this,arguments)})(a.localStore,_))}),k1.apply(this,arguments)}function tO(o,n){return vc.apply(this,arguments)}function vc(){return vc=(0,Je.Z)(function*(o,n){const i=_n(o);if(!i.currentUser.isEqual(n)){ze("SyncEngine","User change. New user:",n.toKey());const a=yield i1(i.localStore,n);i.currentUser=n,(h=i).Ec.forEach(x=>{x.forEach(S=>{S.reject(new Se(Jt.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),h.Ec.clear(),i.sharedClientState.handleUserChange(n,a.removedBatchIds,a.addedBatchIds),yield kl(i,a.er)}var h}),vc.apply(this,arguments)}function eO(o,n){const i=_n(o),a=i.yc.get(n);if(a&&a.fc)return Hr().add(a.key);{let h=Hr();const _=i._c.get(n);if(!_)return h;for(const x of _){const S=i.wc.get(x);h=h.unionWith(S.view.nc)}return h}}class zb{constructor(){this.synchronizeTabs=!1}initialize(n){var i=this;return(0,Je.Z)(function*(){i.serializer=wb(n.databaseInfo.databaseId),i.sharedClientState=i.createSharedClientState(n),i.persistence=i.createPersistence(n),yield i.persistence.start(),i.localStore=i.createLocalStore(n),i.gcScheduler=i.createGarbageCollectionScheduler(n,i.localStore),i.indexBackfillerScheduler=i.createIndexBackfillerScheduler(n,i.localStore)})()}createGarbageCollectionScheduler(n,i){return null}createIndexBackfillerScheduler(n,i){return null}createLocalStore(n){return function mb(o,n,i,a){return new If(o,n,i,a)}(this.persistence,new OE,n.initialUser,this.serializer)}createPersistence(n){return new uh(db.zs,this.serializer)}createSharedClientState(n){return new f1}terminate(){var n=this;return(0,Je.Z)(function*(){n.gcScheduler&&n.gcScheduler.stop(),yield n.sharedClientState.shutdown(),yield n.persistence.shutdown()})()}}class As{initialize(n,i){var a=this;return(0,Je.Z)(function*(){a.localStore||(a.localStore=n.localStore,a.sharedClientState=n.sharedClientState,a.datastore=a.createDatastore(i),a.remoteStore=a.createRemoteStore(i),a.eventManager=a.createEventManager(i),a.syncEngine=a.createSyncEngine(i,!n.synchronizeTabs),a.sharedClientState.onlineStateHandler=h=>xm(a.syncEngine,h,1),a.remoteStore.remoteSyncer.handleCredentialChange=tO.bind(null,a.syncEngine),yield function P1(o,n){return zC.apply(this,arguments)}(a.remoteStore,a.syncEngine.isPrimaryClient))})()}createEventManager(n){return new jE}createDatastore(n){const i=wb(n.databaseInfo.databaseId),a=new kE(n.databaseInfo);return new NE(n.authCredentials,n.appCheckCredentials,a,i)}createRemoteStore(n){return i=this.localStore,a=this.datastore,h=n.asyncQueue,_=S=>xm(this.syncEngine,S,0),x=AE.D()?new AE:new GT,new qT(i,a,h,_,x);var i,a,h,_,x}createSyncEngine(n,i){return function(a,h,_,x,S,L,B){const H=new Jc(a,h,_,x,S,L);return B&&(H.vc=!0),H}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,n.initialUser,n.maxConcurrentLimboResolutions,i)}terminate(){return(n=(0,Je.Z)(function*(i){const a=_n(i);ze("RemoteStore","RemoteStore shutting down."),a.vu.add(5),yield py(a),a.Pu.shutdown(),a.bu.set("Unknown")}),function(i){return n.apply(this,arguments)})(this.remoteStore);var n}}class Pm{constructor(n){this.observer=n,this.muted=!1}next(n){this.observer.next&&this.Sc(this.observer.next,n)}error(n){this.observer.error?this.Sc(this.observer.error,n):rs("Uncaught Error in snapshot listener:",n.toString())}Dc(){this.muted=!0}Sc(n,i){this.muted||setTimeout(()=>{this.muted||n(i)},0)}}class U1{constructor(n,i,a,h){var _=this;this.authCredentials=n,this.appCheckCredentials=i,this.asyncQueue=a,this.databaseInfo=h,this.user=so.UNAUTHENTICATED,this.clientId=Gw.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(a,function(){var x=(0,Je.Z)(function*(S){ze("FirestoreClient","Received user=",S.uid),yield _.authCredentialListener(S),_.user=S});return function(S){return x.apply(this,arguments)}}()),this.appCheckCredentials.start(a,x=>(ze("FirestoreClient","Received new app check token=",x),this.appCheckCredentialListener(x,this.user)))}getConfiguration(){var n=this;return(0,Je.Z)(function*(){return{asyncQueue:n.asyncQueue,databaseInfo:n.databaseInfo,clientId:n.clientId,authCredentials:n.authCredentials,appCheckCredentials:n.appCheckCredentials,initialUser:n.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(n){this.authCredentialListener=n}setAppCheckTokenChangeListener(n){this.appCheckCredentialListener=n}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Se(Jt.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var n=this;this.asyncQueue.enterRestrictedMode();const i=new Ss;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Je.Z)(function*(){try{n._onlineComponents&&(yield n._onlineComponents.terminate()),n._offlineComponents&&(yield n._offlineComponents.terminate()),n.authCredentials.shutdown(),n.appCheckCredentials.shutdown(),i.resolve()}catch(a){const h=dh(a,"Failed to shutdown persistence");i.reject(h)}})),i.promise}}function Em(o,n){return V1.apply(this,arguments)}function V1(){return V1=(0,Je.Z)(function*(o,n){o.asyncQueue.verifyOperationInProgress(),ze("FirestoreClient","Initializing OfflineComponentProvider");const i=yield o.getConfiguration();yield n.initialize(i);let a=i.initialUser;o.setCredentialChangeListener(function(){var h=(0,Je.Z)(function*(_){a.isEqual(_)||(yield i1(n.localStore,_),a=_)});return function(_){return h.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(()=>o.terminate()),o._offlineComponents=n}),V1.apply(this,arguments)}function aO(o,n){return lO.apply(this,arguments)}function lO(){return lO=(0,Je.Z)(function*(o,n){o.asyncQueue.verifyOperationInProgress();const i=yield function tM(o){return My.apply(this,arguments)}(o);ze("FirestoreClient","Initializing OnlineComponentProvider");const a=yield o.getConfiguration();yield n.initialize(i,a),o.setCredentialChangeListener(h=>FC(n.remoteStore,h)),o.setAppCheckTokenChangeListener((h,_)=>FC(n.remoteStore,_)),o._onlineComponents=n}),lO.apply(this,arguments)}function My(){return My=(0,Je.Z)(function*(o){if(!o._offlineComponents)if(o._uninitializedComponentsProvider){ze("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Em(o,o._uninitializedComponentsProvider._offline)}catch(n){const i=n;if(!function Cy(o){return"FirebaseError"===o.name?o.code===Jt.FAILED_PRECONDITION||o.code===Jt.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||22===o.code||20===o.code||11===o.code}(i))throw i;lc("Error using user provided cache. Falling back to memory cache: "+i),yield Em(o,new zb)}}else ze("FirestoreClient","Using default OfflineComponentProvider"),yield Em(o,new zb);return o._offlineComponents}),My.apply(this,arguments)}function Bb(o){return Ub.apply(this,arguments)}function Ub(){return Ub=(0,Je.Z)(function*(o){return o._onlineComponents||(o._uninitializedComponentsProvider?(ze("FirestoreClient","Using user provided OnlineComponentProvider"),yield aO(o,o._uninitializedComponentsProvider._online)):(ze("FirestoreClient","Using default OnlineComponentProvider"),yield aO(o,new As))),o._onlineComponents}),Ub.apply(this,arguments)}function Om(o){return Df.apply(this,arguments)}function Df(){return Df=(0,Je.Z)(function*(o){const n=yield Bb(o),i=n.eventManager;return i.onListen=vm.bind(null,n.syncEngine),i.onUnlisten=YT.bind(null,n.syncEngine),i}),Df.apply(this,arguments)}function uO(o){const n={};return void 0!==o.timeoutSeconds&&(n.timeoutSeconds=o.timeoutSeconds),n}const dO=new Map;function $1(o,n,i){if(!i)throw new Se(Jt.INVALID_ARGUMENT,`Function ${o}() cannot be called with an empty ${n}.`)}function Tm(o){if(!hn.isDocumentKey(o))throw new Se(Jt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${o} has ${o.length}.`)}function G1(o){if(hn.isDocumentKey(o))throw new Se(Jt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${o} has ${o.length}.`)}function fh(o){if(void 0===o)return"undefined";if(null===o)return"null";if("string"==typeof o)return o.length>20&&(o=`${o.substring(0,20)}...`),JSON.stringify(o);if("number"==typeof o||"boolean"==typeof o)return""+o;if("object"==typeof o){if(o instanceof Array)return"an array";{const n=(i=o).constructor?i.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var i;return"function"==typeof o?"a function":wn()}function xi(o,n){if("_delegate"in o&&(o=o._delegate),!(o instanceof n)){if(n.name===o.constructor.name)throw new Se(Jt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const i=fh(o);throw new Se(Jt.INVALID_ARGUMENT,`Expected type '${n.name}', but it was: ${i}`)}}return o}class sM{constructor(n){var i,a;if(void 0===n.host){if(void 0!==n.ssl)throw new Se(Jt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=n.host,this.ssl=null===(i=n.ssl)||void 0===i||i;if(this.credentials=n.credentials,this.ignoreUndefinedProperties=!!n.ignoreUndefinedProperties,this.cache=n.localCache,void 0===n.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==n.cacheSizeBytes&&n.cacheSizeBytes<1048576)throw new Se(Jt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=n.cacheSizeBytes}(function hO(o,n,i,a){if(!0===n&&!0===a)throw new Se(Jt.INVALID_ARGUMENT,`${o} and ${i} cannot be used together.`)})("experimentalForceLongPolling",n.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",n.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!n.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==n.experimentalAutoDetectLongPolling&&!n.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=uO(null!==(a=n.experimentalLongPollingOptions)&&void 0!==a?a:{}),function(h){if(void 0!==h.timeoutSeconds){if(isNaN(h.timeoutSeconds))throw new Se(Jt.INVALID_ARGUMENT,`invalid long polling timeout: ${h.timeoutSeconds} (must not be NaN)`);if(h.timeoutSeconds<5)throw new Se(Jt.INVALID_ARGUMENT,`invalid long polling timeout: ${h.timeoutSeconds} (minimum allowed value is 5)`);if(h.timeoutSeconds>30)throw new Se(Jt.INVALID_ARGUMENT,`invalid long polling timeout: ${h.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!n.useFetchStreams}isEqual(n){return this.host===n.host&&this.ssl===n.ssl&&this.credentials===n.credentials&&this.cacheSizeBytes===n.cacheSizeBytes&&this.experimentalForceLongPolling===n.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===n.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===n.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===n.ignoreUndefinedProperties&&this.useFetchStreams===n.useFetchStreams}}class Im{constructor(n,i,a,h){this._authCredentials=n,this._appCheckCredentials=i,this._databaseId=a,this._app=h,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sM({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Se(Jt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(n){if(this._settingsFrozen)throw new Se(Jt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sM(n),void 0!==n.credentials&&(this._authCredentials=function(i){if(!i)return new UP;switch(i.type){case"firstParty":return new VP(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Se(Jt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(n.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=dO.get(n);i&&(ze("ComponentProvider","Removing Datastore"),dO.delete(n),i.terminate())}(this),Promise.resolve()}}class as{constructor(n,i,a){this.converter=i,this._key=a,this.type="document",this.firestore=n}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tu(this.firestore,this.converter,this._key.path.popLast())}withConverter(n){return new as(this.firestore,n,this._key)}}class va{constructor(n,i,a){this.converter=i,this._query=a,this.type="query",this.firestore=n}withConverter(n){return new va(this.firestore,n,this._query)}}class tu extends va{constructor(n,i,a){super(n,i,Bs(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const n=this._path.popLast();return n.isEmpty()?null:new as(this.firestore,null,new hn(n))}withConverter(n){return new tu(this.firestore,n,this._path)}}function pO(o,n,...i){if(o=(0,$r.m9)(o),$1("collection","path",n),o instanceof Im){const a=oi.fromString(n,...i);return G1(a),new tu(o,null,a)}{if(!(o instanceof as||o instanceof tu))throw new Se(Jt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=o._path.child(oi.fromString(n,...i));return G1(a),new tu(o.firestore,null,a)}}function aM(o,n,...i){if(o=(0,$r.m9)(o),1===arguments.length&&(n=Gw.A()),$1("doc","path",n),o instanceof Im){const a=oi.fromString(n,...i);return Tm(a),new as(o,null,new hn(a))}{if(!(o instanceof as||o instanceof tu))throw new Se(Jt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=o._path.child(oi.fromString(n,...i));return Tm(a),new as(o.firestore,o instanceof tu?o.converter:null,new hn(a))}}class rI{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new DC(this,"async_queue_retry"),this.Xc=()=>{const i=p1();i&&ze("AsyncQueue","Visibility state changed to "+i.visibilityState),this.qo.Mo()};const n=p1();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(n){this.enqueue(n)}enqueueAndForgetEvenWhileRestricted(n){this.Zc(),this.ta(n)}enterRestrictedMode(n){if(!this.jc){this.jc=!0,this.Jc=n||!1;const i=p1();i&&"function"==typeof i.removeEventListener&&i.removeEventListener("visibilitychange",this.Xc)}}enqueue(n){if(this.Zc(),this.jc)return new Promise(()=>{});const i=new Ss;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(n().then(i.resolve,i.reject),i.promise)).then(()=>i.promise)}enqueueRetryable(n){this.enqueueAndForget(()=>(this.Qc.push(n),this.ea()))}ea(){var n=this;return(0,Je.Z)(function*(){if(0!==n.Qc.length){try{yield n.Qc[0](),n.Qc.shift(),n.qo.reset()}catch(i){if(!Ap(i))throw i;ze("AsyncQueue","Operation failed with retryable error: "+i)}n.Qc.length>0&&n.qo.No(()=>n.ea())}})()}ta(n){const i=this.Gc.then(()=>(this.Hc=!0,n().catch(a=>{throw this.Wc=a,this.Hc=!1,rs("INTERNAL UNHANDLED ERROR: ",function(_){let x=_.message||"";return _.stack&&(x=_.stack.includes(_.message)?_.stack:_.message+"\n"+_.stack),x}(a)),a}).then(a=>(this.Hc=!1,a))));return this.Gc=i,i}enqueueAfterDelay(n,i,a){this.Zc(),this.Yc.indexOf(n)>-1&&(i=0);const h=Xp.createAndSchedule(this,n,i,a,_=>this.na(_));return this.zc.push(h),h}Zc(){this.Wc&&wn()}verifyOperationInProgress(){}sa(){var n=this;return(0,Je.Z)(function*(){let i;do{i=n.Gc,yield i}while(i!==n.Gc)})()}ia(n){for(const i of this.zc)if(i.timerId===n)return!0;return!1}ra(n){return this.sa().then(()=>{this.zc.sort((i,a)=>i.targetTimeMs-a.targetTimeMs);for(const i of this.zc)if(i.skipDelay(),"all"!==n&&i.timerId===n)break;return this.sa()})}oa(n){this.Yc.push(n)}na(n){const i=this.zc.indexOf(n);this.zc.splice(i,1)}}function q1(o){return function(n,i){if("object"!=typeof n||null===n)return!1;const a=n;for(const h of["next","error","complete"])if(h in a&&"function"==typeof a[h])return!0;return!1}(o)}class jo extends Im{constructor(n,i,a,h){super(n,i,a,h),this.type="firestore",this._queue=new rI,this._persistenceKey=h?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||sI(this),this._firestoreClient.terminate()}}function oI(o,n){const i="object"==typeof o?o:(0,ts.getApp)(),a="string"==typeof o?o:n||"(default)",h=(0,ts._getProvider)(i,"firestore").getImmediate({identifier:a});if(!h._initialized){const _=(0,$r.P0)("firestore");_&&function fO(o,n,i,a={}){var h;const _=(o=xi(o,Im))._getSettings(),x=`${n}:${i}`;if("firestore.googleapis.com"!==_.host&&_.host!==x&&lc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),o._setSettings(Object.assign(Object.assign({},_),{host:x,ssl:!1})),a.mockUserToken){let S,L;if("string"==typeof a.mockUserToken)S=a.mockUserToken,L=so.MOCK_USER;else{S=(0,$r.Sg)(a.mockUserToken,null===(h=o._app)||void 0===h?void 0:h.options.projectId);const B=a.mockUserToken.sub||a.mockUserToken.user_id;if(!B)throw new Se(Jt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");L=new so(B)}o._authCredentials=new cf(new gx(S,L))}}(h,..._)}return h}function Vs(o){return o._firestoreClient||sI(o),o._firestoreClient.verifyNotTerminated(),o._firestoreClient}function sI(o){var n,i,a;const h=o._freezeSettings(),_=(S=(null===(n=o._app)||void 0===n?void 0:n.options.appId)||"",new KP(o._databaseId,S,o._persistenceKey,(B=h).host,B.ssl,B.experimentalForceLongPolling,B.experimentalAutoDetectLongPolling,uO(B.experimentalLongPollingOptions),B.useFetchStreams));var S,B;o._firestoreClient=new U1(o._authCredentials,o._appCheckCredentials,o._queue,_),null!==(i=h.cache)&&void 0!==i&&i._offlineComponentProvider&&null!==(a=h.cache)&&void 0!==a&&a._onlineComponentProvider&&(o._firestoreClient._uninitializedComponentsProvider={_offlineKind:h.cache.kind,_offline:h.cache._offlineComponentProvider,_online:h.cache._onlineComponentProvider})}class Sm{constructor(n){this._byteString=n}static fromBase64String(n){try{return new Sm(ys.fromBase64String(n))}catch(i){throw new Se(Jt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+i)}}static fromUint8Array(n){return new Sm(ys.fromUint8Array(n))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(n){return this._byteString.isEqual(n._byteString)}}class js{constructor(...n){for(let i=0;i<n.length;++i)if(0===n[i].length)throw new Se(Jt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _s(n)}isEqual(n){return this._internalPath.isEqual(n._internalPath)}}class hM{constructor(n){this._methodName=n}}class Jp{constructor(n,i){if(!isFinite(n)||n<-90||n>90)throw new Se(Jt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+n);if(!isFinite(i)||i<-180||i>180)throw new Se(Jt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+i);this._lat=n,this._long=i}get latitude(){return this._lat}get longitude(){return this._long}isEqual(n){return this._lat===n._lat&&this._long===n._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(n){return Br(this._lat,n._lat)||Br(this._long,n._long)}}const Z1=/^__.*__$/;class W1{constructor(n,i,a){this.data=n,this.fieldMask=i,this.fieldTransforms=a}toMutation(n,i){return null!==this.fieldMask?new Dl(n,this.data,this.fieldMask,i,this.fieldTransforms):new rm(n,this.data,i,this.fieldTransforms)}}function pM(o){switch(o){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wn()}}class K1{constructor(n,i,a,h,_,x){this.settings=n,this.databaseId=i,this.serializer=a,this.ignoreUndefinedProperties=h,void 0===_&&this.ua(),this.fieldTransforms=_||[],this.fieldMask=x||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(n){return new K1(Object.assign(Object.assign({},this.settings),n),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(n){var i;const a=null===(i=this.path)||void 0===i?void 0:i.child(n),h=this.aa({path:a,la:!1});return h.fa(n),h}da(n){var i;const a=null===(i=this.path)||void 0===i?void 0:i.child(n),h=this.aa({path:a,la:!1});return h.ua(),h}wa(n){return this.aa({path:void 0,la:!0})}_a(n){return Dy(n,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(n){return void 0!==this.fieldMask.find(i=>n.isPrefixOf(i))||void 0!==this.fieldTransforms.find(i=>n.isPrefixOf(i.field))}ua(){if(this.path)for(let n=0;n<this.path.length;n++)this.fa(this.path.get(n))}fa(n){if(0===n.length)throw this._a("Document fields must not be empty");if(pM(this.ca)&&Z1.test(n))throw this._a('Document fields cannot begin and end with "__"')}}class cI{constructor(n,i,a){this.databaseId=n,this.ignoreUndefinedProperties=i,this.serializer=a||wb(n)}ya(n,i,a,h=!1){return new K1({ca:n,methodName:i,ga:a,path:_s.emptyPath(),la:!1,ma:h},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ty(o){const n=o._freezeSettings(),i=wb(o._databaseId);return new cI(o._databaseId,!!n.ignoreUndefinedProperties,i)}function Iy(o,n,i,a,h,_={}){const x=o.ya(_.merge||_.mergeFields?2:0,n,i,h);$b("Data must be an object, but it was:",x,a);const S=bO(a,x);let L,B;if(_.merge)L=new cl(x.fieldMask),B=x.fieldTransforms;else if(_.mergeFields){const H=[];for(const Y of _.mergeFields){const pt=Gb(n,Y,i);if(!x.contains(pt))throw new Se(Jt.INVALID_ARGUMENT,`Field '${pt}' is specified in your field mask but missing from your input data.`);xO(H,pt)||H.push(pt)}L=new cl(H),B=x.fieldTransforms.filter(Y=>L.covers(Y.field))}else L=null,B=x.fieldTransforms;return new W1(new co(S),L,B)}function Dm(o,n){if(mM(o=(0,$r.m9)(o)))return $b("Unsupported field value:",n,o),bO(o,n);if(o instanceof hM)return function(i,a){if(!pM(a.ca))throw a._a(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a._a(`${i._methodName}() is not currently supported inside arrays`);const h=i._toFieldTransform(a);h&&a.fieldTransforms.push(h)}(o,n),null;if(void 0===o&&n.ignoreUndefinedProperties)return null;if(n.path&&n.fieldMask.push(n.path),o instanceof Array){if(n.settings.la&&4!==n.ca)throw n._a("Nested arrays are not supported");return function(i,a){const h=[];let _=0;for(const x of i){let S=Dm(x,a.wa(_));null==S&&(S={nullValue:"NULL_VALUE"}),h.push(S),_++}return{arrayValue:{values:h}}}(o,n)}return function(i,a){if(null===(i=(0,$r.m9)(i)))return{nullValue:"NULL_VALUE"};if("number"==typeof i)return Lx(a.serializer,i);if("boolean"==typeof i)return{booleanValue:i};if("string"==typeof i)return{stringValue:i};if(i instanceof Date){const h=An.fromDate(i);return{timestampValue:om(a.serializer,h)}}if(i instanceof An){const h=new An(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:om(a.serializer,h)}}if(i instanceof Jp)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Sm)return{bytesValue:cE(a.serializer,i._byteString)};if(i instanceof as){const h=a.databaseId,_=i.firestore._databaseId;if(!_.isEqual(h))throw a._a(`Document reference is for database ${_.projectId}/${_.database} but should be for database ${h.projectId}/${h.database}`);return{referenceValue:Hx(i.firestore._databaseId||a.databaseId,i._key.path)}}throw a._a(`Unsupported field value: ${fh(i)}`)}(o,n)}function bO(o,n){const i={};return U_(o)?n.path&&n.path.length>0&&n.fieldMask.push(n.path):qu(o,(a,h)=>{const _=Dm(h,n.ha(a));null!=_&&(i[a]=_)}),{mapValue:{fields:i}}}function mM(o){return!("object"!=typeof o||null===o||o instanceof Array||o instanceof Date||o instanceof An||o instanceof Jp||o instanceof Sm||o instanceof as||o instanceof hM)}function $b(o,n,i){if(!mM(i)||"object"!=typeof(a=i)||null===a||Object.getPrototypeOf(a)!==Object.prototype&&null!==Object.getPrototypeOf(a)){const a=fh(i);throw n._a("an object"===a?o+" a custom object":o+" "+a)}var a}function Gb(o,n,i){if((n=(0,$r.m9)(n))instanceof js)return n._internalPath;if("string"==typeof n)return Hb(o,n);throw Dy("Field path arguments must be of type string or ",o,!1,void 0,i)}const hI=new RegExp("[~\\*/\\[\\]]");function Hb(o,n,i){if(n.search(hI)>=0)throw Dy(`Invalid field path (${n}). Paths must not contain '~', '*', '/', '[', or ']'`,o,!1,void 0,i);try{return new js(...n.split("."))._internalPath}catch{throw Dy(`Invalid field path (${n}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,o,!1,void 0,i)}}function Dy(o,n,i,a,h){const _=a&&!a.isEmpty(),x=void 0!==h;let S=`Function ${n}() called with invalid data`;i&&(S+=" (via `toFirestore()`)"),S+=". ";let L="";return(_||x)&&(L+=" (found",_&&(L+=` in field ${a}`),x&&(L+=` in document ${h}`),L+=")"),new Se(Jt.INVALID_ARGUMENT,S+o+L)}function xO(o,n){return o.some(i=>i.isEqual(n))}class $s{constructor(n,i,a,h,_){this._firestore=n,this._userDataWriter=i,this._key=a,this._document=h,this._converter=_}get id(){return this._key.path.lastSegment()}get ref(){return new as(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const n=new wO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(n)}return this._userDataWriter.convertValue(this._document.data.value)}}get(n){if(this._document){const i=this._document.data.field(qb("DocumentSnapshot.get",n));if(null!==i)return this._userDataWriter.convertValue(i)}}}class wO extends $s{data(){return super.data()}}function qb(o,n){return"string"==typeof n?Hb(o,n):n instanceof js?n._internalPath:n._delegate._internalPath}class IO{convertValue(n,i="none"){switch(kp(n)){case 0:return null;case 1:return n.booleanValue;case 2:return Vo(n.integerValue||n.doubleValue);case 3:return this.convertTimestamp(n.timestampValue);case 4:return this.convertServerTimestamp(n,i);case 5:return n.stringValue;case 6:return this.convertBytes(Zu(n.bytesValue));case 7:return this.convertReference(n.referenceValue);case 8:return this.convertGeoPoint(n.geoPointValue);case 9:return this.convertArray(n.arrayValue,i);case 10:return this.convertObject(n.mapValue,i);default:throw wn()}}convertObject(n,i){return this.convertObjectMap(n.fields,i)}convertObjectMap(n,i="none"){const a={};return qu(n,(h,_)=>{a[h]=this.convertValue(_,i)}),a}convertGeoPoint(n){return new Jp(Vo(n.latitude),Vo(n.longitude))}convertArray(n,i){return(n.values||[]).map(a=>this.convertValue(a,i))}convertServerTimestamp(n,i){switch(i){case"previous":const a=Lv(n);return null==a?null:this.convertValue(a,i);case"estimate":return this.convertTimestamp(qd(n));default:return null}}convertTimestamp(n){const i=pf(n);return new An(i.seconds,i.nanos)}convertDocumentKey(n,i){const a=oi.fromString(n);$n(gE(a));const h=new Al(a.get(1),a.get(3)),_=new hn(a.popFirst(5));return h.isEqual(i)||rs(`Document ${_} contains a document reference within a different database (${h.projectId}/${h.database}) which is not supported. It will be treated as a reference in the current database (${i.projectId}/${i.database}) instead.`),_}}class eg{constructor(n,i){this.hasPendingWrites=n,this.fromCache=i}isEqual(n){return this.hasPendingWrites===n.hasPendingWrites&&this.fromCache===n.fromCache}}class km extends $s{constructor(n,i,a,h,_,x){super(n,i,a,h,x),this._firestore=n,this._firestoreImpl=n,this.metadata=_}exists(){return super.exists()}data(n={}){if(this._document){if(this._converter){const i=new Xb(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(i,n)}return this._userDataWriter.convertValue(this._document.data.value,n.serverTimestamps)}}get(n,i={}){if(this._document){const a=this._document.data.field(qb("DocumentSnapshot.get",n));if(null!==a)return this._userDataWriter.convertValue(a,i.serverTimestamps)}}}class Xb extends km{data(n={}){return super.data(n)}}class Qb{constructor(n,i,a,h){this._firestore=n,this._userDataWriter=i,this._snapshot=h,this.metadata=new eg(h.hasPendingWrites,h.fromCache),this.query=a}get docs(){const n=[];return this.forEach(i=>n.push(i)),n}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(n,i){this._snapshot.docs.forEach(a=>{n.call(i,new Xb(this._firestore,this._userDataWriter,a.key,a,new eg(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(n={}){const i=!!n.includeMetadataChanges;if(i&&this._snapshot.excludesMetadataChanges)throw new Se(Jt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===i||(this._cachedChanges=function(a,h){if(a._snapshot.oldDocs.isEmpty()){let _=0;return a._snapshot.docChanges.map(x=>({type:"added",doc:new Xb(a._firestore,a._userDataWriter,x.doc.key,x.doc,new eg(a._snapshot.mutatedKeys.has(x.doc.key),a._snapshot.fromCache),a.query.converter),oldIndex:-1,newIndex:_++}))}{let _=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(x=>h||3!==x.type).map(x=>{const S=new Xb(a._firestore,a._userDataWriter,x.doc.key,x.doc,new eg(a._snapshot.mutatedKeys.has(x.doc.key),a._snapshot.fromCache),a.query.converter);let L=-1,B=-1;return 0!==x.type&&(L=_.indexOf(x.doc.key),_=_.delete(x.doc.key)),1!==x.type&&(_=_.add(x.doc),B=_.indexOf(x.doc.key)),{type:ph(x.type),doc:S,oldIndex:L,newIndex:B}})}}(this,i),this._cachedChangesIncludeMetadataChanges=i),this._cachedChanges}}function ph(o){switch(o){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wn()}}class Nf extends IO{constructor(n){super(),this.firestore=n}convertBytes(n){return new Sm(n)}convertReference(n){const i=this.convertDocumentKey(n,this.firestore._databaseId);return new as(this.firestore,null,i)}}function J1(o){return Ry(xi(o.firestore,jo),[new Jd(o._key,to.none())])}function za(o,n){const i=xi(o.firestore,jo),a=aM(o),h=function id(o,n,i){let a;return a=o?i&&(i.merge||i.mergeFields)?o.toFirestore(n,i):o.toFirestore(n):n,a}(o.converter,n);return Ry(i,[Iy(Ty(o.firestore),"addDoc",a._key,h,null!==o.converter,{}).toMutation(a._key,to.exists(!1))]).then(()=>a)}function tw(o,...n){var i,a,h;o=(0,$r.m9)(o);let _={includeMetadataChanges:!1},x=0;"object"!=typeof n[x]||q1(n[x])||(_=n[x],x++);const S={includeMetadataChanges:_.includeMetadataChanges};if(q1(n[x])){const Y=n[x];n[x]=null===(i=Y.next)||void 0===i?void 0:i.bind(Y),n[x+1]=null===(a=Y.error)||void 0===a?void 0:a.bind(Y),n[x+2]=null===(h=Y.complete)||void 0===h?void 0:h.bind(Y)}let L,B,H;if(o instanceof as)B=xi(o.firestore,jo),H=Bs(o._key.path),L={next:Y=>{n[x]&&n[x](function Ff(o,n,i){const a=i.docs.get(n._key),h=new Nf(o);return new km(o,h,n._key,a,new eg(i.hasPendingWrites,i.fromCache),n.converter)}(B,o,Y))},error:n[x+1],complete:n[x+2]};else{const Y=xi(o,va);B=xi(Y.firestore,jo),H=Y._query;const pt=new Nf(B);L={next:xt=>{n[x]&&n[x](new Qb(B,pt,Y,xt))},error:n[x+1],complete:n[x+2]},function kf(o){if("L"===o.limitType&&0===o.explicitOrderBy.length)throw new Se(Jt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(o._query)}return function(Y,pt,xt,At){const Ut=new Pm(At),Zt=new I1(pt,Ut,xt);return Y.asyncQueue.enqueueAndForget((0,Je.Z)(function*(){return function Ab(o,n){return Db.apply(this,arguments)}(yield Om(Y),Zt)})),()=>{Ut.Dc(),Y.asyncQueue.enqueueAndForget((0,Je.Z)(function*(){return function Af(o,n){return O1.apply(this,arguments)}(yield Om(Y),Zt)}))}}(Vs(B),H,S,L)}function Ry(o,n){return function(i,a){const h=new Ss;return i.asyncQueue.enqueueAndForget((0,Je.Z)(function*(){return function bm(o,n,i){return GC.apply(this,arguments)}(yield function Py(o){return Bb(o).then(n=>n.syncEngine)}(i),a,h)})),h.promise}(Vs(o),n)}!function(o,n=!0){_a=ts.SDK_VERSION,(0,ts._registerComponent)(new Pa.wA("firestore",(i,{instanceIdentifier:a,options:h})=>{const _=i.getProvider("app").getImmediate(),x=new jo(new Uo(i.getProvider("auth-internal")),new jw(i.getProvider("app-check-internal")),function(S,L){if(!Object.prototype.hasOwnProperty.apply(S.options,["projectId"]))throw new Se(Jt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Al(S.options.projectId,L)}(_,a),_);return h=Object.assign({useFetchStreams:n},h),x._setSettings(h),x},"PUBLIC").setMultipleInstances(!0)),(0,ts.registerVersion)(wv,"3.13.0",o),(0,ts.registerVersion)(wv,"3.13.0","esm2017")}();class IM{constructor(n){return n}}const CI="firestore",AM=new M.OlP("angularfire2.firestore-instances");function n0(o){return(n,i)=>{const a=n.runOutsideAngular(()=>o(i));return new IM(a)}}const LO={provide:class MI{constructor(){return(0,Wr.vb)(CI)}},deps:[[new M.FiY,AM]]},NO={provide:IM,useFactory:function PI(o,n){const i=(0,Wr.JM)(CI,o,n);return i&&new IM(i)},deps:[[new M.FiY,AM],Ns]};let FO=(()=>{class o{constructor(){(0,da.KN)("angularfire",Wr.q4.full,"fst")}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=M.oAB({type:o}),o.\u0275inj=M.cJS({providers:[NO,LO]}),o})();function DM(o,...n){return{ngModule:FO,providers:[{provide:AM,useFactory:n0(o),multi:!0,deps:[M.R0b,M.zs3,Wr.HU,Cu,[new M.FiY,g0],[new M.FiY,sn],...n]}]}}const zO=(0,Wr.u3)(za,!0),II=(0,Wr.u3)(pO,!0),FM=(0,Wr.u3)(J1,!0),r=(0,Wr.u3)(aM,!0),l=(0,Wr.u3)(oI,!0),T=(0,Wr.u3)(tw,!0);var Nt=ft(2459),$t=ft(5592);const{isArray:Rt}=Array,{getPrototypeOf:ie,prototype:Ee,keys:Oe}=Object;function Be(o){if(1===o.length){const n=o[0];if(Rt(n))return{args:n,keys:null};if(function je(o){return o&&"object"==typeof o&&ie(o)===Ee}(n)){const i=Oe(n);return{args:i.map(a=>n[a]),keys:i}}}return{args:o,keys:null}}var En=ft(4829),Qe=ft(4564),nr=ft(8251),ln=ft(7398);const{isArray:Ln}=Array;function mn(o){return(0,ln.U)(n=>function On(o,n){return Ln(n)?o(...n):o(n)}(o,n))}function wr(o,n){return o.reduce((i,a,h)=>(i[a]=n[h],i),{})}let rr=(()=>{class o{constructor(i,a){this._renderer=i,this._elementRef=a,this.onChange=h=>{},this.onTouched=()=>{}}setProperty(i,a){this._renderer.setProperty(this._elementRef.nativeElement,i,a)}registerOnTouched(i){this.onTouched=i}registerOnChange(i){this.onChange=i}setDisabledState(i){this.setProperty("disabled",i)}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(M.Qsj),M.Y36(M.SBq))};static#e=this.\u0275dir=M.lG2({type:o})}return o})(),Kr=(()=>{class o extends rr{static#t=this.\u0275fac=function(){let i;return function(h){return(i||(i=M.n5z(o)))(h||o)}}();static#e=this.\u0275dir=M.lG2({type:o,features:[M.qOj]})}return o})();const Si=new M.OlP("NgValueAccessor"),$o={provide:Si,useExisting:(0,M.Gpc)(()=>Gr),multi:!0},Gi=new M.OlP("CompositionEventMode");let Gr=(()=>{class o extends rr{constructor(i,a,h){super(i,a),this._compositionMode=h,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Io(){const o=It()?It().getUserAgent():"";return/android (\d+)/.test(o.toLowerCase())}())}writeValue(i){this.setProperty("value",i??"")}_handleInput(i){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(i)}_compositionStart(){this._composing=!0}_compositionEnd(i){this._composing=!1,this._compositionMode&&this.onChange(i)}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(M.Qsj),M.Y36(M.SBq),M.Y36(Gi,8))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(a,h){1&a&&M.NdJ("input",function(x){return h._handleInput(x.target.value)})("blur",function(){return h.onTouched()})("compositionstart",function(){return h._compositionStart()})("compositionend",function(x){return h._compositionEnd(x.target.value)})},features:[M._Bn([$o]),M.qOj]})}return o})();function So(o){return null==o||("string"==typeof o||Array.isArray(o))&&0===o.length}function zf(o){return null!=o&&"number"==typeof o.length}const ls=new M.OlP("NgValidators"),Rl=new M.OlP("NgAsyncValidators"),zM=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class BM{static min(n){return function UM(o){return n=>{if(So(n.value)||So(o))return null;const i=parseFloat(n.value);return!isNaN(i)&&i<o?{min:{min:o,actual:n.value}}:null}}(n)}static max(n){return function SI(o){return n=>{if(So(n.value)||So(o))return null;const i=parseFloat(n.value);return!isNaN(i)&&i>o?{max:{max:o,actual:n.value}}:null}}(n)}static required(n){return AI(n)}static requiredTrue(n){return function DI(o){return!0===o.value?null:{required:!0}}(n)}static email(n){return function kI(o){return So(o.value)||zM.test(o.value)?null:{email:!0}}(n)}static minLength(n){return function RI(o){return n=>So(n.value)||!zf(n.value)?null:n.value.length<o?{minlength:{requiredLength:o,actualLength:n.value.length}}:null}(n)}static maxLength(n){return function LI(o){return n=>zf(n.value)&&n.value.length>o?{maxlength:{requiredLength:o,actualLength:n.value.length}}:null}(n)}static pattern(n){return function NI(o){if(!o)return rw;let n,i;return"string"==typeof o?(i="","^"!==o.charAt(0)&&(i+="^"),i+=o,"$"!==o.charAt(o.length-1)&&(i+="$"),n=new RegExp(i)):(i=o.toString(),n=o),a=>{if(So(a.value))return null;const h=a.value;return n.test(h)?null:{pattern:{requiredPattern:i,actualValue:h}}}}(n)}static nullValidator(n){return null}static compose(n){return VO(n)}static composeAsync(n){return jO(n)}}function AI(o){return So(o.value)?{required:!0}:null}function rw(o){return null}function BO(o){return null!=o}function Bf(o){return(0,M.QGY)(o)?(0,Nt.D)(o):o}function FI(o){let n={};return o.forEach(i=>{n=null!=i?{...n,...i}:n}),0===Object.keys(n).length?null:n}function Ly(o,n){return n.map(i=>i(o))}function UO(o){return o.map(n=>function zI(o){return!o.validate}(n)?n:i=>n.validate(i))}function VO(o){if(!o)return null;const n=o.filter(BO);return 0==n.length?null:function(i){return FI(Ly(i,n))}}function ng(o){return null!=o?VO(UO(o)):null}function jO(o){if(!o)return null;const n=o.filter(BO);return 0==n.length?null:function(i){return function Lr(...o){const n=(0,Qe.jO)(o),{args:i,keys:a}=Be(o),h=new $t.y(_=>{const{length:x}=i;if(!x)return void _.complete();const S=new Array(x);let L=x,B=x;for(let H=0;H<x;H++){let Y=!1;(0,En.Xf)(i[H]).subscribe((0,nr.x)(_,pt=>{Y||(Y=!0,B--),S[H]=pt},()=>L--,void 0,()=>{(!L||!Y)&&(B||_.next(a?wr(a,S):S),_.complete())}))}});return n?h.pipe(mn(n)):h}(Ly(i,n).map(Bf)).pipe((0,ln.U)(FI))}}function BI(o){return null!=o?jO(UO(o)):null}function bc(o,n){return null===o?[n]:Array.isArray(o)?[...o,n]:[o,n]}function xc(o){return o._rawValidators}function r0(o){return o._rawAsyncValidators}function $O(o){return o?Array.isArray(o)?o:[o]:[]}function rg(o,n){return Array.isArray(o)?o.includes(n):o===n}function Q2(o,n){const i=$O(n);return $O(o).forEach(h=>{rg(i,h)||i.push(h)}),i}function J2(o,n){return $O(n).filter(i=>!rg(o,i))}class tk{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=ng(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=BI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,i){return!!this.control&&this.control.hasError(n,i)}getError(n,i){return this.control?this.control.getError(n,i):null}}class od extends tk{get formDirective(){return null}get path(){return null}}class iw extends tk{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class ek{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let GO=(()=>{class o extends ek{constructor(i){super(i)}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(iw,2))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(a,h){2&a&&M.ekj("ng-untouched",h.isUntouched)("ng-touched",h.isTouched)("ng-pristine",h.isPristine)("ng-dirty",h.isDirty)("ng-valid",h.isValid)("ng-invalid",h.isInvalid)("ng-pending",h.isPending)},features:[M.qOj]})}return o})(),_D=(()=>{class o extends ek{constructor(i){super(i)}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(od,10))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(a,h){2&a&&M.ekj("ng-untouched",h.isUntouched)("ng-touched",h.isTouched)("ng-pristine",h.isPristine)("ng-dirty",h.isDirty)("ng-valid",h.isValid)("ng-invalid",h.isInvalid)("ng-pending",h.isPending)("ng-submitted",h.isSubmitted)},features:[M.qOj]})}return o})();const UI="VALID",iA="INVALID",HO="PENDING",VI="DISABLED";function bD(o){return(oA(o)?o.validators:o)||null}function xD(o,n){return(oA(n)?n.asyncValidators:o)||null}function oA(o){return null!=o&&!Array.isArray(o)&&"object"==typeof o}function rk(o,n,i){const a=o.controls;if(!(n?Object.keys(a):a).length)throw new M.vHH(1e3,"");if(!a[i])throw new M.vHH(1001,"")}function ik(o,n,i){o._forEachChild((a,h)=>{if(void 0===i[h])throw new M.vHH(1002,"")})}class sA{constructor(n,i){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(i)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===UI}get invalid(){return this.status===iA}get pending(){return this.status==HO}get disabled(){return this.status===VI}get enabled(){return this.status!==VI}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(Q2(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(Q2(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(J2(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(J2(n,this._rawAsyncValidators))}hasValidator(n){return rg(this._rawValidators,n)}hasAsyncValidator(n){return rg(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(i=>{i.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=HO,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const i=this._parentMarkedDirty(n.onlySelf);this.status=VI,this.errors=null,this._forEachChild(a=>{a.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:i}),this._onDisabledChange.forEach(a=>a(!0))}enable(n={}){const i=this._parentMarkedDirty(n.onlySelf);this.status=UI,this._forEachChild(a=>{a.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:i}),this._onDisabledChange.forEach(a=>a(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===UI||this.status===HO)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(i=>i._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?VI:UI}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=HO,this._hasOwnPendingAsyncValidator=!0;const i=Bf(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(a=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(a,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,i={}){this.errors=n,this._updateControlsErrors(!1!==i.emitEvent)}get(n){let i=n;return null==i||(Array.isArray(i)||(i=i.split(".")),0===i.length)?null:i.reduce((a,h)=>a&&a._find(h),this)}getError(n,i){const a=i?this.get(i):this;return a&&a.errors?a.errors[n]:null}hasError(n,i){return!!this.getError(n,i)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new M.vpe,this.statusChanges=new M.vpe}_calculateStatus(){return this._allControlsDisabled()?VI:this.errors?iA:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(HO)?HO:this._anyControlsHaveStatus(iA)?iA:UI}_anyControlsHaveStatus(n){return this._anyControls(i=>i.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){oA(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function RN(o){return Array.isArray(o)?ng(o):o||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function LN(o){return Array.isArray(o)?BI(o):o||null}(this._rawAsyncValidators)}}class qO extends sA{constructor(n,i,a){super(bD(i),xD(a,i)),this.controls=n,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,i){return this.controls[n]?this.controls[n]:(this.controls[n]=i,i.setParent(this),i._registerOnCollectionChange(this._onCollectionChange),i)}addControl(n,i,a={}){this.registerControl(n,i),this.updateValueAndValidity({emitEvent:a.emitEvent}),this._onCollectionChange()}removeControl(n,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}setControl(n,i,a={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],i&&this.registerControl(n,i),this.updateValueAndValidity({emitEvent:a.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,i={}){ik(this,0,n),Object.keys(n).forEach(a=>{rk(this,!0,a),this.controls[a].setValue(n[a],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(n,i={}){null!=n&&(Object.keys(n).forEach(a=>{const h=this.controls[a];h&&h.patchValue(n[a],{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(n={},i={}){this._forEachChild((a,h)=>{a.reset(n?n[h]:null,{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this._reduceChildren({},(n,i,a)=>(n[a]=i.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(i,a)=>!!a._syncPendingControls()||i);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(i=>{const a=this.controls[i];a&&n(a,i)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[i,a]of Object.entries(this.controls))if(this.contains(i)&&n(a))return!0;return!1}_reduceValue(){return this._reduceChildren({},(i,a,h)=>((a.enabled||this.disabled)&&(i[h]=a.value),i))}_reduceChildren(n,i){let a=n;return this._forEachChild((h,_)=>{a=i(a,h,_)}),a}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}class ok extends qO{}const VM=new M.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>jI}),jI="always";function aA(o,n){return[...n.path,o]}function $I(o,n,i=jI){wD(o,n),n.valueAccessor.writeValue(o.value),(o.disabled||"always"===i)&&n.valueAccessor.setDisabledState?.(o.disabled),function FN(o,n){n.valueAccessor.registerOnChange(i=>{o._pendingValue=i,o._pendingChange=!0,o._pendingDirty=!0,"change"===o.updateOn&&sk(o,n)})}(o,n),function BN(o,n){const i=(a,h)=>{n.valueAccessor.writeValue(a),h&&n.viewToModelUpdate(a)};o.registerOnChange(i),n._registerOnDestroy(()=>{o._unregisterOnChange(i)})}(o,n),function zN(o,n){n.valueAccessor.registerOnTouched(()=>{o._pendingTouched=!0,"blur"===o.updateOn&&o._pendingChange&&sk(o,n),"submit"!==o.updateOn&&o.markAsTouched()})}(o,n),function NN(o,n){if(n.valueAccessor.setDisabledState){const i=a=>{n.valueAccessor.setDisabledState(a)};o.registerOnDisabledChange(i),n._registerOnDestroy(()=>{o._unregisterOnDisabledChange(i)})}}(o,n)}function lA(o,n,i=!0){const a=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(a),n.valueAccessor.registerOnTouched(a)),uA(o,n),o&&(n._invokeOnDestroyCallbacks(),o._registerOnCollectionChange(()=>{}))}function cA(o,n){o.forEach(i=>{i.registerOnValidatorChange&&i.registerOnValidatorChange(n)})}function wD(o,n){const i=xc(o);null!==n.validator?o.setValidators(bc(i,n.validator)):"function"==typeof i&&o.setValidators([i]);const a=r0(o);null!==n.asyncValidator?o.setAsyncValidators(bc(a,n.asyncValidator)):"function"==typeof a&&o.setAsyncValidators([a]);const h=()=>o.updateValueAndValidity();cA(n._rawValidators,h),cA(n._rawAsyncValidators,h)}function uA(o,n){let i=!1;if(null!==o){if(null!==n.validator){const h=xc(o);if(Array.isArray(h)&&h.length>0){const _=h.filter(x=>x!==n.validator);_.length!==h.length&&(i=!0,o.setValidators(_))}}if(null!==n.asyncValidator){const h=r0(o);if(Array.isArray(h)&&h.length>0){const _=h.filter(x=>x!==n.asyncValidator);_.length!==h.length&&(i=!0,o.setAsyncValidators(_))}}}const a=()=>{};return cA(n._rawValidators,a),cA(n._rawAsyncValidators,a),i}function sk(o,n){o._pendingDirty&&o.markAsDirty(),o.setValue(o._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(o._pendingValue),o._pendingChange=!1}function ak(o,n){wD(o,n)}function MD(o,n){if(!o.hasOwnProperty("model"))return!1;const i=o.model;return!!i.isFirstChange()||!Object.is(n,i.currentValue)}function lk(o,n){o._syncPendingControls(),n.forEach(i=>{const a=i.control;"submit"===a.updateOn&&a._pendingChange&&(i.viewToModelUpdate(a._pendingValue),a._pendingChange=!1)})}function PD(o,n){if(!n)return null;let i,a,h;return Array.isArray(n),n.forEach(_=>{_.constructor===Gr?i=_:function jN(o){return Object.getPrototypeOf(o.constructor)===Kr}(_)?a=_:h=_}),h||a||i||null}const GN={provide:od,useExisting:(0,M.Gpc)(()=>dA)},GI=(()=>Promise.resolve())();let dA=(()=>{class o extends od{constructor(i,a,h){super(),this.callSetDisabledState=h,this.submitted=!1,this._directives=new Set,this.ngSubmit=new M.vpe,this.form=new qO({},ng(i),BI(a))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(i){GI.then(()=>{const a=this._findContainer(i.path);i.control=a.registerControl(i.name,i.control),$I(i.control,i,this.callSetDisabledState),i.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(i)})}getControl(i){return this.form.get(i.path)}removeControl(i){GI.then(()=>{const a=this._findContainer(i.path);a&&a.removeControl(i.name),this._directives.delete(i)})}addFormGroup(i){GI.then(()=>{const a=this._findContainer(i.path),h=new qO({});ak(h,i),a.registerControl(i.name,h),h.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(i){GI.then(()=>{const a=this._findContainer(i.path);a&&a.removeControl(i.name)})}getFormGroup(i){return this.form.get(i.path)}updateModel(i,a){GI.then(()=>{this.form.get(i.path).setValue(a)})}setValue(i){this.control.setValue(i)}onSubmit(i){return this.submitted=!0,lk(this.form,this._directives),this.ngSubmit.emit(i),"dialog"===i?.target?.method}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(i){return i.pop(),i.length?this.form.get(i):this.form}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(ls,10),M.Y36(Rl,10),M.Y36(VM,8))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(a,h){1&a&&M.NdJ("submit",function(x){return h.onSubmit(x)})("reset",function(){return h.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[M._Bn([GN]),M.qOj]})}return o})();function ck(o,n){const i=o.indexOf(n);i>-1&&o.splice(i,1)}function uk(o){return"object"==typeof o&&null!==o&&2===Object.keys(o).length&&"value"in o&&"disabled"in o}const Rm=class extends sA{constructor(n=null,i,a){super(bD(i),xD(a,i)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(i),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),oA(i)&&(i.nonNullable||i.initialValueIsDefault)&&(this.defaultValue=uk(n)?n.value:n)}setValue(n,i={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==i.emitModelToViewChange&&this._onChange.forEach(a=>a(this.value,!1!==i.emitViewToModelChange)),this.updateValueAndValidity(i)}patchValue(n,i={}){this.setValue(n,i)}reset(n=this.defaultValue,i={}){this._applyFormState(n),this.markAsPristine(i),this.markAsUntouched(i),this.setValue(this.value,i),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){ck(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){ck(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){uk(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},ZN={provide:iw,useExisting:(0,M.Gpc)(()=>ZO)},fk=(()=>Promise.resolve())();let ZO=(()=>{class o extends iw{constructor(i,a,h,_,x,S){super(),this._changeDetectorRef=x,this.callSetDisabledState=S,this.control=new Rm,this._registered=!1,this.name="",this.update=new M.vpe,this._parent=i,this._setValidators(a),this._setAsyncValidators(h),this.valueAccessor=PD(0,_)}ngOnChanges(i){if(this._checkForErrors(),!this._registered||"name"in i){if(this._registered&&(this._checkName(),this.formDirective)){const a=i.name.previousValue;this.formDirective.removeControl({name:a,path:this._getPath(a)})}this._setUpControl()}"isDisabled"in i&&this._updateDisabled(i),MD(i,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){$I(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(i){fk.then(()=>{this.control.setValue(i,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(i){const a=i.isDisabled.currentValue,h=0!==a&&(0,M.VuI)(a);fk.then(()=>{h&&!this.control.disabled?this.control.disable():!h&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(i){return this._parent?aA(i,this._parent):[i]}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(od,9),M.Y36(ls,10),M.Y36(Rl,10),M.Y36(Si,10),M.Y36(M.sBO,8),M.Y36(VM,8))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[M._Bn([ZN]),M.qOj,M.TTD]})}return o})(),ED=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return o})(),gk=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=M.oAB({type:o});static#n=this.\u0275inj=M.cJS({})}return o})();const OD=new M.OlP("NgModelWithFormControlWarning"),JN={provide:od,useExisting:(0,M.Gpc)(()=>hA)};let hA=(()=>{class o extends od{constructor(i,a,h){super(),this.callSetDisabledState=h,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new M.vpe,this._setValidators(i),this._setAsyncValidators(a)}ngOnChanges(i){this._checkFormPresent(),i.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(uA(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(i){const a=this.form.get(i.path);return $I(a,i,this.callSetDisabledState),a.updateValueAndValidity({emitEvent:!1}),this.directives.push(i),a}getControl(i){return this.form.get(i.path)}removeControl(i){lA(i.control||null,i,!1),function $N(o,n){const i=o.indexOf(n);i>-1&&o.splice(i,1)}(this.directives,i)}addFormGroup(i){this._setUpFormContainer(i)}removeFormGroup(i){this._cleanUpFormContainer(i)}getFormGroup(i){return this.form.get(i.path)}addFormArray(i){this._setUpFormContainer(i)}removeFormArray(i){this._cleanUpFormContainer(i)}getFormArray(i){return this.form.get(i.path)}updateModel(i,a){this.form.get(i.path).setValue(a)}onSubmit(i){return this.submitted=!0,lk(this.form,this.directives),this.ngSubmit.emit(i),"dialog"===i?.target?.method}onReset(){this.resetForm()}resetForm(i=void 0){this.form.reset(i),this.submitted=!1}_updateDomValue(){this.directives.forEach(i=>{const a=i.control,h=this.form.get(i.path);a!==h&&(lA(a||null,i),(o=>o instanceof Rm)(h)&&($I(h,i,this.callSetDisabledState),i.control=h))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(i){const a=this.form.get(i.path);ak(a,i),a.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(i){if(this.form){const a=this.form.get(i.path);a&&function UN(o,n){return uA(o,n)}(a,i)&&a.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){wD(this.form,this),this._oldForm&&uA(this._oldForm,this)}_checkFormPresent(){}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(ls,10),M.Y36(Rl,10),M.Y36(VM,8))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["","formGroup",""]],hostBindings:function(a,h){1&a&&M.NdJ("submit",function(x){return h.onSubmit(x)})("reset",function(){return h.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[M._Bn([JN]),M.qOj,M.TTD]})}return o})();const n3={provide:iw,useExisting:(0,M.Gpc)(()=>SD)};let SD=(()=>{class o extends iw{set isDisabled(i){}static#t=this._ngModelWarningSentOnce=!1;constructor(i,a,h,_,x){super(),this._ngModelWarningConfig=x,this._added=!1,this.name=null,this.update=new M.vpe,this._ngModelWarningSent=!1,this._parent=i,this._setValidators(a),this._setAsyncValidators(h),this.valueAccessor=PD(0,_)}ngOnChanges(i){this._added||this._setUpControl(),MD(i,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(i){this.viewModel=i,this.update.emit(i)}get path(){return aA(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static#e=this.\u0275fac=function(a){return new(a||o)(M.Y36(od,13),M.Y36(ls,10),M.Y36(Rl,10),M.Y36(Si,10),M.Y36(OD,8))};static#n=this.\u0275dir=M.lG2({type:o,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[M._Bn([n3]),M.qOj,M.TTD]})}return o})();const r3={provide:Si,useExisting:(0,M.Gpc)(()=>fA),multi:!0};function bk(o,n){return null==o?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${o}: ${n}`.slice(0,50))}let fA=(()=>{class o extends Kr{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(i){this._compareWith=i}writeValue(i){this.value=i;const h=bk(this._getOptionId(i),i);this.setProperty("value",h)}registerOnChange(i){this.onChange=a=>{this.value=this._getOptionValue(a),i(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(i){for(const a of this._optionMap.keys())if(this._compareWith(this._optionMap.get(a),i))return a;return null}_getOptionValue(i){const a=function i3(o){return o.split(":")[0]}(i);return this._optionMap.has(a)?this._optionMap.get(a):i}static#t=this.\u0275fac=function(){let i;return function(h){return(i||(i=M.n5z(o)))(h||o)}}();static#e=this.\u0275dir=M.lG2({type:o,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(a,h){1&a&&M.NdJ("change",function(x){return h.onChange(x.target.value)})("blur",function(){return h.onTouched()})},inputs:{compareWith:"compareWith"},features:[M._Bn([r3]),M.qOj]})}return o})(),xk=(()=>{class o{constructor(i,a,h){this._element=i,this._renderer=a,this._select=h,this._select&&(this.id=this._select._registerOption())}set ngValue(i){null!=this._select&&(this._select._optionMap.set(this.id,i),this._setElementValue(bk(this.id,i)),this._select.writeValue(this._select.value))}set value(i){this._setElementValue(i),this._select&&this._select.writeValue(this._select.value)}_setElementValue(i){this._renderer.setProperty(this._element.nativeElement,"value",i)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(M.SBq),M.Y36(M.Qsj),M.Y36(fA,9))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return o})();const o3={provide:Si,useExisting:(0,M.Gpc)(()=>AD),multi:!0};function wk(o,n){return null==o?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${o}: ${n}`.slice(0,50))}let AD=(()=>{class o extends Kr{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(i){this._compareWith=i}writeValue(i){let a;if(this.value=i,Array.isArray(i)){const h=i.map(_=>this._getOptionId(_));a=(_,x)=>{_._setSelected(h.indexOf(x.toString())>-1)}}else a=(h,_)=>{h._setSelected(!1)};this._optionMap.forEach(a)}registerOnChange(i){this.onChange=a=>{const h=[],_=a.selectedOptions;if(void 0!==_){const x=_;for(let S=0;S<x.length;S++){const B=this._getOptionValue(x[S].value);h.push(B)}}else{const x=a.options;for(let S=0;S<x.length;S++){const L=x[S];if(L.selected){const B=this._getOptionValue(L.value);h.push(B)}}}this.value=h,i(h)}}_registerOption(i){const a=(this._idCounter++).toString();return this._optionMap.set(a,i),a}_getOptionId(i){for(const a of this._optionMap.keys())if(this._compareWith(this._optionMap.get(a)._value,i))return a;return null}_getOptionValue(i){const a=function s3(o){return o.split(":")[0]}(i);return this._optionMap.has(a)?this._optionMap.get(a)._value:i}static#t=this.\u0275fac=function(){let i;return function(h){return(i||(i=M.n5z(o)))(h||o)}}();static#e=this.\u0275dir=M.lG2({type:o,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(a,h){1&a&&M.NdJ("change",function(x){return h.onChange(x.target)})("blur",function(){return h.onTouched()})},inputs:{compareWith:"compareWith"},features:[M._Bn([o3]),M.qOj]})}return o})(),Ck=(()=>{class o{constructor(i,a,h){this._element=i,this._renderer=a,this._select=h,this._select&&(this.id=this._select._registerOption(this))}set ngValue(i){null!=this._select&&(this._value=i,this._setElementValue(wk(this.id,i)),this._select.writeValue(this._select.value))}set value(i){this._select?(this._value=i,this._setElementValue(wk(this.id,i)),this._select.writeValue(this._select.value)):this._setElementValue(i)}_setElementValue(i){this._renderer.setProperty(this._element.nativeElement,"value",i)}_setSelected(i){this._renderer.setProperty(this._element.nativeElement,"selected",i)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(M.SBq),M.Y36(M.Qsj),M.Y36(AD,9))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return o})(),jM=(()=>{class o{constructor(){this._validator=rw}ngOnChanges(i){if(this.inputName in i){const a=this.normalizeInput(i[this.inputName].currentValue);this._enabled=this.enabled(a),this._validator=this._enabled?this.createValidator(a):rw,this._onChange&&this._onChange()}}validate(i){return this._validator(i)}registerOnValidatorChange(i){this._onChange=i}enabled(i){return null!=i}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275dir=M.lG2({type:o,features:[M.TTD]})}return o})();const c3={provide:ls,useExisting:(0,M.Gpc)(()=>HI),multi:!0};let HI=(()=>{class o extends jM{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=M.VuI,this.createValidator=i=>AI}enabled(i){return i}static#t=this.\u0275fac=function(){let i;return function(h){return(i||(i=M.n5z(o)))(h||o)}}();static#e=this.\u0275dir=M.lG2({type:o,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(a,h){2&a&&M.uIk("required",h._enabled?"":null)},inputs:{required:"required"},features:[M._Bn([c3]),M.qOj]})}return o})(),kk=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=M.oAB({type:o});static#n=this.\u0275inj=M.cJS({imports:[gk]})}return o})();class DD extends sA{constructor(n,i,a){super(bD(i),xD(a,i)),this.controls=n,this._initObservables(),this._setUpdateStrategy(i),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[this._adjustIndex(n)]}push(n,i={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}insert(n,i,a={}){this.controls.splice(n,0,i),this._registerControl(i),this.updateValueAndValidity({emitEvent:a.emitEvent})}removeAt(n,i={}){let a=this._adjustIndex(n);a<0&&(a=0),this.controls[a]&&this.controls[a]._registerOnCollectionChange(()=>{}),this.controls.splice(a,1),this.updateValueAndValidity({emitEvent:i.emitEvent})}setControl(n,i,a={}){let h=this._adjustIndex(n);h<0&&(h=0),this.controls[h]&&this.controls[h]._registerOnCollectionChange(()=>{}),this.controls.splice(h,1),i&&(this.controls.splice(h,0,i),this._registerControl(i)),this.updateValueAndValidity({emitEvent:a.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,i={}){ik(this,0,n),n.forEach((a,h)=>{rk(this,!1,h),this.at(h).setValue(a,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i)}patchValue(n,i={}){null!=n&&(n.forEach((a,h)=>{this.at(h)&&this.at(h).patchValue(a,{onlySelf:!0,emitEvent:i.emitEvent})}),this.updateValueAndValidity(i))}reset(n=[],i={}){this._forEachChild((a,h)=>{a.reset(n[h],{onlySelf:!0,emitEvent:i.emitEvent})}),this._updatePristine(i),this._updateTouched(i),this.updateValueAndValidity(i)}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(i=>i._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((i,a)=>!!a._syncPendingControls()||i,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((i,a)=>{n(i,a)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(i=>i.enabled&&n(i))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}}function Rk(o){return!!o&&(void 0!==o.asyncValidators||void 0!==o.validators||void 0!==o.updateOn)}let g3=(()=>{class o{constructor(){this.useNonNullable=!1}get nonNullable(){const i=new o;return i.useNonNullable=!0,i}group(i,a=null){const h=this._reduceControls(i);let _={};return Rk(a)?_=a:null!==a&&(_.validators=a.validator,_.asyncValidators=a.asyncValidator),new qO(h,_)}record(i,a=null){const h=this._reduceControls(i);return new ok(h,a)}control(i,a,h){let _={};return this.useNonNullable?(Rk(a)?_=a:(_.validators=a,_.asyncValidators=h),new Rm(i,{..._,nonNullable:!0})):new Rm(i,a,h)}array(i,a,h){const _=i.map(x=>this._createControl(x));return new DD(_,a,h)}_reduceControls(i){const a={};return Object.keys(i).forEach(h=>{a[h]=this._createControl(i[h])}),a}_createControl(i){return i instanceof Rm||i instanceof sA?i:Array.isArray(i)?this.control(i[0],i.length>1?i[1]:null,i.length>2?i[2]:null):this.control(i)}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Lk=(()=>{class o{static withConfig(i){return{ngModule:o,providers:[{provide:VM,useValue:i.callSetDisabledState??jI}]}}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=M.oAB({type:o});static#n=this.\u0275inj=M.cJS({imports:[kk]})}return o})(),Nk=(()=>{class o{static withConfig(i){return{ngModule:o,providers:[{provide:OD,useValue:i.warnOnNgModelWithFormControl??"always"},{provide:VM,useValue:i.callSetDisabledState??jI}]}}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=M.oAB({type:o});static#n=this.\u0275inj=M.cJS({imports:[kk]})}return o})();var Nr=ft(2096),sd=ft(1631),qI=ft(4674);function WO(o,n){return(0,qI.m)(n)?(0,sd.z)(o,n,1):(0,sd.z)(o,1)}var ig=ft(9360);function Ny(o,n){return(0,ig.e)((i,a)=>{let h=0;i.subscribe((0,nr.x)(a,_=>o.call(n,_,h++)&&a.next(_)))})}function ZI(o){return(0,ig.e)((n,i)=>{try{n.subscribe(i)}finally{i.add(o)}})}var Ll=ft(4664);class $M{}class pA{}class Fy{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(i=>{const a=i.indexOf(":");if(a>0){const h=i.slice(0,a),_=h.toLowerCase(),x=i.slice(a+1).trim();this.maybeSetNormalizedName(h,_),this.headers.has(_)?this.headers.get(_).push(x):this.headers.set(_,[x])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((i,a)=>{this.setHeaderEntries(a,i)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([i,a])=>{this.setHeaderEntries(i,a)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const i=this.headers.get(n.toLowerCase());return i&&i.length>0?i[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,i){return this.clone({name:n,value:i,op:"a"})}set(n,i){return this.clone({name:n,value:i,op:"s"})}delete(n,i){return this.clone({name:n,value:i,op:"d"})}maybeSetNormalizedName(n,i){this.normalizedNames.has(i)||this.normalizedNames.set(i,n)}init(){this.lazyInit&&(this.lazyInit instanceof Fy?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(i=>{this.headers.set(i,n.headers.get(i)),this.normalizedNames.set(i,n.normalizedNames.get(i))})}clone(n){const i=new Fy;return i.lazyInit=this.lazyInit&&this.lazyInit instanceof Fy?this.lazyInit:this,i.lazyUpdate=(this.lazyUpdate||[]).concat([n]),i}applyUpdate(n){const i=n.name.toLowerCase();switch(n.op){case"a":case"s":let a=n.value;if("string"==typeof a&&(a=[a]),0===a.length)return;this.maybeSetNormalizedName(n.name,i);const h=("a"===n.op?this.headers.get(i):void 0)||[];h.push(...a),this.headers.set(i,h);break;case"d":const _=n.value;if(_){let x=this.headers.get(i);if(!x)return;x=x.filter(S=>-1===_.indexOf(S)),0===x.length?(this.headers.delete(i),this.normalizedNames.delete(i)):this.headers.set(i,x)}else this.headers.delete(i),this.normalizedNames.delete(i)}}setHeaderEntries(n,i){const a=(Array.isArray(i)?i:[i]).map(_=>_.toString()),h=n.toLowerCase();this.headers.set(h,a),this.maybeSetNormalizedName(n,h)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(i=>n(this.normalizedNames.get(i),this.headers.get(i)))}}class m3{encodeKey(n){return Fk(n)}encodeValue(n){return Fk(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const y3=/%(\d[a-f0-9])/gi,v3={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Fk(o){return encodeURIComponent(o).replace(y3,(n,i)=>v3[i]??n)}function gA(o){return`${o}`}class ow{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new m3,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function _3(o,n){const i=new Map;return o.length>0&&o.replace(/^\?/,"").split("&").forEach(h=>{const _=h.indexOf("="),[x,S]=-1==_?[n.decodeKey(h),""]:[n.decodeKey(h.slice(0,_)),n.decodeValue(h.slice(_+1))],L=i.get(x)||[];L.push(S),i.set(x,L)}),i}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(i=>{const a=n.fromObject[i],h=Array.isArray(a)?a.map(gA):[gA(a)];this.map.set(i,h)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const i=this.map.get(n);return i?i[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,i){return this.clone({param:n,value:i,op:"a"})}appendAll(n){const i=[];return Object.keys(n).forEach(a=>{const h=n[a];Array.isArray(h)?h.forEach(_=>{i.push({param:a,value:_,op:"a"})}):i.push({param:a,value:h,op:"a"})}),this.clone(i)}set(n,i){return this.clone({param:n,value:i,op:"s"})}delete(n,i){return this.clone({param:n,value:i,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const i=this.encoder.encodeKey(n);return this.map.get(n).map(a=>i+"="+this.encoder.encodeValue(a)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const i=new ow({encoder:this.encoder});return i.cloneFrom=this.cloneFrom||this,i.updates=(this.updates||[]).concat(n),i}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const i=("a"===n.op?this.map.get(n.param):void 0)||[];i.push(gA(n.value)),this.map.set(n.param,i);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let a=this.map.get(n.param)||[];const h=a.indexOf(gA(n.value));-1!==h&&a.splice(h,1),a.length>0?this.map.set(n.param,a):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class b3{constructor(){this.map=new Map}set(n,i){return this.map.set(n,i),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function zk(o){return typeof ArrayBuffer<"u"&&o instanceof ArrayBuffer}function Bk(o){return typeof Blob<"u"&&o instanceof Blob}function Uk(o){return typeof FormData<"u"&&o instanceof FormData}class WI{constructor(n,i,a,h){let _;if(this.url=i,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function x3(o){switch(o){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||h?(this.body=void 0!==a?a:null,_=h):_=a,_&&(this.reportProgress=!!_.reportProgress,this.withCredentials=!!_.withCredentials,_.responseType&&(this.responseType=_.responseType),_.headers&&(this.headers=_.headers),_.context&&(this.context=_.context),_.params&&(this.params=_.params)),this.headers||(this.headers=new Fy),this.context||(this.context=new b3),this.params){const x=this.params.toString();if(0===x.length)this.urlWithParams=i;else{const S=i.indexOf("?");this.urlWithParams=i+(-1===S?"?":S<i.length-1?"&":"")+x}}else this.params=new ow,this.urlWithParams=i}serializeBody(){return null===this.body?null:zk(this.body)||Bk(this.body)||Uk(this.body)||function w3(o){return typeof URLSearchParams<"u"&&o instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof ow?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Uk(this.body)?null:Bk(this.body)?this.body.type||null:zk(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ow?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const i=n.method||this.method,a=n.url||this.url,h=n.responseType||this.responseType,_=void 0!==n.body?n.body:this.body,x=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,S=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let L=n.headers||this.headers,B=n.params||this.params;const H=n.context??this.context;return void 0!==n.setHeaders&&(L=Object.keys(n.setHeaders).reduce((Y,pt)=>Y.set(pt,n.setHeaders[pt]),L)),n.setParams&&(B=Object.keys(n.setParams).reduce((Y,pt)=>Y.set(pt,n.setParams[pt]),B)),new WI(i,a,_,{params:B,headers:L,context:H,reportProgress:S,responseType:h,withCredentials:x})}}var KO=function(o){return o[o.Sent=0]="Sent",o[o.UploadProgress=1]="UploadProgress",o[o.ResponseHeader=2]="ResponseHeader",o[o.DownloadProgress=3]="DownloadProgress",o[o.Response=4]="Response",o[o.User=5]="User",o}(KO||{});class kD{constructor(n,i=200,a="OK"){this.headers=n.headers||new Fy,this.status=void 0!==n.status?n.status:i,this.statusText=n.statusText||a,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class RD extends kD{constructor(n={}){super(n),this.type=KO.ResponseHeader}clone(n={}){return new RD({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class YO extends kD{constructor(n={}){super(n),this.type=KO.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new YO({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class Vk extends kD{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function LD(o,n){return{body:n,headers:o.headers,context:o.context,observe:o.observe,params:o.params,reportProgress:o.reportProgress,responseType:o.responseType,withCredentials:o.withCredentials}}let mA=(()=>{class o{constructor(i){this.handler=i}request(i,a,h={}){let _;if(i instanceof WI)_=i;else{let L,B;L=h.headers instanceof Fy?h.headers:new Fy(h.headers),h.params&&(B=h.params instanceof ow?h.params:new ow({fromObject:h.params})),_=new WI(i,a,void 0!==h.body?h.body:null,{headers:L,context:h.context,params:B,reportProgress:h.reportProgress,responseType:h.responseType||"json",withCredentials:h.withCredentials})}const x=(0,Nr.of)(_).pipe(WO(L=>this.handler.handle(L)));if(i instanceof WI||"events"===h.observe)return x;const S=x.pipe(Ny(L=>L instanceof YO));switch(h.observe||"body"){case"body":switch(_.responseType){case"arraybuffer":return S.pipe((0,ln.U)(L=>{if(null!==L.body&&!(L.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return L.body}));case"blob":return S.pipe((0,ln.U)(L=>{if(null!==L.body&&!(L.body instanceof Blob))throw new Error("Response is not a Blob.");return L.body}));case"text":return S.pipe((0,ln.U)(L=>{if(null!==L.body&&"string"!=typeof L.body)throw new Error("Response is not a string.");return L.body}));default:return S.pipe((0,ln.U)(L=>L.body))}case"response":return S;default:throw new Error(`Unreachable: unhandled observe type ${h.observe}}`)}}delete(i,a={}){return this.request("DELETE",i,a)}get(i,a={}){return this.request("GET",i,a)}head(i,a={}){return this.request("HEAD",i,a)}jsonp(i,a){return this.request("JSONP",i,{params:(new ow).append(a,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(i,a={}){return this.request("OPTIONS",i,a)}patch(i,a,h={}){return this.request("PATCH",i,LD(h,a))}post(i,a,h={}){return this.request("POST",i,LD(h,a))}put(i,a,h={}){return this.request("PUT",i,LD(h,a))}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG($M))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();function Gk(o,n){return n(o)}function M3(o,n){return(i,a)=>n.intercept(i,{handle:h=>o(h,a)})}const E3=new M.OlP(""),KI=new M.OlP(""),Hk=new M.OlP("");function O3(){let o=null;return(n,i)=>{null===o&&(o=((0,M.f3M)(E3,{optional:!0})??[]).reduceRight(M3,Gk));const a=(0,M.f3M)(M.HDt),h=a.add();return o(n,i).pipe(ZI(()=>a.remove(h)))}}let qk=(()=>{class o extends $M{constructor(i,a){super(),this.backend=i,this.injector=a,this.chain=null,this.pendingTasks=(0,M.f3M)(M.HDt)}handle(i){if(null===this.chain){const h=Array.from(new Set([...this.injector.get(KI),...this.injector.get(Hk,[])]));this.chain=h.reduceRight((_,x)=>function P3(o,n,i){return(a,h)=>i.runInContext(()=>n(a,_=>o(_,h)))}(_,x,this.injector),Gk)}const a=this.pendingTasks.add();return this.chain(i,h=>this.backend.handle(h)).pipe(ZI(()=>this.pendingTasks.remove(a)))}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(pA),M.LFG(M.lqb))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();const A3=/^\)\]\}',?\n/;let Wk=(()=>{class o{constructor(i){this.xhrFactory=i}handle(i){if("JSONP"===i.method)throw new M.vHH(-2800,!1);const a=this.xhrFactory;return(a.\u0275loadImpl?(0,Nt.D)(a.\u0275loadImpl()):(0,Nr.of)(null)).pipe((0,Ll.w)(()=>new $t.y(_=>{const x=a.build();if(x.open(i.method,i.urlWithParams),i.withCredentials&&(x.withCredentials=!0),i.headers.forEach((Ut,Zt)=>x.setRequestHeader(Ut,Zt.join(","))),i.headers.has("Accept")||x.setRequestHeader("Accept","application/json, text/plain, */*"),!i.headers.has("Content-Type")){const Ut=i.detectContentTypeHeader();null!==Ut&&x.setRequestHeader("Content-Type",Ut)}if(i.responseType){const Ut=i.responseType.toLowerCase();x.responseType="json"!==Ut?Ut:"text"}const S=i.serializeBody();let L=null;const B=()=>{if(null!==L)return L;const Ut=x.statusText||"OK",Zt=new Fy(x.getAllResponseHeaders()),qe=function D3(o){return"responseURL"in o&&o.responseURL?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):null}(x)||i.url;return L=new RD({headers:Zt,status:x.status,statusText:Ut,url:qe}),L},H=()=>{let{headers:Ut,status:Zt,statusText:qe,url:fn}=B(),$e=null;204!==Zt&&($e=typeof x.response>"u"?x.responseText:x.response),0===Zt&&(Zt=$e?200:0);let cn=Zt>=200&&Zt<300;if("json"===i.responseType&&"string"==typeof $e){const Mr=$e;$e=$e.replace(A3,"");try{$e=""!==$e?JSON.parse($e):null}catch(Cr){$e=Mr,cn&&(cn=!1,$e={error:Cr,text:$e})}}cn?(_.next(new YO({body:$e,headers:Ut,status:Zt,statusText:qe,url:fn||void 0})),_.complete()):_.error(new Vk({error:$e,headers:Ut,status:Zt,statusText:qe,url:fn||void 0}))},Y=Ut=>{const{url:Zt}=B(),qe=new Vk({error:Ut,status:x.status||0,statusText:x.statusText||"Unknown Error",url:Zt||void 0});_.error(qe)};let pt=!1;const xt=Ut=>{pt||(_.next(B()),pt=!0);let Zt={type:KO.DownloadProgress,loaded:Ut.loaded};Ut.lengthComputable&&(Zt.total=Ut.total),"text"===i.responseType&&x.responseText&&(Zt.partialText=x.responseText),_.next(Zt)},At=Ut=>{let Zt={type:KO.UploadProgress,loaded:Ut.loaded};Ut.lengthComputable&&(Zt.total=Ut.total),_.next(Zt)};return x.addEventListener("load",H),x.addEventListener("error",Y),x.addEventListener("timeout",Y),x.addEventListener("abort",Y),i.reportProgress&&(x.addEventListener("progress",xt),null!==S&&x.upload&&x.upload.addEventListener("progress",At)),x.send(S),_.next({type:KO.Sent}),()=>{x.removeEventListener("error",Y),x.removeEventListener("abort",Y),x.removeEventListener("load",H),x.removeEventListener("timeout",Y),i.reportProgress&&(x.removeEventListener("progress",xt),null!==S&&x.upload&&x.upload.removeEventListener("progress",At)),x.readyState!==x.DONE&&x.abort()}})))}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG($a))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();const ND=new M.OlP("XSRF_ENABLED"),Kk=new M.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Yk=new M.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Xk{}let L3=(()=>{class o{constructor(i,a,h){this.doc=i,this.platform=a,this.cookieName=h,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const i=this.doc.cookie||"";return i!==this.lastCookieString&&(this.parseCount++,this.lastToken=pl(i,this.cookieName),this.lastCookieString=i),this.lastToken}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(ye),M.LFG(M.Lbi),M.LFG(Kk))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();function N3(o,n){const i=o.url.toLowerCase();if(!(0,M.f3M)(ND)||"GET"===o.method||"HEAD"===o.method||i.startsWith("http://")||i.startsWith("https://"))return n(o);const a=(0,M.f3M)(Xk).getToken(),h=(0,M.f3M)(Yk);return null!=a&&!o.headers.has(h)&&(o=o.clone({headers:o.headers.set(h,a)})),n(o)}var sw=function(o){return o[o.Interceptors=0]="Interceptors",o[o.LegacyInterceptors=1]="LegacyInterceptors",o[o.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",o[o.NoXsrfProtection=3]="NoXsrfProtection",o[o.JsonpSupport=4]="JsonpSupport",o[o.RequestsMadeViaParent=5]="RequestsMadeViaParent",o[o.Fetch=6]="Fetch",o}(sw||{});function F3(...o){const n=[mA,Wk,qk,{provide:$M,useExisting:qk},{provide:pA,useExisting:Wk},{provide:KI,useValue:N3,multi:!0},{provide:ND,useValue:!0},{provide:Xk,useClass:L3}];for(const i of o)n.push(...i.\u0275providers);return(0,M.MR2)(n)}const Qk=new M.OlP("LEGACY_INTERCEPTOR_FN");function z3(){return function GM(o,n){return{\u0275kind:o,\u0275providers:n}}(sw.LegacyInterceptors,[{provide:Qk,useFactory:O3},{provide:KI,useExisting:Qk,multi:!0}])}let B3=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=M.oAB({type:o});static#n=this.\u0275inj=M.cJS({providers:[F3(z3())]})}return o})();var Lm=ft(5619),yA=ft(2737),q3=ft(7103);function FD(...o){const n=(0,Qe.yG)(o),i=(0,Qe.jO)(o),{args:a,keys:h}=Be(o);if(0===a.length)return(0,Nt.D)([],n);const _=new $t.y(function Z3(o,n,i=yA.y){return a=>{Jk(n,()=>{const{length:h}=o,_=new Array(h);let x=h,S=h;for(let L=0;L<h;L++)Jk(n,()=>{const B=(0,Nt.D)(o[L],n);let H=!1;B.subscribe((0,nr.x)(a,Y=>{_[L]=Y,H||(H=!0,S--),S||a.next(i(_.slice()))},()=>{--x||a.complete()}))},a)},a)}}(a,n,h?x=>wr(h,x):yA.y));return i?_.pipe(mn(i)):_}function Jk(o,n,i){o?(0,q3.f)(i,o,n):n()}const vA=(0,ft(2306).d)(o=>function(){o(this),this.name="EmptyError",this.message="no elements in sequence"});var YI=ft(7537);function zD(...o){return function K3(){return(0,YI.J)(1)}()((0,Nt.D)(o,(0,Qe.yG)(o)))}function tR(o){return new $t.y(n=>{(0,En.Xf)(o()).subscribe(n)})}var Y3=ft(8407);function XI(o,n){const i=(0,qI.m)(o)?o:()=>o,a=h=>h.error(i());return new $t.y(n?h=>n.schedule(a,0,h):a)}var aw=ft(6232),BD=ft(7394);function UD(){return(0,ig.e)((o,n)=>{let i=null;o._refCount++;const a=(0,nr.x)(n,void 0,void 0,void 0,()=>{if(!o||o._refCount<=0||0<--o._refCount)return void(i=null);const h=o._connection,_=i;i=null,h&&(!_||h===_)&&h.unsubscribe(),n.unsubscribe()});o.subscribe(a),a.closed||(i=o.connect())})}class eR extends $t.y{constructor(n,i){super(),this.source=n,this.subjectFactory=i,this._subject=null,this._refCount=0,this._connection=null,(0,ig.A)(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new BD.w0;const i=this.getSubject();n.add(this.source.subscribe((0,nr.x)(i,void 0,()=>{this._teardown(),i.complete()},a=>{this._teardown(),i.error(a)},()=>this._teardown()))),n.closed&&(this._connection=null,n=BD.w0.EMPTY)}return n}refCount(){return UD()(this)}}var zy=ft(8645);function XO(o){return o<=0?()=>aw.E:(0,ig.e)((n,i)=>{let a=0;n.subscribe((0,nr.x)(i,h=>{++a<=o&&(i.next(h),o<=a&&i.complete())}))})}function bA(o){return(0,ig.e)((n,i)=>{let a=!1;n.subscribe((0,nr.x)(i,h=>{a=!0,i.next(h)},()=>{a||i.next(o),i.complete()}))})}function nR(o=Q3){return(0,ig.e)((n,i)=>{let a=!1;n.subscribe((0,nr.x)(i,h=>{a=!0,i.next(h)},()=>a?i.complete():i.error(o())))})}function Q3(){return new vA}function lw(o,n){const i=arguments.length>=2;return a=>a.pipe(o?Ny((h,_)=>o(h,_,a)):yA.y,XO(1),i?bA(n):nR(()=>new vA))}var nu=ft(9397);function HM(o){return(0,ig.e)((n,i)=>{let _,a=null,h=!1;a=n.subscribe((0,nr.x)(i,void 0,void 0,x=>{_=(0,En.Xf)(o(x,HM(o)(n))),a?(a.unsubscribe(),a=null,_.subscribe(i)):h=!0})),h&&(a.unsubscribe(),a=null,_.subscribe(i))})}function VD(o){return o<=0?()=>aw.E:(0,ig.e)((n,i)=>{let a=[];n.subscribe((0,nr.x)(i,h=>{a.push(h),o<a.length&&a.shift()},()=>{for(const h of a)i.next(h);i.complete()},void 0,()=>{a=null}))})}var rF=ft(2420);const di="primary",QI=Symbol("RouteTitle");class oF{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const i=this.params[n];return Array.isArray(i)?i[0]:i}return null}getAll(n){if(this.has(n)){const i=this.params[n];return Array.isArray(i)?i:[i]}return[]}get keys(){return Object.keys(this.params)}}function QO(o){return new oF(o)}function sF(o,n,i){const a=i.path.split("/");if(a.length>o.length||"full"===i.pathMatch&&(n.hasChildren()||a.length<o.length))return null;const h={};for(let _=0;_<a.length;_++){const x=a[_],S=o[_];if(x.startsWith(":"))h[x.substring(1)]=S;else if(x!==S.path)return null}return{consumed:o.slice(0,a.length),posParams:h}}function By(o,n){const i=o?Object.keys(o):void 0,a=n?Object.keys(n):void 0;if(!i||!a||i.length!=a.length)return!1;let h;for(let _=0;_<i.length;_++)if(h=i[_],!rR(o[h],n[h]))return!1;return!0}function rR(o,n){if(Array.isArray(o)&&Array.isArray(n)){if(o.length!==n.length)return!1;const i=[...o].sort(),a=[...n].sort();return i.every((h,_)=>a[_]===h)}return o===n}function iR(o){return o.length>0?o[o.length-1]:null}function cw(o){return function H3(o){return!!o&&(o instanceof $t.y||(0,qI.m)(o.lift)&&(0,qI.m)(o.subscribe))}(o)?o:(0,M.QGY)(o)?(0,Nt.D)(Promise.resolve(o)):(0,Nr.of)(o)}const lF={exact:function aR(o,n,i){if(!qM(o.segments,n.segments)||!xA(o.segments,n.segments,i)||o.numberOfChildren!==n.numberOfChildren)return!1;for(const a in n.children)if(!o.children[a]||!aR(o.children[a],n.children[a],i))return!1;return!0},subset:lR},oR={exact:function cF(o,n){return By(o,n)},subset:function uF(o,n){return Object.keys(n).length<=Object.keys(o).length&&Object.keys(n).every(i=>rR(o[i],n[i]))},ignored:()=>!0};function sR(o,n,i){return lF[i.paths](o.root,n.root,i.matrixParams)&&oR[i.queryParams](o.queryParams,n.queryParams)&&!("exact"===i.fragment&&o.fragment!==n.fragment)}function lR(o,n,i){return cR(o,n,n.segments,i)}function cR(o,n,i,a){if(o.segments.length>i.length){const h=o.segments.slice(0,i.length);return!(!qM(h,i)||n.hasChildren()||!xA(h,i,a))}if(o.segments.length===i.length){if(!qM(o.segments,i)||!xA(o.segments,i,a))return!1;for(const h in n.children)if(!o.children[h]||!lR(o.children[h],n.children[h],a))return!1;return!0}{const h=i.slice(0,o.segments.length),_=i.slice(o.segments.length);return!!(qM(o.segments,h)&&xA(o.segments,h,a)&&o.children[di])&&cR(o.children[di],n,_,a)}}function xA(o,n,i){return n.every((a,h)=>oR[i](o[h].parameters,a.parameters))}class JO{constructor(n=new Ao([],{}),i={},a=null){this.root=n,this.queryParams=i,this.fragment=a}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=QO(this.queryParams)),this._queryParamMap}toString(){return fF.serialize(this)}}class Ao{constructor(n,i){this.segments=n,this.children=i,this.parent=null,Object.values(i).forEach(a=>a.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return wA(this)}}class JI{constructor(n,i){this.path=n,this.parameters=i}get parameterMap(){return this._parameterMap||(this._parameterMap=QO(this.parameters)),this._parameterMap}toString(){return hR(this)}}function qM(o,n){return o.length===n.length&&o.every((i,a)=>i.path===n[a].path)}let tS=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:function(){return new jD},providedIn:"root"})}return o})();class jD{parse(n){const i=new MF(n);return new JO(i.parseRootSegment(),i.parseQueryParams(),i.parseFragment())}serialize(n){const i=`/${eS(n.root,!0)}`,a=function mF(o){const n=Object.keys(o).map(i=>{const a=o[i];return Array.isArray(a)?a.map(h=>`${CA(i)}=${CA(h)}`).join("&"):`${CA(i)}=${CA(a)}`}).filter(i=>!!i);return n.length?`?${n.join("&")}`:""}(n.queryParams),h="string"==typeof n.fragment?`#${function pF(o){return encodeURI(o)}(n.fragment)}`:"";return`${i}${a}${h}`}}const fF=new jD;function wA(o){return o.segments.map(n=>hR(n)).join("/")}function eS(o,n){if(!o.hasChildren())return wA(o);if(n){const i=o.children[di]?eS(o.children[di],!1):"",a=[];return Object.entries(o.children).forEach(([h,_])=>{h!==di&&a.push(`${h}:${eS(_,!1)}`)}),a.length>0?`${i}(${a.join("//")})`:i}{const i=function hF(o,n){let i=[];return Object.entries(o.children).forEach(([a,h])=>{a===di&&(i=i.concat(n(h,a)))}),Object.entries(o.children).forEach(([a,h])=>{a!==di&&(i=i.concat(n(h,a)))}),i}(o,(a,h)=>h===di?[eS(o.children[di],!1)]:[`${h}:${eS(a,!1)}`]);return 1===Object.keys(o.children).length&&null!=o.children[di]?`${wA(o)}/${i[0]}`:`${wA(o)}/(${i.join("//")})`}}function uR(o){return encodeURIComponent(o).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function CA(o){return uR(o).replace(/%3B/gi,";")}function $D(o){return uR(o).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function MA(o){return decodeURIComponent(o)}function dR(o){return MA(o.replace(/\+/g,"%20"))}function hR(o){return`${$D(o.path)}${function gF(o){return Object.keys(o).map(n=>`;${$D(n)}=${$D(o[n])}`).join("")}(o.parameters)}`}const _F=/^[^\/()?;#]+/;function GD(o){const n=o.match(_F);return n?n[0]:""}const yF=/^[^\/()?;=#]+/,bF=/^[^=?&#]+/,wF=/^[^&#]+/;class MF{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ao([],{}):new Ao([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let i={};this.peekStartsWith("/(")&&(this.capture("/"),i=this.parseParens(!0));let a={};return this.peekStartsWith("(")&&(a=this.parseParens(!1)),(n.length>0||Object.keys(i).length>0)&&(a[di]=new Ao(n,i)),a}parseSegment(){const n=GD(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new M.vHH(4009,!1);return this.capture(n),new JI(MA(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const i=function vF(o){const n=o.match(yF);return n?n[0]:""}(this.remaining);if(!i)return;this.capture(i);let a="";if(this.consumeOptional("=")){const h=GD(this.remaining);h&&(a=h,this.capture(a))}n[MA(i)]=MA(a)}parseQueryParam(n){const i=function xF(o){const n=o.match(bF);return n?n[0]:""}(this.remaining);if(!i)return;this.capture(i);let a="";if(this.consumeOptional("=")){const x=function CF(o){const n=o.match(wF);return n?n[0]:""}(this.remaining);x&&(a=x,this.capture(a))}const h=dR(i),_=dR(a);if(n.hasOwnProperty(h)){let x=n[h];Array.isArray(x)||(x=[x],n[h]=x),x.push(_)}else n[h]=_}parseParens(n){const i={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const a=GD(this.remaining),h=this.remaining[a.length];if("/"!==h&&")"!==h&&";"!==h)throw new M.vHH(4010,!1);let _;a.indexOf(":")>-1?(_=a.slice(0,a.indexOf(":")),this.capture(_),this.capture(":")):n&&(_=di);const x=this.parseChildren();i[_]=1===Object.keys(x).length?x[di]:new Ao([],x),this.consumeOptional("//")}return i}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new M.vHH(4011,!1)}}function fR(o){return o.segments.length>0?new Ao([],{[di]:o}):o}function pR(o){const n={};for(const a of Object.keys(o.children)){const _=pR(o.children[a]);if(a===di&&0===_.segments.length&&_.hasChildren())for(const[x,S]of Object.entries(_.children))n[x]=S;else(_.segments.length>0||_.hasChildren())&&(n[a]=_)}return function PF(o){if(1===o.numberOfChildren&&o.children[di]){const n=o.children[di];return new Ao(o.segments.concat(n.segments),n.children)}return o}(new Ao(o.segments,n))}function ZM(o){return o instanceof JO}function gR(o){let n;const h=fR(function i(_){const x={};for(const L of _.children){const B=i(L);x[L.outlet]=B}const S=new Ao(_.url,x);return _===o&&(n=S),S}(o.root));return n??h}function mR(o,n,i,a){let h=o;for(;h.parent;)h=h.parent;if(0===n.length)return HD(h,h,h,i,a);const _=function OF(o){if("string"==typeof o[0]&&1===o.length&&"/"===o[0])return new yR(!0,0,o);let n=0,i=!1;const a=o.reduce((h,_,x)=>{if("object"==typeof _&&null!=_){if(_.outlets){const S={};return Object.entries(_.outlets).forEach(([L,B])=>{S[L]="string"==typeof B?B.split("/"):B}),[...h,{outlets:S}]}if(_.segmentPath)return[...h,_.segmentPath]}return"string"!=typeof _?[...h,_]:0===x?(_.split("/").forEach((S,L)=>{0==L&&"."===S||(0==L&&""===S?i=!0:".."===S?n++:""!=S&&h.push(S))}),h):[...h,_]},[]);return new yR(i,n,a)}(n);if(_.toRoot())return HD(h,h,new Ao([],{}),i,a);const x=function TF(o,n,i){if(o.isAbsolute)return new EA(n,!0,0);if(!i)return new EA(n,!1,NaN);if(null===i.parent)return new EA(i,!0,0);const a=PA(o.commands[0])?0:1;return function IF(o,n,i){let a=o,h=n,_=i;for(;_>h;){if(_-=h,a=a.parent,!a)throw new M.vHH(4005,!1);h=a.segments.length}return new EA(a,!1,h-_)}(i,i.segments.length-1+a,o.numberOfDoubleDots)}(_,h,o),S=x.processChildren?rS(x.segmentGroup,x.index,_.commands):vR(x.segmentGroup,x.index,_.commands);return HD(h,x.segmentGroup,S,i,a)}function PA(o){return"object"==typeof o&&null!=o&&!o.outlets&&!o.segmentPath}function nS(o){return"object"==typeof o&&null!=o&&o.outlets}function HD(o,n,i,a,h){let x,_={};a&&Object.entries(a).forEach(([L,B])=>{_[L]=Array.isArray(B)?B.map(H=>`${H}`):`${B}`}),x=o===n?i:_R(o,n,i);const S=fR(pR(x));return new JO(S,_,h)}function _R(o,n,i){const a={};return Object.entries(o.children).forEach(([h,_])=>{a[h]=_===n?i:_R(_,n,i)}),new Ao(o.segments,a)}class yR{constructor(n,i,a){if(this.isAbsolute=n,this.numberOfDoubleDots=i,this.commands=a,n&&a.length>0&&PA(a[0]))throw new M.vHH(4003,!1);const h=a.find(nS);if(h&&h!==iR(a))throw new M.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class EA{constructor(n,i,a){this.segmentGroup=n,this.processChildren=i,this.index=a}}function vR(o,n,i){if(o||(o=new Ao([],{})),0===o.segments.length&&o.hasChildren())return rS(o,n,i);const a=function AF(o,n,i){let a=0,h=n;const _={match:!1,pathIndex:0,commandIndex:0};for(;h<o.segments.length;){if(a>=i.length)return _;const x=o.segments[h],S=i[a];if(nS(S))break;const L=`${S}`,B=a<i.length-1?i[a+1]:null;if(h>0&&void 0===L)break;if(L&&B&&"object"==typeof B&&void 0===B.outlets){if(!xR(L,B,x))return _;a+=2}else{if(!xR(L,{},x))return _;a++}h++}return{match:!0,pathIndex:h,commandIndex:a}}(o,n,i),h=i.slice(a.commandIndex);if(a.match&&a.pathIndex<o.segments.length){const _=new Ao(o.segments.slice(0,a.pathIndex),{});return _.children[di]=new Ao(o.segments.slice(a.pathIndex),o.children),rS(_,0,h)}return a.match&&0===h.length?new Ao(o.segments,{}):a.match&&!o.hasChildren()?qD(o,n,i):a.match?rS(o,0,h):qD(o,n,i)}function rS(o,n,i){if(0===i.length)return new Ao(o.segments,{});{const a=function SF(o){return nS(o[0])?o[0].outlets:{[di]:o}}(i),h={};if(Object.keys(a).some(_=>_!==di)&&o.children[di]&&1===o.numberOfChildren&&0===o.children[di].segments.length){const _=rS(o.children[di],n,i);return new Ao(o.segments,_.children)}return Object.entries(a).forEach(([_,x])=>{"string"==typeof x&&(x=[x]),null!==x&&(h[_]=vR(o.children[_],n,x))}),Object.entries(o.children).forEach(([_,x])=>{void 0===a[_]&&(h[_]=x)}),new Ao(o.segments,h)}}function qD(o,n,i){const a=o.segments.slice(0,n);let h=0;for(;h<i.length;){const _=i[h];if(nS(_)){const L=DF(_.outlets);return new Ao(a,L)}if(0===h&&PA(i[0])){a.push(new JI(o.segments[n].path,bR(i[0]))),h++;continue}const x=nS(_)?_.outlets[di]:`${_}`,S=h<i.length-1?i[h+1]:null;x&&S&&PA(S)?(a.push(new JI(x,bR(S))),h+=2):(a.push(new JI(x,{})),h++)}return new Ao(a,{})}function DF(o){const n={};return Object.entries(o).forEach(([i,a])=>{"string"==typeof a&&(a=[a]),null!==a&&(n[i]=qD(new Ao([],{}),0,a))}),n}function bR(o){const n={};return Object.entries(o).forEach(([i,a])=>n[i]=`${a}`),n}function xR(o,n,i){return o==i.path&&By(n,i.parameters)}const iS="imperative";class Uy{constructor(n,i){this.id=n,this.url=i}}class OA extends Uy{constructor(n,i,a="imperative",h=null){super(n,i),this.type=0,this.navigationTrigger=a,this.restoredState=h}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class uw extends Uy{constructor(n,i,a){super(n,i),this.urlAfterRedirects=a,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class oS extends Uy{constructor(n,i,a,h){super(n,i),this.reason=a,this.code=h,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class tT extends Uy{constructor(n,i,a,h){super(n,i),this.reason=a,this.code=h,this.type=16}}class TA extends Uy{constructor(n,i,a,h){super(n,i),this.error=a,this.target=h,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class wR extends Uy{constructor(n,i,a,h){super(n,i),this.urlAfterRedirects=a,this.state=h,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class kF extends Uy{constructor(n,i,a,h){super(n,i),this.urlAfterRedirects=a,this.state=h,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class RF extends Uy{constructor(n,i,a,h,_){super(n,i),this.urlAfterRedirects=a,this.state=h,this.shouldActivate=_,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class LF extends Uy{constructor(n,i,a,h){super(n,i),this.urlAfterRedirects=a,this.state=h,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class NF extends Uy{constructor(n,i,a,h){super(n,i),this.urlAfterRedirects=a,this.state=h,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class FF{constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class zF{constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class BF{constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class UF{constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class VF{constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class jF{constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class CR{constructor(n,i,a){this.routerEvent=n,this.position=i,this.anchor=a,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class ZD{}class WD{constructor(n){this.url=n}}class $F{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new sS,this.attachRef=null}}let sS=(()=>{class o{constructor(){this.contexts=new Map}onChildOutletCreated(i,a){const h=this.getOrCreateContext(i);h.outlet=a,this.contexts.set(i,h)}onChildOutletDestroyed(i){const a=this.getContext(i);a&&(a.outlet=null,a.attachRef=null)}onOutletDeactivated(){const i=this.contexts;return this.contexts=new Map,i}onOutletReAttached(i){this.contexts=i}getOrCreateContext(i){let a=this.getContext(i);return a||(a=new $F,this.contexts.set(i,a)),a}getContext(i){return this.contexts.get(i)||null}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();class MR{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const i=this.pathFromRoot(n);return i.length>1?i[i.length-2]:null}children(n){const i=KD(n,this._root);return i?i.children.map(a=>a.value):[]}firstChild(n){const i=KD(n,this._root);return i&&i.children.length>0?i.children[0].value:null}siblings(n){const i=YD(n,this._root);return i.length<2?[]:i[i.length-2].children.map(h=>h.value).filter(h=>h!==n)}pathFromRoot(n){return YD(n,this._root).map(i=>i.value)}}function KD(o,n){if(o===n.value)return n;for(const i of n.children){const a=KD(o,i);if(a)return a}return null}function YD(o,n){if(o===n.value)return[n];for(const i of n.children){const a=YD(o,i);if(a.length)return a.unshift(n),a}return[]}class o0{constructor(n,i){this.value=n,this.children=i}toString(){return`TreeNode(${this.value})`}}function eT(o){const n={};return o&&o.children.forEach(i=>n[i.value.outlet]=i),n}class PR extends MR{constructor(n,i){super(n),this.snapshot=i,XD(this,n)}toString(){return this.snapshot.toString()}}function ER(o,n){const i=function GF(o,n){const x=new IA([],{},{},"",{},di,n,null,{});return new TR("",new o0(x,[]))}(0,n),a=new Lm.X([new JI("",{})]),h=new Lm.X({}),_=new Lm.X({}),x=new Lm.X({}),S=new Lm.X(""),L=new nT(a,h,x,S,_,di,n,i.root);return L.snapshot=i.root,new PR(new o0(L,[]),i)}class nT{constructor(n,i,a,h,_,x,S,L){this.urlSubject=n,this.paramsSubject=i,this.queryParamsSubject=a,this.fragmentSubject=h,this.dataSubject=_,this.outlet=x,this.component=S,this._futureSnapshot=L,this.title=this.dataSubject?.pipe((0,ln.U)(B=>B[QI]))??(0,Nr.of)(void 0),this.url=n,this.params=i,this.queryParams=a,this.fragment=h,this.data=_}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,ln.U)(n=>QO(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,ln.U)(n=>QO(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function OR(o,n="emptyOnly"){const i=o.pathFromRoot;let a=0;if("always"!==n)for(a=i.length-1;a>=1;){const h=i[a],_=i[a-1];if(h.routeConfig&&""===h.routeConfig.path)a--;else{if(_.component)break;a--}}return function HF(o){return o.reduce((n,i)=>({params:{...n.params,...i.params},data:{...n.data,...i.data},resolve:{...i.data,...n.resolve,...i.routeConfig?.data,...i._resolvedData}}),{params:{},data:{},resolve:{}})}(i.slice(a))}class IA{get title(){return this.data?.[QI]}constructor(n,i,a,h,_,x,S,L,B){this.url=n,this.params=i,this.queryParams=a,this.fragment=h,this.data=_,this.outlet=x,this.component=S,this.routeConfig=L,this._resolve=B}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=QO(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=QO(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(a=>a.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class TR extends MR{constructor(n,i){super(i),this.url=n,XD(this,i)}toString(){return IR(this._root)}}function XD(o,n){n.value._routerState=o,n.children.forEach(i=>XD(o,i))}function IR(o){const n=o.children.length>0?` { ${o.children.map(IR).join(", ")} } `:"";return`${o.value}${n}`}function QD(o){if(o.snapshot){const n=o.snapshot,i=o._futureSnapshot;o.snapshot=i,By(n.queryParams,i.queryParams)||o.queryParamsSubject.next(i.queryParams),n.fragment!==i.fragment&&o.fragmentSubject.next(i.fragment),By(n.params,i.params)||o.paramsSubject.next(i.params),function aF(o,n){if(o.length!==n.length)return!1;for(let i=0;i<o.length;++i)if(!By(o[i],n[i]))return!1;return!0}(n.url,i.url)||o.urlSubject.next(i.url),By(n.data,i.data)||o.dataSubject.next(i.data)}else o.snapshot=o._futureSnapshot,o.dataSubject.next(o._futureSnapshot.data)}function JD(o,n){const i=By(o.params,n.params)&&function dF(o,n){return qM(o,n)&&o.every((i,a)=>By(i.parameters,n[a].parameters))}(o.url,n.url);return i&&!(!o.parent!=!n.parent)&&(!o.parent||JD(o.parent,n.parent))}let t2=(()=>{class o{constructor(){this.activated=null,this._activatedRoute=null,this.name=di,this.activateEvents=new M.vpe,this.deactivateEvents=new M.vpe,this.attachEvents=new M.vpe,this.detachEvents=new M.vpe,this.parentContexts=(0,M.f3M)(sS),this.location=(0,M.f3M)(M.s_b),this.changeDetector=(0,M.f3M)(M.sBO),this.environmentInjector=(0,M.f3M)(M.lqb),this.inputBinder=(0,M.f3M)(SA,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(i){if(i.name){const{firstChange:a,previousValue:h}=i.name;if(a)return;this.isTrackedInParentContexts(h)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(h)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(i){return this.parentContexts.getContext(i)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const i=this.parentContexts.getContext(this.name);i?.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new M.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new M.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new M.vHH(4012,!1);this.location.detach();const i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,a){this.activated=i,this._activatedRoute=a,this.location.insert(i.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){const i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,a){if(this.isActivated)throw new M.vHH(4013,!1);this._activatedRoute=i;const h=this.location,x=i.snapshot.component,S=this.parentContexts.getOrCreateContext(this.name).children,L=new qF(i,S,h.injector);this.activated=h.createComponent(x,{index:h.length,injector:L,environmentInjector:a??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[M.TTD]})}return o})();class qF{constructor(n,i,a){this.route=n,this.childContexts=i,this.parent=a}get(n,i){return n===nT?this.route:n===sS?this.childContexts:this.parent.get(n,i)}}const SA=new M.OlP("");let SR=(()=>{class o{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(i){this.unsubscribeFromRouteData(i),this.subscribeToRouteData(i)}unsubscribeFromRouteData(i){this.outletDataSubscriptions.get(i)?.unsubscribe(),this.outletDataSubscriptions.delete(i)}subscribeToRouteData(i){const{activatedRoute:a}=i,h=FD([a.queryParams,a.params,a.data]).pipe((0,Ll.w)(([_,x,S],L)=>(S={..._,...x,...S},0===L?(0,Nr.of)(S):Promise.resolve(S)))).subscribe(_=>{if(!i.isActivated||!i.activatedComponentRef||i.activatedRoute!==a||null===a.component)return void this.unsubscribeFromRouteData(i);const x=(0,M.qFp)(a.component);if(x)for(const{templateName:S}of x.inputs)i.activatedComponentRef.setInput(S,_[S]);else this.unsubscribeFromRouteData(i)});this.outletDataSubscriptions.set(i,h)}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();function aS(o,n,i){if(i&&o.shouldReuseRoute(n.value,i.value.snapshot)){const a=i.value;a._futureSnapshot=n.value;const h=function WF(o,n,i){return n.children.map(a=>{for(const h of i.children)if(o.shouldReuseRoute(a.value,h.value.snapshot))return aS(o,a,h);return aS(o,a)})}(o,n,i);return new o0(a,h)}{if(o.shouldAttach(n.value)){const _=o.retrieve(n.value);if(null!==_){const x=_.route;return x.value._futureSnapshot=n.value,x.children=n.children.map(S=>aS(o,S)),x}}const a=function KF(o){return new nT(new Lm.X(o.url),new Lm.X(o.params),new Lm.X(o.queryParams),new Lm.X(o.fragment),new Lm.X(o.data),o.outlet,o.component,o)}(n.value),h=n.children.map(_=>aS(o,_));return new o0(a,h)}}const e2="ngNavigationCancelingError";function AR(o,n){const{redirectTo:i,navigationBehaviorOptions:a}=ZM(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,h=DR(!1,0,n);return h.url=i,h.navigationBehaviorOptions=a,h}function DR(o,n,i){const a=new Error("NavigationCancelingError: "+(o||""));return a[e2]=!0,a.cancellationCode=n,i&&(a.url=i),a}function kR(o){return o&&o[e2]}let RR=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["ng-component"]],standalone:!0,features:[M.jDz],decls:1,vars:0,template:function(a,h){1&a&&M._UZ(0,"router-outlet")},dependencies:[t2],encapsulation:2})}return o})();function n2(o){const n=o.children&&o.children.map(n2),i=n?{...o,children:n}:{...o};return!i.component&&!i.loadComponent&&(n||i.loadChildren)&&i.outlet&&i.outlet!==di&&(i.component=RR),i}function Nm(o){return o.outlet||di}function lS(o){if(!o)return null;if(o.routeConfig?._injector)return o.routeConfig._injector;for(let n=o.parent;n;n=n.parent){const i=n.routeConfig;if(i?._loadedInjector)return i._loadedInjector;if(i?._injector)return i._injector}return null}class r5{constructor(n,i,a,h,_){this.routeReuseStrategy=n,this.futureState=i,this.currState=a,this.forwardEvent=h,this.inputBindingEnabled=_}activate(n){const i=this.futureState._root,a=this.currState?this.currState._root:null;this.deactivateChildRoutes(i,a,n),QD(this.futureState.root),this.activateChildRoutes(i,a,n)}deactivateChildRoutes(n,i,a){const h=eT(i);n.children.forEach(_=>{const x=_.value.outlet;this.deactivateRoutes(_,h[x],a),delete h[x]}),Object.values(h).forEach(_=>{this.deactivateRouteAndItsChildren(_,a)})}deactivateRoutes(n,i,a){const h=n.value,_=i?i.value:null;if(h===_)if(h.component){const x=a.getContext(h.outlet);x&&this.deactivateChildRoutes(n,i,x.children)}else this.deactivateChildRoutes(n,i,a);else _&&this.deactivateRouteAndItsChildren(i,a)}deactivateRouteAndItsChildren(n,i){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,i):this.deactivateRouteAndOutlet(n,i)}detachAndStoreRouteSubtree(n,i){const a=i.getContext(n.value.outlet),h=a&&n.value.component?a.children:i,_=eT(n);for(const x of Object.keys(_))this.deactivateRouteAndItsChildren(_[x],h);if(a&&a.outlet){const x=a.outlet.detach(),S=a.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:x,route:n,contexts:S})}}deactivateRouteAndOutlet(n,i){const a=i.getContext(n.value.outlet),h=a&&n.value.component?a.children:i,_=eT(n);for(const x of Object.keys(_))this.deactivateRouteAndItsChildren(_[x],h);a&&(a.outlet&&(a.outlet.deactivate(),a.children.onOutletDeactivated()),a.attachRef=null,a.route=null)}activateChildRoutes(n,i,a){const h=eT(i);n.children.forEach(_=>{this.activateRoutes(_,h[_.value.outlet],a),this.forwardEvent(new jF(_.value.snapshot))}),n.children.length&&this.forwardEvent(new UF(n.value.snapshot))}activateRoutes(n,i,a){const h=n.value,_=i?i.value:null;if(QD(h),h===_)if(h.component){const x=a.getOrCreateContext(h.outlet);this.activateChildRoutes(n,i,x.children)}else this.activateChildRoutes(n,i,a);else if(h.component){const x=a.getOrCreateContext(h.outlet);if(this.routeReuseStrategy.shouldAttach(h.snapshot)){const S=this.routeReuseStrategy.retrieve(h.snapshot);this.routeReuseStrategy.store(h.snapshot,null),x.children.onOutletReAttached(S.contexts),x.attachRef=S.componentRef,x.route=S.route.value,x.outlet&&x.outlet.attach(S.componentRef,S.route.value),QD(S.route.value),this.activateChildRoutes(n,null,x.children)}else{const S=lS(h.snapshot);x.attachRef=null,x.route=h,x.injector=S,x.outlet&&x.outlet.activateWith(h,x.injector),this.activateChildRoutes(n,null,x.children)}}else this.activateChildRoutes(n,null,a)}}class LR{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class AA{constructor(n,i){this.component=n,this.route=i}}function i5(o,n,i){const a=o._root;return cS(a,n?n._root:null,i,[a.value])}function rT(o,n){const i=Symbol(),a=n.get(o,i);return a===i?"function"!=typeof o||(0,M.Z0I)(o)?n.get(o):o:a}function cS(o,n,i,a,h={canDeactivateChecks:[],canActivateChecks:[]}){const _=eT(n);return o.children.forEach(x=>{(function s5(o,n,i,a,h={canDeactivateChecks:[],canActivateChecks:[]}){const _=o.value,x=n?n.value:null,S=i?i.getContext(o.value.outlet):null;if(x&&_.routeConfig===x.routeConfig){const L=function a5(o,n,i){if("function"==typeof i)return i(o,n);switch(i){case"pathParamsChange":return!qM(o.url,n.url);case"pathParamsOrQueryParamsChange":return!qM(o.url,n.url)||!By(o.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!JD(o,n)||!By(o.queryParams,n.queryParams);default:return!JD(o,n)}}(x,_,_.routeConfig.runGuardsAndResolvers);L?h.canActivateChecks.push(new LR(a)):(_.data=x.data,_._resolvedData=x._resolvedData),cS(o,n,_.component?S?S.children:null:i,a,h),L&&S&&S.outlet&&S.outlet.isActivated&&h.canDeactivateChecks.push(new AA(S.outlet.component,x))}else x&&uS(n,S,h),h.canActivateChecks.push(new LR(a)),cS(o,null,_.component?S?S.children:null:i,a,h)})(x,_[x.value.outlet],i,a.concat([x.value]),h),delete _[x.value.outlet]}),Object.entries(_).forEach(([x,S])=>uS(S,i.getContext(x),h)),h}function uS(o,n,i){const a=eT(o),h=o.value;Object.entries(a).forEach(([_,x])=>{uS(x,h.component?n?n.children.getContext(_):null:n,i)}),i.canDeactivateChecks.push(new AA(h.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,h))}function dS(o){return"function"==typeof o}function NR(o){return o instanceof vA||"EmptyError"===o?.name}const DA=Symbol("INITIAL_VALUE");function iT(){return(0,Ll.w)(o=>FD(o.map(n=>n.pipe(XO(1),function X3(...o){const n=(0,Qe.yG)(o);return(0,ig.e)((i,a)=>{(n?zD(o,i,n):zD(o,i)).subscribe(a)})}(DA)))).pipe((0,ln.U)(n=>{for(const i of n)if(!0!==i){if(i===DA)return DA;if(!1===i||i instanceof JO)return i}return!0}),Ny(n=>n!==DA),XO(1)))}function FR(o){return(0,Y3.z)((0,nu.b)(n=>{if(ZM(n))throw AR(0,n)}),(0,ln.U)(n=>!0===n))}class kA{constructor(n){this.segmentGroup=n||null}}class zR{constructor(n){this.urlTree=n}}function oT(o){return XI(new kA(o))}function BR(o){return XI(new zR(o))}class O5{constructor(n,i){this.urlSerializer=n,this.urlTree=i}noMatchError(n){return new M.vHH(4002,!1)}lineralizeSegments(n,i){let a=[],h=i.root;for(;;){if(a=a.concat(h.segments),0===h.numberOfChildren)return(0,Nr.of)(a);if(h.numberOfChildren>1||!h.children[di])return XI(new M.vHH(4e3,!1));h=h.children[di]}}applyRedirectCommands(n,i,a){return this.applyRedirectCreateUrlTree(i,this.urlSerializer.parse(i),n,a)}applyRedirectCreateUrlTree(n,i,a,h){const _=this.createSegmentGroup(n,i.root,a,h);return new JO(_,this.createQueryParams(i.queryParams,this.urlTree.queryParams),i.fragment)}createQueryParams(n,i){const a={};return Object.entries(n).forEach(([h,_])=>{if("string"==typeof _&&_.startsWith(":")){const S=_.substring(1);a[h]=i[S]}else a[h]=_}),a}createSegmentGroup(n,i,a,h){const _=this.createSegments(n,i.segments,a,h);let x={};return Object.entries(i.children).forEach(([S,L])=>{x[S]=this.createSegmentGroup(n,L,a,h)}),new Ao(_,x)}createSegments(n,i,a,h){return i.map(_=>_.path.startsWith(":")?this.findPosParam(n,_,h):this.findOrReturn(_,a))}findPosParam(n,i,a){const h=a[i.path.substring(1)];if(!h)throw new M.vHH(4001,!1);return h}findOrReturn(n,i){let a=0;for(const h of i){if(h.path===n.path)return i.splice(a),h;a++}return n}}const r2={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function T5(o,n,i,a,h){const _=i2(o,n,i);return _.matched?(a=function XF(o,n){return o.providers&&!o._injector&&(o._injector=(0,M.MMx)(o.providers,n,`Route: ${o.path}`)),o._injector??n}(n,a),function M5(o,n,i,a){const h=n.canMatch;if(!h||0===h.length)return(0,Nr.of)(!0);const _=h.map(x=>{const S=rT(x,o);return cw(function f5(o){return o&&dS(o.canMatch)}(S)?S.canMatch(n,i):o.runInContext(()=>S(n,i)))});return(0,Nr.of)(_).pipe(iT(),FR())}(a,n,i).pipe((0,ln.U)(x=>!0===x?_:{...r2}))):(0,Nr.of)(_)}function i2(o,n,i){if(""===n.path)return"full"===n.pathMatch&&(o.hasChildren()||i.length>0)?{...r2}:{matched:!0,consumedSegments:[],remainingSegments:i,parameters:{},positionalParamSegments:{}};const h=(n.matcher||sF)(i,o,n);if(!h)return{...r2};const _={};Object.entries(h.posParams??{}).forEach(([S,L])=>{_[S]=L.path});const x=h.consumed.length>0?{..._,...h.consumed[h.consumed.length-1].parameters}:_;return{matched:!0,consumedSegments:h.consumed,remainingSegments:i.slice(h.consumed.length),parameters:x,positionalParamSegments:h.posParams??{}}}function UR(o,n,i,a){return i.length>0&&function A5(o,n,i){return i.some(a=>RA(o,n,a)&&Nm(a)!==di)}(o,i,a)?{segmentGroup:new Ao(n,S5(a,new Ao(i,o.children))),slicedSegments:[]}:0===i.length&&function D5(o,n,i){return i.some(a=>RA(o,n,a))}(o,i,a)?{segmentGroup:new Ao(o.segments,I5(o,0,i,a,o.children)),slicedSegments:i}:{segmentGroup:new Ao(o.segments,o.children),slicedSegments:i}}function I5(o,n,i,a,h){const _={};for(const x of a)if(RA(o,i,x)&&!h[Nm(x)]){const S=new Ao([],{});_[Nm(x)]=S}return{...h,..._}}function S5(o,n){const i={};i[di]=n;for(const a of o)if(""===a.path&&Nm(a)!==di){const h=new Ao([],{});i[Nm(a)]=h}return i}function RA(o,n,i){return(!(o.hasChildren()||n.length>0)||"full"!==i.pathMatch)&&""===i.path}class N5{constructor(n,i,a,h,_,x,S){this.injector=n,this.configLoader=i,this.rootComponentType=a,this.config=h,this.urlTree=_,this.paramsInheritanceStrategy=x,this.urlSerializer=S,this.allowRedirects=!0,this.applyRedirects=new O5(this.urlSerializer,this.urlTree)}noMatchError(n){return new M.vHH(4002,!1)}recognize(){const n=UR(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,di).pipe(HM(i=>{if(i instanceof zR)return this.allowRedirects=!1,this.urlTree=i.urlTree,this.match(i.urlTree);throw i instanceof kA?this.noMatchError(i):i}),(0,ln.U)(i=>{const a=new IA([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},di,this.rootComponentType,null,{}),h=new o0(a,i),_=new TR("",h),x=function EF(o,n,i=null,a=null){return mR(gR(o),n,i,a)}(a,[],this.urlTree.queryParams,this.urlTree.fragment);return x.queryParams=this.urlTree.queryParams,_.url=this.urlSerializer.serialize(x),this.inheritParamsAndData(_._root),{state:_,tree:x}}))}match(n){return this.processSegmentGroup(this.injector,this.config,n.root,di).pipe(HM(a=>{throw a instanceof kA?this.noMatchError(a):a}))}inheritParamsAndData(n){const i=n.value,a=OR(i,this.paramsInheritanceStrategy);i.params=Object.freeze(a.params),i.data=Object.freeze(a.data),n.children.forEach(h=>this.inheritParamsAndData(h))}processSegmentGroup(n,i,a,h){return 0===a.segments.length&&a.hasChildren()?this.processChildren(n,i,a):this.processSegment(n,i,a,a.segments,h,!0)}processChildren(n,i,a){const h=[];for(const _ of Object.keys(a.children))"primary"===_?h.unshift(_):h.push(_);return(0,Nt.D)(h).pipe(WO(_=>{const x=a.children[_],S=function e5(o,n){const i=o.filter(a=>Nm(a)===n);return i.push(...o.filter(a=>Nm(a)!==n)),i}(i,_);return this.processSegmentGroup(n,S,x,_)}),function tF(o,n){return(0,ig.e)(function J3(o,n,i,a,h){return(_,x)=>{let S=i,L=n,B=0;_.subscribe((0,nr.x)(x,H=>{const Y=B++;L=S?o(L,H,Y):(S=!0,H),a&&x.next(L)},h&&(()=>{S&&x.next(L),x.complete()})))}}(o,n,arguments.length>=2,!0))}((_,x)=>(_.push(...x),_)),bA(null),function eF(o,n){const i=arguments.length>=2;return a=>a.pipe(o?Ny((h,_)=>o(h,_,a)):yA.y,VD(1),i?bA(n):nR(()=>new vA))}(),(0,sd.z)(_=>{if(null===_)return oT(a);const x=VR(_);return function F5(o){o.sort((n,i)=>n.value.outlet===di?-1:i.value.outlet===di?1:n.value.outlet.localeCompare(i.value.outlet))}(x),(0,Nr.of)(x)}))}processSegment(n,i,a,h,_,x){return(0,Nt.D)(i).pipe(WO(S=>this.processSegmentAgainstRoute(S._injector??n,i,S,a,h,_,x).pipe(HM(L=>{if(L instanceof kA)return(0,Nr.of)(null);throw L}))),lw(S=>!!S),HM(S=>{if(NR(S))return function R5(o,n,i){return 0===n.length&&!o.children[i]}(a,h,_)?(0,Nr.of)([]):oT(a);throw S}))}processSegmentAgainstRoute(n,i,a,h,_,x,S){return function k5(o,n,i,a){return!!(Nm(o)===a||a!==di&&RA(n,i,o))&&("**"===o.path||i2(n,o,i).matched)}(a,h,_,x)?void 0===a.redirectTo?this.matchSegmentAgainstRoute(n,h,a,_,x,S):S&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,h,i,a,_,x):oT(h):oT(h)}expandSegmentAgainstRouteUsingRedirect(n,i,a,h,_,x){return"**"===h.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,a,h,x):this.expandRegularSegmentAgainstRouteUsingRedirect(n,i,a,h,_,x)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,i,a,h){const _=this.applyRedirects.applyRedirectCommands([],a.redirectTo,{});return a.redirectTo.startsWith("/")?BR(_):this.applyRedirects.lineralizeSegments(a,_).pipe((0,sd.z)(x=>{const S=new Ao(x,{});return this.processSegment(n,i,S,x,h,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,i,a,h,_,x){const{matched:S,consumedSegments:L,remainingSegments:B,positionalParamSegments:H}=i2(i,h,_);if(!S)return oT(i);const Y=this.applyRedirects.applyRedirectCommands(L,h.redirectTo,H);return h.redirectTo.startsWith("/")?BR(Y):this.applyRedirects.lineralizeSegments(h,Y).pipe((0,sd.z)(pt=>this.processSegment(n,a,i,pt.concat(B),x,!1)))}matchSegmentAgainstRoute(n,i,a,h,_,x){let S;if("**"===a.path){const L=h.length>0?iR(h).parameters:{},B=new IA(h,L,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,jR(a),Nm(a),a.component??a._loadedComponent??null,a,$R(a));S=(0,Nr.of)({snapshot:B,consumedSegments:[],remainingSegments:[]}),i.children={}}else S=T5(i,a,h,n).pipe((0,ln.U)(({matched:L,consumedSegments:B,remainingSegments:H,parameters:Y})=>L?{snapshot:new IA(B,Y,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,jR(a),Nm(a),a.component??a._loadedComponent??null,a,$R(a)),consumedSegments:B,remainingSegments:H}:null));return S.pipe((0,Ll.w)(L=>null===L?oT(i):this.getChildConfig(n=a._injector??n,a,h).pipe((0,Ll.w)(({routes:B})=>{const H=a._loadedInjector??n,{snapshot:Y,consumedSegments:pt,remainingSegments:xt}=L,{segmentGroup:At,slicedSegments:Ut}=UR(i,pt,xt,B);if(0===Ut.length&&At.hasChildren())return this.processChildren(H,B,At).pipe((0,ln.U)(qe=>null===qe?null:[new o0(Y,qe)]));if(0===B.length&&0===Ut.length)return(0,Nr.of)([new o0(Y,[])]);const Zt=Nm(a)===_;return this.processSegment(H,B,At,Ut,Zt?di:_,!0).pipe((0,ln.U)(qe=>[new o0(Y,qe)]))}))))}getChildConfig(n,i,a){return i.children?(0,Nr.of)({routes:i.children,injector:n}):i.loadChildren?void 0!==i._loadedRoutes?(0,Nr.of)({routes:i._loadedRoutes,injector:i._loadedInjector}):function C5(o,n,i,a){const h=n.canLoad;if(void 0===h||0===h.length)return(0,Nr.of)(!0);const _=h.map(x=>{const S=rT(x,o);return cw(function c5(o){return o&&dS(o.canLoad)}(S)?S.canLoad(n,i):o.runInContext(()=>S(n,i)))});return(0,Nr.of)(_).pipe(iT(),FR())}(n,i,a).pipe((0,sd.z)(h=>h?this.configLoader.loadChildren(n,i).pipe((0,nu.b)(_=>{i._loadedRoutes=_.routes,i._loadedInjector=_.injector})):function E5(o){return XI(DR(!1,3))}())):(0,Nr.of)({routes:[],injector:n})}}function z5(o){const n=o.value.routeConfig;return n&&""===n.path}function VR(o){const n=[],i=new Set;for(const a of o){if(!z5(a)){n.push(a);continue}const h=n.find(_=>a.value.routeConfig===_.value.routeConfig);void 0!==h?(h.children.push(...a.children),i.add(h)):n.push(a)}for(const a of i){const h=VR(a.children);n.push(new o0(a.value,h))}return n.filter(a=>!i.has(a))}function jR(o){return o.data||{}}function $R(o){return o.resolve||{}}function GR(o){return"string"==typeof o.title||null===o.title}function o2(o){return(0,Ll.w)(n=>{const i=o(n);return i?(0,Nt.D)(i).pipe((0,ln.U)(()=>n)):(0,Nr.of)(n)})}const sT=new M.OlP("ROUTES");let s2=(()=>{class o{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,M.f3M)(M.Sil)}loadComponent(i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return(0,Nr.of)(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);const a=cw(i.loadComponent()).pipe((0,ln.U)(HR),(0,nu.b)(_=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=_}),ZI(()=>{this.componentLoaders.delete(i)})),h=new eR(a,()=>new zy.x).pipe(UD());return this.componentLoaders.set(i,h),h}loadChildren(i,a){if(this.childrenLoaders.get(a))return this.childrenLoaders.get(a);if(a._loadedRoutes)return(0,Nr.of)({routes:a._loadedRoutes,injector:a._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(a);const _=function H5(o,n,i,a){return cw(o.loadChildren()).pipe((0,ln.U)(HR),(0,sd.z)(h=>h instanceof M.YKP||Array.isArray(h)?(0,Nr.of)(h):(0,Nt.D)(n.compileModuleAsync(h))),(0,ln.U)(h=>{a&&a(o);let _,x,S=!1;return Array.isArray(h)?(x=h,!0):(_=h.create(i).injector,x=_.get(sT,[],{optional:!0,self:!0}).flat()),{routes:x.map(n2),injector:_}}))}(a,this.compiler,i,this.onLoadEndListener).pipe(ZI(()=>{this.childrenLoaders.delete(a)})),x=new eR(_,()=>new zy.x).pipe(UD());return this.childrenLoaders.set(a,x),x}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function HR(o){return function q5(o){return o&&"object"==typeof o&&"default"in o}(o)?o.default:o}let LA=(()=>{class o{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new zy.x,this.transitionAbortSubject=new zy.x,this.configLoader=(0,M.f3M)(s2),this.environmentInjector=(0,M.f3M)(M.lqb),this.urlSerializer=(0,M.f3M)(tS),this.rootContexts=(0,M.f3M)(sS),this.inputBindingEnabled=null!==(0,M.f3M)(SA,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,Nr.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=h=>this.events.next(new zF(h)),this.configLoader.onLoadStartListener=h=>this.events.next(new FF(h))}complete(){this.transitions?.complete()}handleNavigationRequest(i){const a=++this.navigationId;this.transitions?.next({...this.transitions.value,...i,id:a})}setupNavigations(i,a,h){return this.transitions=new Lm.X({id:0,currentUrlTree:a,currentRawUrl:a,currentBrowserUrl:a,extractedUrl:i.urlHandlingStrategy.extract(a),urlAfterRedirects:i.urlHandlingStrategy.extract(a),rawUrl:a,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:iS,restoredState:null,currentSnapshot:h.snapshot,targetSnapshot:null,currentRouterState:h,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ny(_=>0!==_.id),(0,ln.U)(_=>({..._,extractedUrl:i.urlHandlingStrategy.extract(_.rawUrl)})),(0,Ll.w)(_=>{this.currentTransition=_;let x=!1,S=!1;return(0,Nr.of)(_).pipe((0,nu.b)(L=>{this.currentNavigation={id:L.id,initialUrl:L.rawUrl,extractedUrl:L.extractedUrl,trigger:L.source,extras:L.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Ll.w)(L=>{const B=L.currentBrowserUrl.toString(),H=!i.navigated||L.extractedUrl.toString()!==B||B!==L.currentUrlTree.toString();if(!H&&"reload"!==(L.extras.onSameUrlNavigation??i.onSameUrlNavigation)){const pt="";return this.events.next(new tT(L.id,this.urlSerializer.serialize(L.rawUrl),pt,0)),L.resolve(null),aw.E}if(i.urlHandlingStrategy.shouldProcessUrl(L.rawUrl))return(0,Nr.of)(L).pipe((0,Ll.w)(pt=>{const xt=this.transitions?.getValue();return this.events.next(new OA(pt.id,this.urlSerializer.serialize(pt.extractedUrl),pt.source,pt.restoredState)),xt!==this.transitions?.getValue()?aw.E:Promise.resolve(pt)}),function B5(o,n,i,a,h,_){return(0,sd.z)(x=>function L5(o,n,i,a,h,_,x="emptyOnly"){return new N5(o,n,i,a,h,x,_).recognize()}(o,n,i,a,x.extractedUrl,h,_).pipe((0,ln.U)(({state:S,tree:L})=>({...x,targetSnapshot:S,urlAfterRedirects:L}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,i.config,this.urlSerializer,i.paramsInheritanceStrategy),(0,nu.b)(pt=>{_.targetSnapshot=pt.targetSnapshot,_.urlAfterRedirects=pt.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:pt.urlAfterRedirects};const xt=new wR(pt.id,this.urlSerializer.serialize(pt.extractedUrl),this.urlSerializer.serialize(pt.urlAfterRedirects),pt.targetSnapshot);this.events.next(xt)}));if(H&&i.urlHandlingStrategy.shouldProcessUrl(L.currentRawUrl)){const{id:pt,extractedUrl:xt,source:At,restoredState:Ut,extras:Zt}=L,qe=new OA(pt,this.urlSerializer.serialize(xt),At,Ut);this.events.next(qe);const fn=ER(0,this.rootComponentType).snapshot;return this.currentTransition=_={...L,targetSnapshot:fn,urlAfterRedirects:xt,extras:{...Zt,skipLocationChange:!1,replaceUrl:!1}},(0,Nr.of)(_)}{const pt="";return this.events.next(new tT(L.id,this.urlSerializer.serialize(L.extractedUrl),pt,1)),L.resolve(null),aw.E}}),(0,nu.b)(L=>{const B=new kF(L.id,this.urlSerializer.serialize(L.extractedUrl),this.urlSerializer.serialize(L.urlAfterRedirects),L.targetSnapshot);this.events.next(B)}),(0,ln.U)(L=>(this.currentTransition=_={...L,guards:i5(L.targetSnapshot,L.currentSnapshot,this.rootContexts)},_)),function g5(o,n){return(0,sd.z)(i=>{const{targetSnapshot:a,currentSnapshot:h,guards:{canActivateChecks:_,canDeactivateChecks:x}}=i;return 0===x.length&&0===_.length?(0,Nr.of)({...i,guardsResult:!0}):function m5(o,n,i,a){return(0,Nt.D)(o).pipe((0,sd.z)(h=>function w5(o,n,i,a,h){const _=n&&n.routeConfig?n.routeConfig.canDeactivate:null;if(!_||0===_.length)return(0,Nr.of)(!0);const x=_.map(S=>{const L=lS(n)??h,B=rT(S,L);return cw(function h5(o){return o&&dS(o.canDeactivate)}(B)?B.canDeactivate(o,n,i,a):L.runInContext(()=>B(o,n,i,a))).pipe(lw())});return(0,Nr.of)(x).pipe(iT())}(h.component,h.route,i,n,a)),lw(h=>!0!==h,!0))}(x,a,h,o).pipe((0,sd.z)(S=>S&&function l5(o){return"boolean"==typeof o}(S)?function _5(o,n,i,a){return(0,Nt.D)(n).pipe(WO(h=>zD(function v5(o,n){return null!==o&&n&&n(new BF(o)),(0,Nr.of)(!0)}(h.route.parent,a),function y5(o,n){return null!==o&&n&&n(new VF(o)),(0,Nr.of)(!0)}(h.route,a),function x5(o,n,i){const a=n[n.length-1],_=n.slice(0,n.length-1).reverse().map(x=>function o5(o){const n=o.routeConfig?o.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:o,guards:n}:null}(x)).filter(x=>null!==x).map(x=>tR(()=>{const S=x.guards.map(L=>{const B=lS(x.node)??i,H=rT(L,B);return cw(function d5(o){return o&&dS(o.canActivateChild)}(H)?H.canActivateChild(a,o):B.runInContext(()=>H(a,o))).pipe(lw())});return(0,Nr.of)(S).pipe(iT())}));return(0,Nr.of)(_).pipe(iT())}(o,h.path,i),function b5(o,n,i){const a=n.routeConfig?n.routeConfig.canActivate:null;if(!a||0===a.length)return(0,Nr.of)(!0);const h=a.map(_=>tR(()=>{const x=lS(n)??i,S=rT(_,x);return cw(function u5(o){return o&&dS(o.canActivate)}(S)?S.canActivate(n,o):x.runInContext(()=>S(n,o))).pipe(lw())}));return(0,Nr.of)(h).pipe(iT())}(o,h.route,i))),lw(h=>!0!==h,!0))}(a,_,o,n):(0,Nr.of)(S)),(0,ln.U)(S=>({...i,guardsResult:S})))})}(this.environmentInjector,L=>this.events.next(L)),(0,nu.b)(L=>{if(_.guardsResult=L.guardsResult,ZM(L.guardsResult))throw AR(0,L.guardsResult);const B=new RF(L.id,this.urlSerializer.serialize(L.extractedUrl),this.urlSerializer.serialize(L.urlAfterRedirects),L.targetSnapshot,!!L.guardsResult);this.events.next(B)}),Ny(L=>!!L.guardsResult||(this.cancelNavigationTransition(L,"",3),!1)),o2(L=>{if(L.guards.canActivateChecks.length)return(0,Nr.of)(L).pipe((0,nu.b)(B=>{const H=new LF(B.id,this.urlSerializer.serialize(B.extractedUrl),this.urlSerializer.serialize(B.urlAfterRedirects),B.targetSnapshot);this.events.next(H)}),(0,Ll.w)(B=>{let H=!1;return(0,Nr.of)(B).pipe(function U5(o,n){return(0,sd.z)(i=>{const{targetSnapshot:a,guards:{canActivateChecks:h}}=i;if(!h.length)return(0,Nr.of)(i);let _=0;return(0,Nt.D)(h).pipe(WO(x=>function V5(o,n,i,a){const h=o.routeConfig,_=o._resolve;return void 0!==h?.title&&!GR(h)&&(_[QI]=h.title),function j5(o,n,i,a){const h=function $5(o){return[...Object.keys(o),...Object.getOwnPropertySymbols(o)]}(o);if(0===h.length)return(0,Nr.of)({});const _={};return(0,Nt.D)(h).pipe((0,sd.z)(x=>function G5(o,n,i,a){const h=lS(n)??a,_=rT(o,h);return cw(_.resolve?_.resolve(n,i):h.runInContext(()=>_(n,i)))}(o[x],n,i,a).pipe(lw(),(0,nu.b)(S=>{_[x]=S}))),VD(1),function nF(o){return(0,ln.U)(()=>o)}(_),HM(x=>NR(x)?aw.E:XI(x)))}(_,o,n,a).pipe((0,ln.U)(x=>(o._resolvedData=x,o.data=OR(o,i).resolve,h&&GR(h)&&(o.data[QI]=h.title),null)))}(x.route,a,o,n)),(0,nu.b)(()=>_++),VD(1),(0,sd.z)(x=>_===h.length?(0,Nr.of)(i):aw.E))})}(i.paramsInheritanceStrategy,this.environmentInjector),(0,nu.b)({next:()=>H=!0,complete:()=>{H||this.cancelNavigationTransition(B,"",2)}}))}),(0,nu.b)(B=>{const H=new NF(B.id,this.urlSerializer.serialize(B.extractedUrl),this.urlSerializer.serialize(B.urlAfterRedirects),B.targetSnapshot);this.events.next(H)}))}),o2(L=>{const B=H=>{const Y=[];H.routeConfig?.loadComponent&&!H.routeConfig._loadedComponent&&Y.push(this.configLoader.loadComponent(H.routeConfig).pipe((0,nu.b)(pt=>{H.component=pt}),(0,ln.U)(()=>{})));for(const pt of H.children)Y.push(...B(pt));return Y};return FD(B(L.targetSnapshot.root)).pipe(bA(),XO(1))}),o2(()=>this.afterPreactivation()),(0,ln.U)(L=>{const B=function ZF(o,n,i){const a=aS(o,n._root,i?i._root:void 0);return new PR(a,n)}(i.routeReuseStrategy,L.targetSnapshot,L.currentRouterState);return this.currentTransition=_={...L,targetRouterState:B},_}),(0,nu.b)(()=>{this.events.next(new ZD)}),((o,n,i,a)=>(0,ln.U)(h=>(new r5(n,h.targetRouterState,h.currentRouterState,i,a).activate(o),h)))(this.rootContexts,i.routeReuseStrategy,L=>this.events.next(L),this.inputBindingEnabled),XO(1),(0,nu.b)({next:L=>{x=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new uw(L.id,this.urlSerializer.serialize(L.extractedUrl),this.urlSerializer.serialize(L.urlAfterRedirects))),i.titleStrategy?.updateTitle(L.targetRouterState.snapshot),L.resolve(!0)},complete:()=>{x=!0}}),function iF(o){return(0,ig.e)((n,i)=>{(0,En.Xf)(o).subscribe((0,nr.x)(i,()=>i.complete(),rF.Z)),!i.closed&&n.subscribe(i)})}(this.transitionAbortSubject.pipe((0,nu.b)(L=>{throw L}))),ZI(()=>{x||S||this.cancelNavigationTransition(_,"",1),this.currentNavigation?.id===_.id&&(this.currentNavigation=null)}),HM(L=>{if(S=!0,kR(L))this.events.next(new oS(_.id,this.urlSerializer.serialize(_.extractedUrl),L.message,L.cancellationCode)),function YF(o){return kR(o)&&ZM(o.url)}(L)?this.events.next(new WD(L.url)):_.resolve(!1);else{this.events.next(new TA(_.id,this.urlSerializer.serialize(_.extractedUrl),L,_.targetSnapshot??void 0));try{_.resolve(i.errorHandler(L))}catch(B){_.reject(B)}}return aw.E}))}))}cancelNavigationTransition(i,a,h){const _=new oS(i.id,this.urlSerializer.serialize(i.extractedUrl),a,h);this.events.next(_),i.resolve(!1)}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function qR(o){return o!==iS}let ZR=(()=>{class o{buildTitle(i){let a,h=i.root;for(;void 0!==h;)a=this.getResolvedTitleForRoute(h)??a,h=h.children.find(_=>_.outlet===di);return a}getResolvedTitleForRoute(i){return i.data[QI]}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:function(){return(0,M.f3M)(Z5)},providedIn:"root"})}return o})(),Z5=(()=>{class o extends ZR{constructor(i){super(),this.title=i}updateTitle(i){const a=this.buildTitle(i);void 0!==a&&this.title.setTitle(a)}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(Sc))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),W5=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:function(){return(0,M.f3M)(Y5)},providedIn:"root"})}return o})();class K5{shouldDetach(n){return!1}store(n,i){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,i){return n.routeConfig===i.routeConfig}}let Y5=(()=>{class o extends K5{static#t=this.\u0275fac=function(){let i;return function(h){return(i||(i=M.n5z(o)))(h||o)}}();static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const NA=new M.OlP("",{providedIn:"root",factory:()=>({})});let X5=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:function(){return(0,M.f3M)(Q5)},providedIn:"root"})}return o})(),Q5=(()=>{class o{shouldProcessUrl(i){return!0}extract(i){return i}merge(i,a){return i}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var hS=function(o){return o[o.COMPLETE=0]="COMPLETE",o[o.FAILED=1]="FAILED",o[o.REDIRECTING=2]="REDIRECTING",o}(hS||{});function WR(o,n){o.events.pipe(Ny(i=>i instanceof uw||i instanceof oS||i instanceof TA||i instanceof tT),(0,ln.U)(i=>i instanceof uw||i instanceof tT?hS.COMPLETE:i instanceof oS&&(0===i.code||1===i.code)?hS.REDIRECTING:hS.FAILED),Ny(i=>i!==hS.REDIRECTING),XO(1)).subscribe(()=>{n()})}function J5(o){throw o}function tz(o,n,i){return n.parse("/")}const ez={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},nz={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ru=(()=>{class o{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,M.f3M)(M.c2e),this.isNgZoneEnabled=!1,this._events=new zy.x,this.options=(0,M.f3M)(NA,{optional:!0})||{},this.pendingTasks=(0,M.f3M)(M.HDt),this.errorHandler=this.options.errorHandler||J5,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||tz,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,M.f3M)(X5),this.routeReuseStrategy=(0,M.f3M)(W5),this.titleStrategy=(0,M.f3M)(ZR),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,M.f3M)(sT,{optional:!0})?.flat()??[],this.navigationTransitions=(0,M.f3M)(LA),this.urlSerializer=(0,M.f3M)(tS),this.location=(0,M.f3M)(rn),this.componentInputBindingEnabled=!!(0,M.f3M)(SA,{optional:!0}),this.eventsSubscription=new BD.w0,this.isNgZoneEnabled=(0,M.f3M)(M.R0b)instanceof M.R0b&&M.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new JO,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=ER(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(i=>{this.lastSuccessfulId=i.id,this.currentPageId=this.browserPageId},i=>{this.console.warn(`Unhandled Navigation Error: ${i}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const i=this.navigationTransitions.events.subscribe(a=>{try{const{currentTransition:h}=this.navigationTransitions;if(null===h)return void(KR(a)&&this._events.next(a));if(a instanceof OA)qR(h.source)&&(this.browserUrlTree=h.extractedUrl);else if(a instanceof tT)this.rawUrlTree=h.rawUrl;else if(a instanceof wR){if("eager"===this.urlUpdateStrategy){if(!h.extras.skipLocationChange){const _=this.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl);this.setBrowserUrl(_,h)}this.browserUrlTree=h.urlAfterRedirects}}else if(a instanceof ZD)this.currentUrlTree=h.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl),this.routerState=h.targetRouterState,"deferred"===this.urlUpdateStrategy&&(h.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,h),this.browserUrlTree=h.urlAfterRedirects);else if(a instanceof oS)0!==a.code&&1!==a.code&&(this.navigated=!0),(3===a.code||2===a.code)&&this.restoreHistory(h);else if(a instanceof WD){const _=this.urlHandlingStrategy.merge(a.url,h.currentRawUrl),x={skipLocationChange:h.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||qR(h.source)};this.scheduleNavigation(_,iS,null,x,{resolve:h.resolve,reject:h.reject,promise:h.promise})}a instanceof TA&&this.restoreHistory(h,!0),a instanceof uw&&(this.navigated=!0),KR(a)&&this._events.next(a)}catch(h){this.navigationTransitions.transitionAbortSubject.next(h)}});this.eventsSubscription.add(i)}resetRootComponentType(i){this.routerState.root.component=i,this.navigationTransitions.rootComponentType=i}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const i=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),iS,i)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(i=>{const a="popstate"===i.type?"popstate":"hashchange";"popstate"===a&&setTimeout(()=>{this.navigateToSyncWithBrowser(i.url,a,i.state)},0)}))}navigateToSyncWithBrowser(i,a,h){const _={replaceUrl:!0},x=h?.navigationId?h:null;if(h){const L={...h};delete L.navigationId,delete L.\u0275routerPageId,0!==Object.keys(L).length&&(_.state=L)}const S=this.parseUrl(i);this.scheduleNavigation(S,a,x,_)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(i){this.config=i.map(n2),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(i,a={}){const{relativeTo:h,queryParams:_,fragment:x,queryParamsHandling:S,preserveFragment:L}=a,B=L?this.currentUrlTree.fragment:x;let Y,H=null;switch(S){case"merge":H={...this.currentUrlTree.queryParams,..._};break;case"preserve":H=this.currentUrlTree.queryParams;break;default:H=_||null}null!==H&&(H=this.removeEmptyProps(H));try{Y=gR(h?h.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof i[0]||!i[0].startsWith("/"))&&(i=[]),Y=this.currentUrlTree.root}return mR(Y,i,H,B??null)}navigateByUrl(i,a={skipLocationChange:!1}){const h=ZM(i)?i:this.parseUrl(i),_=this.urlHandlingStrategy.merge(h,this.rawUrlTree);return this.scheduleNavigation(_,iS,null,a)}navigate(i,a={skipLocationChange:!1}){return function rz(o){for(let n=0;n<o.length;n++)if(null==o[n])throw new M.vHH(4008,!1)}(i),this.navigateByUrl(this.createUrlTree(i,a),a)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){let a;try{a=this.urlSerializer.parse(i)}catch(h){a=this.malformedUriErrorHandler(h,this.urlSerializer,i)}return a}isActive(i,a){let h;if(h=!0===a?{...ez}:!1===a?{...nz}:a,ZM(i))return sR(this.currentUrlTree,i,h);const _=this.parseUrl(i);return sR(this.currentUrlTree,_,h)}removeEmptyProps(i){return Object.keys(i).reduce((a,h)=>{const _=i[h];return null!=_&&(a[h]=_),a},{})}scheduleNavigation(i,a,h,_,x){if(this.disposed)return Promise.resolve(!1);let S,L,B;x?(S=x.resolve,L=x.reject,B=x.promise):B=new Promise((Y,pt)=>{S=Y,L=pt});const H=this.pendingTasks.add();return WR(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(H))}),this.navigationTransitions.handleNavigationRequest({source:a,restoredState:h,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:i,extras:_,resolve:S,reject:L,promise:B,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),B.catch(Y=>Promise.reject(Y))}setBrowserUrl(i,a){const h=this.urlSerializer.serialize(i);if(this.location.isCurrentPathEqualTo(h)||a.extras.replaceUrl){const x={...a.extras.state,...this.generateNgRouterState(a.id,this.browserPageId)};this.location.replaceState(h,"",x)}else{const _={...a.extras.state,...this.generateNgRouterState(a.id,this.browserPageId+1)};this.location.go(h,"",_)}}restoreHistory(i,a=!1){if("computed"===this.canceledNavigationResolution){const _=this.currentPageId-this.browserPageId;0!==_?this.location.historyGo(_):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===_&&(this.resetState(i),this.browserUrlTree=i.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(a&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=i.currentRouterState,this.currentUrlTree=i.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(i,a){return"computed"===this.canceledNavigationResolution?{navigationId:i,\u0275routerPageId:a}:{navigationId:i}}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function KR(o){return!(o instanceof ZD||o instanceof WD)}let fS=(()=>{class o{constructor(i,a,h,_,x,S){this.router=i,this.route=a,this.tabIndexAttribute=h,this.renderer=_,this.el=x,this.locationStrategy=S,this.href=null,this.commands=null,this.onChanges=new zy.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const L=x.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===L||"area"===L,this.isAnchorElement?this.subscription=i.events.subscribe(B=>{B instanceof uw&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(i){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",i)}ngOnChanges(i){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(i){null!=i?(this.commands=Array.isArray(i)?i:[i],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(i,a,h,_,x){return!!(null===this.urlTree||this.isAnchorElement&&(0!==i||a||h||_||x||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const i=null===this.href?null:(0,M.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(i,a){const h=this.renderer,_=this.el.nativeElement;null!==a?h.setAttribute(_,i,a):h.removeAttribute(_,i)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(ru),M.Y36(nT),M.$8M("tabindex"),M.Y36(M.Qsj),M.Y36(M.SBq),M.Y36(Le))};static#e=this.\u0275dir=M.lG2({type:o,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(a,h){1&a&&M.NdJ("click",function(x){return h.onClick(x.button,x.ctrlKey,x.shiftKey,x.altKey,x.metaKey)}),2&a&&M.uIk("target",h.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",M.VuI],skipLocationChange:["skipLocationChange","skipLocationChange",M.VuI],replaceUrl:["replaceUrl","replaceUrl",M.VuI],routerLink:"routerLink"},standalone:!0,features:[M.Xq5,M.TTD]})}return o})();class YR{}let sz=(()=>{class o{constructor(i,a,h,_,x){this.router=i,this.injector=h,this.preloadingStrategy=_,this.loader=x}setUpPreloading(){this.subscription=this.router.events.pipe(Ny(i=>i instanceof uw),WO(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(i,a){const h=[];for(const _ of a){_.providers&&!_._injector&&(_._injector=(0,M.MMx)(_.providers,i,`Route: ${_.path}`));const x=_._injector??i,S=_._loadedInjector??x;(_.loadChildren&&!_._loadedRoutes&&void 0===_.canLoad||_.loadComponent&&!_._loadedComponent)&&h.push(this.preloadConfig(x,_)),(_.children||_._loadedRoutes)&&h.push(this.processRoutes(S,_.children??_._loadedRoutes))}return(0,Nt.D)(h).pipe((0,YI.J)())}preloadConfig(i,a){return this.preloadingStrategy.preload(a,()=>{let h;h=a.loadChildren&&void 0===a.canLoad?this.loader.loadChildren(i,a):(0,Nr.of)(null);const _=h.pipe((0,sd.z)(x=>null===x?(0,Nr.of)(void 0):(a._loadedRoutes=x.routes,a._loadedInjector=x.injector,this.processRoutes(x.injector??i,x.routes))));if(a.loadComponent&&!a._loadedComponent){const x=this.loader.loadComponent(a);return(0,Nt.D)([_,x]).pipe((0,YI.J)())}return _})}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(ru),M.LFG(M.Sil),M.LFG(M.lqb),M.LFG(YR),M.LFG(s2))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const a2=new M.OlP("");let XR=(()=>{class o{constructor(i,a,h,_,x={}){this.urlSerializer=i,this.transitions=a,this.viewportScroller=h,this.zone=_,this.options=x,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},x.scrollPositionRestoration=x.scrollPositionRestoration||"disabled",x.anchorScrolling=x.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof OA?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=i.navigationTrigger,this.restoredId=i.restoredState?i.restoredState.navigationId:0):i instanceof uw?(this.lastId=i.id,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.urlAfterRedirects).fragment)):i instanceof tT&&0===i.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(i,this.urlSerializer.parse(i.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(i=>{i instanceof CR&&(i.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(i.position):i.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(i.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(i,a){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new CR(i,"popstate"===this.lastSource?this.store[this.restoredId]:null,a))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#t=this.\u0275fac=function(a){M.$Z()};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();function s0(o,n){return{\u0275kind:o,\u0275providers:n}}function JR(){const o=(0,M.f3M)(M.zs3);return n=>{const i=o.get(M.z2F);if(n!==i.components[0])return;const a=o.get(ru),h=o.get(tL);1===o.get(l2)&&a.initialNavigation(),o.get(eL,null,M.XFs.Optional)?.setUpPreloading(),o.get(a2,null,M.XFs.Optional)?.init(),a.resetRootComponentType(i.componentTypes[0]),h.closed||(h.next(),h.complete(),h.unsubscribe())}}const tL=new M.OlP("",{factory:()=>new zy.x}),l2=new M.OlP("",{providedIn:"root",factory:()=>1}),eL=new M.OlP("");function uz(o){return s0(0,[{provide:eL,useExisting:sz},{provide:YR,useExisting:o}])}const nL=new M.OlP("ROUTER_FORROOT_GUARD"),hz=[rn,{provide:tS,useClass:jD},ru,sS,{provide:nT,useFactory:function QR(o){return o.routerState.root},deps:[ru]},s2,[]];function fz(){return new M.PXZ("Router",ru)}let rL=(()=>{class o{constructor(i){}static forRoot(i,a){return{ngModule:o,providers:[hz,[],{provide:sT,multi:!0,useValue:i},{provide:nL,useFactory:_z,deps:[[ru,new M.FiY,new M.tp0]]},{provide:NA,useValue:a||{}},a?.useHash?{provide:Le,useClass:We}:{provide:Le,useClass:tn},{provide:a2,useFactory:()=>{const o=(0,M.f3M)(Cc),n=(0,M.f3M)(M.R0b),i=(0,M.f3M)(NA),a=(0,M.f3M)(LA),h=(0,M.f3M)(tS);return i.scrollOffset&&o.setOffset(i.scrollOffset),new XR(h,a,o,n,i)}},a?.preloadingStrategy?uz(a.preloadingStrategy).\u0275providers:[],{provide:M.PXZ,multi:!0,useFactory:fz},a?.initialNavigation?yz(a):[],a?.bindToComponentInputs?s0(8,[SR,{provide:SA,useExisting:SR}]).\u0275providers:[],[{provide:iL,useFactory:JR},{provide:M.tb,multi:!0,useExisting:iL}]]}}static forChild(i){return{ngModule:o,providers:[{provide:sT,multi:!0,useValue:i}]}}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(nL,8))};static#e=this.\u0275mod=M.oAB({type:o});static#n=this.\u0275inj=M.cJS({})}return o})();function _z(o){return"guarded"}function yz(o){return["disabled"===o.initialNavigation?s0(3,[{provide:M.ip1,multi:!0,useFactory:()=>{const n=(0,M.f3M)(ru);return()=>{n.setUpLocationChangeListener()}}},{provide:l2,useValue:2}]).\u0275providers:[],"enabledBlocking"===o.initialNavigation?s0(2,[{provide:l2,useValue:0},{provide:M.ip1,multi:!0,deps:[M.zs3],useFactory:n=>{const i=n.get(ue,Promise.resolve());return()=>i.then(()=>new Promise(a=>{const h=n.get(ru),_=n.get(tL);WR(h,()=>{a(!0)}),n.get(LA).afterPreactivation=()=>(a(!0),_.closed?(0,Nr.of)(void 0):_),h.initialNavigation()}))}}]).\u0275providers:[]]}const iL=new M.OlP("");var bz=ft(3019),FA=ft(3093),xz=ft(4552);class wz extends zy.x{constructor(n=1/0,i=1/0,a=xz.l){super(),this._bufferSize=n,this._windowTime=i,this._timestampProvider=a,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=i===1/0,this._bufferSize=Math.max(1,n),this._windowTime=Math.max(1,i)}next(n){const{isStopped:i,_buffer:a,_infiniteTimeWindow:h,_timestampProvider:_,_windowTime:x}=this;i||(a.push(n),!h&&a.push(_.now()+x)),this._trimBuffer(),super.next(n)}_subscribe(n){this._throwIfClosed(),this._trimBuffer();const i=this._innerSubscribe(n),{_infiniteTimeWindow:a,_buffer:h}=this,_=h.slice();for(let x=0;x<_.length&&!n.closed;x+=a?1:2)n.next(_[x]);return this._checkFinalizedStatuses(n),i}_trimBuffer(){const{_bufferSize:n,_timestampProvider:i,_buffer:a,_infiniteTimeWindow:h}=this,_=(h?1:2)*n;if(n<1/0&&_<a.length&&a.splice(0,a.length-_),!h){const x=i.now();let S=0;for(let L=1;L<a.length&&a[L]<=x;L+=2)S=L;S&&a.splice(0,S+1)}}}var Cz=ft(3020);function oL(o,n,i){let a,h=!1;return o&&"object"==typeof o?({bufferSize:a=1/0,windowTime:n=1/0,refCount:h=!1,scheduler:i}=o):a=o??1/0,(0,Cz.B)({connector:()=>new wz(a,n,i),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:h})}function sL(o,n){return(0,qI.m)(n)?(0,Ll.w)(()=>o,n):(0,Ll.w)(()=>o)}var c2=ft(5137);ft(120);const Pz=new M.OlP("angularfire2.auth.use-emulator"),Ez=new M.OlP("angularfire2.auth.settings"),Oz=new M.OlP("angularfire2.auth.tenant-id"),Tz=new M.OlP("angularfire2.auth.langugage-code"),Iz=new M.OlP("angularfire2.auth.use-device-language"),Sz=new M.OlP("angularfire.auth.persistence");let u2=(()=>{class o{constructor(i,a,h,_,x,S,L,B,H,Y,pt,xt){const At=new zy.x,Ut=(0,Nr.of)(void 0).pipe((0,FA.Q)(x.outsideAngular),(0,Ll.w)(()=>_.runOutsideAngular(()=>ft.e(661).then(ft.bind(ft,8661)))),(0,ln.U)(()=>(0,Ma.on)(i,_,a)),(0,ln.U)(Zt=>((o,n,i,a,h,_,x,S)=>(0,Ma.cc)(`${o.name}.auth`,"AngularFireAuth",o.name,()=>{const L=n.runOutsideAngular(()=>o.auth());if(i&&L.useEmulator(...i),a&&(L.tenantId=a),L.languageCode=h,_&&L.useDeviceLanguage(),x)for(const[B,H]of Object.entries(x))L.settings[B]=H;return S&&L.setPersistence(S),L},[i,a,h,_,x,S]))(Zt,_,S,B,H,Y,L,pt)),oL({bufferSize:1,refCount:!1}));if(Xo(h))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,Nr.of)(null);else{Ut.pipe(lw()).subscribe();const qe=Ut.pipe((0,Ll.w)(cn=>cn.getRedirectResult().then(Mr=>Mr,()=>null)),Wr.iC,oL({bufferSize:1,refCount:!1})),fn=Ut.pipe((0,Ll.w)(cn=>new $t.y(Mr=>({unsubscribe:_.runOutsideAngular(()=>cn.onAuthStateChanged(Cr=>Mr.next(Cr),Cr=>Mr.error(Cr),()=>Mr.complete()))})))),$e=Ut.pipe((0,Ll.w)(cn=>new $t.y(Mr=>({unsubscribe:_.runOutsideAngular(()=>cn.onIdTokenChanged(Cr=>Mr.next(Cr),Cr=>Mr.error(Cr),()=>Mr.complete()))}))));this.authState=qe.pipe(sL(fn),(0,c2.R)(x.outsideAngular),(0,FA.Q)(x.insideAngular)),this.user=qe.pipe(sL($e),(0,c2.R)(x.outsideAngular),(0,FA.Q)(x.insideAngular)),this.idToken=this.user.pipe((0,Ll.w)(cn=>cn?(0,Nt.D)(cn.getIdToken()):(0,Nr.of)(null))),this.idTokenResult=this.user.pipe((0,Ll.w)(cn=>cn?(0,Nt.D)(cn.getIdTokenResult()):(0,Nr.of)(null))),this.credential=(0,bz.T)(qe,At,this.authState.pipe(Ny(cn=>!cn))).pipe((0,ln.U)(cn=>cn?.user?cn:null),(0,c2.R)(x.outsideAngular),(0,FA.Q)(x.insideAngular))}return(0,Ma.pX)(this,Ut,_,{spy:{apply:(Zt,qe,fn)=>{(Zt.startsWith("signIn")||Zt.startsWith("createUser"))&&fn.then($e=>At.next($e))}}})}}return o.\u0275fac=function(i){return new(i||o)(M.LFG(Ma.Dh),M.LFG(Ma.xv,8),M.LFG(M.Lbi),M.LFG(M.R0b),M.LFG(Wr.HU),M.LFG(Pz,8),M.LFG(Ez,8),M.LFG(Oz,8),M.LFG(Tz,8),M.LFG(Iz,8),M.LFG(Sz,8),M.LFG(sn,8))},o.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"any"}),o})(),zA=(()=>{class o{constructor(i,a,h){this.firebaseAuthenticationService=i,this.router=a,this.ngZone=h,this.firebaseAuthenticationService.authState.subscribe(_=>{_?(this.userData=_,localStorage.setItem("user",JSON.stringify(this.userData))):localStorage.setItem("user","null")})}logInWithEmailAndPassword(i,a){return this.firebaseAuthenticationService.signInWithEmailAndPassword(i,a).then(h=>{this.userData=h.user,this.observeUserState()}).catch(h=>{let _="Hubo un error al iniciar sesi\xf3n con Google.";return("auth/user-not-found"===h.code||"auth/wrong-password"===h.code)&&(_="Usuario o contrase\xf1a incorrectos. Por favor, verifica tus credenciales."),_})}logInWithGoogleProvider(){return this.firebaseAuthenticationService.signInWithPopup(new rc.V).then(()=>this.observeUserState()).catch(i=>{let a="Hubo un error al iniciar sesi\xf3n con Google.";return("auth/user-not-found"===i.code||"auth/wrong-password"===i.code)&&(a="Usuario o contrase\xf1a incorrectos. Por favor, verifica tus credenciales."),a})}signUpWithEmailAndPassword(i,a){return this.firebaseAuthenticationService.createUserWithEmailAndPassword(i,a).then(h=>{this.userData=h.user,this.observeUserState()}).catch(h=>{let _="Hubo un error al iniciar sesi\xf3n con Google.";return("auth/user-not-found"===h.code||"auth/wrong-password"===h.code)&&(_="Usuario o contrase\xf1a incorrectos. Por favor, verifica tus credenciales."),_})}signUpWithGoogle(){return this.firebaseAuthenticationService.signInWithPopup(new rc.V).then(i=>{this.userData=i.user,this.observeUserState()}).catch(i=>{let a="Hubo un error al iniciar sesi\xf3n con Google.";return("auth/user-not-found"===i.code||"auth/wrong-password"===i.code)&&(a="Usuario o contrase\xf1a incorrectos. Por favor, verifica tus credenciales."),a})}observeUserState(){this.firebaseAuthenticationService.authState.subscribe(i=>{i&&this.ngZone.run(()=>this.router.navigate(["dashboard"]))})}get isLoggedIn(){return null!==JSON.parse(localStorage.getItem("user"))}logOut(){return this.firebaseAuthenticationService.signOut().then(()=>{localStorage.removeItem("user"),this.router.navigate([""])})}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(u2),M.LFG(ru),M.LFG(M.R0b))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Dz=(()=>{class o{constructor(i,a){this.authService=i,this.router=a,this.usuario="",this.contrasenia=""}iniciarSesion(){var i=this;return(0,Je.Z)(function*(){try{yield i.authService.logInWithEmailAndPassword(i.usuario,i.contrasenia)}catch(a){i.errorMessage="auth/user-not-found"===a.code?"Usuario no encontrado. Por favor, registra una cuenta.":"auth/wrong-password"===a.code?"Contrase\xf1a incorrecta. Por favor, int\xe9ntalo nuevamente.":"Ha ocurrido un error durante el inicio de sesi\xf3n. Por favor, int\xe9ntalo nuevamente m\xe1s tarde."}})()}iniciarSesionConGoogle(){this.authService.logInWithGoogleProvider()}regresarInicio(){this.router.navigate(["/"])}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(zA),M.Y36(ru))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-login"]],decls:32,vars:2,consts:[["rel","stylesheet","href","https://fonts.googleapis.com/icon?family=Material+Icons"],[1,"login-wrapper"],[1,"input-box"],["for","usuario"],["type","text","name","usuario","id","usuario","required","","placeholder","example@example.com",3,"ngModel","ngModelChange"],[1,"bx","bxs-user"],["for","contrasenia"],["type","password","name","contrasenia","id","contrasenia","required","","placeholder","Enter your password",3,"ngModel","ngModelChange"],[1,"bx","bxs-lock-alt"],["type","button",1,"btn",3,"click"],["type","button",1,"google-btn",3,"click"],[1,"google-icon"],["src","https://www.svgrepo.com/show/475656/google-color.svg","alt","google logo"],[1,"google-text"],[1,"register-link"],["routerLink","/sign-up"],[1,"back-button",3,"click"],[1,"material-icons"]],template:function(a,h){1&a&&(M.TgZ(0,"head"),M._UZ(1,"link",0),M.qZA(),M.TgZ(2,"body")(3,"div",1)(4,"h1"),M._uU(5,"Sing in"),M.qZA(),M.TgZ(6,"div",2)(7,"label",3),M._uU(8,"Your email"),M.qZA(),M.TgZ(9,"input",4),M.NdJ("ngModelChange",function(x){return h.usuario=x}),M.qZA(),M._UZ(10,"i",5),M.qZA(),M.TgZ(11,"div",2)(12,"label",6),M._uU(13,"Password"),M.qZA(),M.TgZ(14,"input",7),M.NdJ("ngModelChange",function(x){return h.contrasenia=x}),M.qZA(),M._UZ(15,"i",8),M.qZA(),M.TgZ(16,"button",9),M.NdJ("click",function(){return h.iniciarSesion()}),M._uU(17,"Sing in"),M.qZA(),M.TgZ(18,"button",10),M.NdJ("click",function(){return h.iniciarSesionConGoogle()}),M.TgZ(19,"div",11),M._UZ(20,"img",12),M.qZA(),M.TgZ(21,"span",13),M._uU(22,"Sing in with google"),M.qZA()(),M.TgZ(23,"div",14)(24,"p"),M._uU(25,"You do not have an account? "),M.TgZ(26,"a",15),M._uU(27,"Sing up for TripTrove"),M.qZA()()()(),M.TgZ(28,"button",16),M.NdJ("click",function(){return h.regresarInicio()}),M.TgZ(29,"span",17),M._uU(30,"arrow_back_ios_new"),M.qZA(),M._uU(31," Return "),M.qZA()()),2&a&&(M.xp6(9),M.Q6J("ngModel",h.usuario),M.xp6(5),M.Q6J("ngModel",h.contrasenia))},dependencies:[fS,Gr,GO,HI,ZO],styles:["body[_ngcontent-%COMP%]{background-image:url(fondoLogin.2db4eed342a65978.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;font-family:Arial,sans-serif;margin:0;padding:0;display:flex;justify-content:flex-start;align-items:center;height:100vh;overflow:hidden}.login-wrapper[_ngcontent-%COMP%]{max-width:600px;padding:20px;margin:20%;border:1px solid #85858577;border-radius:11px;box-shadow:0 0 10px #0000003f;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)}.back-button[_ngcontent-%COMP%]{position:absolute;top:2%;right:0;z-index:9999;display:flex;align-items:center;padding:5px,;border:none;border-radius:4px;cursor:pointer;color:#000;font-size:150%;font-weight:700}.back-button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{margin-right:5px}.login-wrapper[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{align-self:center;justify-self:center}.input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:silver}.google-text[_ngcontent-%COMP%]{margin-top:auto}.google-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.input-box[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%], .google-btn[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:700}input[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%], .google-btn[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #757575;border-radius:4px;box-sizing:border-box;cursor:pointer;text-align:center}.google-btn[_ngcontent-%COMP%]{display:flex;align-items:center}.google-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px;margin-right:10px}.back-button[_ngcontent-%COMP%]{padding:5px 10px;border:none;border-radius:4px;cursor:pointer;color:#000}.register-link[_ngcontent-%COMP%]{margin-top:10px}@media (max-width: 600px){.login-wrapper[_ngcontent-%COMP%]{max-width:100%}}"]})}return o})(),kz=(()=>{class o{constructor(i,a){this.authService=i,this.router=a,this.email="",this.password=""}signUp(){var i=this;return(0,Je.Z)(function*(){try{yield i.authService.signUpWithEmailAndPassword(i.email,i.password)}catch(a){i.errorMessage="auth/email-already-in-use"===a.code?"Este correo electr\xf3nico ya est\xe1 en uso. Por favor, utiliza otro correo.":"auth/weak-password"===a.code?"La contrase\xf1a es d\xe9bil. Por favor, utiliza una contrase\xf1a m\xe1s segura.":"Ha ocurrido un error durante el registro. Por favor, int\xe9ntalo nuevamente m\xe1s tarde."}})()}registerWithGoogle(){this.authService.signUpWithGoogle()}goBack(){this.router.navigate(["/"])}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(zA),M.Y36(ru))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-sign-up"]],decls:30,vars:2,consts:[["rel","stylesheet","href","https://fonts.googleapis.com/icon?family=Material+Icons"],[1,"login-wrapper"],[1,"input-box"],["for","email"],["type","email","name","email","id","email","required","",3,"ngModel","ngModelChange"],["for","password"],["type","password","name","password","id","password","required","",3,"ngModel","ngModelChange"],["type","button",1,"btn",3,"click"],["type","button",1,"google-btn",3,"click"],[1,"google-icon"],["src","https://www.svgrepo.com/show/475656/google-color.svg","alt","google logo"],[1,"register-link"],["routerLink","/login"],[1,"back-button",3,"click"],[1,"material-icons"]],template:function(a,h){1&a&&(M.TgZ(0,"head"),M._UZ(1,"link",0),M.qZA(),M.TgZ(2,"body")(3,"div",1)(4,"h1"),M._uU(5,"Sign Up"),M.qZA(),M.TgZ(6,"div",2)(7,"label",3),M._uU(8,"Your email"),M.qZA(),M.TgZ(9,"input",4),M.NdJ("ngModelChange",function(x){return h.email=x}),M.qZA()(),M.TgZ(10,"div",2)(11,"label",5),M._uU(12,"Password"),M.qZA(),M.TgZ(13,"input",6),M.NdJ("ngModelChange",function(x){return h.password=x}),M.qZA()(),M.TgZ(14,"button",7),M.NdJ("click",function(){return h.signUp()}),M._uU(15,"Sign Up"),M.qZA(),M.TgZ(16,"button",8),M.NdJ("click",function(){return h.registerWithGoogle()}),M.TgZ(17,"div",9),M._UZ(18,"img",10),M.qZA(),M.TgZ(19,"span"),M._uU(20,"Sign Up with Google"),M.qZA()(),M.TgZ(21,"div",11)(22,"p"),M._uU(23,"Already have an account? "),M.TgZ(24,"a",12),M._uU(25,"Log In"),M.qZA()()(),M.TgZ(26,"button",13),M.NdJ("click",function(){return h.goBack()}),M.TgZ(27,"span",14),M._uU(28,"arrow_back_ios_new"),M.qZA(),M._uU(29," Volver "),M.qZA()()()),2&a&&(M.xp6(9),M.Q6J("ngModel",h.email),M.xp6(4),M.Q6J("ngModel",h.password))},dependencies:[fS,Gr,GO,HI,ZO],styles:["body[_ngcontent-%COMP%]{background-image:url(fondoLogin.2db4eed342a65978.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;font-family:Arial,sans-serif;margin:0;padding:0;max-height:100vh;overflow:hidden}.login-wrapper[_ngcontent-%COMP%]{height:700px;max-width:400px;margin:200px auto;padding:20px;border:1px solid #ccc;border-radius:11px;box-shadow:0 0 10px #0000003f;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)}.login-wrapper[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{align-self:center;justify-self:center}.input-box[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%], .google-btn[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:700}input[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%], .google-btn[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box;cursor:pointer;text-align:center}.google-btn[_ngcontent-%COMP%]{display:flex;align-items:center}.google-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px;margin-right:10px}.back-button[_ngcontent-%COMP%]{background-color:#000;padding:5px 10px;border:none;border-radius:4px;cursor:pointer;color:#fff}.register-link[_ngcontent-%COMP%]{margin-top:10px}@media (max-width: 600px){.login-wrapper[_ngcontent-%COMP%]{max-width:100%}}"]})}return o})();const pS_apiKey="pk.eyJ1IjoibmFodW1sb3B6IiwiYSI6ImNsc3k2eGRlejBhYXIycm54YmxnaXlneTkifQ.wrnk_DcsIDYJ6a8OQSeE5Q",pS_firebase={projectId:"triptroveangular",appId:"1:424821813680:web:8e62cec178c0ffc4972675",storageBucket:"triptroveangular.appspot.com",apiKey:"AIzaSyA9r2Hn3Qoc7EaCkG0q9LVIGj_N6UluTZ4",authDomain:"triptroveangular.firebaseapp.com",messagingSenderId:"424821813680",measurementId:"G-JB2EZRFDDX"};let Rz=(()=>{class o extends mA{constructor(i){super(i),this.baseUrl="https://api.mapbox.com/directions/v5/mapbox"}get(i){return super.get(i=this.baseUrl+i,{params:{alternatives:!0,geometries:"geojson",language:"es",overview:"simplified",steps:!0,access_token:pS_apiKey}})}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG($M))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Lz=(()=>{class o extends mA{constructor(i){super(i),this.baseUrl="https://api.mapbox.com/geocoding/v5/mapbox.places"}get(i,a){i=`${this.baseUrl}${i}`;const h={limit:4,language:"es",access_token:pS_apiKey,...a.params};return h.bbox="-99.3269,19.1056,-98.5636,19.7039",super.get(i,{params:h})}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG($M))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var a0=ft(2574),aL=ft.n(a0);let Nz=(()=>{class o extends mA{constructor(i){super(i),this.baseUrl="https://api.mapbox.com/directions/v5/mapbox"}get(i){return super.get(i=this.baseUrl+i,{params:{contours_colors:"005a32",polygons:"true",denoise:"1",generalize:"500",access_token:pS_apiKey}})}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG($M))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),gS=(()=>{class o{get isMapReady(){return!!this.map}constructor(i,a){this.directionsApi=i,this.distanceApi=a,this.markers=[],this.stepsAsString=""}setMap(i){this.map=i}flyTo(i){if(!this.isMapReady)throw Error("El mapa  no esta inicializado");this.map?.flyTo({zoom:16,pitch:40,essential:!0,center:i})}createMarkersFromPlaces(i,a){if(!this.map)throw Error("Mapa no inicializado");this.markers.forEach(x=>x.remove());const h=[];for(const x of i){const[S,L]=x.center,B=(new a0.Popup).setHTML(`<h6>${x.text}</h6><br><span>${x.place_name}</span>`),H=(new a0.Marker).setLngLat([S,L]).setPopup(B).addTo(this.map);h.push(H)}if(this.markers=h,0==i.length)return;const _=new a0.LngLatBounds;h.forEach(x=>_.extend(x.getLngLat())),_.extend(a),this.map.fitBounds(_,{padding:200})}getRouteBetweenPoints(i,a,h){this.directionsApi.get(`/${i}/${a.join(",")};${h.join(",")}`).subscribe(_=>this.drawPolyline(_.routes[0]))}drawPolyline(i){const a=i.legs[0].steps;console.log("Instrucciones de la Ruta:");for(const S of a)console.log(S.maneuver.instruction);if(console.log({kms:i.distance/1e3,duration:i.duration/60}),!this.map)throw Error("Mapa no inicializado");const h=i.geometry.coordinates,_=new a0.LngLatBounds;h.forEach(([S,L])=>_.extend([S,L])),this.map?.fitBounds(_,{padding:200});const x={type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:h}}]}};this.map.getLayer("RouteString")&&(this.map.removeLayer("RouteString"),this.map.removeSource("RouteString")),this.map.addSource("RouteString",x),this.map.addLayer({id:"RouteString",type:"line",source:"RouteString",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"green","line-width":7}})}distancePolyline(i){if(!this.map)throw Error("Mapa no inicializado");const a=new a0.LngLatBounds;this.map?.fitBounds(a,{padding:200}),this.map.getLayer("RouteString")&&(this.map.removeLayer("RouteString"),this.map.removeSource("RouteString")),this.map.addLayer({id:"RouteString",type:"line",source:"RouteString",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"green","line-width":7}})}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(Rz),M.LFG(Nz))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),aT=(()=>{class o{get isUserLocationReady(){return!!this.userLocation}constructor(i,a){this.placesApi=i,this.mapService=a,this.isLoadingPlaces=!1,this.places=[],this.getUserLocation()}getUserLocation(){var i=this;return(0,Je.Z)(function*(){return new Promise((a,h)=>{navigator.geolocation.getCurrentPosition(({coords:_})=>{i.userLocation=[_.longitude,_.latitude],a(i.userLocation)},_=>{alert("No se pudo obtener la geolocalizaci\xf3n"),console.log(_),h(_)})})})()}getPlacesByQuery(i=""){if(0===i.length)return this.isLoadingPlaces=!1,void(this.places=[]);if(!this.userLocation)throw Error("No hay userLocation");this.isLoadingPlaces=!0,this.placesApi.get(`/${i}.json`,{params:{proximity:this.userLocation?.join(",")}}).subscribe(a=>{console.log(a.features[0]),this.isLoadingPlaces=!1,this.places=a.features,this.mapService.createMarkersFromPlaces(this.places,this.userLocation)})}upPlaces(){this.places=[]}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(Lz),M.LFG(gS))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();const lL="firebasestorage.googleapis.com",cL="storageBucket";class Gs extends $r.ZR{constructor(n,i,a=0){super(d2(n),`Firebase Storage: ${i} (${d2(n)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Gs.prototype)}get status(){return this.status_}set status(n){this.status_=n}_codeEquals(n){return d2(n)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(n){this.customData.serverResponse=n,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Ds=function(o){return o.UNKNOWN="unknown",o.OBJECT_NOT_FOUND="object-not-found",o.BUCKET_NOT_FOUND="bucket-not-found",o.PROJECT_NOT_FOUND="project-not-found",o.QUOTA_EXCEEDED="quota-exceeded",o.UNAUTHENTICATED="unauthenticated",o.UNAUTHORIZED="unauthorized",o.UNAUTHORIZED_APP="unauthorized-app",o.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",o.INVALID_CHECKSUM="invalid-checksum",o.CANCELED="canceled",o.INVALID_EVENT_NAME="invalid-event-name",o.INVALID_URL="invalid-url",o.INVALID_DEFAULT_BUCKET="invalid-default-bucket",o.NO_DEFAULT_BUCKET="no-default-bucket",o.CANNOT_SLICE_BLOB="cannot-slice-blob",o.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",o.NO_DOWNLOAD_URL="no-download-url",o.INVALID_ARGUMENT="invalid-argument",o.INVALID_ARGUMENT_COUNT="invalid-argument-count",o.APP_DELETED="app-deleted",o.INVALID_ROOT_OPERATION="invalid-root-operation",o.INVALID_FORMAT="invalid-format",o.INTERNAL_ERROR="internal-error",o.UNSUPPORTED_ENVIRONMENT="unsupported-environment",o}(Ds||{});function d2(o){return"storage/"+o}function h2(){return new Gs(Ds.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function f2(o){return new Gs(Ds.INVALID_ARGUMENT,o)}function fL(){return new Gs(Ds.APP_DELETED,"The Firebase app was deleted.")}function mS(o,n){return new Gs(Ds.INVALID_FORMAT,"String does not match format '"+o+"': "+n)}function _S(o){throw new Gs(Ds.INTERNAL_ERROR,"Internal error: "+o)}class ad{constructor(n,i){this.bucket=n,this.path_=i}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const n=encodeURIComponent;return"/b/"+n(this.bucket)+"/o/"+n(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(n,i){let a;try{a=ad.makeFromUrl(n,i)}catch{return new ad(n,"")}if(""===a.path)return a;throw function qz(o){return new Gs(Ds.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+o+"'.")}(n)}static makeFromUrl(n,i){let a=null;const h="([A-Za-z0-9.\\-_]+)",S=new RegExp("^gs://"+h+"(/(.*))?$","i");function B(cn){cn.path_=decodeURIComponent(cn.path)}const Y=i.replace(/[.]/g,"\\."),$e=[{regex:S,indices:{bucket:1,path:3},postModify:function _(cn){"/"===cn.path.charAt(cn.path.length-1)&&(cn.path_=cn.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${Y}/v[A-Za-z0-9_]+/b/${h}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:B},{regex:new RegExp(`^https?://${i===lL?"(?:storage.googleapis.com|storage.cloud.google.com)":i}/${h}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:B}];for(let cn=0;cn<$e.length;cn++){const Mr=$e[cn],Cr=Mr.regex.exec(n);if(Cr){let ks=Cr[Mr.indices.path];ks||(ks=""),a=new ad(Cr[Mr.indices.bucket],ks),Mr.postModify(a);break}}if(null==a)throw function Hz(o){return new Gs(Ds.INVALID_URL,"Invalid URL '"+o+"'.")}(n);return a}}class Qz{constructor(n){this.promise_=Promise.reject(n)}getPromise(){return this.promise_}cancel(n=!1){}}function BA(o){return"string"==typeof o||o instanceof String}function pL(o){return p2()&&o instanceof Blob}function p2(){return typeof Blob<"u"&&!(0,$r.UG)()}function g2(o,n,i,a){if(a<n)throw f2(`Invalid value for '${o}'. Expected ${n} or greater.`);if(a>i)throw f2(`Invalid value for '${o}'. Expected ${i} or less.`)}function l0(o,n,i){let a=n;return null==i&&(a=`https://${n}`),`${i}://${a}/v0${o}`}function gL(o){const n=encodeURIComponent;let i="?";for(const a in o)o.hasOwnProperty(a)&&(i=i+(n(a)+"=")+n(o[a])+"&");return i=i.slice(0,-1),i}var lT=function(o){return o[o.NO_ERROR=0]="NO_ERROR",o[o.NETWORK_ERROR=1]="NETWORK_ERROR",o[o.ABORT=2]="ABORT",o}(lT||{});class iB{constructor(n,i,a,h,_,x,S,L,B,H,Y,pt=!0){this.url_=n,this.method_=i,this.headers_=a,this.body_=h,this.successCodes_=_,this.additionalRetryCodes_=x,this.callback_=S,this.errorCallback_=L,this.timeout_=B,this.progressCallback_=H,this.connectionFactory_=Y,this.retry=pt,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((xt,At)=>{this.resolve_=xt,this.reject_=At,this.start_()})}start_(){const i=(a,h)=>{const _=this.resolve_,x=this.reject_,S=h.connection;if(h.wasSuccessCode)try{const L=this.callback_(S,S.getResponse());!function eB(o){return void 0!==o}(L)?_():_(L)}catch(L){x(L)}else if(null!==S){const L=h2();L.serverResponse=S.getErrorText(),x(this.errorCallback_?this.errorCallback_(S,L):L)}else x(h.canceled?this.appDelete_?fL():function dL(){return new Gs(Ds.CANCELED,"User canceled the upload/download.")}():function uL(){return new Gs(Ds.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}())};this.canceled_?i(0,new UA(!1,null,!0)):this.backoffId_=function Jz(o,n,i){let a=1,h=null,_=null,x=!1,S=0;function L(){return 2===S}let B=!1;function H(...Zt){B||(B=!0,n.apply(null,Zt))}function Y(Zt){h=setTimeout(()=>{h=null,o(xt,L())},Zt)}function pt(){_&&clearTimeout(_)}function xt(Zt,...qe){if(B)return void pt();if(Zt)return pt(),void H.call(null,Zt,...qe);if(L()||x)return pt(),void H.call(null,Zt,...qe);let $e;a<64&&(a*=2),1===S?(S=2,$e=0):$e=1e3*(a+Math.random()),Y($e)}let At=!1;function Ut(Zt){At||(At=!0,pt(),!B&&(null!==h?(Zt||(S=2),clearTimeout(h),Y(0)):Zt||(S=1)))}return Y(0),_=setTimeout(()=>{x=!0,Ut(!0)},i),Ut}((a,h)=>{if(h)return void a(!1,new UA(!1,null,!0));const _=this.connectionFactory_();this.pendingConnection_=_;const x=S=>{null!==this.progressCallback_&&this.progressCallback_(S.loaded,S.lengthComputable?S.total:-1)};null!==this.progressCallback_&&_.addUploadProgressListener(x),_.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&_.removeUploadProgressListener(x),this.pendingConnection_=null;const S=_.getErrorCode()===lT.NO_ERROR,L=_.getStatus();if(!S||function mL(o,n){const i=o>=500&&o<600,h=-1!==[408,429].indexOf(o),_=-1!==n.indexOf(o);return i||h||_}(L,this.additionalRetryCodes_)&&this.retry){const H=_.getErrorCode()===lT.ABORT;return void a(!1,new UA(!1,null,H))}const B=-1!==this.successCodes_.indexOf(L);a(!0,new UA(B,_))})},i,this.timeout_)}getPromise(){return this.promise_}cancel(n){this.canceled_=!0,this.appDelete_=n||!1,null!==this.backoffId_&&function tB(o){o(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class UA{constructor(n,i,a){this.wasSuccessCode=n,this.connection=i,this.canceled=!!a}}function dB(...o){const n=function uB(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==n){const i=new n;for(let a=0;a<o.length;a++)i.append(o[a]);return i.getBlob()}if(p2())return new Blob(o);throw new Gs(Ds.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const Fm={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class m2{constructor(n,i){this.data=n,this.contentType=i||null}}function yL(o){const n=[];for(let i=0;i<o.length;i++){let a=o.charCodeAt(i);a<=127?n.push(a):a<=2047?n.push(192|a>>6,128|63&a):55296==(64512&a)?i<o.length-1&&56320==(64512&o.charCodeAt(i+1))?(a=65536|(1023&a)<<10|1023&o.charCodeAt(++i),n.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a)):n.push(239,191,189):56320==(64512&a)?n.push(239,191,189):n.push(224|a>>12,128|a>>6&63,128|63&a)}return new Uint8Array(n)}function vL(o,n){switch(o){case Fm.BASE64:{const h=-1!==n.indexOf("-"),_=-1!==n.indexOf("_");if(h||_)throw mS(o,"Invalid character '"+(h?"-":"_")+"' found: is it base64url encoded?");break}case Fm.BASE64URL:{const h=-1!==n.indexOf("+"),_=-1!==n.indexOf("/");if(h||_)throw mS(o,"Invalid character '"+(h?"+":"/")+"' found: is it base64 encoded?");n=n.replace(/-/g,"+").replace(/_/g,"/");break}}let i;try{i=function fB(o){if(typeof atob>"u")throw function Yz(o){return new Gs(Ds.UNSUPPORTED_ENVIRONMENT,`${o} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(o)}(n)}catch(h){throw h.message.includes("polyfill")?h:mS(o,"Invalid character found")}const a=new Uint8Array(i.length);for(let h=0;h<i.length;h++)a[h]=i.charCodeAt(h);return a}class bL{constructor(n){this.base64=!1,this.contentType=null;const i=n.match(/^data:([^,]+)?,/);if(null===i)throw mS(Fm.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const a=i[1]||null;null!=a&&(this.base64=function _B(o,n){return o.length>=n.length&&o.substring(o.length-n.length)===n}(a,";base64"),this.contentType=this.base64?a.substring(0,a.length-7):a),this.rest=n.substring(n.indexOf(",")+1)}}class c0{constructor(n,i){let a=0,h="";pL(n)?(this.data_=n,a=n.size,h=n.type):n instanceof ArrayBuffer?(i?this.data_=new Uint8Array(n):(this.data_=new Uint8Array(n.byteLength),this.data_.set(new Uint8Array(n))),a=this.data_.length):n instanceof Uint8Array&&(i?this.data_=n:(this.data_=new Uint8Array(n.length),this.data_.set(n)),a=n.length),this.size_=a,this.type_=h}size(){return this.size_}type(){return this.type_}slice(n,i){if(pL(this.data_)){const h=function hB(o,n,i){return o.webkitSlice?o.webkitSlice(n,i):o.mozSlice?o.mozSlice(n,i):o.slice?o.slice(n,i):null}(this.data_,n,i);return null===h?null:new c0(h)}{const a=new Uint8Array(this.data_.buffer,n,i-n);return new c0(a,!0)}}static getBlob(...n){if(p2()){const i=n.map(a=>a instanceof c0?a.data_:a);return new c0(dB.apply(null,i))}{const i=n.map(x=>BA(x)?function _L(o,n){switch(o){case Fm.RAW:return new m2(yL(n));case Fm.BASE64:case Fm.BASE64URL:return new m2(vL(o,n));case Fm.DATA_URL:return new m2(function gB(o){const n=new bL(o);return n.base64?vL(Fm.BASE64,n.rest):function pB(o){let n;try{n=decodeURIComponent(o)}catch{throw mS(Fm.DATA_URL,"Malformed data URL.")}return yL(n)}(n.rest)}(n),function mB(o){return new bL(o).contentType}(n))}throw h2()}(Fm.RAW,x).data:x.data_);let a=0;i.forEach(x=>{a+=x.byteLength});const h=new Uint8Array(a);let _=0;return i.forEach(x=>{for(let S=0;S<x.length;S++)h[_++]=x[S]}),new c0(h,!0)}}uploadData(){return this.data_}}function _2(o){let n;try{n=JSON.parse(o)}catch{return null}return function rB(o){return"object"==typeof o&&!Array.isArray(o)}(n)?n:null}function xL(o){const n=o.lastIndexOf("/",o.length-2);return-1===n?o:o.slice(n+1)}function bB(o,n){return n}class ld{constructor(n,i,a,h){this.server=n,this.local=i||n,this.writable=!!a,this.xform=h||bB}}let VA=null;function yS(){if(VA)return VA;const o=[];o.push(new ld("bucket")),o.push(new ld("generation")),o.push(new ld("metageneration")),o.push(new ld("name","fullPath",!0));const i=new ld("name");i.xform=function n(_,x){return function xB(o){return!BA(o)||o.length<2?o:xL(o)}(x)},o.push(i);const h=new ld("size");return h.xform=function a(_,x){return void 0!==x?Number(x):x},o.push(h),o.push(new ld("timeCreated")),o.push(new ld("updated")),o.push(new ld("md5Hash",null,!0)),o.push(new ld("cacheControl",null,!0)),o.push(new ld("contentDisposition",null,!0)),o.push(new ld("contentEncoding",null,!0)),o.push(new ld("contentLanguage",null,!0)),o.push(new ld("contentType",null,!0)),o.push(new ld("metadata","customMetadata",!0)),VA=o,VA}function wL(o,n,i){const a=_2(n);return null===a?null:function CB(o,n,i){const a={type:"file"},h=i.length;for(let _=0;_<h;_++){const x=i[_];a[x.local]=x.xform(a,n[x.server])}return function wB(o,n){Object.defineProperty(o,"ref",{get:function i(){const _=new ad(o.bucket,o.fullPath);return n._makeStorageReference(_)}})}(a,o),a}(o,a,i)}class Vy{constructor(n,i,a,h){this.url=n,this.method=i,this.handler=a,this.timeout=h,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function jy(o){if(!o)throw h2()}function cT(o){return function n(i,a){let h;return h=401===i.getStatus()?i.getErrorText().includes("Firebase App Check token is invalid")?function $z(){return new Gs(Ds.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function jz(){return new Gs(Ds.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===i.getStatus()?function Vz(o){return new Gs(Ds.QUOTA_EXCEEDED,"Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(o.bucket):403===i.getStatus()?function Gz(o){return new Gs(Ds.UNAUTHORIZED,"User does not have permission to access '"+o+"'.")}(o.path):a,h.status=i.getStatus(),h.serverResponse=a.serverResponse,h}}function TL(o,n,i,a,h){const _=n.bucketOnlyServerUrl(),x={"X-Goog-Upload-Protocol":"multipart"},L=function S(){let $e="";for(let cn=0;cn<2;cn++)$e+=Math.random().toString().slice(2);return $e}();x["Content-Type"]="multipart/related; boundary="+L;const B=function OL(o,n,i){const a=Object.assign({},i);return a.fullPath=o.path,a.size=n.size(),a.contentType||(a.contentType=function kB(o,n){return o&&o.contentType||n&&n.type()||"application/octet-stream"}(null,n)),a}(n,a,h),H=function y2(o,n){const i={},a=n.length;for(let h=0;h<a;h++){const _=n[h];_.writable&&(i[_.server]=o[_.local])}return JSON.stringify(i)}(B,i),xt=c0.getBlob("--"+L+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+H+"\r\n--"+L+"\r\nContent-Type: "+B.contentType+"\r\n\r\n",a,"\r\n--"+L+"--");if(null===xt)throw function hL(){return new Gs(Ds.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}();const At={name:B.fullPath},Ut=l0(_,o.host,o._protocol),qe=o.maxUploadRetryTime,fn=new Vy(Ut,"POST",function jA(o,n){return function i(a,h){const _=wL(o,h,n);return jy(null!==_),_}}(o,i),qe);return fn.urlParams=At,fn.headers=x,fn.body=xt.uploadData(),fn.errorHandler=cT(n),fn}let SL=null;class zB{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=lT.NO_ERROR,this.sendPromise_=new Promise(n=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=lT.ABORT,n()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=lT.NETWORK_ERROR,n()}),this.xhr_.addEventListener("load",()=>{n()})})}send(n,i,a,h){if(this.sent_)throw _S("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(i,n,!0),void 0!==h)for(const _ in h)h.hasOwnProperty(_)&&this.xhr_.setRequestHeader(_,h[_].toString());return void 0!==a?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw _S("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw _S("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw _S("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw _S("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(n){return this.xhr_.getResponseHeader(n)}addUploadProgressListener(n){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",n)}removeUploadProgressListener(n){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",n)}}class BB extends zB{initXhr(){this.xhr_.responseType="text"}}function zm(){return SL?SL():new BB}class WM{constructor(n,i){this._service=n,this._location=i instanceof ad?i:ad.makeFromUrl(i,n.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(n,i){return new WM(n,i)}get root(){const n=new ad(this._location.bucket,"");return this._newRef(this._service,n)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return xL(this._location.path)}get storage(){return this._service}get parent(){const n=function yB(o){if(0===o.length)return null;const n=o.lastIndexOf("/");return-1===n?"":o.slice(0,n)}(this._location.path);if(null===n)return null;const i=new ad(this._location.bucket,n);return new WM(this._service,i)}_throwIfRoot(n){if(""===this._location.path)throw function Xz(o){return new Gs(Ds.INVALID_ROOT_OPERATION,"The operation '"+o+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(n)}}function QB(o){o._throwIfRoot("getDownloadURL");const n=function SB(o,n,i){const h=l0(n.fullServerUrl(),o.host,o._protocol),x=o.maxOperationRetryTime,S=new Vy(h,"GET",function TB(o,n){return function i(a,h){const _=wL(o,h,n);return jy(null!==_),function MB(o,n,i,a){const h=_2(n);if(null===h||!BA(h.downloadTokens))return null;const _=h.downloadTokens;if(0===_.length)return null;const x=encodeURIComponent;return _.split(",").map(B=>{const Y=o.fullPath;return l0("/b/"+x(o.bucket)+"/o/"+x(Y),i,a)+gL({alt:"media",token:B})})[0]}(_,h,o.host,o._protocol)}}(o,i),x);return S.errorHandler=function vS(o){const n=cT(o);return function i(a,h){let _=n(a,h);return 404===a.getStatus()&&(_=function Uz(o){return new Gs(Ds.OBJECT_NOT_FOUND,"Object '"+o+"' does not exist.")}(o.path)),_.serverResponse=h.serverResponse,_}}(n),S}(o.storage,o._location,yS());return o.storage.makeRequestWithTokens(n,zm).then(i=>{if(null===i)throw function Kz(){return new Gs(Ds.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return i})}function LL(o,n){if(o instanceof w2){const i=o;if(null==i._bucket)throw function Zz(){return new Gs(Ds.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+cL+"' property when initializing the app?")}();const a=new WM(i,i._bucket);return null!=n?LL(a,n):a}return void 0!==n?function RL(o,n){const i=function vB(o,n){const i=n.split("/").filter(a=>a.length>0).join("/");return 0===o.length?i:o+"/"+i}(o._location.path,n),a=new ad(o._location.bucket,i);return new WM(o.storage,a)}(o,n):o}function NL(o,n){const i=n?.[cL];return null==i?null:ad.makeFromBucketSpec(i,o)}class w2{constructor(n,i,a,h,_){this.app=n,this._authProvider=i,this._appCheckProvider=a,this._url=h,this._firebaseVersion=_,this._bucket=null,this._host=lL,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=h?ad.makeFromBucketSpec(h,this._host):NL(this._host,this.app.options)}get host(){return this._host}set host(n){this._host=n,this._bucket=null!=this._url?ad.makeFromBucketSpec(this._url,n):NL(n,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(n){g2("time",0,Number.POSITIVE_INFINITY,n),this._maxUploadRetryTime=n}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(n){g2("time",0,Number.POSITIVE_INFINITY,n),this._maxOperationRetryTime=n}_getAuthToken(){var n=this;return(0,Je.Z)(function*(){if(n._overrideAuthToken)return n._overrideAuthToken;const i=n._authProvider.getImmediate({optional:!0});if(i){const a=yield i.getToken();if(null!==a)return a.accessToken}return null})()}_getAppCheckToken(){var n=this;return(0,Je.Z)(function*(){const i=n._appCheckProvider.getImmediate({optional:!0});return i?(yield i.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(n=>n.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(n){return new WM(this,n)}_makeRequest(n,i,a,h,_=!0){if(this._deleted)return new Qz(fL());{const x=function cB(o,n,i,a,h,_,x=!0){const S=gL(o.urlParams),L=o.url+S,B=Object.assign({},o.headers);return function aB(o,n){n&&(o["X-Firebase-GMPID"]=n)}(B,n),function oB(o,n){null!==n&&n.length>0&&(o.Authorization="Firebase "+n)}(B,i),function sB(o,n){o["X-Firebase-Storage-Version"]="webjs/"+(n??"AppManager")}(B,_),function lB(o,n){null!==n&&(o["X-Firebase-AppCheck"]=n)}(B,a),new iB(L,o.method,B,o.body,o.successCodes,o.additionalRetryCodes,o.handler,o.errorHandler,o.timeout,o.progressCallback,h,x)}(n,this._appId,a,h,i,this._firebaseVersion,_);return this._requests.add(x),x.getPromise().then(()=>this._requests.delete(x),()=>this._requests.delete(x)),x}}makeRequestWithTokens(n,i){var a=this;return(0,Je.Z)(function*(){const[h,_]=yield Promise.all([a._getAuthToken(),a._getAppCheckToken()]);return a._makeRequest(n,i,h,_).getPromise()})()}}const FL="@firebase/storage",BL="storage";function i4(o,n,i){return function AL(o,n,i){o._throwIfRoot("uploadBytes");const a=TL(o.storage,o._location,yS(),new c0(n,!0),i);return o.storage.makeRequestWithTokens(a,zm).then(h=>({metadata:h,ref:o}))}(o=(0,$r.m9)(o),n,i)}function o4(o){return QB(o=(0,$r.m9)(o))}function s4(o,n){return function n4(o,n){if(n&&function t4(o){return/^[A-Za-z]+:\/\//.test(o)}(n)){if(o instanceof w2)return function e4(o,n){return new WM(o,n)}(o,n);throw f2("To use ref(service, url), the first argument must be a Storage instance.")}return LL(o,n)}(o=(0,$r.m9)(o),n)}function a4(o=(0,ts.getApp)(),n){o=(0,$r.m9)(o);const a=(0,ts._getProvider)(o,BL).getImmediate({identifier:n}),h=(0,$r.P0)("storage");return h&&function l4(o,n,i,a={}){!function r4(o,n,i,a={}){o.host=`${n}:${i}`,o._protocol="http";const{mockUserToken:h}=a;h&&(o._overrideAuthToken="string"==typeof h?h:(0,$r.Sg)(h,o.app.options.projectId))}(o,n,i,a)}(a,...h),a}function c4(o,{instanceIdentifier:n}){const i=o.getProvider("app").getImmediate(),a=o.getProvider("auth-internal"),h=o.getProvider("app-check-internal");return new w2(i,a,h,n,ts.SDK_VERSION)}!function u4(){(0,ts._registerComponent)(new Pa.wA(BL,c4,"PUBLIC").setMultipleInstances(!0)),(0,ts.registerVersion)(FL,"0.11.2",""),(0,ts.registerVersion)(FL,"0.11.2","esm2017")}();const g4=(0,Wr.u3)(o4,!0),m4=(0,Wr.u3)(a4,!0),_4=(0,Wr.u3)(s4,!0),y4=(0,Wr.u3)(i4,!0);let P2=(()=>{class o{constructor(i){this.firestore=i,this.placesSubject=new zy.x,this.places$=this.placesSubject.asObservable(),this.subscribeToPlacesChanges()}addPlace(i){const a=II(this.firestore,"places");return zO(a,{...i,image:null})}subscribeToPlacesChanges(){const i=II(this.firestore,"places");T(i,a=>{const h=[];a.forEach(_=>{const x=_.data(),S={id:_.id,...x};h.push(S)}),this.placesSubject.next(h)})}deletePlace(i){const a=r(this.firestore,`places/${i.id}`);return FM(a)}uploadImage(i){return(0,Je.Z)(function*(){const a=m4(),h=_4(a,`images/${i.name}`);return yield y4(h,i),yield g4(h)})()}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(IM))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function v4(o,n){if(1&o&&(M.TgZ(0,"div")(1,"p"),M._uU(2),M.qZA()()),2&o){const i=M.oxw().$implicit;M.xp6(2),M.hij("Categor\xedas: ",i.categories.join(", "),"")}}function b4(o,n){1&o&&(M.TgZ(0,"div")(1,"p"),M._uU(2,"Sin categor\xedas"),M.qZA()())}const VL=function(o){return{backgroundImage:o}};function x4(o,n){if(1&o){const i=M.EpF();M.TgZ(0,"div",4),M.NdJ("click",function(){const _=M.CHM(i).$implicit,x=M.oxw(2);return M.KtG(x.showModal(_))}),M._UZ(1,"div",5),M.TgZ(2,"div",6)(3,"h4"),M._uU(4),M.qZA(),M.TgZ(5,"p"),M._uU(6),M.qZA(),M.YNc(7,v4,3,1,"div",7),M.YNc(8,b4,3,0,"div",7),M.qZA()()}if(2&o){const i=n.$implicit;M.xp6(1),M.Q6J("ngStyle",M.VKq(5,VL,"url("+i.imageURL+")")),M.xp6(3),M.Oqu(i.name),M.xp6(2),M.Oqu(i.description),M.xp6(1),M.Q6J("ngIf",i.categories&&i.categories.length>0),M.xp6(1),M.Q6J("ngIf",!i.categories||0===i.categories.length)}}function w4(o,n){if(1&o&&(M.TgZ(0,"div")(1,"h2"),M._uU(2),M.qZA(),M.TgZ(3,"div",2),M.YNc(4,x4,9,7,"div",3),M.qZA()()),2&o){const i=n.$implicit;M.xp6(2),M.Oqu(i.category),M.xp6(2),M.Q6J("ngForOf",i.places)}}function C4(o,n){if(1&o){const i=M.EpF();M.TgZ(0,"div",8),M.NdJ("click",function(){M.CHM(i);const h=M.oxw();return M.KtG(h.closeModal())}),M.TgZ(1,"div",9),M.NdJ("click",function(h){M.CHM(i);const _=M.oxw();return M.KtG(_.stopPropagation(h))}),M._UZ(2,"div",10),M.TgZ(3,"h2"),M._uU(4),M.qZA(),M.TgZ(5,"p"),M._uU(6),M.qZA(),M.TgZ(7,"button",11),M.NdJ("click",function(){M.CHM(i);const h=M.oxw();return M.KtG(h.closeModal())}),M._uU(8,"Cerrar"),M.qZA()()()}if(2&o){const i=M.oxw();M.xp6(2),M.Q6J("ngStyle",M.VKq(3,VL,"url("+i.selectedPlace.imageURL+")")),M.xp6(2),M.Oqu(i.selectedPlace.name),M.xp6(2),M.Oqu(i.selectedPlace.description)}}let M4=(()=>{class o{constructor(i){this.placesService=i,this.isModalOpen=!1,this.categorizedPlaces=[]}ngOnInit(){this.placesService.places$.subscribe(i=>{const a=new Map;i.forEach(h=>{h.categories&&h.categories.forEach(_=>{a.has(_)||a.set(_,[]),a.get(_)?.push(h)})}),this.categorizedPlaces=Array.from(a.entries()).map(([h,_])=>({category:h,places:_.slice(0,5)}))})}showModal(i){this.selectedPlace=i,this.isModalOpen=!0,document.body.style.overflow="hidden"}closeModal(){this.selectedPlace=null,this.isModalOpen=!1,document.body.style.overflow="auto"}stopPropagation(i){i.stopPropagation()}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(P2))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-place-list-user"]],decls:2,vars:2,consts:[[4,"ngFor","ngForOf"],["class","modal",3,"click",4,"ngIf"],[1,"places"],["class","place",3,"click",4,"ngFor","ngForOf"],[1,"place",3,"click"],[1,"image",3,"ngStyle"],[1,"info"],[4,"ngIf"],[1,"modal",3,"click"],[1,"modal-content",3,"click"],[1,"modal-image",3,"ngStyle"],[3,"click"]],template:function(a,h){1&a&&(M.YNc(0,w4,5,2,"div",0),M.YNc(1,C4,9,5,"div",1)),2&a&&(M.Q6J("ngForOf",h.categorizedPlaces),M.xp6(1),M.Q6J("ngIf",h.isModalOpen))},dependencies:[ml,Ua,au],styles:[".places[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.place[_ngcontent-%COMP%]{border:1px solid black;border-radius:20px;overflow:hidden;margin-bottom:20px}.place[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{padding:10px 20px}.place[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{background-size:100% auto;background-position:center;width:100%;height:200px}.modal[_ngcontent-%COMP%]{display:flex;position:fixed;top:0;left:15%;width:70%;height:100%;background-color:rgba(0,0,0,);justify-content:center;align-items:center}.modal-content[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:5px;text-align:center}.modal-image[_ngcontent-%COMP%]{width:100%;height:300px;background-size:cover;background-position:center}"]})}return o})(),P4=(()=>{class o{constructor(i,a){this.authService=i,this.placeService=a,this.searchTerm="",this.places=[]}ngOnInit(){this.getAllPlaces()}ngOnDestroy(){this.placesSubscription&&this.placesSubscription.unsubscribe(),window.removeEventListener("scroll",this.handleScroll)}getAllPlaces(){this.placeService.getPlacesByQuery(),this.placesSubscription=this.placeService.placesChanged.subscribe(i=>{this.places=i})}search(){this.placeService.getPlacesByQuery(this.searchTerm)}logOut(){this.authService.logOut()}ngAfterViewInit(){window.addEventListener("scroll",this.handleScroll)}handleScroll(){const i=document.querySelector("header");window.scrollY>0?i?.classList.add("sticky"):i?.classList.remove("sticky")}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(zA),M.Y36(aT))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-dashboard"]],decls:95,vars:1,consts:[[1,"logoTripTrove"],["href","#",1,"logo","tripTrove"],[1,"user-avatar"],["src","../../../assets/images/usuario.jpg","alt","Usuario"],[1,"search-container"],["type","text","placeholder","Buscar lugares...",3,"ngModel","ngModelChange"],["type","submit",3,"click"],["src","../../../assets/images/searchimagen.png","alt","Buscar"],["href","/maps"],[3,"click"],["id","divider",1,"header-divider"],[1,"titulito"],[1,"cajita"],["id","myCarousel","data-ride","carousel",1,"carousel","slide"],[1,"carousel-indicators"],["data-target","#myCarousel","data-slide-to","0",1,"active"],["data-target","#myCarousel","data-slide-to","1"],["data-target","#myCarousel","data-slide-to","2"],["data-target","#myCarousel","data-slide-to","3"],[1,"carousel-inner"],[1,"carousel-item","active"],["src","../../../assets/images/principal bosque de chapultepc.jpg","alt","Bosque de Chapultepec"],[1,"textito"],[1,"rating"],[1,"fas","fa-star"],[1,"fas","fa-star-half-alt"],[1,"carousel-item"],["src","../../../assets/images/principal parque la mexicana.jpg","alt","Parque La Mexicana"],["src","../../../assets/images/principal museo soumaya.jpg","alt","Museo Soumaya"],["src","../../../assets/images/principal parque bicentenario.jpg","alt","Parque Bicentenario"],[1,"far","fa-star"],["href","#myCarousel","role","button","data-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"sr-only"],["href","#myCarousel","role","button","data-slide","next",1,"carousel-control-next"],["ariahidden","true",1,"carousel-control-next-icon"],[1,"icon-description"],[1,"bx","bxs-star"]],template:function(a,h){1&a&&(M.TgZ(0,"header")(1,"div",0)(2,"a",1),M._uU(3,"TripTrove"),M.qZA()(),M.TgZ(4,"div",2),M._UZ(5,"img",3),M.qZA(),M.TgZ(6,"div",4)(7,"input",5),M.NdJ("ngModelChange",function(x){return h.searchTerm=x}),M.qZA(),M.TgZ(8,"button",6),M.NdJ("click",function(){return h.search()}),M._UZ(9,"img",7),M.qZA()(),M.TgZ(10,"ul")(11,"li")(12,"a",8),M._uU(13,"MAPA"),M.qZA()(),M.TgZ(14,"li")(15,"a",9),M.NdJ("click",function(){return h.logOut()}),M._uU(16,"CERRAR SESION"),M.qZA()()()(),M._UZ(17,"hr",10)(18,"br")(19,"br"),M.TgZ(20,"h2",11),M._uU(21,"Lugares Populares para ti,"),M.qZA(),M.TgZ(22,"div",12)(23,"div",13)(24,"ol",14),M._UZ(25,"li",15)(26,"li",16)(27,"li",17)(28,"li",18),M.qZA(),M.TgZ(29,"div",19)(30,"div",20),M._UZ(31,"img",21),M.TgZ(32,"div",22)(33,"h2"),M._uU(34," BOSQUE DE CHAPULTEPEC"),M.qZA(),M.TgZ(35,"p"),M._uU(36," El bosque de Chapultepec es uno de los lugares m\xe1s emblem\xe1ticos de la Ciudad de M\xe9xico. Es un gran parque urbano con una superficie de m\xe1s de 686 hect\xe1reas, que alberga una gran variedad de flora y fauna. "),M.qZA(),M.TgZ(37,"div",23),M._UZ(38,"i",24)(39,"i",24)(40,"i",24)(41,"i",24)(42,"i",25),M.qZA()()(),M.TgZ(43,"div",26),M._UZ(44,"img",27),M.TgZ(45,"div",22)(46,"h2"),M._uU(47," PARQUE LA MEXICANA"),M.qZA(),M.TgZ(48,"p"),M._uU(49," El parque La Mexicana es un parque urbano ubicado en la delegaci\xf3n Miguel Hidalgo. Es un espacio de recreaci\xf3n y convivencia para los habitantes de la Ciudad de M\xe9xico. "),M.qZA(),M.TgZ(50,"div",23),M._UZ(51,"i",24)(52,"i",24)(53,"i",24)(54,"i",24)(55,"i",24),M.qZA()()(),M.TgZ(56,"div",26),M._UZ(57,"img",28),M.TgZ(58,"div",22)(59,"h2"),M._uU(60," MUSEO SOUMAYA"),M.qZA(),M.TgZ(61,"p"),M._uU(62," El museo Soumaya es un museo de arte ubicado en la Ciudad de M\xe9xico. Alberga una colecci\xf3n de arte mexicano e internacional, que incluye obras de artistas como Miguel \xc1ngel, Leonardo da Vinci, Picasso y Diego Rivera. "),M.qZA(),M.TgZ(63,"div",23),M._UZ(64,"i",24)(65,"i",24)(66,"i",24)(67,"i",24)(68,"i",25),M.qZA()()(),M.TgZ(69,"div",26),M._UZ(70,"img",29),M.TgZ(71,"div",22)(72,"h2"),M._uU(73," PARQUE BICENTENARIO"),M.qZA(),M.TgZ(74,"p"),M._uU(75," El parque Bicentenario es un parque urbano ubicado en la delegaci\xf3n Iztacalco. Fue construido con motivo del bicentenario de la Independencia de M\xe9xico y es un espacio de recreaci\xf3n y cultura para los habitantes de la Ciudad de M\xe9xico. "),M.qZA(),M.TgZ(76,"div",23),M._UZ(77,"i",24)(78,"i",24)(79,"i",25)(80,"i",30)(81,"i",30),M.qZA()()()(),M.TgZ(82,"a",31),M._UZ(83,"span",32),M.TgZ(84,"span",33),M._uU(85,"Anterior"),M.qZA()(),M.TgZ(86,"a",34),M._UZ(87,"span",35),M.TgZ(88,"span",33),M._uU(89,"Siguiente"),M.qZA()()()(),M.TgZ(90,"div",36),M._UZ(91,"i",37),M.TgZ(92,"h2",11),M._uU(93,"Recomendados"),M.qZA(),M._UZ(94,"app-place-list-user"),M.qZA()),2&a&&(M.xp6(7),M.Q6J("ngModel",h.searchTerm))},dependencies:[Gr,GO,ZO,M4],styles:['*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}#contenedorPopup[_ngcontent-%COMP%]{overflow-y:auto;max-height:400px}.tripTrove[_ngcontent-%COMP%]{color:#000;transition:color .9s}header.sticky[_ngcontent-%COMP%]   .tripTrove[_ngcontent-%COMP%]{color:#fff;text-align:center}.botoncillo[_ngcontent-%COMP%]{border:1px solid #ddd;margin:10px;padding:15px;border-radius:8px;background-color:#f9f9f9;flex:0 1 calc(33.33% - 20px);box-sizing:border-box;cursor:pointer;transition:background-color .3s,filter .3s;text-align:left;height:500px}.botoncillo[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.botoncillo[_ngcontent-%COMP%]:active{background-color:#e0e0e0;filter:brightness(1.2) hue-rotate(30deg)}.botoncillo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;height:auto;border-radius:8px;display:block;margin:0 auto}header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;color:#000;transition:.9s;padding:10px 100px;z-index:100000;font-size:18px}.search-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-left:auto}.search-container[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{padding:8px;font-size:16px;border:none;background-color:#f9f9f9;border-radius:5px;flex-grow:1;color:#000}.search-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px;background-color:#f9f9f9;border:none;border-radius:5px;cursor:pointer}.search-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px}.user-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;margin-left:450%;border-radius:50%}.header-divider[_ngcontent-%COMP%]{border:none;border-top:1px solid #000000;margin-top:4%;box-shadow:0 2px 4px #0000001a}header.sticky[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:flex;position:center;margin-right:85%;font-weight:700;color:#000;text-decoration:none;font-size:2em;letter-spacing:2px;transition:.6s}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:relative;display:flex;color:#fff;justify-content:flex-end;align-items:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;list-style:none;margin-left:15px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;text-decoration:none;color:#000;letter-spacing:2px;font-weight:500;transition:.5s;overflow:hidden}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;width:120%;height:3px;background-color:#000;z-index:-1;transition:transform .8s;border-radius:5px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{top:0;left:-10%;transform:scaleX(0);transform-origin:right}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{bottom:0;right:-10%;transform:scaleX(0);transform-origin:left}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:center}.logo[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px}.titulito[_ngcontent-%COMP%]{text-align:center;font-size:45px;padding:20px;font-family:Poppins,sans-serif}.cajita[_ngcontent-%COMP%]{width:1200px;height:570px;margin:27px auto 0}.cajita[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;padding:0;width:400%;animation:_ngcontent-%COMP%_slide 20s infinite alternate ease-in-out}.cajita[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{width:100%;list-style:none;position:relative}.textito[_ngcontent-%COMP%]{font-weight:700;position:absolute;text-align:center;align-items:center;padding:0 250px;top:250px;color:#fff;font-family:Poppins,sans-serif}.textito[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700;font-size:30px;margin-bottom:40px;font-family:Poppins,sans-serif}h1[_ngcontent-%COMP%]{padding:31px;font-weight:700;font-size:30px;font-family:Poppins,sans-serif;text-align:center;align-items:center}.cajita[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1200px;height:570px}@keyframes _ngcontent-%COMP%_slide{0%{margin-left:0}20%{margin-left:0}25%{margin-left:-100%}45%{margin-left:-100%}50%{margin-left:-200%}70%{margin-left:-200%}75%{margin-left:-300%}to{margin-left:-300%}}@media (max-width:991px){body[_ngcontent-%COMP%]{padding:30px}.cajita[_ngcontent-%COMP%]{width:100%}.textito[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif;top:50px;padding:0}.textito[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif;font-size:35px;margin-bottom:15px}.textito[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif;font-size:15px}}.scroll[_ngcontent-%COMP%]{position:relative;display:flex;width:700px;overflow:hidden;-webkit-mask-image:linear-gradient(90deg,transparent,#000000 20%,#000000 80%,transparent)}header.sticky[_ngcontent-%COMP%]{background:#000000}header.sticky[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}.scroll[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{white-space:nowrap;animation:_ngcontent-%COMP%_animate var(--t) linear infinite;animation-delay:calc(var(--t) * -1)}.scroll[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){animation:_ngcontent-%COMP%_animate2 var(--t) linear infinite;animation-delay:calc(var(--t) / -2)}@keyframes _ngcontent-%COMP%_animate{0%{transform:translate(100%)}to{transform:translate(-100%)}}@keyframes _ngcontent-%COMP%_animate2{0%{transform:translate(0)}to{transform:translate(-200%)}}.scroll[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;letter-spacing:.2cm;text-transform:uppercase;margin:10px;background:#222;color:#000;padding:5px 10px;border-radius:5px;transition:.5s}.scroll[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{background:rgb(105,1,224);cursor:pointer}.imgbx[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{scale:.8;filter:grayscale(1);max-height:200px;min-height:200px;max-width:200px;min-width:200px}.imgbx[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{filter:grayscale(0)}.desliza[_ngcontent-%COMP%]{display:flex;min-height:50vh;align-items:center;justify-content:center}#ubicacionesList[_ngcontent-%COMP%]{list-style:none;padding:0;display:flex;flex-wrap:wrap;justify-content:space-around}button[_ngcontent-%COMP%]{border:1px solid #ddd;margin:10px;padding:15px;border-radius:8px;background-color:#f9f9f9;flex:0 1 calc(30% - 20px);box-sizing:border-box;cursor:pointer;transition:background-color .3s;text-align:left}button[_ngcontent-%COMP%]:hover{background-color:#000}button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:300px;max-height:300px;height:auto;border-radius:8px;display:block;margin:0 auto}.icon-description[_ngcontent-%COMP%]{margin:40px 40px 100px;text-align:center}.icon-description[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:50px;color:#000;transition:.7s}.icon-description[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#0059ff;text-shadow:0 0 120px #1900ff}.botoncillo[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;padding:10px 20px;border:none;cursor:pointer;border-radius:5px;margin-bottom:10px}.app-place-list-user[_ngcontent-%COMP%]{display:block;margin:10px auto;padding:15px;border-radius:5px;text-align:center}']})}return o})();function E2(){return E2=Object.assign?Object.assign.bind():function(o){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(o[a]=i[a])}return o},E2.apply(this,arguments)}var E4={strings:["These are the default values...","You know what you should do?","Use your own!","Have a great day!"],stringsElement:null,typeSpeed:0,startDelay:0,backSpeed:0,smartBackspace:!0,shuffle:!1,backDelay:700,fadeOut:!1,fadeOutClass:"typed-fade-out",fadeOutDelay:500,loop:!1,loopCount:1/0,showCursor:!0,cursorChar:"|",autoInsertCss:!0,attr:null,bindInputFocusEvents:!1,contentType:"html",onBegin:function(o){},onComplete:function(o){},preStringTyped:function(o,n){},onStringTyped:function(o,n){},onLastStringBackspaced:function(o){},onTypingPaused:function(o,n){},onTypingResumed:function(o,n){},onReset:function(o){},onStop:function(o,n){},onStart:function(o,n){},onDestroy:function(o){}},O4=new(function(){function o(){}var n=o.prototype;return n.load=function(i,a,h){if(i.el="string"==typeof h?document.querySelector(h):h,i.options=E2({},E4,a),i.isInput="input"===i.el.tagName.toLowerCase(),i.attr=i.options.attr,i.bindInputFocusEvents=i.options.bindInputFocusEvents,i.showCursor=!i.isInput&&i.options.showCursor,i.cursorChar=i.options.cursorChar,i.cursorBlinking=!0,i.elContent=i.attr?i.el.getAttribute(i.attr):i.el.textContent,i.contentType=i.options.contentType,i.typeSpeed=i.options.typeSpeed,i.startDelay=i.options.startDelay,i.backSpeed=i.options.backSpeed,i.smartBackspace=i.options.smartBackspace,i.backDelay=i.options.backDelay,i.fadeOut=i.options.fadeOut,i.fadeOutClass=i.options.fadeOutClass,i.fadeOutDelay=i.options.fadeOutDelay,i.isPaused=!1,i.strings=i.options.strings.map(function(B){return B.trim()}),i.stringsElement="string"==typeof i.options.stringsElement?document.querySelector(i.options.stringsElement):i.options.stringsElement,i.stringsElement){i.strings=[],i.stringsElement.style.cssText="clip: rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;";var _=Array.prototype.slice.apply(i.stringsElement.children),x=_.length;if(x)for(var S=0;S<x;S+=1)i.strings.push(_[S].innerHTML.trim())}for(var L in i.strPos=0,i.currentElContent=this.getCurrentElContent(i),i.currentElContent&&i.currentElContent.length>0&&(i.strPos=i.currentElContent.length-1,i.strings.unshift(i.currentElContent)),i.sequence=[],i.strings)i.sequence[L]=L;i.arrayPos=0,i.stopNum=0,i.loop=i.options.loop,i.loopCount=i.options.loopCount,i.curLoop=0,i.shuffle=i.options.shuffle,i.pause={status:!1,typewrite:!0,curString:"",curStrPos:0},i.typingComplete=!1,i.autoInsertCss=i.options.autoInsertCss,i.autoInsertCss&&(this.appendCursorAnimationCss(i),this.appendFadeOutAnimationCss(i))},n.getCurrentElContent=function(i){return i.attr?i.el.getAttribute(i.attr):i.isInput?i.el.value:"html"===i.contentType?i.el.innerHTML:i.el.textContent},n.appendCursorAnimationCss=function(i){var a="data-typed-js-cursor-css";if(i.showCursor&&!document.querySelector("["+a+"]")){var h=document.createElement("style");h.setAttribute(a,"true"),h.innerHTML="\n        .typed-cursor{\n          opacity: 1;\n        }\n        .typed-cursor.typed-cursor--blink{\n          animation: typedjsBlink 0.7s infinite;\n          -webkit-animation: typedjsBlink 0.7s infinite;\n                  animation: typedjsBlink 0.7s infinite;\n        }\n        @keyframes typedjsBlink{\n          50% { opacity: 0.0; }\n        }\n        @-webkit-keyframes typedjsBlink{\n          0% { opacity: 1; }\n          50% { opacity: 0.0; }\n          100% { opacity: 1; }\n        }\n      ",document.body.appendChild(h)}},n.appendFadeOutAnimationCss=function(i){var a="data-typed-fadeout-js-css";if(i.fadeOut&&!document.querySelector("["+a+"]")){var h=document.createElement("style");h.setAttribute(a,"true"),h.innerHTML="\n        .typed-fade-out{\n          opacity: 0;\n          transition: opacity .25s;\n        }\n        .typed-cursor.typed-cursor--blink.typed-fade-out{\n          -webkit-animation: 0;\n          animation: 0;\n        }\n      ",document.body.appendChild(h)}},o}()),jL=new(function(){function o(){}var n=o.prototype;return n.typeHtmlChars=function(i,a,h){if("html"!==h.contentType)return a;var _=i.substring(a).charAt(0);if("<"===_||"&"===_){var x;for(x="<"===_?">":";";i.substring(a+1).charAt(0)!==x&&!(1+ ++a>i.length););a++}return a},n.backSpaceHtmlChars=function(i,a,h){if("html"!==h.contentType)return a;var _=i.substring(a).charAt(0);if(">"===_||";"===_){var x;for(x=">"===_?"<":"&";i.substring(a-1).charAt(0)!==x&&!(--a<0););a--}return a},o}()),T4=function(){function o(i,a){O4.load(this,a,i),this.begin()}var n=o.prototype;return n.toggle=function(){this.pause.status?this.start():this.stop()},n.stop=function(){this.typingComplete||this.pause.status||(this.toggleBlinking(!0),this.pause.status=!0,this.options.onStop(this.arrayPos,this))},n.start=function(){this.typingComplete||this.pause.status&&(this.pause.status=!1,this.pause.typewrite?this.typewrite(this.pause.curString,this.pause.curStrPos):this.backspace(this.pause.curString,this.pause.curStrPos),this.options.onStart(this.arrayPos,this))},n.destroy=function(){this.reset(!1),this.options.onDestroy(this)},n.reset=function(i){void 0===i&&(i=!0),clearInterval(this.timeout),this.replaceText(""),this.cursor&&this.cursor.parentNode&&(this.cursor.parentNode.removeChild(this.cursor),this.cursor=null),this.strPos=0,this.arrayPos=0,this.curLoop=0,i&&(this.insertCursor(),this.options.onReset(this),this.begin())},n.begin=function(){var i=this;this.options.onBegin(this),this.typingComplete=!1,this.shuffleStringsIfNeeded(this),this.insertCursor(),this.bindInputFocusEvents&&this.bindFocusEvents(),this.timeout=setTimeout(function(){0===i.strPos?i.typewrite(i.strings[i.sequence[i.arrayPos]],i.strPos):i.backspace(i.strings[i.sequence[i.arrayPos]],i.strPos)},this.startDelay)},n.typewrite=function(i,a){var h=this;this.fadeOut&&this.el.classList.contains(this.fadeOutClass)&&(this.el.classList.remove(this.fadeOutClass),this.cursor&&this.cursor.classList.remove(this.fadeOutClass));var _=this.humanizer(this.typeSpeed),x=1;!0!==this.pause.status?this.timeout=setTimeout(function(){a=jL.typeHtmlChars(i,a,h);var S=0,L=i.substring(a);if("^"===L.charAt(0)&&/^\^\d+/.test(L)){var B=1;B+=(L=/\d+/.exec(L)[0]).length,S=parseInt(L),h.temporaryPause=!0,h.options.onTypingPaused(h.arrayPos,h),i=i.substring(0,a)+i.substring(a+B),h.toggleBlinking(!0)}if("`"===L.charAt(0)){for(;"`"!==i.substring(a+x).charAt(0)&&(x++,!(a+x>i.length)););var H=i.substring(0,a),Y=i.substring(H.length+1,a+x),pt=i.substring(a+x+1);i=H+Y+pt,x--}h.timeout=setTimeout(function(){h.toggleBlinking(!1),a>=i.length?h.doneTyping(i,a):h.keepTyping(i,a,x),h.temporaryPause&&(h.temporaryPause=!1,h.options.onTypingResumed(h.arrayPos,h))},S)},_):this.setPauseStatus(i,a,!0)},n.keepTyping=function(i,a,h){0===a&&(this.toggleBlinking(!1),this.options.preStringTyped(this.arrayPos,this));var _=i.substring(0,a+=h);this.replaceText(_),this.typewrite(i,a)},n.doneTyping=function(i,a){var h=this;this.options.onStringTyped(this.arrayPos,this),this.toggleBlinking(!0),this.arrayPos===this.strings.length-1&&(this.complete(),!1===this.loop||this.curLoop===this.loopCount)||(this.timeout=setTimeout(function(){h.backspace(i,a)},this.backDelay))},n.backspace=function(i,a){var h=this;if(!0!==this.pause.status){if(this.fadeOut)return this.initFadeOut();this.toggleBlinking(!1);var _=this.humanizer(this.backSpeed);this.timeout=setTimeout(function(){a=jL.backSpaceHtmlChars(i,a,h);var x=i.substring(0,a);if(h.replaceText(x),h.smartBackspace){var S=h.strings[h.arrayPos+1];h.stopNum=S&&x===S.substring(0,a)?a:0}a>h.stopNum?(a--,h.backspace(i,a)):a<=h.stopNum&&(h.arrayPos++,h.arrayPos===h.strings.length?(h.arrayPos=0,h.options.onLastStringBackspaced(),h.shuffleStringsIfNeeded(),h.begin()):h.typewrite(h.strings[h.sequence[h.arrayPos]],a))},_)}else this.setPauseStatus(i,a,!1)},n.complete=function(){this.options.onComplete(this),this.loop?this.curLoop++:this.typingComplete=!0},n.setPauseStatus=function(i,a,h){this.pause.typewrite=h,this.pause.curString=i,this.pause.curStrPos=a},n.toggleBlinking=function(i){this.cursor&&(this.pause.status||this.cursorBlinking!==i&&(this.cursorBlinking=i,i?this.cursor.classList.add("typed-cursor--blink"):this.cursor.classList.remove("typed-cursor--blink")))},n.humanizer=function(i){return Math.round(Math.random()*i/2)+i},n.shuffleStringsIfNeeded=function(){this.shuffle&&(this.sequence=this.sequence.sort(function(){return Math.random()-.5}))},n.initFadeOut=function(){var i=this;return this.el.className+=" "+this.fadeOutClass,this.cursor&&(this.cursor.className+=" "+this.fadeOutClass),setTimeout(function(){i.arrayPos++,i.replaceText(""),i.strings.length>i.arrayPos?i.typewrite(i.strings[i.sequence[i.arrayPos]],0):(i.typewrite(i.strings[0],0),i.arrayPos=0)},this.fadeOutDelay)},n.replaceText=function(i){this.attr?this.el.setAttribute(this.attr,i):this.isInput?this.el.value=i:"html"===this.contentType?this.el.innerHTML=i:this.el.textContent=i},n.bindFocusEvents=function(){var i=this;this.isInput&&(this.el.addEventListener("focus",function(a){i.stop()}),this.el.addEventListener("blur",function(a){i.el.value&&0!==i.el.value.length||i.start()}))},n.insertCursor=function(){this.showCursor&&(this.cursor||(this.cursor=document.createElement("span"),this.cursor.className="typed-cursor",this.cursor.setAttribute("aria-hidden",!0),this.cursor.innerHTML=this.cursorChar,this.el.parentNode&&this.el.parentNode.insertBefore(this.cursor,this.el.nextSibling)))},o}();let I4=(()=>{class o{ngOnInit(){this.initTypingEffect()}initTypingEffect(){new T4(".multiText",{strings:["EXPERIENCIAS...  ","LUGARES...  ","CULTURA...  ","M\xc9XICO..."],loop:!0,typeSpeed:190,backSpeed:190,backDelay:3e3})}onScroll(){this.toggleStickyHeader(window.scrollY>0)}toggleStickyHeader(i){const a=document.querySelector("header");a&&a.classList.toggle("sticky",i)}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-home"]],hostBindings:function(a,h){1&a&&M.NdJ("scroll",function(x){return h.onScroll(x)},!1,M.Jf7)},standalone:!0,features:[M.jDz],decls:61,vars:0,consts:[["href","http://myxitech.gerdoc.com",1,"logo"],["href","/about"],["href","/download"],["href","/login"],[1,"parallax","section2"],[1,"content","audi"],[1,"multiText"],[1,"contact-section"],[1,"company-info"],[1,"text-info"],[1,"team-member"],["href","https://www.instagram.com/myxitech/","target","_blank"],[1,"Myxi-text-info"],["src","../../../assets/images/MyxiLogo.png","alt","Logo de TripTrove"]],template:function(a,h){1&a&&(M.TgZ(0,"header")(1,"a",0),M._uU(2,"TripTrove"),M.qZA(),M.TgZ(3,"ul")(4,"li")(5,"a",1),M._uU(6,"ACERCA DE"),M.qZA()(),M.TgZ(7,"li")(8,"a",2),M._uU(9,"ANDROID"),M.qZA()(),M.TgZ(10,"li")(11,"a",3),M._uU(12,"INGRESAR"),M.qZA()()()(),M.TgZ(13,"div",4),M._UZ(14,"br")(15,"br")(16,"br")(17,"br")(18,"br")(19,"br")(20,"br")(21,"br")(22,"br")(23,"br")(24,"br")(25,"br"),M.TgZ(26,"h1"),M._uU(27," TU GU\xcdA VIAJERO"),M.qZA(),M.TgZ(28,"div",5)(29,"h2"),M._uU(30," DESCUBRE "),M._UZ(31,"span",6),M.qZA()()(),M.TgZ(32,"div",7)(33,"div",8)(34,"div",9)(35,"h2"),M._uU(36,"Sobre Myxitech"),M.qZA(),M.TgZ(37,"p"),M._uU(38,"Myxitech es una empresa de tecnolog\xeda dedicada a proporcionar soluciones innovadoras en el \xe1mbito del turismo y la exploraci\xf3n. Nuestra misi\xf3n es facilitar experiencias de viaje excepcionales a trav\xe9s de herramientas digitales avanzadas."),M.qZA()(),M.TgZ(39,"div",10)(40,"h3"),M._uU(41,"Contactanos"),M.qZA(),M.TgZ(42,"p"),M._uU(43,"Numero: +52 56 3811 8298"),M.qZA(),M.TgZ(44,"p"),M._uU(45,"Redes Sociales: "),M.TgZ(46,"a",11),M._uU(47,"Myxi"),M.qZA()()(),M.TgZ(48,"div",12)(49,"h3"),M._uU(50,"Informacion"),M.qZA(),M.TgZ(51,"p"),M._uU(52," TripTrove\xa9"),M._UZ(53,"br"),M._uU(54," Terminos y condiciones"),M._UZ(55,"br"),M._uU(56," Privacy"),M._UZ(57,"br"),M._uU(58," Seguridad"),M._UZ(59,"br"),M.qZA()(),M._UZ(60,"img",13),M.qZA()())},styles:['@import"https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap";*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif;color:#000;text-decoration:none}header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;transition:.9s;padding:40px 100px;z-index:100000;font-size:18px}header.sticky[_ngcontent-%COMP%]{padding:5px 100px;background:#000000}header.sticky[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:relative;font-weight:700;color:#000;text-decoration:none;font-size:2em;letter-spacing:2px;transition:.6s}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;list-style:none}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;margin:0 15px;text-decoration:none;color:#000;letter-spacing:2px;font-weight:500;transition:.5s;overflow:hidden}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;width:120%;height:3px;background-color:#000;z-index:-1;transition:transform .8s;border-radius:5px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{top:0;left:-10%;transform:scaleX(0);transform-origin:right}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{bottom:0;right:-10%;transform:scaleX(0);transform-origin:left}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:center}.parallax[_ngcontent-%COMP%]{background-attachment:fixed;background-position:center;background-size:cover;width:100%;height:100vh}.parallax.section2[_ngcontent-%COMP%]{background-image:url(principal\\ 1.8aeacd85a0e89648.jpg);align-items:center;align-content:center;text-align:left;justify-content:center}.parallax.section2[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:100px;color:#000}.audi[_ngcontent-%COMP%]{text-align:left;justify-content:center}.content.audi[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#000;font-size:35px}.multiText[_ngcontent-%COMP%]{font-size:35px}.contact-section[_ngcontent-%COMP%]{background-color:#202020;color:#fff;padding:50px;text-align:center;height:30vh}.company-info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;text-align:left;flex-wrap:wrap}.company-info[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:200px;margin-right:35px;border-radius:7px;margin-bottom:10px}.text-info[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]{flex:1;max-width:60%}.team-member[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]{margin-top:5px;margin-left:65px}.text-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .team-member[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;margin-bottom:10px;color:#fff}.text-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .team-member[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;margin-bottom:8px;color:#fff}.team-member[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}']})}return o})();const GA=(o,n)=>{const i=(0,M.f3M)(zA),a=(0,M.f3M)(ru);return i.isLoggedIn||a.navigate(["login"]),!0};let S4=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-about"]],standalone:!0,features:[M.jDz],decls:77,vars:0,consts:[["lang","en"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],["href","https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css","rel","stylesheet"],["href","#",1,"logo"],["href","/#"],["href","/android"],["href","/login"],[1,"parallax","section1"],[1,"parallax-overlay"],[1,"black-section"],[1,"image-block1"],["src","../../assets/images/acercade bloque.jpg","alt","no leer !!!!",1,"image"],[1,"text-block1"],[1,"black-section2"],[1,"text-block2"],[1,"image-block2"],["src","../../assets/images/barquitos.jpg","alt","me gusta lula",1,"image"],[1,"black-section3"],[1,"image-block3"],["src","../../assets/images/acercade ciudad.jpg","alt","apoco chi",1,"image"],[1,"text-block3"],[1,"contact-section"],[1,"company-info"],[1,"text-info"],[1,"team-member"],["href","https://www.instagram.com/daani_moon/?utm_source=ig_web_button_share_sheet&igshid=OGQ5ZDc2ODk2ZA==","target","_blank"],[1,"Myxi-text-info"],["href","","target","_blank"]],template:function(a,h){1&a&&(M.TgZ(0,"html",0)(1,"head")(2,"title"),M._uU(3,"Acerca De "),M.qZA(),M._UZ(4,"meta",1)(5,"meta",2)(6,"link",3),M.TgZ(7,"title"),M._uU(8,"\xbfQu\xe9 es Trip Trove?"),M.qZA()(),M.TgZ(9,"body")(10,"header")(11,"a",4),M._uU(12,"TripTrove "),M.qZA(),M.TgZ(13,"ul")(14,"li")(15,"a",5),M._uU(16,"INICIO"),M.qZA()(),M.TgZ(17,"li")(18,"a",6),M._uU(19,"APP"),M.qZA()(),M.TgZ(20,"li")(21,"a",7),M._uU(22,"INICIA SESION"),M.qZA()()()(),M.TgZ(23,"div",8)(24,"div",9)(25,"h1"),M._uU(26,"\xa1Descubre la belleza de la Ciudad de M\xe9xico!"),M.qZA(),M.TgZ(27,"p"),M._uU(28,"Los lugares que siempre quisiste est\xe1n aqu\xed, ven y encuentra tu lugar favorito con la ayuda de nuestra aplicaci\xf3n."),M.qZA()()(),M.TgZ(29,"div",10)(30,"div",11),M._UZ(31,"img",12),M.qZA(),M.TgZ(32,"div",13)(33,"h2"),M._uU(34,"Descubre la Belleza y la Importancia del Turismo en la Ciudad de M\xe9xico"),M.qZA(),M.TgZ(35,"p"),M._uU(36,"La Ciudad de M\xe9xico, conocida como la CDMX, es un destino \xfanico con una rica historia desde la civilizaci\xf3n azteca hasta la arquitectura colonial. La ciudad es un museo al aire libre llena de maravillas art\xedsticas y culinarias, desde los murales de Diego Rivera hasta la deliciosa comida mexicana. Adem\xe1s, la CDMX ofrece belleza natural con canales y volcanes. Descubre la historia, cultura y diversidad de esta ciudad impresionante."),M.qZA()()(),M.TgZ(37,"div",14)(38,"div",15)(39,"h2"),M._uU(40,"Nuestro Aporte a el Turismo"),M.qZA(),M.TgZ(41,"p"),M._uU(42,"En Myxitech buscamos fomentar el turismo, la economia y la cultura, es por eso que apasionados por nuestro entorno, creamos Trip Trove, nuestro primer proyecto el cual busca hacer mas facil, claro y mucho mas personal un viaje para todo aquel interesado en visitar la m\xe1gica Ciudad de M\xe9xico"),M.qZA()(),M.TgZ(43,"div",16),M._UZ(44,"img",17),M.qZA()(),M.TgZ(45,"div",18)(46,"div",19),M._UZ(47,"img",20),M.qZA(),M.TgZ(48,"div",21)(49,"h2"),M._uU(50,"El viaje que siempre quisiste"),M.qZA(),M.TgZ(51,"p"),M._uU(52,"En Trip Trove contamos con todas las herramientas que buscas para organizar tu viaje so\xf1ado, consideramos todos los aspectos posibles desde el momento en el que quieres elegir el lugar, transportarte por la ciudad y llegar a tu destino"),M.qZA()()(),M.TgZ(53,"div",22)(54,"div",23)(55,"div",24)(56,"h2"),M._uU(57,"Trip Trove"),M.qZA(),M.TgZ(58,"p"),M._uU(59,"Conoce nuestro centro de ayuda y Myxitech"),M.qZA()(),M.TgZ(60,"div",25)(61,"h3"),M._uU(62,"Contactanos"),M.qZA(),M.TgZ(63,"p"),M._uU(64,"Numero: +52 1 55 6165 3040"),M.qZA(),M.TgZ(65,"p"),M._uU(66,"Email: dani@gmail.com"),M.qZA(),M.TgZ(67,"p"),M._uU(68,"Redes Sociales: "),M.TgZ(69,"a",26),M._uU(70,"Daani_moon"),M.qZA()()(),M.TgZ(71,"div",27)(72,"h3"),M._uU(73,"Compa\xf1ia"),M.qZA(),M.TgZ(74,"p")(75,"a",28),M._uU(76,"Quienes somos"),M.qZA()()()()()()())},styles:['@import"https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap";*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif;color:#f7f7f7;text-decoration:none}body[_ngcontent-%COMP%]{background-color:#000;color:#fff}header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;transition:.9s;padding:40px 100px;z-index:100000;font-size:18px}header.sticky[_ngcontent-%COMP%]{padding:8px 100px;background:#000000}header.sticky[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:relative;font-weight:700;color:#fff;text-decoration:none;font-size:2em;letter-spacing:2px;transition:.6s}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;list-style:none}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;margin:0 15px;text-decoration:none;color:#fff;letter-spacing:2px;font-weight:500;transition:.5s;overflow:hidden}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;width:120%;height:3px;background-color:#fafafa;z-index:-1;transition:transform .8s;border-radius:5px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{top:0;left:-10%;transform:scaleX(0);transform-origin:right}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{bottom:0;right:-10%;transform:scaleX(0);transform-origin:left}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#fff}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:center}.page-container[_ngcontent-%COMP%]{position:relative}.parallax.section1[_ngcontent-%COMP%]{position:relative;background-image:url(fondito.179a8ed1c4f65faf.jpg);background-attachment:fixed;background-position:center;background-size:cover;height:92vh}.parallax.section1[_ngcontent-%COMP%]   .parallax-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:40%;height:50vh;background-color:#0000003b;z-index:2;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:20px;padding:60px;margin-top:160px;margin-left:30px;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px)}.parallax.section1[_ngcontent-%COMP%]   .parallax-overlay[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .parallax.section1[_ngcontent-%COMP%]   .parallax-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff;text-align:center}.black-section[_ngcontent-%COMP%]{display:flex;background-color:#000;color:#fff;padding:50px;align-items:center}.image-block1[_ngcontent-%COMP%]{flex:1;padding:20px;position:relative}.image-block1[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(transparent,black);mix-blend-mode:overlay}.image-block1[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:86%;border-radius:6%}.text-block1[_ngcontent-%COMP%]{flex:2;padding:20px}.text-block1[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:55px;margin-bottom:20px;text-align:justify}.text-block1[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:17.5px;text-align:justify}.black-section2[_ngcontent-%COMP%]{display:flex;background-color:#000;color:#fff;padding:50px;align-items:center}.image-block2[_ngcontent-%COMP%]{flex:1;padding:20px;position:relative}.image-block2[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(transparent,black);mix-blend-mode:overlay}.image-block2[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;border-radius:6%}.text-block2[_ngcontent-%COMP%]{flex:2;padding:20px}.text-block2[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:53px;margin-bottom:20px}.text-block2[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:17px;text-align:justify}.black-section3[_ngcontent-%COMP%]{display:flex;background-color:#000;color:#fff;padding:50px;align-items:center}.image-block3[_ngcontent-%COMP%]{flex:1;padding:20px;position:relative}.image-block3[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(transparent,black);mix-blend-mode:overlay}.image-block3[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;border-radius:6%}.text-block3[_ngcontent-%COMP%]{flex:2;padding:20px}.text-block3[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:53px;margin-bottom:20px}.text-block3[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:17.5px;text-align:justify}.contact-section[_ngcontent-%COMP%]{background-color:#202020;color:#fff;padding:50px;text-align:center;height:30vh}.company-info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;text-align:left;flex-wrap:wrap}.company-info[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:200px;margin-right:35px;border-radius:7px;margin-bottom:10px}.text-info[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]{flex:1;max-width:60%}.team-member[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]{margin-top:5px;margin-left:65px}.team-member[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;margin-bottom:10px}.team-member[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;margin-bottom:8px}.team-member[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}']})}return o})(),A4=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-download"]],decls:16,vars:0,consts:[["href","#",1,"logo"],["href","/#"],["href","/about"],["href","/login"],[1,"card"]],template:function(a,h){1&a&&(M.TgZ(0,"body")(1,"header")(2,"a",0),M._uU(3,"TripTrove"),M.qZA(),M.TgZ(4,"ul")(5,"li")(6,"a",1),M._uU(7,"INICIO"),M.qZA()(),M.TgZ(8,"li")(9,"a",2),M._uU(10,"ACERCA DE"),M.qZA()(),M.TgZ(11,"li")(12,"a",3),M._uU(13,"INICIA SESION"),M.qZA()()()(),M.TgZ(14,"div",4),M._uU(15,"Android"),M.qZA()())},styles:['*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,sans-serif;color:#000;text-decoration:none}body[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100vh;margin:0}header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;transition:.9s;padding:40px 100px;z-index:100000;font-size:18px}header.sticky[_ngcontent-%COMP%]{padding:5px 100px;background:#ffffff}header.sticky[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#000}header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:relative;font-weight:700;color:#000;text-decoration:none;font-size:2em;letter-spacing:2px;transition:.6s}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;list-style:none}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;margin:0 15px;text-decoration:none;color:#000;letter-spacing:2px;font-weight:500;transition:.5s;overflow:hidden}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;width:120%;height:3px;background-color:#000;z-index:-1;transition:transform .8s;border-radius:5px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{top:0;left:-10%;transform:scaleX(0);transform-origin:right}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{bottom:0;right:-10%;transform:scaleX(0);transform-origin:left}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:center}.contact-section[_ngcontent-%COMP%]{background-color:#202020;color:#fff;padding:50px;text-align:center;height:30vh}.company-info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;text-align:left;flex-wrap:wrap}.company-info[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:200px;margin-right:35px;border-radius:7px;margin-bottom:10px}.text-info[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]{flex:1;max-width:60%}.team-member[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]{margin-top:5px;margin-left:65px}.text-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .team-member[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;margin-bottom:10px;color:#fff}.text-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .team-member[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;margin-bottom:8px;color:#fff}.team-member[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}.card[_ngcontent-%COMP%]{position:relative;width:220px;height:320px;background:mediumturquoise;display:flex;align-items:center;justify-content:center;font-size:25px;font-weight:700;border-radius:15px;cursor:pointer}.card[_ngcontent-%COMP%]:before, .card[_ngcontent-%COMP%]:after{position:absolute;content:"";width:20%;height:20%;display:flex;align-items:center;justify-content:center;font-size:25px;font-weight:700;background-color:#add8e6;transition:all .5s}.card[_ngcontent-%COMP%]:before{top:0;right:0;border-radius:0 15px 0 100%}.card[_ngcontent-%COMP%]:after{bottom:0;left:0;border-radius:0 100% 0 15px}.card[_ngcontent-%COMP%]:hover:before, .card[_ngcontent-%COMP%]:hover:after{width:100%;height:100%;border-radius:15px;transition:all .5s}.card[_ngcontent-%COMP%]:hover:after{content:"Pr\\f3ximamente"}']})}return o})();const D4=["mapDiv"];let k4=(()=>{class o{constructor(i,a){this.placesService=i,this.mapService=a}ngAfterViewInit(){if(!this.placesService.userLocation)throw Error("No hat placesServices.location");const i=new(aL().Map)({container:this.mapDivElement.nativeElement,style:"mapbox://styles/nahumlopz/cltkmkcn601oz01qu0d6bh18e",center:this.placesService.userLocation,zoom:14,pitch:30,maxBounds:[[-99.3269,19.1056],[-98.5636,19.7039]]}),a=(new a0.Popup).setHTML("<h6>Aqui Estoy</h6><br><span>Estoy en este lugar del mundo</span>");new a0.Marker({color:"red"}).setLngLat(this.placesService.userLocation).setPopup(a).addTo(i),this.mapService.setMap(i),(new a0.Popup).setHTML("<h6>")}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(aT),M.Y36(gS))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-map-view"]],viewQuery:function(a,h){if(1&a&&M.Gf(D4,5),2&a){let _;M.iGM(_=M.CRH())&&(h.mapDivElement=_.first)}},decls:2,vars:0,consts:[[1,"map-container"],["mapDiv",""]],template:function(a,h){1&a&&M._UZ(0,"div",0,1)},styles:[".map-container[_ngcontent-%COMP%]{position:fixed;top:0;right:0;width:100%;height:100%;background-color:#fff}"]})}return o})(),R4=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-loading"]],decls:6,vars:0,consts:[[1,"loading-map","d-flex","justify-content-center","align-items-center"],[1,"text-center"]],template:function(a,h){1&a&&(M.TgZ(0,"div",0)(1,"div",1)(2,"h3"),M._uU(3," Espere por favor "),M.qZA(),M.TgZ(4,"span"),M._uU(5,"Localizando..."),M.qZA()()())},styles:[".loading-map[_ngcontent-%COMP%]{background-color:#000c;color:#fff;height:100vh;position:fixed;right:0;top:0;width:100vw}"]})}return o})(),L4=(()=>{class o{constructor(i,a){this.mapService=i,this.placesServices=a}goToMyLocation(){if(!this.placesServices.isUserLocationReady)throw Error("No hay ubicacion de usuario");if(!this.mapService.isMapReady)throw Error("No hay mapa disponible");this.mapService.flyTo(this.placesServices.userLocation)}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(gS),M.Y36(aT))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-btn-my-location"]],decls:2,vars:0,consts:[[1,"btn","btn-primary",3,"click"]],template:function(a,h){1&a&&(M.TgZ(0,"button",0),M.NdJ("click",function(){return h.goToMyLocation()}),M._uU(1," Mi ubicacion\n"),M.qZA())},styles:["button[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;z-index:inherit;padding:10px 15px;font-size:16px;border:2px solid #4CAF50;border-radius:5px;background-color:#4caf50;color:#fff;cursor:pointer;outline:none}button[_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:focus{background-color:#45a049}"]})}return o})();function N4(o,n){if(1&o){const i=M.EpF();M.TgZ(0,"li",10),M.NdJ("click",function(){const _=M.CHM(i).$implicit,x=M.oxw(2);return M.KtG(x.flyto(_))}),M.TgZ(1,"h6"),M._uU(2),M.qZA(),M.TgZ(3,"p"),M._uU(4),M.qZA(),M.TgZ(5,"button",11),M.NdJ("click",function(){const _=M.CHM(i).$implicit,x=M.oxw(2);return M.KtG(x.getDirections(x.transport,_))}),M._uU(6," Direcciones "),M.qZA()()}if(2&o){const i=n.$implicit,a=M.oxw(2);M.ekj("active",i.id===a.selectedId),M.xp6(2),M.Oqu(i.text_es),M.xp6(2),M.Oqu(i.place_name),M.xp6(1),M.Q6J("ngClass",i.id===a.selectedId?"btn-outline-light":"btn-outline-primary")}}function F4(o,n){if(1&o&&(M.TgZ(0,"ul",8),M.YNc(1,N4,7,5,"li",9),M.qZA()),2&o){const i=M.oxw();M.xp6(1),M.Q6J("ngForOf",i.places)}}let z4=(()=>{class o{constructor(i,a){this.placesServices=i,this.mapService=a,this.transport="walking",this.selectedId=""}get isLodingPlaces(){return this.placesServices.isLoadingPlaces}get places(){return this.placesServices.places}getDirections(i,a){if(!this.placesServices.userLocation)throw Error("No hay userLocation");this.placesServices.upPlaces(),this.mapService.getRouteBetweenPoints(i,this.placesServices.userLocation,a.center)}flyto(i){this.selectedId=i.id;const[a,h]=i.center;this.mapService.flyTo({lng:a,lat:h})}updateTransport(i){this.transport=i}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(aT),M.Y36(gS))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-search-results"]],decls:13,vars:4,consts:[["class","list-group mt-2",4,"ngIf"],[1,"form-check"],["type","checkbox","id","driving-traffic",1,"form-check-input",3,"checked","change"],["for","driving-traffic",1,"form-check-label"],["type","checkbox","id","walking",1,"form-check-input",3,"checked","change"],["for","walking",1,"form-check-label"],["type","checkbox","id","cycling",1,"form-check-input",3,"checked","change"],["for","cycling",1,"form-check-label"],[1,"list-group","mt-2"],["class","list-group-item list-group-item pointer active",3,"active","click",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item","pointer","active",3,"click"],[1,"btn","btn-sm",3,"ngClass","click"]],template:function(a,h){1&a&&(M.YNc(0,F4,2,1,"ul",0),M.TgZ(1,"div",1)(2,"input",2),M.NdJ("change",function(){return h.updateTransport("driving-traffic")}),M.qZA(),M.TgZ(3,"label",3),M._uU(4,"Driving"),M.qZA()(),M.TgZ(5,"div",1)(6,"input",4),M.NdJ("change",function(){return h.updateTransport("walking")}),M.qZA(),M.TgZ(7,"label",5),M._uU(8,"Walking"),M.qZA()(),M.TgZ(9,"div",1)(10,"input",6),M.NdJ("change",function(){return h.updateTransport("cycling")}),M.qZA(),M.TgZ(11,"label",7),M._uU(12,"Cycling"),M.qZA()()),2&a&&(M.Q6J("ngIf",h.places.length>0),M.xp6(2),M.Q6J("checked","driving-traffic"===h.transport),M.xp6(4),M.Q6J("checked","walking"===h.transport),M.xp6(4),M.Q6J("checked","cycling"===h.transport))},dependencies:[cd,ml,Ua],styles:[".pointer[_ngcontent-%COMP%]{cursor:pointer}p[_ngcontent-%COMP%]{font-size:12px}"]})}return o})(),B4=(()=>{class o{constructor(i){this.placesService=i,this.searchTabOpen=!0}onQueryChanged(i=""){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.placesService.getPlacesByQuery(i)},350)}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(aT))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-search-bar"]],decls:4,vars:0,consts:[[1,"search-container"],["type","text","placeholder","Buscar lugar...",1,"form-control",3,"keyup"],["txtQuery",""]],template:function(a,h){if(1&a){const _=M.EpF();M.TgZ(0,"div",0)(1,"input",1,2),M.NdJ("keyup",function(){M.CHM(_);const S=M.MAs(2);return M.KtG(h.onQueryChanged(S.value))}),M.qZA(),M._UZ(3,"app-search-results"),M.qZA()}},dependencies:[z4],styles:[".search-container[_ngcontent-%COMP%]{position:fixed;top:20px;left:20px;width:250px;background-color:#fff;padding:5px;box-shadow:0 10px 10px #0000001a;border-radius:5px;border:1px solid rgb(0,0,0,.1)}"]})}return o})(),U4=(()=>{class o{constructor(i){this.mapService=i,this.selectedTime=""}onTimeSelectionChange(i){this.mapService.distancePolyline(this.selectedTime)}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(gS))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-ubication-range"]],decls:11,vars:1,consts:[["for","tiempoCombo"],["id","tiempoCombo",3,"ngModel","ngModelChange","change"],["value","","disabled","","selected",""],["value","15"],["value","30"],["value","60"]],template:function(a,h){1&a&&(M.TgZ(0,"label",0),M._uU(1,"Selecciona un tiempo:"),M.qZA(),M.TgZ(2,"select",1),M.NdJ("ngModelChange",function(x){return h.selectedTime=x})("change",function(){return h.onTimeSelectionChange(h.selectedTime)}),M.TgZ(3,"option",2),M._uU(4,"Selecciona un tiempo"),M.qZA(),M.TgZ(5,"option",3),M._uU(6,"15 minutos"),M.qZA(),M.TgZ(7,"option",4),M._uU(8,"30 minutos"),M.qZA(),M.TgZ(9,"option",5),M._uU(10,"60 minutos"),M.qZA()()),2&a&&(M.xp6(2),M.Q6J("ngModel",h.selectedTime))},dependencies:[xk,Ck,fA,GO,ZO],styles:["select[_ngcontent-%COMP%]{position:fixed;top:20px;right:170px;z-index:inherit;padding:10px;font-size:16px;border:2px solid #ccc;border-radius:5px;background-color:#fff;color:#333;cursor:pointer;outline:none}select[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:focus{border-color:#66afe9}"]})}return o})();function V4(o,n){1&o&&M._UZ(0,"app-loading")}function j4(o,n){1&o&&M._UZ(0,"app-map-view")(1,"app-btn-my-location")(2,"app-search-bar")(3,"app-ubication-range")}let $4=(()=>{class o{constructor(i){this.placesService=i}get isUserLocationReady(){return this.placesService.isUserLocationReady}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(aT))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-map-screen"]],decls:4,vars:2,consts:[[4,"ngIf","ngIfElse"],["mapReady",""]],template:function(a,h){if(1&a&&(M.YNc(0,V4,1,0,"app-loading",0),M.YNc(1,j4,4,0,"ng-template",null,1,M.W1O),M._UZ(3,"app-ubication-range")),2&a){const _=M.MAs(2);M.Q6J("ngIf",!h.isUserLocationReady)("ngIfElse",_)}},dependencies:[Ua,k4,R4,L4,B4,U4]})}return o})();function G4(o,n){if(1&o&&(M.TgZ(0,"div")(1,"p"),M._uU(2),M.qZA()()),2&o){const i=M.oxw().$implicit;M.xp6(2),M.hij("Categor\xedas: ",i.categories.join(", "),"")}}function H4(o,n){if(1&o){const i=M.EpF();M.TgZ(0,"div",2)(1,"div",3)(2,"h4"),M._uU(3),M.qZA(),M.TgZ(4,"p"),M._uU(5),M.qZA(),M.TgZ(6,"p"),M._uU(7),M.qZA(),M.YNc(8,G4,3,1,"div",4),M.TgZ(9,"button",5),M.NdJ("click",function(){const _=M.CHM(i).$implicit,x=M.oxw();return M.KtG(x.onClickDelete(_))}),M._uU(10,"Borrar"),M.qZA()()()}if(2&o){const i=n.$implicit;M.xp6(3),M.Oqu(i.name),M.xp6(2),M.Oqu(i.description),M.xp6(2),M.AsE("Coordenadas: ",i.latitude," / ",i.longitude,""),M.xp6(1),M.Q6J("ngIf",i.categories&&i.categories.length>0)}}let q4=(()=>{class o{constructor(i){this.placesService=i}ngOnInit(){this.placesService.places$.subscribe(i=>{this.places=i})}onClickDelete(i){var a=this;return(0,Je.Z)(function*(){const h=yield a.placesService.deletePlace(i);console.log(h)})()}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(P2))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-place-list"]],decls:2,vars:1,consts:[[1,"places"],["class","place",4,"ngFor","ngForOf"],[1,"place"],[1,"info"],[4,"ngIf"],[1,"btn","btn-outline-danger",3,"click"]],template:function(a,h){1&a&&(M.TgZ(0,"div",0),M.YNc(1,H4,11,5,"div",1),M.qZA()),2&a&&(M.xp6(1),M.Q6J("ngForOf",h.places))},dependencies:[ml,Ua],styles:[".place[_ngcontent-%COMP%]{border:1px solid black;border-radius:20px;display:grid;grid-template-columns:1fr 3fr;overflow:hidden;margin-bottom:20px}.place[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{padding:10px 20px}.place[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{background-size:cover;background-position:center}"]})}return o})();function Z4(o,n){if(1&o){const i=M.EpF();M.TgZ(0,"div")(1,"div",10)(2,"input",11),M.NdJ("change",function(){const _=M.CHM(i).$implicit,x=M.oxw();return M.KtG(x.toggleCategory(_))}),M.qZA(),M._uU(3),M.qZA()()}if(2&o){const i=n.$implicit,a=M.oxw();M.xp6(2),M.Q6J("checked",a.formulario.value.categories.includes(i)),M.xp6(1),M.hij(" ",i," ")}}let W4=(()=>{class o{constructor(i){this.placesService=i,this.categories=["cultural","historia","familiar","naturaleza","parques","museos","diversion"],this.formulario=new qO({name:new Rm,latitude:new Rm,longitude:new Rm,description:new Rm,image:new Rm(null),categories:new DD([])}),alert(this.categories)}ngOnInit(){}toggleCategory(i){const a=this.formulario.get("categories"),h=a.value.indexOf(i);-1!==h?a.removeAt(h):a.push(new Rm(i))}onImageSelected(i){this.formulario.patchValue({image:i.target.files[0]})}onSubmit(){var i=this;return(0,Je.Z)(function*(){const a=i.formulario.value;if(a.image){const _=yield i.placesService.uploadImage(a.image);a.imageURL=_}const h=yield i.placesService.addPlace(a);console.log(h)})()}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(P2))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-new-place"]],decls:26,vars:2,consts:[[3,"formGroup","ngSubmit"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","name",1,"form-control"],["cols","30","rows","10","formControlName","description",1,"form-control"],["type","text","formControlName","latitude",1,"form-control"],["type","text","formControlName","longitude",1,"form-control"],["type","file","accept","image/*",1,"form-control",3,"change"],[4,"ngFor","ngForOf"],["type","submit","value","Enviar",1,"btn","btn-info"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"checked","change"]],template:function(a,h){1&a&&(M.TgZ(0,"form",0),M.NdJ("ngSubmit",function(){return h.onSubmit()}),M.TgZ(1,"div",1)(2,"label",2),M._uU(3,"Name"),M.qZA(),M._UZ(4,"input",3),M.qZA(),M.TgZ(5,"div",1)(6,"label",2),M._uU(7,"Description"),M.qZA(),M._UZ(8,"textarea",4),M.qZA(),M.TgZ(9,"div",1)(10,"label",2),M._uU(11,"Latitude"),M.qZA(),M._UZ(12,"input",5),M.qZA(),M.TgZ(13,"div",1)(14,"label",2),M._uU(15,"Longitude"),M.qZA(),M._UZ(16,"input",6),M.qZA(),M.TgZ(17,"div",1)(18,"label",2),M._uU(19,"Image"),M.qZA(),M.TgZ(20,"input",7),M.NdJ("change",function(x){return h.onImageSelected(x)}),M.qZA()(),M.TgZ(21,"div",1)(22,"label",2),M._uU(23,"Categories"),M.qZA(),M.YNc(24,Z4,4,2,"div",8),M.qZA(),M._UZ(25,"input",9),M.qZA()),2&a&&(M.Q6J("formGroup",h.formulario),M.xp6(24),M.Q6J("ngForOf",h.categories))},dependencies:[ED,Gr,GO,_D,hA,SD,ml]})}return o})(),K4=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-screen-upload-location"]],decls:5,vars:0,consts:[[1,"form"],[1,"list"]],template:function(a,h){1&a&&(M.TgZ(0,"main")(1,"section",0),M._UZ(2,"app-new-place"),M.qZA(),M.TgZ(3,"section",1),M._UZ(4,"app-place-list"),M.qZA()())},dependencies:[q4,W4],styles:["main[_ngcontent-%COMP%]{max-width:1000px;margin:20px auto;display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;gap:40px}"]})}return o})();const Y4=[{path:"",component:I4},{path:"download",component:A4},{path:"login",component:Dz},{path:"sign-up",component:kz},{path:"about",component:S4},{path:"maps",component:$4,canActivate:[GA]},{path:"dashboard",component:P4,canActivate:[GA]},{path:"admin-place",component:(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-admin-place"]],decls:26,vars:0,consts:[[1,"container-fluid"],[1,"row"],[1,"navbar","navbar-expand","navbar-light","bg-light","w-100"],[1,"container"],["href","#",1,"navbar-brand"],["type","button","data-toggle","collapse","data-target","#navbarNav","aria-controls","navbarNav","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav","ml-auto"],[1,"nav-item"],["href","#",1,"nav-link"],[1,"nav-item","dropdown"],["href","#","id","navbarDropdown","role","button","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"nav-link","dropdown-toggle"],["src","url_de_la_imagen_del_usuario","alt","Usuario","width","30","height","30",1,"rounded-circle"],["aria-labelledby","navbarDropdown",1,"dropdown-menu"],["href","#",1,"dropdown-item"],[1,"dropdown-divider"],["role","main",1,"col-md-10","ml-sm-auto","col-lg-10","px-md-4"]],template:function(a,h){1&a&&(M.TgZ(0,"div",0)(1,"div",1)(2,"nav",2)(3,"div",3)(4,"a",4),M._uU(5,"Admin Place"),M.qZA(),M.TgZ(6,"button",5),M._UZ(7,"span",6),M.qZA(),M.TgZ(8,"div",7)(9,"ul",8)(10,"li",9)(11,"a",10),M._uU(12,"Nuevo Correo"),M.qZA()(),M.TgZ(13,"li",11)(14,"a",12),M._UZ(15,"img",13),M.qZA(),M.TgZ(16,"div",14)(17,"a",15),M._uU(18,"Perfil"),M.qZA(),M.TgZ(19,"a",15),M._uU(20,"Configuraci\xf3n"),M.qZA(),M._UZ(21,"div",16),M.TgZ(22,"a",15),M._uU(23,"Cerrar sesi\xf3n"),M.qZA()()()()()()(),M.TgZ(24,"main",17),M._UZ(25,"app-screen-upload-location"),M.qZA()()())},dependencies:[K4],styles:["@charset \"UTF-8\";\n\n\n\n\n[_ngcontent-%COMP%]:root, [data-bs-theme=light][_ngcontent-%COMP%]{--bs-blue:#0d6efd;--bs-indigo:#6610f2;--bs-purple:#6f42c1;--bs-pink:#d63384;--bs-red:#dc3545;--bs-orange:#fd7e14;--bs-yellow:#ffc107;--bs-green:#198754;--bs-teal:#20c997;--bs-cyan:#0dcaf0;--bs-black:#000;--bs-white:#fff;--bs-gray:#6c757d;--bs-gray-dark:#343a40;--bs-gray-100:#f8f9fa;--bs-gray-200:#e9ecef;--bs-gray-300:#dee2e6;--bs-gray-400:#ced4da;--bs-gray-500:#adb5bd;--bs-gray-600:#6c757d;--bs-gray-700:#495057;--bs-gray-800:#343a40;--bs-gray-900:#212529;--bs-primary:#0d6efd;--bs-secondary:#6c757d;--bs-success:#198754;--bs-info:#0dcaf0;--bs-warning:#ffc107;--bs-danger:#dc3545;--bs-light:#f8f9fa;--bs-dark:#212529;--bs-primary-rgb:13,110,253;--bs-secondary-rgb:108,117,125;--bs-success-rgb:25,135,84;--bs-info-rgb:13,202,240;--bs-warning-rgb:255,193,7;--bs-danger-rgb:220,53,69;--bs-light-rgb:248,249,250;--bs-dark-rgb:33,37,41;--bs-primary-text-emphasis:#052c65;--bs-secondary-text-emphasis:#2b2f32;--bs-success-text-emphasis:#0a3622;--bs-info-text-emphasis:#055160;--bs-warning-text-emphasis:#664d03;--bs-danger-text-emphasis:#58151c;--bs-light-text-emphasis:#495057;--bs-dark-text-emphasis:#495057;--bs-primary-bg-subtle:#cfe2ff;--bs-secondary-bg-subtle:#e2e3e5;--bs-success-bg-subtle:#d1e7dd;--bs-info-bg-subtle:#cff4fc;--bs-warning-bg-subtle:#fff3cd;--bs-danger-bg-subtle:#f8d7da;--bs-light-bg-subtle:#fcfcfd;--bs-dark-bg-subtle:#ced4da;--bs-primary-border-subtle:#9ec5fe;--bs-secondary-border-subtle:#c4c8cb;--bs-success-border-subtle:#a3cfbb;--bs-info-border-subtle:#9eeaf9;--bs-warning-border-subtle:#ffe69c;--bs-danger-border-subtle:#f1aeb5;--bs-light-border-subtle:#e9ecef;--bs-dark-border-subtle:#adb5bd;--bs-white-rgb:255,255,255;--bs-black-rgb:0,0,0;--bs-font-sans-serif:system-ui,-apple-system,\"Segoe UI\",Roboto,\"Helvetica Neue\",\"Noto Sans\",\"Liberation Sans\",Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\",\"Segoe UI Symbol\",\"Noto Color Emoji\";--bs-font-monospace:SFMono-Regular,Menlo,Monaco,Consolas,\"Liberation Mono\",\"Courier New\",monospace;--bs-gradient:linear-gradient(180deg, rgba(255, 255, 255, .15), rgba(255, 255, 255, 0));--bs-body-font-family:var(--bs-font-sans-serif);--bs-body-font-size:1rem;--bs-body-font-weight:400;--bs-body-line-height:1.5;--bs-body-color:#212529;--bs-body-color-rgb:33,37,41;--bs-body-bg:#fff;--bs-body-bg-rgb:255,255,255;--bs-emphasis-color:#000;--bs-emphasis-color-rgb:0,0,0;--bs-secondary-color:rgba(33, 37, 41, .75);--bs-secondary-color-rgb:33,37,41;--bs-secondary-bg:#e9ecef;--bs-secondary-bg-rgb:233,236,239;--bs-tertiary-color:rgba(33, 37, 41, .5);--bs-tertiary-color-rgb:33,37,41;--bs-tertiary-bg:#f8f9fa;--bs-tertiary-bg-rgb:248,249,250;--bs-heading-color:inherit;--bs-link-color:#0d6efd;--bs-link-color-rgb:13,110,253;--bs-link-decoration:underline;--bs-link-hover-color:#0a58ca;--bs-link-hover-color-rgb:10,88,202;--bs-code-color:#d63384;--bs-highlight-color:#212529;--bs-highlight-bg:#fff3cd;--bs-border-width:1px;--bs-border-style:solid;--bs-border-color:#dee2e6;--bs-border-color-translucent:rgba(0, 0, 0, .175);--bs-border-radius:.375rem;--bs-border-radius-sm:.25rem;--bs-border-radius-lg:.5rem;--bs-border-radius-xl:1rem;--bs-border-radius-xxl:2rem;--bs-border-radius-2xl:var(--bs-border-radius-xxl);--bs-border-radius-pill:50rem;--bs-box-shadow:0 .5rem 1rem rgba(0, 0, 0, .15);--bs-box-shadow-sm:0 .125rem .25rem rgba(0, 0, 0, .075);--bs-box-shadow-lg:0 1rem 3rem rgba(0, 0, 0, .175);--bs-box-shadow-inset:inset 0 1px 2px rgba(0, 0, 0, .075);--bs-focus-ring-width:.25rem;--bs-focus-ring-opacity:.25;--bs-focus-ring-color:rgba(13, 110, 253, .25);--bs-form-valid-color:#198754;--bs-form-valid-border-color:#198754;--bs-form-invalid-color:#dc3545;--bs-form-invalid-border-color:#dc3545}[data-bs-theme=dark][_ngcontent-%COMP%]{color-scheme:dark;--bs-body-color:#dee2e6;--bs-body-color-rgb:222,226,230;--bs-body-bg:#212529;--bs-body-bg-rgb:33,37,41;--bs-emphasis-color:#fff;--bs-emphasis-color-rgb:255,255,255;--bs-secondary-color:rgba(222, 226, 230, .75);--bs-secondary-color-rgb:222,226,230;--bs-secondary-bg:#343a40;--bs-secondary-bg-rgb:52,58,64;--bs-tertiary-color:rgba(222, 226, 230, .5);--bs-tertiary-color-rgb:222,226,230;--bs-tertiary-bg:#2b3035;--bs-tertiary-bg-rgb:43,48,53;--bs-primary-text-emphasis:#6ea8fe;--bs-secondary-text-emphasis:#a7acb1;--bs-success-text-emphasis:#75b798;--bs-info-text-emphasis:#6edff6;--bs-warning-text-emphasis:#ffda6a;--bs-danger-text-emphasis:#ea868f;--bs-light-text-emphasis:#f8f9fa;--bs-dark-text-emphasis:#dee2e6;--bs-primary-bg-subtle:#031633;--bs-secondary-bg-subtle:#161719;--bs-success-bg-subtle:#051b11;--bs-info-bg-subtle:#032830;--bs-warning-bg-subtle:#332701;--bs-danger-bg-subtle:#2c0b0e;--bs-light-bg-subtle:#343a40;--bs-dark-bg-subtle:#1a1d20;--bs-primary-border-subtle:#084298;--bs-secondary-border-subtle:#41464b;--bs-success-border-subtle:#0f5132;--bs-info-border-subtle:#087990;--bs-warning-border-subtle:#997404;--bs-danger-border-subtle:#842029;--bs-light-border-subtle:#495057;--bs-dark-border-subtle:#343a40;--bs-heading-color:inherit;--bs-link-color:#6ea8fe;--bs-link-hover-color:#8bb9fe;--bs-link-color-rgb:110,168,254;--bs-link-hover-color-rgb:139,185,254;--bs-code-color:#e685b5;--bs-highlight-color:#dee2e6;--bs-highlight-bg:#664d03;--bs-border-color:#495057;--bs-border-color-translucent:rgba(255, 255, 255, .15);--bs-form-valid-color:#75b798;--bs-form-valid-border-color:#75b798;--bs-form-invalid-color:#ea868f;--bs-form-invalid-border-color:#ea868f}*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:after, [_ngcontent-%COMP%]:before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){[_ngcontent-%COMP%]:root{scroll-behavior:smooth}}body[_ngcontent-%COMP%]{margin:0;font-family:var(--bs-body-font-family);font-size:var(--bs-body-font-size);font-weight:var(--bs-body-font-weight);line-height:var(--bs-body-line-height);color:var(--bs-body-color);text-align:var(--bs-body-text-align);background-color:var(--bs-body-bg);-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr[_ngcontent-%COMP%]{margin:1rem 0;color:inherit;border:0;border-top:var(--bs-border-width) solid;opacity:.25}.h1[_ngcontent-%COMP%], .h2[_ngcontent-%COMP%], .h3[_ngcontent-%COMP%], .h4[_ngcontent-%COMP%], .h5[_ngcontent-%COMP%], .h6[_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2;color:var(--bs-heading-color)}.h1[_ngcontent-%COMP%], h1[_ngcontent-%COMP%]{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){.h1[_ngcontent-%COMP%], h1[_ngcontent-%COMP%]{font-size:2.5rem}}.h2[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){.h2[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{font-size:2rem}}.h3[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){.h3[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{font-size:1.75rem}}.h4[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){.h4[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{font-size:1.5rem}}.h5[_ngcontent-%COMP%], h5[_ngcontent-%COMP%]{font-size:1.25rem}.h6[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{font-size:1rem}p[_ngcontent-%COMP%]{margin-top:0;margin-bottom:1rem}abbr[title][_ngcontent-%COMP%]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address[_ngcontent-%COMP%]{margin-bottom:1rem;font-style:normal;line-height:inherit}ol[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]{padding-left:2rem}dl[_ngcontent-%COMP%], ol[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]{margin-top:0;margin-bottom:1rem}ol[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%], ol[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-bottom:0}dt[_ngcontent-%COMP%]{font-weight:700}dd[_ngcontent-%COMP%]{margin-bottom:.5rem;margin-left:0}blockquote[_ngcontent-%COMP%]{margin:0 0 1rem}b[_ngcontent-%COMP%], strong[_ngcontent-%COMP%]{font-weight:bolder}.small[_ngcontent-%COMP%], small[_ngcontent-%COMP%]{font-size:.875em}.mark[_ngcontent-%COMP%], mark[_ngcontent-%COMP%]{padding:.1875em;color:var(--bs-highlight-color);background-color:var(--bs-highlight-bg)}sub[_ngcontent-%COMP%], sup[_ngcontent-%COMP%]{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub[_ngcontent-%COMP%]{bottom:-.25em}sup[_ngcontent-%COMP%]{top:-.5em}a[_ngcontent-%COMP%]{color:rgba(var(--bs-link-color-rgb),var(--bs-link-opacity,1));text-decoration:underline}a[_ngcontent-%COMP%]:hover{--bs-link-color-rgb:var(--bs-link-hover-color-rgb)}a[_ngcontent-%COMP%]:not([href]):not([class]), a[_ngcontent-%COMP%]:not([href]):not([class]):hover{color:inherit;text-decoration:none}code[_ngcontent-%COMP%], kbd[_ngcontent-%COMP%], pre[_ngcontent-%COMP%], samp[_ngcontent-%COMP%]{font-family:var(--bs-font-monospace);font-size:1em}pre[_ngcontent-%COMP%]{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{font-size:inherit;color:inherit;word-break:normal}code[_ngcontent-%COMP%]{font-size:.875em;color:var(--bs-code-color);word-wrap:break-word}a[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{color:inherit}kbd[_ngcontent-%COMP%]{padding:.1875rem .375rem;font-size:.875em;color:var(--bs-body-bg);background-color:var(--bs-body-color);border-radius:.25rem}kbd[_ngcontent-%COMP%]   kbd[_ngcontent-%COMP%]{padding:0;font-size:1em}figure[_ngcontent-%COMP%]{margin:0 0 1rem}img[_ngcontent-%COMP%], svg[_ngcontent-%COMP%]{vertical-align:middle}table[_ngcontent-%COMP%]{caption-side:bottom;border-collapse:collapse}caption[_ngcontent-%COMP%]{padding-top:.5rem;padding-bottom:.5rem;color:var(--bs-secondary-color);text-align:left}th[_ngcontent-%COMP%]{text-align:inherit;text-align:-webkit-match-parent}tbody[_ngcontent-%COMP%], td[_ngcontent-%COMP%], tfoot[_ngcontent-%COMP%], th[_ngcontent-%COMP%], thead[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]{border-color:inherit;border-style:solid;border-width:0}label[_ngcontent-%COMP%]{display:inline-block}button[_ngcontent-%COMP%]{border-radius:0}button[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:0}button[_ngcontent-%COMP%], input[_ngcontent-%COMP%], optgroup[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{text-transform:none}[role=button][_ngcontent-%COMP%]{cursor:pointer}select[_ngcontent-%COMP%]{word-wrap:normal}select[_ngcontent-%COMP%]:disabled{opacity:1}[list][_ngcontent-%COMP%]:not([type=date]):not([type=datetime-local]):not([type=month]):not([type=week]):not([type=time])::-webkit-calendar-picker-indicator{display:none!important}[type=button][_ngcontent-%COMP%], [type=reset][_ngcontent-%COMP%], [type=submit][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{-webkit-appearance:button}[type=button][_ngcontent-%COMP%]:not(:disabled), [type=reset][_ngcontent-%COMP%]:not(:disabled), [type=submit][_ngcontent-%COMP%]:not(:disabled), button[_ngcontent-%COMP%]:not(:disabled){cursor:pointer}[_ngcontent-%COMP%]::-moz-focus-inner{padding:0;border-style:none}textarea[_ngcontent-%COMP%]{resize:vertical}fieldset[_ngcontent-%COMP%]{min-width:0;padding:0;margin:0;border:0}legend[_ngcontent-%COMP%]{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend[_ngcontent-%COMP%]{font-size:1.5rem}}legend[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{clear:left}[_ngcontent-%COMP%]::-webkit-datetime-edit-day-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-fields-wrapper, [_ngcontent-%COMP%]::-webkit-datetime-edit-hour-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-minute, [_ngcontent-%COMP%]::-webkit-datetime-edit-month-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-text, [_ngcontent-%COMP%]::-webkit-datetime-edit-year-field{padding:0}[_ngcontent-%COMP%]::-webkit-inner-spin-button{height:auto}[type=search][_ngcontent-%COMP%]{-webkit-appearance:textfield;outline-offset:-2px}[_ngcontent-%COMP%]::-webkit-search-decoration{-webkit-appearance:none}[_ngcontent-%COMP%]::-webkit-color-swatch-wrapper{padding:0}[_ngcontent-%COMP%]::file-selector-button{font:inherit;-webkit-appearance:button}output[_ngcontent-%COMP%]{display:inline-block}iframe[_ngcontent-%COMP%]{border:0}summary[_ngcontent-%COMP%]{display:list-item;cursor:pointer}progress[_ngcontent-%COMP%]{vertical-align:baseline}[hidden][_ngcontent-%COMP%]{display:none!important}.lead[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:300}.display-1[_ngcontent-%COMP%]{font-size:calc(1.625rem + 4.5vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-1[_ngcontent-%COMP%]{font-size:5rem}}.display-2[_ngcontent-%COMP%]{font-size:calc(1.575rem + 3.9vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-2[_ngcontent-%COMP%]{font-size:4.5rem}}.display-3[_ngcontent-%COMP%]{font-size:calc(1.525rem + 3.3vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-3[_ngcontent-%COMP%]{font-size:4rem}}.display-4[_ngcontent-%COMP%]{font-size:calc(1.475rem + 2.7vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-4[_ngcontent-%COMP%]{font-size:3.5rem}}.display-5[_ngcontent-%COMP%]{font-size:calc(1.425rem + 2.1vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-5[_ngcontent-%COMP%]{font-size:3rem}}.display-6[_ngcontent-%COMP%]{font-size:calc(1.375rem + 1.5vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-6[_ngcontent-%COMP%]{font-size:2.5rem}}.list-unstyled[_ngcontent-%COMP%], .list-inline[_ngcontent-%COMP%]{padding-left:0;list-style:none}.list-inline-item[_ngcontent-%COMP%]{display:inline-block}.list-inline-item[_ngcontent-%COMP%]:not(:last-child){margin-right:.5rem}.initialism[_ngcontent-%COMP%]{font-size:.875em;text-transform:uppercase}.blockquote[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1.25rem}.blockquote[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:last-child{margin-bottom:0}.blockquote-footer[_ngcontent-%COMP%]{margin-top:-1rem;margin-bottom:1rem;font-size:.875em;color:#6c757d}.blockquote-footer[_ngcontent-%COMP%]:before{content:\"\\2014\\a0\"}.img-fluid[_ngcontent-%COMP%]{max-width:100%;height:auto}.img-thumbnail[_ngcontent-%COMP%]{padding:.25rem;background-color:var(--bs-body-bg);border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius);max-width:100%;height:auto}.figure[_ngcontent-%COMP%]{display:inline-block}.figure-img[_ngcontent-%COMP%]{margin-bottom:.5rem;line-height:1}.figure-caption[_ngcontent-%COMP%]{font-size:.875em;color:var(--bs-secondary-color)}.container[_ngcontent-%COMP%], .container-fluid[_ngcontent-%COMP%], .container-lg[_ngcontent-%COMP%], .container-md[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%], .container-xl[_ngcontent-%COMP%], .container-xxl[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem;--bs-gutter-y:0;width:100%;padding-right:calc(var(--bs-gutter-x) * .5);padding-left:calc(var(--bs-gutter-x) * .5);margin-right:auto;margin-left:auto}@media (min-width:576px){.container[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%]{max-width:540px}}@media (min-width:768px){.container[_ngcontent-%COMP%], .container-md[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%]{max-width:720px}}@media (min-width:992px){.container[_ngcontent-%COMP%], .container-lg[_ngcontent-%COMP%], .container-md[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%]{max-width:960px}}@media (min-width:1200px){.container[_ngcontent-%COMP%], .container-lg[_ngcontent-%COMP%], .container-md[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%], .container-xl[_ngcontent-%COMP%]{max-width:1140px}}@media (min-width:1400px){.container[_ngcontent-%COMP%], .container-lg[_ngcontent-%COMP%], .container-md[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%], .container-xl[_ngcontent-%COMP%], .container-xxl[_ngcontent-%COMP%]{max-width:1320px}}[_ngcontent-%COMP%]:root{--bs-breakpoint-xs:0;--bs-breakpoint-sm:576px;--bs-breakpoint-md:768px;--bs-breakpoint-lg:992px;--bs-breakpoint-xl:1200px;--bs-breakpoint-xxl:1400px}.row[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem;--bs-gutter-y:0;display:flex;flex-wrap:wrap;margin-top:calc(-1 * var(--bs-gutter-y));margin-right:calc(-.5 * var(--bs-gutter-x));margin-left:calc(-.5 * var(--bs-gutter-x))}.row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex-shrink:0;width:100%;max-width:100%;padding-right:calc(var(--bs-gutter-x) * .5);padding-left:calc(var(--bs-gutter-x) * .5);margin-top:var(--bs-gutter-y)}.col[_ngcontent-%COMP%]{flex:1 0 0%}.row-cols-auto[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.row-cols-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.row-cols-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.row-cols-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.row-cols-4[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.row-cols-5[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:20%}.row-cols-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-auto[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.col-1[_ngcontent-%COMP%]{flex:0 0 auto;width:8.33333333%}.col-2[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-3[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.col-4[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.col-5[_ngcontent-%COMP%]{flex:0 0 auto;width:41.66666667%}.col-6[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.col-7[_ngcontent-%COMP%]{flex:0 0 auto;width:58.33333333%}.col-8[_ngcontent-%COMP%]{flex:0 0 auto;width:66.66666667%}.col-9[_ngcontent-%COMP%]{flex:0 0 auto;width:75%}.col-10[_ngcontent-%COMP%]{flex:0 0 auto;width:83.33333333%}.col-11[_ngcontent-%COMP%]{flex:0 0 auto;width:91.66666667%}.col-12[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.offset-1[_ngcontent-%COMP%]{margin-left:8.33333333%}.offset-2[_ngcontent-%COMP%]{margin-left:16.66666667%}.offset-3[_ngcontent-%COMP%]{margin-left:25%}.offset-4[_ngcontent-%COMP%]{margin-left:33.33333333%}.offset-5[_ngcontent-%COMP%]{margin-left:41.66666667%}.offset-6[_ngcontent-%COMP%]{margin-left:50%}.offset-7[_ngcontent-%COMP%]{margin-left:58.33333333%}.offset-8[_ngcontent-%COMP%]{margin-left:66.66666667%}.offset-9[_ngcontent-%COMP%]{margin-left:75%}.offset-10[_ngcontent-%COMP%]{margin-left:83.33333333%}.offset-11[_ngcontent-%COMP%]{margin-left:91.66666667%}.g-0[_ngcontent-%COMP%], .gx-0[_ngcontent-%COMP%]{--bs-gutter-x:0}.g-0[_ngcontent-%COMP%], .gy-0[_ngcontent-%COMP%]{--bs-gutter-y:0}.g-1[_ngcontent-%COMP%], .gx-1[_ngcontent-%COMP%]{--bs-gutter-x:.25rem}.g-1[_ngcontent-%COMP%], .gy-1[_ngcontent-%COMP%]{--bs-gutter-y:.25rem}.g-2[_ngcontent-%COMP%], .gx-2[_ngcontent-%COMP%]{--bs-gutter-x:.5rem}.g-2[_ngcontent-%COMP%], .gy-2[_ngcontent-%COMP%]{--bs-gutter-y:.5rem}.g-3[_ngcontent-%COMP%], .gx-3[_ngcontent-%COMP%]{--bs-gutter-x:1rem}.g-3[_ngcontent-%COMP%], .gy-3[_ngcontent-%COMP%]{--bs-gutter-y:1rem}.g-4[_ngcontent-%COMP%], .gx-4[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem}.g-4[_ngcontent-%COMP%], .gy-4[_ngcontent-%COMP%]{--bs-gutter-y:1.5rem}.g-5[_ngcontent-%COMP%], .gx-5[_ngcontent-%COMP%]{--bs-gutter-x:3rem}.g-5[_ngcontent-%COMP%], .gy-5[_ngcontent-%COMP%]{--bs-gutter-y:3rem}@media (min-width:576px){.col-sm[_ngcontent-%COMP%]{flex:1 0 0%}.row-cols-sm-auto[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.row-cols-sm-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.row-cols-sm-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.row-cols-sm-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.row-cols-sm-4[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.row-cols-sm-5[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:20%}.row-cols-sm-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-sm-auto[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.col-sm-1[_ngcontent-%COMP%]{flex:0 0 auto;width:8.33333333%}.col-sm-2[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-sm-3[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.col-sm-4[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.col-sm-5[_ngcontent-%COMP%]{flex:0 0 auto;width:41.66666667%}.col-sm-6[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.col-sm-7[_ngcontent-%COMP%]{flex:0 0 auto;width:58.33333333%}.col-sm-8[_ngcontent-%COMP%]{flex:0 0 auto;width:66.66666667%}.col-sm-9[_ngcontent-%COMP%]{flex:0 0 auto;width:75%}.col-sm-10[_ngcontent-%COMP%]{flex:0 0 auto;width:83.33333333%}.col-sm-11[_ngcontent-%COMP%]{flex:0 0 auto;width:91.66666667%}.col-sm-12[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.offset-sm-0[_ngcontent-%COMP%]{margin-left:0}.offset-sm-1[_ngcontent-%COMP%]{margin-left:8.33333333%}.offset-sm-2[_ngcontent-%COMP%]{margin-left:16.66666667%}.offset-sm-3[_ngcontent-%COMP%]{margin-left:25%}.offset-sm-4[_ngcontent-%COMP%]{margin-left:33.33333333%}.offset-sm-5[_ngcontent-%COMP%]{margin-left:41.66666667%}.offset-sm-6[_ngcontent-%COMP%]{margin-left:50%}.offset-sm-7[_ngcontent-%COMP%]{margin-left:58.33333333%}.offset-sm-8[_ngcontent-%COMP%]{margin-left:66.66666667%}.offset-sm-9[_ngcontent-%COMP%]{margin-left:75%}.offset-sm-10[_ngcontent-%COMP%]{margin-left:83.33333333%}.offset-sm-11[_ngcontent-%COMP%]{margin-left:91.66666667%}.g-sm-0[_ngcontent-%COMP%], .gx-sm-0[_ngcontent-%COMP%]{--bs-gutter-x:0}.g-sm-0[_ngcontent-%COMP%], .gy-sm-0[_ngcontent-%COMP%]{--bs-gutter-y:0}.g-sm-1[_ngcontent-%COMP%], .gx-sm-1[_ngcontent-%COMP%]{--bs-gutter-x:.25rem}.g-sm-1[_ngcontent-%COMP%], .gy-sm-1[_ngcontent-%COMP%]{--bs-gutter-y:.25rem}.g-sm-2[_ngcontent-%COMP%], .gx-sm-2[_ngcontent-%COMP%]{--bs-gutter-x:.5rem}.g-sm-2[_ngcontent-%COMP%], .gy-sm-2[_ngcontent-%COMP%]{--bs-gutter-y:.5rem}.g-sm-3[_ngcontent-%COMP%], .gx-sm-3[_ngcontent-%COMP%]{--bs-gutter-x:1rem}.g-sm-3[_ngcontent-%COMP%], .gy-sm-3[_ngcontent-%COMP%]{--bs-gutter-y:1rem}.g-sm-4[_ngcontent-%COMP%], .gx-sm-4[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem}.g-sm-4[_ngcontent-%COMP%], .gy-sm-4[_ngcontent-%COMP%]{--bs-gutter-y:1.5rem}.g-sm-5[_ngcontent-%COMP%], .gx-sm-5[_ngcontent-%COMP%]{--bs-gutter-x:3rem}.g-sm-5[_ngcontent-%COMP%], .gy-sm-5[_ngcontent-%COMP%]{--bs-gutter-y:3rem}}@media (min-width:768px){.col-md[_ngcontent-%COMP%]{flex:1 0 0%}.row-cols-md-auto[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.row-cols-md-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.row-cols-md-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.row-cols-md-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.row-cols-md-4[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.row-cols-md-5[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:20%}.row-cols-md-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-md-auto[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.col-md-1[_ngcontent-%COMP%]{flex:0 0 auto;width:8.33333333%}.col-md-2[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-md-3[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.col-md-4[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.col-md-5[_ngcontent-%COMP%]{flex:0 0 auto;width:41.66666667%}.col-md-6[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.col-md-7[_ngcontent-%COMP%]{flex:0 0 auto;width:58.33333333%}.col-md-8[_ngcontent-%COMP%]{flex:0 0 auto;width:66.66666667%}.col-md-9[_ngcontent-%COMP%]{flex:0 0 auto;width:75%}.col-md-10[_ngcontent-%COMP%]{flex:0 0 auto;width:83.33333333%}.col-md-11[_ngcontent-%COMP%]{flex:0 0 auto;width:91.66666667%}.col-md-12[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.offset-md-0[_ngcontent-%COMP%]{margin-left:0}.offset-md-1[_ngcontent-%COMP%]{margin-left:8.33333333%}.offset-md-2[_ngcontent-%COMP%]{margin-left:16.66666667%}.offset-md-3[_ngcontent-%COMP%]{margin-left:25%}.offset-md-4[_ngcontent-%COMP%]{margin-left:33.33333333%}.offset-md-5[_ngcontent-%COMP%]{margin-left:41.66666667%}.offset-md-6[_ngcontent-%COMP%]{margin-left:50%}.offset-md-7[_ngcontent-%COMP%]{margin-left:58.33333333%}.offset-md-8[_ngcontent-%COMP%]{margin-left:66.66666667%}.offset-md-9[_ngcontent-%COMP%]{margin-left:75%}.offset-md-10[_ngcontent-%COMP%]{margin-left:83.33333333%}.offset-md-11[_ngcontent-%COMP%]{margin-left:91.66666667%}.g-md-0[_ngcontent-%COMP%], .gx-md-0[_ngcontent-%COMP%]{--bs-gutter-x:0}.g-md-0[_ngcontent-%COMP%], .gy-md-0[_ngcontent-%COMP%]{--bs-gutter-y:0}.g-md-1[_ngcontent-%COMP%], .gx-md-1[_ngcontent-%COMP%]{--bs-gutter-x:.25rem}.g-md-1[_ngcontent-%COMP%], .gy-md-1[_ngcontent-%COMP%]{--bs-gutter-y:.25rem}.g-md-2[_ngcontent-%COMP%], .gx-md-2[_ngcontent-%COMP%]{--bs-gutter-x:.5rem}.g-md-2[_ngcontent-%COMP%], .gy-md-2[_ngcontent-%COMP%]{--bs-gutter-y:.5rem}.g-md-3[_ngcontent-%COMP%], .gx-md-3[_ngcontent-%COMP%]{--bs-gutter-x:1rem}.g-md-3[_ngcontent-%COMP%], .gy-md-3[_ngcontent-%COMP%]{--bs-gutter-y:1rem}.g-md-4[_ngcontent-%COMP%], .gx-md-4[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem}.g-md-4[_ngcontent-%COMP%], .gy-md-4[_ngcontent-%COMP%]{--bs-gutter-y:1.5rem}.g-md-5[_ngcontent-%COMP%], .gx-md-5[_ngcontent-%COMP%]{--bs-gutter-x:3rem}.g-md-5[_ngcontent-%COMP%], .gy-md-5[_ngcontent-%COMP%]{--bs-gutter-y:3rem}}@media (min-width:992px){.col-lg[_ngcontent-%COMP%]{flex:1 0 0%}.row-cols-lg-auto[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.row-cols-lg-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.row-cols-lg-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.row-cols-lg-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.row-cols-lg-4[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.row-cols-lg-5[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:20%}.row-cols-lg-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-lg-auto[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.col-lg-1[_ngcontent-%COMP%]{flex:0 0 auto;width:8.33333333%}.col-lg-2[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-lg-3[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.col-lg-4[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.col-lg-5[_ngcontent-%COMP%]{flex:0 0 auto;width:41.66666667%}.col-lg-6[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.col-lg-7[_ngcontent-%COMP%]{flex:0 0 auto;width:58.33333333%}.col-lg-8[_ngcontent-%COMP%]{flex:0 0 auto;width:66.66666667%}.col-lg-9[_ngcontent-%COMP%]{flex:0 0 auto;width:75%}.col-lg-10[_ngcontent-%COMP%]{flex:0 0 auto;width:83.33333333%}.col-lg-11[_ngcontent-%COMP%]{flex:0 0 auto;width:91.66666667%}.col-lg-12[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.offset-lg-0[_ngcontent-%COMP%]{margin-left:0}.offset-lg-1[_ngcontent-%COMP%]{margin-left:8.33333333%}.offset-lg-2[_ngcontent-%COMP%]{margin-left:16.66666667%}.offset-lg-3[_ngcontent-%COMP%]{margin-left:25%}.offset-lg-4[_ngcontent-%COMP%]{margin-left:33.33333333%}.offset-lg-5[_ngcontent-%COMP%]{margin-left:41.66666667%}.offset-lg-6[_ngcontent-%COMP%]{margin-left:50%}.offset-lg-7[_ngcontent-%COMP%]{margin-left:58.33333333%}.offset-lg-8[_ngcontent-%COMP%]{margin-left:66.66666667%}.offset-lg-9[_ngcontent-%COMP%]{margin-left:75%}.offset-lg-10[_ngcontent-%COMP%]{margin-left:83.33333333%}.offset-lg-11[_ngcontent-%COMP%]{margin-left:91.66666667%}.g-lg-0[_ngcontent-%COMP%], .gx-lg-0[_ngcontent-%COMP%]{--bs-gutter-x:0}.g-lg-0[_ngcontent-%COMP%], .gy-lg-0[_ngcontent-%COMP%]{--bs-gutter-y:0}.g-lg-1[_ngcontent-%COMP%], .gx-lg-1[_ngcontent-%COMP%]{--bs-gutter-x:.25rem}.g-lg-1[_ngcontent-%COMP%], .gy-lg-1[_ngcontent-%COMP%]{--bs-gutter-y:.25rem}.g-lg-2[_ngcontent-%COMP%], .gx-lg-2[_ngcontent-%COMP%]{--bs-gutter-x:.5rem}.g-lg-2[_ngcontent-%COMP%], .gy-lg-2[_ngcontent-%COMP%]{--bs-gutter-y:.5rem}.g-lg-3[_ngcontent-%COMP%], .gx-lg-3[_ngcontent-%COMP%]{--bs-gutter-x:1rem}.g-lg-3[_ngcontent-%COMP%], .gy-lg-3[_ngcontent-%COMP%]{--bs-gutter-y:1rem}.g-lg-4[_ngcontent-%COMP%], .gx-lg-4[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem}.g-lg-4[_ngcontent-%COMP%], .gy-lg-4[_ngcontent-%COMP%]{--bs-gutter-y:1.5rem}.g-lg-5[_ngcontent-%COMP%], .gx-lg-5[_ngcontent-%COMP%]{--bs-gutter-x:3rem}.g-lg-5[_ngcontent-%COMP%], .gy-lg-5[_ngcontent-%COMP%]{--bs-gutter-y:3rem}}@media (min-width:1200px){.col-xl[_ngcontent-%COMP%]{flex:1 0 0%}.row-cols-xl-auto[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.row-cols-xl-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.row-cols-xl-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.row-cols-xl-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.row-cols-xl-4[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.row-cols-xl-5[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:20%}.row-cols-xl-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-xl-auto[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.col-xl-1[_ngcontent-%COMP%]{flex:0 0 auto;width:8.33333333%}.col-xl-2[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-xl-3[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.col-xl-4[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.col-xl-5[_ngcontent-%COMP%]{flex:0 0 auto;width:41.66666667%}.col-xl-6[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.col-xl-7[_ngcontent-%COMP%]{flex:0 0 auto;width:58.33333333%}.col-xl-8[_ngcontent-%COMP%]{flex:0 0 auto;width:66.66666667%}.col-xl-9[_ngcontent-%COMP%]{flex:0 0 auto;width:75%}.col-xl-10[_ngcontent-%COMP%]{flex:0 0 auto;width:83.33333333%}.col-xl-11[_ngcontent-%COMP%]{flex:0 0 auto;width:91.66666667%}.col-xl-12[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.offset-xl-0[_ngcontent-%COMP%]{margin-left:0}.offset-xl-1[_ngcontent-%COMP%]{margin-left:8.33333333%}.offset-xl-2[_ngcontent-%COMP%]{margin-left:16.66666667%}.offset-xl-3[_ngcontent-%COMP%]{margin-left:25%}.offset-xl-4[_ngcontent-%COMP%]{margin-left:33.33333333%}.offset-xl-5[_ngcontent-%COMP%]{margin-left:41.66666667%}.offset-xl-6[_ngcontent-%COMP%]{margin-left:50%}.offset-xl-7[_ngcontent-%COMP%]{margin-left:58.33333333%}.offset-xl-8[_ngcontent-%COMP%]{margin-left:66.66666667%}.offset-xl-9[_ngcontent-%COMP%]{margin-left:75%}.offset-xl-10[_ngcontent-%COMP%]{margin-left:83.33333333%}.offset-xl-11[_ngcontent-%COMP%]{margin-left:91.66666667%}.g-xl-0[_ngcontent-%COMP%], .gx-xl-0[_ngcontent-%COMP%]{--bs-gutter-x:0}.g-xl-0[_ngcontent-%COMP%], .gy-xl-0[_ngcontent-%COMP%]{--bs-gutter-y:0}.g-xl-1[_ngcontent-%COMP%], .gx-xl-1[_ngcontent-%COMP%]{--bs-gutter-x:.25rem}.g-xl-1[_ngcontent-%COMP%], .gy-xl-1[_ngcontent-%COMP%]{--bs-gutter-y:.25rem}.g-xl-2[_ngcontent-%COMP%], .gx-xl-2[_ngcontent-%COMP%]{--bs-gutter-x:.5rem}.g-xl-2[_ngcontent-%COMP%], .gy-xl-2[_ngcontent-%COMP%]{--bs-gutter-y:.5rem}.g-xl-3[_ngcontent-%COMP%], .gx-xl-3[_ngcontent-%COMP%]{--bs-gutter-x:1rem}.g-xl-3[_ngcontent-%COMP%], .gy-xl-3[_ngcontent-%COMP%]{--bs-gutter-y:1rem}.g-xl-4[_ngcontent-%COMP%], .gx-xl-4[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem}.g-xl-4[_ngcontent-%COMP%], .gy-xl-4[_ngcontent-%COMP%]{--bs-gutter-y:1.5rem}.g-xl-5[_ngcontent-%COMP%], .gx-xl-5[_ngcontent-%COMP%]{--bs-gutter-x:3rem}.g-xl-5[_ngcontent-%COMP%], .gy-xl-5[_ngcontent-%COMP%]{--bs-gutter-y:3rem}}@media (min-width:1400px){.col-xxl[_ngcontent-%COMP%]{flex:1 0 0%}.row-cols-xxl-auto[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.row-cols-xxl-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.row-cols-xxl-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.row-cols-xxl-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.row-cols-xxl-4[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.row-cols-xxl-5[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:20%}.row-cols-xxl-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-xxl-auto[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.col-xxl-1[_ngcontent-%COMP%]{flex:0 0 auto;width:8.33333333%}.col-xxl-2[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-xxl-3[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.col-xxl-4[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.col-xxl-5[_ngcontent-%COMP%]{flex:0 0 auto;width:41.66666667%}.col-xxl-6[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.col-xxl-7[_ngcontent-%COMP%]{flex:0 0 auto;width:58.33333333%}.col-xxl-8[_ngcontent-%COMP%]{flex:0 0 auto;width:66.66666667%}.col-xxl-9[_ngcontent-%COMP%]{flex:0 0 auto;width:75%}.col-xxl-10[_ngcontent-%COMP%]{flex:0 0 auto;width:83.33333333%}.col-xxl-11[_ngcontent-%COMP%]{flex:0 0 auto;width:91.66666667%}.col-xxl-12[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.offset-xxl-0[_ngcontent-%COMP%]{margin-left:0}.offset-xxl-1[_ngcontent-%COMP%]{margin-left:8.33333333%}.offset-xxl-2[_ngcontent-%COMP%]{margin-left:16.66666667%}.offset-xxl-3[_ngcontent-%COMP%]{margin-left:25%}.offset-xxl-4[_ngcontent-%COMP%]{margin-left:33.33333333%}.offset-xxl-5[_ngcontent-%COMP%]{margin-left:41.66666667%}.offset-xxl-6[_ngcontent-%COMP%]{margin-left:50%}.offset-xxl-7[_ngcontent-%COMP%]{margin-left:58.33333333%}.offset-xxl-8[_ngcontent-%COMP%]{margin-left:66.66666667%}.offset-xxl-9[_ngcontent-%COMP%]{margin-left:75%}.offset-xxl-10[_ngcontent-%COMP%]{margin-left:83.33333333%}.offset-xxl-11[_ngcontent-%COMP%]{margin-left:91.66666667%}.g-xxl-0[_ngcontent-%COMP%], .gx-xxl-0[_ngcontent-%COMP%]{--bs-gutter-x:0}.g-xxl-0[_ngcontent-%COMP%], .gy-xxl-0[_ngcontent-%COMP%]{--bs-gutter-y:0}.g-xxl-1[_ngcontent-%COMP%], .gx-xxl-1[_ngcontent-%COMP%]{--bs-gutter-x:.25rem}.g-xxl-1[_ngcontent-%COMP%], .gy-xxl-1[_ngcontent-%COMP%]{--bs-gutter-y:.25rem}.g-xxl-2[_ngcontent-%COMP%], .gx-xxl-2[_ngcontent-%COMP%]{--bs-gutter-x:.5rem}.g-xxl-2[_ngcontent-%COMP%], .gy-xxl-2[_ngcontent-%COMP%]{--bs-gutter-y:.5rem}.g-xxl-3[_ngcontent-%COMP%], .gx-xxl-3[_ngcontent-%COMP%]{--bs-gutter-x:1rem}.g-xxl-3[_ngcontent-%COMP%], .gy-xxl-3[_ngcontent-%COMP%]{--bs-gutter-y:1rem}.g-xxl-4[_ngcontent-%COMP%], .gx-xxl-4[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem}.g-xxl-4[_ngcontent-%COMP%], .gy-xxl-4[_ngcontent-%COMP%]{--bs-gutter-y:1.5rem}.g-xxl-5[_ngcontent-%COMP%], .gx-xxl-5[_ngcontent-%COMP%]{--bs-gutter-x:3rem}.g-xxl-5[_ngcontent-%COMP%], .gy-xxl-5[_ngcontent-%COMP%]{--bs-gutter-y:3rem}}.table[_ngcontent-%COMP%]{--bs-table-color-type:initial;--bs-table-bg-type:initial;--bs-table-color-state:initial;--bs-table-bg-state:initial;--bs-table-color:var(--bs-emphasis-color);--bs-table-bg:var(--bs-body-bg);--bs-table-border-color:var(--bs-border-color);--bs-table-accent-bg:transparent;--bs-table-striped-color:var(--bs-emphasis-color);--bs-table-striped-bg:rgba(var(--bs-emphasis-color-rgb), .05);--bs-table-active-color:var(--bs-emphasis-color);--bs-table-active-bg:rgba(var(--bs-emphasis-color-rgb), .1);--bs-table-hover-color:var(--bs-emphasis-color);--bs-table-hover-bg:rgba(var(--bs-emphasis-color-rgb), .075);width:100%;margin-bottom:1rem;vertical-align:top;border-color:var(--bs-table-border-color)}.table[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.5rem;color:var(--bs-table-color-state,var(--bs-table-color-type,var(--bs-table-color)));background-color:var(--bs-table-bg);border-bottom-width:var(--bs-border-width);box-shadow:inset 0 0 0 9999px var(--bs-table-bg-state,var(--bs-table-bg-type,var(--bs-table-accent-bg)))}.table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%]{vertical-align:inherit}.table[_ngcontent-%COMP%] > thead[_ngcontent-%COMP%]{vertical-align:bottom}.table-group-divider[_ngcontent-%COMP%]{border-top:calc(var(--bs-border-width) * 2) solid currentcolor}.caption-top[_ngcontent-%COMP%]{caption-side:top}.table-sm[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.25rem}.table-bordered[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%]{border-width:var(--bs-border-width) 0}.table-bordered[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border-width:0 var(--bs-border-width)}.table-borderless[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border-bottom-width:0}.table-borderless[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:first-child){border-top-width:0}.table-striped[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:nth-of-type(odd) > *[_ngcontent-%COMP%]{--bs-table-color-type:var(--bs-table-striped-color);--bs-table-bg-type:var(--bs-table-striped-bg)}.table-striped-columns[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > tr[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:nth-child(2n){--bs-table-color-type:var(--bs-table-striped-color);--bs-table-bg-type:var(--bs-table-striped-bg)}.table-active[_ngcontent-%COMP%]{--bs-table-color-state:var(--bs-table-active-color);--bs-table-bg-state:var(--bs-table-active-bg)}.table-hover[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover > *[_ngcontent-%COMP%]{--bs-table-color-state:var(--bs-table-hover-color);--bs-table-bg-state:var(--bs-table-hover-bg)}.table-primary[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#cfe2ff;--bs-table-border-color:#a6b5cc;--bs-table-striped-bg:#c5d7f2;--bs-table-striped-color:#000;--bs-table-active-bg:#bacbe6;--bs-table-active-color:#000;--bs-table-hover-bg:#bfd1ec;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-secondary[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#e2e3e5;--bs-table-border-color:#b5b6b7;--bs-table-striped-bg:#d7d8da;--bs-table-striped-color:#000;--bs-table-active-bg:#cbccce;--bs-table-active-color:#000;--bs-table-hover-bg:#d1d2d4;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-success[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#d1e7dd;--bs-table-border-color:#a7b9b1;--bs-table-striped-bg:#c7dbd2;--bs-table-striped-color:#000;--bs-table-active-bg:#bcd0c7;--bs-table-active-color:#000;--bs-table-hover-bg:#c1d6cc;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-info[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#cff4fc;--bs-table-border-color:#a6c3ca;--bs-table-striped-bg:#c5e8ef;--bs-table-striped-color:#000;--bs-table-active-bg:#badce3;--bs-table-active-color:#000;--bs-table-hover-bg:#bfe2e9;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-warning[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#fff3cd;--bs-table-border-color:#ccc2a4;--bs-table-striped-bg:#f2e7c3;--bs-table-striped-color:#000;--bs-table-active-bg:#e6dbb9;--bs-table-active-color:#000;--bs-table-hover-bg:#ece1be;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-danger[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#f8d7da;--bs-table-border-color:#c6acae;--bs-table-striped-bg:#eccccf;--bs-table-striped-color:#000;--bs-table-active-bg:#dfc2c4;--bs-table-active-color:#000;--bs-table-hover-bg:#e5c7ca;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-light[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#f8f9fa;--bs-table-border-color:#c6c7c8;--bs-table-striped-bg:#ecedee;--bs-table-striped-color:#000;--bs-table-active-bg:#dfe0e1;--bs-table-active-color:#000;--bs-table-hover-bg:#e5e6e7;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-dark[_ngcontent-%COMP%]{--bs-table-color:#fff;--bs-table-bg:#212529;--bs-table-border-color:#4d5154;--bs-table-striped-bg:#2c3034;--bs-table-striped-color:#fff;--bs-table-active-bg:#373b3e;--bs-table-active-color:#fff;--bs-table-hover-bg:#323539;--bs-table-hover-color:#fff;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}@media (max-width:575.98px){.table-responsive-sm[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:767.98px){.table-responsive-md[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:991.98px){.table-responsive-lg[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:1199.98px){.table-responsive-xl[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:1399.98px){.table-responsive-xxl[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}.form-label[_ngcontent-%COMP%]{margin-bottom:.5rem}.col-form-label[_ngcontent-%COMP%]{padding-top:calc(.375rem + var(--bs-border-width));padding-bottom:calc(.375rem + var(--bs-border-width));margin-bottom:0;font-size:inherit;line-height:1.5}.col-form-label-lg[_ngcontent-%COMP%]{padding-top:calc(.5rem + var(--bs-border-width));padding-bottom:calc(.5rem + var(--bs-border-width));font-size:1.25rem}.col-form-label-sm[_ngcontent-%COMP%]{padding-top:calc(.25rem + var(--bs-border-width));padding-bottom:calc(.25rem + var(--bs-border-width));font-size:.875rem}.form-text[_ngcontent-%COMP%]{margin-top:.25rem;font-size:.875em;color:var(--bs-secondary-color)}.form-control[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:var(--bs-body-color);appearance:none;background-color:var(--bs-body-bg);background-clip:padding-box;border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius);transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control[_ngcontent-%COMP%]{transition:none}}.form-control[type=file][_ngcontent-%COMP%]{overflow:hidden}.form-control[type=file][_ngcontent-%COMP%]:not(:disabled):not([readonly]){cursor:pointer}.form-control[_ngcontent-%COMP%]:focus{color:var(--bs-body-color);background-color:var(--bs-body-bg);border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem #0d6efd40}.form-control[_ngcontent-%COMP%]::-webkit-date-and-time-value{min-width:85px;height:1.5em;margin:0}.form-control[_ngcontent-%COMP%]::-webkit-datetime-edit{display:block;padding:0}.form-control[_ngcontent-%COMP%]::placeholder{color:var(--bs-secondary-color);opacity:1}.form-control[_ngcontent-%COMP%]:disabled{background-color:var(--bs-secondary-bg);opacity:1}.form-control[_ngcontent-%COMP%]::file-selector-button{padding:.375rem .75rem;margin:-.375rem -.75rem;margin-inline-end:.75rem;color:var(--bs-body-color);background-color:var(--bs-tertiary-bg);pointer-events:none;border-color:inherit;border-style:solid;border-width:0;border-inline-end-width:var(--bs-border-width);border-radius:0;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control[_ngcontent-%COMP%]::file-selector-button{transition:none}}.form-control[_ngcontent-%COMP%]:hover:not(:disabled):not([readonly])::file-selector-button{background-color:var(--bs-secondary-bg)}.form-control-plaintext[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem 0;margin-bottom:0;line-height:1.5;color:var(--bs-body-color);background-color:transparent;border:solid transparent;border-width:var(--bs-border-width) 0}.form-control-plaintext[_ngcontent-%COMP%]:focus{outline:0}.form-control-plaintext.form-control-lg[_ngcontent-%COMP%], .form-control-plaintext.form-control-sm[_ngcontent-%COMP%]{padding-right:0;padding-left:0}.form-control-sm[_ngcontent-%COMP%]{min-height:calc(1.5em + .5rem + calc(var(--bs-border-width) * 2));padding:.25rem .5rem;font-size:.875rem;border-radius:var(--bs-border-radius-sm)}.form-control-sm[_ngcontent-%COMP%]::file-selector-button{padding:.25rem .5rem;margin:-.25rem -.5rem;margin-inline-end:.5rem}.form-control-lg[_ngcontent-%COMP%]{min-height:calc(1.5em + 1rem + calc(var(--bs-border-width) * 2));padding:.5rem 1rem;font-size:1.25rem;border-radius:var(--bs-border-radius-lg)}.form-control-lg[_ngcontent-%COMP%]::file-selector-button{padding:.5rem 1rem;margin:-.5rem -1rem;margin-inline-end:1rem}textarea.form-control[_ngcontent-%COMP%]{min-height:calc(1.5em + .75rem + calc(var(--bs-border-width) * 2))}textarea.form-control-sm[_ngcontent-%COMP%]{min-height:calc(1.5em + .5rem + calc(var(--bs-border-width) * 2))}textarea.form-control-lg[_ngcontent-%COMP%]{min-height:calc(1.5em + 1rem + calc(var(--bs-border-width) * 2))}.form-control-color[_ngcontent-%COMP%]{width:3rem;height:calc(1.5em + .75rem + calc(var(--bs-border-width) * 2));padding:.375rem}.form-control-color[_ngcontent-%COMP%]:not(:disabled):not([readonly]){cursor:pointer}.form-control-color[_ngcontent-%COMP%]::-moz-color-swatch{border:0!important;border-radius:var(--bs-border-radius)}.form-control-color[_ngcontent-%COMP%]::-webkit-color-swatch{border:0!important;border-radius:var(--bs-border-radius)}.form-control-color.form-control-sm[_ngcontent-%COMP%]{height:calc(1.5em + .5rem + calc(var(--bs-border-width) * 2))}.form-control-color.form-control-lg[_ngcontent-%COMP%]{height:calc(1.5em + 1rem + calc(var(--bs-border-width) * 2))}.form-select[_ngcontent-%COMP%]{--bs-form-select-bg-img:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e\");display:block;width:100%;padding:.375rem 2.25rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:var(--bs-body-color);appearance:none;background-color:var(--bs-body-bg);background-image:var(--bs-form-select-bg-img),var(--bs-form-select-bg-icon,none);background-repeat:no-repeat;background-position:right .75rem center;background-size:16px 12px;border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius);transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-select[_ngcontent-%COMP%]{transition:none}}.form-select[_ngcontent-%COMP%]:focus{border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem #0d6efd40}.form-select[multiple][_ngcontent-%COMP%], .form-select[size][_ngcontent-%COMP%]:not([size=\"1\"]){padding-right:.75rem;background-image:none}.form-select[_ngcontent-%COMP%]:disabled{background-color:var(--bs-secondary-bg)}.form-select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 var(--bs-body-color)}.form-select-sm[_ngcontent-%COMP%]{padding-top:.25rem;padding-bottom:.25rem;padding-left:.5rem;font-size:.875rem;border-radius:var(--bs-border-radius-sm)}.form-select-lg[_ngcontent-%COMP%]{padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem;border-radius:var(--bs-border-radius-lg)}[data-bs-theme=dark][_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{--bs-form-select-bg-img:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23dee2e6' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e\")}.form-check[_ngcontent-%COMP%]{display:block;min-height:1.5rem;padding-left:1.5em;margin-bottom:.125rem}.form-check[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{float:left;margin-left:-1.5em}.form-check-reverse[_ngcontent-%COMP%]{padding-right:1.5em;padding-left:0;text-align:right}.form-check-reverse[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{float:right;margin-right:-1.5em;margin-left:0}.form-check-input[_ngcontent-%COMP%]{--bs-form-check-bg:var(--bs-body-bg);flex-shrink:0;width:1em;height:1em;margin-top:.25em;vertical-align:top;appearance:none;background-color:var(--bs-form-check-bg);background-image:var(--bs-form-check-bg-image);background-repeat:no-repeat;background-position:center;background-size:contain;border:var(--bs-border-width) solid var(--bs-border-color);-webkit-print-color-adjust:exact;print-color-adjust:exact}.form-check-input[type=checkbox][_ngcontent-%COMP%]{border-radius:.25em}.form-check-input[type=radio][_ngcontent-%COMP%]{border-radius:50%}.form-check-input[_ngcontent-%COMP%]:active{filter:brightness(90%)}.form-check-input[_ngcontent-%COMP%]:focus{border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem #0d6efd40}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#0d6efd;border-color:#0d6efd}.form-check-input[_ngcontent-%COMP%]:checked[type=checkbox]{--bs-form-check-bg-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='3' d='m6 10 3 3 6-6'/%3e%3c/svg%3e\")}.form-check-input[_ngcontent-%COMP%]:checked[type=radio]{--bs-form-check-bg-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='2' fill='%23fff'/%3e%3c/svg%3e\")}.form-check-input[type=checkbox][_ngcontent-%COMP%]:indeterminate{background-color:#0d6efd;border-color:#0d6efd;--bs-form-check-bg-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='3' d='M6 10h8'/%3e%3c/svg%3e\")}.form-check-input[_ngcontent-%COMP%]:disabled{pointer-events:none;filter:none;opacity:.5}.form-check-input[_ngcontent-%COMP%]:disabled ~ .form-check-label[_ngcontent-%COMP%], .form-check-input[disabled][_ngcontent-%COMP%] ~ .form-check-label[_ngcontent-%COMP%]{cursor:default;opacity:.5}.form-switch[_ngcontent-%COMP%]{padding-left:2.5em}.form-switch[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{--bs-form-switch-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='rgba%280, 0, 0, 0.25%29'/%3e%3c/svg%3e\");width:2em;margin-left:-2.5em;background-image:var(--bs-form-switch-bg);background-position:left center;border-radius:2em;transition:background-position .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-switch[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{transition:none}}.form-switch[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:focus{--bs-form-switch-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%2386b7fe'/%3e%3c/svg%3e\")}.form-switch[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:checked{background-position:right center;--bs-form-switch-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%23fff'/%3e%3c/svg%3e\")}.form-switch.form-check-reverse[_ngcontent-%COMP%]{padding-right:2.5em;padding-left:0}.form-switch.form-check-reverse[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{margin-right:-2.5em;margin-left:0}.form-check-inline[_ngcontent-%COMP%]{display:inline-block;margin-right:1rem}.btn-check[_ngcontent-%COMP%]{position:absolute;clip:rect(0,0,0,0);pointer-events:none}.btn-check[_ngcontent-%COMP%]:disabled + .btn[_ngcontent-%COMP%], .btn-check[disabled][_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{pointer-events:none;filter:none;opacity:.65}[data-bs-theme=dark][_ngcontent-%COMP%]   .form-switch[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:not(:checked):not(:focus){--bs-form-switch-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='rgba%28255, 255, 255, 0.25%29'/%3e%3c/svg%3e\")}.form-range[_ngcontent-%COMP%]{width:100%;height:1.5rem;padding:0;appearance:none;background-color:transparent}.form-range[_ngcontent-%COMP%]:focus{outline:0}.form-range[_ngcontent-%COMP%]:focus::-webkit-slider-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .25rem #0d6efd40}.form-range[_ngcontent-%COMP%]:focus::-moz-range-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .25rem #0d6efd40}.form-range[_ngcontent-%COMP%]::-moz-focus-outer{border:0}.form-range[_ngcontent-%COMP%]::-webkit-slider-thumb{width:1rem;height:1rem;margin-top:-.25rem;appearance:none;background-color:#0d6efd;border:0;border-radius:1rem;-webkit-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-range[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-transition:none;transition:none}}.form-range[_ngcontent-%COMP%]::-webkit-slider-thumb:active{background-color:#b6d4fe}.form-range[_ngcontent-%COMP%]::-webkit-slider-runnable-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:var(--bs-secondary-bg);border-color:transparent;border-radius:1rem}.form-range[_ngcontent-%COMP%]::-moz-range-thumb{width:1rem;height:1rem;appearance:none;background-color:#0d6efd;border:0;border-radius:1rem;-moz-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-range[_ngcontent-%COMP%]::-moz-range-thumb{-moz-transition:none;transition:none}}.form-range[_ngcontent-%COMP%]::-moz-range-thumb:active{background-color:#b6d4fe}.form-range[_ngcontent-%COMP%]::-moz-range-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:var(--bs-secondary-bg);border-color:transparent;border-radius:1rem}.form-range[_ngcontent-%COMP%]:disabled{pointer-events:none}.form-range[_ngcontent-%COMP%]:disabled::-webkit-slider-thumb{background-color:var(--bs-secondary-color)}.form-range[_ngcontent-%COMP%]:disabled::-moz-range-thumb{background-color:var(--bs-secondary-color)}.form-floating[_ngcontent-%COMP%]{position:relative}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]{height:calc(3.5rem + calc(var(--bs-border-width) * 2));min-height:calc(3.5rem + calc(var(--bs-border-width) * 2));line-height:1.25}.form-floating[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:2;height:100%;padding:1rem .75rem;overflow:hidden;text-align:start;text-overflow:ellipsis;white-space:nowrap;pointer-events:none;border:var(--bs-border-width) solid transparent;transform-origin:0 0;transition:opacity .1s ease-in-out,transform .1s ease-in-out}@media (prefers-reduced-motion:reduce){.form-floating[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{transition:none}}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%]{padding:1rem .75rem}.form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%]::placeholder, .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]::placeholder{color:transparent}.form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%]:focus, .form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%]:not(:placeholder-shown), .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:focus, .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:placeholder-shown){padding-top:1.625rem;padding-bottom:.625rem}.form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%]:-webkit-autofill, .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:-webkit-autofill{padding-top:1.625rem;padding-bottom:.625rem}.form-floating[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]{padding-top:1.625rem;padding-bottom:.625rem}.form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%] ~ label[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:placeholder-shown) ~ label[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%] ~ label[_ngcontent-%COMP%]{color:rgba(var(--bs-body-color-rgb),.65);transform:scale(.85) translateY(-.5rem) translate(.15rem)}.form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%] ~ label[_ngcontent-%COMP%]:after, .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%]:after, .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:placeholder-shown) ~ label[_ngcontent-%COMP%]:after, .form-floating[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%] ~ label[_ngcontent-%COMP%]:after{position:absolute;inset:1rem .375rem;z-index:-1;height:1.5em;content:\"\";background-color:var(--bs-body-bg);border-radius:var(--bs-border-radius)}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label[_ngcontent-%COMP%]{color:rgba(var(--bs-body-color-rgb),.65);transform:scale(.85) translateY(-.5rem) translate(.15rem)}.form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%] ~ label[_ngcontent-%COMP%]{border-width:var(--bs-border-width) 0}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:disabled ~ label[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:disabled ~ label[_ngcontent-%COMP%]{color:#6c757d}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:disabled ~ label[_ngcontent-%COMP%]:after, .form-floating[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:disabled ~ label[_ngcontent-%COMP%]:after{background-color:var(--bs-secondary-bg)}.input-group[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.input-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]{position:relative;flex:1 1 auto;width:1%;min-width:0}.input-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:focus, .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:focus-within, .input-group[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:focus{z-index:5}.input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{position:relative;z-index:2}.input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:focus{z-index:5}.input-group-text[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:var(--bs-body-color);text-align:center;white-space:nowrap;background-color:var(--bs-tertiary-bg);border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius)}.input-group-lg[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%], .input-group-lg[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%], .input-group-lg[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%], .input-group-lg[_ngcontent-%COMP%] > .input-group-text[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:1.25rem;border-radius:var(--bs-border-radius-lg)}.input-group-sm[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%], .input-group-sm[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%], .input-group-sm[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%], .input-group-sm[_ngcontent-%COMP%] > .input-group-text[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem;border-radius:var(--bs-border-radius-sm)}.input-group-lg[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%], .input-group-sm[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]{padding-right:3rem}.input-group[_ngcontent-%COMP%]:not(.has-validation) > .dropdown-toggle[_ngcontent-%COMP%]:nth-last-child(n+3), .input-group[_ngcontent-%COMP%]:not(.has-validation) > .form-floating[_ngcontent-%COMP%]:not(:last-child) > .form-control[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]:not(.has-validation) > .form-floating[_ngcontent-%COMP%]:not(:last-child) > .form-select[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]:not(.has-validation) > [_ngcontent-%COMP%]:not(:last-child):not(.dropdown-toggle):not(.dropdown-menu):not(.form-floating){border-top-right-radius:0;border-bottom-right-radius:0}.input-group.has-validation[_ngcontent-%COMP%] > .dropdown-toggle[_ngcontent-%COMP%]:nth-last-child(n+4), .input-group.has-validation[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:nth-last-child(n+3) > .form-control[_ngcontent-%COMP%], .input-group.has-validation[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:nth-last-child(n+3) > .form-select[_ngcontent-%COMP%], .input-group.has-validation[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:nth-last-child(n+3):not(.dropdown-toggle):not(.dropdown-menu):not(.form-floating){border-top-right-radius:0;border-bottom-right-radius:0}.input-group[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:first-child):not(.dropdown-menu):not(.valid-tooltip):not(.valid-feedback):not(.invalid-tooltip):not(.invalid-feedback){margin-left:calc(var(--bs-border-width) * -1);border-top-left-radius:0;border-bottom-left-radius:0}.input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:not(:first-child) > .form-control[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:not(:first-child) > .form-select[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}.valid-feedback[_ngcontent-%COMP%]{display:none;width:100%;margin-top:.25rem;font-size:.875em;color:var(--bs-form-valid-color)}.valid-tooltip[_ngcontent-%COMP%]{position:absolute;top:100%;z-index:5;display:none;max-width:100%;padding:.25rem .5rem;margin-top:.1rem;font-size:.875rem;color:#fff;background-color:var(--bs-success);border-radius:var(--bs-border-radius)}.is-valid[_ngcontent-%COMP%] ~ .valid-feedback[_ngcontent-%COMP%], .is-valid[_ngcontent-%COMP%] ~ .valid-tooltip[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:valid ~ .valid-feedback[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:valid ~ .valid-tooltip[_ngcontent-%COMP%]{display:block}.form-control.is-valid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:valid{border-color:var(--bs-form-valid-border-color);padding-right:calc(1.5em + .75rem);background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e\");background-repeat:no-repeat;background-position:right calc(.375em + .1875rem) center;background-size:calc(.75em + .375rem) calc(.75em + .375rem)}.form-control.is-valid[_ngcontent-%COMP%]:focus, .was-validated[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:valid:focus{border-color:var(--bs-form-valid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-success-rgb),.25)}.was-validated[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]:valid, textarea.form-control.is-valid[_ngcontent-%COMP%]{padding-right:calc(1.5em + .75rem);background-position:top calc(.375em + .1875rem) right calc(.375em + .1875rem)}.form-select.is-valid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:valid{border-color:var(--bs-form-valid-border-color)}.form-select.is-valid[_ngcontent-%COMP%]:not([multiple]):not([size]), .form-select.is-valid[_ngcontent-%COMP%]:not([multiple])[size=\"1\"], .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:valid:not([multiple]):not([size]), .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:valid:not([multiple])[size=\"1\"]{--bs-form-select-bg-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e\");padding-right:4.125rem;background-position:right .75rem center,center right 2.25rem;background-size:16px 12px,calc(.75em + .375rem) calc(.75em + .375rem)}.form-select.is-valid[_ngcontent-%COMP%]:focus, .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:valid:focus{border-color:var(--bs-form-valid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-success-rgb),.25)}.form-control-color.is-valid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-control-color[_ngcontent-%COMP%]:valid{width:calc(3.75rem + 1.5em)}.form-check-input.is-valid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:valid{border-color:var(--bs-form-valid-border-color)}.form-check-input.is-valid[_ngcontent-%COMP%]:checked, .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:valid:checked{background-color:var(--bs-form-valid-color)}.form-check-input.is-valid[_ngcontent-%COMP%]:focus, .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:valid:focus{box-shadow:0 0 0 .25rem rgba(var(--bs-success-rgb),.25)}.form-check-input.is-valid[_ngcontent-%COMP%] ~ .form-check-label[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:valid ~ .form-check-label[_ngcontent-%COMP%]{color:var(--bs-form-valid-color)}.form-check-inline[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%] ~ .valid-feedback[_ngcontent-%COMP%]{margin-left:.5em}.input-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:focus).is-valid, .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:not(:focus-within).is-valid, .input-group[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:not(:focus).is-valid, .was-validated[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:focus):valid, .was-validated[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:not(:focus-within):valid, .was-validated[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:not(:focus):valid{z-index:3}.invalid-feedback[_ngcontent-%COMP%]{display:none;width:100%;margin-top:.25rem;font-size:.875em;color:var(--bs-form-invalid-color)}.invalid-tooltip[_ngcontent-%COMP%]{position:absolute;top:100%;z-index:5;display:none;max-width:100%;padding:.25rem .5rem;margin-top:.1rem;font-size:.875rem;color:#fff;background-color:var(--bs-danger);border-radius:var(--bs-border-radius)}.is-invalid[_ngcontent-%COMP%] ~ .invalid-feedback[_ngcontent-%COMP%], .is-invalid[_ngcontent-%COMP%] ~ .invalid-tooltip[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:invalid ~ .invalid-feedback[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:invalid ~ .invalid-tooltip[_ngcontent-%COMP%]{display:block}.form-control.is-invalid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:invalid{border-color:var(--bs-form-invalid-border-color);padding-right:calc(1.5em + .75rem);background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e\");background-repeat:no-repeat;background-position:right calc(.375em + .1875rem) center;background-size:calc(.75em + .375rem) calc(.75em + .375rem)}.form-control.is-invalid[_ngcontent-%COMP%]:focus, .was-validated[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:invalid:focus{border-color:var(--bs-form-invalid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-danger-rgb),.25)}.was-validated[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]:invalid, textarea.form-control.is-invalid[_ngcontent-%COMP%]{padding-right:calc(1.5em + .75rem);background-position:top calc(.375em + .1875rem) right calc(.375em + .1875rem)}.form-select.is-invalid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:invalid{border-color:var(--bs-form-invalid-border-color)}.form-select.is-invalid[_ngcontent-%COMP%]:not([multiple]):not([size]), .form-select.is-invalid[_ngcontent-%COMP%]:not([multiple])[size=\"1\"], .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:invalid:not([multiple]):not([size]), .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:invalid:not([multiple])[size=\"1\"]{--bs-form-select-bg-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e\");padding-right:4.125rem;background-position:right .75rem center,center right 2.25rem;background-size:16px 12px,calc(.75em + .375rem) calc(.75em + .375rem)}.form-select.is-invalid[_ngcontent-%COMP%]:focus, .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:invalid:focus{border-color:var(--bs-form-invalid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-danger-rgb),.25)}.form-control-color.is-invalid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-control-color[_ngcontent-%COMP%]:invalid{width:calc(3.75rem + 1.5em)}.form-check-input.is-invalid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:invalid{border-color:var(--bs-form-invalid-border-color)}.form-check-input.is-invalid[_ngcontent-%COMP%]:checked, .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:invalid:checked{background-color:var(--bs-form-invalid-color)}.form-check-input.is-invalid[_ngcontent-%COMP%]:focus, .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:invalid:focus{box-shadow:0 0 0 .25rem rgba(var(--bs-danger-rgb),.25)}.form-check-input.is-invalid[_ngcontent-%COMP%] ~ .form-check-label[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:invalid ~ .form-check-label[_ngcontent-%COMP%]{color:var(--bs-form-invalid-color)}.form-check-inline[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%] ~ .invalid-feedback[_ngcontent-%COMP%]{margin-left:.5em}.input-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:focus).is-invalid, .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:not(:focus-within).is-invalid, .input-group[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:not(:focus).is-invalid, .was-validated[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:focus):invalid, .was-validated[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:not(:focus-within):invalid, .was-validated[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:not(:focus):invalid{z-index:4}.btn[_ngcontent-%COMP%]{--bs-btn-padding-x:.75rem;--bs-btn-padding-y:.375rem;--bs-btn-font-family: ;--bs-btn-font-size:1rem;--bs-btn-font-weight:400;--bs-btn-line-height:1.5;--bs-btn-color:var(--bs-body-color);--bs-btn-bg:transparent;--bs-btn-border-width:var(--bs-border-width);--bs-btn-border-color:transparent;--bs-btn-border-radius:var(--bs-border-radius);--bs-btn-hover-border-color:transparent;--bs-btn-box-shadow:inset 0 1px 0 rgba(255, 255, 255, .15),0 1px 1px rgba(0, 0, 0, .075);--bs-btn-disabled-opacity:.65;--bs-btn-focus-box-shadow:0 0 0 .25rem rgba(var(--bs-btn-focus-shadow-rgb), .5);display:inline-block;padding:var(--bs-btn-padding-y) var(--bs-btn-padding-x);font-family:var(--bs-btn-font-family);font-size:var(--bs-btn-font-size);font-weight:var(--bs-btn-font-weight);line-height:var(--bs-btn-line-height);color:var(--bs-btn-color);text-align:center;text-decoration:none;vertical-align:middle;cursor:pointer;-webkit-user-select:none;user-select:none;border:var(--bs-btn-border-width) solid var(--bs-btn-border-color);border-radius:var(--bs-btn-border-radius);background-color:var(--bs-btn-bg);transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.btn[_ngcontent-%COMP%]{transition:none}}.btn[_ngcontent-%COMP%]:hover{color:var(--bs-btn-hover-color);background-color:var(--bs-btn-hover-bg);border-color:var(--bs-btn-hover-border-color)}.btn-check[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]:hover{color:var(--bs-btn-color);background-color:var(--bs-btn-bg);border-color:var(--bs-btn-border-color)}.btn[_ngcontent-%COMP%]:focus-visible{color:var(--bs-btn-hover-color);background-color:var(--bs-btn-hover-bg);border-color:var(--bs-btn-hover-border-color);outline:0;box-shadow:var(--bs-btn-focus-box-shadow)}.btn-check[_ngcontent-%COMP%]:focus-visible + .btn[_ngcontent-%COMP%]{border-color:var(--bs-btn-hover-border-color);outline:0;box-shadow:var(--bs-btn-focus-box-shadow)}.btn-check[_ngcontent-%COMP%]:checked + .btn[_ngcontent-%COMP%], .btn.active[_ngcontent-%COMP%], .btn.show[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]:first-child:active, [_ngcontent-%COMP%]:not(.btn-check) + .btn[_ngcontent-%COMP%]:active{color:var(--bs-btn-active-color);background-color:var(--bs-btn-active-bg);border-color:var(--bs-btn-active-border-color)}.btn-check[_ngcontent-%COMP%]:checked + .btn[_ngcontent-%COMP%]:focus-visible, .btn.active[_ngcontent-%COMP%]:focus-visible, .btn.show[_ngcontent-%COMP%]:focus-visible, .btn[_ngcontent-%COMP%]:first-child:active:focus-visible, [_ngcontent-%COMP%]:not(.btn-check) + .btn[_ngcontent-%COMP%]:active:focus-visible{box-shadow:var(--bs-btn-focus-box-shadow)}.btn-check[_ngcontent-%COMP%]:checked:focus-visible + .btn[_ngcontent-%COMP%]{box-shadow:var(--bs-btn-focus-box-shadow)}.btn.disabled[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]:disabled, fieldset[_ngcontent-%COMP%]:disabled   .btn[_ngcontent-%COMP%]{color:var(--bs-btn-disabled-color);pointer-events:none;background-color:var(--bs-btn-disabled-bg);border-color:var(--bs-btn-disabled-border-color);opacity:var(--bs-btn-disabled-opacity)}.btn-primary[_ngcontent-%COMP%]{--bs-btn-color:#fff;--bs-btn-bg:#0d6efd;--bs-btn-border-color:#0d6efd;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#0b5ed7;--bs-btn-hover-border-color:#0a58ca;--bs-btn-focus-shadow-rgb:49,132,253;--bs-btn-active-color:#fff;--bs-btn-active-bg:#0a58ca;--bs-btn-active-border-color:#0a53be;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#0d6efd;--bs-btn-disabled-border-color:#0d6efd}.btn-secondary[_ngcontent-%COMP%]{--bs-btn-color:#fff;--bs-btn-bg:#6c757d;--bs-btn-border-color:#6c757d;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#5c636a;--bs-btn-hover-border-color:#565e64;--bs-btn-focus-shadow-rgb:130,138,145;--bs-btn-active-color:#fff;--bs-btn-active-bg:#565e64;--bs-btn-active-border-color:#51585e;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#6c757d;--bs-btn-disabled-border-color:#6c757d}.btn-success[_ngcontent-%COMP%]{--bs-btn-color:#fff;--bs-btn-bg:#198754;--bs-btn-border-color:#198754;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#157347;--bs-btn-hover-border-color:#146c43;--bs-btn-focus-shadow-rgb:60,153,110;--bs-btn-active-color:#fff;--bs-btn-active-bg:#146c43;--bs-btn-active-border-color:#13653f;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#198754;--bs-btn-disabled-border-color:#198754}.btn-info[_ngcontent-%COMP%]{--bs-btn-color:#000;--bs-btn-bg:#0dcaf0;--bs-btn-border-color:#0dcaf0;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#31d2f2;--bs-btn-hover-border-color:#25cff2;--bs-btn-focus-shadow-rgb:11,172,204;--bs-btn-active-color:#000;--bs-btn-active-bg:#3dd5f3;--bs-btn-active-border-color:#25cff2;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#000;--bs-btn-disabled-bg:#0dcaf0;--bs-btn-disabled-border-color:#0dcaf0}.btn-warning[_ngcontent-%COMP%]{--bs-btn-color:#000;--bs-btn-bg:#ffc107;--bs-btn-border-color:#ffc107;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#ffca2c;--bs-btn-hover-border-color:#ffc720;--bs-btn-focus-shadow-rgb:217,164,6;--bs-btn-active-color:#000;--bs-btn-active-bg:#ffcd39;--bs-btn-active-border-color:#ffc720;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#000;--bs-btn-disabled-bg:#ffc107;--bs-btn-disabled-border-color:#ffc107}.btn-danger[_ngcontent-%COMP%]{--bs-btn-color:#fff;--bs-btn-bg:#dc3545;--bs-btn-border-color:#dc3545;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#bb2d3b;--bs-btn-hover-border-color:#b02a37;--bs-btn-focus-shadow-rgb:225,83,97;--bs-btn-active-color:#fff;--bs-btn-active-bg:#b02a37;--bs-btn-active-border-color:#a52834;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#dc3545;--bs-btn-disabled-border-color:#dc3545}.btn-light[_ngcontent-%COMP%]{--bs-btn-color:#000;--bs-btn-bg:#f8f9fa;--bs-btn-border-color:#f8f9fa;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#d3d4d5;--bs-btn-hover-border-color:#c6c7c8;--bs-btn-focus-shadow-rgb:211,212,213;--bs-btn-active-color:#000;--bs-btn-active-bg:#c6c7c8;--bs-btn-active-border-color:#babbbc;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#000;--bs-btn-disabled-bg:#f8f9fa;--bs-btn-disabled-border-color:#f8f9fa}.btn-dark[_ngcontent-%COMP%]{--bs-btn-color:#fff;--bs-btn-bg:#212529;--bs-btn-border-color:#212529;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#424649;--bs-btn-hover-border-color:#373b3e;--bs-btn-focus-shadow-rgb:66,70,73;--bs-btn-active-color:#fff;--bs-btn-active-bg:#4d5154;--bs-btn-active-border-color:#373b3e;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#212529;--bs-btn-disabled-border-color:#212529}.btn-outline-primary[_ngcontent-%COMP%]{--bs-btn-color:#0d6efd;--bs-btn-border-color:#0d6efd;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#0d6efd;--bs-btn-hover-border-color:#0d6efd;--bs-btn-focus-shadow-rgb:13,110,253;--bs-btn-active-color:#fff;--bs-btn-active-bg:#0d6efd;--bs-btn-active-border-color:#0d6efd;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#0d6efd;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#0d6efd;--bs-gradient:none}.btn-outline-secondary[_ngcontent-%COMP%]{--bs-btn-color:#6c757d;--bs-btn-border-color:#6c757d;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#6c757d;--bs-btn-hover-border-color:#6c757d;--bs-btn-focus-shadow-rgb:108,117,125;--bs-btn-active-color:#fff;--bs-btn-active-bg:#6c757d;--bs-btn-active-border-color:#6c757d;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#6c757d;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#6c757d;--bs-gradient:none}.btn-outline-success[_ngcontent-%COMP%]{--bs-btn-color:#198754;--bs-btn-border-color:#198754;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#198754;--bs-btn-hover-border-color:#198754;--bs-btn-focus-shadow-rgb:25,135,84;--bs-btn-active-color:#fff;--bs-btn-active-bg:#198754;--bs-btn-active-border-color:#198754;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#198754;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#198754;--bs-gradient:none}.btn-outline-info[_ngcontent-%COMP%]{--bs-btn-color:#0dcaf0;--bs-btn-border-color:#0dcaf0;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#0dcaf0;--bs-btn-hover-border-color:#0dcaf0;--bs-btn-focus-shadow-rgb:13,202,240;--bs-btn-active-color:#000;--bs-btn-active-bg:#0dcaf0;--bs-btn-active-border-color:#0dcaf0;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#0dcaf0;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#0dcaf0;--bs-gradient:none}.btn-outline-warning[_ngcontent-%COMP%]{--bs-btn-color:#ffc107;--bs-btn-border-color:#ffc107;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#ffc107;--bs-btn-hover-border-color:#ffc107;--bs-btn-focus-shadow-rgb:255,193,7;--bs-btn-active-color:#000;--bs-btn-active-bg:#ffc107;--bs-btn-active-border-color:#ffc107;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#ffc107;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#ffc107;--bs-gradient:none}.btn-outline-danger[_ngcontent-%COMP%]{--bs-btn-color:#dc3545;--bs-btn-border-color:#dc3545;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#dc3545;--bs-btn-hover-border-color:#dc3545;--bs-btn-focus-shadow-rgb:220,53,69;--bs-btn-active-color:#fff;--bs-btn-active-bg:#dc3545;--bs-btn-active-border-color:#dc3545;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#dc3545;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#dc3545;--bs-gradient:none}.btn-outline-light[_ngcontent-%COMP%]{--bs-btn-color:#f8f9fa;--bs-btn-border-color:#f8f9fa;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#f8f9fa;--bs-btn-hover-border-color:#f8f9fa;--bs-btn-focus-shadow-rgb:248,249,250;--bs-btn-active-color:#000;--bs-btn-active-bg:#f8f9fa;--bs-btn-active-border-color:#f8f9fa;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#f8f9fa;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#f8f9fa;--bs-gradient:none}.btn-outline-dark[_ngcontent-%COMP%]{--bs-btn-color:#212529;--bs-btn-border-color:#212529;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#212529;--bs-btn-hover-border-color:#212529;--bs-btn-focus-shadow-rgb:33,37,41;--bs-btn-active-color:#fff;--bs-btn-active-bg:#212529;--bs-btn-active-border-color:#212529;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#212529;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#212529;--bs-gradient:none}.btn-link[_ngcontent-%COMP%]{--bs-btn-font-weight:400;--bs-btn-color:var(--bs-link-color);--bs-btn-bg:transparent;--bs-btn-border-color:transparent;--bs-btn-hover-color:var(--bs-link-hover-color);--bs-btn-hover-border-color:transparent;--bs-btn-active-color:var(--bs-link-hover-color);--bs-btn-active-border-color:transparent;--bs-btn-disabled-color:#6c757d;--bs-btn-disabled-border-color:transparent;--bs-btn-box-shadow:0 0 0 #000;--bs-btn-focus-shadow-rgb:49,132,253;text-decoration:underline}.btn-link[_ngcontent-%COMP%]:focus-visible{color:var(--bs-btn-color)}.btn-link[_ngcontent-%COMP%]:hover{color:var(--bs-btn-hover-color)}.btn-group-lg[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%], .btn-lg[_ngcontent-%COMP%]{--bs-btn-padding-y:.5rem;--bs-btn-padding-x:1rem;--bs-btn-font-size:1.25rem;--bs-btn-border-radius:var(--bs-border-radius-lg)}.btn-group-sm[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%], .btn-sm[_ngcontent-%COMP%]{--bs-btn-padding-y:.25rem;--bs-btn-padding-x:.5rem;--bs-btn-font-size:.875rem;--bs-btn-border-radius:var(--bs-border-radius-sm)}.fade[_ngcontent-%COMP%]{transition:opacity .15s linear}@media (prefers-reduced-motion:reduce){.fade[_ngcontent-%COMP%]{transition:none}}.fade[_ngcontent-%COMP%]:not(.show){opacity:0}.collapse[_ngcontent-%COMP%]:not(.show){display:none}.collapsing[_ngcontent-%COMP%]{height:0;overflow:hidden;transition:height .35s ease}@media (prefers-reduced-motion:reduce){.collapsing[_ngcontent-%COMP%]{transition:none}}.collapsing.collapse-horizontal[_ngcontent-%COMP%]{width:0;height:auto;transition:width .35s ease}@media (prefers-reduced-motion:reduce){.collapsing.collapse-horizontal[_ngcontent-%COMP%]{transition:none}}.dropdown[_ngcontent-%COMP%], .dropdown-center[_ngcontent-%COMP%], .dropend[_ngcontent-%COMP%], .dropstart[_ngcontent-%COMP%], .dropup[_ngcontent-%COMP%], .dropup-center[_ngcontent-%COMP%]{position:relative}.dropdown-toggle[_ngcontent-%COMP%]{white-space:nowrap}.dropdown-toggle[_ngcontent-%COMP%]:after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:\"\";border-top:.3em solid;border-right:.3em solid transparent;border-bottom:0;border-left:.3em solid transparent}.dropdown-toggle[_ngcontent-%COMP%]:empty:after{margin-left:0}.dropdown-menu[_ngcontent-%COMP%]{--bs-dropdown-zindex:1000;--bs-dropdown-min-width:10rem;--bs-dropdown-padding-x:0;--bs-dropdown-padding-y:.5rem;--bs-dropdown-spacer:.125rem;--bs-dropdown-font-size:1rem;--bs-dropdown-color:var(--bs-body-color);--bs-dropdown-bg:var(--bs-body-bg);--bs-dropdown-border-color:var(--bs-border-color-translucent);--bs-dropdown-border-radius:var(--bs-border-radius);--bs-dropdown-border-width:var(--bs-border-width);--bs-dropdown-inner-border-radius:calc(var(--bs-border-radius) - var(--bs-border-width));--bs-dropdown-divider-bg:var(--bs-border-color-translucent);--bs-dropdown-divider-margin-y:.5rem;--bs-dropdown-box-shadow:var(--bs-box-shadow);--bs-dropdown-link-color:var(--bs-body-color);--bs-dropdown-link-hover-color:var(--bs-body-color);--bs-dropdown-link-hover-bg:var(--bs-tertiary-bg);--bs-dropdown-link-active-color:#fff;--bs-dropdown-link-active-bg:#0d6efd;--bs-dropdown-link-disabled-color:var(--bs-tertiary-color);--bs-dropdown-item-padding-x:1rem;--bs-dropdown-item-padding-y:.25rem;--bs-dropdown-header-color:#6c757d;--bs-dropdown-header-padding-x:1rem;--bs-dropdown-header-padding-y:.5rem;position:absolute;z-index:var(--bs-dropdown-zindex);display:none;min-width:var(--bs-dropdown-min-width);padding:var(--bs-dropdown-padding-y) var(--bs-dropdown-padding-x);margin:0;font-size:var(--bs-dropdown-font-size);color:var(--bs-dropdown-color);text-align:left;list-style:none;background-color:var(--bs-dropdown-bg);background-clip:padding-box;border:var(--bs-dropdown-border-width) solid var(--bs-dropdown-border-color);border-radius:var(--bs-dropdown-border-radius)}.dropdown-menu[data-bs-popper][_ngcontent-%COMP%]{top:100%;left:0;margin-top:var(--bs-dropdown-spacer)}.dropdown-menu-start[_ngcontent-%COMP%]{--bs-position:start}.dropdown-menu-start[data-bs-popper][_ngcontent-%COMP%]{right:auto;left:0}.dropdown-menu-end[_ngcontent-%COMP%]{--bs-position:end}.dropdown-menu-end[data-bs-popper][_ngcontent-%COMP%]{right:0;left:auto}@media (min-width:576px){.dropdown-menu-sm-start[_ngcontent-%COMP%]{--bs-position:start}.dropdown-menu-sm-start[data-bs-popper][_ngcontent-%COMP%]{right:auto;left:0}.dropdown-menu-sm-end[_ngcontent-%COMP%]{--bs-position:end}.dropdown-menu-sm-end[data-bs-popper][_ngcontent-%COMP%]{right:0;left:auto}}@media (min-width:768px){.dropdown-menu-md-start[_ngcontent-%COMP%]{--bs-position:start}.dropdown-menu-md-start[data-bs-popper][_ngcontent-%COMP%]{right:auto;left:0}.dropdown-menu-md-end[_ngcontent-%COMP%]{--bs-position:end}.dropdown-menu-md-end[data-bs-popper][_ngcontent-%COMP%]{right:0;left:auto}}@media (min-width:992px){.dropdown-menu-lg-start[_ngcontent-%COMP%]{--bs-position:start}.dropdown-menu-lg-start[data-bs-popper][_ngcontent-%COMP%]{right:auto;left:0}.dropdown-menu-lg-end[_ngcontent-%COMP%]{--bs-position:end}.dropdown-menu-lg-end[data-bs-popper][_ngcontent-%COMP%]{right:0;left:auto}}@media (min-width:1200px){.dropdown-menu-xl-start[_ngcontent-%COMP%]{--bs-position:start}.dropdown-menu-xl-start[data-bs-popper][_ngcontent-%COMP%]{right:auto;left:0}.dropdown-menu-xl-end[_ngcontent-%COMP%]{--bs-position:end}.dropdown-menu-xl-end[data-bs-popper][_ngcontent-%COMP%]{right:0;left:auto}}@media (min-width:1400px){.dropdown-menu-xxl-start[_ngcontent-%COMP%]{--bs-position:start}.dropdown-menu-xxl-start[data-bs-popper][_ngcontent-%COMP%]{right:auto;left:0}.dropdown-menu-xxl-end[_ngcontent-%COMP%]{--bs-position:end}.dropdown-menu-xxl-end[data-bs-popper][_ngcontent-%COMP%]{right:0;left:auto}}.dropup[_ngcontent-%COMP%]   .dropdown-menu[data-bs-popper][_ngcontent-%COMP%]{top:auto;bottom:100%;margin-top:0;margin-bottom:var(--bs-dropdown-spacer)}.dropup[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:\"\";border-top:0;border-right:.3em solid transparent;border-bottom:.3em solid;border-left:.3em solid transparent}.dropup[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:empty:after{margin-left:0}.dropend[_ngcontent-%COMP%]   .dropdown-menu[data-bs-popper][_ngcontent-%COMP%]{top:0;right:auto;left:100%;margin-top:0;margin-left:var(--bs-dropdown-spacer)}.dropend[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:\"\";border-top:.3em solid transparent;border-right:0;border-bottom:.3em solid transparent;border-left:.3em solid}.dropend[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:empty:after{margin-left:0}.dropend[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:after{vertical-align:0}.dropstart[_ngcontent-%COMP%]   .dropdown-menu[data-bs-popper][_ngcontent-%COMP%]{top:0;right:100%;left:auto;margin-top:0;margin-right:var(--bs-dropdown-spacer)}.dropstart[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:\"\";display:none}.dropstart[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:before{display:inline-block;margin-right:.255em;vertical-align:.255em;content:\"\";border-top:.3em solid transparent;border-right:.3em solid;border-bottom:.3em solid transparent}.dropstart[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:empty:after{margin-left:0}.dropstart[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:before{vertical-align:0}.dropdown-divider[_ngcontent-%COMP%]{height:0;margin:var(--bs-dropdown-divider-margin-y) 0;overflow:hidden;border-top:1px solid var(--bs-dropdown-divider-bg);opacity:1}.dropdown-item[_ngcontent-%COMP%]{display:block;width:100%;padding:var(--bs-dropdown-item-padding-y) var(--bs-dropdown-item-padding-x);clear:both;font-weight:400;color:var(--bs-dropdown-link-color);text-align:inherit;text-decoration:none;white-space:nowrap;background-color:transparent;border:0;border-radius:var(--bs-dropdown-item-border-radius,0)}.dropdown-item[_ngcontent-%COMP%]:focus, .dropdown-item[_ngcontent-%COMP%]:hover{color:var(--bs-dropdown-link-hover-color);background-color:var(--bs-dropdown-link-hover-bg)}.dropdown-item.active[_ngcontent-%COMP%], .dropdown-item[_ngcontent-%COMP%]:active{color:var(--bs-dropdown-link-active-color);text-decoration:none;background-color:var(--bs-dropdown-link-active-bg)}.dropdown-item.disabled[_ngcontent-%COMP%], .dropdown-item[_ngcontent-%COMP%]:disabled{color:var(--bs-dropdown-link-disabled-color);pointer-events:none;background-color:transparent}.dropdown-menu.show[_ngcontent-%COMP%]{display:block}.dropdown-header[_ngcontent-%COMP%]{display:block;padding:var(--bs-dropdown-header-padding-y) var(--bs-dropdown-header-padding-x);margin-bottom:0;font-size:.875rem;color:var(--bs-dropdown-header-color);white-space:nowrap}.dropdown-item-text[_ngcontent-%COMP%]{display:block;padding:var(--bs-dropdown-item-padding-y) var(--bs-dropdown-item-padding-x);color:var(--bs-dropdown-link-color)}.dropdown-menu-dark[_ngcontent-%COMP%]{--bs-dropdown-color:#dee2e6;--bs-dropdown-bg:#343a40;--bs-dropdown-border-color:var(--bs-border-color-translucent);--bs-dropdown-box-shadow: ;--bs-dropdown-link-color:#dee2e6;--bs-dropdown-link-hover-color:#fff;--bs-dropdown-divider-bg:var(--bs-border-color-translucent);--bs-dropdown-link-hover-bg:rgba(255, 255, 255, .15);--bs-dropdown-link-active-color:#fff;--bs-dropdown-link-active-bg:#0d6efd;--bs-dropdown-link-disabled-color:#adb5bd;--bs-dropdown-header-color:#adb5bd}.btn-group[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%]{position:relative;display:inline-flex;vertical-align:middle}.btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%], .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]{position:relative;flex:1 1 auto}.btn-group-vertical[_ngcontent-%COMP%] > .btn-check[_ngcontent-%COMP%]:checked + .btn[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%] > .btn-check[_ngcontent-%COMP%]:focus + .btn[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%] > .btn.active[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:active, .btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:focus, .btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:hover, .btn-group[_ngcontent-%COMP%] > .btn-check[_ngcontent-%COMP%]:checked + .btn[_ngcontent-%COMP%], .btn-group[_ngcontent-%COMP%] > .btn-check[_ngcontent-%COMP%]:focus + .btn[_ngcontent-%COMP%], .btn-group[_ngcontent-%COMP%] > .btn.active[_ngcontent-%COMP%], .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:active, .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:focus, .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:hover{z-index:1}.btn-toolbar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:flex-start}.btn-toolbar[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{width:auto}.btn-group[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius)}.btn-group[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]:not(:first-child), .btn-group[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(.btn-check:first-child) + .btn[_ngcontent-%COMP%]{margin-left:calc(var(--bs-border-width) * -1)}.btn-group[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]:not(:last-child) > .btn[_ngcontent-%COMP%], .btn-group[_ngcontent-%COMP%] > .btn.dropdown-toggle-split[_ngcontent-%COMP%]:first-child, .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:not(:last-child):not(.dropdown-toggle){border-top-right-radius:0;border-bottom-right-radius:0}.btn-group[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]:not(:first-child) > .btn[_ngcontent-%COMP%], .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:nth-child(n+3), .btn-group[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(.btn-check) + .btn[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}.dropdown-toggle-split[_ngcontent-%COMP%]{padding-right:.5625rem;padding-left:.5625rem}.dropdown-toggle-split[_ngcontent-%COMP%]:after, .dropend[_ngcontent-%COMP%]   .dropdown-toggle-split[_ngcontent-%COMP%]:after, .dropup[_ngcontent-%COMP%]   .dropdown-toggle-split[_ngcontent-%COMP%]:after{margin-left:0}.dropstart[_ngcontent-%COMP%]   .dropdown-toggle-split[_ngcontent-%COMP%]:before{margin-right:0}.btn-group-sm[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%] + .dropdown-toggle-split[_ngcontent-%COMP%], .btn-sm[_ngcontent-%COMP%] + .dropdown-toggle-split[_ngcontent-%COMP%]{padding-right:.375rem;padding-left:.375rem}.btn-group-lg[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%] + .dropdown-toggle-split[_ngcontent-%COMP%], .btn-lg[_ngcontent-%COMP%] + .dropdown-toggle-split[_ngcontent-%COMP%]{padding-right:.75rem;padding-left:.75rem}.btn-group-vertical[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;justify-content:center}.btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]{width:100%}.btn-group-vertical[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]:not(:first-child), .btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:not(:first-child){margin-top:calc(var(--bs-border-width) * -1)}.btn-group-vertical[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]:not(:last-child) > .btn[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:not(:last-child):not(.dropdown-toggle){border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]:not(:first-child) > .btn[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%] ~ .btn[_ngcontent-%COMP%]{border-top-left-radius:0;border-top-right-radius:0}.nav[_ngcontent-%COMP%]{--bs-nav-link-padding-x:1rem;--bs-nav-link-padding-y:.5rem;--bs-nav-link-font-weight: ;--bs-nav-link-color:var(--bs-link-color);--bs-nav-link-hover-color:var(--bs-link-hover-color);--bs-nav-link-disabled-color:var(--bs-secondary-color);display:flex;flex-wrap:wrap;padding-left:0;margin-bottom:0;list-style:none}.nav-link[_ngcontent-%COMP%]{display:block;padding:var(--bs-nav-link-padding-y) var(--bs-nav-link-padding-x);font-size:var(--bs-nav-link-font-size);font-weight:var(--bs-nav-link-font-weight);color:var(--bs-nav-link-color);text-decoration:none;background:0 0;border:0;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out}@media (prefers-reduced-motion:reduce){.nav-link[_ngcontent-%COMP%]{transition:none}}.nav-link[_ngcontent-%COMP%]:focus, .nav-link[_ngcontent-%COMP%]:hover{color:var(--bs-nav-link-hover-color)}.nav-link[_ngcontent-%COMP%]:focus-visible{outline:0;box-shadow:0 0 0 .25rem #0d6efd40}.nav-link.disabled[_ngcontent-%COMP%], .nav-link[_ngcontent-%COMP%]:disabled{color:var(--bs-nav-link-disabled-color);pointer-events:none;cursor:default}.nav-tabs[_ngcontent-%COMP%]{--bs-nav-tabs-border-width:var(--bs-border-width);--bs-nav-tabs-border-color:var(--bs-border-color);--bs-nav-tabs-border-radius:var(--bs-border-radius);--bs-nav-tabs-link-hover-border-color:var(--bs-secondary-bg) var(--bs-secondary-bg) var(--bs-border-color);--bs-nav-tabs-link-active-color:var(--bs-emphasis-color);--bs-nav-tabs-link-active-bg:var(--bs-body-bg);--bs-nav-tabs-link-active-border-color:var(--bs-border-color) var(--bs-border-color) var(--bs-body-bg);border-bottom:var(--bs-nav-tabs-border-width) solid var(--bs-nav-tabs-border-color)}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{margin-bottom:calc(-1 * var(--bs-nav-tabs-border-width));border:var(--bs-nav-tabs-border-width) solid transparent;border-top-left-radius:var(--bs-nav-tabs-border-radius);border-top-right-radius:var(--bs-nav-tabs-border-radius)}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:focus, .nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{isolation:isolate;border-color:var(--bs-nav-tabs-link-hover-border-color)}.nav-tabs[_ngcontent-%COMP%]   .nav-item.show[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .nav-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:var(--bs-nav-tabs-link-active-color);background-color:var(--bs-nav-tabs-link-active-bg);border-color:var(--bs-nav-tabs-link-active-border-color)}.nav-tabs[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{margin-top:calc(-1 * var(--bs-nav-tabs-border-width));border-top-left-radius:0;border-top-right-radius:0}.nav-pills[_ngcontent-%COMP%]{--bs-nav-pills-border-radius:var(--bs-border-radius);--bs-nav-pills-link-active-color:#fff;--bs-nav-pills-link-active-bg:#0d6efd}.nav-pills[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{border-radius:var(--bs-nav-pills-border-radius)}.nav-pills[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%], .nav-pills[_ngcontent-%COMP%]   .show[_ngcontent-%COMP%] > .nav-link[_ngcontent-%COMP%]{color:var(--bs-nav-pills-link-active-color);background-color:var(--bs-nav-pills-link-active-bg)}.nav-underline[_ngcontent-%COMP%]{--bs-nav-underline-gap:1rem;--bs-nav-underline-border-width:.125rem;--bs-nav-underline-link-active-color:var(--bs-emphasis-color);gap:var(--bs-nav-underline-gap)}.nav-underline[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:0;padding-left:0;border-bottom:var(--bs-nav-underline-border-width) solid transparent}.nav-underline[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:focus, .nav-underline[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{border-bottom-color:currentcolor}.nav-underline[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%], .nav-underline[_ngcontent-%COMP%]   .show[_ngcontent-%COMP%] > .nav-link[_ngcontent-%COMP%]{font-weight:700;color:var(--bs-nav-underline-link-active-color);border-bottom-color:currentcolor}.nav-fill[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%], .nav-fill[_ngcontent-%COMP%] > .nav-link[_ngcontent-%COMP%]{flex:1 1 auto;text-align:center}.nav-justified[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%], .nav-justified[_ngcontent-%COMP%] > .nav-link[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1;text-align:center}.nav-fill[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .nav-justified[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{width:100%}.tab-content[_ngcontent-%COMP%] > .tab-pane[_ngcontent-%COMP%]{display:none}.tab-content[_ngcontent-%COMP%] > .active[_ngcontent-%COMP%]{display:block}.navbar[_ngcontent-%COMP%]{--bs-navbar-padding-x:0;--bs-navbar-padding-y:.5rem;--bs-navbar-color:rgba(var(--bs-emphasis-color-rgb), .65);--bs-navbar-hover-color:rgba(var(--bs-emphasis-color-rgb), .8);--bs-navbar-disabled-color:rgba(var(--bs-emphasis-color-rgb), .3);--bs-navbar-active-color:rgba(var(--bs-emphasis-color-rgb), 1);--bs-navbar-brand-padding-y:.3125rem;--bs-navbar-brand-margin-end:1rem;--bs-navbar-brand-font-size:1.25rem;--bs-navbar-brand-color:rgba(var(--bs-emphasis-color-rgb), 1);--bs-navbar-brand-hover-color:rgba(var(--bs-emphasis-color-rgb), 1);--bs-navbar-nav-link-padding-x:.5rem;--bs-navbar-toggler-padding-y:.25rem;--bs-navbar-toggler-padding-x:.75rem;--bs-navbar-toggler-font-size:1.25rem;--bs-navbar-toggler-icon-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%2833, 37, 41, 0.75%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e\");--bs-navbar-toggler-border-color:rgba(var(--bs-emphasis-color-rgb), .15);--bs-navbar-toggler-border-radius:var(--bs-border-radius);--bs-navbar-toggler-focus-width:.25rem;--bs-navbar-toggler-transition:box-shadow .15s ease-in-out;position:relative;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;padding:var(--bs-navbar-padding-y) var(--bs-navbar-padding-x)}.navbar[_ngcontent-%COMP%] > .container[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%] > .container-fluid[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%] > .container-lg[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%] > .container-md[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%] > .container-sm[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%] > .container-xl[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%] > .container-xxl[_ngcontent-%COMP%]{display:flex;flex-wrap:inherit;align-items:center;justify-content:space-between}.navbar-brand[_ngcontent-%COMP%]{padding-top:var(--bs-navbar-brand-padding-y);padding-bottom:var(--bs-navbar-brand-padding-y);margin-right:var(--bs-navbar-brand-margin-end);font-size:var(--bs-navbar-brand-font-size);color:var(--bs-navbar-brand-color);text-decoration:none;white-space:nowrap}.navbar-brand[_ngcontent-%COMP%]:focus, .navbar-brand[_ngcontent-%COMP%]:hover{color:var(--bs-navbar-brand-hover-color)}.navbar-nav[_ngcontent-%COMP%]{--bs-nav-link-padding-x:0;--bs-nav-link-padding-y:.5rem;--bs-nav-link-font-weight: ;--bs-nav-link-color:var(--bs-navbar-color);--bs-nav-link-hover-color:var(--bs-navbar-hover-color);--bs-nav-link-disabled-color:var(--bs-navbar-disabled-color);display:flex;flex-direction:column;padding-left:0;margin-bottom:0;list-style:none}.navbar-nav[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%], .navbar-nav[_ngcontent-%COMP%]   .nav-link.show[_ngcontent-%COMP%]{color:var(--bs-navbar-active-color)}.navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:static}.navbar-text[_ngcontent-%COMP%]{padding-top:.5rem;padding-bottom:.5rem;color:var(--bs-navbar-color)}.navbar-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .navbar-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:focus, .navbar-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--bs-navbar-active-color)}.navbar-collapse[_ngcontent-%COMP%]{flex-basis:100%;flex-grow:1;align-items:center}.navbar-toggler[_ngcontent-%COMP%]{padding:var(--bs-navbar-toggler-padding-y) var(--bs-navbar-toggler-padding-x);font-size:var(--bs-navbar-toggler-font-size);line-height:1;color:var(--bs-navbar-color);background-color:transparent;border:var(--bs-border-width) solid var(--bs-navbar-toggler-border-color);border-radius:var(--bs-navbar-toggler-border-radius);transition:var(--bs-navbar-toggler-transition)}@media (prefers-reduced-motion:reduce){.navbar-toggler[_ngcontent-%COMP%]{transition:none}}.navbar-toggler[_ngcontent-%COMP%]:hover{text-decoration:none}.navbar-toggler[_ngcontent-%COMP%]:focus{text-decoration:none;outline:0;box-shadow:0 0 0 var(--bs-navbar-toggler-focus-width)}.navbar-toggler-icon[_ngcontent-%COMP%]{display:inline-block;width:1.5em;height:1.5em;vertical-align:middle;background-image:var(--bs-navbar-toggler-icon-bg);background-repeat:no-repeat;background-position:center;background-size:100%}.navbar-nav-scroll[_ngcontent-%COMP%]{max-height:var(--bs-scroll-height,75vh);overflow-y:auto}@media (min-width:576px){.navbar-expand-sm[_ngcontent-%COMP%]{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-sm[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row}.navbar-expand-sm[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute}.navbar-expand-sm[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-sm[_ngcontent-%COMP%]   .navbar-nav-scroll[_ngcontent-%COMP%]{overflow:visible}.navbar-expand-sm[_ngcontent-%COMP%]   .navbar-collapse[_ngcontent-%COMP%]{display:flex!important;flex-basis:auto}.navbar-expand-sm[_ngcontent-%COMP%]   .navbar-toggler[_ngcontent-%COMP%]{display:none}.navbar-expand-sm[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-sm[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.navbar-expand-sm[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:768px){.navbar-expand-md[_ngcontent-%COMP%]{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-md[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row}.navbar-expand-md[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute}.navbar-expand-md[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-md[_ngcontent-%COMP%]   .navbar-nav-scroll[_ngcontent-%COMP%]{overflow:visible}.navbar-expand-md[_ngcontent-%COMP%]   .navbar-collapse[_ngcontent-%COMP%]{display:flex!important;flex-basis:auto}.navbar-expand-md[_ngcontent-%COMP%]   .navbar-toggler[_ngcontent-%COMP%]{display:none}.navbar-expand-md[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-md[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.navbar-expand-md[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:992px){.navbar-expand-lg[_ngcontent-%COMP%]{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-lg[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row}.navbar-expand-lg[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute}.navbar-expand-lg[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-lg[_ngcontent-%COMP%]   .navbar-nav-scroll[_ngcontent-%COMP%]{overflow:visible}.navbar-expand-lg[_ngcontent-%COMP%]   .navbar-collapse[_ngcontent-%COMP%]{display:flex!important;flex-basis:auto}.navbar-expand-lg[_ngcontent-%COMP%]   .navbar-toggler[_ngcontent-%COMP%]{display:none}.navbar-expand-lg[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-lg[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.navbar-expand-lg[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:1200px){.navbar-expand-xl[_ngcontent-%COMP%]{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-xl[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row}.navbar-expand-xl[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute}.navbar-expand-xl[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-xl[_ngcontent-%COMP%]   .navbar-nav-scroll[_ngcontent-%COMP%]{overflow:visible}.navbar-expand-xl[_ngcontent-%COMP%]   .navbar-collapse[_ngcontent-%COMP%]{display:flex!important;flex-basis:auto}.navbar-expand-xl[_ngcontent-%COMP%]   .navbar-toggler[_ngcontent-%COMP%]{display:none}.navbar-expand-xl[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-xl[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.navbar-expand-xl[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:1400px){.navbar-expand-xxl[_ngcontent-%COMP%]{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-xxl[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row}.navbar-expand-xxl[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute}.navbar-expand-xxl[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-xxl[_ngcontent-%COMP%]   .navbar-nav-scroll[_ngcontent-%COMP%]{overflow:visible}.navbar-expand-xxl[_ngcontent-%COMP%]   .navbar-collapse[_ngcontent-%COMP%]{display:flex!important;flex-basis:auto}.navbar-expand-xxl[_ngcontent-%COMP%]   .navbar-toggler[_ngcontent-%COMP%]{display:none}.navbar-expand-xxl[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-xxl[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.navbar-expand-xxl[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible}}.navbar-expand[_ngcontent-%COMP%]{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row}.navbar-expand[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute}.navbar-expand[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand[_ngcontent-%COMP%]   .navbar-nav-scroll[_ngcontent-%COMP%]{overflow:visible}.navbar-expand[_ngcontent-%COMP%]   .navbar-collapse[_ngcontent-%COMP%]{display:flex!important;flex-basis:auto}.navbar-expand[_ngcontent-%COMP%]   .navbar-toggler[_ngcontent-%COMP%]{display:none}.navbar-expand[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.navbar-expand[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible}.navbar-dark[_ngcontent-%COMP%], .navbar[data-bs-theme=dark][_ngcontent-%COMP%]{--bs-navbar-color:rgba(255, 255, 255, .55);--bs-navbar-hover-color:rgba(255, 255, 255, .75);--bs-navbar-disabled-color:rgba(255, 255, 255, .25);--bs-navbar-active-color:#fff;--bs-navbar-brand-color:#fff;--bs-navbar-brand-hover-color:#fff;--bs-navbar-toggler-border-color:rgba(255, 255, 255, .1);--bs-navbar-toggler-icon-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e\")}[data-bs-theme=dark][_ngcontent-%COMP%]   .navbar-toggler-icon[_ngcontent-%COMP%]{--bs-navbar-toggler-icon-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e\")}.card[_ngcontent-%COMP%]{--bs-card-spacer-y:1rem;--bs-card-spacer-x:1rem;--bs-card-title-spacer-y:.5rem;--bs-card-title-color: ;--bs-card-subtitle-color: ;--bs-card-border-width:var(--bs-border-width);--bs-card-border-color:var(--bs-border-color-translucent);--bs-card-border-radius:var(--bs-border-radius);--bs-card-box-shadow: ;--bs-card-inner-border-radius:calc(var(--bs-border-radius) - (var(--bs-border-width)));--bs-card-cap-padding-y:.5rem;--bs-card-cap-padding-x:1rem;--bs-card-cap-bg:rgba(var(--bs-body-color-rgb), .03);--bs-card-cap-color: ;--bs-card-height: ;--bs-card-color: ;--bs-card-bg:var(--bs-body-bg);--bs-card-img-overlay-padding:1rem;--bs-card-group-margin:.75rem;position:relative;display:flex;flex-direction:column;min-width:0;height:var(--bs-card-height);color:var(--bs-body-color);word-wrap:break-word;background-color:var(--bs-card-bg);background-clip:border-box;border:var(--bs-card-border-width) solid var(--bs-card-border-color);border-radius:var(--bs-card-border-radius)}.card[_ngcontent-%COMP%] > hr[_ngcontent-%COMP%]{margin-right:0;margin-left:0}.card[_ngcontent-%COMP%] > .list-group[_ngcontent-%COMP%]{border-top:inherit;border-bottom:inherit}.card[_ngcontent-%COMP%] > .list-group[_ngcontent-%COMP%]:first-child{border-top-width:0;border-top-left-radius:var(--bs-card-inner-border-radius);border-top-right-radius:var(--bs-card-inner-border-radius)}.card[_ngcontent-%COMP%] > .list-group[_ngcontent-%COMP%]:last-child{border-bottom-width:0;border-bottom-right-radius:var(--bs-card-inner-border-radius);border-bottom-left-radius:var(--bs-card-inner-border-radius)}.card[_ngcontent-%COMP%] > .card-header[_ngcontent-%COMP%] + .list-group[_ngcontent-%COMP%], .card[_ngcontent-%COMP%] > .list-group[_ngcontent-%COMP%] + .card-footer[_ngcontent-%COMP%]{border-top:0}.card-body[_ngcontent-%COMP%]{flex:1 1 auto;padding:var(--bs-card-spacer-y) var(--bs-card-spacer-x);color:var(--bs-card-color)}.card-title[_ngcontent-%COMP%]{margin-bottom:var(--bs-card-title-spacer-y);color:var(--bs-card-title-color)}.card-subtitle[_ngcontent-%COMP%]{margin-top:calc(-.5 * var(--bs-card-title-spacer-y));margin-bottom:0;color:var(--bs-card-subtitle-color)}.card-text[_ngcontent-%COMP%]:last-child{margin-bottom:0}.card-link[_ngcontent-%COMP%] + .card-link[_ngcontent-%COMP%]{margin-left:var(--bs-card-spacer-x)}.card-header[_ngcontent-%COMP%]{padding:var(--bs-card-cap-padding-y) var(--bs-card-cap-padding-x);margin-bottom:0;color:var(--bs-card-cap-color);background-color:var(--bs-card-cap-bg);border-bottom:var(--bs-card-border-width) solid var(--bs-card-border-color)}.card-header[_ngcontent-%COMP%]:first-child{border-radius:var(--bs-card-inner-border-radius) var(--bs-card-inner-border-radius) 0 0}.card-footer[_ngcontent-%COMP%]{padding:var(--bs-card-cap-padding-y) var(--bs-card-cap-padding-x);color:var(--bs-card-cap-color);background-color:var(--bs-card-cap-bg);border-top:var(--bs-card-border-width) solid var(--bs-card-border-color)}.card-footer[_ngcontent-%COMP%]:last-child{border-radius:0 0 var(--bs-card-inner-border-radius) var(--bs-card-inner-border-radius)}.card-header-tabs[_ngcontent-%COMP%]{margin-right:calc(-.5 * var(--bs-card-cap-padding-x));margin-bottom:calc(-1 * var(--bs-card-cap-padding-y));margin-left:calc(-.5 * var(--bs-card-cap-padding-x));border-bottom:0}.card-header-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background-color:var(--bs-card-bg);border-bottom-color:var(--bs-card-bg)}.card-header-pills[_ngcontent-%COMP%]{margin-right:calc(-.5 * var(--bs-card-cap-padding-x));margin-left:calc(-.5 * var(--bs-card-cap-padding-x))}.card-img-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;padding:var(--bs-card-img-overlay-padding);border-radius:var(--bs-card-inner-border-radius)}.card-img[_ngcontent-%COMP%], .card-img-bottom[_ngcontent-%COMP%], .card-img-top[_ngcontent-%COMP%]{width:100%}.card-img[_ngcontent-%COMP%], .card-img-top[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-card-inner-border-radius);border-top-right-radius:var(--bs-card-inner-border-radius)}.card-img[_ngcontent-%COMP%], .card-img-bottom[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-card-inner-border-radius);border-bottom-left-radius:var(--bs-card-inner-border-radius)}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]{margin-bottom:var(--bs-card-group-margin)}@media (min-width:576px){.card-group[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]{flex:1 0 0%;margin-bottom:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%] + .card[_ngcontent-%COMP%]{margin-left:0;border-left:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:last-child)   .card-header[_ngcontent-%COMP%], .card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:last-child)   .card-img-top[_ngcontent-%COMP%]{border-top-right-radius:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:last-child)   .card-footer[_ngcontent-%COMP%], .card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:last-child)   .card-img-bottom[_ngcontent-%COMP%]{border-bottom-right-radius:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:first-child)   .card-header[_ngcontent-%COMP%], .card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:first-child)   .card-img-top[_ngcontent-%COMP%]{border-top-left-radius:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:first-child)   .card-footer[_ngcontent-%COMP%], .card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:first-child)   .card-img-bottom[_ngcontent-%COMP%]{border-bottom-left-radius:0}}.accordion[_ngcontent-%COMP%]{--bs-accordion-color:var(--bs-body-color);--bs-accordion-bg:var(--bs-body-bg);--bs-accordion-transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out,border-radius .15s ease;--bs-accordion-border-color:var(--bs-border-color);--bs-accordion-border-width:var(--bs-border-width);--bs-accordion-border-radius:var(--bs-border-radius);--bs-accordion-inner-border-radius:calc(var(--bs-border-radius) - (var(--bs-border-width)));--bs-accordion-btn-padding-x:1.25rem;--bs-accordion-btn-padding-y:1rem;--bs-accordion-btn-color:var(--bs-body-color);--bs-accordion-btn-bg:var(--bs-accordion-bg);--bs-accordion-btn-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='none' stroke='%23212529' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M2 5L8 11L14 5'/%3e%3c/svg%3e\");--bs-accordion-btn-icon-width:1.25rem;--bs-accordion-btn-icon-transform:rotate(-180deg);--bs-accordion-btn-icon-transition:transform .2s ease-in-out;--bs-accordion-btn-active-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='none' stroke='%23052c65' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M2 5L8 11L14 5'/%3e%3c/svg%3e\");--bs-accordion-btn-focus-box-shadow:0 0 0 .25rem rgba(13, 110, 253, .25);--bs-accordion-body-padding-x:1.25rem;--bs-accordion-body-padding-y:1rem;--bs-accordion-active-color:var(--bs-primary-text-emphasis);--bs-accordion-active-bg:var(--bs-primary-bg-subtle)}.accordion-button[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;width:100%;padding:var(--bs-accordion-btn-padding-y) var(--bs-accordion-btn-padding-x);font-size:1rem;color:var(--bs-accordion-btn-color);text-align:left;background-color:var(--bs-accordion-btn-bg);border:0;border-radius:0;overflow-anchor:none;transition:var(--bs-accordion-transition)}@media (prefers-reduced-motion:reduce){.accordion-button[_ngcontent-%COMP%]{transition:none}}.accordion-button[_ngcontent-%COMP%]:not(.collapsed){color:var(--bs-accordion-active-color);background-color:var(--bs-accordion-active-bg);box-shadow:inset 0 calc(-1 * var(--bs-accordion-border-width)) 0 var(--bs-accordion-border-color)}.accordion-button[_ngcontent-%COMP%]:not(.collapsed):after{background-image:var(--bs-accordion-btn-active-icon);transform:var(--bs-accordion-btn-icon-transform)}.accordion-button[_ngcontent-%COMP%]:after{flex-shrink:0;width:var(--bs-accordion-btn-icon-width);height:var(--bs-accordion-btn-icon-width);margin-left:auto;content:\"\";background-image:var(--bs-accordion-btn-icon);background-repeat:no-repeat;background-size:var(--bs-accordion-btn-icon-width);transition:var(--bs-accordion-btn-icon-transition)}@media (prefers-reduced-motion:reduce){.accordion-button[_ngcontent-%COMP%]:after{transition:none}}.accordion-button[_ngcontent-%COMP%]:hover{z-index:2}.accordion-button[_ngcontent-%COMP%]:focus{z-index:3;outline:0;box-shadow:var(--bs-accordion-btn-focus-box-shadow)}.accordion-header[_ngcontent-%COMP%]{margin-bottom:0}.accordion-item[_ngcontent-%COMP%]{color:var(--bs-accordion-color);background-color:var(--bs-accordion-bg);border:var(--bs-accordion-border-width) solid var(--bs-accordion-border-color)}.accordion-item[_ngcontent-%COMP%]:first-of-type{border-top-left-radius:var(--bs-accordion-border-radius);border-top-right-radius:var(--bs-accordion-border-radius)}.accordion-item[_ngcontent-%COMP%]:first-of-type > .accordion-header[_ngcontent-%COMP%]   .accordion-button[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-accordion-inner-border-radius);border-top-right-radius:var(--bs-accordion-inner-border-radius)}.accordion-item[_ngcontent-%COMP%]:not(:first-of-type){border-top:0}.accordion-item[_ngcontent-%COMP%]:last-of-type{border-bottom-right-radius:var(--bs-accordion-border-radius);border-bottom-left-radius:var(--bs-accordion-border-radius)}.accordion-item[_ngcontent-%COMP%]:last-of-type > .accordion-header[_ngcontent-%COMP%]   .accordion-button.collapsed[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-accordion-inner-border-radius);border-bottom-left-radius:var(--bs-accordion-inner-border-radius)}.accordion-item[_ngcontent-%COMP%]:last-of-type > .accordion-collapse[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-accordion-border-radius);border-bottom-left-radius:var(--bs-accordion-border-radius)}.accordion-body[_ngcontent-%COMP%]{padding:var(--bs-accordion-body-padding-y) var(--bs-accordion-body-padding-x)}.accordion-flush[_ngcontent-%COMP%] > .accordion-item[_ngcontent-%COMP%]{border-right:0;border-left:0;border-radius:0}.accordion-flush[_ngcontent-%COMP%] > .accordion-item[_ngcontent-%COMP%]:first-child{border-top:0}.accordion-flush[_ngcontent-%COMP%] > .accordion-item[_ngcontent-%COMP%]:last-child{border-bottom:0}.accordion-flush[_ngcontent-%COMP%] > .accordion-item[_ngcontent-%COMP%] > .accordion-header[_ngcontent-%COMP%]   .accordion-button[_ngcontent-%COMP%], .accordion-flush[_ngcontent-%COMP%] > .accordion-item[_ngcontent-%COMP%] > .accordion-header[_ngcontent-%COMP%]   .accordion-button.collapsed[_ngcontent-%COMP%]{border-radius:0}.accordion-flush[_ngcontent-%COMP%] > .accordion-item[_ngcontent-%COMP%] > .accordion-collapse[_ngcontent-%COMP%]{border-radius:0}[data-bs-theme=dark][_ngcontent-%COMP%]   .accordion-button[_ngcontent-%COMP%]:after{--bs-accordion-btn-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%236ea8fe'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e\");--bs-accordion-btn-active-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%236ea8fe'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e\")}.breadcrumb[_ngcontent-%COMP%]{--bs-breadcrumb-padding-x:0;--bs-breadcrumb-padding-y:0;--bs-breadcrumb-margin-bottom:1rem;--bs-breadcrumb-bg: ;--bs-breadcrumb-border-radius: ;--bs-breadcrumb-divider-color:var(--bs-secondary-color);--bs-breadcrumb-item-padding-x:.5rem;--bs-breadcrumb-item-active-color:var(--bs-secondary-color);display:flex;flex-wrap:wrap;padding:var(--bs-breadcrumb-padding-y) var(--bs-breadcrumb-padding-x);margin-bottom:var(--bs-breadcrumb-margin-bottom);font-size:var(--bs-breadcrumb-font-size);list-style:none;background-color:var(--bs-breadcrumb-bg);border-radius:var(--bs-breadcrumb-border-radius)}.breadcrumb-item[_ngcontent-%COMP%] + .breadcrumb-item[_ngcontent-%COMP%]{padding-left:var(--bs-breadcrumb-item-padding-x)}.breadcrumb-item[_ngcontent-%COMP%] + .breadcrumb-item[_ngcontent-%COMP%]:before{float:left;padding-right:var(--bs-breadcrumb-item-padding-x);color:var(--bs-breadcrumb-divider-color);content:var(--bs-breadcrumb-divider, \"/\")}.breadcrumb-item.active[_ngcontent-%COMP%]{color:var(--bs-breadcrumb-item-active-color)}.pagination[_ngcontent-%COMP%]{--bs-pagination-padding-x:.75rem;--bs-pagination-padding-y:.375rem;--bs-pagination-font-size:1rem;--bs-pagination-color:var(--bs-link-color);--bs-pagination-bg:var(--bs-body-bg);--bs-pagination-border-width:var(--bs-border-width);--bs-pagination-border-color:var(--bs-border-color);--bs-pagination-border-radius:var(--bs-border-radius);--bs-pagination-hover-color:var(--bs-link-hover-color);--bs-pagination-hover-bg:var(--bs-tertiary-bg);--bs-pagination-hover-border-color:var(--bs-border-color);--bs-pagination-focus-color:var(--bs-link-hover-color);--bs-pagination-focus-bg:var(--bs-secondary-bg);--bs-pagination-focus-box-shadow:0 0 0 .25rem rgba(13, 110, 253, .25);--bs-pagination-active-color:#fff;--bs-pagination-active-bg:#0d6efd;--bs-pagination-active-border-color:#0d6efd;--bs-pagination-disabled-color:var(--bs-secondary-color);--bs-pagination-disabled-bg:var(--bs-secondary-bg);--bs-pagination-disabled-border-color:var(--bs-border-color);display:flex;padding-left:0;list-style:none}.page-link[_ngcontent-%COMP%]{position:relative;display:block;padding:var(--bs-pagination-padding-y) var(--bs-pagination-padding-x);font-size:var(--bs-pagination-font-size);color:var(--bs-pagination-color);text-decoration:none;background-color:var(--bs-pagination-bg);border:var(--bs-pagination-border-width) solid var(--bs-pagination-border-color);transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.page-link[_ngcontent-%COMP%]{transition:none}}.page-link[_ngcontent-%COMP%]:hover{z-index:2;color:var(--bs-pagination-hover-color);background-color:var(--bs-pagination-hover-bg);border-color:var(--bs-pagination-hover-border-color)}.page-link[_ngcontent-%COMP%]:focus{z-index:3;color:var(--bs-pagination-focus-color);background-color:var(--bs-pagination-focus-bg);outline:0;box-shadow:var(--bs-pagination-focus-box-shadow)}.active[_ngcontent-%COMP%] > .page-link[_ngcontent-%COMP%], .page-link.active[_ngcontent-%COMP%]{z-index:3;color:var(--bs-pagination-active-color);background-color:var(--bs-pagination-active-bg);border-color:var(--bs-pagination-active-border-color)}.disabled[_ngcontent-%COMP%] > .page-link[_ngcontent-%COMP%], .page-link.disabled[_ngcontent-%COMP%]{color:var(--bs-pagination-disabled-color);pointer-events:none;background-color:var(--bs-pagination-disabled-bg);border-color:var(--bs-pagination-disabled-border-color)}.page-item[_ngcontent-%COMP%]:not(:first-child)   .page-link[_ngcontent-%COMP%]{margin-left:calc(var(--bs-border-width) * -1)}.page-item[_ngcontent-%COMP%]:first-child   .page-link[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-pagination-border-radius);border-bottom-left-radius:var(--bs-pagination-border-radius)}.page-item[_ngcontent-%COMP%]:last-child   .page-link[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-pagination-border-radius);border-bottom-right-radius:var(--bs-pagination-border-radius)}.pagination-lg[_ngcontent-%COMP%]{--bs-pagination-padding-x:1.5rem;--bs-pagination-padding-y:.75rem;--bs-pagination-font-size:1.25rem;--bs-pagination-border-radius:var(--bs-border-radius-lg)}.pagination-sm[_ngcontent-%COMP%]{--bs-pagination-padding-x:.5rem;--bs-pagination-padding-y:.25rem;--bs-pagination-font-size:.875rem;--bs-pagination-border-radius:var(--bs-border-radius-sm)}.badge[_ngcontent-%COMP%]{--bs-badge-padding-x:.65em;--bs-badge-padding-y:.35em;--bs-badge-font-size:.75em;--bs-badge-font-weight:700;--bs-badge-color:#fff;--bs-badge-border-radius:var(--bs-border-radius);display:inline-block;padding:var(--bs-badge-padding-y) var(--bs-badge-padding-x);font-size:var(--bs-badge-font-size);font-weight:var(--bs-badge-font-weight);line-height:1;color:var(--bs-badge-color);text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:var(--bs-badge-border-radius)}.badge[_ngcontent-%COMP%]:empty{display:none}.btn[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:relative;top:-1px}.alert[_ngcontent-%COMP%]{--bs-alert-bg:transparent;--bs-alert-padding-x:1rem;--bs-alert-padding-y:1rem;--bs-alert-margin-bottom:1rem;--bs-alert-color:inherit;--bs-alert-border-color:transparent;--bs-alert-border:var(--bs-border-width) solid var(--bs-alert-border-color);--bs-alert-border-radius:var(--bs-border-radius);--bs-alert-link-color:inherit;position:relative;padding:var(--bs-alert-padding-y) var(--bs-alert-padding-x);margin-bottom:var(--bs-alert-margin-bottom);color:var(--bs-alert-color);background-color:var(--bs-alert-bg);border:var(--bs-alert-border);border-radius:var(--bs-alert-border-radius)}.alert-heading[_ngcontent-%COMP%]{color:inherit}.alert-link[_ngcontent-%COMP%]{font-weight:700;color:var(--bs-alert-link-color)}.alert-dismissible[_ngcontent-%COMP%]{padding-right:3rem}.alert-dismissible[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:2;padding:1.25rem 1rem}.alert-primary[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-primary-text-emphasis);--bs-alert-bg:var(--bs-primary-bg-subtle);--bs-alert-border-color:var(--bs-primary-border-subtle);--bs-alert-link-color:var(--bs-primary-text-emphasis)}.alert-secondary[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-secondary-text-emphasis);--bs-alert-bg:var(--bs-secondary-bg-subtle);--bs-alert-border-color:var(--bs-secondary-border-subtle);--bs-alert-link-color:var(--bs-secondary-text-emphasis)}.alert-success[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-success-text-emphasis);--bs-alert-bg:var(--bs-success-bg-subtle);--bs-alert-border-color:var(--bs-success-border-subtle);--bs-alert-link-color:var(--bs-success-text-emphasis)}.alert-info[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-info-text-emphasis);--bs-alert-bg:var(--bs-info-bg-subtle);--bs-alert-border-color:var(--bs-info-border-subtle);--bs-alert-link-color:var(--bs-info-text-emphasis)}.alert-warning[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-warning-text-emphasis);--bs-alert-bg:var(--bs-warning-bg-subtle);--bs-alert-border-color:var(--bs-warning-border-subtle);--bs-alert-link-color:var(--bs-warning-text-emphasis)}.alert-danger[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-danger-text-emphasis);--bs-alert-bg:var(--bs-danger-bg-subtle);--bs-alert-border-color:var(--bs-danger-border-subtle);--bs-alert-link-color:var(--bs-danger-text-emphasis)}.alert-light[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-light-text-emphasis);--bs-alert-bg:var(--bs-light-bg-subtle);--bs-alert-border-color:var(--bs-light-border-subtle);--bs-alert-link-color:var(--bs-light-text-emphasis)}.alert-dark[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-dark-text-emphasis);--bs-alert-bg:var(--bs-dark-bg-subtle);--bs-alert-border-color:var(--bs-dark-border-subtle);--bs-alert-link-color:var(--bs-dark-text-emphasis)}@keyframes _ngcontent-%COMP%_progress-bar-stripes{0%{background-position-x:1rem}}.progress[_ngcontent-%COMP%], .progress-stacked[_ngcontent-%COMP%]{--bs-progress-height:1rem;--bs-progress-font-size:.75rem;--bs-progress-bg:var(--bs-secondary-bg);--bs-progress-border-radius:var(--bs-border-radius);--bs-progress-box-shadow:var(--bs-box-shadow-inset);--bs-progress-bar-color:#fff;--bs-progress-bar-bg:#0d6efd;--bs-progress-bar-transition:width .6s ease;display:flex;height:var(--bs-progress-height);overflow:hidden;font-size:var(--bs-progress-font-size);background-color:var(--bs-progress-bg);border-radius:var(--bs-progress-border-radius)}.progress-bar[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;overflow:hidden;color:var(--bs-progress-bar-color);text-align:center;white-space:nowrap;background-color:var(--bs-progress-bar-bg);transition:var(--bs-progress-bar-transition)}@media (prefers-reduced-motion:reduce){.progress-bar[_ngcontent-%COMP%]{transition:none}}.progress-bar-striped[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-size:var(--bs-progress-height) var(--bs-progress-height)}.progress-stacked[_ngcontent-%COMP%] > .progress[_ngcontent-%COMP%]{overflow:visible}.progress-stacked[_ngcontent-%COMP%] > .progress[_ngcontent-%COMP%] > .progress-bar[_ngcontent-%COMP%]{width:100%}.progress-bar-animated[_ngcontent-%COMP%]{animation:1s linear infinite _ngcontent-%COMP%_progress-bar-stripes}@media (prefers-reduced-motion:reduce){.progress-bar-animated[_ngcontent-%COMP%]{animation:none}}.list-group[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-body-color);--bs-list-group-bg:var(--bs-body-bg);--bs-list-group-border-color:var(--bs-border-color);--bs-list-group-border-width:var(--bs-border-width);--bs-list-group-border-radius:var(--bs-border-radius);--bs-list-group-item-padding-x:1rem;--bs-list-group-item-padding-y:.5rem;--bs-list-group-action-color:var(--bs-secondary-color);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-tertiary-bg);--bs-list-group-action-active-color:var(--bs-body-color);--bs-list-group-action-active-bg:var(--bs-secondary-bg);--bs-list-group-disabled-color:var(--bs-secondary-color);--bs-list-group-disabled-bg:var(--bs-body-bg);--bs-list-group-active-color:#fff;--bs-list-group-active-bg:#0d6efd;--bs-list-group-active-border-color:#0d6efd;display:flex;flex-direction:column;padding-left:0;margin-bottom:0;border-radius:var(--bs-list-group-border-radius)}.list-group-numbered[_ngcontent-%COMP%]{list-style-type:none;counter-reset:section}.list-group-numbered[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:before{content:counters(section,\".\") \". \";counter-increment:section}.list-group-item-action[_ngcontent-%COMP%]{width:100%;color:var(--bs-list-group-action-color);text-align:inherit}.list-group-item-action[_ngcontent-%COMP%]:focus, .list-group-item-action[_ngcontent-%COMP%]:hover{z-index:1;color:var(--bs-list-group-action-hover-color);text-decoration:none;background-color:var(--bs-list-group-action-hover-bg)}.list-group-item-action[_ngcontent-%COMP%]:active{color:var(--bs-list-group-action-active-color);background-color:var(--bs-list-group-action-active-bg)}.list-group-item[_ngcontent-%COMP%]{position:relative;display:block;padding:var(--bs-list-group-item-padding-y) var(--bs-list-group-item-padding-x);color:var(--bs-list-group-color);text-decoration:none;background-color:var(--bs-list-group-bg);border:var(--bs-list-group-border-width) solid var(--bs-list-group-border-color)}.list-group-item[_ngcontent-%COMP%]:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.list-group-item[_ngcontent-%COMP%]:last-child{border-bottom-right-radius:inherit;border-bottom-left-radius:inherit}.list-group-item.disabled[_ngcontent-%COMP%], .list-group-item[_ngcontent-%COMP%]:disabled{color:var(--bs-list-group-disabled-color);pointer-events:none;background-color:var(--bs-list-group-disabled-bg)}.list-group-item.active[_ngcontent-%COMP%]{z-index:2;color:var(--bs-list-group-active-color);background-color:var(--bs-list-group-active-bg);border-color:var(--bs-list-group-active-border-color)}.list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:0}.list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-top:calc(-1 * var(--bs-list-group-border-width));border-top-width:var(--bs-list-group-border-width)}.list-group-horizontal[_ngcontent-%COMP%]{flex-direction:row}.list-group-horizontal[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal[_ngcontent-%COMP%] > .list-group-item.active[_ngcontent-%COMP%]{margin-top:0}.list-group-horizontal[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}@media (min-width:576px){.list-group-horizontal-sm[_ngcontent-%COMP%]{flex-direction:row}.list-group-horizontal-sm[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-sm[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-sm[_ngcontent-%COMP%] > .list-group-item.active[_ngcontent-%COMP%]{margin-top:0}.list-group-horizontal-sm[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-sm[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:768px){.list-group-horizontal-md[_ngcontent-%COMP%]{flex-direction:row}.list-group-horizontal-md[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-md[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-md[_ngcontent-%COMP%] > .list-group-item.active[_ngcontent-%COMP%]{margin-top:0}.list-group-horizontal-md[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-md[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:992px){.list-group-horizontal-lg[_ngcontent-%COMP%]{flex-direction:row}.list-group-horizontal-lg[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-lg[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-lg[_ngcontent-%COMP%] > .list-group-item.active[_ngcontent-%COMP%]{margin-top:0}.list-group-horizontal-lg[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-lg[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:1200px){.list-group-horizontal-xl[_ngcontent-%COMP%]{flex-direction:row}.list-group-horizontal-xl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-xl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-xl[_ngcontent-%COMP%] > .list-group-item.active[_ngcontent-%COMP%]{margin-top:0}.list-group-horizontal-xl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-xl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:1400px){.list-group-horizontal-xxl[_ngcontent-%COMP%]{flex-direction:row}.list-group-horizontal-xxl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-xxl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-xxl[_ngcontent-%COMP%] > .list-group-item.active[_ngcontent-%COMP%]{margin-top:0}.list-group-horizontal-xxl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-xxl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}.list-group-flush[_ngcontent-%COMP%]{border-radius:0}.list-group-flush[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]{border-width:0 0 var(--bs-list-group-border-width)}.list-group-flush[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child{border-bottom-width:0}.list-group-item-primary[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-primary-text-emphasis);--bs-list-group-bg:var(--bs-primary-bg-subtle);--bs-list-group-border-color:var(--bs-primary-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-primary-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-primary-border-subtle);--bs-list-group-active-color:var(--bs-primary-bg-subtle);--bs-list-group-active-bg:var(--bs-primary-text-emphasis);--bs-list-group-active-border-color:var(--bs-primary-text-emphasis)}.list-group-item-secondary[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-secondary-text-emphasis);--bs-list-group-bg:var(--bs-secondary-bg-subtle);--bs-list-group-border-color:var(--bs-secondary-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-secondary-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-secondary-border-subtle);--bs-list-group-active-color:var(--bs-secondary-bg-subtle);--bs-list-group-active-bg:var(--bs-secondary-text-emphasis);--bs-list-group-active-border-color:var(--bs-secondary-text-emphasis)}.list-group-item-success[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-success-text-emphasis);--bs-list-group-bg:var(--bs-success-bg-subtle);--bs-list-group-border-color:var(--bs-success-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-success-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-success-border-subtle);--bs-list-group-active-color:var(--bs-success-bg-subtle);--bs-list-group-active-bg:var(--bs-success-text-emphasis);--bs-list-group-active-border-color:var(--bs-success-text-emphasis)}.list-group-item-info[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-info-text-emphasis);--bs-list-group-bg:var(--bs-info-bg-subtle);--bs-list-group-border-color:var(--bs-info-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-info-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-info-border-subtle);--bs-list-group-active-color:var(--bs-info-bg-subtle);--bs-list-group-active-bg:var(--bs-info-text-emphasis);--bs-list-group-active-border-color:var(--bs-info-text-emphasis)}.list-group-item-warning[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-warning-text-emphasis);--bs-list-group-bg:var(--bs-warning-bg-subtle);--bs-list-group-border-color:var(--bs-warning-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-warning-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-warning-border-subtle);--bs-list-group-active-color:var(--bs-warning-bg-subtle);--bs-list-group-active-bg:var(--bs-warning-text-emphasis);--bs-list-group-active-border-color:var(--bs-warning-text-emphasis)}.list-group-item-danger[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-danger-text-emphasis);--bs-list-group-bg:var(--bs-danger-bg-subtle);--bs-list-group-border-color:var(--bs-danger-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-danger-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-danger-border-subtle);--bs-list-group-active-color:var(--bs-danger-bg-subtle);--bs-list-group-active-bg:var(--bs-danger-text-emphasis);--bs-list-group-active-border-color:var(--bs-danger-text-emphasis)}.list-group-item-light[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-light-text-emphasis);--bs-list-group-bg:var(--bs-light-bg-subtle);--bs-list-group-border-color:var(--bs-light-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-light-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-light-border-subtle);--bs-list-group-active-color:var(--bs-light-bg-subtle);--bs-list-group-active-bg:var(--bs-light-text-emphasis);--bs-list-group-active-border-color:var(--bs-light-text-emphasis)}.list-group-item-dark[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-dark-text-emphasis);--bs-list-group-bg:var(--bs-dark-bg-subtle);--bs-list-group-border-color:var(--bs-dark-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-dark-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-dark-border-subtle);--bs-list-group-active-color:var(--bs-dark-bg-subtle);--bs-list-group-active-bg:var(--bs-dark-text-emphasis);--bs-list-group-active-border-color:var(--bs-dark-text-emphasis)}.btn-close[_ngcontent-%COMP%]{--bs-btn-close-color:#000;--bs-btn-close-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23000'%3e%3cpath d='M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414z'/%3e%3c/svg%3e\");--bs-btn-close-opacity:.5;--bs-btn-close-hover-opacity:.75;--bs-btn-close-focus-shadow:0 0 0 .25rem rgba(13, 110, 253, .25);--bs-btn-close-focus-opacity:1;--bs-btn-close-disabled-opacity:.25;--bs-btn-close-white-filter:invert(1) grayscale(100%) brightness(200%);box-sizing:content-box;width:1em;height:1em;padding:.25em;color:var(--bs-btn-close-color);background:transparent var(--bs-btn-close-bg) center/1em auto no-repeat;border:0;border-radius:.375rem;opacity:var(--bs-btn-close-opacity)}.btn-close[_ngcontent-%COMP%]:hover{color:var(--bs-btn-close-color);text-decoration:none;opacity:var(--bs-btn-close-hover-opacity)}.btn-close[_ngcontent-%COMP%]:focus{outline:0;box-shadow:var(--bs-btn-close-focus-shadow);opacity:var(--bs-btn-close-focus-opacity)}.btn-close.disabled[_ngcontent-%COMP%], .btn-close[_ngcontent-%COMP%]:disabled{pointer-events:none;-webkit-user-select:none;user-select:none;opacity:var(--bs-btn-close-disabled-opacity)}.btn-close-white[_ngcontent-%COMP%], [data-bs-theme=dark][_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{filter:var(--bs-btn-close-white-filter)}.toast[_ngcontent-%COMP%]{--bs-toast-zindex:1090;--bs-toast-padding-x:.75rem;--bs-toast-padding-y:.5rem;--bs-toast-spacing:1.5rem;--bs-toast-max-width:350px;--bs-toast-font-size:.875rem;--bs-toast-color: ;--bs-toast-bg:rgba(var(--bs-body-bg-rgb), .85);--bs-toast-border-width:var(--bs-border-width);--bs-toast-border-color:var(--bs-border-color-translucent);--bs-toast-border-radius:var(--bs-border-radius);--bs-toast-box-shadow:var(--bs-box-shadow);--bs-toast-header-color:var(--bs-secondary-color);--bs-toast-header-bg:rgba(var(--bs-body-bg-rgb), .85);--bs-toast-header-border-color:var(--bs-border-color-translucent);width:var(--bs-toast-max-width);max-width:100%;font-size:var(--bs-toast-font-size);color:var(--bs-toast-color);pointer-events:auto;background-color:var(--bs-toast-bg);background-clip:padding-box;border:var(--bs-toast-border-width) solid var(--bs-toast-border-color);box-shadow:var(--bs-toast-box-shadow);border-radius:var(--bs-toast-border-radius)}.toast.showing[_ngcontent-%COMP%]{opacity:0}.toast[_ngcontent-%COMP%]:not(.show){display:none}.toast-container[_ngcontent-%COMP%]{--bs-toast-zindex:1090;position:absolute;z-index:var(--bs-toast-zindex);width:max-content;max-width:100%;pointer-events:none}.toast-container[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:last-child){margin-bottom:var(--bs-toast-spacing)}.toast-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:var(--bs-toast-padding-y) var(--bs-toast-padding-x);color:var(--bs-toast-header-color);background-color:var(--bs-toast-header-bg);background-clip:padding-box;border-bottom:var(--bs-toast-border-width) solid var(--bs-toast-header-border-color);border-top-left-radius:calc(var(--bs-toast-border-radius) - var(--bs-toast-border-width));border-top-right-radius:calc(var(--bs-toast-border-radius) - var(--bs-toast-border-width))}.toast-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{margin-right:calc(-.5 * var(--bs-toast-padding-x));margin-left:var(--bs-toast-padding-x)}.toast-body[_ngcontent-%COMP%]{padding:var(--bs-toast-padding-x);word-wrap:break-word}.modal[_ngcontent-%COMP%]{--bs-modal-zindex:1055;--bs-modal-width:500px;--bs-modal-padding:1rem;--bs-modal-margin:.5rem;--bs-modal-color: ;--bs-modal-bg:var(--bs-body-bg);--bs-modal-border-color:var(--bs-border-color-translucent);--bs-modal-border-width:var(--bs-border-width);--bs-modal-border-radius:var(--bs-border-radius-lg);--bs-modal-box-shadow:var(--bs-box-shadow-sm);--bs-modal-inner-border-radius:calc(var(--bs-border-radius-lg) - (var(--bs-border-width)));--bs-modal-header-padding-x:1rem;--bs-modal-header-padding-y:1rem;--bs-modal-header-padding:1rem 1rem;--bs-modal-header-border-color:var(--bs-border-color);--bs-modal-header-border-width:var(--bs-border-width);--bs-modal-title-line-height:1.5;--bs-modal-footer-gap:.5rem;--bs-modal-footer-bg: ;--bs-modal-footer-border-color:var(--bs-border-color);--bs-modal-footer-border-width:var(--bs-border-width);position:fixed;top:0;left:0;z-index:var(--bs-modal-zindex);display:none;width:100%;height:100%;overflow-x:hidden;overflow-y:auto;outline:0}.modal-dialog[_ngcontent-%COMP%]{position:relative;width:auto;margin:var(--bs-modal-margin);pointer-events:none}.modal.fade[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{transition:transform .3s ease-out;transform:translateY(-50px)}@media (prefers-reduced-motion:reduce){.modal.fade[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{transition:none}}.modal.show[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{transform:none}.modal.modal-static[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{transform:scale(1.02)}.modal-dialog-scrollable[_ngcontent-%COMP%]{height:calc(100% - var(--bs-modal-margin) * 2)}.modal-dialog-scrollable[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{max-height:100%;overflow:hidden}.modal-dialog-scrollable[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-dialog-centered[_ngcontent-%COMP%]{display:flex;align-items:center;min-height:calc(100% - var(--bs-modal-margin) * 2)}.modal-content[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;width:100%;color:var(--bs-modal-color);pointer-events:auto;background-color:var(--bs-modal-bg);background-clip:padding-box;border:var(--bs-modal-border-width) solid var(--bs-modal-border-color);border-radius:var(--bs-modal-border-radius);outline:0}.modal-backdrop[_ngcontent-%COMP%]{--bs-backdrop-zindex:1050;--bs-backdrop-bg:#000;--bs-backdrop-opacity:.5;position:fixed;top:0;left:0;z-index:var(--bs-backdrop-zindex);width:100vw;height:100vh;background-color:var(--bs-backdrop-bg)}.modal-backdrop.fade[_ngcontent-%COMP%]{opacity:0}.modal-backdrop.show[_ngcontent-%COMP%]{opacity:var(--bs-backdrop-opacity)}.modal-header[_ngcontent-%COMP%]{display:flex;flex-shrink:0;align-items:center;padding:var(--bs-modal-header-padding);border-bottom:var(--bs-modal-header-border-width) solid var(--bs-modal-header-border-color);border-top-left-radius:var(--bs-modal-inner-border-radius);border-top-right-radius:var(--bs-modal-inner-border-radius)}.modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{padding:calc(var(--bs-modal-header-padding-y) * .5) calc(var(--bs-modal-header-padding-x) * .5);margin:calc(-.5 * var(--bs-modal-header-padding-y)) calc(-.5 * var(--bs-modal-header-padding-x)) calc(-.5 * var(--bs-modal-header-padding-y)) auto}.modal-title[_ngcontent-%COMP%]{margin-bottom:0;line-height:var(--bs-modal-title-line-height)}.modal-body[_ngcontent-%COMP%]{position:relative;flex:1 1 auto;padding:var(--bs-modal-padding)}.modal-footer[_ngcontent-%COMP%]{display:flex;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;padding:calc(var(--bs-modal-padding) - var(--bs-modal-footer-gap) * .5);background-color:var(--bs-modal-footer-bg);border-top:var(--bs-modal-footer-border-width) solid var(--bs-modal-footer-border-color);border-bottom-right-radius:var(--bs-modal-inner-border-radius);border-bottom-left-radius:var(--bs-modal-inner-border-radius)}.modal-footer[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:calc(var(--bs-modal-footer-gap) * .5)}@media (min-width:576px){.modal[_ngcontent-%COMP%]{--bs-modal-margin:1.75rem;--bs-modal-box-shadow:var(--bs-box-shadow)}.modal-dialog[_ngcontent-%COMP%]{max-width:var(--bs-modal-width);margin-right:auto;margin-left:auto}.modal-sm[_ngcontent-%COMP%]{--bs-modal-width:300px}}@media (min-width:992px){.modal-lg[_ngcontent-%COMP%], .modal-xl[_ngcontent-%COMP%]{--bs-modal-width:800px}}@media (min-width:1200px){.modal-xl[_ngcontent-%COMP%]{--bs-modal-width:1140px}}.modal-fullscreen[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%], .modal-fullscreen[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}@media (max-width:575.98px){.modal-fullscreen-sm-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-sm-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-sm-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%], .modal-fullscreen-sm-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-sm-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}}@media (max-width:767.98px){.modal-fullscreen-md-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-md-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-md-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%], .modal-fullscreen-md-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-md-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}}@media (max-width:991.98px){.modal-fullscreen-lg-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-lg-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-lg-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%], .modal-fullscreen-lg-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-lg-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}}@media (max-width:1199.98px){.modal-fullscreen-xl-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-xl-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-xl-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%], .modal-fullscreen-xl-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-xl-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}}@media (max-width:1399.98px){.modal-fullscreen-xxl-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-xxl-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-xxl-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%], .modal-fullscreen-xxl-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-xxl-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}}.tooltip[_ngcontent-%COMP%]{--bs-tooltip-zindex:1080;--bs-tooltip-max-width:200px;--bs-tooltip-padding-x:.5rem;--bs-tooltip-padding-y:.25rem;--bs-tooltip-margin: ;--bs-tooltip-font-size:.875rem;--bs-tooltip-color:var(--bs-body-bg);--bs-tooltip-bg:var(--bs-emphasis-color);--bs-tooltip-border-radius:var(--bs-border-radius);--bs-tooltip-opacity:.9;--bs-tooltip-arrow-width:.8rem;--bs-tooltip-arrow-height:.4rem;z-index:var(--bs-tooltip-zindex);display:block;margin:var(--bs-tooltip-margin);font-family:var(--bs-font-sans-serif);font-style:normal;font-weight:400;line-height:1.5;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;white-space:normal;word-spacing:normal;line-break:auto;font-size:var(--bs-tooltip-font-size);word-wrap:break-word;opacity:0}.tooltip.show[_ngcontent-%COMP%]{opacity:var(--bs-tooltip-opacity)}.tooltip[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{display:block;width:var(--bs-tooltip-arrow-width);height:var(--bs-tooltip-arrow-height)}.tooltip[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before{position:absolute;content:\"\";border-color:transparent;border-style:solid}.bs-tooltip-auto[data-popper-placement^=top][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%], .bs-tooltip-top[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{bottom:calc(-1 * var(--bs-tooltip-arrow-height))}.bs-tooltip-auto[data-popper-placement^=top][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before, .bs-tooltip-top[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before{top:-1px;border-width:var(--bs-tooltip-arrow-height) calc(var(--bs-tooltip-arrow-width) * .5) 0;border-top-color:var(--bs-tooltip-bg)}.bs-tooltip-auto[data-popper-placement^=right][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%], .bs-tooltip-end[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{left:calc(-1 * var(--bs-tooltip-arrow-height));width:var(--bs-tooltip-arrow-height);height:var(--bs-tooltip-arrow-width)}.bs-tooltip-auto[data-popper-placement^=right][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before, .bs-tooltip-end[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before{right:-1px;border-width:calc(var(--bs-tooltip-arrow-width) * .5) var(--bs-tooltip-arrow-height) calc(var(--bs-tooltip-arrow-width) * .5) 0;border-right-color:var(--bs-tooltip-bg)}.bs-tooltip-auto[data-popper-placement^=bottom][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%], .bs-tooltip-bottom[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{top:calc(-1 * var(--bs-tooltip-arrow-height))}.bs-tooltip-auto[data-popper-placement^=bottom][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before, .bs-tooltip-bottom[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before{bottom:-1px;border-width:0 calc(var(--bs-tooltip-arrow-width) * .5) var(--bs-tooltip-arrow-height);border-bottom-color:var(--bs-tooltip-bg)}.bs-tooltip-auto[data-popper-placement^=left][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%], .bs-tooltip-start[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{right:calc(-1 * var(--bs-tooltip-arrow-height));width:var(--bs-tooltip-arrow-height);height:var(--bs-tooltip-arrow-width)}.bs-tooltip-auto[data-popper-placement^=left][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before, .bs-tooltip-start[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before{left:-1px;border-width:calc(var(--bs-tooltip-arrow-width) * .5) 0 calc(var(--bs-tooltip-arrow-width) * .5) var(--bs-tooltip-arrow-height);border-left-color:var(--bs-tooltip-bg)}.tooltip-inner[_ngcontent-%COMP%]{max-width:var(--bs-tooltip-max-width);padding:var(--bs-tooltip-padding-y) var(--bs-tooltip-padding-x);color:var(--bs-tooltip-color);text-align:center;background-color:var(--bs-tooltip-bg);border-radius:var(--bs-tooltip-border-radius)}.popover[_ngcontent-%COMP%]{--bs-popover-zindex:1070;--bs-popover-max-width:276px;--bs-popover-font-size:.875rem;--bs-popover-bg:var(--bs-body-bg);--bs-popover-border-width:var(--bs-border-width);--bs-popover-border-color:var(--bs-border-color-translucent);--bs-popover-border-radius:var(--bs-border-radius-lg);--bs-popover-inner-border-radius:calc(var(--bs-border-radius-lg) - var(--bs-border-width));--bs-popover-box-shadow:var(--bs-box-shadow);--bs-popover-header-padding-x:1rem;--bs-popover-header-padding-y:.5rem;--bs-popover-header-font-size:1rem;--bs-popover-header-color:inherit;--bs-popover-header-bg:var(--bs-secondary-bg);--bs-popover-body-padding-x:1rem;--bs-popover-body-padding-y:1rem;--bs-popover-body-color:var(--bs-body-color);--bs-popover-arrow-width:1rem;--bs-popover-arrow-height:.5rem;--bs-popover-arrow-border:var(--bs-popover-border-color);z-index:var(--bs-popover-zindex);display:block;max-width:var(--bs-popover-max-width);font-family:var(--bs-font-sans-serif);font-style:normal;font-weight:400;line-height:1.5;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;white-space:normal;word-spacing:normal;line-break:auto;font-size:var(--bs-popover-font-size);word-wrap:break-word;background-color:var(--bs-popover-bg);background-clip:padding-box;border:var(--bs-popover-border-width) solid var(--bs-popover-border-color);border-radius:var(--bs-popover-border-radius)}.popover[_ngcontent-%COMP%]   .popover-arrow[_ngcontent-%COMP%]{display:block;width:var(--bs-popover-arrow-width);height:var(--bs-popover-arrow-height)}.popover[_ngcontent-%COMP%]   .popover-arrow[_ngcontent-%COMP%]:after, .popover[_ngcontent-%COMP%]   .popover-arrow[_ngcontent-%COMP%]:before{position:absolute;display:block;content:\"\";border-color:transparent;border-style:solid;border-width:0}.bs-popover-auto[data-popper-placement^=top][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%], .bs-popover-top[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]{bottom:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width))}.bs-popover-auto[data-popper-placement^=top][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-auto[data-popper-placement^=top][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-top[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-top[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{border-width:var(--bs-popover-arrow-height) calc(var(--bs-popover-arrow-width) * .5) 0}.bs-popover-auto[data-popper-placement^=top][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-top[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{bottom:0;border-top-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=top][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-top[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after{bottom:var(--bs-popover-border-width);border-top-color:var(--bs-popover-bg)}.bs-popover-auto[data-popper-placement^=right][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%], .bs-popover-end[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]{left:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width));width:var(--bs-popover-arrow-height);height:var(--bs-popover-arrow-width)}.bs-popover-auto[data-popper-placement^=right][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-auto[data-popper-placement^=right][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-end[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-end[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{border-width:calc(var(--bs-popover-arrow-width) * .5) var(--bs-popover-arrow-height) calc(var(--bs-popover-arrow-width) * .5) 0}.bs-popover-auto[data-popper-placement^=right][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-end[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{left:0;border-right-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=right][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-end[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after{left:var(--bs-popover-border-width);border-right-color:var(--bs-popover-bg)}.bs-popover-auto[data-popper-placement^=bottom][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%], .bs-popover-bottom[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]{top:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width))}.bs-popover-auto[data-popper-placement^=bottom][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-auto[data-popper-placement^=bottom][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-bottom[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-bottom[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{border-width:0 calc(var(--bs-popover-arrow-width) * .5) var(--bs-popover-arrow-height)}.bs-popover-auto[data-popper-placement^=bottom][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-bottom[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{top:0;border-bottom-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=bottom][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-bottom[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after{top:var(--bs-popover-border-width);border-bottom-color:var(--bs-popover-bg)}.bs-popover-auto[data-popper-placement^=bottom][_ngcontent-%COMP%]   .popover-header[_ngcontent-%COMP%]:before, .bs-popover-bottom[_ngcontent-%COMP%]   .popover-header[_ngcontent-%COMP%]:before{position:absolute;top:0;left:50%;display:block;width:var(--bs-popover-arrow-width);margin-left:calc(-.5 * var(--bs-popover-arrow-width));content:\"\";border-bottom:var(--bs-popover-border-width) solid var(--bs-popover-header-bg)}.bs-popover-auto[data-popper-placement^=left][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%], .bs-popover-start[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]{right:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width));width:var(--bs-popover-arrow-height);height:var(--bs-popover-arrow-width)}.bs-popover-auto[data-popper-placement^=left][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-auto[data-popper-placement^=left][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-start[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-start[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{border-width:calc(var(--bs-popover-arrow-width) * .5) 0 calc(var(--bs-popover-arrow-width) * .5) var(--bs-popover-arrow-height)}.bs-popover-auto[data-popper-placement^=left][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-start[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{right:0;border-left-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=left][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-start[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after{right:var(--bs-popover-border-width);border-left-color:var(--bs-popover-bg)}.popover-header[_ngcontent-%COMP%]{padding:var(--bs-popover-header-padding-y) var(--bs-popover-header-padding-x);margin-bottom:0;font-size:var(--bs-popover-header-font-size);color:var(--bs-popover-header-color);background-color:var(--bs-popover-header-bg);border-bottom:var(--bs-popover-border-width) solid var(--bs-popover-border-color);border-top-left-radius:var(--bs-popover-inner-border-radius);border-top-right-radius:var(--bs-popover-inner-border-radius)}.popover-header[_ngcontent-%COMP%]:empty{display:none}.popover-body[_ngcontent-%COMP%]{padding:var(--bs-popover-body-padding-y) var(--bs-popover-body-padding-x);color:var(--bs-popover-body-color)}.carousel[_ngcontent-%COMP%]{position:relative}.carousel.pointer-event[_ngcontent-%COMP%]{touch-action:pan-y}.carousel-inner[_ngcontent-%COMP%]{position:relative;width:100%;overflow:hidden}.carousel-inner[_ngcontent-%COMP%]:after{display:block;clear:both;content:\"\"}.carousel-item[_ngcontent-%COMP%]{position:relative;display:none;float:left;width:100%;margin-right:-100%;backface-visibility:hidden;transition:transform .6s ease-in-out}@media (prefers-reduced-motion:reduce){.carousel-item[_ngcontent-%COMP%]{transition:none}}.carousel-item-next[_ngcontent-%COMP%], .carousel-item-prev[_ngcontent-%COMP%], .carousel-item.active[_ngcontent-%COMP%]{display:block}.active.carousel-item-end[_ngcontent-%COMP%], .carousel-item-next[_ngcontent-%COMP%]:not(.carousel-item-start){transform:translate(100%)}.active.carousel-item-start[_ngcontent-%COMP%], .carousel-item-prev[_ngcontent-%COMP%]:not(.carousel-item-end){transform:translate(-100%)}.carousel-fade[_ngcontent-%COMP%]   .carousel-item[_ngcontent-%COMP%]{opacity:0;transition-property:opacity;transform:none}.carousel-fade[_ngcontent-%COMP%]   .carousel-item-next.carousel-item-start[_ngcontent-%COMP%], .carousel-fade[_ngcontent-%COMP%]   .carousel-item-prev.carousel-item-end[_ngcontent-%COMP%], .carousel-fade[_ngcontent-%COMP%]   .carousel-item.active[_ngcontent-%COMP%]{z-index:1;opacity:1}.carousel-fade[_ngcontent-%COMP%]   .active.carousel-item-end[_ngcontent-%COMP%], .carousel-fade[_ngcontent-%COMP%]   .active.carousel-item-start[_ngcontent-%COMP%]{z-index:0;opacity:0;transition:opacity 0s .6s}@media (prefers-reduced-motion:reduce){.carousel-fade[_ngcontent-%COMP%]   .active.carousel-item-end[_ngcontent-%COMP%], .carousel-fade[_ngcontent-%COMP%]   .active.carousel-item-start[_ngcontent-%COMP%]{transition:none}}.carousel-control-next[_ngcontent-%COMP%], .carousel-control-prev[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;z-index:1;display:flex;align-items:center;justify-content:center;width:15%;padding:0;color:#fff;text-align:center;background:0 0;border:0;opacity:.5;transition:opacity .15s ease}@media (prefers-reduced-motion:reduce){.carousel-control-next[_ngcontent-%COMP%], .carousel-control-prev[_ngcontent-%COMP%]{transition:none}}.carousel-control-next[_ngcontent-%COMP%]:focus, .carousel-control-next[_ngcontent-%COMP%]:hover, .carousel-control-prev[_ngcontent-%COMP%]:focus, .carousel-control-prev[_ngcontent-%COMP%]:hover{color:#fff;text-decoration:none;outline:0;opacity:.9}.carousel-control-prev[_ngcontent-%COMP%]{left:0}.carousel-control-next[_ngcontent-%COMP%]{right:0}.carousel-control-next-icon[_ngcontent-%COMP%], .carousel-control-prev-icon[_ngcontent-%COMP%]{display:inline-block;width:2rem;height:2rem;background-repeat:no-repeat;background-position:50%;background-size:100% 100%}.carousel-control-prev-icon[_ngcontent-%COMP%]{background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z'/%3e%3c/svg%3e\")}.carousel-control-next-icon[_ngcontent-%COMP%]{background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e\")}.carousel-indicators[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;left:0;z-index:2;display:flex;justify-content:center;padding:0;margin-right:15%;margin-bottom:1rem;margin-left:15%}.carousel-indicators[_ngcontent-%COMP%]   [data-bs-target][_ngcontent-%COMP%]{box-sizing:content-box;flex:0 1 auto;width:30px;height:3px;padding:0;margin-right:3px;margin-left:3px;text-indent:-999px;cursor:pointer;background-color:#fff;background-clip:padding-box;border:0;border-top:10px solid transparent;border-bottom:10px solid transparent;opacity:.5;transition:opacity .6s ease}@media (prefers-reduced-motion:reduce){.carousel-indicators[_ngcontent-%COMP%]   [data-bs-target][_ngcontent-%COMP%]{transition:none}}.carousel-indicators[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{opacity:1}.carousel-caption[_ngcontent-%COMP%]{position:absolute;right:15%;bottom:1.25rem;left:15%;padding-top:1.25rem;padding-bottom:1.25rem;color:#fff;text-align:center}.carousel-dark[_ngcontent-%COMP%]   .carousel-control-next-icon[_ngcontent-%COMP%], .carousel-dark[_ngcontent-%COMP%]   .carousel-control-prev-icon[_ngcontent-%COMP%]{filter:invert(1) grayscale(100)}.carousel-dark[_ngcontent-%COMP%]   .carousel-indicators[_ngcontent-%COMP%]   [data-bs-target][_ngcontent-%COMP%]{background-color:#000}.carousel-dark[_ngcontent-%COMP%]   .carousel-caption[_ngcontent-%COMP%]{color:#000}[data-bs-theme=dark][_ngcontent-%COMP%]   .carousel[_ngcontent-%COMP%]   .carousel-control-next-icon[_ngcontent-%COMP%], [data-bs-theme=dark][_ngcontent-%COMP%]   .carousel[_ngcontent-%COMP%]   .carousel-control-prev-icon[_ngcontent-%COMP%], [data-bs-theme=dark].carousel[_ngcontent-%COMP%]   .carousel-control-next-icon[_ngcontent-%COMP%], [data-bs-theme=dark].carousel[_ngcontent-%COMP%]   .carousel-control-prev-icon[_ngcontent-%COMP%]{filter:invert(1) grayscale(100)}[data-bs-theme=dark][_ngcontent-%COMP%]   .carousel[_ngcontent-%COMP%]   .carousel-indicators[_ngcontent-%COMP%]   [data-bs-target][_ngcontent-%COMP%], [data-bs-theme=dark].carousel[_ngcontent-%COMP%]   .carousel-indicators[_ngcontent-%COMP%]   [data-bs-target][_ngcontent-%COMP%]{background-color:#000}[data-bs-theme=dark][_ngcontent-%COMP%]   .carousel[_ngcontent-%COMP%]   .carousel-caption[_ngcontent-%COMP%], [data-bs-theme=dark].carousel[_ngcontent-%COMP%]   .carousel-caption[_ngcontent-%COMP%]{color:#000}.spinner-border[_ngcontent-%COMP%], .spinner-grow[_ngcontent-%COMP%]{display:inline-block;width:var(--bs-spinner-width);height:var(--bs-spinner-height);vertical-align:var(--bs-spinner-vertical-align);border-radius:50%;animation:var(--bs-spinner-animation-speed) linear infinite var(--bs-spinner-animation-name)}@keyframes _ngcontent-%COMP%_spinner-border{to{transform:rotate(360deg)}}.spinner-border[_ngcontent-%COMP%]{--bs-spinner-width:2rem;--bs-spinner-height:2rem;--bs-spinner-vertical-align:-.125em;--bs-spinner-border-width:.25em;--bs-spinner-animation-speed:.75s;--bs-spinner-animation-name:spinner-border;border:var(--bs-spinner-border-width) solid currentcolor;border-right-color:transparent}.spinner-border-sm[_ngcontent-%COMP%]{--bs-spinner-width:1rem;--bs-spinner-height:1rem;--bs-spinner-border-width:.2em}@keyframes _ngcontent-%COMP%_spinner-grow{0%{transform:scale(0)}50%{opacity:1;transform:none}}.spinner-grow[_ngcontent-%COMP%]{--bs-spinner-width:2rem;--bs-spinner-height:2rem;--bs-spinner-vertical-align:-.125em;--bs-spinner-animation-speed:.75s;--bs-spinner-animation-name:spinner-grow;background-color:currentcolor;opacity:0}.spinner-grow-sm[_ngcontent-%COMP%]{--bs-spinner-width:1rem;--bs-spinner-height:1rem}@media (prefers-reduced-motion:reduce){.spinner-border[_ngcontent-%COMP%], .spinner-grow[_ngcontent-%COMP%]{--bs-spinner-animation-speed:1.5s}}.offcanvas[_ngcontent-%COMP%], .offcanvas-lg[_ngcontent-%COMP%], .offcanvas-md[_ngcontent-%COMP%], .offcanvas-sm[_ngcontent-%COMP%], .offcanvas-xl[_ngcontent-%COMP%], .offcanvas-xxl[_ngcontent-%COMP%]{--bs-offcanvas-zindex:1045;--bs-offcanvas-width:400px;--bs-offcanvas-height:30vh;--bs-offcanvas-padding-x:1rem;--bs-offcanvas-padding-y:1rem;--bs-offcanvas-color:var(--bs-body-color);--bs-offcanvas-bg:var(--bs-body-bg);--bs-offcanvas-border-width:var(--bs-border-width);--bs-offcanvas-border-color:var(--bs-border-color-translucent);--bs-offcanvas-box-shadow:var(--bs-box-shadow-sm);--bs-offcanvas-transition:transform .3s ease-in-out;--bs-offcanvas-title-line-height:1.5}@media (max-width:575.98px){.offcanvas-sm[_ngcontent-%COMP%]{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:575.98px) and (prefers-reduced-motion:reduce){.offcanvas-sm[_ngcontent-%COMP%]{transition:none}}@media (max-width:575.98px){.offcanvas-sm.offcanvas-start[_ngcontent-%COMP%]{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(-100%)}.offcanvas-sm.offcanvas-end[_ngcontent-%COMP%]{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(100%)}.offcanvas-sm.offcanvas-top[_ngcontent-%COMP%]{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-sm.offcanvas-bottom[_ngcontent-%COMP%]{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-sm.show[_ngcontent-%COMP%]:not(.hiding), .offcanvas-sm.showing[_ngcontent-%COMP%]{transform:none}.offcanvas-sm.hiding[_ngcontent-%COMP%], .offcanvas-sm.show[_ngcontent-%COMP%], .offcanvas-sm.showing[_ngcontent-%COMP%]{visibility:visible}}@media (min-width:576px){.offcanvas-sm[_ngcontent-%COMP%]{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-sm[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.offcanvas-sm[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:767.98px){.offcanvas-md[_ngcontent-%COMP%]{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:767.98px) and (prefers-reduced-motion:reduce){.offcanvas-md[_ngcontent-%COMP%]{transition:none}}@media (max-width:767.98px){.offcanvas-md.offcanvas-start[_ngcontent-%COMP%]{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(-100%)}.offcanvas-md.offcanvas-end[_ngcontent-%COMP%]{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(100%)}.offcanvas-md.offcanvas-top[_ngcontent-%COMP%]{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-md.offcanvas-bottom[_ngcontent-%COMP%]{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-md.show[_ngcontent-%COMP%]:not(.hiding), .offcanvas-md.showing[_ngcontent-%COMP%]{transform:none}.offcanvas-md.hiding[_ngcontent-%COMP%], .offcanvas-md.show[_ngcontent-%COMP%], .offcanvas-md.showing[_ngcontent-%COMP%]{visibility:visible}}@media (min-width:768px){.offcanvas-md[_ngcontent-%COMP%]{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-md[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.offcanvas-md[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:991.98px){.offcanvas-lg[_ngcontent-%COMP%]{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:991.98px) and (prefers-reduced-motion:reduce){.offcanvas-lg[_ngcontent-%COMP%]{transition:none}}@media (max-width:991.98px){.offcanvas-lg.offcanvas-start[_ngcontent-%COMP%]{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(-100%)}.offcanvas-lg.offcanvas-end[_ngcontent-%COMP%]{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(100%)}.offcanvas-lg.offcanvas-top[_ngcontent-%COMP%]{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-lg.offcanvas-bottom[_ngcontent-%COMP%]{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-lg.show[_ngcontent-%COMP%]:not(.hiding), .offcanvas-lg.showing[_ngcontent-%COMP%]{transform:none}.offcanvas-lg.hiding[_ngcontent-%COMP%], .offcanvas-lg.show[_ngcontent-%COMP%], .offcanvas-lg.showing[_ngcontent-%COMP%]{visibility:visible}}@media (min-width:992px){.offcanvas-lg[_ngcontent-%COMP%]{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-lg[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.offcanvas-lg[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:1199.98px){.offcanvas-xl[_ngcontent-%COMP%]{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:1199.98px) and (prefers-reduced-motion:reduce){.offcanvas-xl[_ngcontent-%COMP%]{transition:none}}@media (max-width:1199.98px){.offcanvas-xl.offcanvas-start[_ngcontent-%COMP%]{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(-100%)}.offcanvas-xl.offcanvas-end[_ngcontent-%COMP%]{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(100%)}.offcanvas-xl.offcanvas-top[_ngcontent-%COMP%]{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-xl.offcanvas-bottom[_ngcontent-%COMP%]{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-xl.show[_ngcontent-%COMP%]:not(.hiding), .offcanvas-xl.showing[_ngcontent-%COMP%]{transform:none}.offcanvas-xl.hiding[_ngcontent-%COMP%], .offcanvas-xl.show[_ngcontent-%COMP%], .offcanvas-xl.showing[_ngcontent-%COMP%]{visibility:visible}}@media (min-width:1200px){.offcanvas-xl[_ngcontent-%COMP%]{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-xl[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.offcanvas-xl[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:1399.98px){.offcanvas-xxl[_ngcontent-%COMP%]{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:1399.98px) and (prefers-reduced-motion:reduce){.offcanvas-xxl[_ngcontent-%COMP%]{transition:none}}@media (max-width:1399.98px){.offcanvas-xxl.offcanvas-start[_ngcontent-%COMP%]{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(-100%)}.offcanvas-xxl.offcanvas-end[_ngcontent-%COMP%]{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(100%)}.offcanvas-xxl.offcanvas-top[_ngcontent-%COMP%]{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-xxl.offcanvas-bottom[_ngcontent-%COMP%]{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-xxl.show[_ngcontent-%COMP%]:not(.hiding), .offcanvas-xxl.showing[_ngcontent-%COMP%]{transform:none}.offcanvas-xxl.hiding[_ngcontent-%COMP%], .offcanvas-xxl.show[_ngcontent-%COMP%], .offcanvas-xxl.showing[_ngcontent-%COMP%]{visibility:visible}}@media (min-width:1400px){.offcanvas-xxl[_ngcontent-%COMP%]{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-xxl[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.offcanvas-xxl[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}.offcanvas[_ngcontent-%COMP%]{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}@media (prefers-reduced-motion:reduce){.offcanvas[_ngcontent-%COMP%]{transition:none}}.offcanvas.offcanvas-start[_ngcontent-%COMP%]{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(-100%)}.offcanvas.offcanvas-end[_ngcontent-%COMP%]{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(100%)}.offcanvas.offcanvas-top[_ngcontent-%COMP%]{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas.offcanvas-bottom[_ngcontent-%COMP%]{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas.show[_ngcontent-%COMP%]:not(.hiding), .offcanvas.showing[_ngcontent-%COMP%]{transform:none}.offcanvas.hiding[_ngcontent-%COMP%], .offcanvas.show[_ngcontent-%COMP%], .offcanvas.showing[_ngcontent-%COMP%]{visibility:visible}.offcanvas-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;z-index:1040;width:100vw;height:100vh;background-color:#000}.offcanvas-backdrop.fade[_ngcontent-%COMP%]{opacity:0}.offcanvas-backdrop.show[_ngcontent-%COMP%]{opacity:.5}.offcanvas-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:var(--bs-offcanvas-padding-y) var(--bs-offcanvas-padding-x)}.offcanvas-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{padding:calc(var(--bs-offcanvas-padding-y) * .5) calc(var(--bs-offcanvas-padding-x) * .5);margin:calc(-.5 * var(--bs-offcanvas-padding-y)) calc(-.5 * var(--bs-offcanvas-padding-x)) calc(-.5 * var(--bs-offcanvas-padding-y)) auto}.offcanvas-title[_ngcontent-%COMP%]{margin-bottom:0;line-height:var(--bs-offcanvas-title-line-height)}.offcanvas-body[_ngcontent-%COMP%]{flex-grow:1;padding:var(--bs-offcanvas-padding-y) var(--bs-offcanvas-padding-x);overflow-y:auto}.placeholder[_ngcontent-%COMP%]{display:inline-block;min-height:1em;vertical-align:middle;cursor:wait;background-color:currentcolor;opacity:.5}.placeholder.btn[_ngcontent-%COMP%]:before{display:inline-block;content:\"\"}.placeholder-xs[_ngcontent-%COMP%]{min-height:.6em}.placeholder-sm[_ngcontent-%COMP%]{min-height:.8em}.placeholder-lg[_ngcontent-%COMP%]{min-height:1.2em}.placeholder-glow[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_placeholder-glow 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_placeholder-glow{50%{opacity:.2}}.placeholder-wave[_ngcontent-%COMP%]{-webkit-mask-image:linear-gradient(130deg,#000 55%,rgba(0,0,0,.8) 75%,#000 95%);mask-image:linear-gradient(130deg,#000 55%,rgba(0,0,0,.8) 75%,#000 95%);-webkit-mask-size:200% 100%;mask-size:200% 100%;animation:_ngcontent-%COMP%_placeholder-wave 2s linear infinite}@keyframes _ngcontent-%COMP%_placeholder-wave{to{-webkit-mask-position:-200% 0%;mask-position:-200% 0%}}.clearfix[_ngcontent-%COMP%]:after{display:block;clear:both;content:\"\"}.text-bg-primary[_ngcontent-%COMP%]{color:#fff!important;background-color:RGBA(var(--bs-primary-rgb),var(--bs-bg-opacity,1))!important}.text-bg-secondary[_ngcontent-%COMP%]{color:#fff!important;background-color:RGBA(var(--bs-secondary-rgb),var(--bs-bg-opacity,1))!important}.text-bg-success[_ngcontent-%COMP%]{color:#fff!important;background-color:RGBA(var(--bs-success-rgb),var(--bs-bg-opacity,1))!important}.text-bg-info[_ngcontent-%COMP%]{color:#000!important;background-color:RGBA(var(--bs-info-rgb),var(--bs-bg-opacity,1))!important}.text-bg-warning[_ngcontent-%COMP%]{color:#000!important;background-color:RGBA(var(--bs-warning-rgb),var(--bs-bg-opacity,1))!important}.text-bg-danger[_ngcontent-%COMP%]{color:#fff!important;background-color:RGBA(var(--bs-danger-rgb),var(--bs-bg-opacity,1))!important}.text-bg-light[_ngcontent-%COMP%]{color:#000!important;background-color:RGBA(var(--bs-light-rgb),var(--bs-bg-opacity,1))!important}.text-bg-dark[_ngcontent-%COMP%]{color:#fff!important;background-color:RGBA(var(--bs-dark-rgb),var(--bs-bg-opacity,1))!important}.link-primary[_ngcontent-%COMP%]{color:RGBA(var(--bs-primary-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-primary-rgb),var(--bs-link-underline-opacity,1))!important}.link-primary[_ngcontent-%COMP%]:focus, .link-primary[_ngcontent-%COMP%]:hover{color:RGBA(10,88,202,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(10,88,202,var(--bs-link-underline-opacity,1))!important}.link-secondary[_ngcontent-%COMP%]{color:RGBA(var(--bs-secondary-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-secondary-rgb),var(--bs-link-underline-opacity,1))!important}.link-secondary[_ngcontent-%COMP%]:focus, .link-secondary[_ngcontent-%COMP%]:hover{color:RGBA(86,94,100,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(86,94,100,var(--bs-link-underline-opacity,1))!important}.link-success[_ngcontent-%COMP%]{color:RGBA(var(--bs-success-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-success-rgb),var(--bs-link-underline-opacity,1))!important}.link-success[_ngcontent-%COMP%]:focus, .link-success[_ngcontent-%COMP%]:hover{color:RGBA(20,108,67,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(20,108,67,var(--bs-link-underline-opacity,1))!important}.link-info[_ngcontent-%COMP%]{color:RGBA(var(--bs-info-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-info-rgb),var(--bs-link-underline-opacity,1))!important}.link-info[_ngcontent-%COMP%]:focus, .link-info[_ngcontent-%COMP%]:hover{color:RGBA(61,213,243,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(61,213,243,var(--bs-link-underline-opacity,1))!important}.link-warning[_ngcontent-%COMP%]{color:RGBA(var(--bs-warning-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-warning-rgb),var(--bs-link-underline-opacity,1))!important}.link-warning[_ngcontent-%COMP%]:focus, .link-warning[_ngcontent-%COMP%]:hover{color:RGBA(255,205,57,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(255,205,57,var(--bs-link-underline-opacity,1))!important}.link-danger[_ngcontent-%COMP%]{color:RGBA(var(--bs-danger-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-danger-rgb),var(--bs-link-underline-opacity,1))!important}.link-danger[_ngcontent-%COMP%]:focus, .link-danger[_ngcontent-%COMP%]:hover{color:RGBA(176,42,55,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(176,42,55,var(--bs-link-underline-opacity,1))!important}.link-light[_ngcontent-%COMP%]{color:RGBA(var(--bs-light-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-light-rgb),var(--bs-link-underline-opacity,1))!important}.link-light[_ngcontent-%COMP%]:focus, .link-light[_ngcontent-%COMP%]:hover{color:RGBA(249,250,251,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(249,250,251,var(--bs-link-underline-opacity,1))!important}.link-dark[_ngcontent-%COMP%]{color:RGBA(var(--bs-dark-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-dark-rgb),var(--bs-link-underline-opacity,1))!important}.link-dark[_ngcontent-%COMP%]:focus, .link-dark[_ngcontent-%COMP%]:hover{color:RGBA(26,30,33,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(26,30,33,var(--bs-link-underline-opacity,1))!important}.link-body-emphasis[_ngcontent-%COMP%]{color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-underline-opacity,1))!important}.link-body-emphasis[_ngcontent-%COMP%]:focus, .link-body-emphasis[_ngcontent-%COMP%]:hover{color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-opacity,.75))!important;text-decoration-color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-underline-opacity,.75))!important}.focus-ring[_ngcontent-%COMP%]:focus{outline:0;box-shadow:var(--bs-focus-ring-x,0) var(--bs-focus-ring-y,0) var(--bs-focus-ring-blur,0) var(--bs-focus-ring-width) var(--bs-focus-ring-color)}.icon-link[_ngcontent-%COMP%]{display:inline-flex;gap:.375rem;align-items:center;text-decoration-color:rgba(var(--bs-link-color-rgb),var(--bs-link-opacity,.5));text-underline-offset:.25em;backface-visibility:hidden}.icon-link[_ngcontent-%COMP%] > .bi[_ngcontent-%COMP%]{flex-shrink:0;width:1em;height:1em;fill:currentcolor;transition:.2s ease-in-out transform}@media (prefers-reduced-motion:reduce){.icon-link[_ngcontent-%COMP%] > .bi[_ngcontent-%COMP%]{transition:none}}.icon-link-hover[_ngcontent-%COMP%]:focus-visible > .bi[_ngcontent-%COMP%], .icon-link-hover[_ngcontent-%COMP%]:hover > .bi[_ngcontent-%COMP%]{transform:var(--bs-icon-link-transform,translate3d(.25em,0,0))}.ratio[_ngcontent-%COMP%]{position:relative;width:100%}.ratio[_ngcontent-%COMP%]:before{display:block;padding-top:var(--bs-aspect-ratio);content:\"\"}.ratio[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.ratio-1x1[_ngcontent-%COMP%]{--bs-aspect-ratio:100%}.ratio-4x3[_ngcontent-%COMP%]{--bs-aspect-ratio:75%}.ratio-16x9[_ngcontent-%COMP%]{--bs-aspect-ratio:56.25%}.ratio-21x9[_ngcontent-%COMP%]{--bs-aspect-ratio:42.8571428571%}.fixed-top[_ngcontent-%COMP%]{position:fixed;top:0;right:0;left:0;z-index:1030}.fixed-bottom[_ngcontent-%COMP%]{position:fixed;right:0;bottom:0;left:0;z-index:1030}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1020}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:1020}@media (min-width:576px){.sticky-sm-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1020}.sticky-sm-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:1020}}@media (min-width:768px){.sticky-md-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1020}.sticky-md-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:1020}}@media (min-width:992px){.sticky-lg-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1020}.sticky-lg-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:1020}}@media (min-width:1200px){.sticky-xl-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1020}.sticky-xl-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:1020}}@media (min-width:1400px){.sticky-xxl-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1020}.sticky-xxl-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:1020}}.hstack[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;align-self:stretch}.vstack[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;align-self:stretch}.visually-hidden[_ngcontent-%COMP%], .visually-hidden-focusable[_ngcontent-%COMP%]:not(:focus):not(:focus-within){width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}.visually-hidden-focusable[_ngcontent-%COMP%]:not(:focus):not(:focus-within):not(caption), .visually-hidden[_ngcontent-%COMP%]:not(caption){position:absolute!important}.stretched-link[_ngcontent-%COMP%]:after{position:absolute;inset:0;z-index:1;content:\"\"}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.vr[_ngcontent-%COMP%]{display:inline-block;align-self:stretch;width:var(--bs-border-width);min-height:1em;background-color:currentcolor;opacity:.25}.align-baseline[_ngcontent-%COMP%]{vertical-align:baseline!important}.align-top[_ngcontent-%COMP%]{vertical-align:top!important}.align-middle[_ngcontent-%COMP%]{vertical-align:middle!important}.align-bottom[_ngcontent-%COMP%]{vertical-align:bottom!important}.align-text-bottom[_ngcontent-%COMP%]{vertical-align:text-bottom!important}.align-text-top[_ngcontent-%COMP%]{vertical-align:text-top!important}.float-start[_ngcontent-%COMP%]{float:left!important}.float-end[_ngcontent-%COMP%]{float:right!important}.float-none[_ngcontent-%COMP%]{float:none!important}.object-fit-contain[_ngcontent-%COMP%]{object-fit:contain!important}.object-fit-cover[_ngcontent-%COMP%]{object-fit:cover!important}.object-fit-fill[_ngcontent-%COMP%]{object-fit:fill!important}.object-fit-scale[_ngcontent-%COMP%]{object-fit:scale-down!important}.object-fit-none[_ngcontent-%COMP%]{object-fit:none!important}.opacity-0[_ngcontent-%COMP%]{opacity:0!important}.opacity-25[_ngcontent-%COMP%]{opacity:.25!important}.opacity-50[_ngcontent-%COMP%]{opacity:.5!important}.opacity-75[_ngcontent-%COMP%]{opacity:.75!important}.opacity-100[_ngcontent-%COMP%]{opacity:1!important}.overflow-auto[_ngcontent-%COMP%]{overflow:auto!important}.overflow-hidden[_ngcontent-%COMP%]{overflow:hidden!important}.overflow-visible[_ngcontent-%COMP%]{overflow:visible!important}.overflow-scroll[_ngcontent-%COMP%]{overflow:scroll!important}.overflow-x-auto[_ngcontent-%COMP%]{overflow-x:auto!important}.overflow-x-hidden[_ngcontent-%COMP%]{overflow-x:hidden!important}.overflow-x-visible[_ngcontent-%COMP%]{overflow-x:visible!important}.overflow-x-scroll[_ngcontent-%COMP%]{overflow-x:scroll!important}.overflow-y-auto[_ngcontent-%COMP%]{overflow-y:auto!important}.overflow-y-hidden[_ngcontent-%COMP%]{overflow-y:hidden!important}.overflow-y-visible[_ngcontent-%COMP%]{overflow-y:visible!important}.overflow-y-scroll[_ngcontent-%COMP%]{overflow-y:scroll!important}.d-inline[_ngcontent-%COMP%]{display:inline!important}.d-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-block[_ngcontent-%COMP%]{display:block!important}.d-grid[_ngcontent-%COMP%]{display:grid!important}.d-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-table[_ngcontent-%COMP%]{display:table!important}.d-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-flex[_ngcontent-%COMP%]{display:flex!important}.d-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-none[_ngcontent-%COMP%]{display:none!important}.shadow[_ngcontent-%COMP%]{box-shadow:var(--bs-box-shadow)!important}.shadow-sm[_ngcontent-%COMP%]{box-shadow:var(--bs-box-shadow-sm)!important}.shadow-lg[_ngcontent-%COMP%]{box-shadow:var(--bs-box-shadow-lg)!important}.shadow-none[_ngcontent-%COMP%]{box-shadow:none!important}.focus-ring-primary[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-primary-rgb), var(--bs-focus-ring-opacity))}.focus-ring-secondary[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-secondary-rgb), var(--bs-focus-ring-opacity))}.focus-ring-success[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-success-rgb), var(--bs-focus-ring-opacity))}.focus-ring-info[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-info-rgb), var(--bs-focus-ring-opacity))}.focus-ring-warning[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-warning-rgb), var(--bs-focus-ring-opacity))}.focus-ring-danger[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-danger-rgb), var(--bs-focus-ring-opacity))}.focus-ring-light[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-light-rgb), var(--bs-focus-ring-opacity))}.focus-ring-dark[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-dark-rgb), var(--bs-focus-ring-opacity))}.position-static[_ngcontent-%COMP%]{position:static!important}.position-relative[_ngcontent-%COMP%]{position:relative!important}.position-absolute[_ngcontent-%COMP%]{position:absolute!important}.position-fixed[_ngcontent-%COMP%]{position:fixed!important}.position-sticky[_ngcontent-%COMP%]{position:sticky!important}.top-0[_ngcontent-%COMP%]{top:0!important}.top-50[_ngcontent-%COMP%]{top:50%!important}.top-100[_ngcontent-%COMP%]{top:100%!important}.bottom-0[_ngcontent-%COMP%]{bottom:0!important}.bottom-50[_ngcontent-%COMP%]{bottom:50%!important}.bottom-100[_ngcontent-%COMP%]{bottom:100%!important}.start-0[_ngcontent-%COMP%]{left:0!important}.start-50[_ngcontent-%COMP%]{left:50%!important}.start-100[_ngcontent-%COMP%]{left:100%!important}.end-0[_ngcontent-%COMP%]{right:0!important}.end-50[_ngcontent-%COMP%]{right:50%!important}.end-100[_ngcontent-%COMP%]{right:100%!important}.translate-middle[_ngcontent-%COMP%]{transform:translate(-50%,-50%)!important}.translate-middle-x[_ngcontent-%COMP%]{transform:translate(-50%)!important}.translate-middle-y[_ngcontent-%COMP%]{transform:translateY(-50%)!important}.border[_ngcontent-%COMP%]{border:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-0[_ngcontent-%COMP%]{border:0!important}.border-top[_ngcontent-%COMP%]{border-top:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-top-0[_ngcontent-%COMP%]{border-top:0!important}.border-end[_ngcontent-%COMP%]{border-right:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-end-0[_ngcontent-%COMP%]{border-right:0!important}.border-bottom[_ngcontent-%COMP%]{border-bottom:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-bottom-0[_ngcontent-%COMP%]{border-bottom:0!important}.border-start[_ngcontent-%COMP%]{border-left:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-start-0[_ngcontent-%COMP%]{border-left:0!important}.border-primary[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-primary-rgb),var(--bs-border-opacity))!important}.border-secondary[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-secondary-rgb),var(--bs-border-opacity))!important}.border-success[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-success-rgb),var(--bs-border-opacity))!important}.border-info[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-info-rgb),var(--bs-border-opacity))!important}.border-warning[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-warning-rgb),var(--bs-border-opacity))!important}.border-danger[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-danger-rgb),var(--bs-border-opacity))!important}.border-light[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-light-rgb),var(--bs-border-opacity))!important}.border-dark[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-dark-rgb),var(--bs-border-opacity))!important}.border-black[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-black-rgb),var(--bs-border-opacity))!important}.border-white[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-white-rgb),var(--bs-border-opacity))!important}.border-primary-subtle[_ngcontent-%COMP%]{border-color:var(--bs-primary-border-subtle)!important}.border-secondary-subtle[_ngcontent-%COMP%]{border-color:var(--bs-secondary-border-subtle)!important}.border-success-subtle[_ngcontent-%COMP%]{border-color:var(--bs-success-border-subtle)!important}.border-info-subtle[_ngcontent-%COMP%]{border-color:var(--bs-info-border-subtle)!important}.border-warning-subtle[_ngcontent-%COMP%]{border-color:var(--bs-warning-border-subtle)!important}.border-danger-subtle[_ngcontent-%COMP%]{border-color:var(--bs-danger-border-subtle)!important}.border-light-subtle[_ngcontent-%COMP%]{border-color:var(--bs-light-border-subtle)!important}.border-dark-subtle[_ngcontent-%COMP%]{border-color:var(--bs-dark-border-subtle)!important}.border-1[_ngcontent-%COMP%]{border-width:1px!important}.border-2[_ngcontent-%COMP%]{border-width:2px!important}.border-3[_ngcontent-%COMP%]{border-width:3px!important}.border-4[_ngcontent-%COMP%]{border-width:4px!important}.border-5[_ngcontent-%COMP%]{border-width:5px!important}.border-opacity-10[_ngcontent-%COMP%]{--bs-border-opacity:.1}.border-opacity-25[_ngcontent-%COMP%]{--bs-border-opacity:.25}.border-opacity-50[_ngcontent-%COMP%]{--bs-border-opacity:.5}.border-opacity-75[_ngcontent-%COMP%]{--bs-border-opacity:.75}.border-opacity-100[_ngcontent-%COMP%]{--bs-border-opacity:1}.w-25[_ngcontent-%COMP%]{width:25%!important}.w-50[_ngcontent-%COMP%]{width:50%!important}.w-75[_ngcontent-%COMP%]{width:75%!important}.w-100[_ngcontent-%COMP%]{width:100%!important}.w-auto[_ngcontent-%COMP%]{width:auto!important}.mw-100[_ngcontent-%COMP%]{max-width:100%!important}.vw-100[_ngcontent-%COMP%]{width:100vw!important}.min-vw-100[_ngcontent-%COMP%]{min-width:100vw!important}.h-25[_ngcontent-%COMP%]{height:25%!important}.h-50[_ngcontent-%COMP%]{height:50%!important}.h-75[_ngcontent-%COMP%]{height:75%!important}.h-100[_ngcontent-%COMP%]{height:100%!important}.h-auto[_ngcontent-%COMP%]{height:auto!important}.mh-100[_ngcontent-%COMP%]{max-height:100%!important}.vh-100[_ngcontent-%COMP%]{height:100vh!important}.min-vh-100[_ngcontent-%COMP%]{min-height:100vh!important}.flex-fill[_ngcontent-%COMP%]{flex:1 1 auto!important}.flex-row[_ngcontent-%COMP%]{flex-direction:row!important}.flex-column[_ngcontent-%COMP%]{flex-direction:column!important}.flex-row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse!important}.flex-column-reverse[_ngcontent-%COMP%]{flex-direction:column-reverse!important}.flex-grow-0[_ngcontent-%COMP%]{flex-grow:0!important}.flex-grow-1[_ngcontent-%COMP%]{flex-grow:1!important}.flex-shrink-0[_ngcontent-%COMP%]{flex-shrink:0!important}.flex-shrink-1[_ngcontent-%COMP%]{flex-shrink:1!important}.flex-wrap[_ngcontent-%COMP%]{flex-wrap:wrap!important}.flex-nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap!important}.flex-wrap-reverse[_ngcontent-%COMP%]{flex-wrap:wrap-reverse!important}.justify-content-start[_ngcontent-%COMP%]{justify-content:flex-start!important}.justify-content-end[_ngcontent-%COMP%]{justify-content:flex-end!important}.justify-content-center[_ngcontent-%COMP%]{justify-content:center!important}.justify-content-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-around[_ngcontent-%COMP%]{justify-content:space-around!important}.justify-content-evenly[_ngcontent-%COMP%]{justify-content:space-evenly!important}.align-items-start[_ngcontent-%COMP%]{align-items:flex-start!important}.align-items-end[_ngcontent-%COMP%]{align-items:flex-end!important}.align-items-center[_ngcontent-%COMP%]{align-items:center!important}.align-items-baseline[_ngcontent-%COMP%]{align-items:baseline!important}.align-items-stretch[_ngcontent-%COMP%]{align-items:stretch!important}.align-content-start[_ngcontent-%COMP%]{align-content:flex-start!important}.align-content-end[_ngcontent-%COMP%]{align-content:flex-end!important}.align-content-center[_ngcontent-%COMP%]{align-content:center!important}.align-content-between[_ngcontent-%COMP%]{align-content:space-between!important}.align-content-around[_ngcontent-%COMP%]{align-content:space-around!important}.align-content-stretch[_ngcontent-%COMP%]{align-content:stretch!important}.align-self-auto[_ngcontent-%COMP%]{align-self:auto!important}.align-self-start[_ngcontent-%COMP%]{align-self:flex-start!important}.align-self-end[_ngcontent-%COMP%]{align-self:flex-end!important}.align-self-center[_ngcontent-%COMP%]{align-self:center!important}.align-self-baseline[_ngcontent-%COMP%]{align-self:baseline!important}.align-self-stretch[_ngcontent-%COMP%]{align-self:stretch!important}.order-first[_ngcontent-%COMP%]{order:-1!important}.order-0[_ngcontent-%COMP%]{order:0!important}.order-1[_ngcontent-%COMP%]{order:1!important}.order-2[_ngcontent-%COMP%]{order:2!important}.order-3[_ngcontent-%COMP%]{order:3!important}.order-4[_ngcontent-%COMP%]{order:4!important}.order-5[_ngcontent-%COMP%]{order:5!important}.order-last[_ngcontent-%COMP%]{order:6!important}.m-0[_ngcontent-%COMP%]{margin:0!important}.m-1[_ngcontent-%COMP%]{margin:.25rem!important}.m-2[_ngcontent-%COMP%]{margin:.5rem!important}.m-3[_ngcontent-%COMP%]{margin:1rem!important}.m-4[_ngcontent-%COMP%]{margin:1.5rem!important}.m-5[_ngcontent-%COMP%]{margin:3rem!important}.m-auto[_ngcontent-%COMP%]{margin:auto!important}.mx-0[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}.mx-1[_ngcontent-%COMP%]{margin-right:.25rem!important;margin-left:.25rem!important}.mx-2[_ngcontent-%COMP%]{margin-right:.5rem!important;margin-left:.5rem!important}.mx-3[_ngcontent-%COMP%]{margin-right:1rem!important;margin-left:1rem!important}.mx-4[_ngcontent-%COMP%]{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-5[_ngcontent-%COMP%]{margin-right:3rem!important;margin-left:3rem!important}.mx-auto[_ngcontent-%COMP%]{margin-right:auto!important;margin-left:auto!important}.my-0[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}.my-1[_ngcontent-%COMP%]{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-2[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-3[_ngcontent-%COMP%]{margin-top:1rem!important;margin-bottom:1rem!important}.my-4[_ngcontent-%COMP%]{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-5[_ngcontent-%COMP%]{margin-top:3rem!important;margin-bottom:3rem!important}.my-auto[_ngcontent-%COMP%]{margin-top:auto!important;margin-bottom:auto!important}.mt-0[_ngcontent-%COMP%]{margin-top:0!important}.mt-1[_ngcontent-%COMP%]{margin-top:.25rem!important}.mt-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}.mt-5[_ngcontent-%COMP%]{margin-top:3rem!important}.mt-auto[_ngcontent-%COMP%]{margin-top:auto!important}.me-0[_ngcontent-%COMP%]{margin-right:0!important}.me-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-3[_ngcontent-%COMP%]{margin-right:1rem!important}.me-4[_ngcontent-%COMP%]{margin-right:1.5rem!important}.me-5[_ngcontent-%COMP%]{margin-right:3rem!important}.me-auto[_ngcontent-%COMP%]{margin-right:auto!important}.mb-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-5[_ngcontent-%COMP%]{margin-bottom:3rem!important}.mb-auto[_ngcontent-%COMP%]{margin-bottom:auto!important}.ms-0[_ngcontent-%COMP%]{margin-left:0!important}.ms-1[_ngcontent-%COMP%]{margin-left:.25rem!important}.ms-2[_ngcontent-%COMP%]{margin-left:.5rem!important}.ms-3[_ngcontent-%COMP%]{margin-left:1rem!important}.ms-4[_ngcontent-%COMP%]{margin-left:1.5rem!important}.ms-5[_ngcontent-%COMP%]{margin-left:3rem!important}.ms-auto[_ngcontent-%COMP%]{margin-left:auto!important}.p-0[_ngcontent-%COMP%]{padding:0!important}.p-1[_ngcontent-%COMP%]{padding:.25rem!important}.p-2[_ngcontent-%COMP%]{padding:.5rem!important}.p-3[_ngcontent-%COMP%]{padding:1rem!important}.p-4[_ngcontent-%COMP%]{padding:1.5rem!important}.p-5[_ngcontent-%COMP%]{padding:3rem!important}.px-0[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.px-1[_ngcontent-%COMP%]{padding-right:.25rem!important;padding-left:.25rem!important}.px-2[_ngcontent-%COMP%]{padding-right:.5rem!important;padding-left:.5rem!important}.px-3[_ngcontent-%COMP%]{padding-right:1rem!important;padding-left:1rem!important}.px-4[_ngcontent-%COMP%]{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-5[_ngcontent-%COMP%]{padding-right:3rem!important;padding-left:3rem!important}.py-0[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.py-1[_ngcontent-%COMP%]{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-2[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-3[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important}.py-4[_ngcontent-%COMP%]{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.pt-0[_ngcontent-%COMP%]{padding-top:0!important}.pt-1[_ngcontent-%COMP%]{padding-top:.25rem!important}.pt-2[_ngcontent-%COMP%]{padding-top:.5rem!important}.pt-3[_ngcontent-%COMP%]{padding-top:1rem!important}.pt-4[_ngcontent-%COMP%]{padding-top:1.5rem!important}.pt-5[_ngcontent-%COMP%]{padding-top:3rem!important}.pe-0[_ngcontent-%COMP%]{padding-right:0!important}.pe-1[_ngcontent-%COMP%]{padding-right:.25rem!important}.pe-2[_ngcontent-%COMP%]{padding-right:.5rem!important}.pe-3[_ngcontent-%COMP%]{padding-right:1rem!important}.pe-4[_ngcontent-%COMP%]{padding-right:1.5rem!important}.pe-5[_ngcontent-%COMP%]{padding-right:3rem!important}.pb-0[_ngcontent-%COMP%]{padding-bottom:0!important}.pb-1[_ngcontent-%COMP%]{padding-bottom:.25rem!important}.pb-2[_ngcontent-%COMP%]{padding-bottom:.5rem!important}.pb-3[_ngcontent-%COMP%]{padding-bottom:1rem!important}.pb-4[_ngcontent-%COMP%]{padding-bottom:1.5rem!important}.pb-5[_ngcontent-%COMP%]{padding-bottom:3rem!important}.ps-0[_ngcontent-%COMP%]{padding-left:0!important}.ps-1[_ngcontent-%COMP%]{padding-left:.25rem!important}.ps-2[_ngcontent-%COMP%]{padding-left:.5rem!important}.ps-3[_ngcontent-%COMP%]{padding-left:1rem!important}.ps-4[_ngcontent-%COMP%]{padding-left:1.5rem!important}.ps-5[_ngcontent-%COMP%]{padding-left:3rem!important}.gap-0[_ngcontent-%COMP%]{gap:0!important}.gap-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-3[_ngcontent-%COMP%]{gap:1rem!important}.gap-4[_ngcontent-%COMP%]{gap:1.5rem!important}.gap-5[_ngcontent-%COMP%]{gap:3rem!important}.row-gap-0[_ngcontent-%COMP%]{row-gap:0!important}.row-gap-1[_ngcontent-%COMP%]{row-gap:.25rem!important}.row-gap-2[_ngcontent-%COMP%]{row-gap:.5rem!important}.row-gap-3[_ngcontent-%COMP%]{row-gap:1rem!important}.row-gap-4[_ngcontent-%COMP%]{row-gap:1.5rem!important}.row-gap-5[_ngcontent-%COMP%]{row-gap:3rem!important}.column-gap-0[_ngcontent-%COMP%]{column-gap:0!important}.column-gap-1[_ngcontent-%COMP%]{column-gap:.25rem!important}.column-gap-2[_ngcontent-%COMP%]{column-gap:.5rem!important}.column-gap-3[_ngcontent-%COMP%]{column-gap:1rem!important}.column-gap-4[_ngcontent-%COMP%]{column-gap:1.5rem!important}.column-gap-5[_ngcontent-%COMP%]{column-gap:3rem!important}.font-monospace[_ngcontent-%COMP%]{font-family:var(--bs-font-monospace)!important}.fs-1[_ngcontent-%COMP%]{font-size:calc(1.375rem + 1.5vw)!important}.fs-2[_ngcontent-%COMP%]{font-size:calc(1.325rem + .9vw)!important}.fs-3[_ngcontent-%COMP%]{font-size:calc(1.3rem + .6vw)!important}.fs-4[_ngcontent-%COMP%]{font-size:calc(1.275rem + .3vw)!important}.fs-5[_ngcontent-%COMP%]{font-size:1.25rem!important}.fs-6[_ngcontent-%COMP%]{font-size:1rem!important}.fst-italic[_ngcontent-%COMP%]{font-style:italic!important}.fst-normal[_ngcontent-%COMP%]{font-style:normal!important}.fw-lighter[_ngcontent-%COMP%]{font-weight:lighter!important}.fw-light[_ngcontent-%COMP%]{font-weight:300!important}.fw-normal[_ngcontent-%COMP%]{font-weight:400!important}.fw-medium[_ngcontent-%COMP%]{font-weight:500!important}.fw-semibold[_ngcontent-%COMP%]{font-weight:600!important}.fw-bold[_ngcontent-%COMP%]{font-weight:700!important}.fw-bolder[_ngcontent-%COMP%]{font-weight:bolder!important}.lh-1[_ngcontent-%COMP%]{line-height:1!important}.lh-sm[_ngcontent-%COMP%]{line-height:1.25!important}.lh-base[_ngcontent-%COMP%]{line-height:1.5!important}.lh-lg[_ngcontent-%COMP%]{line-height:2!important}.text-start[_ngcontent-%COMP%]{text-align:left!important}.text-end[_ngcontent-%COMP%]{text-align:right!important}.text-center[_ngcontent-%COMP%]{text-align:center!important}.text-decoration-none[_ngcontent-%COMP%]{text-decoration:none!important}.text-decoration-underline[_ngcontent-%COMP%]{text-decoration:underline!important}.text-decoration-line-through[_ngcontent-%COMP%]{text-decoration:line-through!important}.text-lowercase[_ngcontent-%COMP%]{text-transform:lowercase!important}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase!important}.text-capitalize[_ngcontent-%COMP%]{text-transform:capitalize!important}.text-wrap[_ngcontent-%COMP%]{white-space:normal!important}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap!important}.text-break[_ngcontent-%COMP%]{word-wrap:break-word!important;word-break:break-word!important}.text-primary[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-primary-rgb),var(--bs-text-opacity))!important}.text-secondary[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-secondary-rgb),var(--bs-text-opacity))!important}.text-success[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-success-rgb),var(--bs-text-opacity))!important}.text-info[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-info-rgb),var(--bs-text-opacity))!important}.text-warning[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-warning-rgb),var(--bs-text-opacity))!important}.text-danger[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-danger-rgb),var(--bs-text-opacity))!important}.text-light[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-light-rgb),var(--bs-text-opacity))!important}.text-dark[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-dark-rgb),var(--bs-text-opacity))!important}.text-black[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-black-rgb),var(--bs-text-opacity))!important}.text-white[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-white-rgb),var(--bs-text-opacity))!important}.text-body[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-body-color-rgb),var(--bs-text-opacity))!important}.text-muted[_ngcontent-%COMP%]{--bs-text-opacity:1;color:var(--bs-secondary-color)!important}.text-black-50[_ngcontent-%COMP%]{--bs-text-opacity:1;color:#00000080!important}.text-white-50[_ngcontent-%COMP%]{--bs-text-opacity:1;color:#ffffff80!important}.text-body-secondary[_ngcontent-%COMP%]{--bs-text-opacity:1;color:var(--bs-secondary-color)!important}.text-body-tertiary[_ngcontent-%COMP%]{--bs-text-opacity:1;color:var(--bs-tertiary-color)!important}.text-body-emphasis[_ngcontent-%COMP%]{--bs-text-opacity:1;color:var(--bs-emphasis-color)!important}.text-reset[_ngcontent-%COMP%]{--bs-text-opacity:1;color:inherit!important}.text-opacity-25[_ngcontent-%COMP%]{--bs-text-opacity:.25}.text-opacity-50[_ngcontent-%COMP%]{--bs-text-opacity:.5}.text-opacity-75[_ngcontent-%COMP%]{--bs-text-opacity:.75}.text-opacity-100[_ngcontent-%COMP%]{--bs-text-opacity:1}.text-primary-emphasis[_ngcontent-%COMP%]{color:var(--bs-primary-text-emphasis)!important}.text-secondary-emphasis[_ngcontent-%COMP%]{color:var(--bs-secondary-text-emphasis)!important}.text-success-emphasis[_ngcontent-%COMP%]{color:var(--bs-success-text-emphasis)!important}.text-info-emphasis[_ngcontent-%COMP%]{color:var(--bs-info-text-emphasis)!important}.text-warning-emphasis[_ngcontent-%COMP%]{color:var(--bs-warning-text-emphasis)!important}.text-danger-emphasis[_ngcontent-%COMP%]{color:var(--bs-danger-text-emphasis)!important}.text-light-emphasis[_ngcontent-%COMP%]{color:var(--bs-light-text-emphasis)!important}.text-dark-emphasis[_ngcontent-%COMP%]{color:var(--bs-dark-text-emphasis)!important}.link-opacity-10[_ngcontent-%COMP%], .link-opacity-10-hover[_ngcontent-%COMP%]:hover{--bs-link-opacity:.1}.link-opacity-25[_ngcontent-%COMP%], .link-opacity-25-hover[_ngcontent-%COMP%]:hover{--bs-link-opacity:.25}.link-opacity-50[_ngcontent-%COMP%], .link-opacity-50-hover[_ngcontent-%COMP%]:hover{--bs-link-opacity:.5}.link-opacity-75[_ngcontent-%COMP%], .link-opacity-75-hover[_ngcontent-%COMP%]:hover{--bs-link-opacity:.75}.link-opacity-100[_ngcontent-%COMP%], .link-opacity-100-hover[_ngcontent-%COMP%]:hover{--bs-link-opacity:1}.link-offset-1[_ngcontent-%COMP%], .link-offset-1-hover[_ngcontent-%COMP%]:hover{text-underline-offset:.125em!important}.link-offset-2[_ngcontent-%COMP%], .link-offset-2-hover[_ngcontent-%COMP%]:hover{text-underline-offset:.25em!important}.link-offset-3[_ngcontent-%COMP%], .link-offset-3-hover[_ngcontent-%COMP%]:hover{text-underline-offset:.375em!important}.link-underline-primary[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-primary-rgb),var(--bs-link-underline-opacity))!important}.link-underline-secondary[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-secondary-rgb),var(--bs-link-underline-opacity))!important}.link-underline-success[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-success-rgb),var(--bs-link-underline-opacity))!important}.link-underline-info[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-info-rgb),var(--bs-link-underline-opacity))!important}.link-underline-warning[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-warning-rgb),var(--bs-link-underline-opacity))!important}.link-underline-danger[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-danger-rgb),var(--bs-link-underline-opacity))!important}.link-underline-light[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-light-rgb),var(--bs-link-underline-opacity))!important}.link-underline-dark[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-dark-rgb),var(--bs-link-underline-opacity))!important}.link-underline[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-link-color-rgb),var(--bs-link-underline-opacity,1))!important}.link-underline-opacity-0[_ngcontent-%COMP%], .link-underline-opacity-0-hover[_ngcontent-%COMP%]:hover{--bs-link-underline-opacity:0}.link-underline-opacity-10[_ngcontent-%COMP%], .link-underline-opacity-10-hover[_ngcontent-%COMP%]:hover{--bs-link-underline-opacity:.1}.link-underline-opacity-25[_ngcontent-%COMP%], .link-underline-opacity-25-hover[_ngcontent-%COMP%]:hover{--bs-link-underline-opacity:.25}.link-underline-opacity-50[_ngcontent-%COMP%], .link-underline-opacity-50-hover[_ngcontent-%COMP%]:hover{--bs-link-underline-opacity:.5}.link-underline-opacity-75[_ngcontent-%COMP%], .link-underline-opacity-75-hover[_ngcontent-%COMP%]:hover{--bs-link-underline-opacity:.75}.link-underline-opacity-100[_ngcontent-%COMP%], .link-underline-opacity-100-hover[_ngcontent-%COMP%]:hover{--bs-link-underline-opacity:1}.bg-primary[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-primary-rgb),var(--bs-bg-opacity))!important}.bg-secondary[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-secondary-rgb),var(--bs-bg-opacity))!important}.bg-success[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-success-rgb),var(--bs-bg-opacity))!important}.bg-info[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-info-rgb),var(--bs-bg-opacity))!important}.bg-warning[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-warning-rgb),var(--bs-bg-opacity))!important}.bg-danger[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-danger-rgb),var(--bs-bg-opacity))!important}.bg-light[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-light-rgb),var(--bs-bg-opacity))!important}.bg-dark[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-dark-rgb),var(--bs-bg-opacity))!important}.bg-black[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-black-rgb),var(--bs-bg-opacity))!important}.bg-white[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-white-rgb),var(--bs-bg-opacity))!important}.bg-body[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-body-bg-rgb),var(--bs-bg-opacity))!important}.bg-transparent[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:transparent!important}.bg-body-secondary[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-secondary-bg-rgb),var(--bs-bg-opacity))!important}.bg-body-tertiary[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-tertiary-bg-rgb),var(--bs-bg-opacity))!important}.bg-opacity-10[_ngcontent-%COMP%]{--bs-bg-opacity:.1}.bg-opacity-25[_ngcontent-%COMP%]{--bs-bg-opacity:.25}.bg-opacity-50[_ngcontent-%COMP%]{--bs-bg-opacity:.5}.bg-opacity-75[_ngcontent-%COMP%]{--bs-bg-opacity:.75}.bg-opacity-100[_ngcontent-%COMP%]{--bs-bg-opacity:1}.bg-primary-subtle[_ngcontent-%COMP%]{background-color:var(--bs-primary-bg-subtle)!important}.bg-secondary-subtle[_ngcontent-%COMP%]{background-color:var(--bs-secondary-bg-subtle)!important}.bg-success-subtle[_ngcontent-%COMP%]{background-color:var(--bs-success-bg-subtle)!important}.bg-info-subtle[_ngcontent-%COMP%]{background-color:var(--bs-info-bg-subtle)!important}.bg-warning-subtle[_ngcontent-%COMP%]{background-color:var(--bs-warning-bg-subtle)!important}.bg-danger-subtle[_ngcontent-%COMP%]{background-color:var(--bs-danger-bg-subtle)!important}.bg-light-subtle[_ngcontent-%COMP%]{background-color:var(--bs-light-bg-subtle)!important}.bg-dark-subtle[_ngcontent-%COMP%]{background-color:var(--bs-dark-bg-subtle)!important}.bg-gradient[_ngcontent-%COMP%]{background-image:var(--bs-gradient)!important}.user-select-all[_ngcontent-%COMP%]{-webkit-user-select:all!important;user-select:all!important}.user-select-auto[_ngcontent-%COMP%]{-webkit-user-select:auto!important;user-select:auto!important}.user-select-none[_ngcontent-%COMP%]{-webkit-user-select:none!important;user-select:none!important}.pe-none[_ngcontent-%COMP%]{pointer-events:none!important}.pe-auto[_ngcontent-%COMP%]{pointer-events:auto!important}.rounded[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius)!important}.rounded-0[_ngcontent-%COMP%]{border-radius:0!important}.rounded-1[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius-sm)!important}.rounded-2[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius)!important}.rounded-3[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius-lg)!important}.rounded-4[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius-xl)!important}.rounded-5[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius-xxl)!important}.rounded-circle[_ngcontent-%COMP%]{border-radius:50%!important}.rounded-pill[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius-pill)!important}.rounded-top[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius)!important;border-top-right-radius:var(--bs-border-radius)!important}.rounded-top-0[_ngcontent-%COMP%]{border-top-left-radius:0!important;border-top-right-radius:0!important}.rounded-top-1[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius-sm)!important;border-top-right-radius:var(--bs-border-radius-sm)!important}.rounded-top-2[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius)!important;border-top-right-radius:var(--bs-border-radius)!important}.rounded-top-3[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius-lg)!important;border-top-right-radius:var(--bs-border-radius-lg)!important}.rounded-top-4[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius-xl)!important;border-top-right-radius:var(--bs-border-radius-xl)!important}.rounded-top-5[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius-xxl)!important;border-top-right-radius:var(--bs-border-radius-xxl)!important}.rounded-top-circle[_ngcontent-%COMP%]{border-top-left-radius:50%!important;border-top-right-radius:50%!important}.rounded-top-pill[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius-pill)!important;border-top-right-radius:var(--bs-border-radius-pill)!important}.rounded-end[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius)!important;border-bottom-right-radius:var(--bs-border-radius)!important}.rounded-end-0[_ngcontent-%COMP%]{border-top-right-radius:0!important;border-bottom-right-radius:0!important}.rounded-end-1[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius-sm)!important;border-bottom-right-radius:var(--bs-border-radius-sm)!important}.rounded-end-2[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius)!important;border-bottom-right-radius:var(--bs-border-radius)!important}.rounded-end-3[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius-lg)!important;border-bottom-right-radius:var(--bs-border-radius-lg)!important}.rounded-end-4[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius-xl)!important;border-bottom-right-radius:var(--bs-border-radius-xl)!important}.rounded-end-5[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius-xxl)!important;border-bottom-right-radius:var(--bs-border-radius-xxl)!important}.rounded-end-circle[_ngcontent-%COMP%]{border-top-right-radius:50%!important;border-bottom-right-radius:50%!important}.rounded-end-pill[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius-pill)!important;border-bottom-right-radius:var(--bs-border-radius-pill)!important}.rounded-bottom[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius)!important;border-bottom-left-radius:var(--bs-border-radius)!important}.rounded-bottom-0[_ngcontent-%COMP%]{border-bottom-right-radius:0!important;border-bottom-left-radius:0!important}.rounded-bottom-1[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius-sm)!important;border-bottom-left-radius:var(--bs-border-radius-sm)!important}.rounded-bottom-2[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius)!important;border-bottom-left-radius:var(--bs-border-radius)!important}.rounded-bottom-3[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius-lg)!important;border-bottom-left-radius:var(--bs-border-radius-lg)!important}.rounded-bottom-4[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius-xl)!important;border-bottom-left-radius:var(--bs-border-radius-xl)!important}.rounded-bottom-5[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius-xxl)!important;border-bottom-left-radius:var(--bs-border-radius-xxl)!important}.rounded-bottom-circle[_ngcontent-%COMP%]{border-bottom-right-radius:50%!important;border-bottom-left-radius:50%!important}.rounded-bottom-pill[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius-pill)!important;border-bottom-left-radius:var(--bs-border-radius-pill)!important}.rounded-start[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius)!important;border-top-left-radius:var(--bs-border-radius)!important}.rounded-start-0[_ngcontent-%COMP%]{border-bottom-left-radius:0!important;border-top-left-radius:0!important}.rounded-start-1[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius-sm)!important;border-top-left-radius:var(--bs-border-radius-sm)!important}.rounded-start-2[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius)!important;border-top-left-radius:var(--bs-border-radius)!important}.rounded-start-3[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius-lg)!important;border-top-left-radius:var(--bs-border-radius-lg)!important}.rounded-start-4[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius-xl)!important;border-top-left-radius:var(--bs-border-radius-xl)!important}.rounded-start-5[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius-xxl)!important;border-top-left-radius:var(--bs-border-radius-xxl)!important}.rounded-start-circle[_ngcontent-%COMP%]{border-bottom-left-radius:50%!important;border-top-left-radius:50%!important}.rounded-start-pill[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius-pill)!important;border-top-left-radius:var(--bs-border-radius-pill)!important}.visible[_ngcontent-%COMP%]{visibility:visible!important}.invisible[_ngcontent-%COMP%]{visibility:hidden!important}.z-n1[_ngcontent-%COMP%]{z-index:-1!important}.z-0[_ngcontent-%COMP%]{z-index:0!important}.z-1[_ngcontent-%COMP%]{z-index:1!important}.z-2[_ngcontent-%COMP%]{z-index:2!important}.z-3[_ngcontent-%COMP%]{z-index:3!important}@media (min-width:576px){.float-sm-start[_ngcontent-%COMP%]{float:left!important}.float-sm-end[_ngcontent-%COMP%]{float:right!important}.float-sm-none[_ngcontent-%COMP%]{float:none!important}.object-fit-sm-contain[_ngcontent-%COMP%]{object-fit:contain!important}.object-fit-sm-cover[_ngcontent-%COMP%]{object-fit:cover!important}.object-fit-sm-fill[_ngcontent-%COMP%]{object-fit:fill!important}.object-fit-sm-scale[_ngcontent-%COMP%]{object-fit:scale-down!important}.object-fit-sm-none[_ngcontent-%COMP%]{object-fit:none!important}.d-sm-inline[_ngcontent-%COMP%]{display:inline!important}.d-sm-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-sm-block[_ngcontent-%COMP%]{display:block!important}.d-sm-grid[_ngcontent-%COMP%]{display:grid!important}.d-sm-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-sm-table[_ngcontent-%COMP%]{display:table!important}.d-sm-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-sm-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-sm-flex[_ngcontent-%COMP%]{display:flex!important}.d-sm-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-sm-none[_ngcontent-%COMP%]{display:none!important}.flex-sm-fill[_ngcontent-%COMP%]{flex:1 1 auto!important}.flex-sm-row[_ngcontent-%COMP%]{flex-direction:row!important}.flex-sm-column[_ngcontent-%COMP%]{flex-direction:column!important}.flex-sm-row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse!important}.flex-sm-column-reverse[_ngcontent-%COMP%]{flex-direction:column-reverse!important}.flex-sm-grow-0[_ngcontent-%COMP%]{flex-grow:0!important}.flex-sm-grow-1[_ngcontent-%COMP%]{flex-grow:1!important}.flex-sm-shrink-0[_ngcontent-%COMP%]{flex-shrink:0!important}.flex-sm-shrink-1[_ngcontent-%COMP%]{flex-shrink:1!important}.flex-sm-wrap[_ngcontent-%COMP%]{flex-wrap:wrap!important}.flex-sm-nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap!important}.flex-sm-wrap-reverse[_ngcontent-%COMP%]{flex-wrap:wrap-reverse!important}.justify-content-sm-start[_ngcontent-%COMP%]{justify-content:flex-start!important}.justify-content-sm-end[_ngcontent-%COMP%]{justify-content:flex-end!important}.justify-content-sm-center[_ngcontent-%COMP%]{justify-content:center!important}.justify-content-sm-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-sm-around[_ngcontent-%COMP%]{justify-content:space-around!important}.justify-content-sm-evenly[_ngcontent-%COMP%]{justify-content:space-evenly!important}.align-items-sm-start[_ngcontent-%COMP%]{align-items:flex-start!important}.align-items-sm-end[_ngcontent-%COMP%]{align-items:flex-end!important}.align-items-sm-center[_ngcontent-%COMP%]{align-items:center!important}.align-items-sm-baseline[_ngcontent-%COMP%]{align-items:baseline!important}.align-items-sm-stretch[_ngcontent-%COMP%]{align-items:stretch!important}.align-content-sm-start[_ngcontent-%COMP%]{align-content:flex-start!important}.align-content-sm-end[_ngcontent-%COMP%]{align-content:flex-end!important}.align-content-sm-center[_ngcontent-%COMP%]{align-content:center!important}.align-content-sm-between[_ngcontent-%COMP%]{align-content:space-between!important}.align-content-sm-around[_ngcontent-%COMP%]{align-content:space-around!important}.align-content-sm-stretch[_ngcontent-%COMP%]{align-content:stretch!important}.align-self-sm-auto[_ngcontent-%COMP%]{align-self:auto!important}.align-self-sm-start[_ngcontent-%COMP%]{align-self:flex-start!important}.align-self-sm-end[_ngcontent-%COMP%]{align-self:flex-end!important}.align-self-sm-center[_ngcontent-%COMP%]{align-self:center!important}.align-self-sm-baseline[_ngcontent-%COMP%]{align-self:baseline!important}.align-self-sm-stretch[_ngcontent-%COMP%]{align-self:stretch!important}.order-sm-first[_ngcontent-%COMP%]{order:-1!important}.order-sm-0[_ngcontent-%COMP%]{order:0!important}.order-sm-1[_ngcontent-%COMP%]{order:1!important}.order-sm-2[_ngcontent-%COMP%]{order:2!important}.order-sm-3[_ngcontent-%COMP%]{order:3!important}.order-sm-4[_ngcontent-%COMP%]{order:4!important}.order-sm-5[_ngcontent-%COMP%]{order:5!important}.order-sm-last[_ngcontent-%COMP%]{order:6!important}.m-sm-0[_ngcontent-%COMP%]{margin:0!important}.m-sm-1[_ngcontent-%COMP%]{margin:.25rem!important}.m-sm-2[_ngcontent-%COMP%]{margin:.5rem!important}.m-sm-3[_ngcontent-%COMP%]{margin:1rem!important}.m-sm-4[_ngcontent-%COMP%]{margin:1.5rem!important}.m-sm-5[_ngcontent-%COMP%]{margin:3rem!important}.m-sm-auto[_ngcontent-%COMP%]{margin:auto!important}.mx-sm-0[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}.mx-sm-1[_ngcontent-%COMP%]{margin-right:.25rem!important;margin-left:.25rem!important}.mx-sm-2[_ngcontent-%COMP%]{margin-right:.5rem!important;margin-left:.5rem!important}.mx-sm-3[_ngcontent-%COMP%]{margin-right:1rem!important;margin-left:1rem!important}.mx-sm-4[_ngcontent-%COMP%]{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-sm-5[_ngcontent-%COMP%]{margin-right:3rem!important;margin-left:3rem!important}.mx-sm-auto[_ngcontent-%COMP%]{margin-right:auto!important;margin-left:auto!important}.my-sm-0[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}.my-sm-1[_ngcontent-%COMP%]{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-sm-2[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-sm-3[_ngcontent-%COMP%]{margin-top:1rem!important;margin-bottom:1rem!important}.my-sm-4[_ngcontent-%COMP%]{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-sm-5[_ngcontent-%COMP%]{margin-top:3rem!important;margin-bottom:3rem!important}.my-sm-auto[_ngcontent-%COMP%]{margin-top:auto!important;margin-bottom:auto!important}.mt-sm-0[_ngcontent-%COMP%]{margin-top:0!important}.mt-sm-1[_ngcontent-%COMP%]{margin-top:.25rem!important}.mt-sm-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-sm-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-sm-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}.mt-sm-5[_ngcontent-%COMP%]{margin-top:3rem!important}.mt-sm-auto[_ngcontent-%COMP%]{margin-top:auto!important}.me-sm-0[_ngcontent-%COMP%]{margin-right:0!important}.me-sm-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-sm-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-sm-3[_ngcontent-%COMP%]{margin-right:1rem!important}.me-sm-4[_ngcontent-%COMP%]{margin-right:1.5rem!important}.me-sm-5[_ngcontent-%COMP%]{margin-right:3rem!important}.me-sm-auto[_ngcontent-%COMP%]{margin-right:auto!important}.mb-sm-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-sm-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-sm-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-sm-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-sm-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-sm-5[_ngcontent-%COMP%]{margin-bottom:3rem!important}.mb-sm-auto[_ngcontent-%COMP%]{margin-bottom:auto!important}.ms-sm-0[_ngcontent-%COMP%]{margin-left:0!important}.ms-sm-1[_ngcontent-%COMP%]{margin-left:.25rem!important}.ms-sm-2[_ngcontent-%COMP%]{margin-left:.5rem!important}.ms-sm-3[_ngcontent-%COMP%]{margin-left:1rem!important}.ms-sm-4[_ngcontent-%COMP%]{margin-left:1.5rem!important}.ms-sm-5[_ngcontent-%COMP%]{margin-left:3rem!important}.ms-sm-auto[_ngcontent-%COMP%]{margin-left:auto!important}.p-sm-0[_ngcontent-%COMP%]{padding:0!important}.p-sm-1[_ngcontent-%COMP%]{padding:.25rem!important}.p-sm-2[_ngcontent-%COMP%]{padding:.5rem!important}.p-sm-3[_ngcontent-%COMP%]{padding:1rem!important}.p-sm-4[_ngcontent-%COMP%]{padding:1.5rem!important}.p-sm-5[_ngcontent-%COMP%]{padding:3rem!important}.px-sm-0[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.px-sm-1[_ngcontent-%COMP%]{padding-right:.25rem!important;padding-left:.25rem!important}.px-sm-2[_ngcontent-%COMP%]{padding-right:.5rem!important;padding-left:.5rem!important}.px-sm-3[_ngcontent-%COMP%]{padding-right:1rem!important;padding-left:1rem!important}.px-sm-4[_ngcontent-%COMP%]{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-sm-5[_ngcontent-%COMP%]{padding-right:3rem!important;padding-left:3rem!important}.py-sm-0[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.py-sm-1[_ngcontent-%COMP%]{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-sm-2[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-sm-3[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important}.py-sm-4[_ngcontent-%COMP%]{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-sm-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.pt-sm-0[_ngcontent-%COMP%]{padding-top:0!important}.pt-sm-1[_ngcontent-%COMP%]{padding-top:.25rem!important}.pt-sm-2[_ngcontent-%COMP%]{padding-top:.5rem!important}.pt-sm-3[_ngcontent-%COMP%]{padding-top:1rem!important}.pt-sm-4[_ngcontent-%COMP%]{padding-top:1.5rem!important}.pt-sm-5[_ngcontent-%COMP%]{padding-top:3rem!important}.pe-sm-0[_ngcontent-%COMP%]{padding-right:0!important}.pe-sm-1[_ngcontent-%COMP%]{padding-right:.25rem!important}.pe-sm-2[_ngcontent-%COMP%]{padding-right:.5rem!important}.pe-sm-3[_ngcontent-%COMP%]{padding-right:1rem!important}.pe-sm-4[_ngcontent-%COMP%]{padding-right:1.5rem!important}.pe-sm-5[_ngcontent-%COMP%]{padding-right:3rem!important}.pb-sm-0[_ngcontent-%COMP%]{padding-bottom:0!important}.pb-sm-1[_ngcontent-%COMP%]{padding-bottom:.25rem!important}.pb-sm-2[_ngcontent-%COMP%]{padding-bottom:.5rem!important}.pb-sm-3[_ngcontent-%COMP%]{padding-bottom:1rem!important}.pb-sm-4[_ngcontent-%COMP%]{padding-bottom:1.5rem!important}.pb-sm-5[_ngcontent-%COMP%]{padding-bottom:3rem!important}.ps-sm-0[_ngcontent-%COMP%]{padding-left:0!important}.ps-sm-1[_ngcontent-%COMP%]{padding-left:.25rem!important}.ps-sm-2[_ngcontent-%COMP%]{padding-left:.5rem!important}.ps-sm-3[_ngcontent-%COMP%]{padding-left:1rem!important}.ps-sm-4[_ngcontent-%COMP%]{padding-left:1.5rem!important}.ps-sm-5[_ngcontent-%COMP%]{padding-left:3rem!important}.gap-sm-0[_ngcontent-%COMP%]{gap:0!important}.gap-sm-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-sm-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-sm-3[_ngcontent-%COMP%]{gap:1rem!important}.gap-sm-4[_ngcontent-%COMP%]{gap:1.5rem!important}.gap-sm-5[_ngcontent-%COMP%]{gap:3rem!important}.row-gap-sm-0[_ngcontent-%COMP%]{row-gap:0!important}.row-gap-sm-1[_ngcontent-%COMP%]{row-gap:.25rem!important}.row-gap-sm-2[_ngcontent-%COMP%]{row-gap:.5rem!important}.row-gap-sm-3[_ngcontent-%COMP%]{row-gap:1rem!important}.row-gap-sm-4[_ngcontent-%COMP%]{row-gap:1.5rem!important}.row-gap-sm-5[_ngcontent-%COMP%]{row-gap:3rem!important}.column-gap-sm-0[_ngcontent-%COMP%]{column-gap:0!important}.column-gap-sm-1[_ngcontent-%COMP%]{column-gap:.25rem!important}.column-gap-sm-2[_ngcontent-%COMP%]{column-gap:.5rem!important}.column-gap-sm-3[_ngcontent-%COMP%]{column-gap:1rem!important}.column-gap-sm-4[_ngcontent-%COMP%]{column-gap:1.5rem!important}.column-gap-sm-5[_ngcontent-%COMP%]{column-gap:3rem!important}.text-sm-start[_ngcontent-%COMP%]{text-align:left!important}.text-sm-end[_ngcontent-%COMP%]{text-align:right!important}.text-sm-center[_ngcontent-%COMP%]{text-align:center!important}}@media (min-width:768px){.float-md-start[_ngcontent-%COMP%]{float:left!important}.float-md-end[_ngcontent-%COMP%]{float:right!important}.float-md-none[_ngcontent-%COMP%]{float:none!important}.object-fit-md-contain[_ngcontent-%COMP%]{object-fit:contain!important}.object-fit-md-cover[_ngcontent-%COMP%]{object-fit:cover!important}.object-fit-md-fill[_ngcontent-%COMP%]{object-fit:fill!important}.object-fit-md-scale[_ngcontent-%COMP%]{object-fit:scale-down!important}.object-fit-md-none[_ngcontent-%COMP%]{object-fit:none!important}.d-md-inline[_ngcontent-%COMP%]{display:inline!important}.d-md-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-md-block[_ngcontent-%COMP%]{display:block!important}.d-md-grid[_ngcontent-%COMP%]{display:grid!important}.d-md-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-md-table[_ngcontent-%COMP%]{display:table!important}.d-md-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-md-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-md-flex[_ngcontent-%COMP%]{display:flex!important}.d-md-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-md-none[_ngcontent-%COMP%]{display:none!important}.flex-md-fill[_ngcontent-%COMP%]{flex:1 1 auto!important}.flex-md-row[_ngcontent-%COMP%]{flex-direction:row!important}.flex-md-column[_ngcontent-%COMP%]{flex-direction:column!important}.flex-md-row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse!important}.flex-md-column-reverse[_ngcontent-%COMP%]{flex-direction:column-reverse!important}.flex-md-grow-0[_ngcontent-%COMP%]{flex-grow:0!important}.flex-md-grow-1[_ngcontent-%COMP%]{flex-grow:1!important}.flex-md-shrink-0[_ngcontent-%COMP%]{flex-shrink:0!important}.flex-md-shrink-1[_ngcontent-%COMP%]{flex-shrink:1!important}.flex-md-wrap[_ngcontent-%COMP%]{flex-wrap:wrap!important}.flex-md-nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap!important}.flex-md-wrap-reverse[_ngcontent-%COMP%]{flex-wrap:wrap-reverse!important}.justify-content-md-start[_ngcontent-%COMP%]{justify-content:flex-start!important}.justify-content-md-end[_ngcontent-%COMP%]{justify-content:flex-end!important}.justify-content-md-center[_ngcontent-%COMP%]{justify-content:center!important}.justify-content-md-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-md-around[_ngcontent-%COMP%]{justify-content:space-around!important}.justify-content-md-evenly[_ngcontent-%COMP%]{justify-content:space-evenly!important}.align-items-md-start[_ngcontent-%COMP%]{align-items:flex-start!important}.align-items-md-end[_ngcontent-%COMP%]{align-items:flex-end!important}.align-items-md-center[_ngcontent-%COMP%]{align-items:center!important}.align-items-md-baseline[_ngcontent-%COMP%]{align-items:baseline!important}.align-items-md-stretch[_ngcontent-%COMP%]{align-items:stretch!important}.align-content-md-start[_ngcontent-%COMP%]{align-content:flex-start!important}.align-content-md-end[_ngcontent-%COMP%]{align-content:flex-end!important}.align-content-md-center[_ngcontent-%COMP%]{align-content:center!important}.align-content-md-between[_ngcontent-%COMP%]{align-content:space-between!important}.align-content-md-around[_ngcontent-%COMP%]{align-content:space-around!important}.align-content-md-stretch[_ngcontent-%COMP%]{align-content:stretch!important}.align-self-md-auto[_ngcontent-%COMP%]{align-self:auto!important}.align-self-md-start[_ngcontent-%COMP%]{align-self:flex-start!important}.align-self-md-end[_ngcontent-%COMP%]{align-self:flex-end!important}.align-self-md-center[_ngcontent-%COMP%]{align-self:center!important}.align-self-md-baseline[_ngcontent-%COMP%]{align-self:baseline!important}.align-self-md-stretch[_ngcontent-%COMP%]{align-self:stretch!important}.order-md-first[_ngcontent-%COMP%]{order:-1!important}.order-md-0[_ngcontent-%COMP%]{order:0!important}.order-md-1[_ngcontent-%COMP%]{order:1!important}.order-md-2[_ngcontent-%COMP%]{order:2!important}.order-md-3[_ngcontent-%COMP%]{order:3!important}.order-md-4[_ngcontent-%COMP%]{order:4!important}.order-md-5[_ngcontent-%COMP%]{order:5!important}.order-md-last[_ngcontent-%COMP%]{order:6!important}.m-md-0[_ngcontent-%COMP%]{margin:0!important}.m-md-1[_ngcontent-%COMP%]{margin:.25rem!important}.m-md-2[_ngcontent-%COMP%]{margin:.5rem!important}.m-md-3[_ngcontent-%COMP%]{margin:1rem!important}.m-md-4[_ngcontent-%COMP%]{margin:1.5rem!important}.m-md-5[_ngcontent-%COMP%]{margin:3rem!important}.m-md-auto[_ngcontent-%COMP%]{margin:auto!important}.mx-md-0[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}.mx-md-1[_ngcontent-%COMP%]{margin-right:.25rem!important;margin-left:.25rem!important}.mx-md-2[_ngcontent-%COMP%]{margin-right:.5rem!important;margin-left:.5rem!important}.mx-md-3[_ngcontent-%COMP%]{margin-right:1rem!important;margin-left:1rem!important}.mx-md-4[_ngcontent-%COMP%]{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-md-5[_ngcontent-%COMP%]{margin-right:3rem!important;margin-left:3rem!important}.mx-md-auto[_ngcontent-%COMP%]{margin-right:auto!important;margin-left:auto!important}.my-md-0[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}.my-md-1[_ngcontent-%COMP%]{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-md-2[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-md-3[_ngcontent-%COMP%]{margin-top:1rem!important;margin-bottom:1rem!important}.my-md-4[_ngcontent-%COMP%]{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-md-5[_ngcontent-%COMP%]{margin-top:3rem!important;margin-bottom:3rem!important}.my-md-auto[_ngcontent-%COMP%]{margin-top:auto!important;margin-bottom:auto!important}.mt-md-0[_ngcontent-%COMP%]{margin-top:0!important}.mt-md-1[_ngcontent-%COMP%]{margin-top:.25rem!important}.mt-md-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-md-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-md-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}.mt-md-5[_ngcontent-%COMP%]{margin-top:3rem!important}.mt-md-auto[_ngcontent-%COMP%]{margin-top:auto!important}.me-md-0[_ngcontent-%COMP%]{margin-right:0!important}.me-md-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-md-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-md-3[_ngcontent-%COMP%]{margin-right:1rem!important}.me-md-4[_ngcontent-%COMP%]{margin-right:1.5rem!important}.me-md-5[_ngcontent-%COMP%]{margin-right:3rem!important}.me-md-auto[_ngcontent-%COMP%]{margin-right:auto!important}.mb-md-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-md-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-md-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-md-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-md-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-md-5[_ngcontent-%COMP%]{margin-bottom:3rem!important}.mb-md-auto[_ngcontent-%COMP%]{margin-bottom:auto!important}.ms-md-0[_ngcontent-%COMP%]{margin-left:0!important}.ms-md-1[_ngcontent-%COMP%]{margin-left:.25rem!important}.ms-md-2[_ngcontent-%COMP%]{margin-left:.5rem!important}.ms-md-3[_ngcontent-%COMP%]{margin-left:1rem!important}.ms-md-4[_ngcontent-%COMP%]{margin-left:1.5rem!important}.ms-md-5[_ngcontent-%COMP%]{margin-left:3rem!important}.ms-md-auto[_ngcontent-%COMP%]{margin-left:auto!important}.p-md-0[_ngcontent-%COMP%]{padding:0!important}.p-md-1[_ngcontent-%COMP%]{padding:.25rem!important}.p-md-2[_ngcontent-%COMP%]{padding:.5rem!important}.p-md-3[_ngcontent-%COMP%]{padding:1rem!important}.p-md-4[_ngcontent-%COMP%]{padding:1.5rem!important}.p-md-5[_ngcontent-%COMP%]{padding:3rem!important}.px-md-0[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.px-md-1[_ngcontent-%COMP%]{padding-right:.25rem!important;padding-left:.25rem!important}.px-md-2[_ngcontent-%COMP%]{padding-right:.5rem!important;padding-left:.5rem!important}.px-md-3[_ngcontent-%COMP%]{padding-right:1rem!important;padding-left:1rem!important}.px-md-4[_ngcontent-%COMP%]{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-md-5[_ngcontent-%COMP%]{padding-right:3rem!important;padding-left:3rem!important}.py-md-0[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.py-md-1[_ngcontent-%COMP%]{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-md-2[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-md-3[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important}.py-md-4[_ngcontent-%COMP%]{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-md-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.pt-md-0[_ngcontent-%COMP%]{padding-top:0!important}.pt-md-1[_ngcontent-%COMP%]{padding-top:.25rem!important}.pt-md-2[_ngcontent-%COMP%]{padding-top:.5rem!important}.pt-md-3[_ngcontent-%COMP%]{padding-top:1rem!important}.pt-md-4[_ngcontent-%COMP%]{padding-top:1.5rem!important}.pt-md-5[_ngcontent-%COMP%]{padding-top:3rem!important}.pe-md-0[_ngcontent-%COMP%]{padding-right:0!important}.pe-md-1[_ngcontent-%COMP%]{padding-right:.25rem!important}.pe-md-2[_ngcontent-%COMP%]{padding-right:.5rem!important}.pe-md-3[_ngcontent-%COMP%]{padding-right:1rem!important}.pe-md-4[_ngcontent-%COMP%]{padding-right:1.5rem!important}.pe-md-5[_ngcontent-%COMP%]{padding-right:3rem!important}.pb-md-0[_ngcontent-%COMP%]{padding-bottom:0!important}.pb-md-1[_ngcontent-%COMP%]{padding-bottom:.25rem!important}.pb-md-2[_ngcontent-%COMP%]{padding-bottom:.5rem!important}.pb-md-3[_ngcontent-%COMP%]{padding-bottom:1rem!important}.pb-md-4[_ngcontent-%COMP%]{padding-bottom:1.5rem!important}.pb-md-5[_ngcontent-%COMP%]{padding-bottom:3rem!important}.ps-md-0[_ngcontent-%COMP%]{padding-left:0!important}.ps-md-1[_ngcontent-%COMP%]{padding-left:.25rem!important}.ps-md-2[_ngcontent-%COMP%]{padding-left:.5rem!important}.ps-md-3[_ngcontent-%COMP%]{padding-left:1rem!important}.ps-md-4[_ngcontent-%COMP%]{padding-left:1.5rem!important}.ps-md-5[_ngcontent-%COMP%]{padding-left:3rem!important}.gap-md-0[_ngcontent-%COMP%]{gap:0!important}.gap-md-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-md-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-md-3[_ngcontent-%COMP%]{gap:1rem!important}.gap-md-4[_ngcontent-%COMP%]{gap:1.5rem!important}.gap-md-5[_ngcontent-%COMP%]{gap:3rem!important}.row-gap-md-0[_ngcontent-%COMP%]{row-gap:0!important}.row-gap-md-1[_ngcontent-%COMP%]{row-gap:.25rem!important}.row-gap-md-2[_ngcontent-%COMP%]{row-gap:.5rem!important}.row-gap-md-3[_ngcontent-%COMP%]{row-gap:1rem!important}.row-gap-md-4[_ngcontent-%COMP%]{row-gap:1.5rem!important}.row-gap-md-5[_ngcontent-%COMP%]{row-gap:3rem!important}.column-gap-md-0[_ngcontent-%COMP%]{column-gap:0!important}.column-gap-md-1[_ngcontent-%COMP%]{column-gap:.25rem!important}.column-gap-md-2[_ngcontent-%COMP%]{column-gap:.5rem!important}.column-gap-md-3[_ngcontent-%COMP%]{column-gap:1rem!important}.column-gap-md-4[_ngcontent-%COMP%]{column-gap:1.5rem!important}.column-gap-md-5[_ngcontent-%COMP%]{column-gap:3rem!important}.text-md-start[_ngcontent-%COMP%]{text-align:left!important}.text-md-end[_ngcontent-%COMP%]{text-align:right!important}.text-md-center[_ngcontent-%COMP%]{text-align:center!important}}@media (min-width:992px){.float-lg-start[_ngcontent-%COMP%]{float:left!important}.float-lg-end[_ngcontent-%COMP%]{float:right!important}.float-lg-none[_ngcontent-%COMP%]{float:none!important}.object-fit-lg-contain[_ngcontent-%COMP%]{object-fit:contain!important}.object-fit-lg-cover[_ngcontent-%COMP%]{object-fit:cover!important}.object-fit-lg-fill[_ngcontent-%COMP%]{object-fit:fill!important}.object-fit-lg-scale[_ngcontent-%COMP%]{object-fit:scale-down!important}.object-fit-lg-none[_ngcontent-%COMP%]{object-fit:none!important}.d-lg-inline[_ngcontent-%COMP%]{display:inline!important}.d-lg-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-lg-block[_ngcontent-%COMP%]{display:block!important}.d-lg-grid[_ngcontent-%COMP%]{display:grid!important}.d-lg-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-lg-table[_ngcontent-%COMP%]{display:table!important}.d-lg-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-lg-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-lg-flex[_ngcontent-%COMP%]{display:flex!important}.d-lg-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-lg-none[_ngcontent-%COMP%]{display:none!important}.flex-lg-fill[_ngcontent-%COMP%]{flex:1 1 auto!important}.flex-lg-row[_ngcontent-%COMP%]{flex-direction:row!important}.flex-lg-column[_ngcontent-%COMP%]{flex-direction:column!important}.flex-lg-row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse!important}.flex-lg-column-reverse[_ngcontent-%COMP%]{flex-direction:column-reverse!important}.flex-lg-grow-0[_ngcontent-%COMP%]{flex-grow:0!important}.flex-lg-grow-1[_ngcontent-%COMP%]{flex-grow:1!important}.flex-lg-shrink-0[_ngcontent-%COMP%]{flex-shrink:0!important}.flex-lg-shrink-1[_ngcontent-%COMP%]{flex-shrink:1!important}.flex-lg-wrap[_ngcontent-%COMP%]{flex-wrap:wrap!important}.flex-lg-nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap!important}.flex-lg-wrap-reverse[_ngcontent-%COMP%]{flex-wrap:wrap-reverse!important}.justify-content-lg-start[_ngcontent-%COMP%]{justify-content:flex-start!important}.justify-content-lg-end[_ngcontent-%COMP%]{justify-content:flex-end!important}.justify-content-lg-center[_ngcontent-%COMP%]{justify-content:center!important}.justify-content-lg-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-lg-around[_ngcontent-%COMP%]{justify-content:space-around!important}.justify-content-lg-evenly[_ngcontent-%COMP%]{justify-content:space-evenly!important}.align-items-lg-start[_ngcontent-%COMP%]{align-items:flex-start!important}.align-items-lg-end[_ngcontent-%COMP%]{align-items:flex-end!important}.align-items-lg-center[_ngcontent-%COMP%]{align-items:center!important}.align-items-lg-baseline[_ngcontent-%COMP%]{align-items:baseline!important}.align-items-lg-stretch[_ngcontent-%COMP%]{align-items:stretch!important}.align-content-lg-start[_ngcontent-%COMP%]{align-content:flex-start!important}.align-content-lg-end[_ngcontent-%COMP%]{align-content:flex-end!important}.align-content-lg-center[_ngcontent-%COMP%]{align-content:center!important}.align-content-lg-between[_ngcontent-%COMP%]{align-content:space-between!important}.align-content-lg-around[_ngcontent-%COMP%]{align-content:space-around!important}.align-content-lg-stretch[_ngcontent-%COMP%]{align-content:stretch!important}.align-self-lg-auto[_ngcontent-%COMP%]{align-self:auto!important}.align-self-lg-start[_ngcontent-%COMP%]{align-self:flex-start!important}.align-self-lg-end[_ngcontent-%COMP%]{align-self:flex-end!important}.align-self-lg-center[_ngcontent-%COMP%]{align-self:center!important}.align-self-lg-baseline[_ngcontent-%COMP%]{align-self:baseline!important}.align-self-lg-stretch[_ngcontent-%COMP%]{align-self:stretch!important}.order-lg-first[_ngcontent-%COMP%]{order:-1!important}.order-lg-0[_ngcontent-%COMP%]{order:0!important}.order-lg-1[_ngcontent-%COMP%]{order:1!important}.order-lg-2[_ngcontent-%COMP%]{order:2!important}.order-lg-3[_ngcontent-%COMP%]{order:3!important}.order-lg-4[_ngcontent-%COMP%]{order:4!important}.order-lg-5[_ngcontent-%COMP%]{order:5!important}.order-lg-last[_ngcontent-%COMP%]{order:6!important}.m-lg-0[_ngcontent-%COMP%]{margin:0!important}.m-lg-1[_ngcontent-%COMP%]{margin:.25rem!important}.m-lg-2[_ngcontent-%COMP%]{margin:.5rem!important}.m-lg-3[_ngcontent-%COMP%]{margin:1rem!important}.m-lg-4[_ngcontent-%COMP%]{margin:1.5rem!important}.m-lg-5[_ngcontent-%COMP%]{margin:3rem!important}.m-lg-auto[_ngcontent-%COMP%]{margin:auto!important}.mx-lg-0[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}.mx-lg-1[_ngcontent-%COMP%]{margin-right:.25rem!important;margin-left:.25rem!important}.mx-lg-2[_ngcontent-%COMP%]{margin-right:.5rem!important;margin-left:.5rem!important}.mx-lg-3[_ngcontent-%COMP%]{margin-right:1rem!important;margin-left:1rem!important}.mx-lg-4[_ngcontent-%COMP%]{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-lg-5[_ngcontent-%COMP%]{margin-right:3rem!important;margin-left:3rem!important}.mx-lg-auto[_ngcontent-%COMP%]{margin-right:auto!important;margin-left:auto!important}.my-lg-0[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}.my-lg-1[_ngcontent-%COMP%]{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-lg-2[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-lg-3[_ngcontent-%COMP%]{margin-top:1rem!important;margin-bottom:1rem!important}.my-lg-4[_ngcontent-%COMP%]{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-lg-5[_ngcontent-%COMP%]{margin-top:3rem!important;margin-bottom:3rem!important}.my-lg-auto[_ngcontent-%COMP%]{margin-top:auto!important;margin-bottom:auto!important}.mt-lg-0[_ngcontent-%COMP%]{margin-top:0!important}.mt-lg-1[_ngcontent-%COMP%]{margin-top:.25rem!important}.mt-lg-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-lg-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-lg-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}.mt-lg-5[_ngcontent-%COMP%]{margin-top:3rem!important}.mt-lg-auto[_ngcontent-%COMP%]{margin-top:auto!important}.me-lg-0[_ngcontent-%COMP%]{margin-right:0!important}.me-lg-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-lg-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-lg-3[_ngcontent-%COMP%]{margin-right:1rem!important}.me-lg-4[_ngcontent-%COMP%]{margin-right:1.5rem!important}.me-lg-5[_ngcontent-%COMP%]{margin-right:3rem!important}.me-lg-auto[_ngcontent-%COMP%]{margin-right:auto!important}.mb-lg-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-lg-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-lg-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-lg-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-lg-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-lg-5[_ngcontent-%COMP%]{margin-bottom:3rem!important}.mb-lg-auto[_ngcontent-%COMP%]{margin-bottom:auto!important}.ms-lg-0[_ngcontent-%COMP%]{margin-left:0!important}.ms-lg-1[_ngcontent-%COMP%]{margin-left:.25rem!important}.ms-lg-2[_ngcontent-%COMP%]{margin-left:.5rem!important}.ms-lg-3[_ngcontent-%COMP%]{margin-left:1rem!important}.ms-lg-4[_ngcontent-%COMP%]{margin-left:1.5rem!important}.ms-lg-5[_ngcontent-%COMP%]{margin-left:3rem!important}.ms-lg-auto[_ngcontent-%COMP%]{margin-left:auto!important}.p-lg-0[_ngcontent-%COMP%]{padding:0!important}.p-lg-1[_ngcontent-%COMP%]{padding:.25rem!important}.p-lg-2[_ngcontent-%COMP%]{padding:.5rem!important}.p-lg-3[_ngcontent-%COMP%]{padding:1rem!important}.p-lg-4[_ngcontent-%COMP%]{padding:1.5rem!important}.p-lg-5[_ngcontent-%COMP%]{padding:3rem!important}.px-lg-0[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.px-lg-1[_ngcontent-%COMP%]{padding-right:.25rem!important;padding-left:.25rem!important}.px-lg-2[_ngcontent-%COMP%]{padding-right:.5rem!important;padding-left:.5rem!important}.px-lg-3[_ngcontent-%COMP%]{padding-right:1rem!important;padding-left:1rem!important}.px-lg-4[_ngcontent-%COMP%]{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-lg-5[_ngcontent-%COMP%]{padding-right:3rem!important;padding-left:3rem!important}.py-lg-0[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.py-lg-1[_ngcontent-%COMP%]{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-lg-2[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-lg-3[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important}.py-lg-4[_ngcontent-%COMP%]{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-lg-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.pt-lg-0[_ngcontent-%COMP%]{padding-top:0!important}.pt-lg-1[_ngcontent-%COMP%]{padding-top:.25rem!important}.pt-lg-2[_ngcontent-%COMP%]{padding-top:.5rem!important}.pt-lg-3[_ngcontent-%COMP%]{padding-top:1rem!important}.pt-lg-4[_ngcontent-%COMP%]{padding-top:1.5rem!important}.pt-lg-5[_ngcontent-%COMP%]{padding-top:3rem!important}.pe-lg-0[_ngcontent-%COMP%]{padding-right:0!important}.pe-lg-1[_ngcontent-%COMP%]{padding-right:.25rem!important}.pe-lg-2[_ngcontent-%COMP%]{padding-right:.5rem!important}.pe-lg-3[_ngcontent-%COMP%]{padding-right:1rem!important}.pe-lg-4[_ngcontent-%COMP%]{padding-right:1.5rem!important}.pe-lg-5[_ngcontent-%COMP%]{padding-right:3rem!important}.pb-lg-0[_ngcontent-%COMP%]{padding-bottom:0!important}.pb-lg-1[_ngcontent-%COMP%]{padding-bottom:.25rem!important}.pb-lg-2[_ngcontent-%COMP%]{padding-bottom:.5rem!important}.pb-lg-3[_ngcontent-%COMP%]{padding-bottom:1rem!important}.pb-lg-4[_ngcontent-%COMP%]{padding-bottom:1.5rem!important}.pb-lg-5[_ngcontent-%COMP%]{padding-bottom:3rem!important}.ps-lg-0[_ngcontent-%COMP%]{padding-left:0!important}.ps-lg-1[_ngcontent-%COMP%]{padding-left:.25rem!important}.ps-lg-2[_ngcontent-%COMP%]{padding-left:.5rem!important}.ps-lg-3[_ngcontent-%COMP%]{padding-left:1rem!important}.ps-lg-4[_ngcontent-%COMP%]{padding-left:1.5rem!important}.ps-lg-5[_ngcontent-%COMP%]{padding-left:3rem!important}.gap-lg-0[_ngcontent-%COMP%]{gap:0!important}.gap-lg-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-lg-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-lg-3[_ngcontent-%COMP%]{gap:1rem!important}.gap-lg-4[_ngcontent-%COMP%]{gap:1.5rem!important}.gap-lg-5[_ngcontent-%COMP%]{gap:3rem!important}.row-gap-lg-0[_ngcontent-%COMP%]{row-gap:0!important}.row-gap-lg-1[_ngcontent-%COMP%]{row-gap:.25rem!important}.row-gap-lg-2[_ngcontent-%COMP%]{row-gap:.5rem!important}.row-gap-lg-3[_ngcontent-%COMP%]{row-gap:1rem!important}.row-gap-lg-4[_ngcontent-%COMP%]{row-gap:1.5rem!important}.row-gap-lg-5[_ngcontent-%COMP%]{row-gap:3rem!important}.column-gap-lg-0[_ngcontent-%COMP%]{column-gap:0!important}.column-gap-lg-1[_ngcontent-%COMP%]{column-gap:.25rem!important}.column-gap-lg-2[_ngcontent-%COMP%]{column-gap:.5rem!important}.column-gap-lg-3[_ngcontent-%COMP%]{column-gap:1rem!important}.column-gap-lg-4[_ngcontent-%COMP%]{column-gap:1.5rem!important}.column-gap-lg-5[_ngcontent-%COMP%]{column-gap:3rem!important}.text-lg-start[_ngcontent-%COMP%]{text-align:left!important}.text-lg-end[_ngcontent-%COMP%]{text-align:right!important}.text-lg-center[_ngcontent-%COMP%]{text-align:center!important}}@media (min-width:1200px){.float-xl-start[_ngcontent-%COMP%]{float:left!important}.float-xl-end[_ngcontent-%COMP%]{float:right!important}.float-xl-none[_ngcontent-%COMP%]{float:none!important}.object-fit-xl-contain[_ngcontent-%COMP%]{object-fit:contain!important}.object-fit-xl-cover[_ngcontent-%COMP%]{object-fit:cover!important}.object-fit-xl-fill[_ngcontent-%COMP%]{object-fit:fill!important}.object-fit-xl-scale[_ngcontent-%COMP%]{object-fit:scale-down!important}.object-fit-xl-none[_ngcontent-%COMP%]{object-fit:none!important}.d-xl-inline[_ngcontent-%COMP%]{display:inline!important}.d-xl-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-xl-block[_ngcontent-%COMP%]{display:block!important}.d-xl-grid[_ngcontent-%COMP%]{display:grid!important}.d-xl-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-xl-table[_ngcontent-%COMP%]{display:table!important}.d-xl-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-xl-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-xl-flex[_ngcontent-%COMP%]{display:flex!important}.d-xl-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-xl-none[_ngcontent-%COMP%]{display:none!important}.flex-xl-fill[_ngcontent-%COMP%]{flex:1 1 auto!important}.flex-xl-row[_ngcontent-%COMP%]{flex-direction:row!important}.flex-xl-column[_ngcontent-%COMP%]{flex-direction:column!important}.flex-xl-row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse!important}.flex-xl-column-reverse[_ngcontent-%COMP%]{flex-direction:column-reverse!important}.flex-xl-grow-0[_ngcontent-%COMP%]{flex-grow:0!important}.flex-xl-grow-1[_ngcontent-%COMP%]{flex-grow:1!important}.flex-xl-shrink-0[_ngcontent-%COMP%]{flex-shrink:0!important}.flex-xl-shrink-1[_ngcontent-%COMP%]{flex-shrink:1!important}.flex-xl-wrap[_ngcontent-%COMP%]{flex-wrap:wrap!important}.flex-xl-nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap!important}.flex-xl-wrap-reverse[_ngcontent-%COMP%]{flex-wrap:wrap-reverse!important}.justify-content-xl-start[_ngcontent-%COMP%]{justify-content:flex-start!important}.justify-content-xl-end[_ngcontent-%COMP%]{justify-content:flex-end!important}.justify-content-xl-center[_ngcontent-%COMP%]{justify-content:center!important}.justify-content-xl-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-xl-around[_ngcontent-%COMP%]{justify-content:space-around!important}.justify-content-xl-evenly[_ngcontent-%COMP%]{justify-content:space-evenly!important}.align-items-xl-start[_ngcontent-%COMP%]{align-items:flex-start!important}.align-items-xl-end[_ngcontent-%COMP%]{align-items:flex-end!important}.align-items-xl-center[_ngcontent-%COMP%]{align-items:center!important}.align-items-xl-baseline[_ngcontent-%COMP%]{align-items:baseline!important}.align-items-xl-stretch[_ngcontent-%COMP%]{align-items:stretch!important}.align-content-xl-start[_ngcontent-%COMP%]{align-content:flex-start!important}.align-content-xl-end[_ngcontent-%COMP%]{align-content:flex-end!important}.align-content-xl-center[_ngcontent-%COMP%]{align-content:center!important}.align-content-xl-between[_ngcontent-%COMP%]{align-content:space-between!important}.align-content-xl-around[_ngcontent-%COMP%]{align-content:space-around!important}.align-content-xl-stretch[_ngcontent-%COMP%]{align-content:stretch!important}.align-self-xl-auto[_ngcontent-%COMP%]{align-self:auto!important}.align-self-xl-start[_ngcontent-%COMP%]{align-self:flex-start!important}.align-self-xl-end[_ngcontent-%COMP%]{align-self:flex-end!important}.align-self-xl-center[_ngcontent-%COMP%]{align-self:center!important}.align-self-xl-baseline[_ngcontent-%COMP%]{align-self:baseline!important}.align-self-xl-stretch[_ngcontent-%COMP%]{align-self:stretch!important}.order-xl-first[_ngcontent-%COMP%]{order:-1!important}.order-xl-0[_ngcontent-%COMP%]{order:0!important}.order-xl-1[_ngcontent-%COMP%]{order:1!important}.order-xl-2[_ngcontent-%COMP%]{order:2!important}.order-xl-3[_ngcontent-%COMP%]{order:3!important}.order-xl-4[_ngcontent-%COMP%]{order:4!important}.order-xl-5[_ngcontent-%COMP%]{order:5!important}.order-xl-last[_ngcontent-%COMP%]{order:6!important}.m-xl-0[_ngcontent-%COMP%]{margin:0!important}.m-xl-1[_ngcontent-%COMP%]{margin:.25rem!important}.m-xl-2[_ngcontent-%COMP%]{margin:.5rem!important}.m-xl-3[_ngcontent-%COMP%]{margin:1rem!important}.m-xl-4[_ngcontent-%COMP%]{margin:1.5rem!important}.m-xl-5[_ngcontent-%COMP%]{margin:3rem!important}.m-xl-auto[_ngcontent-%COMP%]{margin:auto!important}.mx-xl-0[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}.mx-xl-1[_ngcontent-%COMP%]{margin-right:.25rem!important;margin-left:.25rem!important}.mx-xl-2[_ngcontent-%COMP%]{margin-right:.5rem!important;margin-left:.5rem!important}.mx-xl-3[_ngcontent-%COMP%]{margin-right:1rem!important;margin-left:1rem!important}.mx-xl-4[_ngcontent-%COMP%]{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-xl-5[_ngcontent-%COMP%]{margin-right:3rem!important;margin-left:3rem!important}.mx-xl-auto[_ngcontent-%COMP%]{margin-right:auto!important;margin-left:auto!important}.my-xl-0[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}.my-xl-1[_ngcontent-%COMP%]{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-xl-2[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-xl-3[_ngcontent-%COMP%]{margin-top:1rem!important;margin-bottom:1rem!important}.my-xl-4[_ngcontent-%COMP%]{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-xl-5[_ngcontent-%COMP%]{margin-top:3rem!important;margin-bottom:3rem!important}.my-xl-auto[_ngcontent-%COMP%]{margin-top:auto!important;margin-bottom:auto!important}.mt-xl-0[_ngcontent-%COMP%]{margin-top:0!important}.mt-xl-1[_ngcontent-%COMP%]{margin-top:.25rem!important}.mt-xl-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-xl-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-xl-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}.mt-xl-5[_ngcontent-%COMP%]{margin-top:3rem!important}.mt-xl-auto[_ngcontent-%COMP%]{margin-top:auto!important}.me-xl-0[_ngcontent-%COMP%]{margin-right:0!important}.me-xl-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-xl-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-xl-3[_ngcontent-%COMP%]{margin-right:1rem!important}.me-xl-4[_ngcontent-%COMP%]{margin-right:1.5rem!important}.me-xl-5[_ngcontent-%COMP%]{margin-right:3rem!important}.me-xl-auto[_ngcontent-%COMP%]{margin-right:auto!important}.mb-xl-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-xl-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-xl-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-xl-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-xl-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-xl-5[_ngcontent-%COMP%]{margin-bottom:3rem!important}.mb-xl-auto[_ngcontent-%COMP%]{margin-bottom:auto!important}.ms-xl-0[_ngcontent-%COMP%]{margin-left:0!important}.ms-xl-1[_ngcontent-%COMP%]{margin-left:.25rem!important}.ms-xl-2[_ngcontent-%COMP%]{margin-left:.5rem!important}.ms-xl-3[_ngcontent-%COMP%]{margin-left:1rem!important}.ms-xl-4[_ngcontent-%COMP%]{margin-left:1.5rem!important}.ms-xl-5[_ngcontent-%COMP%]{margin-left:3rem!important}.ms-xl-auto[_ngcontent-%COMP%]{margin-left:auto!important}.p-xl-0[_ngcontent-%COMP%]{padding:0!important}.p-xl-1[_ngcontent-%COMP%]{padding:.25rem!important}.p-xl-2[_ngcontent-%COMP%]{padding:.5rem!important}.p-xl-3[_ngcontent-%COMP%]{padding:1rem!important}.p-xl-4[_ngcontent-%COMP%]{padding:1.5rem!important}.p-xl-5[_ngcontent-%COMP%]{padding:3rem!important}.px-xl-0[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.px-xl-1[_ngcontent-%COMP%]{padding-right:.25rem!important;padding-left:.25rem!important}.px-xl-2[_ngcontent-%COMP%]{padding-right:.5rem!important;padding-left:.5rem!important}.px-xl-3[_ngcontent-%COMP%]{padding-right:1rem!important;padding-left:1rem!important}.px-xl-4[_ngcontent-%COMP%]{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-xl-5[_ngcontent-%COMP%]{padding-right:3rem!important;padding-left:3rem!important}.py-xl-0[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.py-xl-1[_ngcontent-%COMP%]{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-xl-2[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-xl-3[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important}.py-xl-4[_ngcontent-%COMP%]{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-xl-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.pt-xl-0[_ngcontent-%COMP%]{padding-top:0!important}.pt-xl-1[_ngcontent-%COMP%]{padding-top:.25rem!important}.pt-xl-2[_ngcontent-%COMP%]{padding-top:.5rem!important}.pt-xl-3[_ngcontent-%COMP%]{padding-top:1rem!important}.pt-xl-4[_ngcontent-%COMP%]{padding-top:1.5rem!important}.pt-xl-5[_ngcontent-%COMP%]{padding-top:3rem!important}.pe-xl-0[_ngcontent-%COMP%]{padding-right:0!important}.pe-xl-1[_ngcontent-%COMP%]{padding-right:.25rem!important}.pe-xl-2[_ngcontent-%COMP%]{padding-right:.5rem!important}.pe-xl-3[_ngcontent-%COMP%]{padding-right:1rem!important}.pe-xl-4[_ngcontent-%COMP%]{padding-right:1.5rem!important}.pe-xl-5[_ngcontent-%COMP%]{padding-right:3rem!important}.pb-xl-0[_ngcontent-%COMP%]{padding-bottom:0!important}.pb-xl-1[_ngcontent-%COMP%]{padding-bottom:.25rem!important}.pb-xl-2[_ngcontent-%COMP%]{padding-bottom:.5rem!important}.pb-xl-3[_ngcontent-%COMP%]{padding-bottom:1rem!important}.pb-xl-4[_ngcontent-%COMP%]{padding-bottom:1.5rem!important}.pb-xl-5[_ngcontent-%COMP%]{padding-bottom:3rem!important}.ps-xl-0[_ngcontent-%COMP%]{padding-left:0!important}.ps-xl-1[_ngcontent-%COMP%]{padding-left:.25rem!important}.ps-xl-2[_ngcontent-%COMP%]{padding-left:.5rem!important}.ps-xl-3[_ngcontent-%COMP%]{padding-left:1rem!important}.ps-xl-4[_ngcontent-%COMP%]{padding-left:1.5rem!important}.ps-xl-5[_ngcontent-%COMP%]{padding-left:3rem!important}.gap-xl-0[_ngcontent-%COMP%]{gap:0!important}.gap-xl-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-xl-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-xl-3[_ngcontent-%COMP%]{gap:1rem!important}.gap-xl-4[_ngcontent-%COMP%]{gap:1.5rem!important}.gap-xl-5[_ngcontent-%COMP%]{gap:3rem!important}.row-gap-xl-0[_ngcontent-%COMP%]{row-gap:0!important}.row-gap-xl-1[_ngcontent-%COMP%]{row-gap:.25rem!important}.row-gap-xl-2[_ngcontent-%COMP%]{row-gap:.5rem!important}.row-gap-xl-3[_ngcontent-%COMP%]{row-gap:1rem!important}.row-gap-xl-4[_ngcontent-%COMP%]{row-gap:1.5rem!important}.row-gap-xl-5[_ngcontent-%COMP%]{row-gap:3rem!important}.column-gap-xl-0[_ngcontent-%COMP%]{column-gap:0!important}.column-gap-xl-1[_ngcontent-%COMP%]{column-gap:.25rem!important}.column-gap-xl-2[_ngcontent-%COMP%]{column-gap:.5rem!important}.column-gap-xl-3[_ngcontent-%COMP%]{column-gap:1rem!important}.column-gap-xl-4[_ngcontent-%COMP%]{column-gap:1.5rem!important}.column-gap-xl-5[_ngcontent-%COMP%]{column-gap:3rem!important}.text-xl-start[_ngcontent-%COMP%]{text-align:left!important}.text-xl-end[_ngcontent-%COMP%]{text-align:right!important}.text-xl-center[_ngcontent-%COMP%]{text-align:center!important}}@media (min-width:1400px){.float-xxl-start[_ngcontent-%COMP%]{float:left!important}.float-xxl-end[_ngcontent-%COMP%]{float:right!important}.float-xxl-none[_ngcontent-%COMP%]{float:none!important}.object-fit-xxl-contain[_ngcontent-%COMP%]{object-fit:contain!important}.object-fit-xxl-cover[_ngcontent-%COMP%]{object-fit:cover!important}.object-fit-xxl-fill[_ngcontent-%COMP%]{object-fit:fill!important}.object-fit-xxl-scale[_ngcontent-%COMP%]{object-fit:scale-down!important}.object-fit-xxl-none[_ngcontent-%COMP%]{object-fit:none!important}.d-xxl-inline[_ngcontent-%COMP%]{display:inline!important}.d-xxl-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-xxl-block[_ngcontent-%COMP%]{display:block!important}.d-xxl-grid[_ngcontent-%COMP%]{display:grid!important}.d-xxl-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-xxl-table[_ngcontent-%COMP%]{display:table!important}.d-xxl-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-xxl-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-xxl-flex[_ngcontent-%COMP%]{display:flex!important}.d-xxl-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-xxl-none[_ngcontent-%COMP%]{display:none!important}.flex-xxl-fill[_ngcontent-%COMP%]{flex:1 1 auto!important}.flex-xxl-row[_ngcontent-%COMP%]{flex-direction:row!important}.flex-xxl-column[_ngcontent-%COMP%]{flex-direction:column!important}.flex-xxl-row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse!important}.flex-xxl-column-reverse[_ngcontent-%COMP%]{flex-direction:column-reverse!important}.flex-xxl-grow-0[_ngcontent-%COMP%]{flex-grow:0!important}.flex-xxl-grow-1[_ngcontent-%COMP%]{flex-grow:1!important}.flex-xxl-shrink-0[_ngcontent-%COMP%]{flex-shrink:0!important}.flex-xxl-shrink-1[_ngcontent-%COMP%]{flex-shrink:1!important}.flex-xxl-wrap[_ngcontent-%COMP%]{flex-wrap:wrap!important}.flex-xxl-nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap!important}.flex-xxl-wrap-reverse[_ngcontent-%COMP%]{flex-wrap:wrap-reverse!important}.justify-content-xxl-start[_ngcontent-%COMP%]{justify-content:flex-start!important}.justify-content-xxl-end[_ngcontent-%COMP%]{justify-content:flex-end!important}.justify-content-xxl-center[_ngcontent-%COMP%]{justify-content:center!important}.justify-content-xxl-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-xxl-around[_ngcontent-%COMP%]{justify-content:space-around!important}.justify-content-xxl-evenly[_ngcontent-%COMP%]{justify-content:space-evenly!important}.align-items-xxl-start[_ngcontent-%COMP%]{align-items:flex-start!important}.align-items-xxl-end[_ngcontent-%COMP%]{align-items:flex-end!important}.align-items-xxl-center[_ngcontent-%COMP%]{align-items:center!important}.align-items-xxl-baseline[_ngcontent-%COMP%]{align-items:baseline!important}.align-items-xxl-stretch[_ngcontent-%COMP%]{align-items:stretch!important}.align-content-xxl-start[_ngcontent-%COMP%]{align-content:flex-start!important}.align-content-xxl-end[_ngcontent-%COMP%]{align-content:flex-end!important}.align-content-xxl-center[_ngcontent-%COMP%]{align-content:center!important}.align-content-xxl-between[_ngcontent-%COMP%]{align-content:space-between!important}.align-content-xxl-around[_ngcontent-%COMP%]{align-content:space-around!important}.align-content-xxl-stretch[_ngcontent-%COMP%]{align-content:stretch!important}.align-self-xxl-auto[_ngcontent-%COMP%]{align-self:auto!important}.align-self-xxl-start[_ngcontent-%COMP%]{align-self:flex-start!important}.align-self-xxl-end[_ngcontent-%COMP%]{align-self:flex-end!important}.align-self-xxl-center[_ngcontent-%COMP%]{align-self:center!important}.align-self-xxl-baseline[_ngcontent-%COMP%]{align-self:baseline!important}.align-self-xxl-stretch[_ngcontent-%COMP%]{align-self:stretch!important}.order-xxl-first[_ngcontent-%COMP%]{order:-1!important}.order-xxl-0[_ngcontent-%COMP%]{order:0!important}.order-xxl-1[_ngcontent-%COMP%]{order:1!important}.order-xxl-2[_ngcontent-%COMP%]{order:2!important}.order-xxl-3[_ngcontent-%COMP%]{order:3!important}.order-xxl-4[_ngcontent-%COMP%]{order:4!important}.order-xxl-5[_ngcontent-%COMP%]{order:5!important}.order-xxl-last[_ngcontent-%COMP%]{order:6!important}.m-xxl-0[_ngcontent-%COMP%]{margin:0!important}.m-xxl-1[_ngcontent-%COMP%]{margin:.25rem!important}.m-xxl-2[_ngcontent-%COMP%]{margin:.5rem!important}.m-xxl-3[_ngcontent-%COMP%]{margin:1rem!important}.m-xxl-4[_ngcontent-%COMP%]{margin:1.5rem!important}.m-xxl-5[_ngcontent-%COMP%]{margin:3rem!important}.m-xxl-auto[_ngcontent-%COMP%]{margin:auto!important}.mx-xxl-0[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}.mx-xxl-1[_ngcontent-%COMP%]{margin-right:.25rem!important;margin-left:.25rem!important}.mx-xxl-2[_ngcontent-%COMP%]{margin-right:.5rem!important;margin-left:.5rem!important}.mx-xxl-3[_ngcontent-%COMP%]{margin-right:1rem!important;margin-left:1rem!important}.mx-xxl-4[_ngcontent-%COMP%]{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-xxl-5[_ngcontent-%COMP%]{margin-right:3rem!important;margin-left:3rem!important}.mx-xxl-auto[_ngcontent-%COMP%]{margin-right:auto!important;margin-left:auto!important}.my-xxl-0[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}.my-xxl-1[_ngcontent-%COMP%]{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-xxl-2[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-xxl-3[_ngcontent-%COMP%]{margin-top:1rem!important;margin-bottom:1rem!important}.my-xxl-4[_ngcontent-%COMP%]{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-xxl-5[_ngcontent-%COMP%]{margin-top:3rem!important;margin-bottom:3rem!important}.my-xxl-auto[_ngcontent-%COMP%]{margin-top:auto!important;margin-bottom:auto!important}.mt-xxl-0[_ngcontent-%COMP%]{margin-top:0!important}.mt-xxl-1[_ngcontent-%COMP%]{margin-top:.25rem!important}.mt-xxl-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-xxl-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-xxl-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}.mt-xxl-5[_ngcontent-%COMP%]{margin-top:3rem!important}.mt-xxl-auto[_ngcontent-%COMP%]{margin-top:auto!important}.me-xxl-0[_ngcontent-%COMP%]{margin-right:0!important}.me-xxl-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-xxl-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-xxl-3[_ngcontent-%COMP%]{margin-right:1rem!important}.me-xxl-4[_ngcontent-%COMP%]{margin-right:1.5rem!important}.me-xxl-5[_ngcontent-%COMP%]{margin-right:3rem!important}.me-xxl-auto[_ngcontent-%COMP%]{margin-right:auto!important}.mb-xxl-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-xxl-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-xxl-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-xxl-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-xxl-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-xxl-5[_ngcontent-%COMP%]{margin-bottom:3rem!important}.mb-xxl-auto[_ngcontent-%COMP%]{margin-bottom:auto!important}.ms-xxl-0[_ngcontent-%COMP%]{margin-left:0!important}.ms-xxl-1[_ngcontent-%COMP%]{margin-left:.25rem!important}.ms-xxl-2[_ngcontent-%COMP%]{margin-left:.5rem!important}.ms-xxl-3[_ngcontent-%COMP%]{margin-left:1rem!important}.ms-xxl-4[_ngcontent-%COMP%]{margin-left:1.5rem!important}.ms-xxl-5[_ngcontent-%COMP%]{margin-left:3rem!important}.ms-xxl-auto[_ngcontent-%COMP%]{margin-left:auto!important}.p-xxl-0[_ngcontent-%COMP%]{padding:0!important}.p-xxl-1[_ngcontent-%COMP%]{padding:.25rem!important}.p-xxl-2[_ngcontent-%COMP%]{padding:.5rem!important}.p-xxl-3[_ngcontent-%COMP%]{padding:1rem!important}.p-xxl-4[_ngcontent-%COMP%]{padding:1.5rem!important}.p-xxl-5[_ngcontent-%COMP%]{padding:3rem!important}.px-xxl-0[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.px-xxl-1[_ngcontent-%COMP%]{padding-right:.25rem!important;padding-left:.25rem!important}.px-xxl-2[_ngcontent-%COMP%]{padding-right:.5rem!important;padding-left:.5rem!important}.px-xxl-3[_ngcontent-%COMP%]{padding-right:1rem!important;padding-left:1rem!important}.px-xxl-4[_ngcontent-%COMP%]{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-xxl-5[_ngcontent-%COMP%]{padding-right:3rem!important;padding-left:3rem!important}.py-xxl-0[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.py-xxl-1[_ngcontent-%COMP%]{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-xxl-2[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-xxl-3[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important}.py-xxl-4[_ngcontent-%COMP%]{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-xxl-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.pt-xxl-0[_ngcontent-%COMP%]{padding-top:0!important}.pt-xxl-1[_ngcontent-%COMP%]{padding-top:.25rem!important}.pt-xxl-2[_ngcontent-%COMP%]{padding-top:.5rem!important}.pt-xxl-3[_ngcontent-%COMP%]{padding-top:1rem!important}.pt-xxl-4[_ngcontent-%COMP%]{padding-top:1.5rem!important}.pt-xxl-5[_ngcontent-%COMP%]{padding-top:3rem!important}.pe-xxl-0[_ngcontent-%COMP%]{padding-right:0!important}.pe-xxl-1[_ngcontent-%COMP%]{padding-right:.25rem!important}.pe-xxl-2[_ngcontent-%COMP%]{padding-right:.5rem!important}.pe-xxl-3[_ngcontent-%COMP%]{padding-right:1rem!important}.pe-xxl-4[_ngcontent-%COMP%]{padding-right:1.5rem!important}.pe-xxl-5[_ngcontent-%COMP%]{padding-right:3rem!important}.pb-xxl-0[_ngcontent-%COMP%]{padding-bottom:0!important}.pb-xxl-1[_ngcontent-%COMP%]{padding-bottom:.25rem!important}.pb-xxl-2[_ngcontent-%COMP%]{padding-bottom:.5rem!important}.pb-xxl-3[_ngcontent-%COMP%]{padding-bottom:1rem!important}.pb-xxl-4[_ngcontent-%COMP%]{padding-bottom:1.5rem!important}.pb-xxl-5[_ngcontent-%COMP%]{padding-bottom:3rem!important}.ps-xxl-0[_ngcontent-%COMP%]{padding-left:0!important}.ps-xxl-1[_ngcontent-%COMP%]{padding-left:.25rem!important}.ps-xxl-2[_ngcontent-%COMP%]{padding-left:.5rem!important}.ps-xxl-3[_ngcontent-%COMP%]{padding-left:1rem!important}.ps-xxl-4[_ngcontent-%COMP%]{padding-left:1.5rem!important}.ps-xxl-5[_ngcontent-%COMP%]{padding-left:3rem!important}.gap-xxl-0[_ngcontent-%COMP%]{gap:0!important}.gap-xxl-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-xxl-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-xxl-3[_ngcontent-%COMP%]{gap:1rem!important}.gap-xxl-4[_ngcontent-%COMP%]{gap:1.5rem!important}.gap-xxl-5[_ngcontent-%COMP%]{gap:3rem!important}.row-gap-xxl-0[_ngcontent-%COMP%]{row-gap:0!important}.row-gap-xxl-1[_ngcontent-%COMP%]{row-gap:.25rem!important}.row-gap-xxl-2[_ngcontent-%COMP%]{row-gap:.5rem!important}.row-gap-xxl-3[_ngcontent-%COMP%]{row-gap:1rem!important}.row-gap-xxl-4[_ngcontent-%COMP%]{row-gap:1.5rem!important}.row-gap-xxl-5[_ngcontent-%COMP%]{row-gap:3rem!important}.column-gap-xxl-0[_ngcontent-%COMP%]{column-gap:0!important}.column-gap-xxl-1[_ngcontent-%COMP%]{column-gap:.25rem!important}.column-gap-xxl-2[_ngcontent-%COMP%]{column-gap:.5rem!important}.column-gap-xxl-3[_ngcontent-%COMP%]{column-gap:1rem!important}.column-gap-xxl-4[_ngcontent-%COMP%]{column-gap:1.5rem!important}.column-gap-xxl-5[_ngcontent-%COMP%]{column-gap:3rem!important}.text-xxl-start[_ngcontent-%COMP%]{text-align:left!important}.text-xxl-end[_ngcontent-%COMP%]{text-align:right!important}.text-xxl-center[_ngcontent-%COMP%]{text-align:center!important}}@media (min-width:1200px){.fs-1[_ngcontent-%COMP%]{font-size:2.5rem!important}.fs-2[_ngcontent-%COMP%]{font-size:2rem!important}.fs-3[_ngcontent-%COMP%]{font-size:1.75rem!important}.fs-4[_ngcontent-%COMP%]{font-size:1.5rem!important}}@media print{.d-print-inline[_ngcontent-%COMP%]{display:inline!important}.d-print-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-print-block[_ngcontent-%COMP%]{display:block!important}.d-print-grid[_ngcontent-%COMP%]{display:grid!important}.d-print-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-print-table[_ngcontent-%COMP%]{display:table!important}.d-print-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-print-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-print-flex[_ngcontent-%COMP%]{display:flex!important}.d-print-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-print-none[_ngcontent-%COMP%]{display:none!important}}.list-group[_ngcontent-%COMP%]{margin-bottom:20px}.card[_ngcontent-%COMP%]{margin-top:20px}.list-group-item[_ngcontent-%COMP%]{cursor:pointer}.list-group-item[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}"]})}return o})(),canActivate:[GA]},{path:"comments",component:(()=>{class o{constructor(i,a){this.fb=i,this.afAuth=a,this.userId=null,this.afAuth.authState.subscribe(h=>{this.userId=h?.uid||null}),this.commentForm=this.fb.group({comment:["",BM.required]})}static#t=this.\u0275fac=function(a){return new(a||o)(M.Y36(g3),M.Y36(u2))};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-comments"]],decls:9,vars:0,consts:[[1,"comment-form-container"],["id","commentForm"],["for","comment"],["id","comment","name","comment","required",""],["type","submit"]],template:function(a,h){1&a&&(M.TgZ(0,"div",0)(1,"h2"),M._uU(2,"Add Comment"),M.qZA(),M.TgZ(3,"form",1)(4,"label",2),M._uU(5,"Comment:"),M.qZA(),M._UZ(6,"textarea",3),M.TgZ(7,"button",4),M._uU(8,"Submit"),M.qZA()()())},dependencies:[ED,_D,dA],styles:["body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;display:flex;align-items:center;justify-content:center;height:100vh;margin:0}.comment-form-container[_ngcontent-%COMP%]{width:300px;padding:20px;border:1px solid #ccc;border-radius:8px}label[_ngcontent-%COMP%]{display:block;margin-bottom:8px}textarea[_ngcontent-%COMP%]{width:100%;height:80px;resize:vertical;margin-bottom:16px}button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:10px;border:none;border-radius:4px;cursor:pointer}"]})}return o})(),canActivate:[GA]}];let X4=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=M.oAB({type:o});static#n=this.\u0275inj=M.cJS({imports:[rL.forRoot(Y4),rL]})}return o})(),Q4=(()=>{class o{constructor(){this.title="TripTrove"}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275cmp=M.Xpm({type:o,selectors:[["app-root"]],decls:1,vars:0,template:function(a,h){1&a&&M._UZ(0,"router-outlet")},dependencies:[t2]})}return o})(),J4=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=M.oAB({type:o});static#n=this.\u0275inj=M.cJS({imports:[Ai,Lk]})}return o})(),tU=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=M.oAB({type:o});static#n=this.\u0275inj=M.cJS({imports:[Nk,Ai]})}return o})();class $L{}class eU{}const u0="*";function GL(o,n=null){return{type:2,steps:o,options:n}}function HL(o){return{type:6,styles:o,offset:null}}class bS{constructor(n=0,i=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+i}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const i="start"==n?this._onStartFns:this._onDoneFns;i.forEach(a=>a()),i.length=0}}class qL{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let i=0,a=0,h=0;const _=this.players.length;0==_?queueMicrotask(()=>this._onFinish()):this.players.forEach(x=>{x.onDone(()=>{++i==_&&this._onFinish()}),x.onDestroy(()=>{++a==_&&this._onDestroy()}),x.onStart(()=>{++h==_&&this._onStart()})}),this.totalTime=this.players.reduce((x,S)=>Math.max(x,S.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const i=n*this.totalTime;this.players.forEach(a=>{const h=a.totalTime?Math.min(1,i/a.totalTime):1;a.setPosition(h)})}getPosition(){const n=this.players.reduce((i,a)=>null===i||a.totalTime>i.totalTime?a:i,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const i="start"==n?this._onStartFns:this._onDoneFns;i.forEach(a=>a()),i.length=0}}function ZL(o){return new M.vHH(3e3,!1)}function dw(o){switch(o.length){case 0:return new bS;case 1:return o[0];default:return new qL(o)}}function WL(o,n,i=new Map,a=new Map){const h=[],_=[];let x=-1,S=null;if(n.forEach(L=>{const B=L.get("offset"),H=B==x,Y=H&&S||new Map;L.forEach((pt,xt)=>{let At=xt,Ut=pt;if("offset"!==xt)switch(At=o.normalizePropertyName(At,h),Ut){case"!":Ut=i.get(xt);break;case u0:Ut=a.get(xt);break;default:Ut=o.normalizeStyleValue(xt,At,Ut,h)}Y.set(At,Ut)}),H||_.push(Y),S=Y,x=B}),h.length)throw function MU(o){return new M.vHH(3502,!1)}();return _}function T2(o,n,i,a){switch(n){case"start":o.onStart(()=>a(i&&I2(i,"start",o)));break;case"done":o.onDone(()=>a(i&&I2(i,"done",o)));break;case"destroy":o.onDestroy(()=>a(i&&I2(i,"destroy",o)))}}function I2(o,n,i){const _=S2(o.element,o.triggerName,o.fromState,o.toState,n||o.phaseName,i.totalTime??o.totalTime,!!i.disabled),x=o._data;return null!=x&&(_._data=x),_}function S2(o,n,i,a,h="",_=0,x){return{element:o,triggerName:n,fromState:i,toState:a,phaseName:h,totalTime:_,disabled:!!x}}function Uf(o,n,i){let a=o.get(n);return a||o.set(n,a=i),a}function KL(o){const n=o.indexOf(":");return[o.substring(1,n),o.slice(n+1)]}const NU=(()=>typeof document>"u"?null:document.documentElement)();function A2(o){const n=o.parentNode||o.host||null;return n===NU?null:n}let KM=null,YL=!1;function XL(o,n){for(;n;){if(n===o)return!0;n=A2(n)}return!1}function QL(o,n,i){if(i)return Array.from(o.querySelectorAll(n));const a=o.querySelector(n);return a?[a]:[]}let JL=(()=>{class o{validateStyleProperty(i){return function zU(o){KM||(KM=function BU(){return typeof document<"u"?document.body:null}()||{},YL=!!KM.style&&"WebkitAppearance"in KM.style);let n=!0;return KM.style&&!function FU(o){return"ebkit"==o.substring(1,6)}(o)&&(n=o in KM.style,!n&&YL&&(n="Webkit"+o.charAt(0).toUpperCase()+o.slice(1)in KM.style)),n}(i)}matchesElement(i,a){return!1}containsElement(i,a){return XL(i,a)}getParentElement(i){return A2(i)}query(i,a,h){return QL(i,a,h)}computeStyle(i,a,h){return h||""}animate(i,a,h,_,x,S=[],L){return new bS(h,_)}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})(),D2=(()=>{class o{static#t=this.NOOP=new JL}return o})();const UU=1e3,k2="ng-enter",HA="ng-leave",qA="ng-trigger",ZA=".ng-trigger",eN="ng-animating",R2=".ng-animating";function d0(o){if("number"==typeof o)return o;const n=o.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:L2(parseFloat(n[1]),n[2])}function L2(o,n){return"s"===n?o*UU:o}function WA(o,n,i){return o.hasOwnProperty("duration")?o:function jU(o,n,i){let h,_=0,x="";if("string"==typeof o){const S=o.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===S)return n.push(ZL()),{duration:0,delay:0,easing:""};h=L2(parseFloat(S[1]),S[2]);const L=S[3];null!=L&&(_=L2(parseFloat(L),S[4]));const B=S[5];B&&(x=B)}else h=o;if(!i){let S=!1,L=n.length;h<0&&(n.push(function nU(){return new M.vHH(3100,!1)}()),S=!0),_<0&&(n.push(function rU(){return new M.vHH(3101,!1)}()),S=!0),S&&n.splice(L,0,ZL())}return{duration:h,delay:_,easing:x}}(o,n,i)}function xS(o,n={}){return Object.keys(o).forEach(i=>{n[i]=o[i]}),n}function nN(o){const n=new Map;return Object.keys(o).forEach(i=>{n.set(i,o[i])}),n}function hw(o,n=new Map,i){if(i)for(let[a,h]of i)n.set(a,h);for(let[a,h]of o)n.set(a,h);return n}function $y(o,n,i){n.forEach((a,h)=>{const _=F2(h);i&&!i.has(h)&&i.set(h,o.style[_]),o.style[_]=a})}function YM(o,n){n.forEach((i,a)=>{const h=F2(a);o.style[h]=""})}function wS(o){return Array.isArray(o)?1==o.length?o[0]:GL(o):o}const N2=new RegExp("{{\\s*(.+?)\\s*}}","g");function iN(o){let n=[];if("string"==typeof o){let i;for(;i=N2.exec(o);)n.push(i[1]);N2.lastIndex=0}return n}function CS(o,n,i){const a=o.toString(),h=a.replace(N2,(_,x)=>{let S=n[x];return null==S&&(i.push(function oU(o){return new M.vHH(3003,!1)}()),S=""),S.toString()});return h==a?o:h}function KA(o){const n=[];let i=o.next();for(;!i.done;)n.push(i.value),i=o.next();return n}const HU=/-+([a-z0-9])/g;function F2(o){return o.replace(HU,(...n)=>n[1].toUpperCase())}function Vf(o,n,i){switch(n.type){case 7:return o.visitTrigger(n,i);case 0:return o.visitState(n,i);case 1:return o.visitTransition(n,i);case 2:return o.visitSequence(n,i);case 3:return o.visitGroup(n,i);case 4:return o.visitAnimate(n,i);case 5:return o.visitKeyframes(n,i);case 6:return o.visitStyle(n,i);case 8:return o.visitReference(n,i);case 9:return o.visitAnimateChild(n,i);case 10:return o.visitAnimateRef(n,i);case 11:return o.visitQuery(n,i);case 12:return o.visitStagger(n,i);default:throw function sU(o){return new M.vHH(3004,!1)}()}}function oN(o,n){return window.getComputedStyle(o)[n]}const YA="*";function WU(o,n){const i=[];return"string"==typeof o?o.split(/\s*,\s*/).forEach(a=>function KU(o,n,i){if(":"==o[0]){const L=function YU(o,n){switch(o){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(i,a)=>parseFloat(a)>parseFloat(i);case":decrement":return(i,a)=>parseFloat(a)<parseFloat(i);default:return n.push(function bU(o){return new M.vHH(3016,!1)}()),"* => *"}}(o,i);if("function"==typeof L)return void n.push(L);o=L}const a=o.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==a||a.length<4)return i.push(function vU(o){return new M.vHH(3015,!1)}()),n;const h=a[1],_=a[2],x=a[3];n.push(sN(h,x));"<"==_[0]&&!(h==YA&&x==YA)&&n.push(sN(x,h))}(a,i,n)):i.push(o),i}const XA=new Set(["true","1"]),QA=new Set(["false","0"]);function sN(o,n){const i=XA.has(o)||QA.has(o),a=XA.has(n)||QA.has(n);return(h,_)=>{let x=o==YA||o==h,S=n==YA||n==_;return!x&&i&&"boolean"==typeof h&&(x=h?XA.has(o):QA.has(o)),!S&&a&&"boolean"==typeof _&&(S=_?XA.has(n):QA.has(n)),x&&S}}const XU=new RegExp("s*:selfs*,?","g");function z2(o,n,i,a){return new QU(o).build(n,i,a)}class QU{constructor(n){this._driver=n}build(n,i,a){const h=new eV(i);return this._resetContextStyleTimingState(h),Vf(this,wS(n),h)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,i){let a=i.queryCount=0,h=i.depCount=0;const _=[],x=[];return"@"==n.name.charAt(0)&&i.errors.push(function lU(){return new M.vHH(3006,!1)}()),n.definitions.forEach(S=>{if(this._resetContextStyleTimingState(i),0==S.type){const L=S,B=L.name;B.toString().split(/\s*,\s*/).forEach(H=>{L.name=H,_.push(this.visitState(L,i))}),L.name=B}else if(1==S.type){const L=this.visitTransition(S,i);a+=L.queryCount,h+=L.depCount,x.push(L)}else i.errors.push(function cU(){return new M.vHH(3007,!1)}())}),{type:7,name:n.name,states:_,transitions:x,queryCount:a,depCount:h,options:null}}visitState(n,i){const a=this.visitStyle(n.styles,i),h=n.options&&n.options.params||null;if(a.containsDynamicStyles){const _=new Set,x=h||{};a.styles.forEach(S=>{S instanceof Map&&S.forEach(L=>{iN(L).forEach(B=>{x.hasOwnProperty(B)||_.add(B)})})}),_.size&&(KA(_.values()),i.errors.push(function uU(o,n){return new M.vHH(3008,!1)}()))}return{type:0,name:n.name,style:a,options:h?{params:h}:null}}visitTransition(n,i){i.queryCount=0,i.depCount=0;const a=Vf(this,wS(n.animation),i);return{type:1,matchers:WU(n.expr,i.errors),animation:a,queryCount:i.queryCount,depCount:i.depCount,options:XM(n.options)}}visitSequence(n,i){return{type:2,steps:n.steps.map(a=>Vf(this,a,i)),options:XM(n.options)}}visitGroup(n,i){const a=i.currentTime;let h=0;const _=n.steps.map(x=>{i.currentTime=a;const S=Vf(this,x,i);return h=Math.max(h,i.currentTime),S});return i.currentTime=h,{type:3,steps:_,options:XM(n.options)}}visitAnimate(n,i){const a=function rV(o,n){if(o.hasOwnProperty("duration"))return o;if("number"==typeof o)return B2(WA(o,n).duration,0,"");const i=o;if(i.split(/\s+/).some(_=>"{"==_.charAt(0)&&"{"==_.charAt(1))){const _=B2(0,0,"");return _.dynamic=!0,_.strValue=i,_}const h=WA(i,n);return B2(h.duration,h.delay,h.easing)}(n.timings,i.errors);i.currentAnimateTimings=a;let h,_=n.styles?n.styles:HL({});if(5==_.type)h=this.visitKeyframes(_,i);else{let x=n.styles,S=!1;if(!x){S=!0;const B={};a.easing&&(B.easing=a.easing),x=HL(B)}i.currentTime+=a.duration+a.delay;const L=this.visitStyle(x,i);L.isEmptyStep=S,h=L}return i.currentAnimateTimings=null,{type:4,timings:a,style:h,options:null}}visitStyle(n,i){const a=this._makeStyleAst(n,i);return this._validateStyleAst(a,i),a}_makeStyleAst(n,i){const a=[],h=Array.isArray(n.styles)?n.styles:[n.styles];for(let S of h)"string"==typeof S?S===u0?a.push(S):i.errors.push(new M.vHH(3002,!1)):a.push(nN(S));let _=!1,x=null;return a.forEach(S=>{if(S instanceof Map&&(S.has("easing")&&(x=S.get("easing"),S.delete("easing")),!_))for(let L of S.values())if(L.toString().indexOf("{{")>=0){_=!0;break}}),{type:6,styles:a,easing:x,offset:n.offset,containsDynamicStyles:_,options:null}}_validateStyleAst(n,i){const a=i.currentAnimateTimings;let h=i.currentTime,_=i.currentTime;a&&_>0&&(_-=a.duration+a.delay),n.styles.forEach(x=>{"string"!=typeof x&&x.forEach((S,L)=>{const B=i.collectedStyles.get(i.currentQuerySelector),H=B.get(L);let Y=!0;H&&(_!=h&&_>=H.startTime&&h<=H.endTime&&(i.errors.push(function hU(o,n,i,a,h){return new M.vHH(3010,!1)}()),Y=!1),_=H.startTime),Y&&B.set(L,{startTime:_,endTime:h}),i.options&&function GU(o,n,i){const a=n.params||{},h=iN(o);h.length&&h.forEach(_=>{a.hasOwnProperty(_)||i.push(function iU(o){return new M.vHH(3001,!1)}())})}(S,i.options,i.errors)})})}visitKeyframes(n,i){const a={type:5,styles:[],options:null};if(!i.currentAnimateTimings)return i.errors.push(function fU(){return new M.vHH(3011,!1)}()),a;let _=0;const x=[];let S=!1,L=!1,B=0;const H=n.steps.map(qe=>{const fn=this._makeStyleAst(qe,i);let $e=null!=fn.offset?fn.offset:function nV(o){if("string"==typeof o)return null;let n=null;if(Array.isArray(o))o.forEach(i=>{if(i instanceof Map&&i.has("offset")){const a=i;n=parseFloat(a.get("offset")),a.delete("offset")}});else if(o instanceof Map&&o.has("offset")){const i=o;n=parseFloat(i.get("offset")),i.delete("offset")}return n}(fn.styles),cn=0;return null!=$e&&(_++,cn=fn.offset=$e),L=L||cn<0||cn>1,S=S||cn<B,B=cn,x.push(cn),fn});L&&i.errors.push(function pU(){return new M.vHH(3012,!1)}()),S&&i.errors.push(function gU(){return new M.vHH(3200,!1)}());const Y=n.steps.length;let pt=0;_>0&&_<Y?i.errors.push(function mU(){return new M.vHH(3202,!1)}()):0==_&&(pt=1/(Y-1));const xt=Y-1,At=i.currentTime,Ut=i.currentAnimateTimings,Zt=Ut.duration;return H.forEach((qe,fn)=>{const $e=pt>0?fn==xt?1:pt*fn:x[fn],cn=$e*Zt;i.currentTime=At+Ut.delay+cn,Ut.duration=cn,this._validateStyleAst(qe,i),qe.offset=$e,a.styles.push(qe)}),a}visitReference(n,i){return{type:8,animation:Vf(this,wS(n.animation),i),options:XM(n.options)}}visitAnimateChild(n,i){return i.depCount++,{type:9,options:XM(n.options)}}visitAnimateRef(n,i){return{type:10,animation:this.visitReference(n.animation,i),options:XM(n.options)}}visitQuery(n,i){const a=i.currentQuerySelector,h=n.options||{};i.queryCount++,i.currentQuery=n;const[_,x]=function JU(o){const n=!!o.split(/\s*,\s*/).find(i=>":self"==i);return n&&(o=o.replace(XU,"")),o=o.replace(/@\*/g,ZA).replace(/@\w+/g,i=>ZA+"-"+i.slice(1)).replace(/:animating/g,R2),[o,n]}(n.selector);i.currentQuerySelector=a.length?a+" "+_:_,Uf(i.collectedStyles,i.currentQuerySelector,new Map);const S=Vf(this,wS(n.animation),i);return i.currentQuery=null,i.currentQuerySelector=a,{type:11,selector:_,limit:h.limit||0,optional:!!h.optional,includeSelf:x,animation:S,originalSelector:n.selector,options:XM(n.options)}}visitStagger(n,i){i.currentQuery||i.errors.push(function _U(){return new M.vHH(3013,!1)}());const a="full"===n.timings?{duration:0,delay:0,easing:"full"}:WA(n.timings,i.errors,!0);return{type:12,animation:Vf(this,wS(n.animation),i),timings:a,options:null}}}class eV{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function XM(o){return o?(o=xS(o)).params&&(o.params=function tV(o){return o?xS(o):null}(o.params)):o={},o}function B2(o,n,i){return{duration:o,delay:n,easing:i}}function U2(o,n,i,a,h,_,x=null,S=!1){return{type:1,element:o,keyframes:n,preStyleProps:i,postStyleProps:a,duration:h,delay:_,totalTime:h+_,easing:x,subTimeline:S}}class JA{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,i){let a=this._map.get(n);a||this._map.set(n,a=[]),a.push(...i)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const sV=new RegExp(":enter","g"),lV=new RegExp(":leave","g");function V2(o,n,i,a,h,_=new Map,x=new Map,S,L,B=[]){return(new cV).buildKeyframes(o,n,i,a,h,_,x,S,L,B)}class cV{buildKeyframes(n,i,a,h,_,x,S,L,B,H=[]){B=B||new JA;const Y=new j2(n,i,B,h,_,H,[]);Y.options=L;const pt=L.delay?d0(L.delay):0;Y.currentTimeline.delayNextStep(pt),Y.currentTimeline.setStyles([x],null,Y.errors,L),Vf(this,a,Y);const xt=Y.timelines.filter(At=>At.containsAnimation());if(xt.length&&S.size){let At;for(let Ut=xt.length-1;Ut>=0;Ut--){const Zt=xt[Ut];if(Zt.element===i){At=Zt;break}}At&&!At.allowOnlyTimelineStyles()&&At.setStyles([S],null,Y.errors,L)}return xt.length?xt.map(At=>At.buildKeyframes()):[U2(i,[],[],[],0,pt,"",!1)]}visitTrigger(n,i){}visitState(n,i){}visitTransition(n,i){}visitAnimateChild(n,i){const a=i.subInstructions.get(i.element);if(a){const h=i.createSubContext(n.options),_=i.currentTimeline.currentTime,x=this._visitSubInstructions(a,h,h.options);_!=x&&i.transformIntoNewTimeline(x)}i.previousNode=n}visitAnimateRef(n,i){const a=i.createSubContext(n.options);a.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],i,a),this.visitReference(n.animation,a),i.transformIntoNewTimeline(a.currentTimeline.currentTime),i.previousNode=n}_applyAnimationRefDelays(n,i,a){for(const h of n){const _=h?.delay;if(_){const x="number"==typeof _?_:d0(CS(_,h?.params??{},i.errors));a.delayNextStep(x)}}}_visitSubInstructions(n,i,a){let _=i.currentTimeline.currentTime;const x=null!=a.duration?d0(a.duration):null,S=null!=a.delay?d0(a.delay):null;return 0!==x&&n.forEach(L=>{const B=i.appendInstructionToTimeline(L,x,S);_=Math.max(_,B.duration+B.delay)}),_}visitReference(n,i){i.updateOptions(n.options,!0),Vf(this,n.animation,i),i.previousNode=n}visitSequence(n,i){const a=i.subContextCount;let h=i;const _=n.options;if(_&&(_.params||_.delay)&&(h=i.createSubContext(_),h.transformIntoNewTimeline(),null!=_.delay)){6==h.previousNode.type&&(h.currentTimeline.snapshotCurrentStyles(),h.previousNode=tD);const x=d0(_.delay);h.delayNextStep(x)}n.steps.length&&(n.steps.forEach(x=>Vf(this,x,h)),h.currentTimeline.applyStylesToKeyframe(),h.subContextCount>a&&h.transformIntoNewTimeline()),i.previousNode=n}visitGroup(n,i){const a=[];let h=i.currentTimeline.currentTime;const _=n.options&&n.options.delay?d0(n.options.delay):0;n.steps.forEach(x=>{const S=i.createSubContext(n.options);_&&S.delayNextStep(_),Vf(this,x,S),h=Math.max(h,S.currentTimeline.currentTime),a.push(S.currentTimeline)}),a.forEach(x=>i.currentTimeline.mergeTimelineCollectedStyles(x)),i.transformIntoNewTimeline(h),i.previousNode=n}_visitTiming(n,i){if(n.dynamic){const a=n.strValue;return WA(i.params?CS(a,i.params,i.errors):a,i.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,i){const a=i.currentAnimateTimings=this._visitTiming(n.timings,i),h=i.currentTimeline;a.delay&&(i.incrementTime(a.delay),h.snapshotCurrentStyles());const _=n.style;5==_.type?this.visitKeyframes(_,i):(i.incrementTime(a.duration),this.visitStyle(_,i),h.applyStylesToKeyframe()),i.currentAnimateTimings=null,i.previousNode=n}visitStyle(n,i){const a=i.currentTimeline,h=i.currentAnimateTimings;!h&&a.hasCurrentStyleProperties()&&a.forwardFrame();const _=h&&h.easing||n.easing;n.isEmptyStep?a.applyEmptyStep(_):a.setStyles(n.styles,_,i.errors,i.options),i.previousNode=n}visitKeyframes(n,i){const a=i.currentAnimateTimings,h=i.currentTimeline.duration,_=a.duration,S=i.createSubContext().currentTimeline;S.easing=a.easing,n.styles.forEach(L=>{S.forwardTime((L.offset||0)*_),S.setStyles(L.styles,L.easing,i.errors,i.options),S.applyStylesToKeyframe()}),i.currentTimeline.mergeTimelineCollectedStyles(S),i.transformIntoNewTimeline(h+_),i.previousNode=n}visitQuery(n,i){const a=i.currentTimeline.currentTime,h=n.options||{},_=h.delay?d0(h.delay):0;_&&(6===i.previousNode.type||0==a&&i.currentTimeline.hasCurrentStyleProperties())&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=tD);let x=a;const S=i.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!h.optional,i.errors);i.currentQueryTotal=S.length;let L=null;S.forEach((B,H)=>{i.currentQueryIndex=H;const Y=i.createSubContext(n.options,B);_&&Y.delayNextStep(_),B===i.element&&(L=Y.currentTimeline),Vf(this,n.animation,Y),Y.currentTimeline.applyStylesToKeyframe(),x=Math.max(x,Y.currentTimeline.currentTime)}),i.currentQueryIndex=0,i.currentQueryTotal=0,i.transformIntoNewTimeline(x),L&&(i.currentTimeline.mergeTimelineCollectedStyles(L),i.currentTimeline.snapshotCurrentStyles()),i.previousNode=n}visitStagger(n,i){const a=i.parentContext,h=i.currentTimeline,_=n.timings,x=Math.abs(_.duration),S=x*(i.currentQueryTotal-1);let L=x*i.currentQueryIndex;switch(_.duration<0?"reverse":_.easing){case"reverse":L=S-L;break;case"full":L=a.currentStaggerTime}const H=i.currentTimeline;L&&H.delayNextStep(L);const Y=H.currentTime;Vf(this,n.animation,i),i.previousNode=n,a.currentStaggerTime=h.currentTime-Y+(h.startTime-a.currentTimeline.startTime)}}const tD={};class j2{constructor(n,i,a,h,_,x,S,L){this._driver=n,this.element=i,this.subInstructions=a,this._enterClassName=h,this._leaveClassName=_,this.errors=x,this.timelines=S,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=tD,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=L||new eD(this._driver,i,0),S.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,i){if(!n)return;const a=n;let h=this.options;null!=a.duration&&(h.duration=d0(a.duration)),null!=a.delay&&(h.delay=d0(a.delay));const _=a.params;if(_){let x=h.params;x||(x=this.options.params={}),Object.keys(_).forEach(S=>{(!i||!x.hasOwnProperty(S))&&(x[S]=CS(_[S],x,this.errors))})}}_copyOptions(){const n={};if(this.options){const i=this.options.params;if(i){const a=n.params={};Object.keys(i).forEach(h=>{a[h]=i[h]})}}return n}createSubContext(n=null,i,a){const h=i||this.element,_=new j2(this._driver,h,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(h,a||0));return _.previousNode=this.previousNode,_.currentAnimateTimings=this.currentAnimateTimings,_.options=this._copyOptions(),_.updateOptions(n),_.currentQueryIndex=this.currentQueryIndex,_.currentQueryTotal=this.currentQueryTotal,_.parentContext=this,this.subContextCount++,_}transformIntoNewTimeline(n){return this.previousNode=tD,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,i,a){const h={duration:i??n.duration,delay:this.currentTimeline.currentTime+(a??0)+n.delay,easing:""},_=new uV(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,h,n.stretchStartingKeyframe);return this.timelines.push(_),h}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,i,a,h,_,x){let S=[];if(h&&S.push(this.element),n.length>0){n=(n=n.replace(sV,"."+this._enterClassName)).replace(lV,"."+this._leaveClassName);let B=this._driver.query(this.element,n,1!=a);0!==a&&(B=a<0?B.slice(B.length+a,B.length):B.slice(0,a)),S.push(...B)}return!_&&0==S.length&&x.push(function yU(o){return new M.vHH(3014,!1)}()),S}}class eD{constructor(n,i,a,h){this._driver=n,this.element=i,this.startTime=a,this._elementTimelineStylesLookup=h,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(i),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(i,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const i=1===this._keyframes.size&&this._pendingStyles.size;this.duration||i?(this.forwardTime(this.currentTime+n),i&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,i){return this.applyStylesToKeyframe(),new eD(this._driver,n,i||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,i){this._localTimelineStyles.set(n,i),this._globalTimelineStyles.set(n,i),this._styleSummary.set(n,{time:this.currentTime,value:i})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[i,a]of this._globalTimelineStyles)this._backFill.set(i,a||u0),this._currentKeyframe.set(i,u0);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,i,a,h){i&&this._previousKeyframe.set("easing",i);const _=h&&h.params||{},x=function dV(o,n){const i=new Map;let a;return o.forEach(h=>{if("*"===h){a=a||n.keys();for(let _ of a)i.set(_,u0)}else hw(h,i)}),i}(n,this._globalTimelineStyles);for(let[S,L]of x){const B=CS(L,_,a);this._pendingStyles.set(S,B),this._localTimelineStyles.has(S)||this._backFill.set(S,this._globalTimelineStyles.get(S)??u0),this._updateStyle(S,B)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,i)=>{this._currentKeyframe.set(i,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,i)=>{this._currentKeyframe.has(i)||this._currentKeyframe.set(i,n)}))}snapshotCurrentStyles(){for(let[n,i]of this._localTimelineStyles)this._pendingStyles.set(n,i),this._updateStyle(n,i)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let i in this._currentKeyframe)n.push(i);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((i,a)=>{const h=this._styleSummary.get(a);(!h||i.time>h.time)&&this._updateStyle(a,i.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,i=new Set,a=1===this._keyframes.size&&0===this.duration;let h=[];this._keyframes.forEach((S,L)=>{const B=hw(S,new Map,this._backFill);B.forEach((H,Y)=>{"!"===H?n.add(Y):H===u0&&i.add(Y)}),a||B.set("offset",L/this.duration),h.push(B)});const _=n.size?KA(n.values()):[],x=i.size?KA(i.values()):[];if(a){const S=h[0],L=new Map(S);S.set("offset",0),L.set("offset",1),h=[S,L]}return U2(this.element,h,_,x,this.duration,this.startTime,this.easing,!1)}}class uV extends eD{constructor(n,i,a,h,_,x,S=!1){super(n,i,x.delay),this.keyframes=a,this.preStyleProps=h,this.postStyleProps=_,this._stretchStartingKeyframe=S,this.timings={duration:x.duration,delay:x.delay,easing:x.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:i,duration:a,easing:h}=this.timings;if(this._stretchStartingKeyframe&&i){const _=[],x=a+i,S=i/x,L=hw(n[0]);L.set("offset",0),_.push(L);const B=hw(n[0]);B.set("offset",cN(S)),_.push(B);const H=n.length-1;for(let Y=1;Y<=H;Y++){let pt=hw(n[Y]);const xt=pt.get("offset");pt.set("offset",cN((i+xt*a)/x)),_.push(pt)}a=x,i=0,h="",n=_}return U2(this.element,n,this.preStyleProps,this.postStyleProps,a,i,h,!0)}}function cN(o,n=3){const i=Math.pow(10,n-1);return Math.round(o*i)/i}class $2{}const hV=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class fV extends $2{normalizePropertyName(n,i){return F2(n)}normalizeStyleValue(n,i,a,h){let _="";const x=a.toString().trim();if(hV.has(i)&&0!==a&&"0"!==a)if("number"==typeof a)_="px";else{const S=a.match(/^[+-]?[\d\.]+([a-z]*)$/);S&&0==S[1].length&&h.push(function aU(o,n){return new M.vHH(3005,!1)}())}return x+_}}function uN(o,n,i,a,h,_,x,S,L,B,H,Y,pt){return{type:0,element:o,triggerName:n,isRemovalTransition:h,fromState:i,fromStyles:_,toState:a,toStyles:x,timelines:S,queriedElements:L,preStyleProps:B,postStyleProps:H,totalTime:Y,errors:pt}}const G2={};class dN{constructor(n,i,a){this._triggerName=n,this.ast=i,this._stateStyles=a}match(n,i,a,h){return function pV(o,n,i,a,h){return o.some(_=>_(n,i,a,h))}(this.ast.matchers,n,i,a,h)}buildStyles(n,i,a){let h=this._stateStyles.get("*");return void 0!==n&&(h=this._stateStyles.get(n?.toString())||h),h?h.buildStyles(i,a):new Map}build(n,i,a,h,_,x,S,L,B,H){const Y=[],pt=this.ast.options&&this.ast.options.params||G2,At=this.buildStyles(a,S&&S.params||G2,Y),Ut=L&&L.params||G2,Zt=this.buildStyles(h,Ut,Y),qe=new Set,fn=new Map,$e=new Map,cn="void"===h,Mr={params:gV(Ut,pt),delay:this.ast.options?.delay},Cr=H?[]:V2(n,i,this.ast.animation,_,x,At,Zt,Mr,B,Y);let Bi=0;if(Cr.forEach(iu=>{Bi=Math.max(iu.duration+iu.delay,Bi)}),Y.length)return uN(i,this._triggerName,a,h,cn,At,Zt,[],[],fn,$e,Bi,Y);Cr.forEach(iu=>{const h0=iu.element,EN=Uf(fn,h0,new Set);iu.preStyleProps.forEach(QM=>EN.add(QM));const PS=Uf($e,h0,new Set);iu.postStyleProps.forEach(QM=>PS.add(QM)),h0!==i&&qe.add(h0)});const ks=KA(qe.values());return uN(i,this._triggerName,a,h,cn,At,Zt,Cr,ks,fn,$e,Bi)}}function gV(o,n){const i=xS(n);for(const a in o)o.hasOwnProperty(a)&&null!=o[a]&&(i[a]=o[a]);return i}class mV{constructor(n,i,a){this.styles=n,this.defaultParams=i,this.normalizer=a}buildStyles(n,i){const a=new Map,h=xS(this.defaultParams);return Object.keys(n).forEach(_=>{const x=n[_];null!==x&&(h[_]=x)}),this.styles.styles.forEach(_=>{"string"!=typeof _&&_.forEach((x,S)=>{x&&(x=CS(x,h,i));const L=this.normalizer.normalizePropertyName(S,i);x=this.normalizer.normalizeStyleValue(S,L,x,i),a.set(S,x)})}),a}}class yV{constructor(n,i,a){this.name=n,this.ast=i,this._normalizer=a,this.transitionFactories=[],this.states=new Map,i.states.forEach(h=>{this.states.set(h.name,new mV(h.style,h.options&&h.options.params||{},a))}),hN(this.states,"true","1"),hN(this.states,"false","0"),i.transitions.forEach(h=>{this.transitionFactories.push(new dN(n,h,this.states))}),this.fallbackTransition=function vV(o,n,i){return new dN(o,{type:1,animation:{type:2,steps:[],options:null},matchers:[(x,S)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,i,a,h){return this.transitionFactories.find(x=>x.match(n,i,a,h))||null}matchStyles(n,i,a){return this.fallbackTransition.buildStyles(n,i,a)}}function hN(o,n,i){o.has(n)?o.has(i)||o.set(i,o.get(n)):o.has(i)&&o.set(n,o.get(i))}const bV=new JA;class xV{constructor(n,i,a){this.bodyNode=n,this._driver=i,this._normalizer=a,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,i){const a=[],_=z2(this._driver,i,a,[]);if(a.length)throw function PU(o){return new M.vHH(3503,!1)}();this._animations.set(n,_)}_buildPlayer(n,i,a){const h=n.element,_=WL(this._normalizer,n.keyframes,i,a);return this._driver.animate(h,_,n.duration,n.delay,n.easing,[],!0)}create(n,i,a={}){const h=[],_=this._animations.get(n);let x;const S=new Map;if(_?(x=V2(this._driver,i,_,k2,HA,new Map,new Map,a,bV,h),x.forEach(H=>{const Y=Uf(S,H.element,new Map);H.postStyleProps.forEach(pt=>Y.set(pt,null))})):(h.push(function EU(){return new M.vHH(3300,!1)}()),x=[]),h.length)throw function OU(o){return new M.vHH(3504,!1)}();S.forEach((H,Y)=>{H.forEach((pt,xt)=>{H.set(xt,this._driver.computeStyle(Y,xt,u0))})});const B=dw(x.map(H=>{const Y=S.get(H.element);return this._buildPlayer(H,new Map,Y)}));return this._playersById.set(n,B),B.onDestroy(()=>this.destroy(n)),this.players.push(B),B}destroy(n){const i=this._getPlayer(n);i.destroy(),this._playersById.delete(n);const a=this.players.indexOf(i);a>=0&&this.players.splice(a,1)}_getPlayer(n){const i=this._playersById.get(n);if(!i)throw function TU(o){return new M.vHH(3301,!1)}();return i}listen(n,i,a,h){const _=S2(i,"","","");return T2(this._getPlayer(n),a,_,h),()=>{}}command(n,i,a,h){if("register"==a)return void this.register(n,h[0]);if("create"==a)return void this.create(n,i,h[0]||{});const _=this._getPlayer(n);switch(a){case"play":_.play();break;case"pause":_.pause();break;case"reset":_.reset();break;case"restart":_.restart();break;case"finish":_.finish();break;case"init":_.init();break;case"setPosition":_.setPosition(parseFloat(h[0]));break;case"destroy":this.destroy(n)}}}const fN="ng-animate-queued",H2="ng-animate-disabled",EV=[],pN={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},OV={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Bm="__ng_removed";class q2{get params(){return this.options.params}constructor(n,i=""){this.namespaceId=i;const a=n&&n.hasOwnProperty("value");if(this.value=function AV(o){return o??null}(a?n.value:n),a){const _=xS(n);delete _.value,this.options=_}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const i=n.params;if(i){const a=this.options.params;Object.keys(i).forEach(h=>{null==a[h]&&(a[h]=i[h])})}}}const MS="void",Z2=new q2(MS);class TV{constructor(n,i,a){this.id=n,this.hostElement=i,this._engine=a,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,og(i,this._hostClassName)}listen(n,i,a,h){if(!this._triggers.has(i))throw function IU(o,n){return new M.vHH(3302,!1)}();if(null==a||0==a.length)throw function SU(o){return new M.vHH(3303,!1)}();if(!function DV(o){return"start"==o||"done"==o}(a))throw function AU(o,n){return new M.vHH(3400,!1)}();const _=Uf(this._elementListeners,n,[]),x={name:i,phase:a,callback:h};_.push(x);const S=Uf(this._engine.statesByElement,n,new Map);return S.has(i)||(og(n,qA),og(n,qA+"-"+i),S.set(i,Z2)),()=>{this._engine.afterFlush(()=>{const L=_.indexOf(x);L>=0&&_.splice(L,1),this._triggers.has(i)||S.delete(i)})}}register(n,i){return!this._triggers.has(n)&&(this._triggers.set(n,i),!0)}_getTrigger(n){const i=this._triggers.get(n);if(!i)throw function DU(o){return new M.vHH(3401,!1)}();return i}trigger(n,i,a,h=!0){const _=this._getTrigger(i),x=new W2(this.id,i,n);let S=this._engine.statesByElement.get(n);S||(og(n,qA),og(n,qA+"-"+i),this._engine.statesByElement.set(n,S=new Map));let L=S.get(i);const B=new q2(a,this.id);if(!(a&&a.hasOwnProperty("value"))&&L&&B.absorbOptions(L.options),S.set(i,B),L||(L=Z2),B.value!==MS&&L.value===B.value){if(!function LV(o,n){const i=Object.keys(o),a=Object.keys(n);if(i.length!=a.length)return!1;for(let h=0;h<i.length;h++){const _=i[h];if(!n.hasOwnProperty(_)||o[_]!==n[_])return!1}return!0}(L.params,B.params)){const Ut=[],Zt=_.matchStyles(L.value,L.params,Ut),qe=_.matchStyles(B.value,B.params,Ut);Ut.length?this._engine.reportError(Ut):this._engine.afterFlush(()=>{YM(n,Zt),$y(n,qe)})}return}const pt=Uf(this._engine.playersByElement,n,[]);pt.forEach(Ut=>{Ut.namespaceId==this.id&&Ut.triggerName==i&&Ut.queued&&Ut.destroy()});let xt=_.matchTransition(L.value,B.value,n,B.params),At=!1;if(!xt){if(!h)return;xt=_.fallbackTransition,At=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:i,transition:xt,fromState:L,toState:B,player:x,isFallbackTransition:At}),At||(og(n,fN),x.onStart(()=>{dT(n,fN)})),x.onDone(()=>{let Ut=this.players.indexOf(x);Ut>=0&&this.players.splice(Ut,1);const Zt=this._engine.playersByElement.get(n);if(Zt){let qe=Zt.indexOf(x);qe>=0&&Zt.splice(qe,1)}}),this.players.push(x),pt.push(x),x}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(i=>i.delete(n)),this._elementListeners.forEach((i,a)=>{this._elementListeners.set(a,i.filter(h=>h.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const i=this._engine.playersByElement.get(n);i&&(i.forEach(a=>a.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,i){const a=this._engine.driver.query(n,ZA,!0);a.forEach(h=>{if(h[Bm])return;const _=this._engine.fetchNamespacesByElement(h);_.size?_.forEach(x=>x.triggerLeaveAnimation(h,i,!1,!0)):this.clearElementCache(h)}),this._engine.afterFlushAnimationsDone(()=>a.forEach(h=>this.clearElementCache(h)))}triggerLeaveAnimation(n,i,a,h){const _=this._engine.statesByElement.get(n),x=new Map;if(_){const S=[];if(_.forEach((L,B)=>{if(x.set(B,L.value),this._triggers.has(B)){const H=this.trigger(n,B,MS,h);H&&S.push(H)}}),S.length)return this._engine.markElementAsRemoved(this.id,n,!0,i,x),a&&dw(S).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const i=this._elementListeners.get(n),a=this._engine.statesByElement.get(n);if(i&&a){const h=new Set;i.forEach(_=>{const x=_.name;if(h.has(x))return;h.add(x);const L=this._triggers.get(x).fallbackTransition,B=a.get(x)||Z2,H=new q2(MS),Y=new W2(this.id,x,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:x,transition:L,fromState:B,toState:H,player:Y,isFallbackTransition:!0})})}}removeNode(n,i){const a=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,i),this.triggerLeaveAnimation(n,i,!0))return;let h=!1;if(a.totalAnimations){const _=a.players.length?a.playersByQueriedElement.get(n):[];if(_&&_.length)h=!0;else{let x=n;for(;x=x.parentNode;)if(a.statesByElement.get(x)){h=!0;break}}}if(this.prepareLeaveAnimationListeners(n),h)a.markElementAsRemoved(this.id,n,!1,i);else{const _=n[Bm];(!_||_===pN)&&(a.afterFlush(()=>this.clearElementCache(n)),a.destroyInnerAnimations(n),a._onRemovalComplete(n,i))}}insertNode(n,i){og(n,this._hostClassName)}drainQueuedTransitions(n){const i=[];return this._queue.forEach(a=>{const h=a.player;if(h.destroyed)return;const _=a.element,x=this._elementListeners.get(_);x&&x.forEach(S=>{if(S.name==a.triggerName){const L=S2(_,a.triggerName,a.fromState.value,a.toState.value);L._data=n,T2(a.player,S.phase,L,S.callback)}}),h.markedForDestroy?this._engine.afterFlush(()=>{h.destroy()}):i.push(a)}),this._queue=[],i.sort((a,h)=>{const _=a.transition.ast.depCount,x=h.transition.ast.depCount;return 0==_||0==x?_-x:this._engine.driver.containsElement(a.element,h.element)?1:-1})}destroy(n){this.players.forEach(i=>i.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class IV{_onRemovalComplete(n,i){this.onRemovalComplete(n,i)}constructor(n,i,a){this.bodyNode=n,this.driver=i,this._normalizer=a,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(h,_)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(i=>{i.players.forEach(a=>{a.queued&&n.push(a)})}),n}createNamespace(n,i){const a=new TV(n,i,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,i)?this._balanceNamespaceList(a,i):(this.newHostElements.set(i,a),this.collectEnterElement(i)),this._namespaceLookup[n]=a}_balanceNamespaceList(n,i){const a=this._namespaceList,h=this.namespacesByHostElement;if(a.length-1>=0){let x=!1,S=this.driver.getParentElement(i);for(;S;){const L=h.get(S);if(L){const B=a.indexOf(L);a.splice(B+1,0,n),x=!0;break}S=this.driver.getParentElement(S)}x||a.unshift(n)}else a.push(n);return h.set(i,n),n}register(n,i){let a=this._namespaceLookup[n];return a||(a=this.createNamespace(n,i)),a}registerTrigger(n,i,a){let h=this._namespaceLookup[n];h&&h.register(i,a)&&this.totalAnimations++}destroy(n,i){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const a=this._fetchNamespace(n);this.namespacesByHostElement.delete(a.hostElement);const h=this._namespaceList.indexOf(a);h>=0&&this._namespaceList.splice(h,1),a.destroy(i),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const i=new Set,a=this.statesByElement.get(n);if(a)for(let h of a.values())if(h.namespaceId){const _=this._fetchNamespace(h.namespaceId);_&&i.add(_)}return i}trigger(n,i,a,h){if(nD(i)){const _=this._fetchNamespace(n);if(_)return _.trigger(i,a,h),!0}return!1}insertNode(n,i,a,h){if(!nD(i))return;const _=i[Bm];if(_&&_.setForRemoval){_.setForRemoval=!1,_.setForMove=!0;const x=this.collectedLeaveElements.indexOf(i);x>=0&&this.collectedLeaveElements.splice(x,1)}if(n){const x=this._fetchNamespace(n);x&&x.insertNode(i,a)}h&&this.collectEnterElement(i)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,i){i?this.disabledNodes.has(n)||(this.disabledNodes.add(n),og(n,H2)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),dT(n,H2))}removeNode(n,i,a){if(nD(i)){const h=n?this._fetchNamespace(n):null;h?h.removeNode(i,a):this.markElementAsRemoved(n,i,!1,a);const _=this.namespacesByHostElement.get(i);_&&_.id!==n&&_.removeNode(i,a)}else this._onRemovalComplete(i,a)}markElementAsRemoved(n,i,a,h,_){this.collectedLeaveElements.push(i),i[Bm]={namespaceId:n,setForRemoval:h,hasAnimation:a,removedBeforeQueried:!1,previousTriggersValues:_}}listen(n,i,a,h,_){return nD(i)?this._fetchNamespace(n).listen(i,a,h,_):()=>{}}_buildInstruction(n,i,a,h,_){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,a,h,n.fromState.options,n.toState.options,i,_)}destroyInnerAnimations(n){let i=this.driver.query(n,ZA,!0);i.forEach(a=>this.destroyActiveAnimationsForElement(a)),0!=this.playersByQueriedElement.size&&(i=this.driver.query(n,R2,!0),i.forEach(a=>this.finishActiveQueriedAnimationOnElement(a)))}destroyActiveAnimationsForElement(n){const i=this.playersByElement.get(n);i&&i.forEach(a=>{a.queued?a.markedForDestroy=!0:a.destroy()})}finishActiveQueriedAnimationOnElement(n){const i=this.playersByQueriedElement.get(n);i&&i.forEach(a=>a.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return dw(this.players).onDone(()=>n());n()})}processLeaveNode(n){const i=n[Bm];if(i&&i.setForRemoval){if(n[Bm]=pN,i.namespaceId){this.destroyInnerAnimations(n);const a=this._fetchNamespace(i.namespaceId);a&&a.clearElementCache(n)}this._onRemovalComplete(n,i.setForRemoval)}n.classList?.contains(H2)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(a=>{this.markElementAsDisabled(a,!1)})}flush(n=-1){let i=[];if(this.newHostElements.size&&(this.newHostElements.forEach((a,h)=>this._balanceNamespaceList(a,h)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let a=0;a<this.collectedEnterElements.length;a++)og(this.collectedEnterElements[a],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const a=[];try{i=this._flushAnimations(a,n)}finally{for(let h=0;h<a.length;h++)a[h]()}}else for(let a=0;a<this.collectedLeaveElements.length;a++)this.processLeaveNode(this.collectedLeaveElements[a]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(a=>a()),this._flushFns=[],this._whenQuietFns.length){const a=this._whenQuietFns;this._whenQuietFns=[],i.length?dw(i).onDone(()=>{a.forEach(h=>h())}):a.forEach(h=>h())}}reportError(n){throw function kU(o){return new M.vHH(3402,!1)}()}_flushAnimations(n,i){const a=new JA,h=[],_=new Map,x=[],S=new Map,L=new Map,B=new Map,H=new Set;this.disabledNodes.forEach(Qn=>{H.add(Qn);const Er=this.driver.query(Qn,".ng-animate-queued",!0);for(let jr=0;jr<Er.length;jr++)H.add(Er[jr])});const Y=this.bodyNode,pt=Array.from(this.statesByElement.keys()),xt=_N(pt,this.collectedEnterElements),At=new Map;let Ut=0;xt.forEach((Qn,Er)=>{const jr=k2+Ut++;At.set(Er,jr),Qn.forEach(eo=>og(eo,jr))});const Zt=[],qe=new Set,fn=new Set;for(let Qn=0;Qn<this.collectedLeaveElements.length;Qn++){const Er=this.collectedLeaveElements[Qn],jr=Er[Bm];jr&&jr.setForRemoval&&(Zt.push(Er),qe.add(Er),jr.hasAnimation?this.driver.query(Er,".ng-star-inserted",!0).forEach(eo=>qe.add(eo)):fn.add(Er))}const $e=new Map,cn=_N(pt,Array.from(qe));cn.forEach((Qn,Er)=>{const jr=HA+Ut++;$e.set(Er,jr),Qn.forEach(eo=>og(eo,jr))}),n.push(()=>{xt.forEach((Qn,Er)=>{const jr=At.get(Er);Qn.forEach(eo=>dT(eo,jr))}),cn.forEach((Qn,Er)=>{const jr=$e.get(Er);Qn.forEach(eo=>dT(eo,jr))}),Zt.forEach(Qn=>{this.processLeaveNode(Qn)})});const Mr=[],Cr=[];for(let Qn=this._namespaceList.length-1;Qn>=0;Qn--)this._namespaceList[Qn].drainQueuedTransitions(i).forEach(jr=>{const eo=jr.player,Nl=jr.element;if(Mr.push(eo),this.collectedEnterElements.length){const ou=Nl[Bm];if(ou&&ou.setForMove){if(ou.previousTriggersValues&&ou.previousTriggersValues.has(jr.triggerName)){const JM=ou.previousTriggersValues.get(jr.triggerName),sg=this.statesByElement.get(jr.element);if(sg&&sg.has(jr.triggerName)){const oD=sg.get(jr.triggerName);oD.value=JM,sg.set(jr.triggerName,oD)}}return void eo.destroy()}}const Gy=!Y||!this.driver.containsElement(Y,Nl),jf=$e.get(Nl),fw=At.get(Nl),Hs=this._buildInstruction(jr,a,fw,jf,Gy);if(Hs.errors&&Hs.errors.length)return void Cr.push(Hs);if(Gy)return eo.onStart(()=>YM(Nl,Hs.fromStyles)),eo.onDestroy(()=>$y(Nl,Hs.toStyles)),void h.push(eo);if(jr.isFallbackTransition)return eo.onStart(()=>YM(Nl,Hs.fromStyles)),eo.onDestroy(()=>$y(Nl,Hs.toStyles)),void h.push(eo);const IN=[];Hs.timelines.forEach(ou=>{ou.stretchStartingKeyframe=!0,this.disabledNodes.has(ou.element)||IN.push(ou)}),Hs.timelines=IN,a.append(Nl,Hs.timelines),x.push({instruction:Hs,player:eo,element:Nl}),Hs.queriedElements.forEach(ou=>Uf(S,ou,[]).push(eo)),Hs.preStyleProps.forEach((ou,JM)=>{if(ou.size){let sg=L.get(JM);sg||L.set(JM,sg=new Set),ou.forEach((oD,X2)=>sg.add(X2))}}),Hs.postStyleProps.forEach((ou,JM)=>{let sg=B.get(JM);sg||B.set(JM,sg=new Set),ou.forEach((oD,X2)=>sg.add(X2))})});if(Cr.length){const Qn=[];Cr.forEach(Er=>{Qn.push(function RU(o,n){return new M.vHH(3505,!1)}())}),Mr.forEach(Er=>Er.destroy()),this.reportError(Qn)}const Bi=new Map,ks=new Map;x.forEach(Qn=>{const Er=Qn.element;a.has(Er)&&(ks.set(Er,Er),this._beforeAnimationBuild(Qn.player.namespaceId,Qn.instruction,Bi))}),h.forEach(Qn=>{const Er=Qn.element;this._getPreviousPlayers(Er,!1,Qn.namespaceId,Qn.triggerName,null).forEach(eo=>{Uf(Bi,Er,[]).push(eo),eo.destroy()})});const iu=Zt.filter(Qn=>vN(Qn,L,B)),h0=new Map;mN(h0,this.driver,fn,B,u0).forEach(Qn=>{vN(Qn,L,B)&&iu.push(Qn)});const PS=new Map;xt.forEach((Qn,Er)=>{mN(PS,this.driver,new Set(Qn),L,"!")}),iu.forEach(Qn=>{const Er=h0.get(Qn),jr=PS.get(Qn);h0.set(Qn,new Map([...Er?.entries()??[],...jr?.entries()??[]]))});const QM=[],ON=[],TN={};x.forEach(Qn=>{const{element:Er,player:jr,instruction:eo}=Qn;if(a.has(Er)){if(H.has(Er))return jr.onDestroy(()=>$y(Er,eo.toStyles)),jr.disabled=!0,jr.overrideTotalTime(eo.totalTime),void h.push(jr);let Nl=TN;if(ks.size>1){let jf=Er;const fw=[];for(;jf=jf.parentNode;){const Hs=ks.get(jf);if(Hs){Nl=Hs;break}fw.push(jf)}fw.forEach(Hs=>ks.set(Hs,Nl))}const Gy=this._buildAnimation(jr.namespaceId,eo,Bi,_,PS,h0);if(jr.setRealPlayer(Gy),Nl===TN)QM.push(jr);else{const jf=this.playersByElement.get(Nl);jf&&jf.length&&(jr.parentPlayer=dw(jf)),h.push(jr)}}else YM(Er,eo.fromStyles),jr.onDestroy(()=>$y(Er,eo.toStyles)),ON.push(jr),H.has(Er)&&h.push(jr)}),ON.forEach(Qn=>{const Er=_.get(Qn.element);if(Er&&Er.length){const jr=dw(Er);Qn.setRealPlayer(jr)}}),h.forEach(Qn=>{Qn.parentPlayer?Qn.syncPlayerEvents(Qn.parentPlayer):Qn.destroy()});for(let Qn=0;Qn<Zt.length;Qn++){const Er=Zt[Qn],jr=Er[Bm];if(dT(Er,HA),jr&&jr.hasAnimation)continue;let eo=[];if(S.size){let Gy=S.get(Er);Gy&&Gy.length&&eo.push(...Gy);let jf=this.driver.query(Er,R2,!0);for(let fw=0;fw<jf.length;fw++){let Hs=S.get(jf[fw]);Hs&&Hs.length&&eo.push(...Hs)}}const Nl=eo.filter(Gy=>!Gy.destroyed);Nl.length?kV(this,Er,Nl):this.processLeaveNode(Er)}return Zt.length=0,QM.forEach(Qn=>{this.players.push(Qn),Qn.onDone(()=>{Qn.destroy();const Er=this.players.indexOf(Qn);this.players.splice(Er,1)}),Qn.play()}),QM}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,i,a,h,_){let x=[];if(i){const S=this.playersByQueriedElement.get(n);S&&(x=S)}else{const S=this.playersByElement.get(n);if(S){const L=!_||_==MS;S.forEach(B=>{B.queued||!L&&B.triggerName!=h||x.push(B)})}}return(a||h)&&(x=x.filter(S=>!(a&&a!=S.namespaceId||h&&h!=S.triggerName))),x}_beforeAnimationBuild(n,i,a){const _=i.element,x=i.isRemovalTransition?void 0:n,S=i.isRemovalTransition?void 0:i.triggerName;for(const L of i.timelines){const B=L.element,H=B!==_,Y=Uf(a,B,[]);this._getPreviousPlayers(B,H,x,S,i.toState).forEach(xt=>{const At=xt.getRealPlayer();At.beforeDestroy&&At.beforeDestroy(),xt.destroy(),Y.push(xt)})}YM(_,i.fromStyles)}_buildAnimation(n,i,a,h,_,x){const S=i.triggerName,L=i.element,B=[],H=new Set,Y=new Set,pt=i.timelines.map(At=>{const Ut=At.element;H.add(Ut);const Zt=Ut[Bm];if(Zt&&Zt.removedBeforeQueried)return new bS(At.duration,At.delay);const qe=Ut!==L,fn=function RV(o){const n=[];return yN(o,n),n}((a.get(Ut)||EV).map(Bi=>Bi.getRealPlayer())).filter(Bi=>!!Bi.element&&Bi.element===Ut),$e=_.get(Ut),cn=x.get(Ut),Mr=WL(this._normalizer,At.keyframes,$e,cn),Cr=this._buildPlayer(At,Mr,fn);if(At.subTimeline&&h&&Y.add(Ut),qe){const Bi=new W2(n,S,Ut);Bi.setRealPlayer(Cr),B.push(Bi)}return Cr});B.forEach(At=>{Uf(this.playersByQueriedElement,At.element,[]).push(At),At.onDone(()=>function SV(o,n,i){let a=o.get(n);if(a){if(a.length){const h=a.indexOf(i);a.splice(h,1)}0==a.length&&o.delete(n)}return a}(this.playersByQueriedElement,At.element,At))}),H.forEach(At=>og(At,eN));const xt=dw(pt);return xt.onDestroy(()=>{H.forEach(At=>dT(At,eN)),$y(L,i.toStyles)}),Y.forEach(At=>{Uf(h,At,[]).push(xt)}),xt}_buildPlayer(n,i,a){return i.length>0?this.driver.animate(n.element,i,n.duration,n.delay,n.easing,a):new bS(n.duration,n.delay)}}class W2{constructor(n,i,a){this.namespaceId=n,this.triggerName=i,this.element=a,this._player=new bS,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((i,a)=>{i.forEach(h=>T2(n,a,void 0,h))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const i=this._player;i.triggerCallback&&n.onStart(()=>i.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,i){Uf(this._queuedCallbacks,n,[]).push(i)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const i=this._player;i.triggerCallback&&i.triggerCallback(n)}}function nD(o){return o&&1===o.nodeType}function gN(o,n){const i=o.style.display;return o.style.display=n??"none",i}function mN(o,n,i,a,h){const _=[];i.forEach(L=>_.push(gN(L)));const x=[];a.forEach((L,B)=>{const H=new Map;L.forEach(Y=>{const pt=n.computeStyle(B,Y,h);H.set(Y,pt),(!pt||0==pt.length)&&(B[Bm]=OV,x.push(B))}),o.set(B,H)});let S=0;return i.forEach(L=>gN(L,_[S++])),x}function _N(o,n){const i=new Map;if(o.forEach(S=>i.set(S,[])),0==n.length)return i;const h=new Set(n),_=new Map;function x(S){if(!S)return 1;let L=_.get(S);if(L)return L;const B=S.parentNode;return L=i.has(B)?B:h.has(B)?1:x(B),_.set(S,L),L}return n.forEach(S=>{const L=x(S);1!==L&&i.get(L).push(S)}),i}function og(o,n){o.classList?.add(n)}function dT(o,n){o.classList?.remove(n)}function kV(o,n,i){dw(i).onDone(()=>o.processLeaveNode(n))}function yN(o,n){for(let i=0;i<o.length;i++){const a=o[i];a instanceof qL?yN(a.players,n):n.push(a)}}function vN(o,n,i){const a=i.get(o);if(!a)return!1;let h=n.get(o);return h?a.forEach(_=>h.add(_)):n.set(o,a),i.delete(o),!0}class rD{constructor(n,i,a){this.bodyNode=n,this._driver=i,this._normalizer=a,this._triggerCache={},this.onRemovalComplete=(h,_)=>{},this._transitionEngine=new IV(n,i,a),this._timelineEngine=new xV(n,i,a),this._transitionEngine.onRemovalComplete=(h,_)=>this.onRemovalComplete(h,_)}registerTrigger(n,i,a,h,_){const x=n+"-"+h;let S=this._triggerCache[x];if(!S){const L=[],H=z2(this._driver,_,L,[]);if(L.length)throw function CU(o,n){return new M.vHH(3404,!1)}();S=function _V(o,n,i){return new yV(o,n,i)}(h,H,this._normalizer),this._triggerCache[x]=S}this._transitionEngine.registerTrigger(i,h,S)}register(n,i){this._transitionEngine.register(n,i)}destroy(n,i){this._transitionEngine.destroy(n,i)}onInsert(n,i,a,h){this._transitionEngine.insertNode(n,i,a,h)}onRemove(n,i,a){this._transitionEngine.removeNode(n,i,a)}disableAnimations(n,i){this._transitionEngine.markElementAsDisabled(n,i)}process(n,i,a,h){if("@"==a.charAt(0)){const[_,x]=KL(a);this._timelineEngine.command(_,i,x,h)}else this._transitionEngine.trigger(n,i,a,h)}listen(n,i,a,h,_){if("@"==a.charAt(0)){const[x,S]=KL(a);return this._timelineEngine.listen(x,i,S,_)}return this._transitionEngine.listen(n,i,a,h,_)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}let FV=(()=>{class o{static#t=this.initialStylesByElement=new WeakMap;constructor(i,a,h){this._element=i,this._startStyles=a,this._endStyles=h,this._state=0;let _=o.initialStylesByElement.get(i);_||o.initialStylesByElement.set(i,_=new Map),this._initialStyles=_}start(){this._state<1&&(this._startStyles&&$y(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&($y(this._element,this._initialStyles),this._endStyles&&($y(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(o.initialStylesByElement.delete(this._element),this._startStyles&&(YM(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(YM(this._element,this._endStyles),this._endStyles=null),$y(this._element,this._initialStyles),this._state=3)}}return o})();function K2(o){let n=null;return o.forEach((i,a)=>{(function zV(o){return"display"===o||"position"===o})(a)&&(n=n||new Map,n.set(a,i))}),n}class bN{constructor(n,i,a,h){this.element=n,this.keyframes=i,this.options=a,this._specialStyles=h,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=a.duration,this._delay=a.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map;const i=()=>this._onFinish();this.domPlayer.addEventListener("finish",i),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",i)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const i=[];return n.forEach(a=>{i.push(Object.fromEntries(a))}),i}_triggerWebAnimation(n,i,a){return n.animate(this._convertKeyframesToObject(i),a)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((a,h)=>{"offset"!==h&&n.set(h,this._finished?a:oN(this.element,h))}),this.currentSnapshot=n}triggerCallback(n){const i="start"===n?this._onStartFns:this._onDoneFns;i.forEach(a=>a()),i.length=0}}class BV{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,i){return!1}containsElement(n,i){return XL(n,i)}getParentElement(n){return A2(n)}query(n,i,a){return QL(n,i,a)}computeStyle(n,i,a){return window.getComputedStyle(n)[i]}animate(n,i,a,h,_,x=[]){const L={duration:a,delay:h,fill:0==h?"both":"forwards"};_&&(L.easing=_);const B=new Map,H=x.filter(xt=>xt instanceof bN);(function qU(o,n){return 0===o||0===n})(a,h)&&H.forEach(xt=>{xt.currentSnapshot.forEach((At,Ut)=>B.set(Ut,At))});let Y=function $U(o){return o.length?o[0]instanceof Map?o:o.map(n=>nN(n)):[]}(i).map(xt=>hw(xt));Y=function ZU(o,n,i){if(i.size&&n.length){let a=n[0],h=[];if(i.forEach((_,x)=>{a.has(x)||h.push(x),a.set(x,_)}),h.length)for(let _=1;_<n.length;_++){let x=n[_];h.forEach(S=>x.set(S,oN(o,S)))}}return n}(n,Y,B);const pt=function NV(o,n){let i=null,a=null;return Array.isArray(n)&&n.length?(i=K2(n[0]),n.length>1&&(a=K2(n[n.length-1]))):n instanceof Map&&(i=K2(n)),i||a?new FV(o,i,a):null}(n,Y);return new bN(n,Y,L,pt)}}let UV=(()=>{class o extends $L{constructor(i,a){super(),this._nextAnimationId=0,this._renderer=i.createRenderer(a.body,{id:"0",encapsulation:M.ifc.None,styles:[],data:{animation:[]}})}build(i){const a=this._nextAnimationId.toString();this._nextAnimationId++;const h=Array.isArray(i)?GL(i):i;return xN(this._renderer,null,a,"register",[h]),new VV(a,this._renderer)}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(M.FYo),M.LFG(ye))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();class VV extends eU{constructor(n,i){super(),this._id=n,this._renderer=i}create(n,i){return new jV(this._id,n,i||{},this._renderer)}}class jV{constructor(n,i,a,h){this.id=n,this.element=i,this._renderer=h,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",a)}_listen(n,i){return this._renderer.listen(this.element,`@@${this.id}:${n}`,i)}_command(n,...i){return xN(this._renderer,this.element,this.id,n,i)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function xN(o,n,i,a,h){return o.setProperty(n,`@@${i}:${a}`,h)}const wN="@.disabled";let $V=(()=>{class o{constructor(i,a,h){this.delegate=i,this.engine=a,this._zone=h,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,a.onRemovalComplete=(_,x)=>{const S=x?.parentNode(_);S&&x.removeChild(S,_)}}createRenderer(i,a){const _=this.delegate.createRenderer(i,a);if(!(i&&a&&a.data&&a.data.animation)){let H=this._rendererCache.get(_);return H||(H=new CN("",_,this.engine,()=>this._rendererCache.delete(_)),this._rendererCache.set(_,H)),H}const x=a.id,S=a.id+"-"+this._currentId;this._currentId++,this.engine.register(S,i);const L=H=>{Array.isArray(H)?H.forEach(L):this.engine.registerTrigger(x,S,i,H.name,H)};return a.data.animation.forEach(L),new GV(this,S,_,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(i,a,h){i>=0&&i<this._microtaskId?this._zone.run(()=>a(h)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(_=>{const[x,S]=_;x(S)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([a,h]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(M.FYo),M.LFG(rD),M.LFG(M.R0b))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();class CN{constructor(n,i,a,h){this.namespaceId=n,this.delegate=i,this.engine=a,this._onDestroy=h}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,i){return this.delegate.createElement(n,i)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,i){this.delegate.appendChild(n,i),this.engine.onInsert(this.namespaceId,i,n,!1)}insertBefore(n,i,a,h=!0){this.delegate.insertBefore(n,i,a),this.engine.onInsert(this.namespaceId,i,n,h)}removeChild(n,i,a){this.engine.onRemove(this.namespaceId,i,this.delegate)}selectRootElement(n,i){return this.delegate.selectRootElement(n,i)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,i,a,h){this.delegate.setAttribute(n,i,a,h)}removeAttribute(n,i,a){this.delegate.removeAttribute(n,i,a)}addClass(n,i){this.delegate.addClass(n,i)}removeClass(n,i){this.delegate.removeClass(n,i)}setStyle(n,i,a,h){this.delegate.setStyle(n,i,a,h)}removeStyle(n,i,a){this.delegate.removeStyle(n,i,a)}setProperty(n,i,a){"@"==i.charAt(0)&&i==wN?this.disableAnimations(n,!!a):this.delegate.setProperty(n,i,a)}setValue(n,i){this.delegate.setValue(n,i)}listen(n,i,a){return this.delegate.listen(n,i,a)}disableAnimations(n,i){this.engine.disableAnimations(n,i)}}class GV extends CN{constructor(n,i,a,h,_){super(i,a,h,_),this.factory=n,this.namespaceId=i}setProperty(n,i,a){"@"==i.charAt(0)?"."==i.charAt(1)&&i==wN?this.disableAnimations(n,a=void 0===a||!!a):this.engine.process(this.namespaceId,n,i.slice(1),a):this.delegate.setProperty(n,i,a)}listen(n,i,a){if("@"==i.charAt(0)){const h=function HV(o){switch(o){case"body":return document.body;case"document":return document;case"window":return window;default:return o}}(n);let _=i.slice(1),x="";return"@"!=_.charAt(0)&&([_,x]=function qV(o){const n=o.indexOf(".");return[o.substring(0,n),o.slice(n+1)]}(_)),this.engine.listen(this.namespaceId,h,_,x,S=>{this.factory.scheduleListenerCallback(S._data||-1,a,S)})}return this.delegate.listen(n,i,a)}}let ZV=(()=>{class o extends rD{constructor(i,a,h,_){super(i.body,a,h)}ngOnDestroy(){this.flush()}static#t=this.\u0275fac=function(a){return new(a||o)(M.LFG(ye),M.LFG(D2),M.LFG($2),M.LFG(M.z2F))};static#e=this.\u0275prov=M.Yz7({token:o,factory:o.\u0275fac})}return o})();const MN=[{provide:$L,useClass:UV},{provide:$2,useFactory:function WV(){return new fV}},{provide:rD,useClass:ZV},{provide:M.FYo,useFactory:function KV(o,n,i){return new $V(o,n,i)},deps:[Ah,rD,M.R0b]}],Y2=[{provide:D2,useFactory:()=>new BV},{provide:M.QbO,useValue:"BrowserAnimations"},...MN],PN=[{provide:D2,useClass:JL},{provide:M.QbO,useValue:"NoopAnimations"},...MN];let YV=(()=>{class o{static withConfig(i){return{ngModule:o,providers:i.disableAnimations?PN:Y2}}static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=M.oAB({type:o});static#n=this.\u0275inj=M.cJS({providers:Y2,imports:[xu]})}return o})(),XV=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#e=this.\u0275mod=M.oAB({type:o,bootstrap:[Q4]});static#n=this.\u0275inj=M.cJS({imports:[xu,X4,Lk,J4,tU,B3,Nk,bg(()=>Zl(pS_firebase)),Mo(()=>iP()),DM(()=>l()),Ma.hO.initializeApp(pS_firebase),YV]})}return o})();if(aL().accessToken="pk.eyJ1IjoibmFodW1sb3B6IiwiYSI6ImNsc3k2eGRlejBhYXIycm54YmxnaXlneTkifQ.wrnk_DcsIDYJ6a8OQSeE5Q",!navigator.geolocation)throw alert("Navegador no soporta el Geolocation"),new Error("Navegador no soporta el Geolocation");No().bootstrapModule(XV).catch(o=>console.error(o))},2574:function(Hn){Hn.exports=function(){"use strict";var we,ft,M;function mt(vt,lt){if(we)if(ft){var ye="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+we+")(sharedChunk); ("+ft+")(sharedChunk); self.onerror = null;",ke={};we(ke),M=lt(ke),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(M.workerUrl=window.URL.createObjectURL(new Blob([ye],{type:"text/javascript"})))}else ft=lt;else we=lt}return mt(0,function(vt){var lt=typeof self<"u"?self:{},ye="3.1.2";let ke;const ue={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==ke){const e=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{ke=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):e}catch{ke=e}}return ke},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ue.API_URL)return null;try{const e=new URL(ue.API_URL);return"api.mapbox.cn"===e.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===e.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},be={supported:!1,testSupport:function(e){!Yt&&Et&&(Le?re(e):Pt=e)}};let Pt,Et,Yt=!1,Le=!1;function re(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Et),e.isContextLost())return;be.supported=!0}catch{}e.deleteTexture(t),Yt=!0}lt.document&&(Et=lt.document.createElement("img"),Et.onload=function(){Pt&&re(Pt),Pt=null,Le=!0},Et.onerror=function(){Yt=!0,Pt=null},Et.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const tn="01";function We(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rn=Te;function Te(e,t,r,s){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(s-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=s}Te.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,s=0;s<8;s++){var c=this.sampleCurveX(r)-e;if(Math.abs(c)<t)return r;var d=this.sampleCurveDerivativeX(r);if(Math.abs(d)<1e-6)break;r-=c/d}var f=0,g=1;for(r=e,s=0;s<20&&(c=this.sampleCurveX(r),!(Math.abs(c-e)<t));s++)e>c?f=r:g=r,r=.5*(g-f)+f;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var Fn=We(rn),Ce=me;function me(e,t){this.x=e,this.y=t}me.prototype={clone:function(){return new me(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),s=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=s,this},_rotateAround:function(e,t){var r=Math.cos(e),s=Math.sin(e),c=t.y+s*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-s*(this.y-t.y),this.y=c,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},me.convert=function(e){return e instanceof me?e:Array.isArray(e)?new me(e[0],e[1]):e};var tt=We(Ce);function Xt(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!Xt(e[r],t[r]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!Xt(e[r],t[r]))return!1;return!0}return e===t}const Ve=Math.PI/180,Gt=180/Math.PI;function Ct(e){return e*Ve}function ge(e){return e*Gt}const en=[[0,0],[1,0],[1,1],[0,1]];function Ui(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function cs(e){let t=1/0,r=1/0,s=-1/0,c=-1/0;for(const d of e)t=Math.min(t,d.x),r=Math.min(r,d.y),s=Math.max(s,d.x),c=Math.max(c,d.y);return{min:new tt(t,r),max:new tt(s,c)}}function Go(e,t,r=0,s=!0){const c=new tt(r,r),d=e.sub(c),f=t.add(c),g=[d,new tt(f.x,d.y),f,new tt(d.x,f.y)];return s&&g.push(d.clone()),g}function us(e,t,r,s){const c=new Fn(e,t,r,s);return function(d){return c.solve(d)}}const Yr=us(.25,.1,.25,1);function Ne(e,t,r){return Math.min(r,Math.max(t,e))}function vs(e,t,r){return(r=Ne((r-e)/(t-e),0,1))*r*(3-2*r)}function Wt(e,t,r){const s=r-t,c=((e-t)%s+s)%s+t;return c===t?r:c}function Kt(e,t,r){if(!e.length)return r(null,[]);let s=e.length;const c=new Array(e.length);let d=null;e.forEach((f,g)=>{t(f,(y,b)=>{y&&(d=y),c[g]=b,0==--s&&r(d,c)})})}function pe(e){const t=[];for(const r in e)t.push(e[r]);return t}function _t(e,...t){for(const r of t)for(const s in r)e[s]=r[s];return e}function he(e,t){const r={};for(let s=0;s<t.length;s++){const c=t[s];c in e&&(r[c]=e[c])}return r}let Ue=1;function In(){return Ue++}function qr(){return function e(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function wi(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function tr(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Tn(e,t){e.forEach(r=>{t[r]&&(t[r]=t[r].bind(t))})}function pn(e,t){return-1!==e.indexOf(t,e.length-t.length)}function hi(e,t,r){const s={};for(const c in e)s[c]=t.call(r||this,e[c],c,e);return s}function ce(e,t,r){const s={};for(const c in e)t.call(r||this,e[c],c,e)&&(s[c]=e[c]);return s}function et(e){return Array.isArray(e)?e.map(et):"object"==typeof e&&e?hi(e,et):e}const nt={};function gt(e){nt[e]||(typeof console<"u"&&console.warn(e),nt[e]=!0)}function Qt(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function oe(e){let t=0;for(let r,s,c=0,d=e.length,f=d-1;c<d;f=c++)r=e[c],s=e[f],t+=(s.x-r.x)*(r.y+s.y);return t}function Pe([e,t,r]){const s=Ct(t+90),c=Ct(r);return{x:e*Math.cos(s)*Math.sin(c),y:e*Math.sin(s)*Math.sin(c),z:e*Math.cos(c),azimuthal:t,polar:r}}function Ge(e,t,r){const s=Math.sqrt(e*e+t*t+r*r),c=s>0?Math.acos(r/s)*Gt:0;let d=0!==e||0!==t?Math.atan2(-t,-e)*Gt+90:0;return d<0&&(d+=360),[s,d,c]}function ae(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Xe(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,s,c,d)=>{const f=c||d;return t[s]=!f||f.toLowerCase(),""}),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}let Ze=null;function Ie(){return!!lt.document.fullscreenElement||!!lt.document.webkitFullscreenElement}function gn(e){try{const t=lt[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function ur(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}function yn(e,t,r){e[4*t+0]=r[0],e[4*t+1]=r[1],e[4*t+2]=r[2],e[4*t+3]=r[3]}function Fr(e,t){return[Math.pow(e[0],2.2)*t,Math.pow(e[1],2.2)*t,Math.pow(e[2],2.2)*t]}function Xr(e){return[Math.pow(e[0],1/2.2),Math.pow(e[1],1/2.2),Math.pow(e[2],1/2.2)]}const Sn="mapbox-tiles";let Ar,dr,Vi=500,Ur=50;function Fl(){try{return lt.caches}catch{}}function er(){Fl()&&!Ar&&(Ar=lt.caches.open(Sn))}function Rs(e){const t=e.indexOf("?");if(t<0)return e;const s=function(c){const d=c.indexOf("?");return d>0?c.slice(d+1).split("&"):[]}(e).filter(c=>{const d=c.split("=");return"language"===d[0]||"worldview"===d[0]});return s.length?`${e.slice(0,t)}?${s.join("&")}`:e.slice(0,t)}let no=1/0;function ds(e){no++,no>Ur&&(e.getActor().send("enforceCacheSizeLimit",Vi),no=0)}const Ft={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};"function"==typeof Object.freeze&&Object.freeze(Ft);class Ht extends Error{constructor(t,r,s){401===r&&Nn(s)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=r,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const te=ae()?()=>self.worker&&self.worker.referrer:()=>("blob:"===lt.location.protocol?lt.parent:lt).location.href,le=function(e,t){if(!(/^file:/.test(r=e.url)||/^file:/.test(te())&&!/^\w+:/.test(r))){if(lt.fetch&&lt.Request&&lt.AbortController&&lt.Request.prototype.hasOwnProperty("signal"))return function(s,c){const d=new lt.AbortController,f=new lt.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:te(),referrerPolicy:s.referrerPolicy,signal:d.signal});let g=!1,y=!1;const b=(w=f.url).indexOf("sku=")>0&&Nn(w);var w;"json"===s.type&&f.headers.set("Accept","application/json");const P=(I,A,l)=>{if(y)return;if(I&&"SecurityError"!==I.message&&gt(I.toString()),A&&l)return O(A);const u=Date.now();lt.fetch(f).then(p=>{if(p.ok){const m=b?p.clone():null;return O(p,m,u)}return c(new Ht(p.statusText,p.status,s.url))}).catch(p=>{"AbortError"!==p.name&&c(new Error(`${p.message} ${s.url}`))})},O=(I,A,l)=>{("arrayBuffer"===s.type?I.arrayBuffer():"json"===s.type?I.json():I.text()).then(u=>{y||(A&&l&&function(p,m,v){if(er(),!Ar)return;const C={status:m.status,statusText:m.statusText,headers:new lt.Headers};m.headers.forEach((k,N)=>C.headers.set(N,k));const E=Xe(m.headers.get("Cache-Control")||"");if(E["no-store"])return;E["max-age"]&&C.headers.set("Expires",new Date(v+1e3*E["max-age"]).toUTCString());const T=C.headers.get("Expires");T&&(new Date(T).getTime()-v<42e4||function(k,N){if(void 0===dr)try{new Response(new ReadableStream),dr=!0}catch{dr=!1}dr?N(k.body):k.blob().then(N)}(m,k=>{const N=new lt.Response(k,C);er(),Ar&&Ar.then(F=>F.put(Rs(p.url),N)).catch(F=>gt(F.message))}))}(f,A,l),g=!0,c(null,u,I.headers.get("Cache-Control"),I.headers.get("Expires")))}).catch(u=>{y||c(new Error(u.message))})};return b?function(I,A){if(er(),!Ar)return A(null);const l=Rs(I.url);Ar.then(u=>{u.match(l).then(p=>{const m=function(v){if(!v)return!1;const C=new Date(v.headers.get("Expires")||0),E=Xe(v.headers.get("Cache-Control")||"");return C>Date.now()&&!E["no-cache"]}(p);u.delete(l),m&&u.put(l,p.clone()),A(null,p,m)}).catch(A)}).catch(A)}(f,P):P(null,null),{cancel:()=>{y=!0,g||d.abort()}}}(e,t);if(ae()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(s,c){const d=new lt.XMLHttpRequest;d.open(s.method||"GET",s.url,!0),"arrayBuffer"===s.type&&(d.responseType="arraybuffer");for(const f in s.headers)d.setRequestHeader(f,s.headers[f]);return"json"===s.type&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials="include"===s.credentials,d.onerror=()=>{c(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||0===d.status)&&null!==d.response){let f=d.response;if("json"===s.type)try{f=JSON.parse(d.response)}catch(g){return c(g)}c(null,f,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else c(new Ht(d.statusText,d.status,s.url))},d.send(s.body),{cancel:()=>d.abort()}}(e,t)},_e=function(e,t){return le(_t(e,{type:"json"}),t)},ve=function(e,t){return le(_t(e,{type:"arrayBuffer"}),t)};function xe(e){const t=lt.document.createElement("a");return t.href=e,t.protocol===lt.document.location.protocol&&t.host===lt.document.location.host}const it="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let at,ht;at=[],ht=0;const Bt=function(e,t){if(be.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ht>=ue.MAX_PARALLEL_IMAGE_REQUESTS){const d={requestParameters:e,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return at.push(d),d}ht++;let r=!1;const s=()=>{if(!r)for(r=!0,ht--;at.length&&ht<ue.MAX_PARALLEL_IMAGE_REQUESTS;){const d=at.shift(),{requestParameters:f,callback:g,cancelled:y}=d;y||(d.cancel=Bt(f,g).cancel)}},c=ve(e,(d,f,g,y)=>{s(),d?t(d):f&&(lt.createImageBitmap?function(b,w){const P=new lt.Blob([new Uint8Array(b)],{type:"image/png"});lt.createImageBitmap(P).then(O=>{w(null,O)}).catch(O=>{w(new Error(`Could not load image because of ${O.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(f,(b,w)=>t(b,w,g,y)):function(b,w){const P=new lt.Image,O=lt.URL;P.onload=()=>{w(null,P),O.revokeObjectURL(P.src),P.onload=null,lt.requestAnimationFrame(()=>{P.src=it})},P.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const I=new lt.Blob([new Uint8Array(b)],{type:"image/png"});P.src=b.byteLength?O.createObjectURL(I):it}(f,(b,w)=>t(b,w,g,y)))});return{cancel:()=>{c.cancel(),s()}}},kt="NO_ACCESS_TOKEN";class ee{constructor(t,r,s){this._transformRequestFn=t,this._customAccessToken=r,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const t=function(){let r="";for(let s=0;s<10;s++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",tn,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,r){return this._transformRequestFn&&this._transformRequestFn(t,r)||{url:t}}normalizeStyleURL(t,r){if(!Ke(t))return t;const s=ir(t);return s.params.push(`sdk=js-${ye}`),s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeGlyphsURL(t,r){if(!Ke(t))return t;const s=ir(t);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeModelURL(t,r){if(!Ke(t))return t;const s=ir(t);return s.path=`/models/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeSourceURL(t,r,s,c){if(!Ke(t))return t;const d=ir(t);return d.path=`/v4/${d.authority}.json`,d.params.push("secure"),s&&d.params.push(`language=${s}`),c&&d.params.push(`worldview=${c}`),this._makeAPIURL(d,this._customAccessToken||r)}normalizeSpriteURL(t,r,s,c){const d=ir(t);return Ke(t)?(d.path=`/styles/v1${d.path}/sprite${r}${s}`,this._makeAPIURL(d,this._customAccessToken||c)):(d.path+=`${r}${s}`,ji(d))}normalizeTileURL(t,r,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Ke(t))return t;const c=ir(t);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||s&&"raster"!==c.authority&&512===s?"@2x":""}${be.supported?".webp":"$1"}`),"raster"===c.authority?c.path=`/${ue.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${ue.TILE_URL_VERSION}${c.path}`);const d=this._customAccessToken||function(f){for(const g of f){const y=g.match(/^access_token=(.*)$/);if(y)return y[1]}return null}(c.params)||ue.ACCESS_TOKEN;return ue.REQUIRE_ACCESS_TOKEN&&d&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,d)}canonicalizeTileURL(t,r){const s=ir(t);if(!s.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!s.path.match(/\.[\w]+$/))return t;let c="mapbox://";s.path.match(/^\/raster\/v1\//)?c+=`raster/${s.path.replace(`/${ue.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${s.path.replace(`/${ue.TILE_URL_VERSION}/`,"")}`;let d=s.params;return r&&(d=d.filter(f=>!f.match(/^access_token=/))),d.length&&(c+=`?${d.join("&")}`),c}canonicalizeTileset(t,r){const s=!!r&&Ke(r),c=[];for(const d of t.tiles||[])Nn(d)?c.push(this.canonicalizeTileURL(d,s)):c.push(d);return c}_makeAPIURL(t,r){const s="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=ir(ue.API_URL);if(t.protocol=c.protocol,t.authority=c.authority,"http"===t.protocol){const d=t.params.indexOf("secure");d>=0&&t.params.splice(d,1)}if("/"!==c.path&&(t.path=`${c.path}${t.path}`),!ue.REQUIRE_ACCESS_TOKEN)return ji(t);if(r=r||ue.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if("s"===r[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return t.params=t.params.filter(d=>-1===d.indexOf("access_token")),t.params.push(`access_token=${r||""}`),ji(t)}}function Ke(e){return 0===e.indexOf("mapbox:")}function Nn(e){return ue.API_URL_REGEX.test(e)}function yr(e){return ue.API_CDN_URL_REGEX.test(e)}function Or(e){return ue.API_STYLE_REGEX.test(e)&&!Qr(e)}function Qr(e){return ue.API_SPRITE_REGEX.test(e)}const Pr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ir(e){const t=e.match(Pr);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function ji(e){const t=e.params.length?`?${e.params.join("&")}`:"";return`${e.protocol}://${e.authority}${e.path}${t}`}const or="mapbox.eventData";function qs(e){if(!e)return null;const t=e.split(".");if(!t||3!==t.length)return null;try{return JSON.parse(decodeURIComponent(lt.atob(t[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class ne{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const r=qs(ue.ACCESS_TOKEN);let s="";return s=r&&r.u?lt.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(c,d)=>String.fromCharCode(+("0x"+d)))):ue.ACCESS_TOKEN||"",t?`${or}.${t}:${s}`:`${or}:${s}`}fetchEventData(){const t=gn("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(t)try{const c=lt.localStorage.getItem(r);c&&(this.eventData=JSON.parse(c));const d=lt.localStorage.getItem(s);d&&(this.anonId=d)}catch{gt("Unable to read from LocalStorage")}}saveEventData(){const t=gn("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(t)try{lt.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&lt.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{gt("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,r,s,c){if(!ue.EVENTS_URL)return;const d=ir(ue.EVENTS_URL);d.params.push(`access_token=${c||ue.ACCESS_TOKEN||""}`);const f={event:this.type,created:new Date(t).toISOString()},g=r?_t(f,r):f,y={url:ji(d),headers:{"Content-Type":"text/plain"},body:JSON.stringify([g])};var w;this.pendingRequest=(w=b=>{this.pendingRequest=null,s(b),this.saveEventData(),this.processRequests(c)},le(_t(y,{method:"POST"}),w))}queueRequest(t,r){this.queue.push(t),this.processRequests(r)}}const Vt=new class extends ne{constructor(e){super("appUserTurnstile"),this._customAccessToken=e}postTurnstileEvent(e,t){ue.EVENTS_URL&&ue.ACCESS_TOKEN&&Array.isArray(e)&&e.some(r=>Ke(r)||Nn(r))&&this.queueRequest(Date.now(),t)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=qs(ue.ACCESS_TOKEN),r=t?t.u:ue.ACCESS_TOKEN;let s=r!==this.eventData.tokenU;tr(this.anonId)||(this.anonId=qr(),s=!0);const c=this.queue.shift();if(this.eventData.lastSuccess){const d=new Date(this.eventData.lastSuccess),f=new Date(c),g=(c-this.eventData.lastSuccess)/864e5;s=s||g>=1||g<-1||d.getDate()!==f.getDate()}else s=!0;s?this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ye,skuId:tn,"enabled.telemetry":!1,userId:this.anonId},d=>{d||(this.eventData.lastSuccess=c,this.eventData.tokenU=r)},e):this.processRequests()}},Re=Vt.postTurnstileEvent.bind(Vt),zn=new class extends ne{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(e,t,r,s){this.skuToken=t,this.errorCb=s,ue.EVENTS_URL&&(r||ue.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},r):this.errorCb(new Error(kt)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:r}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),tr(this.anonId)||(this.anonId=qr()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ye,skuId:tn,skuToken:this.skuToken,userId:this.anonId},s=>{s?this.errorCb(s):t&&(this.success[t]=!0)},e))}},vr=zn.postMapLoadEvent.bind(zn),sr=new class extends ne{constructor(){super("gljs.performance")}postPerformanceEvent(e,t){ue.EVENTS_URL&&(e||ue.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},e)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:t,performanceData:r}=this.queue.shift(),s=function(c){const d=lt.performance.getEntriesByType("resource"),f=lt.performance.getEntriesByType("mark"),g=function(O){const I={};if(O)for(const A in O)if("other"!==A)for(const l of O[A]){const u=`${A}ResolveRangeMin`,p=`${A}ResolveRangeMax`,m=`${A}RequestCount`,v=`${A}RequestCachedCount`;I[u]=Math.min(I[u]||1/0,l.startTime),I[p]=Math.max(I[p]||-1/0,l.responseEnd);const C=E=>{void 0===I[E]&&(I[E]=0),++I[E]};void 0!==l.transferSize&&0===l.transferSize&&C(v),C(m)}return I}(function(O,I){const A={};if(O)for(const l of O){const u=I(l);void 0===A[u]&&(A[u]=[]),A[u].push(l)}return A}(d,cd)),y=lt.devicePixelRatio,b=lt.navigator.connection||lt.navigator.mozConnection||lt.navigator.webkitConnection,w={counters:[],metadata:[],attributes:[]},P=(O,I,A)=>{null!=A&&O.push({name:I,value:A.toString()})};for(const O in g)P(w.counters,O,g[O]);if(c.interactionRange[0]!==1/0&&c.interactionRange[1]!==-1/0&&(P(w.counters,"interactionRangeMin",c.interactionRange[0]),P(w.counters,"interactionRangeMax",c.interactionRange[1])),f)for(const O of Object.keys(gl)){const I=gl[O],A=f.find(l=>l.name===I);A&&P(w.counters,I,A.startTime)}return P(w.counters,"visibilityHidden",c.visibilityHidden),P(w.attributes,"style",function(O){if(O)for(const I of O){const A=I.name.split("?")[0];if(Or(A)){const l=A.split("/").slice(-2);if(2===l.length)return`mapbox://styles/${l[0]}/${l[1]}`}}}(d)),P(w.attributes,"terrainEnabled",c.terrainEnabled?"true":"false"),P(w.attributes,"fogEnabled",c.fogEnabled?"true":"false"),P(w.attributes,"projection",c.projection),P(w.attributes,"zoom",c.zoom),P(w.metadata,"devicePixelRatio",y),P(w.metadata,"connectionEffectiveType",b?b.effectiveType:void 0),P(w.metadata,"navigatorUserAgent",lt.navigator.userAgent),P(w.metadata,"screenWidth",lt.screen.width),P(w.metadata,"screenHeight",lt.screen.height),P(w.metadata,"windowWidth",lt.innerWidth),P(w.metadata,"windowHeight",lt.innerHeight),P(w.metadata,"mapWidth",c.width/y),P(w.metadata,"mapHeight",c.height/y),P(w.metadata,"webglRenderer",c.renderer),P(w.metadata,"webglVendor",c.vendor),P(w.metadata,"sdkVersion",ye),P(w.metadata,"sdkIdentifier","mapbox-gl-js"),w}(r);for(const c of s.metadata);for(const c of s.counters);for(const c of s.attributes);this.postEvent(t,s,()=>{},e)}},ai=sr.postPerformanceEvent.bind(sr),Hi=new class extends ne{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(e,t,r,s){if(!ue.API_URL||!ue.SESSION_PATH)return;const c=ir(ue.API_URL+ue.SESSION_PATH);c.params.push(`sku=${t||""}`),c.params.push(`access_token=${s||ue.ACCESS_TOKEN||""}`);const d={url:ji(c),headers:{"Content-Type":"text/plain"}};var g;this.pendingRequest=(g=f=>{this.pendingRequest=null,r(f),this.saveEventData(),this.processRequests(s)},le(_t(d,{method:"GET"}),g))}getSessionAPI(e,t,r,s){this.skuToken=t,this.errorCb=s,ue.SESSION_PATH&&ue.API_URL&&(r||ue.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},r):this.errorCb(new Error(kt)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:r}=this.queue.shift();t&&this.success[t]||this.getSession(r,this.skuToken,s=>{s?this.errorCb(s):t&&(this.success[t]=!0)},e)}},Ti=Hi.getSessionAPI.bind(Hi),zr=new Set;function pl(e,t){t?zr.add(e):zr.delete(e)}const gl={create:"create",load:"load",fullLoad:"fullLoad"},mh={mark(e){lt.performance.mark(e)},measure(e,t,r){lt.performance.measure(e,t,r)}};function cd(e){const t=e.name.split("?")[0];return yr(t)&&t.includes("mapbox-gl.js")?"javascript":yr(t)&&t.includes("mapbox-gl.css")?"css":ue.API_FONTS_REGEX.test(t)?"fontRange":Qr(t)?"sprite":Or(t)?"style":ue.API_TILEJSON_REGEX.test(t)?"tilejson":"other"}const bs=lt.performance;function Ba(e){const t=e?e.url.toString():void 0;return bs.getEntriesByName(t)}var ag=ml;function ml(e){return t=e,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var s,c,d=new Blob([""],{type:"text/javascript"}),f=URL.createObjectURL(d);try{c=new Worker(f),s=!0}catch{s=!1}return c&&c.terminate(),URL.revokeObjectURL(f),s}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var s=document.createElement("canvas");s.width=s.height=1;var c=s.getContext("2d");if(!c)return!1;var d=c.getImageData(0,0,1,1);return d&&d.width===s.width}()||(void 0===qi[r=t&&t.failIfMajorPerformanceCaveat]&&(qi[r]=function(s){var c,f,g,y,d=(f=s,g=document.createElement("canvas"),(y=Object.create(ml.webGLContextAttributes)).failIfMajorPerformanceCaveat=f,g.getContext("webgl",y)||g.getContext("experimental-webgl",y));if(!d)return!1;try{c=d.createShader(d.VERTEX_SHADER)}catch{return!1}return!(!c||d.isContextLost())&&(d.shaderSource(c,"void main() {}"),d.compileShader(c),!0===d.getShaderParameter(c,d.COMPILE_STATUS))}(r)),!qi[r]||document.documentMode));var t,r}var qi={};let lg,Ua,ud,dd,Va;function hd(){return null==lg&&(lg=lt.OffscreenCanvas&&new lt.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof lt.createImageBitmap),lg}ml.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Mn={now:()=>void 0!==dd?dd:lt.performance.now(),setNow(e){dd=e},restoreNow(){dd=void 0},frame(e){const t=lt.requestAnimationFrame(e);return{cancel:()=>lt.cancelAnimationFrame(t)}},getImageData(e,t=0){const{width:r,height:s}=e;Va||(Va=lt.document.createElement("canvas"));const c=Va.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return(r>Va.width||s>Va.height)&&(Va.width=r,Va.height=s),c.clearRect(-t,-t,r+2*t,s+2*t),c.drawImage(e,0,0,r,s),c.getImageData(-t,-t,r+2*t,s+2*t)},resolveURL:e=>(Ua||(Ua=lt.document.createElement("a")),Ua.href=e,Ua.href),get devicePixelRatio(){return lt.devicePixelRatio},get prefersReducedMotion(){return!!lt.matchMedia&&(null==ud&&(ud=lt.matchMedia("(prefers-reduced-motion: reduce)")),ud.matches)},hasCanvasFingerprintNoise(){if(!hd())return!1;const e=new lt.OffscreenCanvas(85,1),t=e.getContext("2d",{willReadFrequently:!0});let r=0;for(let c=0;c<e.width;++c)t.fillStyle=`rgba(${r++},${r++},${r++}, 255)`,t.fillRect(c,0,1,1);const s=t.getImageData(0,0,e.width,e.height);r=0;for(let c=0;c<s.data.length;++c)if(c%4!=3&&r++!==s.data[c])return!0;return!1}};function ei(e,t,r){const s=lt.document.createElement(e);return void 0!==t&&(s.className=t),r&&r.appendChild(s),s}function ia(e,t,r){const s=lt.document.createElementNS("http://www.w3.org/2000/svg",e);for(const c of Object.keys(t))s.setAttributeNS(null,c,t[c]);return r&&r.appendChild(s),s}const Ho=lt.document&&lt.document.documentElement.style,su=Ho&&void 0!==Ho.userSelect?"userSelect":"WebkitUserSelect";let au;function $f(){Ho&&su&&(au=Ho[su],Ho[su]="none")}function Hy(){Ho&&su&&(Ho[su]=au)}function xs(e){e.preventDefault(),e.stopPropagation(),lt.removeEventListener("click",xs,!0)}function _h(){lt.addEventListener("click",xs,!0),lt.setTimeout(()=>{lt.removeEventListener("click",xs,!0)},0)}function vo(e,t){const r=e.getBoundingClientRect();return Um(e,r,t)}function lu(e,t){const r=e.getBoundingClientRect(),s=[];for(let c=0;c<t.length;c++)s.push(Um(e,r,t[c]));return s}function Gf(e){return void 0!==lt.InstallTrigger&&2===e.button&&e.ctrlKey&&lt.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button}function Um(e,t,r){const s=e.offsetWidth===t.width?1:e.offsetWidth/t.width;return new tt((r.clientX-t.left)*s,(r.clientY-t.top)*s)}function fd(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function yh(e,t,r){if(r&&r[e]){const s=r[e].indexOf(t);-1!==s&&r[e].splice(s,1)}}class de{constructor(t,r={}){_t(this,r),this.type=t}}class Cn extends de{constructor(t,r={}){super("error",_t({error:t},r))}}class ki{on(t,r){return this._listeners=this._listeners||{},fd(t,r,this._listeners),this}off(t,r){return yh(t,r,this._listeners),yh(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},fd(t,r,this._oneTimeListeners),this):new Promise(s=>this.once(t,s))}fire(t,r){"string"==typeof t&&(t=new de(t,r||{}));const s=t.type;if(this.listens(s)){t.target=this;const c=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const g of c)g.call(this,t);const d=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const g of d)yh(s,g,this._oneTimeListeners),g.call(this,t);const f=this._eventedParent;f&&(_t(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),f.fire(t))}else t instanceof Cn&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var wt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class Fe{constructor(t,r,s,c){this.message=(t?`${t}: `:"")+s,c&&(this.identifier=c),null!=r&&r.__line__&&(this.line=r.__line__)}}class wc extends Fe{}function Zs(e,...t){for(const r of t)for(const s in r)e[s]=r[s];return e}function Wn(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function $i(e){if(Array.isArray(e))return e.map($i);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const r in e)t[r]=$i(e[r]);return t}return Wn(e)}class Yo extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}var ho=Yo;class Do{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[s,c]of r)this.bindings[s]=c}concat(t){return new Do(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var Vm=Do;const ws={kind:"null"},Ae={kind:"number"},br={kind:"string"},Tr={kind:"boolean"},Jr={kind:"color"},dn={kind:"object"},Ye={kind:"value"},Ai={kind:"collator"},Cs={kind:"formatted"},ja={kind:"resolvedImage"};function Zr(e,t){return{kind:"array",itemType:e,N:t}}function ni(e){if("array"===e.kind){const t=ni(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const ko=[ws,Ae,br,Tr,Jr,Cs,dn,Zr(Ye),ja];function Xo(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Xo(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const r of ko)if(!Xo(r,t))return null}return`Expected ${ni(e)} but found ${ni(t)} instead.`}function pd(e,t){return t.some(r=>r.kind===e.kind)}function ar(e,t){return t.some(r=>"null"===r?null===e:"array"===r?Array.isArray(e):"object"===r?e&&!Array.isArray(e)&&"object"==typeof e:r===typeof e)}var Ws,Cc={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ba(e){return(e=Math.round(e))<0?0:e>255?255:e}function Zi(e){return ba("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function cu(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function $a(e,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}try{Ws={}.parseCSSColor=function(e){var t,r=e.replace(/ /g,"").toLowerCase();if(r in Cc)return Cc[r].slice();if("#"===r[0])return 4===r.length?(t=parseInt(r.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===r.length&&(t=parseInt(r.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var s=r.indexOf("("),c=r.indexOf(")");if(-1!==s&&c+1===r.length){var d=r.substr(0,s),f=r.substr(s+1,c-(s+1)).split(","),g=1;switch(d){case"rgba":if(4!==f.length)return null;g=cu(f.pop());case"rgb":return 3!==f.length?null:[Zi(f[0]),Zi(f[1]),Zi(f[2]),g];case"hsla":if(4!==f.length)return null;g=cu(f.pop());case"hsl":if(3!==f.length)return null;var y=(parseFloat(f[0])%360+360)%360/360,b=cu(f[1]),w=cu(f[2]),P=w<=.5?w*(b+1):w+b-w*b,O=2*w-P;return[ba(255*$a(O,P,y+1/3)),ba(255*$a(O,P,y)),ba(255*$a(O,P,y-1/3)),g];default:return null}}return null}}catch{}class fo{constructor(t,r,s,c=1){this.r=t,this.g=r,this.b=s,this.a=c}static parse(t){if(!t)return;if(t instanceof fo)return t;if("string"!=typeof t)return;const r=Ws(t);return r?new fo(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[t,r,s,c]=this.toArray();return`rgba(${Math.round(t)},${Math.round(r)},${Math.round(s)},${c})`}toArray(){const{r:t,g:r,b:s,a:c}=this;return 0===c?[0,0,0,0]:[255*t/c,255*r/c,255*s/c,c]}toArray01(){const{r:t,g:r,b:s,a:c}=this;return 0===c?[0,0,0,0]:[t/c,r/c,s/c,c]}toArray01Scaled(t){const{r,g:s,b:c,a:d}=this;return 0===d?[0,0,0]:[r/d*t,s/d*t,c/d*t]}toArray01PremultipliedAlpha(){const{r:t,g:r,b:s,a:c}=this;return[t,r,s,c]}toArray01Linear(){const{r:t,g:r,b:s,a:c}=this;return 0===c?[0,0,0,0]:[Math.pow(t/c,2.2),Math.pow(r/c,2.2),Math.pow(s/c,2.2),c]}}fo.black=new fo(0,0,0,1),fo.white=new fo(1,1,1,1),fo.transparent=new fo(0,0,0,0),fo.red=new fo(1,0,0,1),fo.blue=new fo(0,0,1,1);var bn=fo;class Hf{constructor(t,r,s){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class oa{constructor(t,r,s,c,d){this.text=t.normalize?t.normalize():t,this.image=r,this.scale=s,this.fontStack=c,this.textColor=d}}class po{constructor(t){this.sections=t}static fromString(t){return new po([new oa(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(t=>0!==t.text.length||t.image&&0!==t.image.namePrimary.length)}static factory(t){return t instanceof po?t:po.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const r of this.sections){if(r.image){t.push(["image",r.image.namePrimary]);continue}t.push(r.text);const s={};r.fontStack&&(s["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(s["font-scale"]=r.scale),r.textColor&&(s["text-color"]=["rgba"].concat(r.textColor.toArray())),t.push(s)}return t}}class Ro{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,r){return t?new Ro({namePrimary:t,nameSecondary:r,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function sa(e,t,r,s){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===s||"number"==typeof s&&s>=0&&s<=1?null:`Invalid rgba value [${[e,t,r,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof s?[e,t,r,s]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Yn(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof bn||e instanceof Hf||e instanceof po||e instanceof Ro)return!0;if(Array.isArray(e)){for(const t of e)if(!Yn(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!Yn(e[t]))return!1;return!0}return!1}function go(e){if(null===e)return ws;if("string"==typeof e)return br;if("boolean"==typeof e)return Tr;if("number"==typeof e)return Ae;if(e instanceof bn)return Jr;if(e instanceof Hf)return Ai;if(e instanceof po)return Cs;if(e instanceof Ro)return ja;if(Array.isArray(e)){const t=e.length;let r;for(const s of e){const c=go(s);if(r){if(r===c)continue;r=Ye;break}r=c}return Zr(r||Ye,t)}return dn}function zl(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof bn||e instanceof po||e instanceof Ro?e.toString():JSON.stringify(e)}class gd{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(2!==t.length)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Yn(t[1]))return r.error("invalid value");const s=t[1];let c=go(s);const d=r.expectedType;return"array"!==c.kind||0!==c.N||!d||"array"!==d.kind||"number"==typeof d.N&&0!==d.N||(c=d),new gd(c,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof bn?["rgba"].concat(this.value.toArray()):this.value instanceof po?this.value.serialize():this.value}}var Ms=gd,Wi=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};const Bl={string:br,number:Ae,boolean:Tr,object:dn};class uu{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let s,c=1;const d=t[0];if("array"===d){let g,y;if(t.length>2){const b=t[1];if("string"!=typeof b||!(b in Bl)||"object"===b)return r.error('The item type argument of "array" must be one of string, number, boolean',1);g=Bl[b],c++}else g=Ye;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);y=t[2],c++}s=Zr(g,y)}else s=Bl[d];const f=[];for(;c<t.length;c++){const g=r.parse(t[c],c,Ye);if(!g)return null;f.push(g)}return new uu(s,f)}evaluate(t){for(let r=0;r<this.args.length;r++){const s=this.args[r].evaluate(t);if(!Xo(this.type,go(s)))return s;if(r===this.args.length-1)throw new Wi(`Expected value to be of type ${ni(this.type)}, but found ${ni(go(s))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,r=[t.kind];if("array"===t.kind){const s=t.itemType;if("string"===s.kind||"number"===s.kind||"boolean"===s.kind){r.push(s.kind);const c=t.N;("number"==typeof c||this.args.length>1)&&r.push(c)}}return r.concat(this.args.map(s=>s.serialize()))}}var Fi=uu;class aa{constructor(t){this.type=Cs,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const s=t[1];if(!Array.isArray(s)&&"object"==typeof s)return r.error("First argument must be an image or text section.");const c=[];let d=!1;for(let f=1;f<=t.length-1;++f){const g=t[f];if(d&&"object"==typeof g&&!Array.isArray(g)){d=!1;let y=null;if(g["font-scale"]&&(y=r.parse(g["font-scale"],1,Ae),!y))return null;let b=null;if(g["text-font"]&&(b=r.parse(g["text-font"],1,Zr(br)),!b))return null;let w=null;if(g["text-color"]&&(w=r.parse(g["text-color"],1,Jr),!w))return null;const P=c[c.length-1];P.scale=y,P.font=b,P.textColor=w}else{const y=r.parse(t[f],1,Ye);if(!y)return null;const b=y.type.kind;if("string"!==b&&"value"!==b&&"null"!==b&&"resolvedImage"!==b)return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,c.push({content:y,scale:null,font:null,textColor:null})}}return new aa(c)}evaluate(t){return new po(this.sections.map(r=>{const s=r.content.evaluate(t);return go(s)===ja?new oa("",s,null,null,null):new oa(zl(s),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null)}))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const r of this.sections){t.push(r.content.serialize());const s={};r.scale&&(s["font-scale"]=r.scale.serialize()),r.font&&(s["text-font"]=r.font.serialize()),r.textColor&&(s["text-color"]=r.textColor.serialize()),t.push(s)}return t}}class bo{constructor(t,r){this.type=ja,this.inputPrimary=t,this.inputSecondary=r}static parse(t,r){if(t.length<2)return r.error("Expected two or more arguments.");const s=r.parse(t[1],1,br);if(!s)return r.error("No image name provided.");if(2===t.length)return new bo(s);const c=r.parse(t[2],1,br);return c?new bo(s,c):r.error("Secondary image variant is not a string.")}evaluate(t){const r=Ro.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return r&&t.availableImages&&(r.available=t.availableImages.indexOf(r.namePrimary)>-1,r.nameSecondary&&r.available&&t.availableImages&&(r.available=t.availableImages.indexOf(r.nameSecondary)>-1)),r}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Un(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}const du={"to-boolean":Tr,"to-color":Jr,"to-number":Ae,"to-string":br};class _l{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const s=t[0],c=[];let d=ws;if("to-array"===s){if(!Array.isArray(t[1]))return null;const f=t[1].length;if(r.expectedType){if("array"!==r.expectedType.kind)return r.error(`Expected ${r.expectedType.kind} but found array.`);d=Zr(r.expectedType.itemType,f)}else{if(!(f>0&&Yn(t[1][0])))return null;d=Zr(go(t[1][0]),f)}for(let g=0;g<f;g++){const y=t[1][g];let b;if("array"===Un(y))b=r.parse(y,void 0,d.itemType);else{const w=Un(y);if(w!==d.itemType.kind)return r.error(`Expected ${d.itemType.kind} but found ${w}.`);b=r.registry.literal.parse(["literal",void 0===y?null:y],r)}if(!b)return null;c.push(b)}}else{if(("to-boolean"===s||"to-string"===s)&&2!==t.length)return r.error("Expected one argument.");d=du[s];for(let f=1;f<t.length;f++){const g=r.parse(t[f],f,Ye);if(!g)return null;c.push(g)}}return new _l(d,c)}evaluate(t){if("boolean"===this.type.kind)return!!this.args[0].evaluate(t);if("color"===this.type.kind){let r,s;for(const c of this.args){if(r=c.evaluate(t),s=null,r instanceof bn)return r;if("string"==typeof r){const d=t.parseColor(r);if(d)return d}else if(Array.isArray(r)&&(s=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:sa(r[0],r[1],r[2],r[3]),!s))return new bn(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Wi(s||`Could not parse color from value '${"string"==typeof r?r:String(JSON.stringify(r))}'`)}if("number"===this.type.kind){let r=null;for(const s of this.args){if(r=s.evaluate(t),null===r)return 0;const c=Number(r);if(!isNaN(c))return c}throw new Wi(`Could not convert ${JSON.stringify(r)} to number.`)}return"formatted"===this.type.kind?po.fromString(zl(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Ro.fromString(zl(this.args[0].evaluate(t))):"array"===this.type.kind?this.args.map(r=>r.evaluate(t)):zl(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if("formatted"===this.type.kind)return new aa([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new bo(this.args[0]).serialize();const t="array"===this.type.kind?[]:[`to-${this.type.kind}`];return this.eachChild(r=>{t.push(r.serialize())}),t}}var Ga=_l;const la=["Unknown","Point","LineString","Polygon"];var hu=class{constructor(e){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.options=e}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?la[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(e){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:r,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*t-e[0])+this.featureDistanceData.bearing[1]*(s*t-e[1])}return 0}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=bn.parse(e)),t}getConfig(e){return this.options?this.options.get(e):null}};class yl{constructor(t,r,s,c,d){this.name=t,this.type=r,this._evaluate=s,this.args=c,this._overloadIndex=d}evaluate(t){if(!this._evaluate){const r=yl.definitions[this.name];this._evaluate=Array.isArray(r)?r[2]:r.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,r){const s=t[0],c=yl.definitions[s];if(!c)return r.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(c)?c[0]:c.type,f=Array.isArray(c)?[[c[1],c[2]]]:c.overloads,g=[];let y=null,b=-1;for(const[w,P]of f){if(Array.isArray(w)&&w.length!==t.length-1)continue;g.push(w),b++,y=new wd(r.registry,r.path,null,r.scope,void 0,r.options);const O=[];let I=!1;for(let A=1;A<t.length;A++){const l=t[A],u=Array.isArray(w)?w[A-1]:w.type,p=y.parse(l,1+O.length,u);if(!p){I=!0;break}O.push(p)}if(!I)if(Array.isArray(w)&&w.length!==O.length)y.error(`Expected ${w.length} arguments, but found ${O.length} instead.`);else{for(let A=0;A<O.length;A++){const l=Array.isArray(w)?w[A]:w.type,u=O[A];y.concat(A+1).checkSubtype(l,u.type)}if(0===y.errors.length)return new yl(s,d,P,O,b)}}if(1===g.length)r.errors.push(...y.errors);else{const w=(g.length?g:f.map(([O])=>O)).map(cg).join(" | "),P=[];for(let O=1;O<t.length;O++){const I=r.parse(t[O],1+P.length);if(!I)return null;P.push(ni(I.type))}r.error(`Expected arguments of type ${w}, but found (${P.join(", ")}) instead.`)}return null}static register(t,r){yl.definitions=r;for(const s in r)t[s]=yl}}function cg(e){return Array.isArray(e)?`(${e.map(ni).join(", ")})`:`(${ni(e.type)}...)`}var vl=yl;class vh{constructor(t,r,s){this.type=Ai,this.locale=s,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(2!==t.length)return r.error("Expected one argument.");const s=t[1];if("object"!=typeof s||Array.isArray(s))return r.error("Collator options argument must be an object.");const c=r.parse(void 0!==s["case-sensitive"]&&s["case-sensitive"],1,Tr);if(!c)return null;const d=r.parse(void 0!==s["diacritic-sensitive"]&&s["diacritic-sensitive"],1,Tr);if(!d)return null;let f=null;return s.locale&&(f=r.parse(s.locale,1,br),!f)?null:new vh(c,d,f)}evaluate(t){return new Hf(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}var Ki={exports:{}};Ki.exports=function(){function e(s,c,d,f,g){for(;f>d;){if(f-d>600){var y=f-d+1,b=c-d+1,w=Math.log(y),P=.5*Math.exp(2*w/3),O=.5*Math.sqrt(w*P*(y-P)/y)*(b-y/2<0?-1:1);e(s,c,Math.max(d,Math.floor(c-b*P/y+O)),Math.min(f,Math.floor(c+(y-b)*P/y+O)),g)}var I=s[c],A=d,l=f;for(t(s,d,c),g(s[f],I)>0&&t(s,d,f);A<l;){for(t(s,A,l),A++,l--;g(s[A],I)<0;)A++;for(;g(s[l],I)>0;)l--}0===g(s[d],I)?t(s,d,l):t(s,++l,f),l<=c&&(d=l+1),c<=l&&(f=l-1)}}function t(s,c,d){var f=s[c];s[c]=s[d],s[d]=f}function r(s,c){return s<c?-1:s>c?1:0}return function(s,c,d,f,g){e(s,c,d||0,f||s.length-1,g||r)}}();var qy=We(Ki.exports);function pw(e){let t=0;for(let r,s,c=0,d=e.length,f=d-1;c<d;f=c++)r=e[c],s=e[f],t+=(s.x-r.x)*(r.y+s.y);return t}function bh(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function ug(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function qf(e,t,r){const s=e[0]-t[0],c=e[1]-t[1],d=e[0]-r[0],f=e[1]-r[1];return s*f-d*c==0&&s*d<=0&&c*f<=0}function Ps(e,t,r=!1){let s=!1;for(let g=0,y=t.length;g<y;g++){const b=t[g];for(let w=0,P=b.length,O=P-1;w<P;O=w++){const I=b[O],A=b[w];if(qf(e,I,A))return r;(d=I)[1]>(c=e)[1]!=(f=A)[1]>c[1]&&c[0]<(f[0]-d[0])*(c[1]-d[1])/(f[1]-d[1])+d[0]&&(s=!s)}}var c,d,f;return s}function jm(e,t,r,s){const c=s[0]-r[0],d=s[1]-r[1],f=(e[0]-r[0])*d-c*(e[1]-r[1]),g=(t[0]-r[0])*d-c*(t[1]-r[1]);return f>0&&g<0||f<0&&g>0}function fu(e,t,r,s){return(c=[s[0]-r[0],s[1]-r[1]])[0]*(d=[t[0]-e[0],t[1]-e[1]])[1]-c[1]*d[0]!=0&&!(!jm(e,t,r,s)||!jm(r,s,e,t));var c,d}const Ha=8192;function f0(e,t){const r=(180+e[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,c=Math.pow(2,t.z);return[Math.round(r*c*Ha),Math.round(s*c*Ha)]}function Zy(e,t){for(let r=0;r<t.length;r++)if(Ps(e,t[r]))return!0;return!1}function dg(e,t,r){for(const s of r)for(let c=0,d=s.length,f=d-1;c<d;f=c++)if(fu(e,t,s[f],s[c]))return!0;return!1}function xh(e,t){for(let r=0;r<e.length;++r)if(!Ps(e[r],t))return!1;for(let r=0;r<e.length-1;++r)if(dg(e[r],e[r+1],t))return!1;return!0}function $m(e,t){for(let r=0;r<t.length;r++)if(xh(e,t[r]))return!0;return!1}function md(e,t,r){const s=[];for(let c=0;c<e.length;c++){const d=[];for(let f=0;f<e[c].length;f++){const g=f0(e[c][f],r);bh(t,g),d.push(g)}s.push(d)}return s}function xa(e,t,r){const s=[];for(let c=0;c<e.length;c++){const d=md(e[c],t,r);s.push(d)}return s}function Zf(e,t,r,s){if(e[0]<r[0]||e[0]>r[2]){const c=.5*s;let d=e[0]-r[0]>c?-s:r[0]-e[0]>c?s:0;0===d&&(d=e[0]-r[2]>c?-s:r[2]-e[0]>c?s:0),e[0]+=d}bh(t,e)}function Ul(e,t,r,s){const c=Math.pow(2,s.z)*Ha,d=[s.x*Ha,s.y*Ha],f=[];if(!e)return f;for(const g of e)for(const y of g){const b=[y.x+d[0],y.y+d[1]];Zf(b,t,r,c),f.push(b)}return f}function ca(e,t,r,s){const c=Math.pow(2,s.z)*Ha,d=[s.x*Ha,s.y*Ha],f=[];if(!e)return f;for(const y of e){const b=[];for(const w of y){const P=[w.x+d[0],w.y+d[1]];bh(t,P),b.push(P)}f.push(b)}if(t[2]-t[0]<=c/2){(g=t)[0]=g[1]=1/0,g[2]=g[3]=-1/0;for(const y of f)for(const b of y)Zf(b,t,r,c)}var g;return f}class pu{constructor(t,r){this.type=Tr,this.geojson=t,this.geometries=r}static parse(t,r){if(2!==t.length)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Yn(t[1])){const s=t[1];if("FeatureCollection"===s.type)for(let c=0;c<s.features.length;++c){const d=s.features[c].geometry.type;if("Polygon"===d||"MultiPolygon"===d)return new pu(s,s.features[c].geometry)}else if("Feature"===s.type){const c=s.geometry.type;if("Polygon"===c||"MultiPolygon"===c)return new pu(s,s.geometry)}else if("Polygon"===s.type||"MultiPolygon"===s.type)return new pu(s,s)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(r,s){const c=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],f=r.canonicalID();if(!f)return!1;if("Polygon"===s.type){const g=md(s.coordinates,d,f),y=Ul(r.geometry(),c,d,f);if(!ug(c,d))return!1;for(const b of y)if(!Ps(b,g))return!1}if("MultiPolygon"===s.type){const g=xa(s.coordinates,d,f),y=Ul(r.geometry(),c,d,f);if(!ug(c,d))return!1;for(const b of y)if(!Zy(b,g))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(r,s){const c=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],f=r.canonicalID();if(!f)return!1;if("Polygon"===s.type){const g=md(s.coordinates,d,f),y=ca(r.geometry(),c,d,f);if(!ug(c,d))return!1;for(const b of y)if(!xh(b,g))return!1}if("MultiPolygon"===s.type){const g=xa(s.coordinates,d,f),y=ca(r.geometry(),c,d,f);if(!ug(c,d))return!1;for(const b of y)if(!$m(b,g))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var wh=pu,qo={exports:{}};qo.exports=function(){var e={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},t=1/298.257223563,r=t*(2-t),s=Math.PI/180,c=function(b,w){if(void 0===b)throw new Error("No latitude given.");if(w&&!e[w])throw new Error("Unknown unit "+w+". Use one of: "+Object.keys(e).join(", "));var P=6378.137*s*(w?e[w]:1),O=Math.cos(b*s),I=1/(1-r*(1-O*O)),A=Math.sqrt(I);this.kx=P*A*O,this.ky=P*A*I*(1-r)},d={units:{configurable:!0}};function f(b,w){return b[0]===w[0]&&b[1]===w[1]}function g(b,w,P){var O=y(w[0]-b[0]);return[b[0]+O*P,b[1]+(w[1]-b[1])*P]}function y(b){for(;b<-180;)b+=360;for(;b>180;)b-=360;return b}return c.fromTile=function(b,w,P){var O=Math.PI*(1-2*(b+.5)/Math.pow(2,w)),I=Math.atan(.5*(Math.exp(O)-Math.exp(-O)))/s;return new c(I,P)},d.units.get=function(){return e},c.prototype.distance=function(b,w){var P=y(b[0]-w[0])*this.kx,O=(b[1]-w[1])*this.ky;return Math.sqrt(P*P+O*O)},c.prototype.bearing=function(b,w){var P=y(w[0]-b[0])*this.kx;return Math.atan2(P,(w[1]-b[1])*this.ky)/s},c.prototype.destination=function(b,w,P){var O=P*s;return this.offset(b,Math.sin(O)*w,Math.cos(O)*w)},c.prototype.offset=function(b,w,P){return[b[0]+w/this.kx,b[1]+P/this.ky]},c.prototype.lineDistance=function(b){for(var w=0,P=0;P<b.length-1;P++)w+=this.distance(b[P],b[P+1]);return w},c.prototype.area=function(b){for(var w=0,P=0;P<b.length;P++)for(var O=b[P],I=0,A=O.length,l=A-1;I<A;l=I++)w+=y(O[I][0]-O[l][0])*(O[I][1]+O[l][1])*(P?-1:1);return Math.abs(w)/2*this.kx*this.ky},c.prototype.along=function(b,w){var P=0;if(w<=0)return b[0];for(var O=0;O<b.length-1;O++){var I=b[O],A=b[O+1],l=this.distance(I,A);if((P+=l)>w)return g(I,A,(w-(P-l))/l)}return b[b.length-1]},c.prototype.pointToSegmentDistance=function(b,w,P){var O=w[0],I=w[1],A=y(P[0]-O)*this.kx,l=(P[1]-I)*this.ky,u=0;return 0===A&&0===l||((u=(y(b[0]-O)*this.kx*A+(b[1]-I)*this.ky*l)/(A*A+l*l))>1?(O=P[0],I=P[1]):u>0&&(O+=A/this.kx*u,I+=l/this.ky*u)),A=y(b[0]-O)*this.kx,l=(b[1]-I)*this.ky,Math.sqrt(A*A+l*l)},c.prototype.pointOnLine=function(b,w){for(var P,O,I,A,l=1/0,u=0;u<b.length-1;u++){var p=b[u][0],m=b[u][1],v=y(b[u+1][0]-p)*this.kx,C=(b[u+1][1]-m)*this.ky,E=0;0===v&&0===C||((E=(y(w[0]-p)*this.kx*v+(w[1]-m)*this.ky*C)/(v*v+C*C))>1?(p=b[u+1][0],m=b[u+1][1]):E>0&&(p+=v/this.kx*E,m+=C/this.ky*E));var T=(v=y(w[0]-p)*this.kx)*v+(C=(w[1]-m)*this.ky)*C;T<l&&(l=T,P=p,O=m,I=u,A=E)}return{point:[P,O],index:I,t:Math.max(0,Math.min(1,A))}},c.prototype.lineSlice=function(b,w,P){var O=this.pointOnLine(P,b),I=this.pointOnLine(P,w);if(O.index>I.index||O.index===I.index&&O.t>I.t){var A=O;O=I,I=A}var l=[O.point],u=O.index+1,p=I.index;!f(P[u],l[0])&&u<=p&&l.push(P[u]);for(var m=u+1;m<=p;m++)l.push(P[m]);return f(P[p],I.point)||l.push(I.point),l},c.prototype.lineSliceAlong=function(b,w,P){for(var O=0,I=[],A=0;A<P.length-1;A++){var l=P[A],u=P[A+1],p=this.distance(l,u);if((O+=p)>b&&0===I.length&&I.push(g(l,u,(b-(O-p))/p)),O>=w)return I.push(g(l,u,(w-(O-p))/p)),I;O>b&&I.push(u)}return I},c.prototype.bufferPoint=function(b,w){var P=w/this.ky,O=w/this.kx;return[b[0]-O,b[1]-P,b[0]+O,b[1]+P]},c.prototype.bufferBBox=function(b,w){var P=w/this.ky,O=w/this.kx;return[b[0]-O,b[1]-P,b[2]+O,b[3]+P]},c.prototype.insideBBox=function(b,w){return y(b[0]-w[0])>=0&&y(b[0]-w[2])<=0&&b[1]>=w[1]&&b[1]<=w[3]},Object.defineProperties(c,d),c}();var _d=We(qo.exports),Qo={exports:{}};Qo.exports=function(){var e=function(r,s){if(void 0===r&&(r=[]),void 0===s&&(s=t),this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(var c=(this.length>>1)-1;c>=0;c--)this._down(c)};function t(r,s){return r<s?-1:r>s?1:0}return e.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},e.prototype.pop=function(){if(0!==this.length){var r=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),r}},e.prototype.peek=function(){return this.data[0]},e.prototype._up=function(r){for(var s=this.data,c=this.compare,d=s[r];r>0;){var f=r-1>>1,g=s[f];if(c(d,g)>=0)break;s[r]=g,r=f}s[r]=d},e.prototype._down=function(r){for(var s=this.data,c=this.compare,d=this.length>>1,f=s[r];r<d;){var g=1+(r<<1),y=s[g],b=g+1;if(b<this.length&&c(s[b],y)<0&&(g=b,y=s[b]),c(y,f)>=0)break;s[r]=y,r=g}s[r]=f},e}();var Ch=We(Qo.exports),Dt=8192;function Lo(e,t){return t.dist-e.dist}const hg=100,Mc=50;function Gm(e){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Vl(e){return e[1]-e[0]+1}function qa(e,t){const r=e[1]>=e[0]&&e[1]<t;return r||console.warn("Distance Expression: Index is out of range"),r}function Pc(e,t){if(e[0]>e[1])return[null,null];const r=Vl(e);if(t){if(2===r)return[e,null];const s=Math.floor(r/2);return[[e[0],e[0]+s],[e[0]+s,e[1]]]}{if(1===r)return[e,null];const s=Math.floor(r/2)-1;return[[e[0],e[0]+s],[e[0]+s+1,e[1]]]}}function jl(e,t){const r=[1/0,1/0,-1/0,-1/0];if(!qa(t,e.length))return r;for(let s=t[0];s<=t[1];++s)bh(r,e[s]);return r}function $l(e){const t=[1/0,1/0,-1/0,-1/0];for(let r=0;r<e.length;++r)for(let s=0;s<e[r].length;++s)bh(t,e[r][s]);return t}function Za(e,t,r){if(Gm(e)||Gm(t))return NaN;let s=0,c=0;return e[2]<t[0]&&(s=t[0]-e[2]),e[0]>t[2]&&(s=e[0]-t[2]),e[1]>t[3]&&(c=e[1]-t[3]),e[3]<t[1]&&(c=t[1]-e[3]),r.distance([0,0],[s,c])}function Gl(e,t){const r=Math.pow(2,t.z);return[(c=(e.x/Dt+t.x)/r,360*c-180),(s=(e.y/Dt+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90)];var s,c}function Mh(e,t){const r=[];for(let s=0;s<e.length;++s)r.push(Gl(e[s],t));return r}function Wf(e,t,r){const s=r.pointOnLine(t,e).point;return r.distance(e,s)}function Hm(e,t,r,s,c){const d=r.slice(s[0],s[1]+1);let f=1/0;for(let g=t[0];g<=t[1];++g)if(0===(f=Math.min(f,Wf(e[g],d,c))))return 0;return f}function qm(e,t,r,s,c){const d=Math.min(c.pointToSegmentDistance(e,r,s),c.pointToSegmentDistance(t,r,s)),f=Math.min(c.pointToSegmentDistance(r,e,t),c.pointToSegmentDistance(s,e,t));return Math.min(d,f)}function Zm(e,t,r,s,c){if(!qa(t,e.length)||!qa(s,r.length))return NaN;let d=1/0;for(let f=t[0];f<t[1];++f)for(let g=s[0];g<s[1];++g){if(fu(e[f],e[f+1],r[g],r[g+1]))return 0;d=Math.min(d,qm(e[f],e[f+1],r[g],r[g+1],c))}return d}function Wm(e,t,r,s,c){if(!qa(t,e.length)||!qa(s,r.length))return NaN;let d=1/0;for(let f=t[0];f<=t[1];++f)for(let g=s[0];g<=s[1];++g)if(0===(d=Math.min(d,c.distance(e[f],r[g]))))return d;return d}function Km(e,t,r){if(Ps(e,t,!0))return 0;let s=1/0;for(const c of t){const d=c.length;if(d<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(c[0]!==c[d-1]&&0===(s=Math.min(s,r.pointToSegmentDistance(e,c[d-1],c[0])))||0===(s=Math.min(s,Wf(e,c,r))))return s}return s}function Ph(e,t,r,s){if(!qa(t,e.length))return NaN;for(let d=t[0];d<=t[1];++d)if(Ps(e[d],r,!0))return 0;let c=1/0;for(let d=t[0];d<t[1];++d)for(const f of r)for(let g=0,y=f.length,b=y-1;g<y;b=g++){if(fu(e[d],e[d+1],f[b],f[g]))return 0;c=Math.min(c,qm(e[d],e[d+1],f[b],f[g],s))}return c}function Eh(e,t){for(const r of e)for(let s=0;s<=r.length-1;++s)if(Ps(r[s],t,!0))return!0;return!1}function yd(e,t,r,s=1/0){const c=$l(e),d=$l(t);if(s!==1/0&&Za(c,d,r)>=s)return s;if(ug(c,d)){if(Eh(e,t))return 0}else if(Eh(t,e))return 0;let f=s;for(const g of e)for(let y=0,b=g.length,w=b-1;y<b;w=y++)for(const P of t)for(let O=0,I=P.length,A=I-1;O<I;A=O++){if(fu(g[w],g[y],P[A],P[O]))return 0;f=Math.min(f,qm(g[w],g[y],P[A],P[O],r))}return f}function Oh(e,t,r,s,c,d,f){if(null===d||null===f)return;const g=Za(jl(s,d),jl(c,f),r);g<t&&e.push({dist:g,range1:d,range2:f})}function fg(e,t,r,s,c=1/0){let d=Math.min(s.distance(e[0],r[0][0]),c);if(0===d)return d;const f=new Ch([{dist:0,range1:[0,e.length-1],range2:[0,0]}],Lo),g=t?Mc:hg,y=$l(r);for(;f.length;){const b=f.pop();if(b.dist>=d)continue;const w=b.range1;if(Vl(w)<=g){if(!qa(w,e.length))return NaN;if(t){const P=Ph(e,w,r,s);if(0===(d=Math.min(d,P)))return d}else for(let P=w[0];P<=w[1];++P){const O=Km(e[P],r,s);if(0===(d=Math.min(d,O)))return d}}else{const P=Pc(w,t);if(null!==P[0]){const O=Za(jl(e,P[0]),y,s);O<d&&f.push({dist:O,range1:P[0],range2:[0,0]})}if(null!==P[1]){const O=Za(jl(e,P[1]),y,s);O<d&&f.push({dist:O,range1:P[1],range2:[0,0]})}}}return d}function Kf(e,t,r,s,c,d=1/0){let f=Math.min(d,c.distance(e[0],r[0]));if(0===f)return f;const g=new Ch([{dist:0,range1:[0,e.length-1],range2:[0,r.length-1]}],Lo),y=t?Mc:hg,b=s?Mc:hg;for(;g.length;){const w=g.pop();if(w.dist>=f)continue;const P=w.range1,O=w.range2;if(Vl(P)<=y&&Vl(O)<=b){if(!qa(P,e.length)||!qa(O,r.length))return NaN;if(t&&s?f=Math.min(f,Zm(e,P,r,O,c)):t||s?t&&!s?f=Math.min(f,Hm(r,O,e,P,c)):!t&&s&&(f=Math.min(f,Hm(e,P,r,O,c))):f=Math.min(f,Wm(e,P,r,O,c)),0===f)return f}else{const I=Pc(P,t),A=Pc(O,s);Oh(g,f,c,e,r,I[0],A[0]),Oh(g,f,c,e,r,I[0],A[1]),Oh(g,f,c,e,r,I[1],A[0]),Oh(g,f,c,e,r,I[1],A[1])}}return f}function vd(e,t,r,s,c=1/0){let d=c;const f=jl(e,[0,e.length-1]);for(const g of r)if(!(d!==1/0&&Za(f,jl(g,[0,g.length-1]),s)>=d)&&(d=Math.min(d,Kf(e,t,g,!0,s,d)),0===d))return d;return d}function pg(e,t,r,s,c=1/0){let d=c;const f=jl(e,[0,e.length-1]);for(const g of r){if(d!==1/0&&Za(f,$l(g),s)>=d)continue;const y=fg(e,t,g,s,d);if(isNaN(y))return y;if(0===(d=Math.min(d,y)))return d}return d}function bd(e){return"Point"===e||"MultiPoint"===e||"LineString"===e||"MultiLineString"===e||"Polygon"===e||"MultiPolygon"===e}class xd{constructor(t,r){this.type=Ae,this.geojson=t,this.geometries=r}static parse(t,r){if(2!==t.length)return r.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(Yn(t[1])){const s=t[1];if("FeatureCollection"===s.type){for(let c=0;c<s.features.length;++c)if(bd(s.features[c].geometry.type))return new xd(s,s.features[c].geometry)}else if("Feature"===s.type){if(bd(s.geometry.type))return new xd(s,s.geometry)}else if(bd(s.type))return new xd(s,s)}return r.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const r=t.geometry(),s=t.canonicalID();if(null!=r&&null!=s){if("Point"===t.geometryType())return function(c,d,f){const g=[];for(const b of c)for(const w of b)g.push(Gl(w,d));const y=new _d(g[0][1],"meters");return"Point"===f.type||"MultiPoint"===f.type||"LineString"===f.type?Kf(g,!1,"Point"===f.type?[f.coordinates]:f.coordinates,"LineString"===f.type,y):"MultiLineString"===f.type?vd(g,!1,f.coordinates,y):"Polygon"===f.type||"MultiPolygon"===f.type?pg(g,!1,"Polygon"===f.type?[f.coordinates]:f.coordinates,y):null}(r,s,this.geometries);if("LineString"===t.geometryType())return function(c,d,f){const g=[];for(const b of c){const w=[];for(const P of b)w.push(Gl(P,d));g.push(w)}const y=new _d(g[0][0][1],"meters");if("Point"===f.type||"MultiPoint"===f.type||"LineString"===f.type)return vd("Point"===f.type?[f.coordinates]:f.coordinates,"LineString"===f.type,g,y);if("MultiLineString"===f.type){let b=1/0;for(let w=0;w<f.coordinates.length;w++){const P=vd(f.coordinates[w],!0,g,y,b);if(isNaN(P))return P;if(0===(b=Math.min(b,P)))return b}return b}if("Polygon"===f.type||"MultiPolygon"===f.type){let b=1/0;for(let w=0;w<g.length;w++){const P=pg(g[w],!0,"Polygon"===f.type?[f.coordinates]:f.coordinates,y,b);if(isNaN(P))return P;if(0===(b=Math.min(b,P)))return b}return b}return null}(r,s,this.geometries);if("Polygon"===t.geometryType())return function(c,d,f){const g=[];for(const b of function(w,P){const O=w.length;if(O<=1)return[w];const I=[];let A,l;for(let u=0;u<O;u++){const p=pw(w[u]);0!==p&&(w[u].area=Math.abs(p),void 0===l&&(l=p<0),l===p<0?(A&&I.push(A),A=[w[u]]):A.push(w[u]))}return A&&I.push(A),I}(c)){const w=[];for(let P=0;P<b.length;++P)w.push(Mh(b[P],d));g.push(w)}const y=new _d(g[0][0][0][1],"meters");if("Point"===f.type||"MultiPoint"===f.type||"LineString"===f.type)return pg("Point"===f.type?[f.coordinates]:f.coordinates,"LineString"===f.type,g,y);if("MultiLineString"===f.type){let b=1/0;for(let w=0;w<f.coordinates.length;w++){const P=pg(f.coordinates[w],!0,g,y,b);if(isNaN(P))return P;if(0===(b=Math.min(b,P)))return b}return b}return"Polygon"===f.type||"MultiPolygon"===f.type?function(b,w,P){let O=1/0;for(const I of b)for(const A of w){const l=yd(I,A,P,O);if(isNaN(l))return l;if(0===(O=Math.min(O,l)))return O}return O}("Polygon"===f.type?[f.coordinates]:f.coordinates,g,y):null}(r,s,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var Yf=xd;function Th(e){if(e instanceof vl&&("get"===e.name&&1===e.args.length||"feature-state"===e.name||"has"===e.name&&1===e.args.length||"properties"===e.name||"geometry-type"===e.name||"id"===e.name||/^filter-/.test(e.name))||e instanceof wh||e instanceof Yf)return!1;let t=!0;return e.eachChild(r=>{t&&!Th(r)&&(t=!1)}),t}function Ec(e){if(e instanceof vl&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild(r=>{t&&!Ec(r)&&(t=!1)}),t}function gg(e){if(e instanceof vl&&"config"===e.name)return!1;let t=!0;return e.eachChild(r=>{t&&!gg(r)&&(t=!1)}),t}function gu(e,t){if(e instanceof vl&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild(s=>{r&&!gu(s,t)&&(r=!1)}),r}class mu{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(2!==t.length||"string"!=typeof t[1])return r.error("'var' expression requires exactly one string literal argument.");const s=t[1];return r.scope.has(s)?new mu(s,r.scope.get(s)):r.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Ih=mu;class wa{constructor(t,r=[],s,c=new Vm,d=[],f){this.registry=t,this.path=r,this.key=r.map(g=>`[${g}]`).join(""),this.scope=c,this.errors=d,this.expectedType=s,this.options=f}parse(t,r,s,c,d={}){return r||s?this.concat(r,s,c)._parse(t,d):this._parse(t,d)}_parse(t,r){function s(c,d,f){return"assert"===f?new Fi(d,[c]):"coerce"===f?new Ga(d,[c]):c}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const c="string"==typeof t[0]?this.registry[t[0]]:void 0;if(c){let d=c.parse(t,this);if(!d)return null;if(this.expectedType){const f=this.expectedType,g=d.type;if("string"!==f.kind&&"number"!==f.kind&&"boolean"!==f.kind&&"object"!==f.kind&&"array"!==f.kind||"value"!==g.kind)if("color"!==f.kind&&"formatted"!==f.kind&&"resolvedImage"!==f.kind||"value"!==g.kind&&"string"!==g.kind){if(this.checkSubtype(f,g))return null}else d=s(d,f,r.typeAnnotation||"coerce");else d=s(d,f,r.typeAnnotation||"assert")}if(!(d instanceof Ms)&&"resolvedImage"!==d.type.kind&&Oc(d)){const f=new hu(this.options);try{d=new Ms(d.type,d.evaluate(f))}catch(g){return this.error(g.message),null}}return d}return Ga.parse(["to-array",t],this)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,s){const c="number"==typeof t?this.path.concat(t):this.path,d=s?this.scope.concat(s):this.scope;return new wa(this.registry,c,r||null,d,this.errors,this.options)}error(t,...r){const s=`${this.key}${r.map(c=>`[${c}]`).join("")}`;this.errors.push(new ho(s,t))}checkSubtype(t,r){const s=Xo(t,r);return s&&this.error(s),s}}var wd=wa;function Oc(e){if(e instanceof Ih)return Oc(e.boundExpression);if(e instanceof vl&&"error"===e.name||e instanceof vl&&"config"===e.name||e instanceof vh||e instanceof wh||e instanceof Yf)return!1;const t=e instanceof Ga||e instanceof Fi;let r=!0;return e.eachChild(s=>{r=t?r&&Oc(s):r&&s instanceof Ms}),!!r&&Th(e)&&gu(e,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function Cd(e,t){const r=e.length-1;let s,c,d=0,f=r,g=0;for(;d<=f;)if(g=Math.floor((d+f)/2),s=e[g],c=e[g+1],s<=t){if(g===r||t<c)return g;d=g+1}else{if(!(s>t))throw new Wi("Input is not a number.");f=g-1}return 0}class Sh{constructor(t,r,s){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[c,d]of s)this.labels.push(c),this.outputs.push(d)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const s=r.parse(t[1],1,Ae);if(!s)return null;const c=[];let d=null;r.expectedType&&"value"!==r.expectedType.kind&&(d=r.expectedType);for(let f=1;f<t.length;f+=2){const g=1===f?-1/0:t[f],y=t[f+1],b=f,w=f+1;if("number"!=typeof g)return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',b);if(c.length&&c[c.length-1][0]>=g)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',b);const P=r.parse(y,w,d);if(!P)return null;d=d||P.type,c.push([g,P])}return new Sh(d,s,c)}evaluate(t){const r=this.labels,s=this.outputs;if(1===r.length)return s[0].evaluate(t);const c=this.input.evaluate(t);if(c<=r[0])return s[0].evaluate(t);const d=r.length;return c>=r[d-1]?s[d-1].evaluate(t):s[Cd(r,c)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&t.push(this.labels[r]),t.push(this.outputs[r].serialize());return t}}var Ym=Sh;function vn(e,t,r){return e*(1-r)+t*r}function mg(e,t,r){return e.map((s,c)=>vn(s,t[c],r))}var Md=Object.freeze({__proto__:null,array:mg,color:function(e,t,r){return new bn(vn(e.r,t.r,r),vn(e.g,t.g,r),vn(e.b,t.b,r),vn(e.a,t.a,r))},number:vn});const hs=4/29,Tc=6/29,Xm=3*Tc*Tc,zi=Tc*Tc*Tc,Xf=Math.PI/180,_u=180/Math.PI;function Jo(e){return e>zi?Math.pow(e,1/3):e/Xm+hs}function Qf(e){return e>Tc?e*e*e:Xm*(e-hs)}function yu(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function vu(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ua(e){const t=vu(e.r),r=vu(e.g),s=vu(e.b),c=Jo((.4124564*t+.3575761*r+.1804375*s)/.95047),d=Jo((.2126729*t+.7151522*r+.072175*s)/1);return{l:116*d-16,a:500*(c-d),b:200*(d-Jo((.0193339*t+.119192*r+.9503041*s)/1.08883)),alpha:e.a}}function Ic(e){let t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,s=isNaN(e.b)?t:t-e.b/200;return t=1*Qf(t),r=.95047*Qf(r),s=1.08883*Qf(s),new bn(yu(3.2404542*r-1.5371385*t-.4985314*s),yu(-.969266*r+1.8760108*t+.041556*s),yu(.0556434*r-.2040259*t+1.0572252*s),e.alpha)}function gw(e,t,r){const s=t-e;return e+r*(s>180||s<-180?s-360*Math.round(s/360):s)}const mo={forward:ua,reverse:Ic,interpolate:function(e,t,r){return{l:vn(e.l,t.l,r),a:vn(e.a,t.a,r),b:vn(e.b,t.b,r),alpha:vn(e.alpha,t.alpha,r)}}},Es={forward:function(e){const{l:t,a:r,b:s}=ua(e),c=Math.atan2(s,r)*_u;return{h:c<0?c+360:c,c:Math.sqrt(r*r+s*s),l:t,alpha:e.a}},reverse:function(e){const t=e.h*Xf,r=e.c;return Ic({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:gw(e.h,t.h,r),c:vn(e.c,t.c,r),l:vn(e.l,t.l,r),alpha:vn(e.alpha,t.alpha,r)}}};var Jf=Object.freeze({__proto__:null,hcl:Es,lab:mo});class tp{constructor(t,r,s,c,d){this.type=t,this.operator=r,this.interpolation=s,this.input=c,this.labels=[],this.outputs=[];for(const[f,g]of d)this.labels.push(f),this.outputs.push(g)}static interpolationFactor(t,r,s,c){let d=0;if("exponential"===t.name)d=Pd(r,t.base,s,c);else if("linear"===t.name)d=Pd(r,1,s,c);else if("cubic-bezier"===t.name){const f=t.controlPoints;d=new Fn(f[0],f[1],f[2],f[3]).solve(Pd(r,1,s,c))}return d}static parse(t,r){let[s,c,d,...f]=t;if(!Array.isArray(c)||0===c.length)return r.error("Expected an interpolation type expression.",1);if("linear"===c[0])c={name:"linear"};else if("exponential"===c[0]){const b=c[1];if("number"!=typeof b)return r.error("Exponential interpolation requires a numeric base.",1,1);c={name:"exponential",base:b}}else{if("cubic-bezier"!==c[0])return r.error(`Unknown interpolation type ${String(c[0])}`,1,0);{const b=c.slice(1);if(4!==b.length||b.some(w=>"number"!=typeof w||w<0||w>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);c={name:"cubic-bezier",controlPoints:b}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(d=r.parse(d,2,Ae),!d)return null;const g=[];let y=null;"interpolate-hcl"===s||"interpolate-lab"===s?y=Jr:r.expectedType&&"value"!==r.expectedType.kind&&(y=r.expectedType);for(let b=0;b<f.length;b+=2){const w=f[b],P=f[b+1],O=b+3,I=b+4;if("number"!=typeof w)return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(g.length&&g[g.length-1][0]>=w)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const A=r.parse(P,I,y);if(!A)return null;y=y||A.type,g.push([w,A])}return"number"===y.kind||"color"===y.kind||"array"===y.kind&&"number"===y.itemType.kind&&"number"==typeof y.N?new tp(y,s,c,d,g):r.error(`Type ${ni(y)} is not interpolatable.`)}evaluate(t){const r=this.labels,s=this.outputs;if(1===r.length)return s[0].evaluate(t);const c=this.input.evaluate(t);if(c<=r[0])return s[0].evaluate(t);const d=r.length;if(c>=r[d-1])return s[d-1].evaluate(t);const f=Cd(r,c),g=tp.interpolationFactor(this.interpolation,c,r[f],r[f+1]),y=s[f].evaluate(t),b=s[f+1].evaluate(t);return"interpolate"===this.operator?Md[this.type.kind.toLowerCase()](y,b,g):"interpolate-hcl"===this.operator?Es.reverse(Es.interpolate(Es.forward(y),Es.forward(b),g)):mo.reverse(mo.interpolate(mo.forward(y),mo.forward(b),g))}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,t,this.input.serialize()];for(let s=0;s<this.labels.length;s++)r.push(this.labels[s],this.outputs[s].serialize());return r}}function Pd(e,t,r,s){const c=s-r,d=e-r;return 0===c?0:1===t?d/c:(Math.pow(t,d)-1)/(Math.pow(t,c)-1)}var Wa=tp;class bu{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expectected at least one argument.");let s=null;const c=r.expectedType;c&&"value"!==c.kind&&(s=c);const d=[];for(const g of t.slice(1)){const y=r.parse(g,1+d.length,s,void 0,{typeAnnotation:"omit"});if(!y)return null;s=s||y.type,d.push(y)}const f=c&&d.some(g=>Xo(c,g.type));return new bu(f?Ye:s,d)}evaluate(t){let r,s=null,c=0;for(const d of this.args){if(c++,s=d.evaluate(t),s&&s instanceof Ro&&!s.available&&(r||(r=s),s=null,c===this.args.length))return r;if(null!==s)break}return s}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(r=>{t.push(r.serialize())}),t}}var No=bu;class lr{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const s=[];for(let d=1;d<t.length-1;d+=2){const f=t[d];if("string"!=typeof f)return r.error(`Expected string, but found ${typeof f} instead.`,d);if(/[^a-zA-Z0-9_]/.test(f))return r.error("Variable names must contain only alphanumeric characters or '_'.",d);const g=r.parse(t[d+1],d+1);if(!g)return null;s.push([f,g])}const c=r.parse(t[t.length-1],t.length-1,r.expectedType,s);return c?new lr(s,c):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[r,s]of this.bindings)t.push(r,s.serialize());return t.push(this.result.serialize()),t}}var xo=lr;class ep{constructor(t,r,s){this.type=t,this.index=r,this.input=s}static parse(t,r){if(3!==t.length)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,Ae),c=r.parse(t[2],2,Zr(r.expectedType||Ye));return s&&c?new ep(c.type.itemType,s,c):null}evaluate(t){const r=this.index.evaluate(t),s=this.input.evaluate(t);if(r<0)throw new Wi(`Array index out of bounds: ${r} < 0.`);if(r>=s.length)throw new Wi(`Array index out of bounds: ${r} > ${s.length-1}.`);if(r!==Math.floor(r))throw new Wi(`Array index must be an integer, but found ${r} instead.`);return s[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var xu=ep;class Dh{constructor(t,r){this.type=Tr,this.needle=t,this.haystack=r}static parse(t,r){if(3!==t.length)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,Ye),c=r.parse(t[2],2,Ye);return s&&c?pd(s.type,[Tr,br,Ae,ws,Ye])?new Dh(s,c):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${ni(s.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(null==s)return!1;if(!ar(r,["boolean","string","number","null"]))throw new Wi(`Expected first argument to be of type boolean, string, number or null, but found ${ni(go(r))} instead.`);if(!ar(s,["string","array"]))throw new Wi(`Expected second argument to be of type array or string, but found ${ni(go(s))} instead.`);return s.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Wy=Dh;class Ed{constructor(t,r,s){this.type=Ae,this.needle=t,this.haystack=r,this.fromIndex=s}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,Ye),c=r.parse(t[2],2,Ye);if(!s||!c)return null;if(!pd(s.type,[Tr,br,Ae,ws,Ye]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${ni(s.type)} instead`);if(4===t.length){const d=r.parse(t[3],3,Ae);return d?new Ed(s,c,d):null}return new Ed(s,c)}evaluate(t){const r=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!ar(r,["boolean","string","number","null"]))throw new Wi(`Expected first argument to be of type boolean, string, number or null, but found ${ni(go(r))} instead.`);if(!ar(s,["string","array"]))throw new Wi(`Expected second argument to be of type array or string, but found ${ni(go(s))} instead.`);if(this.fromIndex){const c=this.fromIndex.evaluate(t);return s.indexOf(r,c)}return s.indexOf(r)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var wu=Ed;class Sc{constructor(t,r,s,c,d,f){this.inputType=t,this.type=r,this.input=s,this.cases=c,this.outputs=d,this.otherwise=f}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let s,c;r.expectedType&&"value"!==r.expectedType.kind&&(c=r.expectedType);const d={},f=[];for(let b=2;b<t.length-1;b+=2){let w=t[b];const P=t[b+1];Array.isArray(w)||(w=[w]);const O=r.concat(b);if(0===w.length)return O.error("Expected at least one branch label.");for(const A of w){if("number"!=typeof A&&"string"!=typeof A)return O.error("Branch labels must be numbers or strings.");if("number"==typeof A&&Math.abs(A)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof A&&Math.floor(A)!==A)return O.error("Numeric branch labels must be integer values.");if(s){if(O.checkSubtype(s,go(A)))return null}else s=go(A);if(void 0!==d[String(A)])return O.error("Branch labels must be unique.");d[String(A)]=f.length}const I=r.parse(P,b,c);if(!I)return null;c=c||I.type,f.push(I)}const g=r.parse(t[1],1,Ye);if(!g)return null;const y=r.parse(t[t.length-1],t.length-1,c);return y?"value"!==g.type.kind&&r.concat(1).checkSubtype(s,g.type)?null:new Sc(s,c,g,d,f,y):null}evaluate(t){const r=this.input.evaluate(t);return(go(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),s=[],c={};for(const f of r){const g=c[this.cases[f]];void 0===g?(c[this.cases[f]]=s.length,s.push([this.cases[f],[f]])):s[g][1].push(f)}const d=f=>"number"===this.inputType.kind?Number(f):f;for(const[f,g]of s)t.push(1===g.length?d(g[0]):g.map(d)),t.push(this.outputs[f].serialize());return t.push(this.otherwise.serialize()),t}}var Qm=Sc;class Ks{constructor(t,r,s){this.type=t,this.branches=r,this.otherwise=s}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let s;r.expectedType&&"value"!==r.expectedType.kind&&(s=r.expectedType);const c=[];for(let f=1;f<t.length-1;f+=2){const g=r.parse(t[f],f,Tr);if(!g)return null;const y=r.parse(t[f+1],f+1,s);if(!y)return null;c.push([g,y]),s=s||y.type}const d=r.parse(t[t.length-1],t.length-1,s);return d?new Ks(s,c,d):null}evaluate(t){for(const[r,s]of this.branches)if(r.evaluate(t))return s.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,s]of this.branches)t(r),t(s);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(r=>{t.push(r.serialize())}),t}}var Jm=Ks;class np{constructor(t,r,s,c){this.type=t,this.input=r,this.beginIndex=s,this.endIndex=c}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,Ye),c=r.parse(t[2],2,Ae);if(!s||!c)return null;if(!pd(s.type,[Zr(Ye),br,Ye]))return r.error(`Expected first argument to be of type array or string, but found ${ni(s.type)} instead`);if(4===t.length){const d=r.parse(t[3],3,Ae);return d?new np(s.type,s,c,d):null}return new np(s.type,s,c)}evaluate(t){const r=this.input.evaluate(t),s=this.beginIndex.evaluate(t);if(!ar(r,["string","array"]))throw new Wi(`Expected first argument to be of type array or string, but found ${ni(go(r))} instead.`);if(this.endIndex){const c=this.endIndex.evaluate(t);return r.slice(s,c)}return r.slice(s)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Me=np;function ri(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function _g(e,t,r,s){return 0===s.compare(t,r)}function Od(e,t,r){const s="=="!==e&&"!="!==e;return class SN{constructor(d,f,g){this.type=Tr,this.lhs=d,this.rhs=f,this.collator=g,this.hasUntypedArgument="value"===d.type.kind||"value"===f.type.kind}static parse(d,f){if(3!==d.length&&4!==d.length)return f.error("Expected two or three arguments.");const g=d[0];let y=f.parse(d[1],1,Ye);if(!y)return null;if(!ri(g,y.type))return f.concat(1).error(`"${g}" comparisons are not supported for type '${ni(y.type)}'.`);let b=f.parse(d[2],2,Ye);if(!b)return null;if(!ri(g,b.type))return f.concat(2).error(`"${g}" comparisons are not supported for type '${ni(b.type)}'.`);if(y.type.kind!==b.type.kind&&"value"!==y.type.kind&&"value"!==b.type.kind)return f.error(`Cannot compare types '${ni(y.type)}' and '${ni(b.type)}'.`);s&&("value"===y.type.kind&&"value"!==b.type.kind?y=new Fi(b.type,[y]):"value"!==y.type.kind&&"value"===b.type.kind&&(b=new Fi(y.type,[b])));let w=null;if(4===d.length){if("string"!==y.type.kind&&"string"!==b.type.kind&&"value"!==y.type.kind&&"value"!==b.type.kind)return f.error("Cannot use collator to compare non-string types.");if(w=f.parse(d[3],3,Ai),!w)return null}return new SN(y,b,w)}evaluate(d){const f=this.lhs.evaluate(d),g=this.rhs.evaluate(d);if(s&&this.hasUntypedArgument){const y=go(f),b=go(g);if(y.kind!==b.kind||"string"!==y.kind&&"number"!==y.kind)throw new Wi(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${y.kind}, ${b.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const y=go(f),b=go(g);if("string"!==y.kind||"string"!==b.kind)return t(d,f,g)}return this.collator?r(d,f,g,this.collator.evaluate(d)):t(d,f,g)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){const d=[e];return this.eachChild(f=>{d.push(f.serialize())}),d}}}const fs=Od("==",function(e,t,r){return t===r},_g),t_=Od("!=",function(e,t,r){return t!==r},function(e,t,r,s){return!_g(0,t,r,s)}),rp=Od("<",function(e,t,r){return t<r},function(e,t,r,s){return s.compare(t,r)<0}),Ka=Od(">",function(e,t,r){return t>r},function(e,t,r,s){return s.compare(t,r)>0}),kh=Od("<=",function(e,t,r){return t<=r},function(e,t,r,s){return s.compare(t,r)<=0}),ip=Od(">=",function(e,t,r){return t>=r},function(e,t,r,s){return s.compare(t,r)>=0});class yg{constructor(t,r,s,c,d,f){this.type=br,this.number=t,this.locale=r,this.currency=s,this.unit=c,this.minFractionDigits=d,this.maxFractionDigits=f}static parse(t,r){if(3!==t.length)return r.error("Expected two arguments.");const s=r.parse(t[1],1,Ae);if(!s)return null;const c=t[2];if("object"!=typeof c||Array.isArray(c))return r.error("NumberFormat options argument must be an object.");let d=null;if(c.locale&&(d=r.parse(c.locale,1,br),!d))return null;let f=null;if(c.currency&&(f=r.parse(c.currency,1,br),!f))return null;let g=null;if(c.unit&&(g=r.parse(c.unit,1,br),!g))return null;let y=null;if(c["min-fraction-digits"]&&(y=r.parse(c["min-fraction-digits"],1,Ae),!y))return null;let b=null;return c["max-fraction-digits"]&&(b=r.parse(c["max-fraction-digits"],1,Ae),!b)?null:new yg(s,d,f,g,y,b)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class vg{constructor(t){this.type=Ae,this.input=t}static parse(t,r){if(2!==t.length)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=r.parse(t[1],1);return s?"array"!==s.type.kind&&"string"!==s.type.kind&&"value"!==s.type.kind?r.error(`Expected argument of type string or array, but found ${ni(s.type)} instead.`):new vg(s):null}evaluate(t){const r=this.input.evaluate(t);if("string"==typeof r||Array.isArray(r))return r.length;throw new Wi(`Expected value to be of type string or array, but found ${ni(go(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(r=>{t.push(r.serialize())}),t}}function Rh(e){return function(){e=1831565813+(e|=0)|0;let t=Math.imul(e^e>>>15,1|e);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const Ls={"==":fs,"!=":t_,">":Ka,"<":rp,">=":ip,"<=":kh,array:Fi,at:xu,boolean:Fi,case:Jm,coalesce:No,collator:vh,format:aa,image:bo,in:Wy,"index-of":wu,interpolate:Wa,"interpolate-hcl":Wa,"interpolate-lab":Wa,length:vg,let:xo,literal:Ms,match:Qm,number:Fi,"number-format":yg,object:Fi,slice:Me,step:Ym,string:Fi,"to-boolean":Ga,"to-color":Ga,"to-number":Ga,"to-string":Ga,var:Ih,within:wh,distance:Yf};function bl(e,[t,r,s,c]){t=t.evaluate(e),r=r.evaluate(e),s=s.evaluate(e);const d=c?c.evaluate(e):1,f=sa(t,r,s,d);if(f)throw new Wi(f);return new bn(t/255*d,r/255*d,s/255*d,d)}function Td(e,[t,r,s,c]){t=t.evaluate(e),r=r.evaluate(e),s=s.evaluate(e);const d=c?c.evaluate(e):1,f=(w=r,P=s,O=d,"number"==typeof(b=t)&&b>=0&&b<=360?"number"==typeof w&&w>=0&&w<=100&&"number"==typeof P&&P>=0&&P<=100?void 0===O||"number"==typeof O&&O>=0&&O<=1?null:`Invalid hsla value [${[b,w,P,O].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${("number"==typeof O?[b,w,P,O]:[b,w,P]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${("number"==typeof O?[b,w,P,O]:[b,w,P]).join(", ")}]: 'h' must be between 0 and 360.`);var b,w,P,O;if(f)throw new Wi(f);const g=`hsla(${t}, ${r}%, ${s}%, ${d})`,y=bn.parse(g);if(!y)throw new Wi(`Failed to parse HSLA color: ${g}`);return y}function Id(e,t){return e in t}function Ca(e,t){const r=t[e];return void 0===r?null:r}function e_(e,t){switch(e){case"string":return String(t);case"number":return+t;case"boolean":return!!t;case"color":return bn.parse(t)}return t}function op(e,t,r,s){return void 0!==s&&(e=s*Math.round(e/s)),void 0!==t&&e<t&&(e=t),void 0!==r&&e>r&&(e=r),e}function Ky(e,t,r){r.length&&(t+=`\x1f${r}`);const s=e.getConfig(t);if(!s)return null;const{type:c,value:d,values:f,minValue:g,maxValue:y,stepValue:b}=s,w=s.default.evaluate(e);let P=d?d.evaluate(e):w;return c&&(P=e_(c,P)),void 0!==d&&void 0!==P&&f&&!f.includes(P)&&(P=w,c&&(P=e_(c,P))),void 0===P||void 0===g&&void 0===y&&void 0===b||("number"==typeof P?P=op(P,g,y,b):Array.isArray(P)&&(P=P.map(O=>"number"==typeof O?op(O,g,y,b):O))),P}function Ac(e){return{type:e}}vl.register(Ls,{error:[{kind:"error"},[br],(e,[t])=>{throw new Wi(t.evaluate(e))}],typeof:[br,[Ye],(e,[t])=>ni(go(t.evaluate(e)))],"to-rgba":[Zr(Ae,4),[Jr],(e,[t])=>t.evaluate(e).toArray()],rgb:[Jr,[Ae,Ae,Ae],bl],rgba:[Jr,[Ae,Ae,Ae,Ae],bl],hsl:[Jr,[Ae,Ae,Ae],Td],hsla:[Jr,[Ae,Ae,Ae,Ae],Td],has:{type:Tr,overloads:[[[br],(e,[t])=>Id(t.evaluate(e),e.properties())],[[br,dn],(e,[t,r])=>Id(t.evaluate(e),r.evaluate(e))]]},get:{type:Ye,overloads:[[[br],(e,[t])=>Ca(t.evaluate(e),e.properties())],[[br,dn],(e,[t,r])=>Ca(t.evaluate(e),r.evaluate(e))]]},config:{type:Ye,overloads:[[[br],(e,[t])=>Ky(e,t.evaluate(e),"")],[[br,br],(e,[t,r])=>Ky(e,t.evaluate(e),r.evaluate(e))]]},"feature-state":[Ye,[br],(e,[t])=>Ca(t.evaluate(e),e.featureState||{})],properties:[dn,[],e=>e.properties()],"geometry-type":[br,[],e=>e.geometryType()],id:[Ye,[],e=>e.id()],zoom:[Ae,[],e=>e.globals.zoom],pitch:[Ae,[],e=>e.globals.pitch||0],"distance-from-center":[Ae,[],e=>e.distanceFromCenter()],"measure-light":[Ae,[br],(e,[t])=>e.measureLight(t.evaluate(e))],"heatmap-density":[Ae,[],e=>e.globals.heatmapDensity||0],"line-progress":[Ae,[],e=>e.globals.lineProgress||0],"raster-value":[Ae,[],e=>e.globals.rasterValue||0],"sky-radial-progress":[Ae,[],e=>e.globals.skyRadialProgress||0],accumulated:[Ye,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[Ae,Ac(Ae),(e,t)=>{let r=0;for(const s of t)r+=s.evaluate(e);return r}],"*":[Ae,Ac(Ae),(e,t)=>{let r=1;for(const s of t)r*=s.evaluate(e);return r}],"-":{type:Ae,overloads:[[[Ae,Ae],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[Ae],(e,[t])=>-t.evaluate(e)]]},"/":[Ae,[Ae,Ae],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[Ae,[Ae,Ae],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[Ae,[],()=>Math.LN2],pi:[Ae,[],()=>Math.PI],e:[Ae,[],()=>Math.E],"^":[Ae,[Ae,Ae],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[Ae,[Ae],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[Ae,[Ae],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[Ae,[Ae],(e,[t])=>Math.log(t.evaluate(e))],log2:[Ae,[Ae],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[Ae,[Ae],(e,[t])=>Math.sin(t.evaluate(e))],cos:[Ae,[Ae],(e,[t])=>Math.cos(t.evaluate(e))],tan:[Ae,[Ae],(e,[t])=>Math.tan(t.evaluate(e))],asin:[Ae,[Ae],(e,[t])=>Math.asin(t.evaluate(e))],acos:[Ae,[Ae],(e,[t])=>Math.acos(t.evaluate(e))],atan:[Ae,[Ae],(e,[t])=>Math.atan(t.evaluate(e))],min:[Ae,Ac(Ae),(e,t)=>Math.min(...t.map(r=>r.evaluate(e)))],max:[Ae,Ac(Ae),(e,t)=>Math.max(...t.map(r=>r.evaluate(e)))],abs:[Ae,[Ae],(e,[t])=>Math.abs(t.evaluate(e))],round:[Ae,[Ae],(e,[t])=>{const r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Ae,[Ae],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[Ae,[Ae],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[Tr,[br,Ye],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[Tr,[Ye],(e,[t])=>e.id()===t.value],"filter-type-==":[Tr,[br],(e,[t])=>e.geometryType()===t.value],"filter-<":[Tr,[br,Ye],(e,[t,r])=>{const s=e.properties()[t.value],c=r.value;return typeof s==typeof c&&s<c}],"filter-id-<":[Tr,[Ye],(e,[t])=>{const r=e.id(),s=t.value;return typeof r==typeof s&&r<s}],"filter->":[Tr,[br,Ye],(e,[t,r])=>{const s=e.properties()[t.value],c=r.value;return typeof s==typeof c&&s>c}],"filter-id->":[Tr,[Ye],(e,[t])=>{const r=e.id(),s=t.value;return typeof r==typeof s&&r>s}],"filter-<=":[Tr,[br,Ye],(e,[t,r])=>{const s=e.properties()[t.value],c=r.value;return typeof s==typeof c&&s<=c}],"filter-id-<=":[Tr,[Ye],(e,[t])=>{const r=e.id(),s=t.value;return typeof r==typeof s&&r<=s}],"filter->=":[Tr,[br,Ye],(e,[t,r])=>{const s=e.properties()[t.value],c=r.value;return typeof s==typeof c&&s>=c}],"filter-id->=":[Tr,[Ye],(e,[t])=>{const r=e.id(),s=t.value;return typeof r==typeof s&&r>=s}],"filter-has":[Tr,[Ye],(e,[t])=>t.value in e.properties()],"filter-has-id":[Tr,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[Tr,[Zr(br)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[Tr,[Zr(Ye)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[Tr,[br,Zr(Ye)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[Tr,[br,Zr(Ye)],(e,[t,r])=>function(s,c,d,f){for(;d<=f;){const g=d+f>>1;if(c[g]===s)return!0;c[g]>s?f=g-1:d=g+1}return!1}(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:Tr,overloads:[[[Tr,Tr],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[Ac(Tr),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:Tr,overloads:[[[Tr,Tr],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[Ac(Tr),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[Tr,[Tr],(e,[t])=>!t.evaluate(e)],"is-supported-script":[Tr,[br],(e,[t])=>{const r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[br,[br],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[br,[br],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[br,Ac(Ye),(e,t)=>t.map(r=>zl(r.evaluate(e))).join("")],"resolved-locale":[br,[Ai],(e,[t])=>t.evaluate(e).resolvedLocale()],random:[Ae,[Ae,Ae,Ye],(e,t)=>{const[r,s,c]=t.map(f=>f.evaluate(e));if(r>s||r===s)return r;let d;if("string"==typeof c)d=function(f){let g=0;if(0===f.length)return g;for(let y=0;y<f.length;y++)g=(g<<5)-g+f.charCodeAt(y),g&=g;return g}(c);else{if("number"!=typeof c)throw new Wi(`Invalid seed input: ${c}`);d=c}return r+Rh(d)()*(s-r)}]});var Dc=Ls;function Ma(e){return{result:"success",value:e}}function Wr(e){return{result:"error",value:e}}function da(e,t){return!!e&&!!e.parameters&&e.parameters.indexOf(t)>-1}function Ns(e){return"data-driven"===e["property-type"]}function Cu(e){return da(e.expression,"measure-light")}function kc(e){return da(e.expression,"zoom")}function Rc(e){return!!e.expression&&e.expression.interpolated}function xl(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function n_(e){return e}function Mu(e,t){const r="color"===t.type,s=e.stops&&"object"==typeof e.stops[0][0],c=s||!(s||void 0!==e.property),d=e.type||(Rc(t)?"exponential":"interval");if(r&&((e=Zs({},e)).stops&&(e.stops=e.stops.map(b=>[b[0],bn.parse(b[1])])),e.default=bn.parse(e.default?e.default:t.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!Jf[e.colorSpace])throw new Error(`Unknown color space: ${e.colorSpace}`);let f,g,y;if("exponential"===d)f=ro;else if("interval"===d)f=bg;else if("categorical"===d){f=ql,g=Object.create(null);for(const b of e.stops)g[b[0]]=b[1];y=typeof e.stops[0][0]}else{if("identity"!==d)throw new Error(`Unknown function type "${d}"`);f=Eu}if(s){const b={},w=[];for(let I=0;I<e.stops.length;I++){const A=e.stops[I],l=A[0].zoom;void 0===b[l]&&(b[l]={zoom:l,type:e.type,property:e.property,default:e.default,stops:[]},w.push(l)),b[l].stops.push([A[0].value,A[1]])}const P=[];for(const I of w)P.push([b[I].zoom,Mu(b[I],t)]);const O={name:"linear"};return{kind:"composite",interpolationType:O,interpolationFactor:Wa.interpolationFactor.bind(void 0,O),zoomStops:P.map(I=>I[0]),evaluate:({zoom:I},A)=>ro({stops:P,base:e.base},t,I).evaluate(I,A)}}if(c){const b="exponential"===d?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:b,interpolationFactor:Wa.interpolationFactor.bind(void 0,b),zoomStops:e.stops.map(w=>w[0]),evaluate:({zoom:w})=>f(e,t,w,g,y)}}return{kind:"source",evaluate(b,w){const P=w&&w.properties?w.properties[e.property]:void 0;return void 0===P?Pu(e.default,t.default):f(e,t,P,g,y)}}}function Pu(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function ql(e,t,r,s,c){return Pu(typeof r===c?s[r]:void 0,e.default,t.default)}function bg(e,t,r){if("number"!==Un(r))return Pu(e.default,t.default);const s=e.stops.length;if(1===s||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[s-1][0])return e.stops[s-1][1];const c=Cd(e.stops.map(d=>d[0]),r);return e.stops[c][1]}function ro(e,t,r){const s=void 0!==e.base?e.base:1;if("number"!==Un(r))return Pu(e.default,t.default);const c=e.stops.length;if(1===c||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[c-1][0])return e.stops[c-1][1];const d=Cd(e.stops.map(w=>w[0]),r),f=function(w,P,O,I){const A=I-O,l=w-O;return 0===A?0:1===P?l/A:(Math.pow(P,l)-1)/(Math.pow(P,A)-1)}(r,s,e.stops[d][0],e.stops[d+1][0]),g=e.stops[d][1],y=e.stops[d+1][1];let b=Md[t.type]||n_;if(e.colorSpace&&"rgb"!==e.colorSpace){const w=Jf[e.colorSpace];b=(P,O)=>w.reverse(w.interpolate(w.forward(P),w.forward(O),f))}return"function"==typeof g.evaluate?{evaluate(...w){const P=g.evaluate.apply(void 0,w),O=y.evaluate.apply(void 0,w);if(void 0!==P&&void 0!==O)return b(P,O,f)}}:b(g,y,f)}function Eu(e,t,r){return"color"===t.type?r=bn.parse(r):"formatted"===t.type?r=po.fromString(r.toString()):"resolvedImage"===t.type?r=Ro.fromString(r.toString()):Un(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0),Pu(r,e.default,t.default)}class Yi{constructor(t,r,s){var c;this.expression=t,this._warningHistory={},this._evaluator=new hu(s),this._defaultValue=r?"color"===(c=r).type&&(xl(c.default)||Array.isArray(c.default))?new bn(0,0,0,0):"color"===c.type?bn.parse(c.default)||null:void 0===c.default?null:c.default:null,this._enumValues=r&&"enum"===r.type?r.values:null}evaluateWithoutErrorHandling(t,r,s,c,d,f,g,y){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=s,this._evaluator.canonical=c||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=f,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=y||null,this.expression.evaluate(this._evaluator)}evaluate(t,r,s,c,d,f,g,y){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=s||null,this._evaluator.canonical=c||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=f||null,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=y||null;try{const b=this.expression.evaluate(this._evaluator);if(null==b||"number"==typeof b&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Wi(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Zl(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Dc}function Wl(e,t,r){const s=new wd(Dc,[],t?function(d){const f={color:Jr,string:br,number:Ae,enum:br,boolean:Tr,formatted:Cs,resolvedImage:ja};return"array"===d.type?Zr(f[d.value]||Ye,d.length):f[d.type]}(t):void 0,void 0,void 0,r),c=s.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return c?Ma(new Yi(c,t,r)):Wr(s.errors)}class xg{constructor(t,r,s){this.kind=t,this._styleExpression=r,this.isLightConstant=s,this.isStateDependent="constant"!==t&&!Ec(r.expression),this.isConfigDependent=!gg(r.expression)}evaluateWithoutErrorHandling(t,r,s,c,d,f){return this._styleExpression.evaluateWithoutErrorHandling(t,r,s,c,d,f)}evaluate(t,r,s,c,d,f){return this._styleExpression.evaluate(t,r,s,c,d,f)}}class Os{constructor(t,r,s,c,d){this.kind=t,this.zoomStops=s,this._styleExpression=r,this.isStateDependent="camera"!==t&&!Ec(r.expression),this.isLightConstant=d,this.isConfigDependent=!gg(r.expression),this.interpolationType=c}evaluateWithoutErrorHandling(t,r,s,c,d,f){return this._styleExpression.evaluateWithoutErrorHandling(t,r,s,c,d,f)}evaluate(t,r,s,c,d,f){return this._styleExpression.evaluate(t,r,s,c,d,f)}interpolationFactor(t,r,s){return this.interpolationType?Wa.interpolationFactor(this.interpolationType,t,r,s):0}}function Je(e,t,r){if("error"===(e=Wl(e,t,r)).result)return e;const s=e.value.expression,c=Th(s);if(!c&&!Ns(t))return Wr([new ho("","data expressions not supported")]);const d=gu(s,["zoom","pitch","distance-from-center"]);if(!d&&!kc(t))return Wr([new ho("","zoom expressions not supported")]);const f=gu(s,["measure-light"]);if(!f&&!Cu(t))return Wr([new ho("","measure-light expression not supported")]);const g=t.expression&&t.expression.relaxZoomRestriction,y=Pa(s);return y||d||g?y instanceof ho?Wr([y]):y instanceof Wa&&!Rc(t)?Wr([new ho("",'"interpolate" expressions cannot be used with this property')]):Ma(y?new Os(c?"camera":"composite",e.value,y.labels,y instanceof Wa?y.interpolation:void 0,f):new xg(c?"constant":"source",e.value,f)):Wr([new ho("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class ts{constructor(t,r){this._parameters=t,this._specification=r,Zs(this,Mu(this._parameters,this._specification))}static deserialize(t){return new ts(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Pa(e){let t=null;if(e instanceof xo)t=Pa(e.result);else if(e instanceof No){for(const r of e.args)if(t=Pa(r),t)break}else(e instanceof Ym||e instanceof Wa)&&e.input instanceof vl&&"zoom"===e.input.name&&(t=e);return t instanceof ho||e.eachChild(r=>{const s=Pa(r);s instanceof ho?t=s:t&&s&&t!==s&&(t=new ho("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function $r(e){const t=e.key,r=e.value,s=e.valueSpec||{},c=e.objectElementValidators||{},d=e.style,f=e.styleSpec;let g=[];const y=Un(r);if("object"!==y)return[new Fe(t,r,`object expected, ${y} found`)];for(const b in r){const w=b.split(".")[0];let P;c[w]?P=c[w]:s[w]?P=wo:c["*"]?P=c["*"]:s["*"]&&(P=wo),P?g=g.concat(P({key:(t&&`${t}.`)+b,value:r[b],valueSpec:s[w]||s["*"],style:d,styleSpec:f,object:r,objectKey:b},r)):g.push(new wc(t,r[b],`unknown property "${b}"`))}for(const b in s)c[b]||s[b].required&&void 0===s[b].default&&void 0===r[b]&&g.push(new Fe(t,r,`missing required property "${b}"`));return g}function Kl(e){const t=e.value,r=e.valueSpec,s=e.style,c=e.styleSpec,d=e.key,f=e.arrayElementValidator||wo;if("array"!==Un(t))return[new Fe(d,t,`array expected, ${Un(t)} found`)];if(r.length&&t.length!==r.length)return[new Fe(d,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new Fe(d,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let g={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};c.$version<7&&(g.function=r.function),"object"===Un(r.value)&&(g=r.value);let y=[];for(let b=0;b<t.length;b++)y=y.concat(f({array:t,arrayIndex:b,value:t[b],valueSpec:g,style:s,styleSpec:c,key:`${d}[${b}]`},!0));return y}function Yl(e){const t=e.key,r=e.value,s=e.valueSpec;let c=Un(r);if("number"===c&&r!=r&&(c="NaN"),"number"!==c)return[new Fe(t,r,`number expected, ${c} found`)];if("minimum"in s){let d=s.minimum;if("array"===Un(s.minimum)&&(d=s.minimum[e.arrayIndex]),r<d)return[new Fe(t,r,`${r} is less than the minimum value ${d}`)]}if("maximum"in s){let d=s.maximum;if("array"===Un(s.maximum)&&(d=s.maximum[e.arrayIndex]),r>d)return[new Fe(t,r,`${r} is greater than the maximum value ${d}`)]}return[]}function Sd(e){const t=e.valueSpec,r=Wn(e.value.type);let s,c,d,f={};const g="categorical"!==r&&void 0===e.value.property,y=!g,b="array"===Un(e.value.stops)&&"array"===Un(e.value.stops[0])&&"object"===Un(e.value.stops[0][0]),w=$r({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(I){if("identity"===r)return[new Fe(I.key,I.value,'identity function may not have a "stops" property')];let A=[];const l=I.value;return A=A.concat(Kl({key:I.key,value:l,valueSpec:I.valueSpec,style:I.style,styleSpec:I.styleSpec,arrayElementValidator:P})),"array"===Un(l)&&0===l.length&&A.push(new Fe(I.key,l,"array must have at least one stop")),A},default:function(I){return wo({key:I.key,value:I.value,valueSpec:t,style:I.style,styleSpec:I.styleSpec})}}});return"identity"===r&&g&&w.push(new Fe(e.key,e.value,'missing required property "property"')),"identity"===r||e.value.stops||w.push(new Fe(e.key,e.value,'missing required property "stops"')),"exponential"===r&&e.valueSpec.expression&&!Rc(e.valueSpec)&&w.push(new Fe(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(y&&!Ns(e.valueSpec)?w.push(new Fe(e.key,e.value,"property functions not supported")):g&&!kc(e.valueSpec)&&w.push(new Fe(e.key,e.value,"zoom functions not supported"))),"categorical"!==r&&!b||void 0!==e.value.property||w.push(new Fe(e.key,e.value,'"property" property is required')),w;function P(I){let A=[];const l=I.value,u=I.key;if("array"!==Un(l))return[new Fe(u,l,`array expected, ${Un(l)} found`)];if(2!==l.length)return[new Fe(u,l,`array length 2 expected, length ${l.length} found`)];if(b){if("object"!==Un(l[0]))return[new Fe(u,l,`object expected, ${Un(l[0])} found`)];if(void 0===l[0].zoom)return[new Fe(u,l,"object stop key must have zoom")];if(void 0===l[0].value)return[new Fe(u,l,"object stop key must have value")];const p=Wn(l[0].zoom);if("number"!=typeof p)return[new Fe(u,l[0].zoom,"stop zoom values must be numbers")];if(d&&d>p)return[new Fe(u,l[0].zoom,"stop zoom values must appear in ascending order")];p!==d&&(d=p,c=void 0,f={}),A=A.concat($r({key:`${u}[0]`,value:l[0],valueSpec:{zoom:{}},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{zoom:Yl,value:O}}))}else A=A.concat(O({key:`${u}[0]`,value:l[0],valueSpec:{},style:I.style,styleSpec:I.styleSpec},l));return Zl($i(l[1]))?A.concat([new Fe(`${u}[1]`,l[1],"expressions are not allowed in function stops.")]):A.concat(wo({key:`${u}[1]`,value:l[1],valueSpec:t,style:I.style,styleSpec:I.styleSpec}))}function O(I,A){const l=Un(I.value),u=Wn(I.value),p=null!==I.value?I.value:A;if(s){if(l!==s)return[new Fe(I.key,p,`${l} stop domain type must match previous stop domain type ${s}`)]}else s=l;if("number"!==l&&"string"!==l&&"boolean"!==l&&"number"!=typeof u&&"string"!=typeof u&&"boolean"!=typeof u)return[new Fe(I.key,p,"stop domain value must be a number, string, or boolean")];if("number"!==l&&"categorical"!==r){let m=`number expected, ${l} found`;return Ns(t)&&void 0===r&&(m+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Fe(I.key,p,m)]}return"categorical"!==r||"number"!==l||"number"==typeof u&&isFinite(u)&&Math.floor(u)===u?"categorical"!==r&&"number"===l&&"number"==typeof u&&"number"==typeof c&&void 0!==c&&u<c?[new Fe(I.key,p,"stop domain values must appear in ascending order")]:(c=u,"categorical"===r&&u in f?[new Fe(I.key,p,"stop domain values must be unique")]:(f[u]=!0,[])):[new Fe(I.key,p,`integer expected, found ${String(u)}`)]}}function Ts(e){const t=("property"===e.expressionContext?Je:Wl)($i(e.value),e.valueSpec);if("error"===t.result)return t.value.map(s=>new Fe(`${e.key}${s.key}`,e.value,s.message));const r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Fe(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Ec(r))return[new Fe(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext)return io(r,e);if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!gu(r,["zoom","feature-state"]))return[new Fe(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Th(r))return[new Fe(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function io(e,t){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const c of t.valueSpec.expression.parameters)r.delete(c);if(0===r.size)return[];const s=[];return e instanceof vl&&r.has(e.name)?[new Fe(t.key,t.value,`["${e.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(e.eachChild(c=>{s.push(...io(c,t))}),s)}function sp(e){const t=e.key,r=e.value,s=e.valueSpec,c=[];return Array.isArray(s.values)?-1===s.values.indexOf(Wn(r))&&c.push(new Fe(t,r,`expected one of [${s.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(s.values).indexOf(Wn(r))&&c.push(new Fe(t,r,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(r)} found`)),c}function Ya(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!Ya(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}function Ou(e,t="fill"){if(null==e)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ya(e)||(e=Nh(e));const r=e;let s=!0;try{s=function(b){if(!Ad(b))return b;let w=$i(b);return Lh(w),w=Lc(w),w}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(r,null,2)}\n        `)}const c=wt[`filter_${t}`],d=Wl(s,c);let f=null;if("error"===d.result)throw new Error(d.value.map(b=>`${b.key}: ${b.message}`).join(", "));f=(b,w,P)=>d.value.evaluate(b,w,{},P);let g=null,y=null;if(s!==r){const b=Wl(r,c);if("error"===b.result)throw new Error(b.value.map(w=>`${w.key}: ${w.message}`).join(", "));g=(w,P,O,I,A)=>b.value.evaluate(w,P,{},O,void 0,void 0,I,A),y=!Th(b.value.expression)}return{filter:f,dynamicFilter:g||void 0,needGeometry:i_(s),needFeature:!!y}}function Lc(e){if(!Array.isArray(e))return e;const t=function(r){if(r_.has(r[0]))for(let s=1;s<r.length;s++)if(Ad(r[s]))return!0;return r}(e);return!0===t?t:t.map(r=>Lc(r))}function Lh(e){let t=!1;const r=[];if("case"===e[0]){for(let s=1;s<e.length-1;s+=2)t=t||Ad(e[s]),r.push(e[s+1]);r.push(e[e.length-1])}else if("match"===e[0]){t=t||Ad(e[1]);for(let s=2;s<e.length-1;s+=2)r.push(e[s+1]);r.push(e[e.length-1])}else if("step"===e[0]){t=t||Ad(e[1]);for(let s=1;s<e.length-1;s+=2)r.push(e[s+1])}t&&(e.length=0,e.push("any",...r));for(let s=1;s<e.length;s++)Lh(e[s])}function Ad(e){if(!Array.isArray(e))return!1;if("pitch"===(t=e[0])||"distance-from-center"===t)return!0;var t;for(let r=1;r<e.length;r++)if(Ad(e[r]))return!0;return!1}const r_=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function wg(e,t){return e<t?-1:e>t?1:0}function i_(e){if(!Array.isArray(e))return!1;if("within"===e[0]||"distance"===e[0])return!0;for(let t=1;t<e.length;t++)if(i_(e[t]))return!0;return!1}function Nh(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?Fh(e[1],e[2],"=="):"!="===t?ha(Fh(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?Fh(e[1],e[2],t):"any"===t?(r=e.slice(1),["any"].concat(r.map(Nh))):"all"===t?["all"].concat(e.slice(1).map(Nh)):"none"===t?["all"].concat(e.slice(1).map(Nh).map(ha)):"in"===t?ps(e[1],e.slice(2)):"!in"===t?ha(ps(e[1],e.slice(2))):"has"===t?ap(e[1]):"!has"!==t||ha(ap(e[1]));var r}function Fh(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function ps(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",e,["literal",t.sort(wg)]]:["filter-in-small",e,["literal",t]]}}function ap(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function ha(e){return["!",e]}function Xl(e){return Ya($i(e.value))?Ts(Zs({},e,{expressionContext:"filter",valueSpec:e.styleSpec[`filter_${e.layerType||"fill"}`]})):Dd(e)}function Dd(e){const t=e.value,r=e.key;if("array"!==Un(t))return[new Fe(r,t,`array expected, ${Un(t)} found`)];const s=e.styleSpec;let c,d=[];if(t.length<1)return[new Fe(r,t,"filter array must have at least 1 element")];switch(d=d.concat(sp({key:`${r}[0]`,value:t[0],valueSpec:s.filter_operator,style:e.style,styleSpec:e.styleSpec})),Wn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===Wn(t[1])&&d.push(new Fe(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&d.push(new Fe(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(c=Un(t[1]),"string"!==c&&d.push(new Fe(`${r}[1]`,t[1],`string expected, ${c} found`)));for(let f=2;f<t.length;f++)c=Un(t[f]),"$type"===Wn(t[1])?d=d.concat(sp({key:`${r}[${f}]`,value:t[f],valueSpec:s.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==c&&"number"!==c&&"boolean"!==c&&d.push(new Fe(`${r}[${f}]`,t[f],`string, number, or boolean expected, ${c} found`));break;case"any":case"all":case"none":for(let f=1;f<t.length;f++)d=d.concat(Dd({key:`${r}[${f}]`,value:t[f],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":c=Un(t[1]),2!==t.length?d.push(new Fe(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==c&&d.push(new Fe(`${r}[1]`,t[1],`string expected, ${c} found`))}return d}function Xa(e,t){const r=e.key,s=e.style,c=e.layer,d=e.styleSpec,f=e.value,g=e.objectKey,y=d[`${t}_${e.layerType}`];if(!y)return[];const b=g.match(/^(.*)-transition$/);if("paint"===t&&b&&y[b[1]]&&y[b[1]].transition)return wo({key:r,value:f,valueSpec:d.transition,style:s,styleSpec:d});const w=e.valueSpec||y[g];if(!w)return[new wc(r,f,`unknown property "${g}"`)];let P;if("string"===Un(f)&&Ns(w)&&!w.tokens&&(P=/^{([^}]+)}$/.exec(f))){const I=`\`{ "type": "identity", "property": ${P?JSON.stringify(P[1]):'"_"'} }\``;return[new Fe(r,f,`"${g}" does not support interpolation syntax\nUse an identity property function instead: ${I}.`)]}const O=[];if("symbol"===e.layerType)"text-field"!==g||!s||s.glyphs||s.imports||O.push(new Fe(r,f,'use of "text-field" requires a style "glyphs" property')),"text-font"===g&&xl($i(f))&&"identity"===Wn(f.type)&&O.push(new Fe(r,f,'"text-font" does not support identity functions'));else if("model"===e.layerType&&"paint"===t&&c&&c.layout&&c.layout.hasOwnProperty("model-id")&&Ns(w)&&(Cu(w)||kc(w))){const I=Je($i(f),w),A=I.value.expression||I.value._styleExpression.expression;A&&!gu(A,["measure-light"])&&("model-emissive-strength"===g&&Th(A)&&Ec(A)||O.push(new Fe(r,f,`${g} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return O.concat(wo({key:e.key,value:f,valueSpec:w,style:s,styleSpec:d,expressionContext:"property",propertyType:t,propertyKey:g}))}function kd(e){return Xa(e,"paint")}function Qa(e){return Xa(e,"layout")}function lp(e){let t=[];const r=e.value,s=e.key,c=e.style,d=e.styleSpec;r.type||r.ref||t.push(new Fe(s,r,'either "type" or "ref" is required'));let f=Wn(r.type);const g=Wn(r.ref);if(r.id){const y=Wn(r.id);for(let b=0;b<e.arrayIndex;b++){const w=c.layers[b];Wn(w.id)===y&&t.push(new Fe(s,r.id,`duplicate layer id "${r.id}", previously used at line ${w.id.__line__}`))}}if("ref"in r){let y;["type","source","source-layer","filter","layout"].forEach(b=>{b in r&&t.push(new Fe(s,r[b],`"${b}" is prohibited for ref layers`))}),c.layers.forEach(b=>{Wn(b.id)===g&&(y=b)}),y?y.ref?t.push(new Fe(s,r.ref,"ref cannot reference another ref layer")):f=Wn(y.type):"string"==typeof g&&t.push(new Fe(s,r.ref,`ref layer "${g}" not found`))}else if("background"!==f&&"sky"!==f&&"slot"!==f)if(r.source){const y=c.sources&&c.sources[r.source],b=y&&Wn(y.type);y?"vector"===b&&"raster"===f?t.push(new Fe(s,r.source,`layer "${r.id}" requires a raster source`)):"raster"===b&&"raster"!==f?t.push(new Fe(s,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==b||r["source-layer"]?"raster-dem"===b&&"hillshade"!==f?t.push(new Fe(s,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==f||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||"geojson"===b&&y.lineMetrics||t.push(new Fe(s,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Fe(s,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new Fe(s,r.source,`source "${r.source}" not found`))}else t.push(new Fe(s,r,'missing required property "source"'));return t=t.concat($r({key:s,value:r,valueSpec:d.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":()=>[],type:()=>wo({key:`${s}.type`,value:r.type,valueSpec:d.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"}),filter:y=>Xl(Zs({layerType:f},y)),layout:y=>$r({layer:r,key:y.key,value:y.value,valueSpec:{},style:y.style,styleSpec:y.styleSpec,objectElementValidators:{"*":b=>Qa(Zs({layerType:f},b))}}),paint:y=>$r({layer:r,key:y.key,value:y.value,valueSpec:{},style:y.style,styleSpec:y.styleSpec,objectElementValidators:{"*":b=>kd(Zs({layerType:f,layer:r},b))}})}})),t}function wl(e){const t=e.value,r=e.key,s=Un(t);return"string"!==s?[new Fe(r,t,`string expected, ${s} found`)]:[]}const cp={promoteId:function({key:e,value:t}){if("string"===Un(t))return wl({key:e,value:t});{const r=[];for(const s in t)r.push(...wl({key:`${e}.${s}`,value:t[s]}));return r}}};function Cg(e){const t=e.value,r=e.key,s=e.styleSpec,c=e.style;if(!t.type)return[new Fe(r,t,'"type" is required')];const d=Wn(t.type);let f=[];switch(["vector","raster","raster-dem"].includes(d)&&(t.url||t.tiles||f.push(new Fe(r,t,'Either "url" or "tiles" is required.'))),d){case"vector":case"raster":case"raster-dem":return f=f.concat($r({key:r,value:t,valueSpec:s[`source_${d.replace("-","_")}`],style:e.style,styleSpec:s,objectElementValidators:cp})),f;case"geojson":if(f=$r({key:r,value:t,valueSpec:s.source_geojson,style:c,styleSpec:s,objectElementValidators:cp}),t.cluster)for(const g in t.clusterProperties){const[y,b]=t.clusterProperties[g],w="string"==typeof y?[y,["accumulated"],["get",g]]:y;f.push(...Ts({key:`${r}.${g}.map`,value:b,expressionContext:"cluster-map"})),f.push(...Ts({key:`${r}.${g}.reduce`,value:w,expressionContext:"cluster-reduce"}))}return f;case"video":return $r({key:r,value:t,valueSpec:s.source_video,style:c,styleSpec:s});case"image":return $r({key:r,value:t,valueSpec:s.source_image,style:c,styleSpec:s});case"canvas":return[new Fe(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return sp({key:`${r}.type`,value:t.type,valueSpec:{values:Ys(s)},style:c,styleSpec:s})}}function Ys(e){return e.source.reduce((t,r)=>{const s=e[r];return"enum"===s.type.type&&(t=t.concat(Object.keys(s.type.values))),t},[])}function Mg(e){const t=e.value;let r=[];if(!t)return r;const s=Un(t);return"string"!==s?(r=r.concat([new Fe(e.key,t,`string expected, "${s}" found`)]),r):(function(c){const d=-1===c.indexOf("://");try{return new URL(c,d?"http://example.com":void 0),!0}catch{return!1}}(t)||(r=r.concat([new Fe(e.key,t,`invalid url "${t}"`)])),r)}function Cl(e){const t=e.value,r=e.styleSpec,s=r.light,c=e.style;let d=[];const f=Un(t);if(void 0===t)return d;if("object"!==f)return d=d.concat([new Fe("light",t,`object expected, ${f} found`)]),d;for(const g in t){const y=g.match(/^(.*)-transition$/);d=d.concat(y&&s[y[1]]&&s[y[1]].transition?wo({key:g,value:t[g],valueSpec:r.transition,style:c,styleSpec:r}):s[g]?wo({key:g,value:t[g],valueSpec:s[g],style:c,styleSpec:r}):[new Fe(g,t[g],`unknown property "${g}"`)])}return d}function Rd(e){const t=e.value;let r=[];if(!t)return r;const s=Un(t);if("object"!==s)return r=r.concat([new Fe("light-3d",t,`object expected, ${s} found`)]),r;const c=e.styleSpec,d=c["light-3d"],f=e.key,g=e.style,y=e.style.lights;for(const P of["type","id"])if(!(P in t))return r=r.concat([new Fe("light-3d",t,`missing property ${P} on light`)]),r;if(t.type&&y)for(let P=0;P<e.arrayIndex;P++){const O=Wn(t.type),I=y[P];Wn(I.type)===O&&r.push(new Fe(f,t.id,`duplicate light type "${t.type}", previously defined at line ${I.id.__line__}`))}const b=`properties_light_${t.type}`;if(!(b in c))return r=r.concat([new Fe("light-3d",t,`Invalid light type ${t.type}`)]),r;const w=c[b];for(const P in t)if("properties"===P){const O=t[P],I=Un(O);if("object"!==I)return r=r.concat([new Fe("properties",O,`object expected, ${I} found`)]),r;for(const A in O)r=r.concat(w[A]?wo({key:A,value:O[A],valueSpec:w[A],style:g,styleSpec:c}):[new wc(e.key,O[A],`unknown property "${A}"`)])}else{const O=P.match(/^(.*)-transition$/);r=r.concat(O&&d[O[1]]&&d[O[1]].transition?wo({key:P,value:t[P],valueSpec:c.transition,style:g,styleSpec:c}):d[P]?wo({key:P,value:t[P],valueSpec:d[P],style:g,styleSpec:c}):[new wc(P,t[P],`unknown property "${P}"`)])}return r}function up(e){const t=e.value,r=e.key,s=e.style,c=e.styleSpec,d=c.terrain;let f=[];const g=Un(t);if(void 0===t||"null"===g)return f;if("object"!==g)return f=f.concat([new Fe("terrain",t,`object expected, ${g} found`)]),f;for(const y in t){const b=y.match(/^(.*)-transition$/);f=f.concat(b&&d[b[1]]&&d[b[1]].transition?wo({key:y,value:t[y],valueSpec:c.transition,style:s,styleSpec:c}):d[y]?wo({key:y,value:t[y],valueSpec:d[y],style:s,styleSpec:c}):[new wc(y,t[y],`unknown property "${y}"`)])}if(t.source){const y=s.sources&&s.sources[t.source],b=y&&Wn(y.type);y?"raster-dem"!==b&&f.push(new Fe(r,t.source,`terrain cannot be used with a source of type ${String(b)}, it only be used with a "raster-dem" source type`)):f.push(new Fe(r,t.source,`source "${t.source}" not found`))}else f.push(new Fe(r,t,'terrain is missing required property "source"'));return f}function Tu(e){const t=e.value,r=e.style,s=e.styleSpec,c=s.fog;let d=[];const f=Un(t);if(void 0===t)return d;if("object"!==f)return d=d.concat([new Fe("fog",t,`object expected, ${f} found`)]),d;for(const g in t){const y=g.match(/^(.*)-transition$/);d=d.concat(y&&c[y[1]]&&c[y[1]].transition?wo({key:g,value:t[g],valueSpec:s.transition,style:r,styleSpec:s}):c[g]?wo({key:g,value:t[g],valueSpec:c[g],style:r,styleSpec:s}):[new wc(g,t[g],`unknown property "${g}"`)])}return d}const Ld={"*":()=>[],array:Kl,boolean:function(e){const t=e.value,r=e.key,s=Un(t);return"boolean"!==s?[new Fe(r,t,`boolean expected, ${s} found`)]:[]},number:Yl,color:function(e){const t=e.key,r=e.value,s=Un(r);return"string"!==s?[new Fe(t,r,`color expected, ${s} found`)]:null===Ws(r)?[new Fe(t,r,`color expected, "${r}" found`)]:[]},enum:sp,filter:Xl,function:Sd,layer:lp,object:$r,source:Cg,model:Mg,light:Cl,"light-3d":Rd,terrain:up,fog:Tu,string:wl,formatted:function(e){return 0===wl(e).length?[]:Ts(e)},resolvedImage:function(e){return 0===wl(e).length?[]:Ts(e)},projection:function(e){const t=e.value,r=e.styleSpec,s=r.projection,c=e.style;let d=[];const f=Un(t);if("object"===f)for(const g in t)d=d.concat(wo({key:g,value:t[g],valueSpec:s[g],style:c,styleSpec:r}));else"string"!==f&&(d=d.concat([new Fe("projection",t,`object or string expected, ${f} found`)]));return d},import:function(e){const{value:t,styleSpec:r}=e,{data:s,...c}=t;Object.defineProperty(c,"__line__",{value:t.__line__,enumerable:!1});let d=$r(Zs({},e,{value:c,valueSpec:r.import}));return""===Wn(c.id)&&d.push(new Fe(`${e.key}.id`,c,"import id can't be an empty string")),s&&(d=d.concat(Iu(s,r,{key:`${e.key}.data`}))),d}};function wo(e,t=!1){const r=e.value,s=e.valueSpec,c=e.styleSpec;if(s.expression&&xl(Wn(r)))return Sd(e);if(s.expression&&Zl($i(r)))return Ts(e);if(s.type&&Ld[s.type]){const d=Ld[s.type](e);return!0===t&&d.length>0&&"array"===Un(e.value)?Ts(e):d}return $r(Zs({},e,{valueSpec:s.type?c[s.type]:s}))}function zh(e){const t=e.value,r=e.key,s=wl(e);return s.length||(-1===t.indexOf("{fontstack}")&&s.push(new Fe(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&s.push(new Fe(r,t,'"glyphs" url must include a "{range}" token'))),s}function Iu(e,t=wt,r={}){return wo({key:r.key||"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:zh,"*":()=>[]}})}function Ea(e,t=wt){return fa(Iu(e,t))}const Nd=e=>fa(Cg(e)),dp=e=>fa(Cl(e)),Ja=e=>fa(Rd(e)),Fd=e=>fa(up(e)),Bh=e=>fa(Tu(e)),Pg=e=>fa(lp(e)),hp=e=>fa(Xl(e)),Su=e=>fa(kd(e)),Nc=e=>fa(Qa(e)),es=e=>fa(Mg(e));function fa(e){return e.slice().sort((t,r)=>t.line&&r.line?t.line-r.line:0)}function Uh(e,t){let r=!1;if(t&&t.length)for(const s of t)s instanceof wc?gt(s.message):(e.fire(new Cn(new Error(s.message))),r=!0);return r}var Ql=Fo,Ml=3;function Fo(e,t,r){var s=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var c=new Int32Array(this.arrayBuffer);e=c[0],this.d=(t=c[1])+2*(r=c[2]);for(var d=0;d<this.d*this.d;d++){var f=c[Ml+d],g=c[Ml+d+1];s.push(f===g?null:c.subarray(f,g))}var y=c[Ml+s.length+1];this.keys=c.subarray(c[Ml+s.length],y),this.bboxes=c.subarray(y),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var b=0;b<this.d*this.d;b++)s.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var w=r/t*e;this.min=-w,this.max=e+w}Fo.prototype.insert=function(e,t,r,s,c){this._forEachCell(t,r,s,c,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(c)},Fo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Fo.prototype._insertCell=function(e,t,r,s,c,d){this.cells[c].push(d)},Fo.prototype.query=function(e,t,r,s,c){var d=this.min,f=this.max;if(e<=d&&t<=d&&f<=r&&f<=s&&!c)return Array.prototype.slice.call(this.keys);var g=[];return this._forEachCell(e,t,r,s,this._queryCell,g,{},c),g},Fo.prototype._queryCell=function(e,t,r,s,c,d,f,g){var y=this.cells[c];if(null!==y)for(var b=this.keys,w=this.bboxes,P=0;P<y.length;P++){var O=y[P];if(void 0===f[O]){var I=4*O;(g?g(w[I+0],w[I+1],w[I+2],w[I+3]):e<=w[I+2]&&t<=w[I+3]&&r>=w[I+0]&&s>=w[I+1])?(f[O]=!0,d.push(b[O])):f[O]=!1}}},Fo.prototype._forEachCell=function(e,t,r,s,c,d,f,g){for(var y=this._convertToCellCoord(e),b=this._convertToCellCoord(t),w=this._convertToCellCoord(r),P=this._convertToCellCoord(s),O=y;O<=w;O++)for(var I=b;I<=P;I++){var A=this.d*I+O;if((!g||g(this._convertFromCellCoord(O),this._convertFromCellCoord(I),this._convertFromCellCoord(O+1),this._convertFromCellCoord(I+1)))&&c.call(this,e,t,r,s,A,d,f,g))return}},Fo.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Fo.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Fo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=Ml+this.cells.length+1+1,r=0,s=0;s<this.cells.length;s++)r+=this.cells[s].length;var c=new Int32Array(t+r+this.keys.length+this.bboxes.length);c[0]=this.extent,c[1]=this.n,c[2]=this.padding;for(var d=t,f=0;f<e.length;f++){var g=e[f];c[Ml+f]=d,c.set(g,d),d+=g.length}return c[Ml+e.length]=d,c.set(this.keys,d),c[Ml+e.length+1]=d+=this.keys.length,c.set(this.bboxes,d),d+=this.bboxes.length,c.buffer};var Jl=We(Ql);const tc={};function De(e,t,r={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),tc[t]={klass:e,omit:r.omit||[]}}De(Object,"Object"),Jl.serialize=function(e,t){const r=e.toArrayBuffer();return t&&t.add(r),{buffer:r}},Jl.deserialize=function(e){return new Jl(e.buffer)},Object.defineProperty(Jl,"name",{value:"Grid"}),De(Jl,"Grid"),De(bn,"Color"),De(Error,"Error"),De(Ht,"AJAXError"),De(Ro,"ResolvedImage"),De(ts,"StylePropertyFunction"),De(Yi,"StyleExpression",{omit:["_evaluator"]}),De(Os,"ZoomDependentExpression"),De(xg,"ZoomConstantExpression"),De(vl,"CompoundExpression",{omit:["_evaluate"]});for(const e in Dc)tc[Dc[e]._classRegistryKey]||De(Dc[e],`Expression${e}`);function ec(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function zd(e){return lt.ImageBitmap&&e instanceof lt.ImageBitmap}function nc(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(ec(e)||zd(e))return t&&t.add(e),e;if(ArrayBuffer.isView(e)){const r=e;return t&&t.add(r.buffer),r}if(e instanceof lt.ImageData)return t&&t.add(e.data.buffer),e;if(Array.isArray(e)){const r=[];for(const s of e)r.push(nc(s,t));return r}if(e instanceof Map){const r={$name:"Map"};for(const[s,c]of e.entries())r[s]=nc(c);return r}if("object"==typeof e){const r=e.constructor,s=r._classRegistryKey;if(!s)throw new Error(`can't serialize object of unregistered class ${s}`);const c=r.serialize?r.serialize(e,t):{};if(!r.serialize){for(const d in e)e.hasOwnProperty(d)&&(tc[s].omit.indexOf(d)>=0||(c[d]=nc(e[d],t)));e instanceof Error&&(c.message=e.message)}if(c.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(c.$name=s),c}throw new Error("can't serialize object of type "+typeof e)}function U(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||ec(e)||zd(e)||ArrayBuffer.isView(e)||e instanceof lt.ImageData)return e;if(Array.isArray(e))return e.map(U);if("object"==typeof e){const t=e.$name||"Object";if("Map"===t){const c=new Map;for(const d of Object.keys(e))"$name"!==d&&c.set(d,U(e[d]));return c}const{klass:r}=tc[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(e);const s=Object.create(r.prototype);for(const c of Object.keys(e))"$name"!==c&&(s[c]=U(e[c]));return s}throw new Error("can't deserialize object of type "+typeof e)}const V={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519,"CJK Unified Ideographs Extension B":e=>e>=131072&&e<=173791};function W(e){for(const t of e)if(Lt(t.charCodeAt(0)))return!0;return!1}function ut(e){for(const t of e)if(!Mt(t.charCodeAt(0)))return!1;return!0}function Mt(e){return!(V.Arabic(e)||V["Arabic Supplement"](e)||V["Arabic Extended-A"](e)||V["Arabic Presentation Forms-A"](e)||V["Arabic Presentation Forms-B"](e))}function Lt(e){return!(746!==e&&747!==e&&(e<4352||!(V["Bopomofo Extended"](e)||V.Bopomofo(e)||V["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||V["CJK Compatibility Ideographs"](e)||V["CJK Compatibility"](e)||V["CJK Radicals Supplement"](e)||V["CJK Strokes"](e)||!(!V["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||V["CJK Unified Ideographs Extension A"](e)||V["CJK Unified Ideographs"](e)||V["Enclosed CJK Letters and Months"](e)||V["Hangul Compatibility Jamo"](e)||V["Hangul Jamo Extended-A"](e)||V["Hangul Jamo Extended-B"](e)||V["Hangul Jamo"](e)||V["Hangul Syllables"](e)||V.Hiragana(e)||V["Ideographic Description Characters"](e)||V.Kanbun(e)||V["Kangxi Radicals"](e)||V["Katakana Phonetic Extensions"](e)||V.Katakana(e)&&12540!==e||!(!V["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!V["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||V["Unified Canadian Aboriginal Syllabics"](e)||V["Unified Canadian Aboriginal Syllabics Extended"](e)||V["Vertical Forms"](e)||V["Yijing Hexagram Symbols"](e)||V["Yi Syllables"](e)||V["Yi Radicals"](e))))}function se(e){return!(Lt(e)||(t=e,V["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||V["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||V["Letterlike Symbols"](t)||V["Number Forms"](t)||V["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||V["Control Pictures"](t)&&9251!==t||V["Optical Character Recognition"](t)||V["Enclosed Alphanumerics"](t)||V["Geometric Shapes"](t)||V["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||V["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||V["CJK Symbols and Punctuation"](t)||V.Katakana(t)||V["Private Use Area"](t)||V["CJK Compatibility Forms"](t)||V["Small Form Variants"](t)||V["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t));var t}function on(e){return e>=1424&&e<=2303||V["Arabic Presentation Forms-A"](e)||V["Arabic Presentation Forms-B"](e)}function nn(e,t){return!(!t&&on(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||V.Khmer(e))}function xn(e){for(const t of e)if(on(t.charCodeAt(0)))return!0;return!1}const mr="deferred",hr="loading",mi="loaded";let Co=null,oo="unavailable",Oa=null;const _o=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(oo="error"),Co&&Co(e)};function Zo(){Ta.fire(new de("pluginStateChange",{pluginStatus:oo,pluginURL:Oa}))}const Ta=new ki,Au=function(){return oo},Vh=function(){if(oo!==mr||!Oa)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");oo=hr,Zo(),Oa&&ve({url:Oa},e=>{e?_o(e):(oo=mi,Zo())})},tl={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>oo===mi||null!=tl.applyArabicShaping,isLoading:()=>oo===hr,setState(e){oo=e.pluginStatus,Oa=e.pluginURL},isParsed:()=>null!=tl.applyArabicShaping&&null!=tl.processBidirectionalText&&null!=tl.processStyledBidirectionalText,getPluginURL:()=>Oa};class Ri{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.transition=r.transition,this.pitch=r.pitch,this.brightness=r.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(r,s){for(const c of r)if(!nn(c.charCodeAt(0),s))return!1;return!0}(t,tl.isLoaded())}}class Eg{constructor(t,r,s){this.property=t,this.value=r,this.expression=function(c,d,f){if(xl(c))return new ts(c,d);if(Zl(c)||Array.isArray(c)&&c.length>0){const g=Je(c,d,f);if("error"===g.result)throw new Error(g.value.map(y=>`${y.key}: ${y.message}`).join(", "));return g.value}{let g=c;return"string"==typeof c&&"color"===d.type&&(g=bn.parse(c)),{kind:"constant",isConfigDependent:!1,evaluate:()=>g}}}(void 0===r?t.specification.default:r,t.specification,s)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,r,s){return this.property.possiblyEvaluate(this,t,r,s)}}class o_{constructor(t,r){this.property=t,this.value=new Eg(t,void 0,r)}transitioned(t,r){return new s_(this.property,this.value,r,_t({},t.transition,this.transition),t.now)}untransitioned(){return new s_(this.property,this.value,null,{},0)}}class Xs{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._options=r,this.isConfigDependent=!1}getValue(t){return et(this._values[t].value.value)}setValue(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new o_(this._values[t].property,this._options)),this._values[t].value=new Eg(this._values[t].property,null===r?void 0:et(r),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].value.expression.isConfigDependent}setTransitionOrValue(t,r){r&&(this._options=r);const s=this._properties.properties;if(t)for(const c in t){const d=t[c];if(pn(c,"-transition")){const f=c.slice(0,-11);s[f]&&this.setTransition(f,d)}else s[c]&&this.setValue(c,d)}}getTransition(t){return et(this._values[t].transition)}setTransition(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new o_(this._values[t].property)),this._values[t].transition=et(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const s=this.getValue(r);void 0!==s&&(t[r]=s);const c=this.getTransition(r);void 0!==c&&(t[`${r}-transition`]=c)}return t}transitioned(t,r){const s=new z(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].transitioned(t,r._values[c]);return s}untransitioned(){const t=new z(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class s_{constructor(t,r,s,c,d){const f=c.delay||0,g=c.duration||0;d=d||0,this.property=t,this.value=r,this.begin=d+f,this.end=this.begin+g,t.specification.transition&&(c.delay||c.duration)&&(this.prior=s)}possiblyEvaluate(t,r,s){const c=t.now||0,d=this.value.possiblyEvaluate(t,r,s),f=this.prior;if(f){if(c>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(c<this.begin)return f.possiblyEvaluate(t,r,s);{const g=(c-this.begin)/(this.end-this.begin);return this.property.interpolate(f.possiblyEvaluate(t,r,s),d,Ui(g))}}return d}}class z{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,s){const c=new j(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].possiblyEvaluate(t,r,s);return c}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class D{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._options=r,this.isConfigDependent=!1}getValue(t){return et(this._values[t].value)}setValue(t,r){this._values[t]=new Eg(this._values[t].property,null===r?void 0:et(r),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].expression.isConfigDependent}serialize(){const t={};for(const r of Object.keys(this._values)){const s=this.getValue(r);void 0!==s&&(t[r]=s)}return t}possiblyEvaluate(t,r,s){const c=new j(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].possiblyEvaluate(t,r,s);return c}}class R{constructor(t,r,s){this.property=t,this.value=r,this.parameters=s}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,r,s,c){return this.property.evaluate(this.value,this.parameters,t,r,s,c)}}class j{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class G{constructor(t){this.specification=t}possiblyEvaluate(t,r){return t.expression.evaluate(r)}interpolate(t,r,s){const c=Md[this.specification.type];return c?c(t,r,s):t}}class Q{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,s,c){return new R(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(r,null,{},s,c)}:t.expression,r)}interpolate(t,r,s){if("constant"!==t.value.kind||"constant"!==r.value.kind)return t;if(void 0===t.value.value||void 0===r.value.value)return new R(this,{kind:"constant",value:void 0},t.parameters);const c=Md[this.specification.type];return c?new R(this,{kind:"constant",value:c(t.value.value,r.value.value,s)},t.parameters):t}evaluate(t,r,s,c,d,f){return"constant"===t.kind?t.value:t.evaluate(r,s,c,d,f)}}class St{constructor(t){this.specification=t}possiblyEvaluate(t,r,s,c){return!!t.expression.evaluate(r,null,{},s,c)}interpolate(){return!1}}class jt{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const r=new Ri(0,{});for(const s in t){const c=t[s];c.specification.overridable&&this.overridableProperties.push(s);const d=this.defaultPropertyValues[s]=new Eg(c,void 0),f=this.defaultTransitionablePropertyValues[s]=new o_(c);this.defaultTransitioningPropertyValues[s]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=d.possiblyEvaluate(r)}}}De(Q,"DataDrivenProperty"),De(G,"DataConstantProperty"),De(St,"ColorRampProperty");function un(e){return e.indexOf("\x1f")>=0}function sn(e,t){return t?`${e}\x1f${t}`:e}function ti(e){const t=e.indexOf("\x1f");return t>=0?e.slice(0,t):e}const ns="-transition";class gs extends ki{constructor(t,r,s){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&"sky"!==t.type&&"slot"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),this.options=s,t.slot&&(this.slot=t.slot),r.layout&&(this._unevaluatedLayout=new D(r.layout,s),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),r.paint)){this._transitionablePaint=new Xs(r.paint,s);for(const c in t.paint)this.setPaintProperty(c,t.paint[c],{validate:!1});for(const c in t.layout)this.setLayoutProperty(c,t.layout[c],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new j(r.paint)}}setScope(t){this.scope=t,this.fqid=sn(this.id,t)}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,s={}){if(null!=r&&this._validate(Nc,`layers.${this.id}.layout.${t}`,t,r,s))return;if("custom"===this.type&&"visibility"===t)return void(this.visibility=r);const c=this._unevaluatedLayout;c._properties.properties[t]&&(c.setValue(t,r),this.isConfigDependent=this.isConfigDependent||c.isConfigDependent,"visibility"===t&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return pn(t,ns)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,s={}){if(null!=r&&this._validate(Su,`layers.${this.id}.paint.${t}`,t,r,s))return!1;const c=this._transitionablePaint,d=c._properties.properties;if(pn(t,ns)){const O=t.slice(0,-11);return d[O]&&c.setTransition(O,r||void 0),!1}if(!d[t])return!1;const f=c._values[t],g=f.value.isDataDriven(),y=f.value;c.setValue(t,r),this.isConfigDependent=this.isConfigDependent||c.isConfigDependent,this._handleSpecialPaintPropertyUpdate(t);const b=c._values[t].value,w=b.isDataDriven(),P=pn(t,"pattern")||"line-dasharray"===t;return w||g||P||this._handleOverridablePaintPropertyUpdate(t,y,b)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,r){return null}_handleOverridablePaintPropertyUpdate(t,r,s){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){return ce({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,r)=>!(void 0===t||"layout"===r&&!Object.keys(t).length||"paint"===r&&!Object.keys(t).length))}_validate(t,r,s,c,d={}){return(!d||!1!==d.validate)&&Uh(this,t.call(Ea,{key:r,layerType:this.type,objectKey:s,value:c,styleSpec:wt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof R&&Ns(r.property.specification)&&("source"===r.value.kind||"composite"===r.value.kind)&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Ou(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(){this._stats&&(this._stats.numRenderedVerticesInShadowPass=0,this._stats.numRenderedVerticesInTransparentPass=0)}}class jh{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(t,r){this._updatedSourceCaches[t]=r,this.setDirty()}discardSourceCacheUpdate(t){delete this._updatedSourceCaches[t]}updateLayer(t){const r=t.scope;this._updatedLayers[r]=this._updatedLayers[r]||new Set,this._updatedLayers[r].add(t.id),this.setDirty()}removeLayer(t){const r=t.scope;this._removedLayers[r]=this._removedLayers[r]||{},this._updatedLayers[r]=this._updatedLayers[r]||new Set,this._removedLayers[r][t.id]=t,this._updatedLayers[r].delete(t.id),this._updatedPaintProps.delete(t.fqid),this.setDirty()}getRemovedLayer(t){return this._removedLayers[t.scope]?this._removedLayers[t.scope][t.id]:null}discardLayerRemoval(t){this._removedLayers[t.scope]&&delete this._removedLayers[t.scope][t.id]}getLayerUpdatesByScope(){const t={};for(const r in this._updatedLayers)t[r]=t[r]||{},t[r].updatedIds=Array.from(this._updatedLayers[r].values());for(const r in this._removedLayers)t[r]=t[r]||{},t[r].removedIds=Object.keys(this._removedLayers[r]);return t}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(t){this._updatedPaintProps.add(t.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(t){this._updatedImages.add(t),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}const mw={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class $h{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ci{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Dr(e,t=1){let r=0,s=0;return{members:e.map(c=>{const d=mw[c.type].BYTES_PER_ELEMENT,f=r=a_(r,Math.max(t,d)),g=c.components||1;return s=Math.max(s,d),r+=d*g,{name:c.name,type:c.type,components:g,offset:f}}),size:a_(r,Math.max(s,t)),alignment:t}}function a_(e,t){return Math.ceil(e/t)*t}class pa extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,r)}emplace(t,r,s){const c=2*t;return this.int16[c+0]=r,this.int16[c+1]=s,t}}pa.prototype.bytesPerElement=4,De(pa,"StructArrayLayout2i4");class l_ extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,r,s)}emplace(t,r,s,c){const d=3*t;return this.int16[d+0]=r,this.int16[d+1]=s,this.int16[d+2]=c,t}}l_.prototype.bytesPerElement=6,De(l_,"StructArrayLayout3i6");class el extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,r,s,c)}emplace(t,r,s,c,d){const f=4*t;return this.int16[f+0]=r,this.int16[f+1]=s,this.int16[f+2]=c,this.int16[f+3]=d,t}}el.prototype.bytesPerElement=8,De(el,"StructArrayLayout4i8");class Gh extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,r,s,c,d)}emplace(t,r,s,c,d,f){const g=5*t;return this.int16[g+0]=r,this.int16[g+1]=s,this.int16[g+2]=c,this.int16[g+3]=d,this.int16[g+4]=f,t}}Gh.prototype.bytesPerElement=10,De(Gh,"StructArrayLayout5i10");class p0 extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,r,s,c,d,f,g)}emplace(t,r,s,c,d,f,g,y){const b=6*t,w=12*t,P=3*t;return this.int16[b+0]=r,this.int16[b+1]=s,this.uint8[w+4]=c,this.uint8[w+5]=d,this.uint8[w+6]=f,this.uint8[w+7]=g,this.float32[P+2]=y,t}}p0.prototype.bytesPerElement=12,De(p0,"StructArrayLayout2i4ub1f12");class Du extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,r,s,c)}emplace(t,r,s,c,d){const f=4*t;return this.float32[f+0]=r,this.float32[f+1]=s,this.float32[f+2]=c,this.float32[f+3]=d,t}}Du.prototype.bytesPerElement=16,De(Du,"StructArrayLayout4f16");class rc extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,r,s,c,d)}emplace(t,r,s,c,d,f){const g=6*t,y=3*t;return this.uint16[g+0]=r,this.uint16[g+1]=s,this.uint16[g+2]=c,this.uint16[g+3]=d,this.float32[y+2]=f,t}}rc.prototype.bytesPerElement=12,De(rc,"StructArrayLayout4ui1f12");class Yy extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,r,s,c)}emplace(t,r,s,c,d){const f=4*t;return this.uint16[f+0]=r,this.uint16[f+1]=s,this.uint16[f+2]=c,this.uint16[f+3]=d,t}}Yy.prototype.bytesPerElement=8,De(Yy,"StructArrayLayout4ui8");class Xy extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,s,c,d,f)}emplace(t,r,s,c,d,f,g){const y=6*t;return this.int16[y+0]=r,this.int16[y+1]=s,this.int16[y+2]=c,this.int16[y+3]=d,this.int16[y+4]=f,this.int16[y+5]=g,t}}Xy.prototype.bytesPerElement=12,De(Xy,"StructArrayLayout6i12");class g0 extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g,y,b,w,P,O){const I=this.length;return this.resize(I+1),this.emplace(I,t,r,s,c,d,f,g,y,b,w,P,O)}emplace(t,r,s,c,d,f,g,y,b,w,P,O,I){const A=12*t;return this.int16[A+0]=r,this.int16[A+1]=s,this.int16[A+2]=c,this.int16[A+3]=d,this.uint16[A+4]=f,this.uint16[A+5]=g,this.uint16[A+6]=y,this.uint16[A+7]=b,this.int16[A+8]=w,this.int16[A+9]=P,this.int16[A+10]=O,this.int16[A+11]=I,t}}g0.prototype.bytesPerElement=24,De(g0,"StructArrayLayout4i4ui4i24");class tP extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,s,c,d,f)}emplace(t,r,s,c,d,f,g){const y=10*t,b=5*t;return this.int16[y+0]=r,this.int16[y+1]=s,this.int16[y+2]=c,this.float32[b+2]=d,this.float32[b+3]=f,this.float32[b+4]=g,t}}tP.prototype.bytesPerElement=20,De(tP,"StructArrayLayout3i3f20");class Qy extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}Qy.prototype.bytesPerElement=4,De(Qy,"StructArrayLayout1ul4");class ku extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,r)}emplace(t,r,s){const c=2*t;return this.uint16[c+0]=r,this.uint16[c+1]=s,t}}ku.prototype.bytesPerElement=4,De(ku,"StructArrayLayout2ui4");class m0 extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g,y,b,w,P,O,I){const A=this.length;return this.resize(A+1),this.emplace(A,t,r,s,c,d,f,g,y,b,w,P,O,I)}emplace(t,r,s,c,d,f,g,y,b,w,P,O,I,A){const l=20*t,u=10*t;return this.int16[l+0]=r,this.int16[l+1]=s,this.int16[l+2]=c,this.int16[l+3]=d,this.int16[l+4]=f,this.float32[u+3]=g,this.float32[u+4]=y,this.float32[u+5]=b,this.float32[u+6]=w,this.int16[l+14]=P,this.uint32[u+8]=O,this.uint16[l+18]=I,this.uint16[l+19]=A,t}}m0.prototype.bytesPerElement=40,De(m0,"StructArrayLayout5i4f1i1ul2ui40");class _0 extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,r,s,c,d,f,g)}emplace(t,r,s,c,d,f,g,y){const b=8*t;return this.int16[b+0]=r,this.int16[b+1]=s,this.int16[b+2]=c,this.int16[b+4]=d,this.int16[b+5]=f,this.int16[b+6]=g,this.int16[b+7]=y,t}}_0.prototype.bytesPerElement=16,De(_0,"StructArrayLayout3i2i2i16");class y0 extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,r,s,c,d)}emplace(t,r,s,c,d,f){const g=4*t,y=8*t;return this.float32[g+0]=r,this.float32[g+1]=s,this.float32[g+2]=c,this.int16[y+6]=d,this.int16[y+7]=f,t}}y0.prototype.bytesPerElement=16,De(y0,"StructArrayLayout2f1f2i16");class eP extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,r,s,c)}emplace(t,r,s,c,d){const f=12*t,g=3*t;return this.uint8[f+0]=r,this.uint8[f+1]=s,this.float32[g+1]=c,this.float32[g+2]=d,t}}eP.prototype.bytesPerElement=12,De(eP,"StructArrayLayout2ub2f12");class Mo extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,r,s)}emplace(t,r,s,c){const d=3*t;return this.uint16[d+0]=r,this.uint16[d+1]=s,this.uint16[d+2]=c,t}}Mo.prototype.bytesPerElement=6,De(Mo,"StructArrayLayout3ui6");class hT extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p,m,v,C,E){const T=this.length;return this.resize(T+1),this.emplace(T,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p,m,v,C,E)}emplace(t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p,m,v,C,E,T){const k=30*t,N=15*t,F=60*t;return this.int16[k+0]=r,this.int16[k+1]=s,this.int16[k+2]=c,this.float32[N+2]=d,this.float32[N+3]=f,this.uint16[k+8]=g,this.uint16[k+9]=y,this.uint32[N+5]=b,this.uint32[N+6]=w,this.uint32[N+7]=P,this.uint16[k+16]=O,this.uint16[k+17]=I,this.uint16[k+18]=A,this.float32[N+10]=l,this.float32[N+11]=u,this.uint8[F+48]=p,this.uint8[F+49]=m,this.uint8[F+50]=v,this.uint32[N+13]=C,this.int16[k+28]=E,this.uint8[F+58]=T,t}}hT.prototype.bytesPerElement=60,De(hT,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class nP extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p,m,v,C,E,T,k,N,F,$,q,Z,X,K,J,st){const ot=this.length;return this.resize(ot+1),this.emplace(ot,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p,m,v,C,E,T,k,N,F,$,q,Z,X,K,J,st)}emplace(t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p,m,v,C,E,T,k,N,F,$,q,Z,X,K,J,st,ot){const rt=20*t,ct=40*t,yt=80*t;return this.float32[rt+0]=r,this.float32[rt+1]=s,this.int16[ct+4]=c,this.int16[ct+5]=d,this.int16[ct+6]=f,this.int16[ct+7]=g,this.int16[ct+8]=y,this.int16[ct+9]=b,this.int16[ct+10]=w,this.int16[ct+11]=P,this.int16[ct+12]=O,this.uint16[ct+13]=I,this.uint16[ct+14]=A,this.uint16[ct+15]=l,this.uint16[ct+16]=u,this.uint16[ct+17]=p,this.uint16[ct+18]=m,this.uint16[ct+19]=v,this.uint16[ct+20]=C,this.uint16[ct+21]=E,this.uint16[ct+22]=T,this.uint16[ct+23]=k,this.uint16[ct+24]=N,this.uint16[ct+25]=F,this.uint16[ct+26]=$,this.uint16[ct+27]=q,this.uint32[rt+14]=Z,this.float32[rt+15]=X,this.float32[rt+16]=K,this.float32[rt+17]=J,this.float32[rt+18]=st,this.uint8[yt+76]=ot,t}}nP.prototype.bytesPerElement=80,De(nP,"StructArrayLayout2f9i15ui1ul4f1ub80");class v0 extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}v0.prototype.bytesPerElement=4,De(v0,"StructArrayLayout1f4");class fp extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,r,s,c,d)}emplace(t,r,s,c,d,f){const g=5*t;return this.float32[g+0]=r,this.float32[g+1]=s,this.float32[g+2]=c,this.float32[g+3]=d,this.float32[g+4]=f,t}}fp.prototype.bytesPerElement=20,De(fp,"StructArrayLayout5f20");class fT extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,r,s,c,d,f,g)}emplace(t,r,s,c,d,f,g,y){const b=7*t;return this.float32[b+0]=r,this.float32[b+1]=s,this.float32[b+2]=c,this.float32[b+3]=d,this.float32[b+4]=f,this.float32[b+5]=g,this.float32[b+6]=y,t}}fT.prototype.bytesPerElement=28,De(fT,"StructArrayLayout7f28");class pT extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,r,s,c)}emplace(t,r,s,c,d){const f=6*t;return this.uint32[3*t+0]=r,this.uint16[f+2]=s,this.uint16[f+3]=c,this.uint16[f+4]=d,t}}pT.prototype.bytesPerElement=12,De(pT,"StructArrayLayout1ul3ui12");class c_ extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}c_.prototype.bytesPerElement=2,De(c_,"StructArrayLayout1ui2");class Jy extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,r,s)}emplace(t,r,s,c){const d=3*t;return this.float32[d+0]=r,this.float32[d+1]=s,this.float32[d+2]=c,t}}Jy.prototype.bytesPerElement=12,De(Jy,"StructArrayLayout3f12");class _w extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,r)}emplace(t,r,s){const c=2*t;return this.float32[c+0]=r,this.float32[c+1]=s,t}}_w.prototype.bytesPerElement=8,De(_w,"StructArrayLayout2f8");class gT extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u)}emplace(t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p){const m=16*t;return this.float32[m+0]=r,this.float32[m+1]=s,this.float32[m+2]=c,this.float32[m+3]=d,this.float32[m+4]=f,this.float32[m+5]=g,this.float32[m+6]=y,this.float32[m+7]=b,this.float32[m+8]=w,this.float32[m+9]=P,this.float32[m+10]=O,this.float32[m+11]=I,this.float32[m+12]=A,this.float32[m+13]=l,this.float32[m+14]=u,this.float32[m+15]=p,t}}gT.prototype.bytesPerElement=64,De(gT,"StructArrayLayout16f64");class rP extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,r,s,c,d,f,g)}emplace(t,r,s,c,d,f,g,y){const b=10*t,w=5*t;return this.uint16[b+0]=r,this.uint16[b+1]=s,this.uint16[b+2]=c,this.uint16[b+3]=d,this.float32[w+2]=f,this.float32[w+3]=g,this.float32[w+4]=y,t}}rP.prototype.bytesPerElement=20,De(rP,"StructArrayLayout4ui3f20");class mT extends Ci{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint8[1*t+0]=r,t}}mT.prototype.bytesPerElement=1,De(mT,"StructArrayLayout1ub1");class iP extends $h{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}iP.prototype.size=40;class tv extends m0{get(t){return new iP(this,t)}}De(tv,"CollisionBoxArray");class b0 extends $h{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}b0.prototype.size=60;class oP extends hT{get(t){return new b0(this,t)}}De(oP,"PlacedSymbolArray");class sP extends $h{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}sP.prototype.size=80;class aP extends nP{get(t){return new sP(this,t)}}De(aP,"SymbolInstanceArray");class u_ extends v0{getoffsetX(t){return this.float32[1*t+0]}}De(u_,"GlyphOffsetArray");class lP extends pa{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}De(lP,"SymbolLineVertexArray");class cP extends $h{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}cP.prototype.size=12;class x0 extends pT{get(t){return new cP(this,t)}}De(x0,"FeatureIndexArray");class w0 extends ku{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}De(w0,"FillExtrusionCentroidArray");const yw=Dr([{name:"a_pos",components:2,type:"Int16"}],4),ES=Dr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class li{constructor(t=[]){this.segments=t}_prepareSegment(t,r,s,c){let d=this.segments[this.segments.length-1];return t>li.MAX_VERTEX_ARRAY_LENGTH&&gt(`Max vertices per segment is ${li.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!d||d.vertexLength+t>li.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==c)&&(d={vertexOffset:r,primitiveOffset:s,vertexLength:0,primitiveLength:0},void 0!==c&&(d.sortKey=c),this.segments.push(d)),d}prepareSegment(t,r,s,c){return this._prepareSegment(t,r.length,s.length,c)}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,s,c){return new li([{vertexOffset:t,primitiveOffset:r,vertexLength:s,primitiveLength:c,vaos:{},sortKey:0}])}}function _T(e,t){return 256*(e=Ne(Math.floor(e),0,255))+Ne(Math.floor(t),0,255)}li.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,De(li,"SegmentVector");const yT=Dr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),uP=Dr([{name:"a_dash",components:4,type:"Uint16"}]);var vw={exports:{}},OS={exports:function(t,r){var s,c,d,f,g,y,b,w;for(c=t.length-(s=3&t.length),d=r,g=3432918353,y=461845907,w=0;w<c;)b=255&t.charCodeAt(w)|(255&t.charCodeAt(++w))<<8|(255&t.charCodeAt(++w))<<16|(255&t.charCodeAt(++w))<<24,++w,d=27492+(65535&(f=5*(65535&(d=(d^=b=(65535&(b=(b=(65535&b)*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*y+(((b>>>16)*y&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(b=0,s){case 3:b^=(255&t.charCodeAt(w+2))<<16;case 2:b^=(255&t.charCodeAt(w+1))<<8;case 1:d^=b=(65535&(b=(b=(65535&(b^=255&t.charCodeAt(w)))*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*y+(((b>>>16)*y&65535)<<16)&4294967295}return d^=t.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0}}.exports,dP={exports:{}};dP.exports=function(t,r){for(var s,c=t.length,d=r^c,f=0;c>=4;)s=1540483477*(65535&(s=255&t.charCodeAt(f)|(255&t.charCodeAt(++f))<<8|(255&t.charCodeAt(++f))<<16|(255&t.charCodeAt(++f))<<24))+((1540483477*(s>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),c-=4,++f;switch(c){case 3:d^=(255&t.charCodeAt(f+2))<<16;case 2:d^=(255&t.charCodeAt(f+1))<<8;case 1:d=1540483477*(65535&(d^=255&t.charCodeAt(f)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var bT=OS,TS=dP.exports;vw.exports=bT,vw.exports.murmur3=bT,vw.exports.murmur2=TS;var nl=We(vw.exports);class d_{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,r,s,c){this.ids.push(hP(t)),this.positions.push(r,s,c)}eachPosition(t,r){const s=hP(t);let c=0,d=this.ids.length-1;for(;c<d;){const f=c+d>>1;this.ids[f]>=s?d=f:c=f+1}for(;this.ids[c]===s;)r(this.positions[3*c],this.positions[3*c+1],this.positions[3*c+2]),c++}static serialize(t,r){const s=new Float64Array(t.ids),c=new Uint32Array(t.positions);return C0(s,c,0,s.length-1),r&&(r.add(s.buffer),r.add(c.buffer)),{ids:s,positions:c}}static deserialize(t){const r=new d_;let s;r.ids=t.ids,r.positions=t.positions;for(const c of r.ids)c!==s&&r.uniqueIds.push(c),s=c;return r.indexed=!0,r}}function hP(e){const t=+e;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:nl(String(e))}function C0(e,t,r,s){for(;r<s;){const c=e[r+s>>1];let d=r-1,f=s+1;for(;;){do{d++}while(e[d]<c);do{f--}while(e[f]>c);if(d>=f)break;Qs(e,d,f),Qs(t,3*d,3*f),Qs(t,3*d+1,3*f+1),Qs(t,3*d+2,3*f+2)}f-r<s-f?(C0(e,t,r,f),r=f+1):(C0(e,t,f+1,s),s=f)}}function Qs(e,t,r){const s=e[t];e[t]=e[r],e[r]=s}De(d_,"FeaturePositionMap");class Fc{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,r){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,r),this.initialized=!0),!!this.location}}class cr extends Fc{constructor(t){super(t),this.current=0}set(t,r,s){this.fetchUniformLocation(t,r)&&this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}}class fe extends Fc{constructor(t){super(t),this.current=0}set(t,r,s){this.fetchUniformLocation(t,r)&&this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class fr extends Fc{constructor(t){super(t),this.current=[0,0]}set(t,r,s){this.fetchUniformLocation(t,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1])))}}class Kn extends Fc{constructor(t){super(t),this.current=[0,0,0]}set(t,r,s){this.fetchUniformLocation(t,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2])))}}class ic extends Fc{constructor(t){super(t),this.current=[0,0,0,0]}set(t,r,s){this.fetchUniformLocation(t,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3])))}}class h_ extends Fc{constructor(t){super(t),this.current=bn.transparent}set(t,r,s){this.fetchUniformLocation(t,r)&&(s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a)))}}const IS=new Float32Array(16);class Vn extends Fc{constructor(t){super(t),this.current=IS}set(t,r,s){if(this.fetchUniformLocation(t,r)){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let c=1;c<16;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}}}const SS=new Float32Array(9);class fP extends Fc{constructor(t){super(t),this.current=SS}set(t,r,s){if(this.fetchUniformLocation(t,r))for(let c=0;c<9;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}const pP=new Float32Array(4);class M0 extends Fc{constructor(t){super(t),this.current=pP}set(t,r,s){if(this.fetchUniformLocation(t,r))for(let c=0;c<4;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix2fv(this.location,!1,s);break}}}function gP(e){return[_T(255*e.r,255*e.g),_T(255*e.b,255*e.a)]}class Hh{constructor(t,r,s){this.value=t,this.uniformNames=r.map(c=>`u_${c}`),this.type=s}setUniform(t,r,s,c,d){r.set(t,d,c.constantOr(this.value))}getBinding(t,r){return"color"===this.type?new h_(t):new fe(t)}}class Ia{constructor(t,r){this.uniformNames=r.map(s=>`u_${s}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,r,s,c,d){const f="u_pattern"===d||"u_dash"===d?this.pattern:"u_pixel_ratio"===d?this.pixelRatio:null;f&&r.set(t,d,f)}getBinding(t,r){return"u_pattern"===r||"u_dash"===r?new ic(t):new fe(t)}}class an{constructor(t,r,s,c){this.expression=t,this.type=s,this.maxValue=0,this.paintVertexAttributes=r.map(d=>({name:`a_${d}`,type:"Float32",components:"color"===s?2:1,offset:0})),this.paintVertexArray=new c}populatePaintArray(t,r,s,c,d,f,g){const y=this.paintVertexArray.length,b=this.expression.evaluate(new Ri(0,{brightness:f}),r,{},d,c,g);this.paintVertexArray.resize(t),this._setPaintValue(y,t,b)}updatePaintArray(t,r,s,c,d,f,g){const y=this.expression.evaluate({zoom:0,brightness:g},s,c,void 0,d);this._setPaintValue(t,r,y)}_setPaintValue(t,r,s){if("color"===this.type){const c=gP(s);for(let d=t;d<r;d++)this.paintVertexArray.emplace(d,c[0],c[1])}else{for(let c=t;c<r;c++)this.paintVertexArray.emplace(c,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Pl{constructor(t,r,s,c,d,f){this.expression=t,this.uniformNames=r.map(g=>`u_${g}_t`),this.type=s,this.useIntegerZoom=c,this.zoom=d,this.maxValue=0,this.paintVertexAttributes=r.map(g=>({name:`a_${g}`,type:"Float32",components:"color"===s?4:2,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,r,s,c,d,f,g){const y=this.expression.evaluate(new Ri(this.zoom,{brightness:f}),r,{},d,c,g),b=this.expression.evaluate(new Ri(this.zoom+1,{brightness:f}),r,{},d,c,g),w=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(w,t,y,b)}updatePaintArray(t,r,s,c,d,f,g){const y=this.expression.evaluate({zoom:this.zoom,brightness:g},s,c,void 0,d),b=this.expression.evaluate({zoom:this.zoom+1,brightness:g},s,c,void 0,d);this._setPaintValue(t,r,y,b)}_setPaintValue(t,r,s,c){if("color"===this.type){const d=gP(s),f=gP(c);for(let g=t;g<r;g++)this.paintVertexArray.emplace(g,d[0],d[1],f[0],f[1])}else{for(let d=t;d<r;d++)this.paintVertexArray.emplace(d,s,c);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r,s,c,d){const f=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,g=Ne(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);r.set(t,d,g)}getBinding(t,r){return new fe(t)}}class pr{constructor(t,r,s,c,d){this.expression=t,this.layerId=d,this.paintVertexAttributes=("array"===s?uP:yT).members;for(let f=0;f<r.length;++f);this.paintVertexArray=new c}populatePaintArray(t,r,s){const c=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(c,t,r.patterns&&r.patterns[this.layerId],s)}updatePaintArray(t,r,s,c,d,f,g){this._setPaintValues(t,r,s.patterns&&s.patterns[this.layerId],f)}_setPaintValues(t,r,s,c){if(!c||!s)return;const d=c[s];if(!d)return;const{tl:f,br:g,pixelRatio:y}=d;for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,f[0],f[1],g[0],g[1],y)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ru{constructor(t,r,s=(()=>!0)){this.binders={},this._buffers=[];const c=[];for(const d in t.paint._values){const f=t.paint.get(d);if(!s(d)||!(f instanceof R&&Ns(f.property.specification)))continue;const g=E0(d,t.type),y=f.value,b=f.property.specification.type,w=!!f.property.useIntegerZoom,P="line-dasharray"===d||d.endsWith("pattern"),O="line-dasharray"===d&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==y.kind||O)if("source"===y.kind||O||P){const I=mP(d,b,"source");this.binders[d]=P?new pr(y,g,b,I,t.id):new an(y,g,b,I),c.push(`/a_${d}`)}else{const I=mP(d,b,"composite");this.binders[d]=new Pl(y,g,b,w,r,I),c.push(`/z_${d}`)}else this.binders[d]=P?new Ia(y.value,g):new Hh(y.value,g,b),c.push(`/u_${d}`)}this.cacheKey=c.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof an||r instanceof Pl?r.maxValue:0}populatePaintArrays(t,r,s,c,d,f,g){for(const y in this.binders){const b=this.binders[y];(b instanceof an||b instanceof Pl||b instanceof pr)&&b.populatePaintArray(t,r,s,c,d,f,g)}}setConstantPatternPositions(t){for(const r in this.binders){const s=this.binders[r];s instanceof Ia&&s.setConstantPatternPositions(t)}}updatePaintArrays(t,r,s,c,d,f,g,y){let b=!1;const w=Object.keys(t),P=0!==w.length,O=P?w:r.uniqueIds;for(const I in this.binders){const A=this.binders[I];if((A instanceof an||A instanceof Pl||A instanceof pr)&&(!0===A.expression.isStateDependent||!1===A.expression.isLightConstant)){const l=d.paint.get(I);A.expression=l.value;for(const u of O){const p=t[u.toString()];r.eachPosition(u,(m,v,C)=>{const E=c.feature(m);A.updatePaintArray(v,C,E,p,f,g,y)})}if(!P)for(const u of s.uniqueIds){const p=t[u.toString()];s.eachPosition(u,(m,v,C)=>{const E=c.feature(m);A.updatePaintArray(v,C,E,p,f,g,y)})}b=!0}}return b}defines(){const t=[];for(const r in this.binders){const s=this.binders[r];(s instanceof Hh||s instanceof Ia)&&t.push(...s.uniformNames.map(c=>`#define HAS_UNIFORM_${c}`))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof an||s instanceof Pl||s instanceof pr)for(let c=0;c<s.paintVertexAttributes.length;c++)t.push(s.paintVertexAttributes[c].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof Hh||s instanceof Ia||s instanceof Pl)for(const c of s.uniformNames)t.push(c)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const r=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof Hh||c instanceof Ia||c instanceof Pl)for(const d of c.uniformNames)r.push({name:d,property:s,binding:c.getBinding(t,d)})}return r}setUniforms(t,r,s,c,d){for(const{name:f,property:g,binding:y}of s)this.binders[g].setUniform(t,y,d,c.get(g),f)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const r=this.binders[t];(r instanceof an||r instanceof Pl||r instanceof pr)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(t){for(const r in this.binders){const s=this.binders[r];(s instanceof an||s instanceof Pl||s instanceof pr)&&s.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof an||r instanceof Pl||r instanceof pr)&&r.destroy()}}}class ga{constructor(t,r,s=(()=>!0)){this.programConfigurations={};for(const c of t)this.programConfigurations[c.id]=new Ru(c,r,s);this.needsUpload=!1,this._featureMap=new d_,this._featureMapWithoutIds=new d_,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,r,s,c,d,f,g,y){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,r,c,d,f,g,y);void 0!==r.id?this._featureMap.add(r.id,s,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,s,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,s,c,d,f){for(const g of s)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,r,g,c,d,f||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const P0={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function E0(e,t){return P0[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}const bw={"line-pattern":{source:rc,composite:rc},"fill-pattern":{source:rc,composite:rc},"fill-extrusion-pattern":{source:rc,composite:rc},"line-dasharray":{source:Yy,composite:Yy}},O0={color:{source:_w,composite:Du},number:{source:v0,composite:_w}};function mP(e,t,r){const s=bw[e];return s&&s[r]||O0[t][r]}De(Hh,"ConstantBinder"),De(Ia,"PatternConstantBinder"),De(an,"SourceExpressionBinder"),De(pr,"PatternCompositeBinder"),De(Pl,"CompositeExpressionBinder"),De(Ru,"ProgramConfiguration",{omit:["_buffers"]}),De(ga,"ProgramConfigurationSet");class Xi{constructor(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof kn?new kn(t.lng,t.lat):kn.convert(t),this}setSouthWest(t){return this._sw=t instanceof kn?new kn(t.lng,t.lat):kn.convert(t),this}extend(t){const r=this._sw,s=this._ne;let c,d;if(t instanceof kn)c=t,d=t;else{if(!(t instanceof Xi))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Xi.convert(t)):this.extend(kn.convert(t)):"object"==typeof t&&null!==t&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(kn.convert(t)):this;if(c=t._sw,d=t._ne,!c||!d)return this}return r||s?(r.lng=Math.min(c.lng,r.lng),r.lat=Math.min(c.lat,r.lat),s.lng=Math.max(d.lng,s.lng),s.lat=Math.max(d.lat,s.lat)):(this._sw=new kn(c.lng,c.lat),this._ne=new kn(d.lng,d.lat)),this}getCenter(){return new kn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new kn(this.getWest(),this.getNorth())}getSouthEast(){return new kn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:r,lat:s}=kn.convert(t);let c=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(c=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&c}static convert(t){return!t||t instanceof Xi?t:new Xi(t)}}var zo={},ci={};Object.defineProperty(ci,"__esModule",{value:!0}),ci.setMatrixArrayType=function(e){ci.ARRAY_TYPE=_P=e},ci.toRadian=function(e){return e*f_},ci.equals=function(e,t){return Math.abs(e-t)<=qh*Math.max(1,Math.abs(e),Math.abs(t))},ci.RANDOM=ci.ARRAY_TYPE=ci.EPSILON=void 0;var qh=1e-6;ci.EPSILON=qh;var _P=typeof Float32Array<"u"?Float32Array:Array;ci.ARRAY_TYPE=_P;var xw=Math.random;ci.RANDOM=xw;var f_=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Di={};function Is(e){return(Is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(Di,"__esModule",{value:!0}),Di.create=function(){var e=new pp.ARRAY_TYPE(4);return pp.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},Di.clone=function(e){var t=new pp.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Di.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},Di.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},Di.fromValues=function(e,t,r,s){var c=new pp.ARRAY_TYPE(4);return c[0]=e,c[1]=t,c[2]=r,c[3]=s,c},Di.set=function(e,t,r,s,c){return e[0]=t,e[1]=r,e[2]=s,e[3]=c,e},Di.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},Di.invert=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=r*d-c*s;return f?(e[0]=d*(f=1/f),e[1]=-s*f,e[2]=-c*f,e[3]=r*f,e):null},Di.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},Di.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},Di.multiply=Og,Di.rotate=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=Math.sin(r),y=Math.cos(r);return e[0]=s*y+d*g,e[1]=c*y+f*g,e[2]=s*-g+d*y,e[3]=c*-g+f*y,e},Di.scale=function(e,t,r){var s=t[1],c=t[2],d=t[3],f=r[0],g=r[1];return e[0]=t[0]*f,e[1]=s*f,e[2]=c*g,e[3]=d*g,e},Di.fromRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=r,e[2]=-r,e[3]=s,e},Di.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},Di.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},Di.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},Di.LDU=function(e,t,r,s){return e[2]=s[2]/s[0],r[0]=s[0],r[1]=s[1],r[3]=s[3]-e[2]*r[1],[e,t,r]},Di.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},Di.subtract=zc,Di.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},Di.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=e[3],f=t[0],g=t[1],y=t[2],b=t[3];return Math.abs(r-f)<=pp.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(s-g)<=pp.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-y)<=pp.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(d-b)<=pp.EPSILON*Math.max(1,Math.abs(d),Math.abs(b))},Di.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},Di.multiplyScalarAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e[2]=t[2]+r[2]*s,e[3]=t[3]+r[3]*s,e},Di.sub=Di.mul=void 0;var pp=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==Is(e)&&"function"!=typeof e)return{default:e};var r=p_(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(ci);function p_(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p_=function(s){return s?r:t})(e)}function Og(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=r[0],y=r[1],b=r[2],w=r[3];return e[0]=s*g+d*y,e[1]=c*g+f*y,e[2]=s*b+d*w,e[3]=c*b+f*w,e}function zc(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}Di.mul=Og,Di.sub=zc;var fi={};function T0(e){return(T0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(fi,"__esModule",{value:!0}),fi.create=function(){var e=new Lu.ARRAY_TYPE(6);return Lu.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},fi.clone=function(e){var t=new Lu.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},fi.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},fi.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},fi.fromValues=function(e,t,r,s,c,d){var f=new Lu.ARRAY_TYPE(6);return f[0]=e,f[1]=t,f[2]=r,f[3]=s,f[4]=c,f[5]=d,f},fi.set=function(e,t,r,s,c,d,f){return e[0]=t,e[1]=r,e[2]=s,e[3]=c,e[4]=d,e[5]=f,e},fi.invert=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=r*d-s*c;return y?(e[0]=d*(y=1/y),e[1]=-s*y,e[2]=-c*y,e[3]=r*y,e[4]=(c*g-d*f)*y,e[5]=(s*f-r*g)*y,e):null},fi.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},fi.multiply=yP,fi.rotate=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=Math.sin(r),w=Math.cos(r);return e[0]=s*w+d*b,e[1]=c*w+f*b,e[2]=s*-b+d*w,e[3]=c*-b+f*w,e[4]=g,e[5]=y,e},fi.scale=function(e,t,r){var s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=r[0],b=r[1];return e[0]=t[0]*y,e[1]=s*y,e[2]=c*b,e[3]=d*b,e[4]=f,e[5]=g,e},fi.translate=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=r[0],w=r[1];return e[0]=s,e[1]=c,e[2]=d,e[3]=f,e[4]=s*b+d*w+g,e[5]=c*b+f*w+y,e},fi.fromRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=r,e[2]=-r,e[3]=s,e[4]=0,e[5]=0,e},fi.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},fi.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},fi.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},fi.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)},fi.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},fi.subtract=Ig,fi.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},fi.multiplyScalarAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e[2]=t[2]+r[2]*s,e[3]=t[3]+r[3]*s,e[4]=t[4]+r[4]*s,e[5]=t[5]+r[5]*s,e},fi.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},fi.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=e[3],f=e[4],g=e[5],y=t[0],b=t[1],w=t[2],P=t[3],O=t[4],I=t[5];return Math.abs(r-y)<=Lu.EPSILON*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(s-b)<=Lu.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(c-w)<=Lu.EPSILON*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(d-P)<=Lu.EPSILON*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(f-O)<=Lu.EPSILON*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(g-I)<=Lu.EPSILON*Math.max(1,Math.abs(g),Math.abs(I))},fi.sub=fi.mul=void 0;var Lu=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==T0(e)&&"function"!=typeof e)return{default:e};var r=Tg(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(ci);function Tg(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(Tg=function(s){return s?r:t})(e)}function yP(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=r[0],w=r[1],P=r[2],O=r[3],I=r[4],A=r[5];return e[0]=s*b+d*w,e[1]=c*b+f*w,e[2]=s*P+d*O,e[3]=c*P+f*O,e[4]=s*I+d*A+g,e[5]=c*I+f*A+y,e}function Ig(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}fi.mul=yP,fi.sub=Ig;var ui={};function I0(e){return(I0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(ui,"__esModule",{value:!0}),ui.create=function(){var e=new rl.ARRAY_TYPE(9);return rl.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},ui.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},ui.clone=function(e){var t=new rl.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},ui.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},ui.fromValues=function(e,t,r,s,c,d,f,g,y){var b=new rl.ARRAY_TYPE(9);return b[0]=e,b[1]=t,b[2]=r,b[3]=s,b[4]=c,b[5]=d,b[6]=f,b[7]=g,b[8]=y,b},ui.set=function(e,t,r,s,c,d,f,g,y,b){return e[0]=t,e[1]=r,e[2]=s,e[3]=c,e[4]=d,e[5]=f,e[6]=g,e[7]=y,e[8]=b,e},ui.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},ui.transpose=function(e,t){if(e===t){var r=t[1],s=t[2],c=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=s,e[7]=c}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},ui.invert=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=t[6],b=t[7],w=t[8],P=w*f-g*b,O=-w*d+g*y,I=b*d-f*y,A=r*P+s*O+c*I;return A?(e[0]=P*(A=1/A),e[1]=(-w*s+c*b)*A,e[2]=(g*s-c*f)*A,e[3]=O*A,e[4]=(w*r-c*y)*A,e[5]=(-g*r+c*d)*A,e[6]=I*A,e[7]=(-b*r+s*y)*A,e[8]=(f*r-s*d)*A,e):null},ui.adjoint=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=t[6],b=t[7],w=t[8];return e[0]=f*w-g*b,e[1]=c*b-s*w,e[2]=s*g-c*f,e[3]=g*y-d*w,e[4]=r*w-c*y,e[5]=c*d-r*g,e[6]=d*b-f*y,e[7]=s*y-r*b,e[8]=r*f-s*d,e},ui.determinant=function(e){var t=e[3],r=e[4],s=e[5],c=e[6],d=e[7],f=e[8];return e[0]*(f*r-s*d)+e[1]*(-f*t+s*c)+e[2]*(d*t-r*c)},ui.multiply=g_,ui.translate=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=t[6],w=t[7],P=t[8],O=r[0],I=r[1];return e[0]=s,e[1]=c,e[2]=d,e[3]=f,e[4]=g,e[5]=y,e[6]=O*s+I*f+b,e[7]=O*c+I*g+w,e[8]=O*d+I*y+P,e},ui.rotate=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=t[6],w=t[7],P=t[8],O=Math.sin(r),I=Math.cos(r);return e[0]=I*s+O*f,e[1]=I*c+O*g,e[2]=I*d+O*y,e[3]=I*f-O*s,e[4]=I*g-O*c,e[5]=I*y-O*d,e[6]=b,e[7]=w,e[8]=P,e},ui.scale=function(e,t,r){var s=r[0],c=r[1];return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=c*t[3],e[4]=c*t[4],e[5]=c*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},ui.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},ui.fromRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=r,e[2]=0,e[3]=-r,e[4]=s,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},ui.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},ui.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},ui.fromQuat=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=r+r,g=s+s,y=c+c,b=r*f,w=s*f,P=s*g,O=c*f,I=c*g,A=c*y,l=d*f,u=d*g,p=d*y;return e[0]=1-P-A,e[3]=w-p,e[6]=O+u,e[1]=w+p,e[4]=1-b-A,e[7]=I-l,e[2]=O-u,e[5]=I+l,e[8]=1-b-P,e},ui.normalFromMat4=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=t[6],b=t[7],w=t[8],P=t[9],O=t[10],I=t[11],A=t[12],l=t[13],u=t[14],p=t[15],m=r*g-s*f,v=r*y-c*f,C=r*b-d*f,E=s*y-c*g,T=s*b-d*g,k=c*b-d*y,N=w*l-P*A,F=w*u-O*A,$=w*p-I*A,q=P*u-O*l,Z=P*p-I*l,X=O*p-I*u,K=m*X-v*Z+C*q+E*$-T*F+k*N;return K?(e[0]=(g*X-y*Z+b*q)*(K=1/K),e[1]=(y*$-f*X-b*F)*K,e[2]=(f*Z-g*$+b*N)*K,e[3]=(c*Z-s*X-d*q)*K,e[4]=(r*X-c*$+d*F)*K,e[5]=(s*$-r*Z-d*N)*K,e[6]=(l*k-u*T+p*E)*K,e[7]=(u*C-A*k-p*v)*K,e[8]=(A*T-l*C+p*m)*K,e):null},ui.projection=function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},ui.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},ui.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},ui.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},ui.subtract=nv,ui.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},ui.multiplyScalarAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e[2]=t[2]+r[2]*s,e[3]=t[3]+r[3]*s,e[4]=t[4]+r[4]*s,e[5]=t[5]+r[5]*s,e[6]=t[6]+r[6]*s,e[7]=t[7]+r[7]*s,e[8]=t[8]+r[8]*s,e},ui.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},ui.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=e[3],f=e[4],g=e[5],y=e[6],b=e[7],w=e[8],P=t[0],O=t[1],I=t[2],A=t[3],l=t[4],u=t[5],p=t[6],m=t[7],v=t[8];return Math.abs(r-P)<=rl.EPSILON*Math.max(1,Math.abs(r),Math.abs(P))&&Math.abs(s-O)<=rl.EPSILON*Math.max(1,Math.abs(s),Math.abs(O))&&Math.abs(c-I)<=rl.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(d-A)<=rl.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(f-l)<=rl.EPSILON*Math.max(1,Math.abs(f),Math.abs(l))&&Math.abs(g-u)<=rl.EPSILON*Math.max(1,Math.abs(g),Math.abs(u))&&Math.abs(y-p)<=rl.EPSILON*Math.max(1,Math.abs(y),Math.abs(p))&&Math.abs(b-m)<=rl.EPSILON*Math.max(1,Math.abs(b),Math.abs(m))&&Math.abs(w-v)<=rl.EPSILON*Math.max(1,Math.abs(w),Math.abs(v))},ui.sub=ui.mul=void 0;var rl=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==I0(e)&&"function"!=typeof e)return{default:e};var r=ev(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(ci);function ev(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(ev=function(s){return s?r:t})(e)}function g_(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=t[6],w=t[7],P=t[8],O=r[0],I=r[1],A=r[2],l=r[3],u=r[4],p=r[5],m=r[6],v=r[7],C=r[8];return e[0]=O*s+I*f+A*b,e[1]=O*c+I*g+A*w,e[2]=O*d+I*y+A*P,e[3]=l*s+u*f+p*b,e[4]=l*c+u*g+p*w,e[5]=l*d+u*y+p*P,e[6]=m*s+v*f+C*b,e[7]=m*c+v*g+C*w,e[8]=m*d+v*y+C*P,e}function nv(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}ui.mul=g_,ui.sub=nv;var Bn={};function Zh(e){return(Zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.create=function(){var e=new Qi.ARRAY_TYPE(16);return Qi.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},Bn.clone=function(e){var t=new Qi.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Bn.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},Bn.fromValues=function(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l){var u=new Qi.ARRAY_TYPE(16);return u[0]=e,u[1]=t,u[2]=r,u[3]=s,u[4]=c,u[5]=d,u[6]=f,u[7]=g,u[8]=y,u[9]=b,u[10]=w,u[11]=P,u[12]=O,u[13]=I,u[14]=A,u[15]=l,u},Bn.set=function(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u){return e[0]=t,e[1]=r,e[2]=s,e[3]=c,e[4]=d,e[5]=f,e[6]=g,e[7]=y,e[8]=b,e[9]=w,e[10]=P,e[11]=O,e[12]=I,e[13]=A,e[14]=l,e[15]=u,e},Bn.identity=Wh,Bn.transpose=function(e,t){if(e===t){var r=t[1],s=t[2],c=t[3],d=t[6],f=t[7],g=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=s,e[9]=d,e[11]=t[14],e[12]=c,e[13]=f,e[14]=g}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},Bn.invert=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=t[6],b=t[7],w=t[8],P=t[9],O=t[10],I=t[11],A=t[12],l=t[13],u=t[14],p=t[15],m=r*g-s*f,v=r*y-c*f,C=r*b-d*f,E=s*y-c*g,T=s*b-d*g,k=c*b-d*y,N=w*l-P*A,F=w*u-O*A,$=w*p-I*A,q=P*u-O*l,Z=P*p-I*l,X=O*p-I*u,K=m*X-v*Z+C*q+E*$-T*F+k*N;return K?(e[0]=(g*X-y*Z+b*q)*(K=1/K),e[1]=(c*Z-s*X-d*q)*K,e[2]=(l*k-u*T+p*E)*K,e[3]=(O*T-P*k-I*E)*K,e[4]=(y*$-f*X-b*F)*K,e[5]=(r*X-c*$+d*F)*K,e[6]=(u*C-A*k-p*v)*K,e[7]=(w*k-O*C+I*v)*K,e[8]=(f*Z-g*$+b*N)*K,e[9]=(s*$-r*Z-d*N)*K,e[10]=(A*T-l*C+p*m)*K,e[11]=(P*C-w*T-I*m)*K,e[12]=(g*F-f*q-y*N)*K,e[13]=(r*q-s*F+c*N)*K,e[14]=(l*v-A*E-u*m)*K,e[15]=(w*E-P*v+O*m)*K,e):null},Bn.adjoint=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=t[6],b=t[7],w=t[8],P=t[9],O=t[10],I=t[11],A=t[12],l=t[13],u=t[14],p=t[15];return e[0]=g*(O*p-I*u)-P*(y*p-b*u)+l*(y*I-b*O),e[1]=-(s*(O*p-I*u)-P*(c*p-d*u)+l*(c*I-d*O)),e[2]=s*(y*p-b*u)-g*(c*p-d*u)+l*(c*b-d*y),e[3]=-(s*(y*I-b*O)-g*(c*I-d*O)+P*(c*b-d*y)),e[4]=-(f*(O*p-I*u)-w*(y*p-b*u)+A*(y*I-b*O)),e[5]=r*(O*p-I*u)-w*(c*p-d*u)+A*(c*I-d*O),e[6]=-(r*(y*p-b*u)-f*(c*p-d*u)+A*(c*b-d*y)),e[7]=r*(y*I-b*O)-f*(c*I-d*O)+w*(c*b-d*y),e[8]=f*(P*p-I*l)-w*(g*p-b*l)+A*(g*I-b*P),e[9]=-(r*(P*p-I*l)-w*(s*p-d*l)+A*(s*I-d*P)),e[10]=r*(g*p-b*l)-f*(s*p-d*l)+A*(s*b-d*g),e[11]=-(r*(g*I-b*P)-f*(s*I-d*P)+w*(s*b-d*g)),e[12]=-(f*(P*u-O*l)-w*(g*u-y*l)+A*(g*O-y*P)),e[13]=r*(P*u-O*l)-w*(s*u-c*l)+A*(s*O-c*P),e[14]=-(r*(g*u-y*l)-f*(s*u-c*l)+A*(s*y-c*g)),e[15]=r*(g*O-y*P)-f*(s*O-c*P)+w*(s*y-c*g),e},Bn.determinant=function(e){var t=e[0],r=e[1],s=e[2],c=e[3],d=e[4],f=e[5],g=e[6],y=e[7],b=e[8],w=e[9],P=e[10],O=e[11],I=e[12],A=e[13],l=e[14],u=e[15];return(t*f-r*d)*(P*u-O*l)-(t*g-s*d)*(w*u-O*A)+(t*y-c*d)*(w*l-P*A)+(r*g-s*f)*(b*u-O*I)-(r*y-c*f)*(b*l-P*I)+(s*y-c*g)*(b*A-w*I)},Bn.multiply=ww,Bn.translate=function(e,t,r){var s,c,d,f,g,y,b,w,P,O,I,A,l=r[0],u=r[1],p=r[2];return t===e?(e[12]=t[0]*l+t[4]*u+t[8]*p+t[12],e[13]=t[1]*l+t[5]*u+t[9]*p+t[13],e[14]=t[2]*l+t[6]*u+t[10]*p+t[14],e[15]=t[3]*l+t[7]*u+t[11]*p+t[15]):(c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=t[6],w=t[7],P=t[8],O=t[9],I=t[10],A=t[11],e[0]=s=t[0],e[1]=c,e[2]=d,e[3]=f,e[4]=g,e[5]=y,e[6]=b,e[7]=w,e[8]=P,e[9]=O,e[10]=I,e[11]=A,e[12]=s*l+g*u+P*p+t[12],e[13]=c*l+y*u+O*p+t[13],e[14]=d*l+b*u+I*p+t[14],e[15]=f*l+w*u+A*p+t[15]),e},Bn.scale=function(e,t,r){var s=r[0],c=r[1],d=r[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*c,e[5]=t[5]*c,e[6]=t[6]*c,e[7]=t[7]*c,e[8]=t[8]*d,e[9]=t[9]*d,e[10]=t[10]*d,e[11]=t[11]*d,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},Bn.rotate=function(e,t,r,s){var c,d,f,g,y,b,w,P,O,I,A,l,u,p,m,v,C,E,T,k,N,F,$,q,Z=s[0],X=s[1],K=s[2],J=Math.hypot(Z,X,K);return J<Qi.EPSILON?null:(Z*=J=1/J,X*=J,K*=J,c=Math.sin(r),d=Math.cos(r),y=t[1],b=t[2],w=t[3],O=t[5],I=t[6],A=t[7],u=t[9],p=t[10],m=t[11],T=Z*X*(f=1-d)-K*c,k=X*X*f+d,N=K*X*f+Z*c,F=Z*K*f+X*c,$=X*K*f-Z*c,q=K*K*f+d,e[0]=(g=t[0])*(v=Z*Z*f+d)+(P=t[4])*(C=X*Z*f+K*c)+(l=t[8])*(E=K*Z*f-X*c),e[1]=y*v+O*C+u*E,e[2]=b*v+I*C+p*E,e[3]=w*v+A*C+m*E,e[4]=g*T+P*k+l*N,e[5]=y*T+O*k+u*N,e[6]=b*T+I*k+p*N,e[7]=w*T+A*k+m*N,e[8]=g*F+P*$+l*q,e[9]=y*F+O*$+u*q,e[10]=b*F+I*$+p*q,e[11]=w*F+A*$+m*q,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},Bn.rotateX=function(e,t,r){var s=Math.sin(r),c=Math.cos(r),d=t[4],f=t[5],g=t[6],y=t[7],b=t[8],w=t[9],P=t[10],O=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=d*c+b*s,e[5]=f*c+w*s,e[6]=g*c+P*s,e[7]=y*c+O*s,e[8]=b*c-d*s,e[9]=w*c-f*s,e[10]=P*c-g*s,e[11]=O*c-y*s,e},Bn.rotateY=function(e,t,r){var s=Math.sin(r),c=Math.cos(r),d=t[0],f=t[1],g=t[2],y=t[3],b=t[8],w=t[9],P=t[10],O=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=d*c-b*s,e[1]=f*c-w*s,e[2]=g*c-P*s,e[3]=y*c-O*s,e[8]=d*s+b*c,e[9]=f*s+w*c,e[10]=g*s+P*c,e[11]=y*s+O*c,e},Bn.rotateZ=function(e,t,r){var s=Math.sin(r),c=Math.cos(r),d=t[0],f=t[1],g=t[2],y=t[3],b=t[4],w=t[5],P=t[6],O=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=d*c+b*s,e[1]=f*c+w*s,e[2]=g*c+P*s,e[3]=y*c+O*s,e[4]=b*c-d*s,e[5]=w*c-f*s,e[6]=P*c-g*s,e[7]=O*c-y*s,e},Bn.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},Bn.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},Bn.fromRotation=function(e,t,r){var s,c,d,f=r[0],g=r[1],y=r[2],b=Math.hypot(f,g,y);return b<Qi.EPSILON?null:(f*=b=1/b,g*=b,y*=b,s=Math.sin(t),c=Math.cos(t),e[0]=f*f*(d=1-c)+c,e[1]=g*f*d+y*s,e[2]=y*f*d-g*s,e[3]=0,e[4]=f*g*d-y*s,e[5]=g*g*d+c,e[6]=y*g*d+f*s,e[7]=0,e[8]=f*y*d+g*s,e[9]=g*y*d-f*s,e[10]=y*y*d+c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},Bn.fromXRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},Bn.fromYRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},Bn.fromZRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},Bn.fromRotationTranslation=gp,Bn.fromQuat2=function(e,t){var r=new Qi.ARRAY_TYPE(3),s=-t[0],c=-t[1],d=-t[2],f=t[3],g=t[4],y=t[5],b=t[6],w=t[7],P=s*s+c*c+d*d+f*f;return P>0?(r[0]=2*(g*f+w*s+y*d-b*c)/P,r[1]=2*(y*f+w*c+b*s-g*d)/P,r[2]=2*(b*f+w*d+g*c-y*s)/P):(r[0]=2*(g*f+w*s+y*d-b*c),r[1]=2*(y*f+w*c+b*s-g*d),r[2]=2*(b*f+w*d+g*c-y*s)),gp(e,t,r),e},Bn.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},Bn.getScaling=m_,Bn.getRotation=function(e,t){var r=new Qi.ARRAY_TYPE(3);m_(r,t);var s=1/r[0],c=1/r[1],d=1/r[2],f=t[0]*s,g=t[1]*c,y=t[2]*d,b=t[4]*s,w=t[5]*c,P=t[6]*d,O=t[8]*s,I=t[9]*c,A=t[10]*d,l=f+w+A,u=0;return l>0?(u=2*Math.sqrt(l+1),e[3]=.25*u,e[0]=(P-I)/u,e[1]=(O-y)/u,e[2]=(g-b)/u):f>w&&f>A?(u=2*Math.sqrt(1+f-w-A),e[3]=(P-I)/u,e[0]=.25*u,e[1]=(g+b)/u,e[2]=(O+y)/u):w>A?(u=2*Math.sqrt(1+w-f-A),e[3]=(O-y)/u,e[0]=(g+b)/u,e[1]=.25*u,e[2]=(P+I)/u):(u=2*Math.sqrt(1+A-f-w),e[3]=(g-b)/u,e[0]=(O+y)/u,e[1]=(P+I)/u,e[2]=.25*u),e},Bn.fromRotationTranslationScale=function(e,t,r,s){var c=t[0],d=t[1],f=t[2],g=t[3],y=c+c,b=d+d,w=f+f,P=c*y,O=c*b,I=c*w,A=d*b,l=d*w,u=f*w,p=g*y,m=g*b,v=g*w,C=s[0],E=s[1],T=s[2];return e[0]=(1-(A+u))*C,e[1]=(O+v)*C,e[2]=(I-m)*C,e[3]=0,e[4]=(O-v)*E,e[5]=(1-(P+u))*E,e[6]=(l+p)*E,e[7]=0,e[8]=(I+m)*T,e[9]=(l-p)*T,e[10]=(1-(P+A))*T,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},Bn.fromRotationTranslationScaleOrigin=function(e,t,r,s,c){var d=t[0],f=t[1],g=t[2],y=t[3],b=d+d,w=f+f,P=g+g,O=d*b,I=d*w,A=d*P,l=f*w,u=f*P,p=g*P,m=y*b,v=y*w,C=y*P,E=s[0],T=s[1],k=s[2],N=c[0],F=c[1],$=c[2],q=(1-(l+p))*E,Z=(I+C)*E,X=(A-v)*E,K=(I-C)*T,J=(1-(O+p))*T,st=(u+m)*T,ot=(A+v)*k,rt=(u-m)*k,ct=(1-(O+l))*k;return e[0]=q,e[1]=Z,e[2]=X,e[3]=0,e[4]=K,e[5]=J,e[6]=st,e[7]=0,e[8]=ot,e[9]=rt,e[10]=ct,e[11]=0,e[12]=r[0]+N-(q*N+K*F+ot*$),e[13]=r[1]+F-(Z*N+J*F+rt*$),e[14]=r[2]+$-(X*N+st*F+ct*$),e[15]=1,e},Bn.fromQuat=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=r+r,g=s+s,y=c+c,b=r*f,w=s*f,P=s*g,O=c*f,I=c*g,A=c*y,l=d*f,u=d*g,p=d*y;return e[0]=1-P-A,e[1]=w+p,e[2]=O-u,e[3]=0,e[4]=w-p,e[5]=1-b-A,e[6]=I+l,e[7]=0,e[8]=O+u,e[9]=I-l,e[10]=1-b-P,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},Bn.frustum=function(e,t,r,s,c,d,f){var g=1/(r-t),y=1/(c-s),b=1/(d-f);return e[0]=2*d*g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*d*y,e[6]=0,e[7]=0,e[8]=(r+t)*g,e[9]=(c+s)*y,e[10]=(f+d)*b,e[11]=-1,e[12]=0,e[13]=0,e[14]=f*d*2*b,e[15]=0,e},Bn.perspectiveNO=vP,Bn.perspectiveZO=function(e,t,r,s,c){var d,f=1/Math.tan(t/2);return e[0]=f/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=c&&c!==1/0?(e[10]=c*(d=1/(s-c)),e[14]=c*s*d):(e[10]=-1,e[14]=-s),e},Bn.perspectiveFromFieldOfView=function(e,t,r,s){var c=Math.tan(t.upDegrees*Math.PI/180),d=Math.tan(t.downDegrees*Math.PI/180),f=Math.tan(t.leftDegrees*Math.PI/180),g=Math.tan(t.rightDegrees*Math.PI/180),y=2/(f+g),b=2/(c+d);return e[0]=y,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=b,e[6]=0,e[7]=0,e[8]=-(f-g)*y*.5,e[9]=(c-d)*b*.5,e[10]=s/(r-s),e[11]=-1,e[12]=0,e[13]=0,e[14]=s*r/(r-s),e[15]=0,e},Bn.orthoNO=__,Bn.orthoZO=function(e,t,r,s,c,d,f){var g=1/(t-r),y=1/(s-c),b=1/(d-f);return e[0]=-2*g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=b,e[11]=0,e[12]=(t+r)*g,e[13]=(c+s)*y,e[14]=d*b,e[15]=1,e},Bn.lookAt=function(e,t,r,s){var c,d,f,g,y,b,w,P,O,I,A=t[0],l=t[1],u=t[2],p=s[0],m=s[1],v=s[2],C=r[0],E=r[1],T=r[2];return Math.abs(A-C)<Qi.EPSILON&&Math.abs(l-E)<Qi.EPSILON&&Math.abs(u-T)<Qi.EPSILON?Wh(e):(w=A-C,P=l-E,O=u-T,c=m*(O*=I=1/Math.hypot(w,P,O))-v*(P*=I),d=v*(w*=I)-p*O,f=p*P-m*w,(I=Math.hypot(c,d,f))?(c*=I=1/I,d*=I,f*=I):(c=0,d=0,f=0),g=P*f-O*d,y=O*c-w*f,b=w*d-P*c,(I=Math.hypot(g,y,b))?(g*=I=1/I,y*=I,b*=I):(g=0,y=0,b=0),e[0]=c,e[1]=g,e[2]=w,e[3]=0,e[4]=d,e[5]=y,e[6]=P,e[7]=0,e[8]=f,e[9]=b,e[10]=O,e[11]=0,e[12]=-(c*A+d*l+f*u),e[13]=-(g*A+y*l+b*u),e[14]=-(w*A+P*l+O*u),e[15]=1,e)},Bn.targetTo=function(e,t,r,s){var c=t[0],d=t[1],f=t[2],g=s[0],y=s[1],b=s[2],w=c-r[0],P=d-r[1],O=f-r[2],I=w*w+P*P+O*O;I>0&&(w*=I=1/Math.sqrt(I),P*=I,O*=I);var A=y*O-b*P,l=b*w-g*O,u=g*P-y*w;return(I=A*A+l*l+u*u)>0&&(A*=I=1/Math.sqrt(I),l*=I,u*=I),e[0]=A,e[1]=l,e[2]=u,e[3]=0,e[4]=P*u-O*l,e[5]=O*A-w*u,e[6]=w*l-P*A,e[7]=0,e[8]=w,e[9]=P,e[10]=O,e[11]=0,e[12]=c,e[13]=d,e[14]=f,e[15]=1,e},Bn.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},Bn.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},Bn.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},Bn.subtract=A0,Bn.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},Bn.multiplyScalarAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e[2]=t[2]+r[2]*s,e[3]=t[3]+r[3]*s,e[4]=t[4]+r[4]*s,e[5]=t[5]+r[5]*s,e[6]=t[6]+r[6]*s,e[7]=t[7]+r[7]*s,e[8]=t[8]+r[8]*s,e[9]=t[9]+r[9]*s,e[10]=t[10]+r[10]*s,e[11]=t[11]+r[11]*s,e[12]=t[12]+r[12]*s,e[13]=t[13]+r[13]*s,e[14]=t[14]+r[14]*s,e[15]=t[15]+r[15]*s,e},Bn.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},Bn.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=e[3],f=e[4],g=e[5],y=e[6],b=e[7],w=e[8],P=e[9],O=e[10],I=e[11],A=e[12],l=e[13],u=e[14],p=e[15],m=t[0],v=t[1],C=t[2],E=t[3],T=t[4],k=t[5],N=t[6],F=t[7],$=t[8],q=t[9],Z=t[10],X=t[11],K=t[12],J=t[13],st=t[14],ot=t[15];return Math.abs(r-m)<=Qi.EPSILON*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(s-v)<=Qi.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(c-C)<=Qi.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(d-E)<=Qi.EPSILON*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(f-T)<=Qi.EPSILON*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(g-k)<=Qi.EPSILON*Math.max(1,Math.abs(g),Math.abs(k))&&Math.abs(y-N)<=Qi.EPSILON*Math.max(1,Math.abs(y),Math.abs(N))&&Math.abs(b-F)<=Qi.EPSILON*Math.max(1,Math.abs(b),Math.abs(F))&&Math.abs(w-$)<=Qi.EPSILON*Math.max(1,Math.abs(w),Math.abs($))&&Math.abs(P-q)<=Qi.EPSILON*Math.max(1,Math.abs(P),Math.abs(q))&&Math.abs(O-Z)<=Qi.EPSILON*Math.max(1,Math.abs(O),Math.abs(Z))&&Math.abs(I-X)<=Qi.EPSILON*Math.max(1,Math.abs(I),Math.abs(X))&&Math.abs(A-K)<=Qi.EPSILON*Math.max(1,Math.abs(A),Math.abs(K))&&Math.abs(l-J)<=Qi.EPSILON*Math.max(1,Math.abs(l),Math.abs(J))&&Math.abs(u-st)<=Qi.EPSILON*Math.max(1,Math.abs(u),Math.abs(st))&&Math.abs(p-ot)<=Qi.EPSILON*Math.max(1,Math.abs(p),Math.abs(ot))},Bn.sub=Bn.mul=Bn.ortho=Bn.perspective=void 0;var Qi=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==Zh(e)&&"function"!=typeof e)return{default:e};var r=S0(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(ci);function S0(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(S0=function(s){return s?r:t})(e)}function Wh(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ww(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=t[6],w=t[7],P=t[8],O=t[9],I=t[10],A=t[11],l=t[12],u=t[13],p=t[14],m=t[15],v=r[0],C=r[1],E=r[2],T=r[3];return e[0]=v*s+C*g+E*P+T*l,e[1]=v*c+C*y+E*O+T*u,e[2]=v*d+C*b+E*I+T*p,e[3]=v*f+C*w+E*A+T*m,e[4]=(v=r[4])*s+(C=r[5])*g+(E=r[6])*P+(T=r[7])*l,e[5]=v*c+C*y+E*O+T*u,e[6]=v*d+C*b+E*I+T*p,e[7]=v*f+C*w+E*A+T*m,e[8]=(v=r[8])*s+(C=r[9])*g+(E=r[10])*P+(T=r[11])*l,e[9]=v*c+C*y+E*O+T*u,e[10]=v*d+C*b+E*I+T*p,e[11]=v*f+C*w+E*A+T*m,e[12]=(v=r[12])*s+(C=r[13])*g+(E=r[14])*P+(T=r[15])*l,e[13]=v*c+C*y+E*O+T*u,e[14]=v*d+C*b+E*I+T*p,e[15]=v*f+C*w+E*A+T*m,e}function gp(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=s+s,y=c+c,b=d+d,w=s*g,P=s*y,O=s*b,I=c*y,A=c*b,l=d*b,u=f*g,p=f*y,m=f*b;return e[0]=1-(I+l),e[1]=P+m,e[2]=O-p,e[3]=0,e[4]=P-m,e[5]=1-(w+l),e[6]=A+u,e[7]=0,e[8]=O+p,e[9]=A-u,e[10]=1-(w+I),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function m_(e,t){var r=t[4],s=t[5],c=t[6],d=t[8],f=t[9],g=t[10];return e[0]=Math.hypot(t[0],t[1],t[2]),e[1]=Math.hypot(r,s,c),e[2]=Math.hypot(d,f,g),e}function vP(e,t,r,s,c){var d,f=1/Math.tan(t/2);return e[0]=f/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=c&&c!==1/0?(e[10]=(c+s)*(d=1/(s-c)),e[14]=2*c*s*d):(e[10]=-1,e[14]=-2*s),e}function __(e,t,r,s,c,d,f){var g=1/(t-r),y=1/(s-c),b=1/(d-f);return e[0]=-2*g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*b,e[11]=0,e[12]=(t+r)*g,e[13]=(c+s)*y,e[14]=(f+d)*b,e[15]=1,e}function A0(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}Bn.perspective=vP,Bn.ortho=__,Bn.mul=ww,Bn.sub=A0;var jn={},qn={};function rv(e){return(rv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(qn,"__esModule",{value:!0}),qn.create=y_,qn.clone=function(e){var t=new Nu.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},qn.length=Kh,qn.fromValues=function(e,t,r){var s=new Nu.ARRAY_TYPE(3);return s[0]=e,s[1]=t,s[2]=r,s},qn.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},qn.set=function(e,t,r,s){return e[0]=t,e[1]=r,e[2]=s,e},qn.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},qn.subtract=D0,qn.multiply=k0,qn.divide=bP,qn.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},qn.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},qn.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},qn.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},qn.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},qn.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},qn.scaleAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e[2]=t[2]+r[2]*s,e},qn.distance=Cw,qn.squaredDistance=R0,qn.squaredLength=Mw,qn.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},qn.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},qn.normalize=function(e,t){var r=t[0],s=t[1],c=t[2],d=r*r+s*s+c*c;return d>0&&(d=1/Math.sqrt(d)),e[0]=t[0]*d,e[1]=t[1]*d,e[2]=t[2]*d,e},qn.dot=_p,qn.cross=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=r[0],g=r[1],y=r[2];return e[0]=c*y-d*g,e[1]=d*f-s*y,e[2]=s*g-c*f,e},qn.lerp=function(e,t,r,s){var c=t[0],d=t[1],f=t[2];return e[0]=c+s*(r[0]-c),e[1]=d+s*(r[1]-d),e[2]=f+s*(r[2]-f),e},qn.hermite=function(e,t,r,s,c,d){var f=d*d,g=f*(2*d-3)+1,y=f*(d-2)+d,b=f*(d-1),w=f*(3-2*d);return e[0]=t[0]*g+r[0]*y+s[0]*b+c[0]*w,e[1]=t[1]*g+r[1]*y+s[1]*b+c[1]*w,e[2]=t[2]*g+r[2]*y+s[2]*b+c[2]*w,e},qn.bezier=function(e,t,r,s,c,d){var f=1-d,g=f*f,y=d*d,b=g*f,w=3*d*g,P=3*y*f,O=y*d;return e[0]=t[0]*b+r[0]*w+s[0]*P+c[0]*O,e[1]=t[1]*b+r[1]*w+s[1]*P+c[1]*O,e[2]=t[2]*b+r[2]*w+s[2]*P+c[2]*O,e},qn.random=function(e,t){t=t||1;var r=2*Nu.RANDOM()*Math.PI,s=2*Nu.RANDOM()-1,c=Math.sqrt(1-s*s)*t;return e[0]=Math.cos(r)*c,e[1]=Math.sin(r)*c,e[2]=s*t,e},qn.transformMat4=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=r[3]*s+r[7]*c+r[11]*d+r[15];return e[0]=(r[0]*s+r[4]*c+r[8]*d+r[12])/(f=f||1),e[1]=(r[1]*s+r[5]*c+r[9]*d+r[13])/f,e[2]=(r[2]*s+r[6]*c+r[10]*d+r[14])/f,e},qn.transformMat3=function(e,t,r){var s=t[0],c=t[1],d=t[2];return e[0]=s*r[0]+c*r[3]+d*r[6],e[1]=s*r[1]+c*r[4]+d*r[7],e[2]=s*r[2]+c*r[5]+d*r[8],e},qn.transformQuat=function(e,t,r){var s=r[0],c=r[1],d=r[2],f=t[0],g=t[1],y=t[2],b=c*y-d*g,w=d*f-s*y,P=s*g-c*f,O=c*P-d*w,I=d*b-s*P,A=s*w-c*b,l=2*r[3];return w*=l,P*=l,I*=2,A*=2,e[0]=f+(b*=l)+(O*=2),e[1]=g+w+I,e[2]=y+P+A,e},qn.rotateX=function(e,t,r,s){var c=[],d=[];return c[0]=t[0]-r[0],c[1]=t[1]-r[1],c[2]=t[2]-r[2],d[0]=c[0],d[1]=c[1]*Math.cos(s)-c[2]*Math.sin(s),d[2]=c[1]*Math.sin(s)+c[2]*Math.cos(s),e[0]=d[0]+r[0],e[1]=d[1]+r[1],e[2]=d[2]+r[2],e},qn.rotateY=function(e,t,r,s){var c=[],d=[];return c[0]=t[0]-r[0],c[1]=t[1]-r[1],c[2]=t[2]-r[2],d[0]=c[2]*Math.sin(s)+c[0]*Math.cos(s),d[1]=c[1],d[2]=c[2]*Math.cos(s)-c[0]*Math.sin(s),e[0]=d[0]+r[0],e[1]=d[1]+r[1],e[2]=d[2]+r[2],e},qn.rotateZ=function(e,t,r,s){var c=[],d=[];return c[0]=t[0]-r[0],c[1]=t[1]-r[1],c[2]=t[2]-r[2],d[0]=c[0]*Math.cos(s)-c[1]*Math.sin(s),d[1]=c[0]*Math.sin(s)+c[1]*Math.cos(s),d[2]=c[2],e[0]=d[0]+r[0],e[1]=d[1]+r[1],e[2]=d[2]+r[2],e},qn.angle=function(e,t){var r=e[0],s=e[1],c=e[2],d=t[0],f=t[1],g=t[2],y=Math.sqrt(r*r+s*s+c*c)*Math.sqrt(d*d+f*f+g*g),b=y&&_p(e,t)/y;return Math.acos(Math.min(Math.max(b,-1),1))},qn.zero=function(e){return e[0]=0,e[1]=0,e[2]=0,e},qn.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},qn.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},qn.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=t[0],f=t[1],g=t[2];return Math.abs(r-d)<=Nu.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(s-f)<=Nu.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(c-g)<=Nu.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))},qn.forEach=qn.sqrLen=qn.len=qn.sqrDist=qn.dist=qn.div=qn.mul=qn.sub=void 0;var Nu=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==rv(e)&&"function"!=typeof e)return{default:e};var r=mp(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(ci);function mp(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(mp=function(s){return s?r:t})(e)}function y_(){var e=new Nu.ARRAY_TYPE(3);return Nu.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Kh(e){return Math.hypot(e[0],e[1],e[2])}function D0(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function k0(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function bP(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function Cw(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])}function R0(e,t){var r=t[0]-e[0],s=t[1]-e[1],c=t[2]-e[2];return r*r+s*s+c*c}function Mw(e){var t=e[0],r=e[1],s=e[2];return t*t+r*r+s*s}function _p(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}qn.sub=D0,qn.mul=k0,qn.div=bP,qn.dist=Cw,qn.sqrDist=R0,qn.len=Kh,qn.sqrLen=Mw;var El,L0=(El=y_(),function(e,t,r,s,c,d){var f,g;for(t||(t=3),r||(r=0),g=s?Math.min(s*t+r,e.length):e.length,f=r;f<g;f+=t)El[0]=e[f],El[1]=e[f+1],El[2]=e[f+2],c(El,El,d),e[f]=El[0],e[f+1]=El[1],e[f+2]=El[2];return e});qn.forEach=L0;var gr={};function v_(e){return(v_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(gr,"__esModule",{value:!0}),gr.create=Fs,gr.clone=function(e){var t=new il.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},gr.fromValues=function(e,t,r,s){var c=new il.ARRAY_TYPE(4);return c[0]=e,c[1]=t,c[2]=r,c[3]=s,c},gr.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},gr.set=function(e,t,r,s,c){return e[0]=t,e[1]=r,e[2]=s,e[3]=c,e},gr.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},gr.subtract=Js,gr.multiply=ov,gr.divide=N0,gr.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},gr.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},gr.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},gr.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},gr.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},gr.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},gr.scaleAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e[2]=t[2]+r[2]*s,e[3]=t[3]+r[3]*s,e},gr.distance=xP,gr.squaredDistance=Yh,gr.length=b_,gr.squaredLength=Pw,gr.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},gr.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},gr.normalize=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=r*r+s*s+c*c+d*d;return f>0&&(f=1/Math.sqrt(f)),e[0]=r*f,e[1]=s*f,e[2]=c*f,e[3]=d*f,e},gr.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},gr.cross=function(e,t,r,s){var c=r[0]*s[1]-r[1]*s[0],d=r[0]*s[2]-r[2]*s[0],f=r[0]*s[3]-r[3]*s[0],g=r[1]*s[2]-r[2]*s[1],y=r[1]*s[3]-r[3]*s[1],b=r[2]*s[3]-r[3]*s[2],w=t[0],P=t[1],O=t[2],I=t[3];return e[0]=P*b-O*y+I*g,e[1]=-w*b+O*f-I*d,e[2]=w*y-P*f+I*c,e[3]=-w*g+P*d-O*c,e},gr.lerp=function(e,t,r,s){var c=t[0],d=t[1],f=t[2],g=t[3];return e[0]=c+s*(r[0]-c),e[1]=d+s*(r[1]-d),e[2]=f+s*(r[2]-f),e[3]=g+s*(r[3]-g),e},gr.random=function(e,t){var r,s,c,d,f,g;t=t||1;do{f=(r=2*il.RANDOM()-1)*r+(s=2*il.RANDOM()-1)*s}while(f>=1);do{g=(c=2*il.RANDOM()-1)*c+(d=2*il.RANDOM()-1)*d}while(g>=1);var y=Math.sqrt((1-f)/g);return e[0]=t*r,e[1]=t*s,e[2]=t*c*y,e[3]=t*d*y,e},gr.transformMat4=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3];return e[0]=r[0]*s+r[4]*c+r[8]*d+r[12]*f,e[1]=r[1]*s+r[5]*c+r[9]*d+r[13]*f,e[2]=r[2]*s+r[6]*c+r[10]*d+r[14]*f,e[3]=r[3]*s+r[7]*c+r[11]*d+r[15]*f,e},gr.transformQuat=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=r[0],g=r[1],y=r[2],b=r[3],w=b*s+g*d-y*c,P=b*c+y*s-f*d,O=b*d+f*c-g*s,I=-f*s-g*c-y*d;return e[0]=w*b+I*-f+P*-y-O*-g,e[1]=P*b+I*-g+O*-f-w*-y,e[2]=O*b+I*-y+w*-g-P*-f,e[3]=t[3],e},gr.zero=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},gr.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},gr.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},gr.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=e[3],f=t[0],g=t[1],y=t[2],b=t[3];return Math.abs(r-f)<=il.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(s-g)<=il.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-y)<=il.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(d-b)<=il.EPSILON*Math.max(1,Math.abs(d),Math.abs(b))},gr.forEach=gr.sqrLen=gr.len=gr.sqrDist=gr.dist=gr.div=gr.mul=gr.sub=void 0;var il=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==v_(e)&&"function"!=typeof e)return{default:e};var r=iv(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(ci);function iv(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(iv=function(s){return s?r:t})(e)}function Fs(){var e=new il.ARRAY_TYPE(4);return il.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Js(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function ov(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function N0(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function xP(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2],t[3]-e[3])}function Yh(e,t){var r=t[0]-e[0],s=t[1]-e[1],c=t[2]-e[2],d=t[3]-e[3];return r*r+s*s+c*c+d*d}function b_(e){return Math.hypot(e[0],e[1],e[2],e[3])}function Pw(e){var t=e[0],r=e[1],s=e[2],c=e[3];return t*t+r*r+s*s+c*c}gr.sub=Js,gr.mul=ov,gr.div=N0,gr.dist=xP,gr.sqrDist=Yh,gr.len=b_,gr.sqrLen=Pw;var AS=function(){var e=Fs();return function(t,r,s,c,d,f){var g,y;for(r||(r=4),s||(s=0),y=c?Math.min(c*r+s,t.length):t.length,g=s;g<y;g+=r)e[0]=t[g],e[1]=t[g+1],e[2]=t[g+2],e[3]=t[g+3],d(e,e,f),t[g]=e[0],t[g+1]=e[1],t[g+2]=e[2],t[g+3]=e[3];return t}}();function wP(e){return(wP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}gr.forEach=AS,Object.defineProperty(jn,"__esModule",{value:!0}),jn.create=w_,jn.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},jn.setAxisAngle=B0,jn.getAxisAngle=function(e,t){var r=2*Math.acos(t[3]),s=Math.sin(r/2);return s>x_.EPSILON?(e[0]=t[0]/s,e[1]=t[1]/s,e[2]=t[2]/s):(e[0]=1,e[1]=0,e[2]=0),r},jn.getAngle=function(e,t){var r=CP(e,t);return Math.acos(2*r*r-1)},jn.multiply=C_,jn.rotateX=function(e,t,r){r*=.5;var s=t[0],c=t[1],d=t[2],f=t[3],g=Math.sin(r),y=Math.cos(r);return e[0]=s*y+f*g,e[1]=c*y+d*g,e[2]=d*y-c*g,e[3]=f*y-s*g,e},jn.rotateY=function(e,t,r){r*=.5;var s=t[0],c=t[1],d=t[2],f=t[3],g=Math.sin(r),y=Math.cos(r);return e[0]=s*y-d*g,e[1]=c*y+f*g,e[2]=d*y+s*g,e[3]=f*y-c*g,e},jn.rotateZ=function(e,t,r){r*=.5;var s=t[0],c=t[1],d=t[2],f=t[3],g=Math.sin(r),y=Math.cos(r);return e[0]=s*y+c*g,e[1]=c*y-s*g,e[2]=d*y+f*g,e[3]=f*y-d*g,e},jn.calculateW=function(e,t){var r=t[0],s=t[1],c=t[2];return e[0]=r,e[1]=s,e[2]=c,e[3]=Math.sqrt(Math.abs(1-r*r-s*s-c*c)),e},jn.exp=Fu,jn.ln=M_,jn.pow=function(e,t,r){return M_(e,t),V0(e,e,r),Fu(e,e),e},jn.slerp=Xh,jn.random=function(e){var t=x_.RANDOM(),r=x_.RANDOM(),s=x_.RANDOM(),c=Math.sqrt(1-t),d=Math.sqrt(t);return e[0]=c*Math.sin(2*Math.PI*r),e[1]=c*Math.cos(2*Math.PI*r),e[2]=d*Math.sin(2*Math.PI*s),e[3]=d*Math.cos(2*Math.PI*s),e},jn.invert=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=r*r+s*s+c*c+d*d,g=f?1/f:0;return e[0]=-r*g,e[1]=-s*g,e[2]=-c*g,e[3]=d*g,e},jn.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},jn.fromMat3=U0,jn.fromEuler=function(e,t,r,s){var c=.5*Math.PI/180;t*=c,r*=c,s*=c;var d=Math.sin(t),f=Math.cos(t),g=Math.sin(r),y=Math.cos(r),b=Math.sin(s),w=Math.cos(s);return e[0]=d*y*w-f*g*b,e[1]=f*g*w+d*y*b,e[2]=f*y*b-d*g*w,e[3]=f*y*w+d*g*b,e},jn.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},jn.setAxes=jn.sqlerp=jn.rotationTo=jn.equals=jn.exactEquals=jn.normalize=jn.sqrLen=jn.squaredLength=jn.len=jn.length=jn.lerp=jn.dot=jn.scale=jn.mul=jn.add=jn.set=jn.copy=jn.fromValues=jn.clone=void 0;var x_=z0(ci),F0=z0(ui),Bc=z0(qn),Sa=z0(gr);function Ew(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(Ew=function(s){return s?r:t})(e)}function z0(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==wP(e)&&"function"!=typeof e)return{default:e};var r=Ew(t);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}function w_(){var e=new x_.ARRAY_TYPE(4);return x_.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function B0(e,t,r){r*=.5;var s=Math.sin(r);return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=Math.cos(r),e}function C_(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=r[0],y=r[1],b=r[2],w=r[3];return e[0]=s*w+f*g+c*b-d*y,e[1]=c*w+f*y+d*g-s*b,e[2]=d*w+f*b+s*y-c*g,e[3]=f*w-s*g-c*y-d*b,e}function Fu(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=Math.sqrt(r*r+s*s+c*c),g=Math.exp(d),y=f>0?g*Math.sin(f)/f:0;return e[0]=r*y,e[1]=s*y,e[2]=c*y,e[3]=g*Math.cos(f),e}function M_(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=Math.sqrt(r*r+s*s+c*c),g=f>0?Math.atan2(f,d)/f:0;return e[0]=r*g,e[1]=s*g,e[2]=c*g,e[3]=.5*Math.log(r*r+s*s+c*c+d*d),e}function Xh(e,t,r,s){var c,d,f,g,y,b=t[0],w=t[1],P=t[2],O=t[3],I=r[0],A=r[1],l=r[2],u=r[3];return(d=b*I+w*A+P*l+O*u)<0&&(d=-d,I=-I,A=-A,l=-l,u=-u),1-d>x_.EPSILON?(c=Math.acos(d),f=Math.sin(c),g=Math.sin((1-s)*c)/f,y=Math.sin(s*c)/f):(g=1-s,y=s),e[0]=g*b+y*I,e[1]=g*w+y*A,e[2]=g*P+y*l,e[3]=g*O+y*u,e}function U0(e,t){var r,s=t[0]+t[4]+t[8];if(s>0)r=Math.sqrt(s+1),e[3]=.5*r,e[0]=(t[5]-t[7])*(r=.5/r),e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var c=0;t[4]>t[0]&&(c=1),t[8]>t[3*c+c]&&(c=2);var d=(c+1)%3,f=(c+2)%3;r=Math.sqrt(t[3*c+c]-t[3*d+d]-t[3*f+f]+1),e[c]=.5*r,e[3]=(t[3*d+f]-t[3*f+d])*(r=.5/r),e[d]=(t[3*d+c]+t[3*c+d])*r,e[f]=(t[3*f+c]+t[3*c+f])*r}return e}jn.clone=Sa.clone,jn.fromValues=Sa.fromValues,jn.copy=Sa.copy,jn.set=Sa.set,jn.add=Sa.add,jn.mul=C_;var V0=Sa.scale;jn.scale=V0;var CP=Sa.dot;jn.dot=CP,jn.lerp=Sa.lerp;var j0=Sa.length;jn.length=j0,jn.len=j0;var xT=Sa.squaredLength;jn.squaredLength=xT,jn.sqrLen=xT;var sv=Sa.normalize;jn.normalize=sv,jn.exactEquals=Sa.exactEquals,jn.equals=Sa.equals;var ta,wT,CT,yp=(ta=Bc.create(),wT=Bc.fromValues(1,0,0),CT=Bc.fromValues(0,1,0),function(e,t,r){var s=Bc.dot(t,r);return s<-.999999?(Bc.cross(ta,wT,t),Bc.len(ta)<1e-6&&Bc.cross(ta,CT,t),Bc.normalize(ta,ta),B0(e,ta,Math.PI),e):s>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(Bc.cross(ta,t,r),e[0]=ta[0],e[1]=ta[1],e[2]=ta[2],e[3]=1+s,sv(e,e))});jn.rotationTo=yp;var $0,P_,MP=($0=w_(),P_=w_(),function(e,t,r,s,c,d){return Xh($0,t,c,d),Xh(P_,r,s,d),Xh(e,$0,P_,2*d*(1-d)),e});jn.sqlerp=MP;var ol,Ow=(ol=F0.create(),function(e,t,r,s){return ol[0]=r[0],ol[3]=r[1],ol[6]=r[2],ol[1]=s[0],ol[4]=s[1],ol[7]=s[2],ol[2]=-t[0],ol[5]=-t[1],ol[8]=-t[2],sv(e,U0(e,ol))});jn.setAxes=Ow;var Dn={};function G0(e){return(G0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.create=function(){var e=new ms.ARRAY_TYPE(8);return ms.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},Dn.clone=function(e){var t=new ms.ARRAY_TYPE(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t},Dn.fromValues=function(e,t,r,s,c,d,f,g){var y=new ms.ARRAY_TYPE(8);return y[0]=e,y[1]=t,y[2]=r,y[3]=s,y[4]=c,y[5]=d,y[6]=f,y[7]=g,y},Dn.fromRotationTranslationValues=function(e,t,r,s,c,d,f){var g=new ms.ARRAY_TYPE(8);g[0]=e,g[1]=t,g[2]=r,g[3]=s;var y=.5*c,b=.5*d,w=.5*f;return g[4]=y*s+b*r-w*t,g[5]=b*s+w*e-y*r,g[6]=w*s+y*t-b*e,g[7]=-y*e-b*t-w*r,g},Dn.fromRotationTranslation=Z0,Dn.fromTranslation=function(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e},Dn.fromRotation=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},Dn.fromMat4=function(e,t){var r=Uc.create();vp.getRotation(r,t);var s=new ms.ARRAY_TYPE(3);return vp.getTranslation(s,t),Z0(e,r,s),e},Dn.copy=Sg,Dn.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},Dn.set=function(e,t,r,s,c,d,f,g,y){return e[0]=t,e[1]=r,e[2]=s,e[3]=c,e[4]=d,e[5]=f,e[6]=g,e[7]=y,e},Dn.getDual=function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},Dn.setDual=function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},Dn.getTranslation=function(e,t){var r=t[4],s=t[5],c=t[6],d=t[7],f=-t[0],g=-t[1],y=-t[2],b=t[3];return e[0]=2*(r*b+d*f+s*y-c*g),e[1]=2*(s*b+d*g+c*f-r*y),e[2]=2*(c*b+d*y+r*g-s*f),e},Dn.translate=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=.5*r[0],y=.5*r[1],b=.5*r[2],w=t[4],P=t[5],O=t[6],I=t[7];return e[0]=s,e[1]=c,e[2]=d,e[3]=f,e[4]=f*g+c*b-d*y+w,e[5]=f*y+d*g-s*b+P,e[6]=f*b+s*y-c*g+O,e[7]=-s*g-c*y-d*b+I,e},Dn.rotateX=function(e,t,r){var s=-t[0],c=-t[1],d=-t[2],f=t[3],g=t[4],y=t[5],b=t[6],w=t[7],P=g*f+w*s+y*d-b*c,O=y*f+w*c+b*s-g*d,I=b*f+w*d+g*c-y*s,A=w*f-g*s-y*c-b*d;return Uc.rotateX(e,t,r),e[4]=P*(f=e[3])+A*(s=e[0])+O*(d=e[2])-I*(c=e[1]),e[5]=O*f+A*c+I*s-P*d,e[6]=I*f+A*d+P*c-O*s,e[7]=A*f-P*s-O*c-I*d,e},Dn.rotateY=function(e,t,r){var s=-t[0],c=-t[1],d=-t[2],f=t[3],g=t[4],y=t[5],b=t[6],w=t[7],P=g*f+w*s+y*d-b*c,O=y*f+w*c+b*s-g*d,I=b*f+w*d+g*c-y*s,A=w*f-g*s-y*c-b*d;return Uc.rotateY(e,t,r),e[4]=P*(f=e[3])+A*(s=e[0])+O*(d=e[2])-I*(c=e[1]),e[5]=O*f+A*c+I*s-P*d,e[6]=I*f+A*d+P*c-O*s,e[7]=A*f-P*s-O*c-I*d,e},Dn.rotateZ=function(e,t,r){var s=-t[0],c=-t[1],d=-t[2],f=t[3],g=t[4],y=t[5],b=t[6],w=t[7],P=g*f+w*s+y*d-b*c,O=y*f+w*c+b*s-g*d,I=b*f+w*d+g*c-y*s,A=w*f-g*s-y*c-b*d;return Uc.rotateZ(e,t,r),e[4]=P*(f=e[3])+A*(s=e[0])+O*(d=e[2])-I*(c=e[1]),e[5]=O*f+A*c+I*s-P*d,e[6]=I*f+A*d+P*c-O*s,e[7]=A*f-P*s-O*c-I*d,e},Dn.rotateByQuatAppend=function(e,t,r){var s=r[0],c=r[1],d=r[2],f=r[3],g=t[0],y=t[1],b=t[2],w=t[3];return e[0]=g*f+w*s+y*d-b*c,e[1]=y*f+w*c+b*s-g*d,e[2]=b*f+w*d+g*c-y*s,e[3]=w*f-g*s-y*c-b*d,e[4]=(g=t[4])*f+(w=t[7])*s+(y=t[5])*d-(b=t[6])*c,e[5]=y*f+w*c+b*s-g*d,e[6]=b*f+w*d+g*c-y*s,e[7]=w*f-g*s-y*c-b*d,e},Dn.rotateByQuatPrepend=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=r[0],y=r[1],b=r[2],w=r[3];return e[0]=s*w+f*g+c*b-d*y,e[1]=c*w+f*y+d*g-s*b,e[2]=d*w+f*b+s*y-c*g,e[3]=f*w-s*g-c*y-d*b,e[4]=s*(w=r[7])+f*(g=r[4])+c*(b=r[6])-d*(y=r[5]),e[5]=c*w+f*y+d*g-s*b,e[6]=d*w+f*b+s*y-c*g,e[7]=f*w-s*g-c*y-d*b,e},Dn.rotateAroundAxis=function(e,t,r,s){if(Math.abs(s)<ms.EPSILON)return Sg(e,t);var c=Math.hypot(r[0],r[1],r[2]);s*=.5;var d=Math.sin(s),f=d*r[0]/c,g=d*r[1]/c,y=d*r[2]/c,b=Math.cos(s),w=t[0],P=t[1],O=t[2],I=t[3];e[0]=w*b+I*f+P*y-O*g,e[1]=P*b+I*g+O*f-w*y,e[2]=O*b+I*y+w*g-P*f,e[3]=I*b-w*f-P*g-O*y;var A=t[4],l=t[5],u=t[6],p=t[7];return e[4]=A*b+p*f+l*y-u*g,e[5]=l*b+p*g+u*f-A*y,e[6]=u*b+p*y+A*g-l*f,e[7]=p*b-A*f-l*g-u*y,e},Dn.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e},Dn.multiply=W0,Dn.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e},Dn.lerp=function(e,t,r,s){var c=1-s;return K0(t,r)<0&&(s=-s),e[0]=t[0]*c+r[0]*s,e[1]=t[1]*c+r[1]*s,e[2]=t[2]*c+r[2]*s,e[3]=t[3]*c+r[3]*s,e[4]=t[4]*c+r[4]*s,e[5]=t[5]*c+r[5]*s,e[6]=t[6]*c+r[6]*s,e[7]=t[7]*c+r[7]*s,e},Dn.invert=function(e,t){var r=Ag(t);return e[0]=-t[0]/r,e[1]=-t[1]/r,e[2]=-t[2]/r,e[3]=t[3]/r,e[4]=-t[4]/r,e[5]=-t[5]/r,e[6]=-t[6]/r,e[7]=t[7]/r,e},Dn.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},Dn.normalize=function(e,t){var r=Ag(t);if(r>0){r=Math.sqrt(r);var s=t[0]/r,c=t[1]/r,d=t[2]/r,f=t[3]/r,g=t[4],y=t[5],b=t[6],w=t[7],P=s*g+c*y+d*b+f*w;e[0]=s,e[1]=c,e[2]=d,e[3]=f,e[4]=(g-s*P)/r,e[5]=(y-c*P)/r,e[6]=(b-d*P)/r,e[7]=(w-f*P)/r}return e},Dn.str=function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},Dn.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},Dn.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=e[3],f=e[4],g=e[5],y=e[6],b=e[7],w=t[0],P=t[1],O=t[2],I=t[3],A=t[4],l=t[5],u=t[6],p=t[7];return Math.abs(r-w)<=ms.EPSILON*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(s-P)<=ms.EPSILON*Math.max(1,Math.abs(s),Math.abs(P))&&Math.abs(c-O)<=ms.EPSILON*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(d-I)<=ms.EPSILON*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(f-A)<=ms.EPSILON*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(g-l)<=ms.EPSILON*Math.max(1,Math.abs(g),Math.abs(l))&&Math.abs(y-u)<=ms.EPSILON*Math.max(1,Math.abs(y),Math.abs(u))&&Math.abs(b-p)<=ms.EPSILON*Math.max(1,Math.abs(b),Math.abs(p))},Dn.sqrLen=Dn.squaredLength=Dn.len=Dn.length=Dn.dot=Dn.mul=Dn.setReal=Dn.getReal=void 0;var ms=q0(ci),Uc=q0(jn),vp=q0(Bn);function H0(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(H0=function(s){return s?r:t})(e)}function q0(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==G0(e)&&"function"!=typeof e)return{default:e};var r=H0(t);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}function Z0(e,t,r){var s=.5*r[0],c=.5*r[1],d=.5*r[2],f=t[0],g=t[1],y=t[2],b=t[3];return e[0]=f,e[1]=g,e[2]=y,e[3]=b,e[4]=s*b+c*y-d*g,e[5]=c*b+d*f-s*y,e[6]=d*b+s*g-c*f,e[7]=-s*f-c*g-d*y,e}function Sg(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function W0(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=r[4],y=r[5],b=r[6],w=r[7],P=t[4],O=t[5],I=t[6],A=t[7],l=r[0],u=r[1],p=r[2],m=r[3];return e[0]=s*m+f*l+c*p-d*u,e[1]=c*m+f*u+d*l-s*p,e[2]=d*m+f*p+s*u-c*l,e[3]=f*m-s*l-c*u-d*p,e[4]=s*w+f*g+c*b-d*y+P*m+A*l+O*p-I*u,e[5]=c*w+f*y+d*g-s*b+O*m+A*u+I*l-P*p,e[6]=d*w+f*b+s*y-c*g+I*m+A*p+P*u-O*l,e[7]=f*w-s*g-c*y-d*b+A*m-P*l-O*u-I*p,e}Dn.getReal=Uc.copy,Dn.setReal=Uc.copy,Dn.mul=W0;var K0=Uc.dot;Dn.dot=K0;var Y0=Uc.length;Dn.length=Y0,Dn.len=Y0;var Ag=Uc.squaredLength;Dn.squaredLength=Ag,Dn.sqrLen=Ag;var Zn={};function Tw(e){return(Tw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.create=Qh,Zn.clone=function(e){var t=new E_.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},Zn.fromValues=function(e,t){var r=new E_.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},Zn.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},Zn.set=function(e,t,r){return e[0]=t,e[1]=r,e},Zn.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},Zn.subtract=av,Zn.multiply=X0,Zn.divide=lv,Zn.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},Zn.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},Zn.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},Zn.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},Zn.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},Zn.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},Zn.scaleAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e},Zn.distance=cv,Zn.squaredDistance=PP,Zn.length=Dg,Zn.squaredLength=Q0,Zn.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},Zn.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},Zn.normalize=function(e,t){var r=t[0],s=t[1],c=r*r+s*s;return c>0&&(c=1/Math.sqrt(c)),e[0]=t[0]*c,e[1]=t[1]*c,e},Zn.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},Zn.cross=function(e,t,r){var s=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=s,e},Zn.lerp=function(e,t,r,s){var c=t[0],d=t[1];return e[0]=c+s*(r[0]-c),e[1]=d+s*(r[1]-d),e},Zn.random=function(e,t){t=t||1;var r=2*E_.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},Zn.transformMat2=function(e,t,r){var s=t[0],c=t[1];return e[0]=r[0]*s+r[2]*c,e[1]=r[1]*s+r[3]*c,e},Zn.transformMat2d=function(e,t,r){var s=t[0],c=t[1];return e[0]=r[0]*s+r[2]*c+r[4],e[1]=r[1]*s+r[3]*c+r[5],e},Zn.transformMat3=function(e,t,r){var s=t[0],c=t[1];return e[0]=r[0]*s+r[3]*c+r[6],e[1]=r[1]*s+r[4]*c+r[7],e},Zn.transformMat4=function(e,t,r){var s=t[0],c=t[1];return e[0]=r[0]*s+r[4]*c+r[12],e[1]=r[1]*s+r[5]*c+r[13],e},Zn.rotate=function(e,t,r,s){var c=t[0]-r[0],d=t[1]-r[1],f=Math.sin(s),g=Math.cos(s);return e[0]=c*g-d*f+r[0],e[1]=c*f+d*g+r[1],e},Zn.angle=function(e,t){var r=e[0],s=e[1],c=t[0],d=t[1],f=Math.sqrt(r*r+s*s)*Math.sqrt(c*c+d*d);return Math.acos(Math.min(Math.max(f&&(r*c+s*d)/f,-1),1))},Zn.zero=function(e){return e[0]=0,e[1]=0,e},Zn.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},Zn.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Zn.equals=function(e,t){var r=e[0],s=e[1],c=t[0],d=t[1];return Math.abs(r-c)<=E_.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(s-d)<=E_.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))},Zn.forEach=Zn.sqrLen=Zn.sqrDist=Zn.dist=Zn.div=Zn.mul=Zn.sub=Zn.len=void 0;var E_=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==Tw(e)&&"function"!=typeof e)return{default:e};var r=bp(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(ci);function bp(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(bp=function(s){return s?r:t})(e)}function Qh(){var e=new E_.ARRAY_TYPE(2);return E_.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e}function av(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function X0(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function lv(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function cv(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1])}function PP(e,t){var r=t[0]-e[0],s=t[1]-e[1];return r*r+s*s}function Dg(e){return Math.hypot(e[0],e[1])}function Q0(e){var t=e[0],r=e[1];return t*t+r*r}Zn.len=Dg,Zn.sub=av,Zn.mul=X0,Zn.div=lv,Zn.dist=cv,Zn.sqrDist=PP,Zn.sqrLen=Q0;var kg=function(){var e=Qh();return function(t,r,s,c,d,f){var g,y;for(r||(r=2),s||(s=0),y=c?Math.min(c*r+s,t.length):t.length,g=s;g<y;g+=r)e[0]=t[g],e[1]=t[g+1],d(e,e,f),t[g]=e[0],t[g+1]=e[1];return t}}();function O_(e){return(O_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Zn.forEach=kg,Object.defineProperty(zo,"__esModule",{value:!0});var kr=zo.vec4=dt=zo.vec3=zo.vec2=zo.quat2=Bo=zo.quat=bt=zo.mat4=sl=zo.mat3=zo.mat2d=Rg=zo.mat2=zo.glMatrix=void 0,Iw=Vc(ci);zo.glMatrix=Iw;var Sw=Vc(Di),Rg=zo.mat2=Sw,Aw=Vc(fi);zo.mat2d=Aw;var xp=Vc(ui),sl=zo.mat3=xp,Jh=Vc(Bn),bt=zo.mat4=Jh,J0=Vc(jn),Bo=zo.quat=J0,uv=Vc(Dn);zo.quat2=uv;var Ii=Vc(Zn);zo.vec2=Ii;var tf=Vc(qn),dt=zo.vec3=tf,dv=Vc(gr);function EP(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(EP=function(s){return s?r:t})(e)}function Vc(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==O_(e)&&"function"!=typeof e)return{default:e};var r=EP(t);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}kr=zo.vec4=dv;const T_=Dr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:tx}=T_,OP=Dr([{name:"a_pos_3",components:3,type:"Int16"}]);var wp=Dr([{name:"a_pos",type:"Int16",components:2}]),Cp={};!function(r){function s(d,f,g){var y=c(256*d,256*(f=Math.pow(2,g)-f-1),g),b=c(256*(d+1),256*(f+1),g);return y[0]+","+y[1]+","+b[0]+","+b[1]}function c(d,f,g){var y=2*Math.PI*6378137/256/Math.pow(2,g);return[d*y-2*Math.PI*6378137/2,f*y-2*Math.PI*6378137/2]}r.getURL=function(d,f,g,y,b,w){return w=w||{},d+"?"+["bbox="+s(g,y,b),"format="+(w.format||"image/png"),"service="+(w.service||"WMS"),"version="+(w.version||"1.1.1"),"request="+(w.request||"GetMap"),"srs="+(w.srs||"EPSG:3857"),"width="+(w.width||256),"height="+(w.height||256),"layers="+f].join("&")},r.getTileBBox=s,r.getMercCoords=c,Object.defineProperty(r,"__esModule",{value:!0})}(Cp);var ef=Cp;class oc{constructor(t,r,s){this.z=t,this.x=r,this.y=s,this.key=nf(0,t,t,r,s)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r){const s=ef.getTileBBox(this.x,this.y,this.z),c=function(d,f,g){let y,b="";for(let w=d;w>0;w--)y=1<<w-1,b+=(f&y?1:0)+(g&y?2:0);return b}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",c).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class hv{constructor(t,r){this.wrap=t,this.canonical=r,this.key=nf(t,r.z,r.z,r.x,r.y)}}class Ir{constructor(t,r,s,c,d){this.overscaledZ=t,this.wrap=r,this.canonical=new oc(s,+c,+d),this.key=0===r&&t===s?this.canonical.key:nf(r,t,s,c,d)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const r=this.canonical.z-t;return t>this.canonical.z?new Ir(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ir(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r=!0){if(this.overscaledZ===t&&r)return this.key;if(t>this.canonical.z)return nf(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-t;return nf(this.wrap*+r,t,t,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const r=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new Ir(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,s=2*this.canonical.x,c=2*this.canonical.y;return[new Ir(r,this.wrap,r,s,c),new Ir(r,this.wrap,r,s+1,c),new Ir(r,this.wrap,r,s,c+1),new Ir(r,this.wrap,r,s+1,c+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ir(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ir(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new hv(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function nf(e,t,r,s,c){const d=1<<Math.min(r,22);let f=d*(c%d)+s%d;return e&&r<22&&(f+=d*d*((e<0?-2*e-1:2*e)%(1<<2*(22-r)))),16*(32*f+r)+(t-r)}const TP=[e=>{let t=e.canonical.x-1,r=e.wrap;return t<0&&(t=(1<<e.canonical.z)-1,r--),new Ir(e.overscaledZ,r,e.canonical.z,t,e.canonical.y)},e=>{let t=e.canonical.x+1,r=e.wrap;return t===1<<e.canonical.z&&(t=0,r++),new Ir(e.overscaledZ,r,e.canonical.z,t,e.canonical.y)},e=>new Ir(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,(0===e.canonical.y?1<<e.canonical.z:e.canonical.y)-1),e=>new Ir(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y===(1<<e.canonical.z)-1?0:e.canonical.y+1)];De(oc,"CanonicalTileID"),De(Ir,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});class ex{constructor(t,r){this.pos=t,this.dir=r}intersectsPlane(t,r,s){const c=dt.dot(r,this.dir);if(Math.abs(c)<1e-6)return!1;const d=((t[0]-this.pos[0])*r[0]+(t[1]-this.pos[1])*r[1]+(t[2]-this.pos[2])*r[2])/c;return s[0]=this.pos[0]+this.dir[0]*d,s[1]=this.pos[1]+this.dir[1]*d,s[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(t,r,s){if(dt.equals(this.pos,t)||0===r)return s[0]=s[1]=s[2]=0,!1;const[c,d,f]=this.dir,g=this.pos[0]-t[0],y=this.pos[1]-t[1],b=this.pos[2]-t[2],w=c*c+d*d+f*f,P=2*(g*c+y*d+b*f),O=P*P-4*w*(g*g+y*y+b*b-r*r);if(O<0){const I=Math.max(-P/2,0),A=g+c*I,l=y+d*I,u=b+f*I,p=Math.hypot(A,l,u);return s[0]=A*r/p,s[1]=l*r/p,s[2]=u*r/p,!1}{const I=(-P-Math.sqrt(O))/(2*w);if(I<0){const A=Math.hypot(g,y,b);return s[0]=g*r/A,s[1]=y*r/A,s[2]=b*r/A,!1}return s[0]=g+c*I,s[1]=y+d*I,s[2]=b+f*I,!0}}}class nx{constructor(t,r,s,c,d){this.TL=t,this.TR=r,this.BR=s,this.BL=c,this.horizon=d}static fromInvProjectionMatrix(t,r,s){const c=[-1,1,1],d=[1,1,1],f=[1,-1,1],g=[-1,-1,1],y=dt.transformMat4(c,c,t),b=dt.transformMat4(d,d,t),w=dt.transformMat4(f,f,t),P=dt.transformMat4(g,g,t);return new nx(y,b,w,P,r/s)}}function rx(e,t,r){let s=1/0,c=-1/0;const d=[];for(const f of e){dt.sub(d,f,t);const g=dt.dot(d,r);s=Math.min(s,g),c=Math.max(c,g)}return[s,c]}function IP(e,t){let r=!0;for(let s=0;s<e.planes.length;s++){const c=e.planes[s];let d=0;for(let f=0;f<t.length;f++)d+=dt.dot(c,t[f])+c[3]>=0;if(0===d)return 0;d!==t.length&&(r=!1)}return r?2:1}function I_(e,t){for(const r of e.projections){const s=rx(t,e.points[0],r.axis);if(r.projection[1]<s[0]||r.projection[0]>s[1])return 0}return 1}function ix(e,t){let r=0;const s=[0,0,0,0];for(let c=0;c<e.length;c++)s[0]=e[c][0],s[1]=e[c][1],s[2]=e[c][2],s[3]=1,kr.dot(s,t)>=0&&r++;return r}class sc{constructor(t,r){this.points=t||new Array(8).fill([0,0,0]),this.planes=r||new Array(6).fill([0,0,0,0]),this.bounds=_i.fromPoints(this.points),this.projections=[],this.frustumEdges=[dt.sub([],this.points[2],this.points[3]),dt.sub([],this.points[0],this.points[3]),dt.sub([],this.points[4],this.points[0]),dt.sub([],this.points[5],this.points[1]),dt.sub([],this.points[6],this.points[2]),dt.sub([],this.points[7],this.points[3])];for(const s of this.frustumEdges){const c=[0,-s[2],s[1]],d=[s[2],0,-s[0]];this.projections.push({axis:c,projection:rx(this.points,this.points[0],c)}),this.projections.push({axis:d,projection:rx(this.points,this.points[0],d)})}}static fromInvProjectionMatrix(t,r,s,c){const d=Math.pow(2,s),f=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const w=kr.transformMat4([],b,t),P=1/w[3]/r*d;return kr.mul(w,w,[P,P,c?1/w[3]:P,P])}),g=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const w=dt.sub([],f[b[0]],f[b[1]]),P=dt.sub([],f[b[2]],f[b[1]]),O=dt.normalize([],dt.cross([],w,P)),I=-dt.dot(O,f[b[1]]);return O.concat(I)}),y=[];for(let b=0;b<f.length;b++)y.push([f[b][0],f[b][1],f[b][2]]);return new sc(y,g)}intersectsPrecise(t,r,s){for(let c=0;c<r.length;c++)if(!ix(t,r[c]))return 0;for(let c=0;c<this.planes.length;c++)if(!ix(t,this.planes[c]))return 0;for(const c of s)for(const d of this.frustumEdges){const f=dt.cross([],c,d),g=dt.length(f);if(0===g)continue;dt.scale(f,f,1/g);const y=rx(this.points,this.points[0],f),b=rx(t,this.points[0],f);if(y[0]>b[1]||b[0]>y[1])return 0}return 1}}class _i{static fromPoints(t){const r=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];for(const c of t)dt.min(r,r,c),dt.max(s,s,c);return new _i(r,s)}static fromTileIdAndHeight(t,r,s){const c=1<<t.canonical.z,d=t.canonical.x,f=t.canonical.y;return new _i([d/c,f/c,r],[(d+1)/c,(f+1)/c,s])}static applyTransform(t,r){const s=t.getCorners();for(let c=0;c<s.length;++c)dt.transformMat4(s[c],s[c],r);return _i.fromPoints(s)}static projectAabbCorners(t,r){const s=t.getCorners();for(let c=0;c<s.length;++c)dt.transformMat4(s[c],s[c],r);return s}constructor(t,r){this.min=t,this.max=r,this.center=dt.scale([],dt.add([],this.min,this.max),.5)}quadrant(t){const r=[t%2==0,t<2],s=dt.clone(this.min),c=dt.clone(this.max);for(let d=0;d<r.length;d++)s[d]=r[d]?this.min[d]:this.center[d],c[d]=r[d]?this.center[d]:this.max[d];return c[2]=this.max[2],new _i(s,c)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,r=this.max;return[[t[0],t[1],t[2]],[r[0],t[1],t[2]],[r[0],r[1],t[2]],[t[0],r[1],t[2]],[t[0],t[1],r[2]],[r[0],t[1],r[2]],[r[0],r[1],r[2]],[t[0],r[1],r[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?IP(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?IP(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,r){return r||this.intersects(t)?I_(t,this.getCorners()):0}intersectsPreciseFlat(t,r){return r||this.intersectsFlat(t)?I_(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let r=0;r<3;++r)if(this.min[r]>t.max[r]||t.min[r]>this.max[r])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],t.min[r]),this.max[r]=Math.max(this.max[r],t.max[r])}encapsulatePoint(t){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],t[r]),this.max[r]=Math.max(this.max[r],t[r])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}De(_i,"Aabb");const zu=5,Bd=6,ea=Dt/Math.PI/2,fv=16383,Bu=[64,32,16],na=-ea,ma=ea,S_=[new _i([na,na,na],[ma,ma,ma]),new _i([na,na,na],[0,0,ma]),new _i([0,na,na],[ma,0,ma]),new _i([na,0,na],[0,ma,ma]),new _i([0,0,na],[ma,ma,ma])];function ox(e){return e*ea/Ep}function Mp(e,t,r,s=!0){const c=dt.scale([],e._camera.position,e.worldSize),d=[t,r,1,1];kr.transformMat4(d,d,e.pixelMatrixInverse),kr.scale(d,d,1/d[3]);const f=dt.sub([],d,c),g=dt.normalize([],f),y=e.globeMatrix,b=[y[12],y[13],y[14]],w=dt.sub([],b,c),P=dt.length(w),O=dt.normalize([],w),I=e.worldSize/(2*Math.PI),A=dt.dot(O,g),l=Math.asin(I/P);if(l<Math.acos(A)){if(!s)return null;const q=[],Z=[];dt.scale(q,g,P/A),dt.normalize(Z,dt.sub(Z,q,w)),dt.normalize(g,dt.add(g,w,dt.scale(g,Z,Math.tan(l)*P)))}const u=[];new ex(c,g).closestPointOnSphere(b,I,u);const p=dt.normalize([],ur(y,0)),m=dt.normalize([],ur(y,1)),v=dt.normalize([],ur(y,2)),C=dt.dot(p,u),E=dt.dot(m,u),T=dt.dot(v,u),k=ge(Math.asin(-E/I));let N=ge(Math.atan2(C,T));N=e.center.lng+function(q,Z){const X=(Z-q+180)%360-180;return X<-180?X+360:X}(e.center.lng,N);const F=yo(N),$=Ne(Pi(k),0,1);return new Xn(F,$)}class sf{constructor(t,r,s){this.a=dt.sub([],t,s),this.b=dt.sub([],r,s),this.center=s;const c=dt.normalize([],this.a),d=dt.normalize([],this.b);this.angle=Math.acos(dt.dot(c,d))}}function Dw(e,t){if(0===e.angle)return null;let r;return r=0===e.a[t]?1/e.angle*.5*Math.PI:1/e.angle*Math.atan(e.b[t]/e.a[t]/Math.sin(e.angle)-1/Math.tan(e.angle)),r<0||r>1?null:function(s,c,d,f){const g=Math.sin(d);return s*(Math.sin((1-f)*d)/g)+c*(Math.sin(f*d)/g)}(e.a[t],e.b[t],e.angle,Ne(r,0,1))+e.center[t]}function Mi(e){if(e.z<=1)return S_[e.z+2*e.y+e.x];const t=lx(pv(e));return _i.fromPoints(t)}function Ud(e,t,r){return dt.scale(e,e,1-r),dt.scaleAndAdd(e,e,t,r)}function SP(e,t){const r=Po(t.zoom);if(0===r)return Mi(e);const s=pv(e),c=lx(s),d=yo(s.getWest())*t.worldSize,f=yo(s.getEast())*t.worldSize,g=Pi(s.getNorth())*t.worldSize,y=Pi(s.getSouth())*t.worldSize,b=[d,g,0],w=[f,g,0],P=[d,y,0],O=[f,y,0],I=bt.invert([],t.globeMatrix);return dt.transformMat4(b,b,I),dt.transformMat4(w,w,I),dt.transformMat4(P,P,I),dt.transformMat4(O,O,I),c[0]=Ud(c[0],P,r),c[1]=Ud(c[1],O,r),c[2]=Ud(c[2],w,r),c[3]=Ud(c[3],b,r),_i.fromPoints(c)}function sx(e,t,r){for(const s of e)dt.transformMat4(s,s,t),dt.scale(s,s,r)}function ax(e,t,r,s){const c=t/e.worldSize,d=e.globeMatrix;if(r.z<=1){const F=Mi(r).getCorners();return sx(F,d,c),_i.fromPoints(F)}const f=pv(r,s),g=lx(f);sx(g,d,c);const y=Number.MAX_VALUE,b=[-y,-y,-y],w=[y,y,y];if(f.contains(e.center)){for(const q of g)dt.min(w,w,q),dt.max(b,b,q);b[2]=0;const F=e.point,$=[F.x*c,F.y*c,0];return dt.min(w,w,$),dt.max(b,b,$),new _i(w,b)}const P=[d[12]*c,d[13]*c,d[14]*c],O=f.getCenter(),I=Ne(e.center.lat,-yi,yi),A=Ne(O.lat,-yi,yi),l=yo(e.center.lng),u=Pi(I);let p=l-yo(O.lng);const m=u-Pi(A);p>.5?p-=1:p<-.5&&(p+=1);let v=0;if(Math.abs(p)>Math.abs(m))v=p>=0?1:3;else{v=m>=0?0:2;const F=[d[4]*c,d[5]*c,d[6]*c],$=-Math.sin(Ct(m>=0?f.getSouth():f.getNorth()))*ea;dt.scaleAndAdd(P,P,F,$)}const C=g[v],E=g[(v+1)%4],T=new sf(C,E,P),k=[Dw(T,0)||C[0],Dw(T,1)||C[1],Dw(T,2)||C[2]],N=Po(e.zoom);if(N>0){const F=function({x:q,y:Z,z:X},K,J,st,ot){const rt=1/(1<<X);let ct=q*rt,yt=ct+rt,Ot=Z*rt,Tt=Ot+rt,zt=0;const Nt=(ct+yt)/2-st;return Nt>.5?zt=-1:Nt<-.5&&(zt=1),ct=((ct+zt)*K-(st*=K))*J+st,yt=((yt+zt)*K-st)*J+st,Ot=(Ot*K-(ot*=K))*J+ot,Tt=(Tt*K-ot)*J+ot,[[ct,Tt,0],[yt,Tt,0],[yt,Ot,0],[ct,Ot,0]]}(r,t,e._pixelsPerMercatorPixel,l,u);for(let q=0;q<g.length;q++)Ud(g[q],F[q],N);const $=dt.add([],F[v],F[(v+1)%4]);dt.scale($,$,.5),Ud(k,$,N)}for(const F of g)dt.min(w,w,F),dt.max(b,b,F);return w[2]=Math.min(C[2],E[2]),dt.min(w,w,k),dt.max(b,b,k),new _i(w,b)}function pv({x:e,y:t,z:r},s=!1){const c=1/(1<<r),d=new kn(Da(e*c),t===(1<<r)-1&&s?-90:Ji((t+1)*c)),f=new kn(Da((e+1)*c),0===t&&s?90:Ji(t*c));return new Xi(d,f)}function lx(e){const t=Ct(e.getNorth()),r=Ct(e.getSouth()),s=Math.cos(t),c=Math.cos(r),d=Math.sin(t),f=Math.sin(r),g=e.getWest(),y=e.getEast();return[A_(c,f,g),A_(c,f,y),A_(s,d,y),A_(s,d,g)]}function A_(e,t,r,s=ea){return r=Ct(r),[e*Math.sin(r)*s,-t*s,e*Math.cos(r)*s]}function ra(e,t,r){return A_(Math.cos(Ct(e)),Math.sin(Ct(e)),t,r)}function af(e,t,r,s){const c=1<<r.z,d=(e/Dt+r.x)/c;return ra(Ji((t/Dt+r.y)/c),Da(d),s)}function al({min:e,max:t}){return fv/Math.max(t[0]-e[0],t[1]-e[1],t[2]-e[2])}const kw=new Float64Array(16);function lf(e){const t=al(e),r=bt.fromScaling(kw,[t,t,t]);return bt.translate(r,r,dt.negate([],e.min))}function D_(e){const t=bt.fromTranslation(kw,e.min),r=1/al(e);return bt.scale(t,t,[r,r,r])}function Pp(e){const t=Dt/(2*Math.PI);return e/(2*Math.PI)/t}function k_(e,t){return Dt/(512*Math.pow(2,e))*al(Mi(t))}function cx(e,t,r,s,c){const d=Pp(r),f=[e,t,-r/(2*Math.PI)],g=bt.identity(new Float64Array(16));return bt.translate(g,g,f),bt.scale(g,g,[d,d,d]),bt.rotateX(g,g,Ct(-c)),bt.rotateY(g,g,Ct(-s)),g}function ux(e){const t=e.pixelsPerMeter,r=t/ii(1,e.center.lat),s=bt.identity(new Float64Array(16));return bt.translate(s,s,[e.point.x,e.point.y,0]),bt.scale(s,s,[r,r,t]),Float32Array.from(s)}function Po(e){return vs(zu,Bd,e)}function AP(e,t,r){const s=bt.identity(new Float64Array(16)),c=(t/(1<<e)-.5)*Math.PI*2;return bt.rotateY(s,r.globeMatrix,c),Float32Array.from(s)}function gv(e,t,r){const s=Po(r.zoom),c=e.style.map._antialias,d=t.options.extStandardDerivativesForceOff||e.terrain&&e.terrain.exaggeration()>0;return 0===s&&!c&&!d}function mv(e,t,r,s){const c=t.getNorth(),d=t.getSouth(),f=t.getWest(),g=t.getEast(),y=1<<e.z,b=g-f,w=c-d,P=b/64,O=-w/Bu[r],I=[0,P,0,O,0,0,c,f,0];if(e.z>0){const A=180/s;sl.multiply(I,I,[A/b+1,0,0,0,A/w+1,0,-.5*A/P,.5*A/O,1])}return I[2]=y,I[5]=e.x,I[8]=e.y,I}function DP(e){const t=yi-5;e=Ne(e,-t,t)/t*90;const r=Math.pow(Math.abs(Math.sin(Ct(e))),3);return Math.round(r*(Bu.length-1))}function Uu(e){const t=[0,0,0],r=bt.identity(new Float64Array(16));return bt.multiply(r,e.pixelMatrix,e.globeMatrix),dt.transformMat4(t,t,r),new tt(t[0],t[1])}function Lg(e,t){const r=ra(t.lat,t.lng),s=function(d){const f=ra(d._center.lat,d._center.lng),g=dt.fromValues(0,1,0);let y=dt.cross([],g,f);const b=bt.fromRotation([],-d.angle,f);y=dt.transformMat4(y,y,b),bt.fromRotation(b,-d._pitch,y);const w=dt.normalize([],f);return dt.scale(w,w,ox(d.cameraToCenterDistance/d.pixelsPerMeter)),dt.transformMat4(w,w,b),dt.add([],f,w)}(e),c=dt.subtract([],s,r);return dt.angle(c,r)}function _v(e,t){return Lg(e,t)>Math.PI/2*1.01}const yv=Ct(85),Rw=Math.cos(yv),kP=Math.sin(yv);class dx{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,r){const s=new pa,c=new Mo,d=[],f=t+1+2,g=r[0]+1,y=r[0]+1+(1+r.length),b=(w,P,O)=>{let I=w===f-1?w-2:0===w?w:w-1;return I+=O?24575:0,[I,P]};for(let w=0;w<f;++w)s.emplaceBack(...b(w,0,!0));for(let w=0;w<g;++w)for(let P=0;P<f;++P)s.emplaceBack(...b(P,w,(0===P||P===f-1)&&!0));for(let w=0;w<r.length;++w){const P=r[w];for(let O=0;O<f;++O)s.emplaceBack(...b(O,P,!0))}for(let w=0;w<r.length;++w){const P=c.length,O=r[w]+1+2,I=new Mo;for(let u=0;u<O-1;u++){const p=u===O-2,m=p?f*(y-r.length+w-u):f;for(let v=0;v<f-1;v++){const C=u*f+v;0===u||p||0===v||v===f-2?(I.emplaceBack(C+1,C,C+m),I.emplaceBack(C+m,C+m+1,C+1)):(c.emplaceBack(C+1,C,C+m),c.emplaceBack(C+m,C+m+1,C+1))}}const A=li.simpleSegment(0,P,s.length,c.length-P);for(let u=0;u<I.uint16.length;u+=3)c.emplaceBack(I.uint16[u],I.uint16[u+1],I.uint16[u+2]);const l=li.simpleSegment(0,P,s.length,c.length-P);d.push({withoutSkirts:A,withSkirts:l})}return{vertices:s,indices:c,segments:d}}_createGrid(t){const r=this._fillGridMeshWithLods(64,Bu);this._gridSegments=r.segments,this._gridBuffer=t.createVertexBuffer(r.vertices,wp.members),this._gridIndexBuffer=t.createIndexBuffer(r.indices,!0)}_createPoles(t){const r=new Mo;for(let g=0;g<=64;g++)r.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=t.createIndexBuffer(r,!0);const s=new fp,c=new fp,d=new fp,f=new fp;this._poleSegments=[];for(let g=0,y=0;g<zu;g++){const b=360/(1<<g);s.emplaceBack(0,-ea,0,.5,0),c.emplaceBack(0,-ea,0,.5,1),d.emplaceBack(0,-ea,0,.5,.5),f.emplaceBack(0,-ea,0,.5,.5);for(let w=0;w<=64;w++){let P=w/64,O=0;const I=vn(0,b,P),[A,l,u]=A_(Rw,kP,I,ea);s.emplaceBack(A,l,u,P,O),c.emplaceBack(A,l,u,P,1-O);const p=Ct(I);P=.5+.5*Math.sin(p),O=.5+.5*Math.cos(p),d.emplaceBack(A,l,u,P,O),f.emplaceBack(A,l,u,P,1-O)}this._poleSegments.push(li.simpleSegment(y,0,66,64)),y+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(s,tx,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(c,tx,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(d,tx,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(f,tx,!1)}getGridBuffers(t,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,r){return[r?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,r?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}}const Ep=6371008.8,vv=2*Math.PI*Ep;class Aa{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Aa(Wt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,s=this.lat*r,c=t.lat*r,d=Math.sin(s)*Math.sin(c)+Math.cos(s)*Math.cos(c)*Math.cos((t.lng-this.lng)*r);return Ep*Math.acos(Math.min(d,1))}toBounds(t=0){const r=360*t/40075017,s=r/Math.cos(Math.PI/180*this.lat);return new Xi(new Aa(this.lng-s,this.lat-r),new Aa(this.lng+s,this.lat+r))}toEcef(t){const r=ox(t);return ra(this.lat,this.lng,ea+r)}static convert(t){if(t instanceof Aa)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Aa(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Aa(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var kn=Aa;const hx=0,Lw=25.5;function bv(e){return vv*Math.cos(e*Math.PI/180)}function yo(e){return(180+e)/360}function Pi(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function ii(e,t){return e/bv(t)}function Da(e){return 360*e-180}function Ji(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function RP(e,t){return e*bv(Ji(t))}const yi=85.051129;function xv(e){return Math.cos(Ct(Ne(e,-yi,yi)))}function pi(e,t){const r=Ne(t,hx,Lw),s=Math.pow(2,r);return xv(e)*vv/(512*s)}function ac(e){return 1/Math.cos(e*Math.PI/180)}function Op(e,t=0){const r=Math.exp(Math.PI*(1-(e.y+t/Dt)/(1<<e.z)*2));return 80150034*r/(r*r+1)/Dt/(1<<e.z)}class Xn{constructor(t,r,s=0){this.x=+t,this.y=+r,this.z=+s}static fromLngLat(t,r=0){const s=kn.convert(t);return new Xn(yo(s.lng),Pi(s.lat),ii(r,s.lat))}toLngLat(){return new kn(Da(this.x),Ji(this.y))}toAltitude(){return RP(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/vv*ac(Ji(this.y))}}function R_(e,t,r,s,c,d,f,g,y){const b=(t+s)/2,w=(r+c)/2,P=new tt(b,w);g(P),function(O,I,A,l,u,p){const m=A-u,v=l-p;return Math.abs((l-I)*m-(A-O)*v)/Math.hypot(m,v)}(P.x,P.y,d.x,d.y,f.x,f.y)>=y?(R_(e,t,r,b,w,d,P,g,y),R_(e,b,w,s,c,P,f,g,y)):e.push(f)}function Vu(e,t,r){let s=e[0],c=s.x,d=s.y;t(s);const f=[s];for(let g=1;g<e.length;g++){const y=e[g],{x:b,y:w}=y;t(y),R_(f,c,d,b,w,s,y,t,r),c=b,d=w,s=y}return f}function Vd(e,t,r,s){if(s(t,r)){const c=t.add(r)._mult(.5);Vd(e,t,c,s),Vd(e,c,r,s)}else e.push(r)}function Nw(e,t){let r=e[0];const s=[r];for(let c=1;c<e.length;c++){const d=e[c];Vd(s,r,d,t),r=d}return s}const Fw=Math.pow(2,14)-1,jd=-Fw-1;function Ol(e,t){const r=Math.round(e.x*t),s=Math.round(e.y*t);return e.x=Ne(r,jd,Fw),e.y=Ne(s,jd,Fw),(r<e.x||r>e.x+1||s<e.y||s>e.y+1)&&gt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),e}function Ei(e,t,r){const s=e.loadGeometry(),c=e.extent,d=Dt/c;if(t&&r&&r.projection.isReprojectedInTileSpace){const f=1<<t.z,{scale:g,x:y,y:b,projection:w}=r,P=O=>{const I=Da((t.x+O.x/c)/f),A=Ji((t.y+O.y/c)/f),l=w.project(I,A);O.x=(l.x*g-y)*c,O.y=(l.y*g-b)*c};for(let O=0;O<s.length;O++)if(1!==e.type)s[O]=Vu(s[O],P,1);else{const I=[];for(const A of s[O])A.x<0||A.x>=c||A.y<0||A.y>=c||(P(A),I.push(A));s[O]=I}}for(const f of s)for(const g of f)Ol(g,d);return s}function jc(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Ei(e):[]}}function Ng(e,t,r,s,c){e.emplaceBack(2*t+(s+1)/2,2*r+(c+1)/2)}function Fg(e,t,r){e.emplaceBack(t.x,t.y,t.z,16384*r[0],16384*r[1],16384*r[2])}class Wo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new pa,this.indexArray=new Mo,this.segments=new li,this.programConfigurations=new ga(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,s,c){const d=this.layers[0],f=[];let g=null;"circle"===d.type&&(g=d.layout.get("circle-sort-key"));for(const{feature:b,id:w,index:P,sourceLayerIndex:O}of t){const I=this.layers[0]._featureFilter.needGeometry,A=jc(b,I);if(!this.layers[0]._featureFilter.filter(new Ri(this.zoom),A,s))continue;const l=g?g.evaluate(A,{},s):void 0,u={id:w,properties:b.properties,type:b.type,sourceLayerIndex:O,index:P,geometry:I?A.geometry:Ei(b,s,c),patterns:{},sortKey:l};f.push(u)}g&&f.sort((b,w)=>b.sortKey-w.sortKey);let y=null;"globe"===c.projection.name&&(this.globeExtVertexArray=new Xy,y=c.projection);for(const b of f){const{geometry:w,index:P,sourceLayerIndex:O}=b,I=t[P].feature;this.addFeature(b,w,P,r.availableImages,s,y,r.brightness),r.featureIndex.insert(I,w,P,O,this.index)}}update(t,r,s,c,d){const f=0!==Object.keys(t).length;f&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,f?this.stateDependentLayers:this.layers,s,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,yw.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,ES.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,r,s,c,d,f,g){for(const y of r)for(const b of y){const w=b.x,P=b.y;if(w<0||w>=Dt||P<0||P>=Dt)continue;if(f){const A=f.projectTilePoint(w,P,d),l=f.upVector(d,w,P),u=this.globeExtVertexArray;Fg(u,A,l),Fg(u,A,l),Fg(u,A,l),Fg(u,A,l)}const O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),I=O.vertexLength;Ng(this.layoutVertexArray,w,P,-1,-1),Ng(this.layoutVertexArray,w,P,1,-1),Ng(this.layoutVertexArray,w,P,1,1),Ng(this.layoutVertexArray,w,P,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+2,I+3),O.vertexLength+=4,O.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{},c,d,g)}}function zw(e,t){for(let r=0;r<e.length;r++)if($c(t,e[r]))return!0;for(let r=0;r<t.length;r++)if($c(e,t[r]))return!0;return!!zg(e,t)}function Tp(e,t,r){return!!$c(e,t)||!!fx(t,e,r)}function LP(e,t){if(1===e.length)return Uw(t,e[0]);for(let r=0;r<t.length;r++){const s=t[r];for(let c=0;c<s.length;c++)if($c(e,s[c]))return!0}for(let r=0;r<e.length;r++)if(Uw(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(zg(e,t[r]))return!0;return!1}function MT(e,t,r){if(e.length>1){if(zg(e,t))return!0;for(let s=0;s<t.length;s++)if(fx(t[s],e,r))return!0}for(let s=0;s<e.length;s++)if(fx(e[s],t,r))return!0;return!1}function zg(e,t){if(0===e.length||0===t.length)return!1;for(let r=0;r<e.length-1;r++){const s=e[r],c=e[r+1];for(let d=0;d<t.length-1;d++)if(NP(s,c,t[d],t[d+1]))return!0}return!1}function NP(e,t,r,s){return Qt(e,r,s)!==Qt(t,r,s)&&Qt(e,t,r)!==Qt(e,t,s)}function fx(e,t,r){const s=r*r;if(1===t.length)return e.distSqr(t[0])<s;for(let c=1;c<t.length;c++)if(Bw(e,t[c-1],t[c])<s)return!0;return!1}function Bw(e,t,r){const s=t.distSqr(r);if(0===s)return e.distSqr(t);const c=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/s;return e.distSqr(c<0?t:c>1?r:r.sub(t)._mult(c)._add(t))}function Uw(e,t){let r,s,c,d=!1;for(let f=0;f<e.length;f++){r=e[f];for(let g=0,y=r.length-1;g<r.length;y=g++)s=r[g],c=r[y],s.y>t.y!=c.y>t.y&&t.x<(c.x-s.x)*(t.y-s.y)/(c.y-s.y)+s.x&&(d=!d)}return d}function $c(e,t){let r=!1;for(let s=0,c=e.length-1;s<e.length;c=s++){const d=e[s],f=e[c];d.y>t.y!=f.y>t.y&&t.x<(f.x-d.x)*(t.y-d.y)/(f.y-d.y)+d.x&&(r=!r)}return r}function FP(e,t,r,s,c){for(const f of e)if(t<=f.x&&r<=f.y&&s>=f.x&&c>=f.y)return!0;const d=[new tt(t,r),new tt(t,c),new tt(s,c),new tt(s,r)];if(e.length>2)for(const f of d)if($c(e,f))return!0;for(let f=0;f<e.length-1;f++)if(zP(e[f],e[f+1],d))return!0;return!1}function zP(e,t,r){const s=r[0],c=r[2];if(e.x<s.x&&t.x<s.x||e.x>c.x&&t.x>c.x||e.y<s.y&&t.y<s.y||e.y>c.y&&t.y>c.y)return!1;const d=Qt(e,t,r[0]);return d!==Qt(e,t,r[1])||d!==Qt(e,t,r[2])||d!==Qt(e,t,r[3])}function ju(e,t,r,s,c,d){let f=t.y-e.y,g=e.x-t.x;if(d=d||0){const y=f*f+g*g;if(0===y)return!0;const b=Math.sqrt(y);f/=b,g/=b}return!((r.x-e.x)*f+(r.y-e.y)*g-d<0||(s.x-e.x)*f+(s.y-e.y)*g-d<0||(c.x-e.x)*f+(c.y-e.y)*g-d<0)}function wv(e,t,r,s,c,d,f){return!(ju(e,t,s,c,d,f)||ju(t,r,s,c,d,f)||ju(r,e,s,c,d,f)||ju(s,c,e,t,r,f)||ju(c,d,e,t,r,f)||ju(d,s,e,t,r,f))}function so(e,t,r){const s=t.paint.get(e).value;return"constant"===s.kind?s.value:r.programConfigurations.get(t.id).getMaxValue(e)}function _a(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Tl(e,t,r,s,c){if(!t[0]&&!t[1])return e;const d=tt.convert(t)._mult(c);"viewport"===r&&d._rotate(-s);const f=[];for(let g=0;g<e.length;g++)f.push(e[g].sub(d));return f}function px(e,t,r,s){const c=tt.convert(e)._mult(s);return"viewport"===t&&c._rotate(-r),c}De(Wo,"CircleBucket",{omit:["layers"]});const DS=new jt({"circle-sort-key":new Q(wt.layout_circle["circle-sort-key"]),visibility:new G(wt.layout_circle.visibility)});var ze={paint:new jt({"circle-radius":new Q(wt.paint_circle["circle-radius"]),"circle-color":new Q(wt.paint_circle["circle-color"]),"circle-blur":new Q(wt.paint_circle["circle-blur"]),"circle-opacity":new Q(wt.paint_circle["circle-opacity"]),"circle-translate":new G(wt.paint_circle["circle-translate"]),"circle-translate-anchor":new G(wt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new G(wt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new G(wt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Q(wt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Q(wt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Q(wt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new G(wt.paint_circle["circle-emissive-strength"])}),layout:DS};const rs=bt.create(),lc=(e,t,r,s,c,d)=>{const f=e.transform,g="globe"===f.projection.name;let y;if("map"===d.paint.get("circle-pitch-alignment"))if(g){const w=k_(f.zoom,t.canonical)*f._pixelsPerMercatorPixel;y=Float32Array.from([w,0,0,w])}else y=f.calculatePixelsToTileUnitsMatrix(r);else y=new Float32Array([f.pixelsToGLUnits[0],0,0,f.pixelsToGLUnits[1]]);const b={u_camera_to_center_distance:e.transform.getCameraToCenterDistance(f.projection),u_matrix:e.translatePosMatrix(t.projMatrix,r,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Mn.devicePixelRatio,u_extrude_scale:y,u_inv_rot_matrix:rs,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:d.paint.get("circle-emissive-strength")};if(g){b.u_inv_rot_matrix=s,b.u_merc_center=c,b.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],b.u_zoom_transition=Po(f.zoom);const w=c[0]*Dt,P=c[1]*Dt;b.u_up_dir=f.projection.upVector(new oc(0,0,0),w,P)}return b},Ip=e=>{const t=[];return"map"===e.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===e.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t};function wn(e,t,r,s,c,d,f,g,y){if(d&&e.queryGeometry.isAboveHorizon)return!1;d&&(y*=e.pixelToTileUnitsFactor);const b=e.tileID.canonical,w=r.projection.upVectorScale(b,r.center.lat,r.worldSize).metersToTile;for(const P of t)for(const O of P){const I=O.add(g),A=c&&r.elevation?r.elevation.exaggeration()*c.getElevationAt(I.x,I.y,!0):0,l=r.projection.projectTilePoint(I.x,I.y,b);if(A>0){const v=r.projection.upVector(b,I.x,I.y);l.x+=v[0]*w*A,l.y+=v[1]*w*A,l.z+=v[2]*w*A}const u=d?I:$n(l.x,l.y,l.z,s),p=d?e.tilespaceRays.map(v=>Jt(v,A)):e.queryGeometry.screenGeometry,m=kr.transformMat4([],[l.x,l.y,l.z,1],s);if(!f&&d?y*=m[3]/r.cameraToCenterDistance:f&&!d&&(y*=r.cameraToCenterDistance/m[3]),d){const v=Ji((O.y/Dt+b.y)/(1<<b.z));y/=r.projection.pixelsPerMeter(v,1)/ii(1,v)}if(Tp(p,u,y))return!0}return!1}function $n(e,t,r,s){const c=kr.transformMat4([],[e,t,r,1],s);return new tt(c[0]/c[3],c[1]/c[3])}const BP=dt.fromValues(0,0,0),_n=dt.fromValues(0,0,1);function Jt(e,t){const r=dt.create();return BP[2]=t,e.intersectsPlane(BP,_n,r),new tt(r[0],r[1])}class Se extends Wo{}function Ss(e,{width:t,height:r},s,c){if(c){if(c instanceof Uint8ClampedArray)c=new Uint8Array(c.buffer);else if(c.length!==t*r*s)throw new RangeError("mismatched image size")}else c=new Uint8Array(t*r*s);return e.width=t,e.height=r,e.data=c,e}function gx(e,t,r){const{width:s,height:c}=t;s===e.width&&c===e.height||(UP(e,t,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,s),height:Math.min(e.height,c)},r),e.width=s,e.height=c,e.data=t.data)}function UP(e,t,r,s,c,d){if(0===c.width||0===c.height)return t;if(c.width>e.width||c.height>e.height||r.x>e.width-c.width||r.y>e.height-c.height)throw new RangeError("out of range source coordinates for image copy");if(c.width>t.width||c.height>t.height||s.x>t.width-c.width||s.y>t.height-c.height)throw new RangeError("out of range destination coordinates for image copy");const f=e.data,g=t.data;for(let y=0;y<c.height;y++){const b=((r.y+y)*e.width+r.x)*d,w=((s.y+y)*t.width+s.x)*d;for(let P=0;P<c.width*d;P++)g[w+P]=f[b+P]}return t}De(Se,"HeatmapBucket",{omit:["layers"]});class cf{constructor(t,r){Ss(this,t,1,r)}resize(t){gx(this,new cf(t),1)}clone(){return new cf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,s,c,d){UP(t,r,s,c,d,1)}}class Uo{constructor(t,r){Ss(this,t,4,r)}resize(t){gx(this,new Uo(t),4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Uo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,s,c,d){UP(t,r,s,c,d,4)}}class PT{constructor(t,r){this.width=t.width,this.height=t.height,this.data=r instanceof Uint8Array?new Float32Array(r.buffer):r}}De(cf,"AlphaImage"),De(Uo,"RGBAImage");const VP=new jt({visibility:new G(wt.layout_heatmap.visibility)});var Vw={paint:new jt({"heatmap-radius":new Q(wt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Q(wt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new G(wt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new St(wt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new G(wt.paint_heatmap["heatmap-opacity"])}),layout:VP};function jw(e){const t={},r=e.resolution||256,s=e.clips?e.clips.length:1,c=e.image||new Uo({width:r,height:s}),d=(f,g,y)=>{t[e.evaluationKey]=y;const b=e.expression.evaluate(t);b&&(c.data[f+g+0]=Math.floor(255*b.r/b.a),c.data[f+g+1]=Math.floor(255*b.g/b.a),c.data[f+g+2]=Math.floor(255*b.b/b.a),c.data[f+g+3]=Math.floor(255*b.a))};if(e.clips)for(let f=0,g=0;f<s;++f,g+=4*r)for(let y=0,b=0;y<r;y++,b+=4){const w=y/(r-1),{start:P,end:O}=e.clips[f];d(g,b,P*(1-w)+O*w)}else for(let f=0,g=0;f<r;f++,g+=4)d(0,g,f/(r-1));return c}const $w=new jt({visibility:new G(wt.layout_hillshade.visibility)});var jP={paint:new jt({"hillshade-illumination-direction":new G(wt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new G(wt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new G(wt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new G(wt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new G(wt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new G(wt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new G(wt.paint_hillshade["hillshade-emissive-strength"])}),layout:$w};const Gw=Dr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Br}=Gw;var uf={exports:{}};function L_(e,t,r){r=r||2;var s,c,d,f,g,y,b,w=t&&t.length,P=w?t[0]*r:e.length,O=An(e,0,P,r,!0),I=[];if(!O||O.next===O.prev)return I;if(w&&(O=function(l,u,p,m){var v,C,E,T=[];for(v=0,C=u.length;v<C;v++)(E=An(l,u[v]*m,v<C-1?u[v+1]*m:l.length,m,!1))===E.next&&(E.steiner=!0),T.push(N_(E));for(T.sort(df),v=0;v<T.length;v++)p=Cv(T[v],p);return p}(e,t,O,r)),e.length>80*r){s=d=e[0],c=f=e[1];for(var A=r;A<P;A+=r)(g=e[A])<s&&(s=g),(y=e[A+1])<c&&(c=y),g>d&&(d=g),y>f&&(f=y);b=0!==(b=Math.max(d-s,f-c))?32767/b:0}return $d(O,I,r,s,c,b,0),I}function An(e,t,r,s,c){var d,f;if(c===Sl(e,t,r,s)>0)for(d=t;d<r;d+=s)f=_x(d,e[d],e[d+1],f);else for(d=r-s;d>=t;d-=s)f=_x(d,e[d],e[d+1],f);return f&&Ug(f,f.next)&&(qt(f),f=f.next),f}function Rn(e,t){if(!e)return e;t||(t=e);var r,s=e;do{if(r=!1,s.steiner||!Ug(s,s.next)&&0!==Eo(s.prev,s,s.next))s=s.next;else{if(qt(s),(s=t=s.prev)===s.next)break;r=!0}}while(r||s!==t);return t}function $d(e,t,r,s,c,d,f){if(e){!f&&d&&function(w,P,O,I){var A=w;do{0===A.z&&(A.z=mx(A.x,A.y,P,O,I)),A.prevZ=A.prev,A.nextZ=A.next,A=A.next}while(A!==w);A.prevZ.nextZ=null,A.prevZ=null,function(l){var u,p,m,v,C,E,T,k,N=1;do{for(p=l,l=null,C=null,E=0;p;){for(E++,m=p,T=0,u=0;u<N&&(T++,m=m.nextZ);u++);for(k=N;T>0||k>0&&m;)0!==T&&(0===k||!m||p.z<=m.z)?(v=p,p=p.nextZ,T--):(v=m,m=m.nextZ,k--),C?C.nextZ=v:l=v,v.prevZ=C,C=v;p=m}C.nextZ=null,N*=2}while(E>1)}(A)}(e,s,c,d);for(var g,y,b=e;e.prev!==e.next;)if(g=e.prev,y=e.next,d?$P(e,s,c,d):oi(e))t.push(g.i/r|0),t.push(e.i/r|0),t.push(y.i/r|0),qt(e),e=y.next,b=y.next;else if((e=y)===b){f?1===f?$d(e=_s(Rn(e),t,r),t,r,s,c,d,2):2===f&&hn(e,t,r,s,c,d):$d(Rn(e),t,r,s,c,d,1);break}}}function oi(e){var t=e.prev,r=e,s=e.next;if(Eo(t,r,s)>=0)return!1;for(var c=t.x,d=r.x,f=s.x,g=t.y,y=r.y,b=s.y,w=c<d?c<f?c:f:d<f?d:f,P=g<y?g<b?g:b:y<b?y:b,O=c>d?c>f?c:f:d>f?d:f,I=g>y?g>b?g:b:y>b?y:b,A=s.next;A!==t;){if(A.x>=w&&A.x<=O&&A.y>=P&&A.y<=I&&Sp(c,g,d,y,f,b,A.x,A.y)&&Eo(A.prev,A,A.next)>=0)return!1;A=A.next}return!0}function $P(e,t,r,s){var c=e.prev,d=e,f=e.next;if(Eo(c,d,f)>=0)return!1;for(var g=c.x,y=d.x,b=f.x,w=c.y,P=d.y,O=f.y,I=g<y?g<b?g:b:y<b?y:b,A=w<P?w<O?w:O:P<O?P:O,l=g>y?g>b?g:b:y>b?y:b,u=w>P?w>O?w:O:P>O?P:O,p=mx(I,A,t,r,s),m=mx(l,u,t,r,s),v=e.prevZ,C=e.nextZ;v&&v.z>=p&&C&&C.z<=m;){if(v.x>=I&&v.x<=l&&v.y>=A&&v.y<=u&&v!==c&&v!==f&&Sp(g,w,y,P,b,O,v.x,v.y)&&Eo(v.prev,v,v.next)>=0||(v=v.prevZ,C.x>=I&&C.x<=l&&C.y>=A&&C.y<=u&&C!==c&&C!==f&&Sp(g,w,y,P,b,O,C.x,C.y)&&Eo(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;v&&v.z>=p;){if(v.x>=I&&v.x<=l&&v.y>=A&&v.y<=u&&v!==c&&v!==f&&Sp(g,w,y,P,b,O,v.x,v.y)&&Eo(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;C&&C.z<=m;){if(C.x>=I&&C.x<=l&&C.y>=A&&C.y<=u&&C!==c&&C!==f&&Sp(g,w,y,P,b,O,C.x,C.y)&&Eo(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function _s(e,t,r){var s=e;do{var c=s.prev,d=s.next.next;!Ug(c,d)&&Il(c,s,s.next,d)&&z_(c,d)&&z_(d,c)&&(t.push(c.i/r|0),t.push(s.i/r|0),t.push(d.i/r|0),qt(s),qt(s.next),s=e=d),s=s.next}while(s!==e);return Rn(s)}function hn(e,t,r,s,c,d){var f=e;do{for(var g=f.next.next;g!==f.prev;){if(f.i!==g.i&&Bg(f,g)){var y=hf(f,g);return f=Rn(f,f.next),y=Rn(y,y.next),$d(f,t,r,s,c,d,0),void $d(y,t,r,s,c,d,0)}g=g.next}f=f.next}while(f!==e)}function df(e,t){return e.x-t.x}function Cv(e,t){var r=function(c,d){var f,g=d,y=c.x,b=c.y,w=-1/0;do{if(b<=g.y&&b>=g.next.y&&g.next.y!==g.y){var P=g.x+(b-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(P<=y&&P>w&&(w=P,f=g.x<g.next.x?g:g.next,P===y))return f}g=g.next}while(g!==d);if(!f)return null;var O,I=f,A=f.x,l=f.y,u=1/0;g=f;do{y>=g.x&&g.x>=A&&y!==g.x&&Sp(b<l?y:w,b,A,l,b<l?w:y,b,g.x,g.y)&&(O=Math.abs(b-g.y)/(y-g.x),z_(g,c)&&(O<u||O===u&&(g.x>f.x||g.x===f.x&&$u(f,g)))&&(f=g,u=O)),g=g.next}while(g!==I);return f}(e,t);if(!r)return t;var s=hf(r,e);return Rn(s,s.next),Rn(r,r.next)}function $u(e,t){return Eo(e.prev,e,t.prev)<0&&Eo(t.next,e,e.next)<0}function mx(e,t,r,s,c){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*c|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-s)*c|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function N_(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Sp(e,t,r,s,c,d,f,g){return(c-f)*(t-g)>=(e-f)*(d-g)&&(e-f)*(s-g)>=(r-f)*(t-g)&&(r-f)*(d-g)>=(c-f)*(s-g)}function Bg(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,s){var c=r;do{if(c.i!==r.i&&c.next.i!==r.i&&c.i!==s.i&&c.next.i!==s.i&&Il(c,c.next,r,s))return!0;c=c.next}while(c!==r);return!1}(e,t)&&(z_(e,t)&&z_(t,e)&&function(r,s){var c=r,d=!1,f=(r.x+s.x)/2,g=(r.y+s.y)/2;do{c.y>g!=c.next.y>g&&c.next.y!==c.y&&f<(c.next.x-c.x)*(g-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next}while(c!==r);return d}(e,t)&&(Eo(e.prev,e,t.prev)||Eo(e,t.prev,t))||Ug(e,t)&&Eo(e.prev,e,e.next)>0&&Eo(t.prev,t,t.next)>0)}function Eo(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Ug(e,t){return e.x===t.x&&e.y===t.y}function Il(e,t,r,s){var c=Mv(Eo(e,t,r)),d=Mv(Eo(e,t,s)),f=Mv(Eo(r,s,e)),g=Mv(Eo(r,s,t));return c!==d&&f!==g||!(0!==c||!F_(e,r,t))||!(0!==d||!F_(e,s,t))||!(0!==f||!F_(r,e,s))||!(0!==g||!F_(r,t,s))}function F_(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Mv(e){return e>0?1:e<0?-1:0}function z_(e,t){return Eo(e.prev,e,e.next)<0?Eo(e,t,e.next)>=0&&Eo(e,e.prev,t)>=0:Eo(e,t,e.prev)<0||Eo(e,e.next,t)<0}function hf(e,t){var r=new B_(e.i,e.x,e.y),s=new B_(t.i,t.x,t.y),c=e.next,d=t.prev;return e.next=t,t.prev=e,r.next=c,c.prev=r,s.next=r,r.prev=s,d.next=s,s.prev=d,s}function _x(e,t,r,s){var c=new B_(e,t,r);return s?(c.next=s.next,c.prev=s,s.next.prev=c,s.next=c):(c.prev=c,c.next=c),c}function qt(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function B_(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Sl(e,t,r,s){for(var c=0,d=t,f=r-s;d<r;d+=s)c+=(e[f]-e[d])*(e[d+1]+e[f+1]),f=d;return c}uf.exports=L_,uf.exports.default=L_,L_.deviation=function(e,t,r,s){var c=t&&t.length,d=Math.abs(Sl(e,0,c?t[0]*r:e.length,r));if(c)for(var f=0,g=t.length;f<g;f++)d-=Math.abs(Sl(e,t[f]*r,f<g-1?t[f+1]*r:e.length,r));var y=0;for(f=0;f<s.length;f+=3){var b=s[f]*r,w=s[f+1]*r,P=s[f+2]*r;y+=Math.abs((e[b]-e[P])*(e[w+1]-e[b+1])-(e[b]-e[w])*(e[P+1]-e[b+1]))}return 0===d&&0===y?0:Math.abs((y-d)/d)},L_.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},s=0,c=0;c<e.length;c++){for(var d=0;d<e[c].length;d++)for(var f=0;f<t;f++)r.vertices.push(e[c][d][f]);c>0&&r.holes.push(s+=e[c-1].length)}return r};var Pv=We(uf.exports);function Vg(e,t){const r=e.length;if(r<=1)return[e];const s=[];let c,d;for(let f=0;f<r;f++){const g=oe(e[f]);0!==g&&(e[f].area=Math.abs(g),void 0===d&&(d=g<0),d===g<0?(c&&s.push(c),c=[e[f]]):c.push(e[f]))}if(c&&s.push(c),t>1)for(let f=0;f<s.length;f++)s[f].length<=t||(qy(s[f],t,1,s[f].length-1,Ap),s[f]=s[f].slice(0,t));return s}function Ap(e,t){return t.area-e.area}function ll(e,t,r){const s=r.patternDependencies;let c=!1;for(const d of t){const f=d.paint.get(`${e}-pattern`);f.isConstant()||(c=!0);const g=f.constantOr(null);g&&(c=!0,s[g]=!0)}return c}function ff(e,t,r,s,c){const d=c.patternDependencies;for(const f of t){const g=f.paint.get(`${e}-pattern`).value;if("constant"!==g.kind){let y=g.evaluate({zoom:s},r,{},c.availableImages);y=y&&y.name?y.name:y,d[y]=!0,r.patterns[f.id]=y}}return r}class Ev{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pa,this.indexArray=new Mo,this.indexArray2=new ku,this.programConfigurations=new ga(t.layers,t.zoom),this.segments=new li,this.segments2=new li,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=t.projection}populate(t,r,s,c){this.hasPattern=ll("fill",this.layers,r);const d=this.layers[0].layout.get("fill-sort-key"),f=[];for(const{feature:g,id:y,index:b,sourceLayerIndex:w}of t){const P=this.layers[0]._featureFilter.needGeometry,O=jc(g,P);if(!this.layers[0]._featureFilter.filter(new Ri(this.zoom),O,s))continue;const I=d?d.evaluate(O,{},s,r.availableImages):void 0,A={id:y,properties:g.properties,type:g.type,sourceLayerIndex:w,index:b,geometry:P?O.geometry:Ei(g,s,c),patterns:{},sortKey:I};f.push(A)}d&&f.sort((g,y)=>g.sortKey-y.sortKey);for(const g of f){const{geometry:y,index:b,sourceLayerIndex:w}=g;if(this.hasPattern){const P=ff("fill",this.layers,g,this.zoom,r);this.patternFeatures.push(P)}else this.addFeature(g,y,b,s,{},r.availableImages,r.brightness);r.featureIndex.insert(t[b].feature,y,b,w,this.index)}}update(t,r,s,c,d){const f=0!==Object.keys(t).length;f&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,f?this.stateDependentLayers:this.layers,s,c,d)}addFeatures(t,r,s,c,d,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,s,c,f)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Br),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,s,c,d,f=[],g){for(const y of Vg(r,500)){let b=0;for(const l of y)b+=l.length;const w=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),P=w.vertexLength,O=[],I=[];for(const l of y){if(0===l.length)continue;l!==y[0]&&I.push(O.length/2);const u=this.segments2.prepareSegment(l.length,this.layoutVertexArray,this.indexArray2),p=u.vertexLength;this.layoutVertexArray.emplaceBack(l[0].x,l[0].y),this.indexArray2.emplaceBack(p+l.length-1,p),O.push(l[0].x),O.push(l[0].y);for(let m=1;m<l.length;m++)this.layoutVertexArray.emplaceBack(l[m].x,l[m].y),this.indexArray2.emplaceBack(p+m-1,p+m),O.push(l[m].x),O.push(l[m].y);u.vertexLength+=l.length,u.primitiveLength+=l.length}const A=Pv(O,I);for(let l=0;l<A.length;l+=3)this.indexArray.emplaceBack(P+A[l],P+A[l+1],P+A[l+2]);w.vertexLength+=b,w.primitiveLength+=A.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,d,f,c,g)}}De(Ev,"FillBucket",{omit:["layers","patternFeatures"]});const GP=new jt({"fill-sort-key":new Q(wt.layout_fill["fill-sort-key"]),visibility:new G(wt.layout_fill.visibility)});var Hw={paint:new jt({"fill-antialias":new G(wt.paint_fill["fill-antialias"]),"fill-opacity":new Q(wt.paint_fill["fill-opacity"]),"fill-color":new Q(wt.paint_fill["fill-color"]),"fill-outline-color":new Q(wt.paint_fill["fill-outline-color"]),"fill-translate":new G(wt.paint_fill["fill-translate"]),"fill-translate-anchor":new G(wt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Q(wt.paint_fill["fill-pattern"]),"fill-emissive-strength":new G(wt.paint_fill["fill-emissive-strength"])}),layout:GP};const HP=Dr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),cc=Dr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Ov=Dr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Tv=Dr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),qw=Dr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:ka}=HP;var yx={},vx=Ce,Gu=jg;function jg(e,t,r,s,c){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=s,this._values=c,e.readFields(bx,this,t)}function bx(e,t,r){1==e?t.id=r.readVarint():2==e?function(s,c){for(var d=s.readVarint()+s.pos;s.pos<d;){var f=c._keys[s.readVarint()],g=c._values[s.readVarint()];c.properties[f]=g}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function qP(e){for(var t,r,s=0,c=0,d=e.length,f=d-1;c<d;f=c++)s+=((r=e[f]).x-(t=e[c]).x)*(t.y+r.y);return s}jg.types=["Unknown","Point","LineString","Polygon"],jg.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,s=1,c=0,d=0,f=0,g=[];e.pos<r;){if(c<=0){var y=e.readVarint();s=7&y,c=y>>3}if(c--,1===s||2===s)d+=e.readSVarint(),f+=e.readSVarint(),1===s&&(t&&g.push(t),t=[]),t.push(new vx(d,f));else{if(7!==s)throw new Error("unknown command "+s);t&&t.push(t[0].clone())}}return t&&g.push(t),g},jg.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,s=0,c=0,d=0,f=1/0,g=-1/0,y=1/0,b=-1/0;e.pos<t;){if(s<=0){var w=e.readVarint();r=7&w,s=w>>3}if(s--,1===r||2===r)(c+=e.readSVarint())<f&&(f=c),c>g&&(g=c),(d+=e.readSVarint())<y&&(y=d),d>b&&(b=d);else if(7!==r)throw new Error("unknown command "+r)}return[f,y,g,b]},jg.prototype.toGeoJSON=function(e,t,r){var s,c,d=this.extent*Math.pow(2,r),f=this.extent*e,g=this.extent*t,y=this.loadGeometry(),b=jg.types[this.type];function w(I){for(var A=0;A<I.length;A++){var l=I[A];I[A]=[360*(l.x+f)/d-180,360/Math.PI*Math.atan(Math.exp((180-360*(l.y+g)/d)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(s=0;s<y.length;s++)P[s]=y[s][0];w(y=P);break;case 2:for(s=0;s<y.length;s++)w(y[s]);break;case 3:for(y=function(I){var A=I.length;if(A<=1)return[I];for(var l,u,p=[],m=0;m<A;m++){var v=qP(I[m]);0!==v&&(void 0===u&&(u=v<0),u===v<0?(l&&p.push(l),l=[I[m]]):l.push(I[m]))}return l&&p.push(l),p}(y),s=0;s<y.length;s++)for(c=0;c<y[s].length;c++)w(y[s][c])}1===y.length?y=y[0]:b="Multi"+b;var O={type:"Feature",geometry:{type:b,coordinates:y},properties:this.properties};return"id"in this&&(O.id=this.id),O};var ET=Gu,Hu=xx;function xx(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(OT,this,t),this.length=this._features.length}function OT(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(s){for(var c=null,d=s.readVarint()+s.pos;s.pos<d;){var f=s.readVarint()>>3;c=1===f?s.readString():2===f?s.readFloat():3===f?s.readDouble():4===f?s.readVarint64():5===f?s.readVarint():6===f?s.readSVarint():7===f?s.readBoolean():null}return c}(r))}xx.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new ET(this._pbf,t,this.extent,this._keys,this._values)};var ZP=Hu;function TT(e,t,r){if(3===e){var s=new ZP(r,r.readVarint()+r.pos);s.length&&(t[s.name]=s)}}var wx=yx.VectorTile=function(e,t){this.layers=e.readFields(TT,{},t)},Iv=yx.VectorTileFeature=Gu;function $g(e,t,r,s){const c=[],d=0===s?(f,g,y,b,w,P)=>{f.push(new tt(P,y+(P-g)/(b-g)*(w-y)))}:(f,g,y,b,w,P)=>{f.push(new tt(g+(P-y)/(w-y)*(b-g),P))};for(const f of e){const g=[];for(const y of f){if(y.length<=2)continue;const b=[];for(let O=0;O<y.length-1;O++){const I=y[O].x,A=y[O].y,l=y[O+1].x,u=y[O+1].y,p=0===s?I:A,m=0===s?l:u;p<t?m>t&&d(b,I,A,l,u,t):p>r?m<r&&d(b,I,A,l,u,r):b.push(y[O]),m<t&&p>=t&&d(b,I,A,l,u,t),m>r&&p<=r&&d(b,I,A,l,u,r)}let w=y[y.length-1];const P=0===s?w.x:w.y;P>=t&&P<=r&&b.push(w),b.length&&(w=b[b.length-1],b[0].x===w.x&&b[0].y===w.y||b.push(b[0]),g.push(b))}g.length&&c.push(g)}return c}yx.VectorTileLayer=Hu;class Cx{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const s=t[r];this._stringToNumber[s]=r,this._numberToString[r]=s}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}var kS={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(e,t,r,s,c){var d,f,g=8*c-s-1,y=(1<<g)-1,b=y>>1,w=-7,P=r?c-1:0,O=r?-1:1,I=e[t+P];for(P+=O,d=I&(1<<-w)-1,I>>=-w,w+=g;w>0;d=256*d+e[t+P],P+=O,w-=8);for(f=d&(1<<-w)-1,d>>=-w,w+=s;w>0;f=256*f+e[t+P],P+=O,w-=8);if(0===d)d=1-b;else{if(d===y)return f?NaN:1/0*(I?-1:1);f+=Math.pow(2,s),d-=b}return(I?-1:1)*f*Math.pow(2,d-s)},write:function(e,t,r,s,c,d){var f,g,y,b=8*d-c-1,w=(1<<b)-1,P=w>>1,O=23===c?Math.pow(2,-24)-Math.pow(2,-77):0,I=s?0:d-1,A=s?1:-1,l=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(g=isNaN(t)?1:0,f=w):(f=Math.floor(Math.log(t)/Math.LN2),t*(y=Math.pow(2,-f))<1&&(f--,y*=2),(t+=f+P>=1?O/y:O*Math.pow(2,1-P))*y>=2&&(f++,y/=2),f+P>=w?(g=0,f=w):f+P>=1?(g=(t*y-1)*Math.pow(2,c),f+=P):(g=t*Math.pow(2,P-1)*Math.pow(2,c),f=0));c>=8;e[r+I]=255&g,I+=A,g/=256,c-=8);for(f=f<<c|g,b+=c;b>0;e[r+I]=255&f,I+=A,f/=256,b-=8);e[r+I-A]|=128*l}},Zw=Li,Sv=kS;function Li(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Li.Varint=0,Li.Fixed64=1,Li.Bytes=2,Li.Fixed32=5;var Mx=4294967296,Av=1/Mx,Gd=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Hd(e){return e.type===Li.Bytes?e.readVarint()+e.pos:e.pos+1}function Px(e,t,r){var s=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(s);for(var c=r.pos-1;c>=e;c--)r.buf[c+s]=r.buf[c]}function Ww(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function zs(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function WP(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function qu(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function U_(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function lo(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Hg(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Ra(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Oo(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function V_(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Gc(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function cl(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}Li.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var s=this.readVarint(),c=s>>3,d=this.pos;this.type=7&s,e(c,t,this),this.pos===d&&this.skip(s)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=V_(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=cl(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=V_(this.buf,this.pos)+V_(this.buf,this.pos+4)*Mx;return this.pos+=8,e},readSFixed64:function(){var e=V_(this.buf,this.pos)+cl(this.buf,this.pos+4)*Mx;return this.pos+=8,e},readFloat:function(){var e=Sv.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Sv.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,s=this.buf;return t=127&(r=s[this.pos++]),r<128?t:(t|=(127&(r=s[this.pos++]))<<7,r<128?t:(t|=(127&(r=s[this.pos++]))<<14,r<128?t:(t|=(127&(r=s[this.pos++]))<<21,r<128?t:function(c,d,f){var g,y,b=f.buf;if(g=(112&(y=b[f.pos++]))>>4,y<128||(g|=(127&(y=b[f.pos++]))<<3,y<128)||(g|=(127&(y=b[f.pos++]))<<10,y<128)||(g|=(127&(y=b[f.pos++]))<<17,y<128)||(g|=(127&(y=b[f.pos++]))<<24,y<128)||(g|=(1&(y=b[f.pos++]))<<31,y<128))return function Gg(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}(c,g,d);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=s[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Gd?Gd.decode(this.buf.subarray(t,e)):function(r,s,c){for(var d="",f=s;f<c;){var g,y,b,w=r[f],P=null,O=w>239?4:w>223?3:w>191?2:1;if(f+O>c)break;1===O?w<128&&(P=w):2===O?128==(192&(g=r[f+1]))&&(P=(31&w)<<6|63&g)<=127&&(P=null):3===O?(y=r[f+2],128==(192&(g=r[f+1]))&&128==(192&y)&&((P=(15&w)<<12|(63&g)<<6|63&y)<=2047||P>=55296&&P<=57343)&&(P=null)):4===O&&(y=r[f+2],b=r[f+3],128==(192&(g=r[f+1]))&&128==(192&y)&&128==(192&b)&&((P=(15&w)<<18|(63&g)<<12|(63&y)<<6|63&b)<=65535||P>=1114112)&&(P=null)),null===P?(P=65533,O=1):P>65535&&(P-=65536,d+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),d+=String.fromCharCode(P),f+=O}return d}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Li.Bytes)return e.push(this.readVarint(t));var r=Hd(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Li.Bytes)return e.push(this.readSVarint());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Li.Bytes)return e.push(this.readBoolean());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Li.Bytes)return e.push(this.readFloat());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Li.Bytes)return e.push(this.readDouble());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Li.Bytes)return e.push(this.readFixed32());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Li.Bytes)return e.push(this.readSFixed32());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Li.Bytes)return e.push(this.readFixed64());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Li.Bytes)return e.push(this.readSFixed64());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Li.Varint)for(;this.buf[this.pos++]>127;);else if(t===Li.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Li.Fixed32)this.pos+=4;else{if(t!==Li.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Gc(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Gc(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Gc(this.buf,-1&e,this.pos),Gc(this.buf,Math.floor(e*Av),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Gc(this.buf,-1&e,this.pos),Gc(this.buf,Math.floor(e*Av),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,r){var s,c,d,g;if(t>=0?(s=t%4294967296|0,c=t/4294967296|0):(c=~(-t/4294967296),4294967295^(s=~(-t%4294967296))?s=s+1|0:(s=0,c=c+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),d=s,(g=r).buf[g.pos++]=127&d|128,d>>>=7,g.buf[g.pos++]=127&d|128,d>>>=7,g.buf[g.pos++]=127&d|128,d>>>=7,g.buf[g.pos++]=127&d|128,g.buf[g.pos]=127&(d>>>=7),function(d,f){var g=(7&d)<<4;f.buf[f.pos++]|=g|((d>>>=3)?128:0),d&&(f.buf[f.pos++]=127&d|((d>>>=7)?128:0),d&&(f.buf[f.pos++]=127&d|((d>>>=7)?128:0),d&&(f.buf[f.pos++]=127&d|((d>>>=7)?128:0),d&&(f.buf[f.pos++]=127&d|((d>>>=7)?128:0),d&&(f.buf[f.pos++]=127&d)))))}(c,r)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(s,c,d){for(var f,g,y=0;y<c.length;y++){if((f=c.charCodeAt(y))>55295&&f<57344){if(!g){f>56319||y+1===c.length?(s[d++]=239,s[d++]=191,s[d++]=189):g=f;continue}if(f<56320){s[d++]=239,s[d++]=191,s[d++]=189,g=f;continue}f=g-55296<<10|f-56320|65536,g=null}else g&&(s[d++]=239,s[d++]=191,s[d++]=189,g=null);f<128?s[d++]=f:(f<2048?s[d++]=f>>6|192:(f<65536?s[d++]=f>>12|224:(s[d++]=f>>18|240,s[d++]=f>>12&63|128),s[d++]=f>>6&63|128),s[d++]=63&f|128)}return d}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&Px(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Sv.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Sv.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var s=this.pos-r;s>=128&&Px(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeMessage:function(e,t,r){this.writeTag(e,Li.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Ww,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,zs,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,U_,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,WP,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,qu,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,lo,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Hg,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Ra,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Oo,t)},writeBytesField:function(e,t){this.writeTag(e,Li.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Li.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Li.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Li.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Li.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Li.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Li.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Li.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Li.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Li.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var Dv=We(Zw);const IT=["tile","layer","source","sourceLayer","state"];class ys{constructor(t,r,s,c,d){this.type="Feature",this._vectorTileFeature=t,this._z=r,this._x=s,this._y=c,this.properties=t.properties,this.id=d}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(t.id=this.id);for(const r of IT)void 0!==this[r]&&(t[r]=this[r]);return t}}class kv{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,r,s){const c=String(r);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][c]=this.stateChanges[t][c]||{},_t(this.stateChanges[t][c],s),null===this.deletedStates[t]){this.deletedStates[t]={};for(const d in this.state[t])d!==c&&(this.deletedStates[t][d]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][c]){this.deletedStates[t][c]={};for(const d in this.state[t][c])s[d]||(this.deletedStates[t][c][d]=null)}else for(const d in s)this.deletedStates[t]&&this.deletedStates[t][c]&&null===this.deletedStates[t][c][d]&&delete this.deletedStates[t][c][d]}removeFeatureState(t,r,s){if(null===this.deletedStates[t])return;const c=String(r);if(this.deletedStates[t]=this.deletedStates[t]||{},s&&void 0!==r)null!==this.deletedStates[t][c]&&(this.deletedStates[t][c]=this.deletedStates[t][c]||{},this.deletedStates[t][c][s]=null);else if(void 0!==r)if(this.stateChanges[t]&&this.stateChanges[t][c])for(s in this.deletedStates[t][c]={},this.stateChanges[t][c])this.deletedStates[t][c][s]=null;else this.deletedStates[t][c]=null;else this.deletedStates[t]=null}getState(t,r){const s=String(r),c=_t({},(this.state[t]||{})[s],(this.stateChanges[t]||{})[s]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const d=this.deletedStates[t][r];if(null===d)return{};for(const f in d)delete c[f]}return c}initializeTileState(t,r){t.setFeatureState(this.state,r)}coalesceChanges(t,r){const s={};for(const c in this.stateChanges){this.state[c]=this.state[c]||{};const d={};for(const f in this.stateChanges[c])this.state[c][f]||(this.state[c][f]={}),_t(this.state[c][f],this.stateChanges[c][f]),d[f]=this.state[c][f];s[c]=d}for(const c in this.deletedStates){this.state[c]=this.state[c]||{};const d={};if(null===this.deletedStates[c])for(const f in this.state[c])d[f]={},this.state[c][f]={};else for(const f in this.deletedStates[c]){if(null===this.deletedStates[c][f])this.state[c][f]={};else if(this.state[c][f])for(const g of Object.keys(this.deletedStates[c][f]))delete this.state[c][f][g];d[f]=this.state[c][f]}s[c]=s[c]||{},_t(s[c],d)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(s).length)for(const c in t)t[c].setFeatureState(s,r)}}class pf{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,r){const s=this.toIdx(t,r);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(t,r){return this.leaves[this.toIdx(t,r)]}toIdx(t,r){return r*this.size+t}}function Vo(e,t,r,s){let c=0,d=Number.MAX_VALUE;for(let f=0;f<3;f++)if(Math.abs(s[f])<1e-15){if(r[f]<e[f]||r[f]>t[f])return null}else{const g=1/s[f];let y=(e[f]-r[f])*g,b=(t[f]-r[f])*g;if(y>b){const w=y;y=b,b=w}if(y>c&&(c=y),b<d&&(d=b),c>d)return null}return c}function Zu(e,t,r,s,c,d,f,g,y,b,w){const P=s-e,O=c-t,I=d-r,A=f-e,l=g-t,u=y-r,p=w[1]*u-w[2]*l,m=w[2]*A-w[0]*u,v=w[0]*l-w[1]*A,C=P*p+O*m+I*v;if(Math.abs(C)<1e-15)return null;const E=1/C,T=b[0]-e,k=b[1]-t,N=b[2]-r,F=(T*p+k*m+N*v)*E;if(F<0||F>1)return null;const $=k*I-N*O,q=N*P-T*I,Z=T*O-k*P,X=(w[0]*$+w[1]*q+w[2]*Z)*E;return X<0||F+X>1?null:(A*$+l*q+u*Z)*E}function Rv(e,t,r){return(e-t)/(r-t)}function Lv(e,t,r,s,c,d,f,g,y){const b=1<<r,w=d-s,P=f-c,O=(e+1)/b*w+s,I=(t+0)/b*P+c,A=(t+1)/b*P+c;g[0]=(e+0)/b*w+s,g[1]=I,y[0]=O,y[1]=A}class qd{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(d){const f=Math.ceil(Math.log2(d.dim/8)),g=[];let y=Math.ceil(Math.pow(2,f));const b=1/y,w=(I,A,l,u,p)=>{const m=u?1:0,v=(I+1)*l-m,C=A*l,E=(A+1)*l-m;p[0]=I*l,p[1]=C,p[2]=v,p[3]=E};let P=new pf(y);const O=[];for(let I=0;I<y*y;I++){w(I%y,Math.floor(I/y),b,!1,O);const A=Al(O[0],O[1],d),l=Al(O[2],O[1],d),u=Al(O[2],O[3],d),p=Al(O[0],O[3],d);P.minimums.push(Math.min(A,l,u,p)),P.maximums.push(Math.max(A,l,u,p)),P.leaves.push(1)}for(g.push(P),y/=2;y>=1;y/=2){const I=g[g.length-1];P=new pf(y);for(let A=0;A<y*y;A++){w(A%y,Math.floor(A/y),2,!0,O);const l=I.getElevation(O[0],O[1]),u=I.getElevation(O[2],O[1]),p=I.getElevation(O[2],O[3]),m=I.getElevation(O[0],O[3]),v=I.isLeaf(O[0],O[1]),C=I.isLeaf(O[2],O[1]),E=I.isLeaf(O[2],O[3]),T=I.isLeaf(O[0],O[3]),k=Math.min(l.min,u.min,p.min,m.min),N=Math.max(l.max,u.max,p.max,m.max),F=v&&C&&E&&T;P.maximums.push(N),P.minimums.push(k),P.leaves.push(N-k<=5&&F?1:0)}g.push(P)}return g}(this.dem),s=r.length-1,c=r[s];this._addNode(c.minimums[0],c.maximums[0],c.leaves[0]),this._construct(r,0,0,s,0)}raycastRoot(t,r,s,c,d,f,g=1){return Vo([t,r,-100],[s,c,this.maximums[0]*g],d,f)}raycast(t,r,s,c,d,f,g=1){if(!this.nodeCount)return null;const y=this.raycastRoot(t,r,s,c,d,f,g);if(null==y)return null;const b=[],w=[],P=[],O=[],I=[{idx:0,t:y,nodex:0,nodey:0,depth:0}];for(;I.length>0;){const{idx:A,t:l,nodex:u,nodey:p,depth:m}=I.pop();if(this.leaves[A]){Lv(u,p,m,t,r,s,c,P,O);const C=1<<m,E=(u+0)/C,T=(u+1)/C,k=(p+0)/C,N=(p+1)/C,F=Al(E,k,this.dem)*g,$=Al(T,k,this.dem)*g,q=Al(T,N,this.dem)*g,Z=Al(E,N,this.dem)*g,X=Zu(P[0],P[1],F,O[0],P[1],$,O[0],O[1],q,d,f),K=Zu(O[0],O[1],q,P[0],O[1],Z,P[0],P[1],F,d,f),J=Math.min(null!==X?X:Number.MAX_VALUE,null!==K?K:Number.MAX_VALUE);if(J!==Number.MAX_VALUE)return J;{const st=dt.scaleAndAdd([],d,f,l);if(KP(F,$,Z,q,Rv(st[0],P[0],O[0]),Rv(st[1],P[1],O[1]))>=st[2])return l}continue}let v=0;for(let C=0;C<this._siblingOffset.length;C++){Lv((u<<1)+this._siblingOffset[C][0],(p<<1)+this._siblingOffset[C][1],m+1,t,r,s,c,P,O),P[2]=-100,O[2]=this.maximums[this.childOffsets[A]+C]*g;const E=Vo(P,O,d,f);if(null!=E){const T=E;b[C]=T;let k=!1;for(let N=0;N<v&&!k;N++)T>=b[w[N]]&&(w.splice(N,0,C),k=!0);k||(w[v]=C),v++}}for(let C=0;C<v;C++){const E=w[C];I.push({idx:this.childOffsets[A]+E,t:b[E],nodex:(u<<1)+this._siblingOffset[E][0],nodey:(p<<1)+this._siblingOffset[E][1],depth:m+1})}}return null}_addNode(t,r,s){return this.minimums.push(t),this.maximums.push(r),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(t,r,s,c,d){if(1===t[c].isLeaf(r,s))return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);const f=c-1,g=t[f];let y=0,b=0;for(let w=0;w<this._siblingOffset.length;w++){const P=2*r+this._siblingOffset[w][0],O=2*s+this._siblingOffset[w][1],I=g.getElevation(P,O),A=g.isLeaf(P,O),l=this._addNode(I.min,I.max,A);A&&(y|=1<<w),b||(b=l)}for(let w=0;w<this._siblingOffset.length;w++)y&1<<w||this._construct(t,2*r+this._siblingOffset[w][0],2*s+this._siblingOffset[w][1],f,b+w)}}function KP(e,t,r,s,c,d){return vn(vn(e,r,d),vn(t,s,d),c)}function Al(e,t,r){const s=r.dim,c=Ne(e*s-.5,0,s-1),d=Ne(t*s-.5,0,s-1),f=Math.floor(c),g=Math.floor(d),y=Math.min(f+1,s-1),b=Math.min(g+1,s-1);return KP(r.get(f,g),r.get(y,g),r.get(f,b),r.get(y,b),c-f,d-g)}const Dp={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Ex(e,t,r){return(256*e*256+256*t+r)/10-1e4}function kp(e,t,r){return 256*e+t+r/256-32768}class uc{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,r,s,c=!1){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(s&&"mapbox"!==s&&"terrarium"!==s)return gt(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const d=this.dim=r.height-2,f=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.floatView=new Float32Array(r.data.buffer),this.borderReady=c,this._modifiedForSources={},!c){for(let y=0;y<d;y++)f[this._idx(-1,y)]=f[this._idx(0,y)],f[this._idx(d,y)]=f[this._idx(d-1,y)],f[this._idx(y,-1)]=f[this._idx(y,0)],f[this._idx(y,d)]=f[this._idx(y,d-1)];f[this._idx(-1,-1)]=f[this._idx(0,0)],f[this._idx(d,-1)]=f[this._idx(d-1,0)],f[this._idx(-1,d)]=f[this._idx(0,d-1)],f[this._idx(d,d)]=f[this._idx(d-1,d-1)]}const g="terrarium"===s?kp:Ex;for(let y=0;y<f.length;++y){const b=4*y;this.floatView[y]=g(this.pixels[b],this.pixels[b+1],this.pixels[b+2])}this._timestamp=Mn.now()}_buildQuadTree(){this._tree=new qd(this)}get(t,r,s=!1){s&&(t=Ne(t,-1,this.dim),r=Ne(r,-1,this.dim));const c=this._idx(t,r);return this.floatView[c]}set(t,r,s){const c=this._idx(t,r),d=this.floatView[c];return this.floatView[c]=s,s-d}static getUnpackVector(t){return Dp[t]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}static pack(t,r){const s=[0,0,0,0],c=uc.getUnpackVector(r);let d=Math.floor((t+c[3])/c[2]);return s[2]=d%256,d=Math.floor(d/256),s[1]=d%256,d=Math.floor(d/256),s[0]=d,s}getPixels(){return new PT({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,r,s){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let c=r*this.dim,d=r*this.dim+this.dim,f=s*this.dim,g=s*this.dim+this.dim;switch(r){case-1:c=d-1;break;case 1:d=c+1}switch(s){case-1:f=g-1;break;case 1:g=f+1}const y=-r*this.dim,b=-s*this.dim;for(let w=f;w<g;w++)for(let P=c;P<d;P++){const O=4*this._idx(P,w),I=4*this._idx(P+y,w+b);this.pixels[O+0]=t.pixels[I+0],this.pixels[O+1]=t.pixels[I+1],this.pixels[O+2]=t.pixels[I+2],this.pixels[O+3]=t.pixels[I+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}De(uc,"DEMData"),De(qd,"DemMinMaxQuadTree",{omit:["dem"]});class Nv{isDataAvailableAtPoint(t){const r=this._source();if(this.isUsingMockSource()||!r||t.y<0||t.y>1)return!1;const s=r.getSource().maxzoom,c=1<<s,d=Math.floor(t.x),f=Math.floor((t.x-d)*c),g=Math.floor(t.y*c),y=this.findDEMTileFor(new Ir(s,d,s,f,g));return!(!y||!y.dem)}getAtPointOrZero(t,r=0){return this.getAtPoint(t,r)||0}getAtPoint(t,r,s=!0){if(this.isUsingMockSource())return null;null==r&&(r=null);const c=this._source();if(!c||t.y<0||t.y>1)return r;const d=c.getSource().maxzoom,f=1<<d,g=Math.floor(t.x),y=t.x-g,b=new Ir(d,g,d,Math.floor(y*f),Math.floor(t.y*f)),w=this.findDEMTileFor(b);if(!w||!w.dem)return r;const P=w.dem,O=1<<w.tileID.canonical.z,I=(y*O-w.tileID.canonical.x)*P.dim,A=(t.y*O-w.tileID.canonical.y)*P.dim,l=Math.floor(I),u=Math.floor(A);return(s?this.exaggeration():1)*vn(vn(P.get(l,u),P.get(l,u+1),A-u),vn(P.get(l+1,u),P.get(l+1,u+1),A-u),I-l)}getAtTileOffset(t,r,s){const c=1<<t.canonical.z;return this.getAtPointOrZero(new Xn(t.wrap+(t.canonical.x+r/Dt)/c,(t.canonical.y+s/Dt)/c))}getAtTileOffsetFunc(t,r,s,c){return d=>{const f=this.getAtTileOffset(t,d.x,d.y),g=c.upVector(t.canonical,d.x,d.y),y=c.upVectorScale(t.canonical,r,s).metersToTile;return dt.scale(g,g,f*y),g}}getForTilePoints(t,r,s,c){if(this.isUsingMockSource())return!1;const d=dc.create(this,t,c);return!!d&&(r.forEach(f=>{f[2]=this.exaggeration()*d.getElevationAt(f[0],f[1],s)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(t);if(!r||!r.dem)return null;const s=r.dem.tree,c=r.tileID,d=1<<t.canonical.z-c.canonical.z;let f=t.canonical.x/d-c.canonical.x,g=t.canonical.y/d-c.canonical.y,y=0;for(let b=0;b<t.canonical.z-c.canonical.z&&!s.leaves[y];b++){f*=2,g*=2;const w=2*Math.floor(g)+Math.floor(f);y=s.childOffsets[y]+w,f%=1,g%=1}return{min:this.exaggeration()*s.minimums[y],max:this.exaggeration()*s.maximums[y]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,r,s){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const t=this.visibleDemTiles;if(0===t.length)return null;let r=!1,s=Number.MAX_VALUE,c=Number.MIN_VALUE;for(const d of t){const f=this.getMinMaxForTile(d.tileID);f&&(s=Math.min(s,f.min),c=Math.max(c,f.max),r=!0)}return r?{min:s,max:c}:null}}class dc{constructor(t,r,s){this._demTile=t,this._dem=this._demTile.dem,this._scale=r,this._offset=s}static create(t,r,s){const c=s||t.findDEMTileFor(r);if(!c||!c.dem)return;const d=c.dem,f=c.tileID,g=1<<r.canonical.z-f.canonical.z;return new dc(c,d.dim/Dt/g,[(r.canonical.x/g-f.canonical.x)*d.dim,(r.canonical.y/g-f.canonical.y)*d.dim])}tileCoordToPixel(t,r){const s=r*this._scale+this._offset[1],c=Math.floor(t*this._scale+this._offset[0]),d=Math.floor(s);return new tt(c,d)}getElevationAt(t,r,s,c){const d=t*this._scale+this._offset[0],f=r*this._scale+this._offset[1],g=Math.floor(d),y=Math.floor(f),b=this._dem;return c=!!c,s?vn(vn(b.get(g,y,c),b.get(g,y+1,c),f-y),vn(b.get(g+1,y,c),b.get(g+1,y+1,c),f-y),d-g):b.get(g,y,c)}getElevationAtPixel(t,r,s){return this._dem.get(t,r,!!s)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*ii(1,t)*this._dem.stride}}class Fv{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Jl(Dt,16,0),this.featureIndexArray=new x0,this.promoteId=r}insert(t,r,s,c,d,f=0){const g=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,c,d,f);const y=this.grid;for(let b=0;b<r.length;b++){const w=r[b],P=[1/0,1/0,-1/0,-1/0];for(let O=0;O<w.length;O++){const I=w[O];P[0]=Math.min(P[0],I.x),P[1]=Math.min(P[1],I.y),P[2]=Math.max(P[2],I.x),P[3]=Math.max(P[3],I.y)}P[0]<Dt&&P[1]<Dt&&P[2]>=0&&P[3]>=0&&y.insert(g,P[0],P[1],P[2],P[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new wx(new Dv(this.rawTileData)).layers,this.sourceLayerCoder=new Cx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,r,s,c){this.loadVTLayers();const d=t.params||{},f=Ou(d.filter),g=t.tileResult,y=t.transform,b=g.bufferedTilespaceBounds,w=this.grid.query(b.min.x,b.min.y,b.max.x,b.max.y,(A,l,u,p)=>FP(g.bufferedTilespaceGeometry,A,l,u,p));w.sort(Kw);let P=null;y.elevation&&w.length>0&&(P=dc.create(y.elevation,this.tileID));const O={};let I;for(let A=0;A<w.length;A++){const l=w[A];if(l===I)continue;I=l;const u=this.featureIndexArray.get(l);let p=null;this.loadMatchingFeature(O,u,f,d.layers,d.availableImages,r,s,c,(m,v,C,E=0)=>(p||(p=Ei(m,this.tileID.canonical,t.tileTransform)),v.queryIntersectsFeature(g,m,C,p,this.z,t.transform,t.pixelPosMatrix,P,E)))}return O}loadMatchingFeature(t,r,s,c,d,f,g,y,b){const{featureIndex:w,bucketIndex:P,sourceLayerIndex:O,layoutVertexArrayOffset:I}=r,A=this.bucketLayerIDs[P];if(c&&!function(m,v){for(let C=0;C<m.length;C++)if(v.indexOf(m[C])>=0)return!0;return!1}(c,A))return;const l=this.sourceLayerCoder.decode(O),u=this.vtLayers[l].feature(w);if(s.needGeometry){const m=jc(u,!0);if(!s.filter(new Ri(this.tileID.overscaledZ),m,this.tileID.canonical))return}else if(!s.filter(new Ri(this.tileID.overscaledZ),u))return;const p=this.getId(u,l);for(let m=0;m<A.length;m++){const v=A[m];if(c&&c.indexOf(v)<0)continue;const C=f[v];if(!C)continue;let E={};void 0!==p&&y&&(E=y.getState(C.sourceLayer||"_geojsonTileLayer",p));const T=_t({},g[v]);T.paint=gf(T.paint,C.paint,u,E,d),T.layout=gf(T.layout,C.layout,u,E,d);const k=!b||b(u,C,E,I);if(!k)continue;const N=new ys(u,this.z,this.x,this.y,p);N.layer=T;let F=t[v];void 0===F&&(F=t[v]=[]),F.push({featureIndex:w,feature:N,intersectionZ:k})}}lookupSymbolFeatures(t,r,s,c,d,f,g,y){const b={};this.loadVTLayers();const w=Ou(d);for(const P of t)this.loadMatchingFeature(b,{bucketIndex:s,sourceLayerIndex:c,featureIndex:P,layoutVertexArrayOffset:0},w,f,g,y,r);return b}loadFeature(t){const{featureIndex:r,sourceLayerIndex:s}=t;this.loadVTLayers();const c=this.sourceLayerCoder.decode(s),d=this.vtFeatures[c];if(d[r])return d[r];const f=this.vtLayers[c].feature(r);return d[r]=f,f}hasLayer(t){for(const r of this.bucketLayerIDs)for(const s of r)if(t===s)return!0;return!1}getId(t,r){let s=t.id;if(this.promoteId){const c="string"==typeof this.promoteId?this.promoteId:this.promoteId[r];null!=c&&(s=t.properties[c]),"boolean"==typeof s&&(s=Number(s))}return s}}function gf(e,t,r,s,c){return hi(e,(d,f)=>{const g=t instanceof j?t.get(f):null;return g&&g.evaluate?g.evaluate(r,s,c):g})}function Kw(e,t){return t-e}De(Fv,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const qg=Dr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Zg=Dr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Yw=Dr([{name:"a_projected_pos",components:4,type:"Float32"}],4);Dr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const zv=Dr([{name:"a_z_offset",components:1,type:"Float32"}],4),YP=Dr([{name:"a_texb",components:2,type:"Uint16"}]),XP=Dr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Ox=Dr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);Dr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const j_=Dr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Xw=Dr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Dr([{name:"triangle",components:3,type:"Uint16"}]),Dr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Dr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Dr([{type:"Float32",name:"offsetX"}]),Dr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var is=24;const Wu=128;function Qw(e,t){const{expression:r}=t;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new Ri(e+1))};if("source"===r.kind)return{kind:"source"};{const{zoomStops:s,interpolationType:c}=r;let d=0;for(;d<s.length&&s[d]<=e;)d++;d=Math.max(0,d-1);let f=d;for(;f<s.length&&s[f]<e+1;)f++;f=Math.min(s.length-1,f);const g=s[d],y=s[f];return"composite"===r.kind?{kind:"composite",minZoom:g,maxZoom:y,interpolationType:c}:{kind:"camera",minZoom:g,maxZoom:y,minSize:r.evaluate(new Ri(g)),maxSize:r.evaluate(new Ri(y)),interpolationType:c}}}function Wg(e,{uSize:t,uSizeT:r},{lowerSize:s,upperSize:c}){return"source"===e.kind?s/Wu:"composite"===e.kind?vn(s/Wu,c/Wu,r):t}function co(e,t){let r=0,s=0;if("constant"===e.kind)s=e.layoutSize;else if("source"!==e.kind){const{interpolationType:c,minZoom:d,maxZoom:f}=e,g=c?Ne(Wa.interpolationFactor(c,t,d,f),0,1):0;"camera"===e.kind?s=vn(e.minSize,e.maxSize,g):r=g}return{uSizeT:r,uSize:s}}var ST=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Wu,evaluateSizeForFeature:Wg,evaluateSizeForZoom:co,getSizeData:Qw});function ao(e,t,r){return e.sections.forEach(s=>{s.text=function(c,d,f){const g=d.layout.get("text-transform").evaluate(f,{});return"uppercase"===g?c=c.toLocaleUpperCase():"lowercase"===g&&(c=c.toLocaleLowerCase()),tl.applyArabicShaping&&(c=tl.applyArabicShaping(c)),c}(s.text,t,r)}),e}const Hc={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function QP(e){return"\ufe36"===e||"\ufe48"===e||"\ufe38"===e||"\ufe44"===e||"\ufe42"===e||"\ufe3e"===e||"\ufe3c"===e||"\ufe3a"===e||"\ufe18"===e||"\ufe40"===e||"\ufe10"===e||"\ufe13"===e||"\ufe14"===e||"\uff40"===e||"\uffe3"===e||"\ufe11"===e||"\ufe12"===e}function Tx(e){return"\ufe35"===e||"\ufe47"===e||"\ufe37"===e||"\ufe43"===e||"\ufe41"===e||"\ufe3d"===e||"\ufe3b"===e||"\ufe39"===e||"\ufe17"===e||"\ufe3f"===e}const Rp=3;function Zd(e,t,r){t.glyphs=[],1===e&&r.readMessage($_,t)}function $_(e,t,r){if(3===e){const{id:s,bitmap:c,width:d,height:f,left:g,top:y,advance:b}=r.readMessage(xr,{});t.glyphs.push({id:s,bitmap:new cf({width:d+2*Rp,height:f+2*Rp},c),metrics:{width:d,height:f,left:g,top:y,advance:b}})}else 4===e?t.ascender=r.readSVarint():5===e&&(t.descender=r.readSVarint())}function xr(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}const vi=Rp,si={horizontal:1,vertical:2,horizontalOnly:3},ul=-17;class mf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){const s=new mf;return s.scale=t||1,s.fontStack=r,s}static forImage(t){const r=new mf;return r.imageName=t,r}}class qc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const s=new qc;for(let c=0;c<t.sections.length;c++){const d=t.sections[c];d.image?s.addImageSection(d):s.addTextSection(d,r)}return s}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(r,s){let c="";for(let d=0;d<r.length;d++){const f=r.charCodeAt(d+1)||null,g=r.charCodeAt(d-1)||null;c+=!s&&(f&&se(f)&&!Hc[r[d+1]]||g&&se(g)&&!Hc[r[d-1]])||!Hc[r[d]]?r[d]:Hc[r[d]]}return c}(this.text,t)}trim(){let t=0;for(let s=0;s<this.text.length&&Kd[this.text.charCodeAt(s)];s++)t++;let r=this.text.length;for(let s=this.text.length-1;s>=0&&s>=t&&Kd[this.text.charCodeAt(s)];s--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const s=new qc;return s.text=this.text.substring(t,r),s.sectionIndex=this.sectionIndex.slice(t,r),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}addTextSection(t,r){this.text+=t.text,this.sections.push(mf.forText(t.scale,t.fontStack||r));const s=this.sections.length-1;for(let c=0;c<t.text.length;++c)this.sectionIndex.push(s)}addImageSection(t){const r=t.image?t.image.namePrimary:"";if(0===r.length)return void gt("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCodePoint(s),this.sections.push(mf.forImage(r)),this.sectionIndex.push(this.sections.length-1)):gt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Wd(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A){const l=qc.fromFeature(e,c);P===si.vertical&&l.verticalizePunctuation(O);let u=[];const p=function(T,k,N,F,$,q){if(!T)return[];const Z=[],X=function(ot,rt,ct,yt,Ot,Tt){let zt=0;for(let Nt=0;Nt<ot.length();Nt++){const $t=ot.getSection(Nt);zt+=Lp(ot.getCodePoint(Nt),$t,yt,Ot,rt,Tt)}return zt/Math.max(1,Math.ceil(zt/ct))}(T,k,N,F,$,q),K=T.text.indexOf("\u200b")>=0;let J=0;for(let ot=0;ot<T.length();ot++){const rt=T.getSection(ot),ct=T.getCodePoint(ot);if(Kd[ct]||(J+=Lp(ct,rt,F,$,k,q)),ot<T.length()-1){const yt=!((st=ct)<11904||!(V["Bopomofo Extended"](st)||V.Bopomofo(st)||V["CJK Compatibility Forms"](st)||V["CJK Compatibility Ideographs"](st)||V["CJK Compatibility"](st)||V["CJK Radicals Supplement"](st)||V["CJK Strokes"](st)||V["CJK Symbols and Punctuation"](st)||V["CJK Unified Ideographs Extension A"](st)||V["CJK Unified Ideographs"](st)||V["Enclosed CJK Letters and Months"](st)||V["Halfwidth and Fullwidth Forms"](st)||V.Hiragana(st)||V["Ideographic Description Characters"](st)||V["Kangxi Radicals"](st)||V["Katakana Phonetic Extensions"](st)||V.Katakana(st)||V["Vertical Forms"](st)||V["Yi Radicals"](st)||V["Yi Syllables"](st)));(Kg[ct]||yt||rt.imageName)&&Z.push(Xg(ot+1,J,X,Z,G_(ct,T.getCodePoint(ot+1),yt&&K),!1))}}var st;return Np(Xg(T.length(),J,X,Z,0,!0))}(l,b,d,t,s,I),{processBidirectionalText:m,processStyledBidirectionalText:v}=tl;if(m&&1===l.sections.length){const T=m(l.toString(),p);for(const k of T){const N=new qc;N.text=k,N.sections=l.sections;for(let F=0;F<k.length;F++)N.sectionIndex.push(0);u.push(N)}}else if(v){const T=v(l.text,l.sectionIndex,p);for(const k of T){const N=new qc;N.text=k[0],N.sectionIndex=k[1],N.sections=l.sections,u.push(N)}}else u=function(T,k){const N=[],F=T.text;let $=0;for(const q of k)N.push(T.substring($,q)),$=q;return $<F.length&&N.push(T.substring($,F.length)),N}(l,p);const C=[],E={positionedLines:C,text:l.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(T,k,N,F,$,q,Z,X,K,J,st,ot){let rt=0,ct=0,yt=0;const Ot="right"===X?1:"left"===X?0:.5;let Tt=!1;for(const Ee of $){const Oe=Ee.getSections();for(const Be of Oe){if(Be.imageName)continue;const je=k[Be.fontStack];if(je&&(Tt=void 0!==je.ascender&&void 0!==je.descender,!Tt))break}if(!Tt)break}let zt=0;for(const Ee of $){Ee.trim();const Oe=Ee.getMaxScale(),Be=(Oe-1)*is,je={positionedGlyphs:[],lineOffset:0};T.positionedLines[zt]=je;const En=je.positionedGlyphs;let Qe=0;if(!Ee.length()){ct+=q,++zt;continue}let nr=0,ln=0;for(let On=0;On<Ee.length();On++){const mn=Ee.getSection(On),wr=Ee.getSectionIndex(On),Lr=Ee.getCodePoint(On);let rr=mn.scale,Kr=null,Si=null,gi=null,Ni=is,$o=0;const Io=!(K===si.horizontal||!st&&!Lt(Lr)||st&&(Kd[Lr]||(Nt=Lr,V.Arabic(Nt)||V["Arabic Supplement"](Nt)||V["Arabic Extended-A"](Nt)||V["Arabic Presentation Forms-A"](Nt)||V["Arabic Presentation Forms-B"](Nt))));if(mn.imageName){const Gi=F[mn.imageName];if(!Gi)continue;gi=mn.imageName,T.iconsInText=T.iconsInText||!0,Si=Gi.paddedRect;const Gr=Gi.displaySize;rr=rr*is/ot,Kr={width:Gr[0],height:Gr[1],left:0,top:-vi,advance:Io?Gr[1]:Gr[0],localGlyph:!1},$o=Tt?-Kr.height*rr:ul+Oe*is-Gr[1]*rr,Ni=Kr.advance;const So=(Io?Gr[0]:Gr[1])*rr-is*Oe;So>0&&So>Qe&&(Qe=So)}else{const Gi=N[mn.fontStack];if(!Gi)continue;Gi[Lr]&&(Si=Gi[Lr]);const Gr=k[mn.fontStack];if(!Gr)continue;const So=Gr.glyphs[Lr];if(!So)continue;if(Kr=So.metrics,Ni=8203!==Lr?is:0,Tt){const zf=void 0!==Gr.ascender?Math.abs(Gr.ascender):0,ls=void 0!==Gr.descender?Math.abs(Gr.descender):0,Rl=(zf+ls)*rr;nr<Rl&&(nr=Rl,ln=(zf-ls)/2*rr),$o=-zf*rr}else $o=ul+(Oe-rr)*is}Io?(T.verticalizable=!0,En.push({glyph:Lr,imageName:gi,x:rt,y:ct+$o,vertical:Io,scale:rr,localGlyph:Kr.localGlyph,fontStack:mn.fontStack,sectionIndex:wr,metrics:Kr,rect:Si}),rt+=Ni*rr+J):(En.push({glyph:Lr,imageName:gi,x:rt,y:ct+$o,vertical:Io,scale:rr,localGlyph:Kr.localGlyph,fontStack:mn.fontStack,sectionIndex:wr,metrics:Kr,rect:Si}),rt+=Kr.advance*rr+J)}0!==En.length&&(yt=Math.max(rt-J,yt),Tt?Ix(En,Ot,Qe,ln,q*Oe/2):Ix(En,Ot,Qe,0,q/2)),rt=0;const Ln=q*Oe+Qe;je.lineOffset=Math.max(Qe,Be),ct+=Ln,++zt}var Nt;const $t=ct,{horizontalAlign:Rt,verticalAlign:ie}=Bv(Z);(function(Ee,Oe,Be,je,En,Qe){const nr=(Oe-Be)*En,ln=-Qe*je;for(const Ln of Ee)for(const On of Ln.positionedGlyphs)On.x+=nr,On.y+=ln})(T.positionedLines,Ot,Rt,ie,yt,$t),T.top+=-ie*$t,T.bottom=T.top+$t,T.left+=-Rt*yt,T.right=T.left+yt,T.hasBaseline=Tt}(E,t,r,s,u,f,g,y,P,b,O,A),!function(T){for(const k of T)if(0!==k.positionedGlyphs.length)return!1;return!0}(C)&&E}const Kd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Kg={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Lp(e,t,r,s,c,d){if(t.imageName){const f=s[t.imageName];return f?f.displaySize[0]*t.scale*is/d+c:0}{const f=r[t.fontStack],g=f&&f.glyphs[e];return g?g.metrics.advance*t.scale+c:0}}function Yg(e,t,r,s){const c=Math.pow(e-t,2);return s?e<t?c/2:2*c:c+Math.abs(r)*r}function G_(e,t,r){let s=0;return 10===e&&(s-=1e4),r&&(s+=150),40!==e&&65288!==e||(s+=50),41!==t&&65289!==t||(s+=50),s}function Xg(e,t,r,s,c,d){let f=null,g=Yg(t,r,c,d);for(const y of s){const b=Yg(t-y.x,r,c,d)+y.badness;b<=g&&(f=y,g=b)}return{index:e,x:t,priorBreak:f,badness:g}}function Np(e){return e?Np(e.priorBreak).concat(e.index):[]}function Bv(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Ix(e,t,r,s,c){if(!(t||r||s||c))return;const d=e.length-1,f=e[d],g=(f.x+f.metrics.advance*f.scale)*t;for(let y=0;y<=d;y++)e[y].x-=g,e[y].y+=r+s+c}function JP(e,t,r,s){const{horizontalAlign:c,verticalAlign:d}=Bv(s),f=r[0]-e.displaySize[0]*c,g=r[1]-e.displaySize[1]*d;return{imagePrimary:e,imageSecondary:t,top:g,bottom:g+e.displaySize[1],left:f,right:f+e.displaySize[0]}}function Jw(e,t,r,s,c,d){const f=e.imagePrimary;let g;if(f.content){const u=f.content,p=f.pixelRatio||1;g=[u[0]/p,u[1]/p,f.displaySize[0]-u[2]/p,f.displaySize[1]-u[3]/p]}const y=t.left*d,b=t.right*d;let w,P,O,I;"width"===r||"both"===r?(I=c[0]+y-s[3],P=c[0]+b+s[1]):(I=c[0]+(y+b-f.displaySize[0])/2,P=I+f.displaySize[0]);const A=t.top*d,l=t.bottom*d;return"height"===r||"both"===r?(w=c[1]+A-s[0],O=c[1]+l+s[2]):(w=c[1]+(A+l-f.displaySize[1])/2,O=w+f.displaySize[1]),{imagePrimary:f,imageSecondary:void 0,top:w,right:P,bottom:O,left:I,collisionPadding:g}}class Yd extends tt{constructor(t,r,s,c,d){super(t,r),this.angle=c,this.z=s,void 0!==d&&(this.segment=d)}clone(){return new Yd(this.x,this.y,this.z,this.angle,this.segment)}}function Uv(e,t,r,s,c){if(void 0===t.segment)return!0;let d=t,f=t.segment+1,g=0;for(;g>-r/2;){if(f--,f<0)return!1;g-=e[f].dist(d),d=e[f]}g+=e[f].dist(e[f+1]),f++;const y=[];let b=0;for(;g<r/2;){const w=e[f],P=e[f+1];if(!P)return!1;let O=e[f-1].angleTo(w)-w.angleTo(P);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),y.push({distance:g,angleDelta:O}),b+=O;g-y[0].distance>s;)b-=y.shift().angleDelta;if(b>c)return!1;f++,g+=w.dist(P)}return!0}function _f(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Qg(e,t,r){return e?.6*t*r:0}function H_(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function q_(e,t,r,s,c,d){const f=Qg(r,c,d),g=H_(r,s)*d;let y=0;const b=_f(e)/2;for(let w=0;w<e.length-1;w++){const P=e[w],O=e[w+1],I=P.dist(O);if(y+I>b){const A=(b-y)/I,l=vn(P.x,O.x,A),u=vn(P.y,O.y,A),p=new Yd(l,u,0,O.angleTo(P),w);return!f||Uv(e,p,g,f,t)?p:void 0}y+=I}}function tE(e,t,r,s,c,d,f,g,y){const b=Qg(s,d,f),w=H_(s,c),P=w*f,O=0===e[0].x||e[0].x===y||0===e[0].y||e[0].y===y;return t-P<t/4&&(t=P+t/4),eE(e,O?t/2*g%t:(w/2+2*d)*f*g%t,t,b,r,P,O,!1,y)}function eE(e,t,r,s,c,d,f,g,y){const b=d/2,w=_f(e);let P=0,O=t-r,I=[];for(let A=0;A<e.length-1;A++){const l=e[A],u=e[A+1],p=l.dist(u),m=u.angleTo(l);for(;O+r<P+p;){O+=r;const v=(O-P)/p,C=vn(l.x,u.x,v),E=vn(l.y,u.y,v);if(C>=0&&C<y&&E>=0&&E<y&&O-b>=0&&O+b<=w){const T=new Yd(C,E,0,m,A);s&&!Uv(e,T,d,s,c)||I.push(T)}}P+=p}return g||I.length||f||(I=eE(e,P/2,r,s,c,d,f,!0,y)),I}function yf(e,t,r,s,c){const d=[];for(let f=0;f<e.length;f++){const g=e[f];let y;for(let b=0;b<g.length-1;b++){let w=g[b],P=g[b+1];w.x<t&&P.x<t||(w.x<t?w=new tt(t,w.y+(t-w.x)/(P.x-w.x)*(P.y-w.y))._round():P.x<t&&(P=new tt(t,w.y+(t-w.x)/(P.x-w.x)*(P.y-w.y))._round()),w.y<r&&P.y<r||(w.y<r?w=new tt(w.x+(r-w.y)/(P.y-w.y)*(P.x-w.x),r)._round():P.y<r&&(P=new tt(w.x+(r-w.y)/(P.y-w.y)*(P.x-w.x),r)._round()),w.x>=s&&P.x>=s||(w.x>=s?w=new tt(s,w.y+(s-w.x)/(P.x-w.x)*(P.y-w.y))._round():P.x>=s&&(P=new tt(s,w.y+(s-w.x)/(P.x-w.x)*(P.y-w.y))._round()),w.y>=c&&P.y>=c||(w.y>=c?w=new tt(w.x+(c-w.y)/(P.y-w.y)*(P.x-w.x),c)._round():P.y>=c&&(P=new tt(w.x+(c-w.y)/(P.y-w.y)*(P.x-w.x),c)._round()),y&&w.equals(y[y.length-1])||(y=[w],d.push(y)),y.push(P)))))}}return d}function Sx(e){let t=0,r=0;for(const f of e)t+=f.w*f.h,r=Math.max(r,f.w);e.sort((f,g)=>g.h-f.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let c=0,d=0;for(const f of e)for(let g=s.length-1;g>=0;g--){const y=s[g];if(!(f.w>y.w||f.h>y.h)){if(f.x=y.x,f.y=y.y,d=Math.max(d,f.y+f.h),c=Math.max(c,f.x+f.w),f.w===y.w&&f.h===y.h){const b=s.pop();g<s.length&&(s[g]=b)}else f.h===y.h?(y.x+=f.w,y.w-=f.w):f.w===y.w?(y.y+=f.h,y.h-=f.h):(s.push({x:y.x+f.w,y:y.y,w:y.w-f.w,h:f.h}),y.y+=f.h,y.h-=f.h);break}}return{w:c,h:d,fill:t/(c*d)||0}}De(Yd,"Anchor");const Bs=1;class tC{constructor(t,{pixelRatio:r,version:s,stretchX:c,stretchY:d,content:f}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=c,this.stretchY=d,this.content=f,this.version=s}get tl(){return[this.paddedRect.x+Bs,this.paddedRect.y+Bs]}get br(){return[this.paddedRect.x+this.paddedRect.w-Bs,this.paddedRect.y+this.paddedRect.h-Bs]}get displaySize(){return[(this.paddedRect.w-2*Bs)/this.pixelRatio,(this.paddedRect.h-2*Bs)/this.pixelRatio]}}class Ax{constructor(t,r){const s={},c={};this.haveRenderCallbacks=[];const d=[];this.addImages(t,s,d),this.addImages(r,c,d);const{w:f,h:g}=Sx(d),y=new Uo({width:f||1,height:g||1});for(const b in t){const w=t[b],P=s[b].paddedRect;Uo.copy(w.data,y,{x:0,y:0},{x:P.x+Bs,y:P.y+Bs},w.data)}for(const b in r){const w=r[b],P=c[b].paddedRect,O=P.x+Bs,I=P.y+Bs,A=w.data.width,l=w.data.height;Uo.copy(w.data,y,{x:0,y:0},{x:O,y:I},w.data),Uo.copy(w.data,y,{x:0,y:l-1},{x:O,y:I-1},{width:A,height:1}),Uo.copy(w.data,y,{x:0,y:0},{x:O,y:I+l},{width:A,height:1}),Uo.copy(w.data,y,{x:A-1,y:0},{x:O-1,y:I},{width:1,height:l}),Uo.copy(w.data,y,{x:0,y:0},{x:O+A,y:I},{width:1,height:l})}this.image=y,this.iconPositions=s,this.patternPositions=c}addImages(t,r,s){for(const c in t){const d=t[c],f={x:0,y:0,w:d.data.width+2*Bs,h:d.data.height+2*Bs};s.push(f),r[c]=new tC(f,d),d.hasRenderCallback&&this.haveRenderCallbacks.push(c)}}patchUpdatedImages(t,r,s){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>t.hasImage(c,s)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,s);for(const c in t.getUpdatedImages(s))this.patchUpdatedImage(this.iconPositions[c],t.getImage(c,s),r),this.patchUpdatedImage(this.patternPositions[c],t.getImage(c,s),r)}patchUpdatedImage(t,r,s){if(!t||!r||t.version===r.version)return;t.version=r.version;const[c,d]=t.tl;s.update(r.data,void 0,{x:c,y:d})}}De(tC,"ImagePosition"),De(Ax,"ImageAtlas");const Jg=1e20;function Dx(e,t,r,s,c,d,f,g,y){for(let b=t;b<t+s;b++)Fp(e,r*d+b,d,c,f,g,y);for(let b=r;b<r+c;b++)Fp(e,b*d+t,1,s,f,g,y)}function Fp(e,t,r,s,c,d,f){d[0]=0,f[0]=-Jg,f[1]=Jg,c[0]=e[t];for(let g=1,y=0,b=0;g<s;g++){c[g]=e[t+g*r];const w=g*g;do{const P=d[y];b=(c[g]-c[P]+w-P*P)/(g-P)/2}while(b<=f[y]&&--y>-1);y++,d[y]=g,f[y]=b,f[y+1]=Jg}for(let g=0,y=0;g<s;g++){for(;f[y+1]<g;)y++;const b=d[y],w=g-b;e[t+g*r]=c[b]+w*w}}const To=2;class Xd{constructor(t,r,s){this.requestManager=t,this.localGlyphMode=r,this.localFontFamily=s,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,r){this.urls[r]=t}getGlyphs(t,r,s){const c=[],d=this.urls[r]||ue.GLYPHS_URL;for(const f in t)for(const g of t[f])c.push({stack:f,id:g});Kt(c,({stack:f,id:g},y)=>{let b=this.entries[f];b||(b=this.entries[f]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=b.glyphs[g];if(void 0!==w)return void y(null,{stack:f,id:g,glyph:w});if(w=this._tinySDF(b,f,g),w)return b.glyphs[g]=w,void y(null,{stack:f,id:g,glyph:w});const P=Math.floor(g/256);if(256*P>65535)return void y(new Error("glyphs > 65535 not supported"));if(b.ranges[P])return void y(null,{stack:f,id:g,glyph:w});let O=b.requests[P];O||(O=b.requests[P]=[],Xd.loadGlyphRange(f,P,d,this.requestManager,(I,A)=>{if(A){b.ascender=A.ascender,b.descender=A.descender;for(const l in A.glyphs)this._doesCharSupportLocalGlyph(+l)||(b.glyphs[+l]=A.glyphs[+l]);b.ranges[P]=!0}for(const l of O)l(I,A);delete b.requests[P]})),O.push((I,A)=>{I?y(I):A&&y(null,{stack:f,id:g,glyph:A.glyphs[g]||null})})},(f,g)=>{if(f)s(f);else if(g){const y={};for(const{stack:b,id:w,glyph:P}of g)void 0===y[b]&&(y[b]={}),void 0===y[b].glyphs&&(y[b].glyphs={}),y[b].glyphs[w]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics},y[b].ascender=this.entries[b].ascender,y[b].descender=this.entries[b].descender;s(null,y)}})}_doesCharSupportLocalGlyph(t){return 0!==this.localGlyphMode&&(2===this.localGlyphMode?!!this.localFontFamily:!!this.localFontFamily&&(V["CJK Unified Ideographs"](t)||V["Hangul Syllables"](t)||V.Hiragana(t)||V.Katakana(t)||V["CJK Symbols and Punctuation"](t)||V["CJK Unified Ideographs Extension A"](t)||V["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,r,s){const c=this.localFontFamily;if(!c||!this._doesCharSupportLocalGlyph(s))return;let d=t.tinySDF;if(!d){let l="400";/bold/i.test(r)?l="900":/medium/i.test(r)?l="500":/light/i.test(r)&&(l="200"),d=t.tinySDF=new Xd.TinySDF({fontFamily:c,fontWeight:l,fontSize:24*To,buffer:3*To,radius:8*To}),d.fontWeight=l}if(this.localGlyphs[d.fontWeight][s])return this.localGlyphs[d.fontWeight][s];const f=String.fromCodePoint(s),{data:g,width:y,height:b,glyphWidth:w,glyphHeight:P,glyphLeft:O,glyphTop:I,glyphAdvance:A}=d.draw(f);return this.localGlyphs[d.fontWeight][s]={id:s,bitmap:new cf({width:y,height:b},g),metrics:{width:w/To,height:P/To,left:O/To,top:I/To-27,advance:A/To,localGlyph:!0}}}}Xd.loadGlyphRange=function(e,t,r,s,c){const d=256*t,f=d+255,g=s.transformRequest(s.normalizeGlyphsURL(r).replace("{fontstack}",e).replace("{range}",`${d}-${f}`),Ft.Glyphs);ve(g,(y,b)=>{if(y)c(y);else if(b){const w={},P=new Dv(b).readFields(Zd,{});for(const O of P.glyphs)w[O.id]=O;c(null,{glyphs:w,ascender:P.ascender,descender:P.descender})}})},Xd.TinySDF=class{constructor({fontSize:e=24,buffer:t=3,radius:r=8,cutoff:s=.25,fontFamily:c="sans-serif",fontWeight:d="normal",fontStyle:f="normal"}={}){this.buffer=t,this.cutoff=s,this.radius=r;const g=this.size=e+4*t,y=this._createCanvas(g),b=this.ctx=y.getContext("2d",{willReadFrequently:!0});b.font=`${f} ${d} ${e}px ${c}`,b.textBaseline="alphabetic",b.textAlign="left",b.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Uint16Array(g)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:s,actualBoundingBoxLeft:c,actualBoundingBoxRight:d}=this.ctx.measureText(e),f=Math.ceil(r),g=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-c))),y=Math.min(this.size-this.buffer,f+Math.ceil(s)),b=g+2*this.buffer,w=y+2*this.buffer,P=Math.max(b*w,0),O=new Uint8ClampedArray(P),I={data:O,width:b,height:w,glyphWidth:g,glyphHeight:y,glyphTop:f,glyphLeft:0,glyphAdvance:t};if(0===g||0===y)return I;const{ctx:A,buffer:l,gridInner:u,gridOuter:p}=this;A.clearRect(l,l,g,y),A.fillText(e,l,l+f);const m=A.getImageData(l,l,g,y);p.fill(Jg,0,P),u.fill(0,0,P);for(let v=0;v<y;v++)for(let C=0;C<g;C++){const E=m.data[4*(v*g+C)+3]/255;if(0===E)continue;const T=(v+l)*b+C+l;if(1===E)p[T]=0,u[T]=Jg;else{const k=.5-E;p[T]=k>0?k*k:0,u[T]=k<0?k*k:0}}Dx(p,0,0,b,w,b,this.f,this.v,this.z),Dx(u,l,l,g,y,b,this.f,this.v,this.z);for(let v=0;v<P;v++){const C=Math.sqrt(p[v])-Math.sqrt(u[v]);O[v]=Math.round(255-255*(C/this.radius+this.cutoff))}return I}};const dl=Bs;function zp(e,t,r,s){const c=[],d=e.imagePrimary,f=d.pixelRatio,g=d.paddedRect.w-2*dl,y=d.paddedRect.h-2*dl,b=e.right-e.left,w=e.bottom-e.top,P=d.stretchX||[[0,g]],O=d.stretchY||[[0,y]],I=(q,Z)=>q+Z[1]-Z[0],A=P.reduce(I,0),l=O.reduce(I,0),u=g-A,p=y-l;let m=0,v=A,C=0,E=l,T=0,k=u,N=0,F=p;if(d.content&&s){const q=d.content;m=Bp(P,0,q[0]),C=Bp(O,0,q[1]),v=Bp(P,q[0],q[2]),E=Bp(O,q[1],q[3]),T=q[0]-m,N=q[1]-C,k=q[2]-q[0]-v,F=q[3]-q[1]-E}const $=(q,Z,X,K)=>{const J=Zc(q.stretch-m,v,b,e.left),st=Z_(q.fixed-T,k,q.stretch,A),ot=Zc(Z.stretch-C,E,w,e.top),rt=Z_(Z.fixed-N,F,Z.stretch,l),ct=Zc(X.stretch-m,v,b,e.left),yt=Z_(X.fixed-T,k,X.stretch,A),Ot=Zc(K.stretch-C,E,w,e.top),Tt=Z_(K.fixed-N,F,K.stretch,l),zt=new tt(J,ot),Nt=new tt(ct,ot),$t=new tt(ct,Ot),Rt=new tt(J,Ot),ie=new tt(st/f,rt/f),Ee=new tt(yt/f,Tt/f),Oe=t*Math.PI/180;if(Oe){const ln=Math.sin(Oe),Ln=Math.cos(Oe),On=[Ln,-ln,ln,Ln];zt._matMult(On),Nt._matMult(On),Rt._matMult(On),$t._matMult(On)}const Be=q.stretch+q.fixed,je=X.stretch+X.fixed,En=Z.stretch+Z.fixed,Qe=K.stretch+K.fixed,nr=e.imageSecondary;return{tl:zt,tr:Nt,bl:Rt,br:$t,texPrimary:{x:d.paddedRect.x+dl+Be,y:d.paddedRect.y+dl+En,w:je-Be,h:Qe-En},texSecondary:nr?{x:nr.paddedRect.x+dl+Be,y:nr.paddedRect.y+dl+En,w:je-Be,h:Qe-En}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ie,pixelOffsetBR:Ee,minFontScaleX:k/f/b,minFontScaleY:F/f/w,isSDF:r}};if(s&&(d.stretchX||d.stretchY)){const q=Vv(P,u,A),Z=Vv(O,p,l);for(let X=0;X<q.length-1;X++){const K=q[X],J=q[X+1];for(let st=0;st<Z.length-1;st++)c.push($(K,Z[st],J,Z[st+1]))}}else c.push($({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:g+1},{fixed:0,stretch:y+1}));return c}function Bp(e,t,r){let s=0;for(const c of e)s+=Math.max(t,Math.min(r,c[1]))-Math.max(t,Math.min(r,c[0]));return s}function Vv(e,t,r){const s=[{fixed:-dl,stretch:0}];for(const[c,d]of e){const f=s[s.length-1];s.push({fixed:c-f.stretch,stretch:f.stretch}),s.push({fixed:c-f.stretch,stretch:f.stretch+(d-c)})}return s.push({fixed:t+dl,stretch:r}),s}function Zc(e,t,r,s){return e/t*r+s}function Z_(e,t,r,s){return e-t*r/s}function nE(e,t,r,s){const c=t+e.positionedLines[s].lineOffset;return 0===s?r+c/2:r+(c+(t+e.positionedLines[s-1].lineOffset))/2}function jv(e,t=1,r=!1){let s=1/0,c=1/0,d=-1/0,f=-1/0;const g=e[0];for(let I=0;I<g.length;I++){const A=g[I];(!I||A.x<s)&&(s=A.x),(!I||A.y<c)&&(c=A.y),(!I||A.x>d)&&(d=A.x),(!I||A.y>f)&&(f=A.y)}const y=Math.min(d-s,f-c);let b=y/2;const w=new Ch([],vf);if(0===y)return new tt(s,c);for(let I=s;I<d;I+=y)for(let A=c;A<f;A+=y)w.push(new W_(I+b,A+b,b,e));let P=function(I){let A=0,l=0,u=0;const p=I[0];for(let m=0,v=p.length,C=v-1;m<v;C=m++){const E=p[m],T=p[C],k=E.x*T.y-T.x*E.y;l+=(E.x+T.x)*k,u+=(E.y+T.y)*k,A+=3*k}return new W_(l/A,u/A,0,I)}(e),O=w.length;for(;w.length;){const I=w.pop();(I.d>P.d||!P.d)&&(P=I,r&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,O)),I.max-P.d<=t||(b=I.h/2,w.push(new W_(I.p.x-b,I.p.y-b,b,e)),w.push(new W_(I.p.x+b,I.p.y-b,b,e)),w.push(new W_(I.p.x-b,I.p.y+b,b,e)),w.push(new W_(I.p.x+b,I.p.y+b,b,e)),O+=4)}return r&&(console.log(`num probes: ${O}`),console.log(`best distance: ${P.d}`)),P.p}function vf(e,t){return t.max-e.max}class W_{constructor(t,r,s,c){this.p=new tt(t,r),this.h=s,this.d=function(d,f){let g=!1,y=1/0;for(let b=0;b<f.length;b++){const w=f[b];for(let P=0,O=w.length,I=O-1;P<O;I=P++){const A=w[P],l=w[I];A.y>d.y!=l.y>d.y&&d.x<(l.x-A.x)*(d.y-A.y)/(l.y-A.y)+A.x&&(g=!g),y=Math.min(y,Bw(d,A,l))}}return(g?1:-1)*Math.sqrt(y)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}}const Us=7,kx=Number.POSITIVE_INFINITY,tm=Math.sqrt(2);function em(e,[t,r]){let s=0,c=0;if(r===kx){t<0&&(t=0);const d=t/tm;switch(e){case"top-right":case"top-left":c=d-Us;break;case"bottom-right":case"bottom-left":c=-d+Us;break;case"bottom":c=-t+Us;break;case"top":c=t-Us}switch(e){case"top-right":case"bottom-right":s=-d;break;case"top-left":case"bottom-left":s=d;break;case"left":s=t;break;case"right":s=-t}}else{switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":c=r-Us;break;case"bottom-right":case"bottom-left":case"bottom":c=-r+Us}switch(e){case"top-right":case"bottom-right":case"right":s=-t;break;case"top-left":case"bottom-left":case"left":s=t}}return[s,c]}function hc(e,t,r,s,c,d,f,g,y,b,w){e.createArrays(),e.tilePixelRatio=Dt/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;const P=e.layers[0].layout,O=e.layers[0]._unevaluatedLayout._values,I={};if("composite"===e.textSizeData.kind){const{minZoom:p,maxZoom:m}=e.textSizeData;I.compositeTextSizes=[O["text-size"].possiblyEvaluate(new Ri(p),g),O["text-size"].possiblyEvaluate(new Ri(m),g)]}if("composite"===e.iconSizeData.kind){const{minZoom:p,maxZoom:m}=e.iconSizeData;I.compositeIconSizes=[O["icon-size"].possiblyEvaluate(new Ri(p),g),O["icon-size"].possiblyEvaluate(new Ri(m),g)]}I.layoutTextSize=O["text-size"].possiblyEvaluate(new Ri(y+1),g),I.layoutIconSize=O["icon-size"].possiblyEvaluate(new Ri(y+1),g),I.textMaxSize=O["text-size"].possiblyEvaluate(new Ri(18),g);const A="map"===P.get("text-rotation-alignment")&&"point"!==P.get("symbol-placement"),l=P.get("text-size");let u=!1;for(const p of e.features)if(p.icon&&p.icon.nameSecondary){u=!0;break}for(const p of e.features){const m=P.get("text-font").evaluate(p,{},g).join(","),v=l.evaluate(p,{},g),C=I.layoutTextSize.evaluate(p,{},g),E=(I.layoutIconSize.evaluate(p,{},g),{horizontal:{},vertical:void 0}),T=p.text;let k,N=[0,0];if(T){const q=T.toString(),Z=P.get("text-letter-spacing").evaluate(p,{},g)*is,X=P.get("text-line-height").evaluate(p,{},g)*is,K=ut(q)?Z:0,J=P.get("text-anchor").evaluate(p,{},g),st=P.get("text-variable-anchor");if(!st){const Ot=P.get("text-radial-offset").evaluate(p,{},g);N=Ot?em(J,[Ot*is,kx]):P.get("text-offset").evaluate(p,{},g).map(Tt=>Tt*is)}let ot=A?"center":P.get("text-justify").evaluate(p,{},g);const rt="point"===P.get("symbol-placement"),ct=rt?P.get("text-max-width").evaluate(p,{},g)*is:1/0,yt=Ot=>{e.allowVerticalPlacement&&W(q)&&(E.vertical=Wd(T,t,r,c,m,ct,X,J,Ot,K,N,si.vertical,!0,C,v))};if(!A&&st){const Ot="auto"===ot?st.map(zt=>eC(zt)):[ot];let Tt=!1;for(let zt=0;zt<Ot.length;zt++){const Nt=Ot[zt];if(!E.horizontal[Nt])if(Tt)E.horizontal[Nt]=E.horizontal[0];else{const $t=Wd(T,t,r,c,m,ct,X,"center",Nt,K,N,si.horizontal,!1,C,v);$t&&(E.horizontal[Nt]=$t,Tt=1===$t.positionedLines.length)}}yt("left")}else{if("auto"===ot&&(ot=eC(J)),rt||P.get("text-writing-mode").indexOf("horizontal")>=0||!W(q)){const Ot=Wd(T,t,r,c,m,ct,X,J,ot,K,N,si.horizontal,!1,C,v);Ot&&(E.horizontal[ot]=Ot)}yt(rt?"left":ot)}}let F=!1;if(p.icon&&p.icon.namePrimary){const q=s[p.icon.namePrimary];q&&(k=JP(c[p.icon.namePrimary],p.icon.nameSecondary?c[p.icon.nameSecondary]:void 0,P.get("icon-offset").evaluate(p,{},g),P.get("icon-anchor").evaluate(p,{},g)),F=q.sdf,void 0===e.sdfIcons?e.sdfIcons=q.sdf:e.sdfIcons!==q.sdf&&gt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(q.pixelRatio!==e.pixelRatio||0!==P.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}const $=nC(E.horizontal)||E.vertical;e.iconsInText||(e.iconsInText=!!$&&$.iconsInText),($||k)&&$v(e,p,E,k,s,I,C,0,N,F,f,g,b,w,u)}d&&e.generateCollisionDebugBuffers(y,e.collisionBoxArray)}function eC(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function $v(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A){let l=d.textMaxSize.evaluate(t,{},P);void 0===l&&(l=f);const u=e.layers[0].layout,p=u.get("icon-offset").evaluate(t,{},P),m=nC(r.horizontal)||r.vertical,v="globe"===O.name,C=is,E=f/C,T=e.tilePixelRatio*l/C,k=(J=e.overscaling,e.zoom>18&&J>2&&(J>>=1),Math.max(Dt/(512*J),1)*u.get("symbol-spacing")),N=u.get("text-padding")*e.tilePixelRatio,F=u.get("icon-padding")*e.tilePixelRatio,$=Ct(u.get("text-max-angle")),q="map"===u.get("text-rotation-alignment")&&"point"!==u.get("symbol-placement"),Z="map"===u.get("icon-rotation-alignment")&&"point"!==u.get("symbol-placement"),X=u.get("symbol-placement"),K=k/2;var J;const st=u.get("icon-text-fit").evaluate(t,{},P),ot=u.get("icon-text-fit-padding").evaluate(t,{},P),rt="none"!==st;let ct;!1===e.hasAnyIconTextFit&&rt&&(e.hasAnyIconTextFit=!0),s&&rt&&(e.allowVerticalPlacement&&r.vertical&&(ct=Jw(s,r.vertical,st,ot,p,E)),m&&(s=Jw(s,m,st,ot,p,E)));const yt=(Ot,Tt,zt)=>{if(Tt.x<0||Tt.x>=Dt||Tt.y<0||Tt.y>=Dt)return;let Nt=null;if(v){const{x:$t,y:Rt,z:ie}=O.projectTilePoint(Tt.x,Tt.y,zt);Nt={anchor:new Yd($t,Rt,ie,0,void 0),up:O.upVector(zt,Tt.x,Tt.y)}}!function($t,Rt,ie,Ee,Oe,Be,je,En,Qe,nr,ln,Ln,On,mn,wr,Lr,rr,Kr,Si,gi,Ni,$o,Io,Gi,Gr,So,zf){const ls=$t.addToLineVertexArray(Rt,Ee);let Rl,zM,BM,UM,SI,AI,DI,kI=0,RI=0,LI=0,NI=0,rw=-1,BO=-1;const Bf={};let FI=nl("");const Ly=ie?ie.anchor:Rt,zI="none"!==Qe.layout.get("icon-text-fit").evaluate(Ni,{},Gr);let UO=0,VO=0;if(void 0===Qe._unevaluatedLayout.getValue("text-radial-offset")?[UO,VO]=Qe.layout.get("text-offset").evaluate(Ni,{},Gr).map(bc=>bc*is):(UO=Qe.layout.get("text-radial-offset").evaluate(Ni,{},Gr)*is,VO=kx),$t.allowVerticalPlacement&&Oe.vertical){const bc=Oe.vertical;if(wr)AI=Rx(bc),En&&(DI=Rx(En));else{const xc=Qe.layout.get("text-rotate").evaluate(Ni,{},Gr)+90;BM=K_(nr,Ly,Rt,ln,Ln,On,bc,mn,xc,Lr),En&&(UM=K_(nr,Ly,Rt,ln,Ln,On,En,Kr,xc))}}if(Be){const bc=Qe.layout.get("icon-rotate").evaluate(Ni,{},Gr),xc=zp(Be,bc,Io,zI),r0=En?zp(En,bc,Io,zI):void 0;zM=K_(nr,Ly,Rt,ln,Ln,On,Be,Kr,bc),kI=4*xc.length;const $O=$t.iconSizeData;let rg=null;"source"===$O.kind?(rg=[Wu*Qe.layout.get("icon-size").evaluate(Ni,{},Gr)],rg[0]>Qd&&gt(`${$t.layerIds[0]}: Value for "icon-size" is >= ${Gv}. Reduce your "icon-size".`)):"composite"===$O.kind&&(rg=[Wu*$o.compositeIconSizes[0].evaluate(Ni,{},Gr),Wu*$o.compositeIconSizes[1].evaluate(Ni,{},Gr)],(rg[0]>Qd||rg[1]>Qd)&&gt(`${$t.layerIds[0]}: Value for "icon-size" is >= ${Gv}. Reduce your "icon-size".`)),$t.addSymbols($t.icon,xc,rg,gi,Si,Ni,!1,ie,Rt,ls.lineStartIndex,ls.lineLength,-1,Gi,Gr,So,zf),rw=$t.icon.placedSymbolArray.length-1,r0&&(RI=4*r0.length,$t.addSymbols($t.icon,r0,rg,gi,Si,Ni,si.vertical,ie,Rt,ls.lineStartIndex,ls.lineLength,-1,Gi,Gr,So,zf),BO=$t.icon.placedSymbolArray.length-1)}for(const bc in Oe.horizontal){const xc=Oe.horizontal[bc];Rl||(FI=nl(xc.text),wr?SI=Rx(xc):Rl=K_(nr,Ly,Rt,ln,Ln,On,xc,mn,Qe.layout.get("text-rotate").evaluate(Ni,{},Gr),Lr));const r0=1===xc.positionedLines.length;if(LI+=Hr($t,ie,Rt,xc,je,Qe,wr,Ni,Lr,ls,Oe.vertical?si.horizontal:si.horizontalOnly,r0?Object.keys(Oe.horizontal):[bc],Bf,rw,$o,Gi,Gr,So),r0)break}Oe.vertical&&(NI+=Hr($t,ie,Rt,Oe.vertical,je,Qe,wr,Ni,Lr,ls,si.vertical,["vertical"],Bf,BO,$o,Gi,Gr,So));let ng=-1;const jO=(bc,xc)=>bc?Math.max(bc,xc):xc;ng=jO(SI,ng),ng=jO(AI,ng),ng=jO(DI,ng);const BI=ng>-1?1:0;$t.glyphOffsetArray.length>=xf.MAX_GLYPHS&&gt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Ni.sortKey&&$t.addToSortKeyRanges($t.symbolInstances.length,Ni.sortKey),$t.symbolInstances.emplaceBack(Rt.x,Rt.y,Ly.x,Ly.y,Ly.z,Bf.right>=0?Bf.right:-1,Bf.center>=0?Bf.center:-1,Bf.left>=0?Bf.left:-1,Bf.vertical>=0?Bf.vertical:-1,rw,BO,FI,void 0!==Rl?Rl:$t.collisionBoxArray.length,void 0!==Rl?Rl+1:$t.collisionBoxArray.length,void 0!==BM?BM:$t.collisionBoxArray.length,void 0!==BM?BM+1:$t.collisionBoxArray.length,void 0!==zM?zM:$t.collisionBoxArray.length,void 0!==zM?zM+1:$t.collisionBoxArray.length,UM||$t.collisionBoxArray.length,UM?UM+1:$t.collisionBoxArray.length,ln,LI,NI,kI,RI,BI,0,UO,VO,ng,0,zI?1:0)}(e,Tt,Nt,Ot,r,s,c,ct,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,N,q,y,0,F,Z,p,t,d,b,w,P,I,A)};if("line"===X)for(const Ot of yf(t.geometry,0,0,Dt,Dt)){const Tt=tE(Ot,k,$,r.vertical||m,s,C,T,e.overscaling,Dt);for(const zt of Tt)m&&rC(e,m.text,K,zt)||yt(Ot,zt,P)}else if("line-center"===X){for(const Ot of t.geometry)if(Ot.length>1){const Tt=q_(Ot,$,r.vertical||m,s,C,T);Tt&&yt(Ot,Tt,P)}}else if("Polygon"===t.type)for(const Ot of Vg(t.geometry,0)){const Tt=jv(Ot,16);yt(Ot[0],new Yd(Tt.x,Tt.y,0,0,void 0),P)}else if("LineString"===t.type)for(const Ot of t.geometry)yt(Ot,new Yd(Ot[0].x,Ot[0].y,0,0,void 0),P);else if("Point"===t.type)for(const Ot of t.geometry)for(const Tt of Ot)yt([Tt],new Yd(Tt.x,Tt.y,0,0,void 0),P)}const Gv=255,Qd=Gv*Wu;function Hr(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p){const m=function(E,T,k,N,F,$,q,Z){const X=[];if(0===T.positionedLines.length)return X;const K=N.layout.get("text-rotate").evaluate($,{})*Math.PI/180,J=function(yt){const Ot=yt[0],Tt=yt[1],zt=Ot*Tt;return zt>0?[Ot,-Tt]:zt<0?[-Ot,Tt]:0===Ot?[Tt,Ot]:[Tt,-Ot]}(k);let st=Math.abs(T.top-T.bottom);for(const yt of T.positionedLines)st-=yt.lineOffset;const ot=T.positionedLines.length,rt=st/ot;let ct=T.top-k[1];for(let yt=0;yt<ot;++yt){const Ot=T.positionedLines[yt];ct=nE(T,rt,ct,yt);for(const Tt of Ot.positionedGlyphs){if(!Tt.rect)continue;const zt=Tt.rect||{};let Nt=vi+1,$t=!0,Rt=1,ie=0;if(Tt.imageName){const gi=q[Tt.imageName];if(!gi)continue;if(gi.sdf){gt("SDF images are not supported in formatted text and will be ignored.");continue}$t=!1,Rt=gi.pixelRatio,Nt=Bs/Rt}const Ee=(F||Z)&&Tt.vertical,Oe=Tt.metrics.advance*Tt.scale/2,Be=Tt.metrics,je=Tt.rect;if(null===je)continue;Z&&T.verticalizable&&(ie=Tt.imageName?Oe-Tt.metrics.width*Tt.scale/2:0);const En=F?[Tt.x+Oe,Tt.y]:[0,0];let Qe=[0,0],nr=[0,0],ln=!1;F||(Ee?(nr=[Tt.x+Oe+J[0],Tt.y+J[1]-ie],ln=!0):Qe=[Tt.x+Oe+k[0],Tt.y+k[1]-ie]);const Ln=je.w*Tt.scale/(Rt*(Tt.localGlyph?To:1)),On=je.h*Tt.scale/(Rt*(Tt.localGlyph?To:1));let mn,wr,Lr,rr;if(Ee){const gi=Tt.y-ct,Ni=new tt(-Oe,Oe-gi),$o=-Math.PI/2,Io=new tt(...nr);mn=new tt(-Oe+Qe[0],Qe[1]),mn._rotateAround($o,Ni)._add(Io),mn.x+=-gi+Oe,mn.y-=(Be.left-Nt)*Tt.scale;const Gi=Tt.imageName?Be.advance*Tt.scale:is*Tt.scale,Gr=String.fromCodePoint(Tt.glyph);QP(Gr)?mn.x+=(1-Nt)*Tt.scale:Tx(Gr)?mn.x+=Gi-Be.height*Tt.scale+(-Nt-1)*Tt.scale:mn.x+=Tt.imageName||Be.width+2*Nt===je.w&&Be.height+2*Nt===je.h?(Gi-On)/2:(Gi-(Be.height+2*Nt)*Tt.scale)/2,wr=new tt(mn.x,mn.y-Ln),Lr=new tt(mn.x+On,mn.y),rr=new tt(mn.x+On,mn.y-Ln)}else{const gi=(Be.left-Nt)*Tt.scale-Oe+Qe[0],Ni=(-Be.top-Nt)*Tt.scale+Qe[1],$o=gi+Ln,Io=Ni+On;mn=new tt(gi,Ni),wr=new tt($o,Ni),Lr=new tt(gi,Io),rr=new tt($o,Io)}if(K){let gi;gi=F?new tt(0,0):ln?new tt(J[0],J[1]):new tt(k[0],k[1]),mn._rotateAround(K,gi),wr._rotateAround(K,gi),Lr._rotateAround(K,gi),rr._rotateAround(K,gi)}const Kr=new tt(0,0),Si=new tt(0,0);X.push({tl:mn,tr:wr,bl:Lr,br:rr,texPrimary:zt,texSecondary:void 0,writingMode:T.writingMode,glyphOffset:En,sectionIndex:Tt.sectionIndex,isSDF:$t,pixelOffsetTL:Kr,pixelOffsetBR:Si,minFontScaleX:0,minFontScaleY:0})}}return X}(0,s,y,d,f,g,c,e.allowVerticalPlacement),v=e.textSizeData;let C=null;"source"===v.kind?(C=[Wu*d.layout.get("text-size").evaluate(g,{},u)],C[0]>Qd&&gt(`${e.layerIds[0]}: Value for "text-size" is >= ${Gv}. Reduce your "text-size".`)):"composite"===v.kind&&(C=[Wu*A.compositeTextSizes[0].evaluate(g,{},u),Wu*A.compositeTextSizes[1].evaluate(g,{},u)],(C[0]>Qd||C[1]>Qd)&&gt(`${e.layerIds[0]}: Value for "text-size" is >= ${Gv}. Reduce your "text-size".`)),e.addSymbols(e.text,m,C,y,f,g,w,t,r,b.lineStartIndex,b.lineLength,I,l,u,p,!1);for(const E of P)O[E]=e.text.placedSymbolArray.length-1;return 4*m.length}function nC(e){for(const t in e)return e[t];return null}function K_(e,t,r,s,c,d,f,g,y,b){let w=f.top,P=f.bottom,O=f.left,I=f.right;const A=f.collisionPadding;if(A&&(O-=A[0],w-=A[1],I+=A[2],P+=A[3]),y){const l=new tt(O,w),u=new tt(I,w),p=new tt(O,P),m=new tt(I,P),v=Ct(y);let C=new tt(0,0);b&&(C=new tt(b[0],b[1])),l._rotateAround(v,C),u._rotateAround(v,C),p._rotateAround(v,C),m._rotateAround(v,C),O=Math.min(l.x,u.x,p.x,m.x),I=Math.max(l.x,u.x,p.x,m.x),w=Math.min(l.y,u.y,p.y,m.y),P=Math.max(l.y,u.y,p.y,m.y)}return e.emplaceBack(t.x,t.y,t.z,r.x,r.y,O,w,I,P,g,s,c,d),e.length-1}function Rx(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);const t=e.bottom-e.top;return t>0?Math.max(10,t):null}function rC(e,t,r,s){const c=e.compareText;if(t in c){const d=c[t];for(let f=d.length-1;f>=0;f--)if(s.dist(d[f])<r)return!0}else c[t]=[];return c[t].push(s),!1}function Lx(e,t){const r=e.fovAboveCenter,s=e.elevation?e.elevation.getMinElevationBelowMSL()*t:0,c=(e._camera.position[2]*e.worldSize-s)/Math.cos(e._pitch),d=Math.sin(r)*c/Math.sin(Math.max(Math.PI/2-e._pitch-r,.01)),f=Math.sin(e._pitch)*d+c;return Math.min(1.01*f,c*(1/e._horizonShift))}function Ku(e,t){if(!t.isReprojectedInTileSpace)return{scale:1<<e.z,x:e.x,y:e.y,x2:e.x+1,y2:e.y+1,projection:t};const r=Math.pow(2,-e.z),s=e.x*r,c=(e.x+1)*r,d=e.y*r,f=(e.y+1)*r,g=Da(s),y=Da(c),b=Ji(d),w=Ji(f),P=t.project(g,b),O=t.project(y,b),I=t.project(y,w),A=t.project(g,w);let l=Math.min(P.x,O.x,I.x,A.x),u=Math.min(P.y,O.y,I.y,A.y),p=Math.max(P.x,O.x,I.x,A.x),m=Math.max(P.y,O.y,I.y,A.y);const v=r/16;function C(T,k,N,F,$,q){const Z=(N+$)/2,X=(F+q)/2,K=t.project(Da(Z),Ji(X)),J=Math.max(0,l-K.x,u-K.y,K.x-p,K.y-m);l=Math.min(l,K.x),p=Math.max(p,K.x),u=Math.min(u,K.y),m=Math.max(m,K.y),J>v&&(C(T,K,N,F,Z,X),C(K,k,Z,X,$,q))}C(P,O,s,d,c,d),C(O,I,c,d,c,f),C(I,A,c,f,s,f),C(A,P,s,f,s,d),l-=v,u-=v,p+=v,m+=v;const E=1/Math.max(p-l,m-u);return{scale:E,x:l*E,y:u*E,x2:p*E,y2:m*E,projection:t}}function rE(e,t,r,s,c,d,f,g,y){if("globe"===y.name)return ax(e,t,new oc(r,s,c),!1);const b=Ku({z:r,x:s,y:c},y);return new _i([(d+b.x/b.scale)*t,t*(b.y/b.scale),f],[(d+b.x2/b.scale)*t,t*(b.y2/b.scale),g])}function iE(e,{x:t,y:r},s=0){return new tt(((t-s)*e.scale-e.x)*Dt,(r*e.scale-e.y)*Dt)}function iC(e,t,r=0){return dt.fromValues(((t.x-r)*e.scale-e.x)*Dt,(t.y*e.scale-e.y)*Dt,RP(t.z,t.y))}const nm=bt.identity(new Float32Array(16));class La{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,r){return{x:0,y:0,z:0}}unproject(t,r){return new kn(0,0)}projectTilePoint(t,r,s){return{x:t,y:r,z:0}}locationPoint(t,r,s=!0){return t._coordinatePoint(t.locationCoordinate(r),s)}pixelsPerMeter(t,r){return ii(1,t)*r}pixelSpaceConversion(t,r,s){return 1}farthestPixelDistance(t){return Lx(t,t.pixelsPerMeter)}pointCoordinate(t,r,s,c){const d=t.horizonLineFromTop(!1),f=new tt(r,Math.max(d,s));return t.rayIntersectionCoordinate(t.pointRayIntersection(f,c))}pointCoordinate3D(t,r,s){const c=new tt(r,s);if(t.elevation)return t.elevation.pointCoordinate(c);{const d=this.pointCoordinate(t,c.x,c.y,0);return[d.x,d.y,d.z]}}isPointAboveHorizon(t,r){if(t.elevation)return!this.pointCoordinate3D(t,r.x,r.y);const s=t.horizonLineFromTop();return r.y<s}createInversionMatrix(t,r){return nm}createTileMatrix(t,r,s){let c,d,f;const g=s.canonical,y=bt.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const b=Ku(g,this);c=1,d=b.x+s.wrap*b.scale,f=b.y,bt.scale(y,y,[c/b.scale,c/b.scale,t.pixelsPerMeter/r])}else c=r/t.zoomScale(g.z),d=(g.x+Math.pow(2,g.z)*s.wrap)*c,f=g.y*c;return bt.translate(y,y,[d,f,0]),bt.scale(y,y,[c/Dt,c/Dt,1]),y}upVector(t,r,s){return[0,0,1]}upVectorScale(t,r,s){return{metersToTile:1}}}class Nx extends La{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[r,s]=this.parallels=t.parallels||[29.5,45.5],c=Math.sin(Ct(r));this.n=(c+Math.sin(Ct(s)))/2,this.c=1+c*(2*this.n-c),this.r0=Math.sqrt(this.c)/this.n}project(t,r){const{n:s,c,r0:d}=this,f=Ct(t-this.center[0]),g=Ct(r),y=Math.sqrt(c-2*s*Math.sin(g))/s;return{x:y*Math.sin(f*s),y:y*Math.cos(f*s)-d,z:0}}unproject(t,r){const{n:s,c,r0:d}=this,f=d+r;let g=Math.atan2(t,Math.abs(f))*Math.sign(f);f*s<0&&(g-=Math.PI*Math.sign(t)*Math.sign(f));const y=Ct(this.center[0])*s;g=Wt(g,-Math.PI-y,Math.PI-y);const b=Ne(ge(g/s)+this.center[0],-180,180),w=Math.asin(Ne((c-(t*t+f*f)*s*s)/(2*s),-1,1)),P=Ne(ge(w),-yi,yi);return new kn(b,P)}}const Yu=1.340264,bf=-.081106,fc=893e-6,Up=.003796,Y_=Math.sqrt(3)/2;class Hv extends La{project(t,r){r=r/180*Math.PI,t=t/180*Math.PI;const s=Math.asin(Y_*Math.sin(r)),c=s*s,d=c*c*c;return{x:.5*(t*Math.cos(s)/(Y_*(Yu+3*bf*c+d*(7*fc+9*Up*c)))/Math.PI+.5),y:1-.5*(s*(Yu+bf*c+d*(fc+Up*c))/Math.PI+1),z:0}}unproject(t,r){t=(2*t-.5)*Math.PI;let s=r=(2*(1-r)-1)*Math.PI,c=s*s,d=c*c*c;for(let w,P,O,I=0;I<12&&(P=s*(Yu+bf*c+d*(fc+Up*c))-r,O=Yu+3*bf*c+d*(7*fc+9*Up*c),w=P/O,s=Ne(s-w,-Math.PI/3,Math.PI/3),c=s*s,d=c*c*c,!(Math.abs(w)<1e-12));++I);const f=Y_*t*(Yu+3*bf*c+d*(7*fc+9*Up*c))/Math.cos(s),g=Math.asin(Math.sin(s)/Y_),y=Ne(180*f/Math.PI,-180,180),b=Ne(180*g/Math.PI,-yi,yi);return new kn(y,b)}}class AT extends La{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,r){return{x:.5+t/360,y:.5-r/360,z:0}}unproject(t,r){const s=360*(t-.5),c=Ne(360*(.5-r),-yi,yi);return new kn(s,c)}}const X_=Math.PI/2;function to(e){return Math.tan((X_+e)/2)}class Q_ extends La{constructor(t){super(t),this.center=t.center||[0,30];const[r,s]=this.parallels=t.parallels||[30,30];let c=Ct(r),d=Ct(s);this.southernCenter=c+d<0,this.southernCenter&&(c=-c,d=-d);const f=Math.cos(c),g=to(c);this.n=c===d?Math.sin(c):Math.log(f/Math.cos(d))/Math.log(to(d)/g),this.f=f*Math.pow(to(c),this.n)/this.n}project(t,r){r=Ct(r),this.southernCenter&&(r=-r),t=Ct(t-this.center[0]);const s=1e-6,{n:c,f:d}=this;d>0?r<-X_+s&&(r=-X_+s):r>X_-s&&(r=X_-s);const f=d/Math.pow(to(r),c);let g=f*Math.sin(c*t),y=d-f*Math.cos(c*t);return g=.5*(g/Math.PI+.5),y=.5*(y/Math.PI+.5),{x:g,y:this.southernCenter?y:1-y,z:0}}unproject(t,r){t=(2*t-.5)*Math.PI,this.southernCenter&&(r=1-r),r=(2*(1-r)-.5)*Math.PI;const{n:s,f:c}=this,d=c-r,f=Math.sign(d),g=Math.sign(s)*Math.sqrt(t*t+d*d);let y=Math.atan2(t,Math.abs(d))*f;d*s<0&&(y-=Math.PI*Math.sign(t)*f);const b=Ne(ge(y/s)+this.center[0],-180,180),w=Ne(ge(2*Math.atan(Math.pow(c/g,1/s))-X_),-yi,yi);return new kn(b,this.southernCenter?-w:w)}}class J_ extends La{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,r){return{x:yo(t),y:Pi(r),z:0}}unproject(t,r){const s=Da(t),c=Ji(r);return new kn(s,c)}}const Fx=Ct(yi);class DT extends La{project(t,r){const s=(r=Ct(r))*r,c=s*s;return{x:.5*((t=Ct(t))*(.8707-.131979*s+c*(c*(.003971*s-.001529*c)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+s*(.015085+c*(.028874*s-.044475-.005916*c)))/Math.PI+1),z:0}}unproject(t,r){t=(2*t-.5)*Math.PI;let s=r=(2*(1-r)-1)*Math.PI,c=25,d=0,f=s*s;do{f=s*s;const b=f*f;d=(s*(1.007226+f*(.015085+b*(.028874*f-.044475-.005916*b)))-r)/(1.007226+f*(.045255+b*(.259866*f-.311325-.005916*11*b))),s=Ne(s-d,-Fx,Fx)}while(Math.abs(d)>1e-6&&--c>0);f=s*s;const g=Ne(ge(t/(.8707+f*(f*(f*f*f*(.003971-.001529*f)-.013791)-.131979))),-180,180),y=ge(s);return new kn(g,y)}}const ty=Ct(yi);class oE extends La{project(t,r){r=Ct(r),t=Ct(t);const s=Math.cos(r),c=2/Math.PI,d=Math.acos(s*Math.cos(t/2)),f=Math.sin(d)/d,g=.5*(t*c+2*s*Math.sin(t/2)/f)||0,y=.5*(r+Math.sin(r)/f)||0;return{x:.5*(g/Math.PI+.5),y:1-.5*(y/Math.PI+1),z:0}}unproject(t,r){let s=t=(2*t-.5)*Math.PI,c=r=(2*(1-r)-1)*Math.PI,d=25;const f=1e-6;let g=0,y=0;do{const b=Math.cos(c),w=Math.sin(c),P=2*w*b,O=w*w,I=b*b,A=Math.cos(s/2),l=Math.sin(s/2),u=2*A*l,p=l*l,m=1-I*A*A,v=m?1/m:0,C=m?Math.acos(b*A)*Math.sqrt(1/m):0,E=.5*(2*C*b*l+2*s/Math.PI)-t,T=.5*(C*w+c)-r,k=.5*v*(I*p+C*b*A*O)+1/Math.PI,N=v*(u*P/4-C*w*l),F=.125*v*(P*l-C*w*I*u),$=.5*v*(O*A+C*p*b)+.5,q=N*F-$*k;g=(T*N-E*$)/q,y=(E*F-T*k)/q,s=Ne(s-g,-Math.PI,Math.PI),c=Ne(c-y,-ty,ty)}while((Math.abs(g)>f||Math.abs(y)>f)&&--d>0);return new kn(ge(s),ge(c))}}class qv extends La{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ct(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,r){const{scale:s,cosPhi:c}=this;return{x:Ct(t)*c*s+.5,y:-Math.sin(Ct(r))/c*s+.5,z:0}}unproject(t,r){const{scale:s,cosPhi:c}=this,d=-(r-.5)/s,f=Ne(ge((t-.5)/s)/c,-180,180),g=Math.asin(Ne(d*c,-1,1)),y=Ne(ge(g),-yi,yi);return new kn(f,y)}}class rm extends J_{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,r,s){const c=af(t,r,s),d=lf(Mi(s));return dt.transformMat4(c,c,d),{x:c[0],y:c[1],z:c[2]}}locationPoint(t,r){const s=ra(r.lat,r.lng),c=dt.normalize([],s),d=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(r),t._centerAltitude):t._centerAltitude,f=ii(1,0)*Dt*d;dt.scaleAndAdd(s,s,c,f);const g=bt.identity(new Float64Array(16));return bt.multiply(g,t.pixelMatrix,t.globeMatrix),dt.transformMat4(s,s,g),new tt(s[0],s[1])}pixelsPerMeter(t,r){return ii(1,0)*r}pixelSpaceConversion(t,r,s){const c=ii(1,t)*r,d=vn(ii(1,45)*r,c,s);return this.pixelsPerMeter(t,r)/d}createTileMatrix(t,r,s){const c=D_(Mi(s.canonical));return bt.multiply(new Float64Array(16),t.globeMatrix,c)}createInversionMatrix(t,r){const{center:s}=t,c=lf(Mi(r));return bt.rotateY(c,c,Ct(s.lng)),bt.rotateX(c,c,Ct(s.lat)),bt.scale(c,c,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(c)}pointCoordinate(t,r,s,c){return Mp(t,r,s,!0)||new Xn(0,0)}pointCoordinate3D(t,r,s){const c=this.pointCoordinate(t,r,s,0);return[c.x,c.y,c.z]}isPointAboveHorizon(t,r){return!Mp(t,r.x,r.y,!1)}farthestPixelDistance(t){const r=function(c,d){const f=c.cameraToCenterDistance,g=c._centerAltitude*d,y=c._camera,b=c._camera.forward(),w=dt.add([],dt.scale([],b,-f),[0,0,g]),P=c.worldSize/(2*Math.PI),O=[0,0,-P],I=c.width/c.height,A=Math.tan(c.fovAboveCenter),l=dt.scale([],y.up(),A),u=dt.scale([],y.right(),A*I),p=dt.normalize([],dt.add([],dt.add([],b,l),u)),m=[];let v;if(new ex(w,p).closestPointOnSphere(O,P,m)){const C=dt.add([],m,O),E=dt.sub([],C,w);v=Math.cos(c.fovAboveCenter)*dt.length(E)}else{const C=dt.sub([],w,O),E=dt.sub([],O,w);dt.normalize(E,E);const T=dt.length(C)-P;v=Math.sqrt(T*(T+2*P));const k=Math.acos(v/(P+T))-Math.acos(dt.dot(b,E));v*=Math.cos(k)}return 1.01*v}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),s=Po(t.zoom);if(s>0){const c=Lx(t,ii(1,t.center.lat)*t.worldSize),d=t.worldSize/(2*Math.PI),f=Math.max(t.width,t.height)/t.worldSize*Math.PI;return vn(r,c+d*(1-Math.cos(f)),Math.pow(s,10))}return r}upVector(t,r,s){return af(r,s,t,1)}upVectorScale(t){return{metersToTile:ox(al(Mi(t)))}}}function Dl(e){const t=e.parallels,r=!!t&&Math.abs(t[0]+t[1])<.01;switch(e.name){case"mercator":return new J_(e);case"equirectangular":return new AT(e);case"naturalEarth":return new DT(e);case"equalEarth":return new Hv(e);case"winkelTripel":return new oE(e);case"albers":return r?new qv(e):new Nx(e);case"lambertConformalConic":return r?new qv(e):new Q_(e);case"globe":return new rm(e)}throw new Error(`Invalid projection name: ${e.name}`)}const oC=new jt({"symbol-placement":new G(wt.layout_symbol["symbol-placement"]),"symbol-spacing":new G(wt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new G(wt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Q(wt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new G(wt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new G(wt.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new G(wt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new G(wt.layout_symbol["icon-ignore-placement"]),"icon-optional":new G(wt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new G(wt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Q(wt.layout_symbol["icon-size"]),"icon-text-fit":new Q(wt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Q(wt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Q(wt.layout_symbol["icon-image"]),"icon-rotate":new Q(wt.layout_symbol["icon-rotate"]),"icon-padding":new G(wt.layout_symbol["icon-padding"]),"icon-keep-upright":new G(wt.layout_symbol["icon-keep-upright"]),"icon-offset":new Q(wt.layout_symbol["icon-offset"]),"icon-anchor":new Q(wt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new G(wt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new G(wt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new G(wt.layout_symbol["text-rotation-alignment"]),"text-field":new Q(wt.layout_symbol["text-field"]),"text-font":new Q(wt.layout_symbol["text-font"]),"text-size":new Q(wt.layout_symbol["text-size"]),"text-max-width":new Q(wt.layout_symbol["text-max-width"]),"text-line-height":new Q(wt.layout_symbol["text-line-height"]),"text-letter-spacing":new Q(wt.layout_symbol["text-letter-spacing"]),"text-justify":new Q(wt.layout_symbol["text-justify"]),"text-radial-offset":new Q(wt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new G(wt.layout_symbol["text-variable-anchor"]),"text-anchor":new Q(wt.layout_symbol["text-anchor"]),"text-max-angle":new G(wt.layout_symbol["text-max-angle"]),"text-writing-mode":new G(wt.layout_symbol["text-writing-mode"]),"text-rotate":new Q(wt.layout_symbol["text-rotate"]),"text-padding":new G(wt.layout_symbol["text-padding"]),"text-keep-upright":new G(wt.layout_symbol["text-keep-upright"]),"text-transform":new Q(wt.layout_symbol["text-transform"]),"text-offset":new Q(wt.layout_symbol["text-offset"]),"text-allow-overlap":new G(wt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new G(wt.layout_symbol["text-ignore-placement"]),"text-optional":new G(wt.layout_symbol["text-optional"]),visibility:new G(wt.layout_symbol.visibility)});var zx={paint:new jt({"icon-opacity":new Q(wt.paint_symbol["icon-opacity"]),"icon-emissive-strength":new Q(wt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Q(wt.paint_symbol["text-emissive-strength"]),"icon-color":new Q(wt.paint_symbol["icon-color"]),"icon-halo-color":new Q(wt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Q(wt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Q(wt.paint_symbol["icon-halo-blur"]),"icon-translate":new G(wt.paint_symbol["icon-translate"]),"icon-translate-anchor":new G(wt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Q(wt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Q(wt.paint_symbol["text-opacity"]),"text-color":new Q(wt.paint_symbol["text-color"],{runtimeType:Jr,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Q(wt.paint_symbol["text-halo-color"]),"text-halo-width":new Q(wt.paint_symbol["text-halo-width"]),"text-halo-blur":new Q(wt.paint_symbol["text-halo-blur"]),"text-translate":new G(wt.paint_symbol["text-translate"]),"text-translate-anchor":new G(wt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new G(wt.paint_symbol["icon-color-saturation"])}),layout:oC};class Bx{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ws,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}De(Bx,"FormatSectionOverride",{omit:["defaultValue"]});class Jd extends gs{constructor(t,r){super(t,zx,r)}recalculate(t,r){super.recalculate(t,r),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const c=[];for(const d of s)c.indexOf(d)<0&&c.push(d);this.layout._values["text-writing-mode"]=c}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,r,s,c){const d=this.layout.get(t).evaluate(r,{},s,c),f=this._unevaluatedLayout._values[t];return f.isDataDriven()||Zl(f.value)||!d?d:(g=r.properties,d.replace(/{([^{}]+)}/g,(b,w)=>w in g?String(g[w]):""));var g}createBucket(t){return new xf(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of zx.paint.overridableProperties){if(!Jd.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),s=new Bx(r),c=new Yi(s,r.property.specification);let d=null;d="constant"===r.value.kind||"source"===r.value.kind?new xg("source",c):new Os("composite",c,r.value.zoomStops,r.value._interpolationType),this.paint._values[t]=new R(r.property,d,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,s){return!(!this.layout||r.isDataDriven()||s.isDataDriven())&&Jd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const s=t.get("text-field"),c=zx.paint.properties[r];let d=!1;const f=g=>{for(const y of g)if(c.overrides&&c.overrides.hasOverride(y))return void(d=!0)};if("constant"===s.value.kind&&s.value.value instanceof po)f(s.value.value.sections);else if("source"===s.value.kind){const g=b=>{d||(b instanceof Ms&&go(b.value)===Cs?f(b.value.sections):b instanceof aa?f(b.sections):b.eachChild(g))},y=s.value;y._styleExpression&&g(y._styleExpression.expression)}return d}getProgramIds(){const t=0!==this.paint.get("icon-opacity").constantOr(1),r=0!==this.paint.get("text-opacity").constantOr(1),s=[];return t&&s.push("symbolIcon"),r&&s.push("symbolSDF"),s}getDefaultProgramParams(t,r){return{config:new Ru(this,r),overrideFog:!1}}}const Ux=Iv.types,Vx=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ey(e,t,r,s,c,d,f,g,y,b,w,P,O){const I=g?Math.min(Qd,Math.round(g[0])):0,A=g?Math.min(Qd,Math.round(g[1])):0;e.emplaceBack(t,r,Math.round(32*s),Math.round(32*c),d,f,(I<<1)+(y?1:0),A,16*b,16*w,256*P,256*O)}function ny(e,t,r){e.emplaceBack(t,r)}function jx(e,t,r,s,c,d,f){e.emplaceBack(t,r,s,c,d,f)}function Zv(e,t,r,s,c){const d=5*t+2;e.float32[d+0]=r,e.float32[d+1]=s,e.float32[d+2]=c}function uo(e,t,r,s,c){e.emplaceBack(t,r,s,c),e.emplaceBack(t,r,s,c),e.emplaceBack(t,r,s,c),e.emplaceBack(t,r,s,c)}function Oi(e){for(const t of e.sections)if(xn(t.text))return!0;return!1}class Wv{constructor(t){this.layoutVertexArray=new g0,this.indexArray=new Mo,this.programConfigurations=t,this.segments=new li,this.dynamicLayoutVertexArray=new Du,this.opacityVertexArray=new Qy,this.placedSymbolArray=new oP,this.iconTransitioningVertexArray=new ku,this.globeExtVertexArray=new tP,this.zOffsetVertexArray=new v0}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length&&0===this.iconTransitioningVertexArray.length}upload(t,r,s,c,d){this.isEmpty()||(s&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qg.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Yw.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Vx,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,YP.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Zg.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||d)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,zv.members,!0)),this.opacityVertexBuffer.itemSize=1),(s||c)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}De(Wv,"SymbolBuffers");class Kv{constructor(t,r,s){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new s,this.segments=new li,this.collisionVertexArray=new eP,this.collisionVertexArrayExt=new Du}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,XP.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,Ox.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}De(Kv,"CollisionBuffers");class im{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(f=>f.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=bt.identity([]),this.placementViewportMatrix=bt.identity([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Qw(this.zoom,r["text-size"]),this.iconSizeData=Qw(this.zoom,r["icon-size"]);const s=this.layers[0].layout,c=s.get("symbol-sort-key"),d=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==d&&void 0!==c.constantOr(1),this.sortFeaturesByY=("viewport-y"===d||"auto"===d&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(f=>si[f]),this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=s.get("symbol-z-elevate")}createArrays(){this.text=new Wv(new ga(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Wv(new ga(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new u_,this.lineVertexArray=new lP,this.symbolInstances=new aP}calculateGlyphDependencies(t,r,s,c,d){for(let f=0;f<t.length;f++){const g=t.codePointAt(f);if(void 0===g)break;if(r[g]=!0,c&&d&&g<=65535){const y=Hc[t.charAt(f)];y&&(r[y.charCodeAt(0)]=!0)}}}populate(t,r,s,c){const d=this.layers[0],f=d.layout,g="globe"===this.projection.name,y=f.get("text-font"),b=f.get("text-field"),w=f.get("icon-image"),P=("constant"!==b.value.kind||b.value.value instanceof po&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&("constant"!==y.value.kind||y.value.value.length>0),O="constant"!==w.value.kind||!!w.value.value||Object.keys(w.parameters).length>0,I=f.get("symbol-sort-key");if(this.features=[],!P&&!O)return;const A=r.iconDependencies,l=r.glyphDependencies,u=r.availableImages,p=new Ri(this.zoom);for(const{feature:m,id:v,index:C,sourceLayerIndex:E}of t){const T=d._featureFilter.needGeometry,k=jc(m,T);if(!d._featureFilter.filter(p,k,s))continue;if(T||(k.geometry=Ei(m,s,c)),g&&1!==m.type&&s.z<=5){const q=k.geometry,Z=.98078528056,X=(K,J)=>{const st=af(K.x,K.y,s,1),ot=af(J.x,J.y,s,1);return dt.dot(st,ot)<Z};for(let K=0;K<q.length;K++)q[K]=Nw(q[K],X)}let N,F;if(P){const q=d.getValueAndResolveTokens("text-field",k,s,u),Z=po.factory(q);Oi(Z)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Au()||this.hasRTLText&&tl.isParsed())&&(N=ao(Z,d,k))}if(O){const q=d.getValueAndResolveTokens("icon-image",k,s,u);F=q instanceof Ro?q:Ro.fromString(q)}if(!N&&!F)continue;const $=this.sortFeaturesByKey?I.evaluate(k,{},s):void 0;if(this.features.push({id:v,text:N,icon:F,index:C,sourceLayerIndex:E,geometry:k.geometry,properties:m.properties,type:Ux[m.type],sortKey:$}),F&&(A[F.namePrimary]=!0,F.nameSecondary&&(A[F.nameSecondary]=!0)),N){const q=y.evaluate(k,{},s).join(","),Z="map"===f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(si.vertical)>=0;for(const X of N.sections)if(X.image)A[X.image.namePrimary]=!0;else{const K=W(N.toString()),J=X.fontStack||q,st=l[J]=l[J]||{};this.calculateGlyphDependencies(X.text,st,Z,this.allowVerticalPlacement,K)}}}"line"===f.get("symbol-placement")&&(this.features=function(m){const v={},C={},E=[];let T=0;function k(q){E.push(m[q]),T++}function N(q,Z,X){const K=C[q];return delete C[q],C[Z]=K,E[K].geometry[0].pop(),E[K].geometry[0]=E[K].geometry[0].concat(X[0]),K}function F(q,Z,X){const K=v[Z];return delete v[Z],v[q]=K,E[K].geometry[0].shift(),E[K].geometry[0]=X[0].concat(E[K].geometry[0]),K}function $(q,Z,X){const K=X?Z[0][Z[0].length-1]:Z[0][0];return`${q}:${K.x}:${K.y}`}for(let q=0;q<m.length;q++){const Z=m[q],X=Z.geometry,K=Z.text?Z.text.toString():null;if(!K){k(q);continue}const J=$(K,X),st=$(K,X,!0);if(J in C&&st in v&&C[J]!==v[st]){const ot=F(J,st,X),rt=N(J,st,E[ot].geometry);delete v[J],delete C[st],C[$(K,E[rt].geometry,!0)]=rt,E[ot].geometry=null}else J in C?N(J,st,X):st in v?F(J,st,X):(k(q),v[J]=T-1,C[st]=T-1)}return E.filter(q=>q.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((m,v)=>m.sortKey-v.sortKey)}update(t,r,s,c,d){const f=0!==Object.keys(t).length;if(f&&!this.stateDependentLayers.length)return;const g=f?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,r,g,s,c,d),this.icon.programConfigurations.updatePaintArrays(t,r,g,s,c,d)}updateZOffset(){const t=(d,f,g)=>{s+=f,s>d.length&&d.resize(s);for(let y=-f;y<0;y++)d.emplace(y+s,g)},r=(d,f,g)=>{c+=f,c>d.length&&d.resize(c);for(let y=-f;y<0;y++)d.emplace(y+c,g)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let s=0,c=0;for(let d=0;d<this.symbolInstances.length;d++){const f=this.symbolInstances.get(d),{numHorizontalGlyphVertices:g,numVerticalGlyphVertices:y,numIconVertices:b}=f,w=f.zOffset,P=b>0;if((g>0||y>0)&&(t(this.text.zOffsetVertexArray,g,w),t(this.text.zOffsetVertexArray,y,w)),P){const{placedIconSymbolIndex:O,verticalPlacedIconSymbolIndex:I}=f;O>=0&&r(this.icon.zOffsetVertexArray,b,w),I>=0&&r(this.icon.zOffsetVertexArray,f.numVerticalIconVertices,w)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Dl(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const s=this.lineVertexArray.length;if(void 0!==t.segment)for(const{x:c,y:d}of r)this.lineVertexArray.emplaceBack(c,d);return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u){const p=t.indexArray,m=t.layoutVertexArray,v=t.globeExtVertexArray,C=t.segments.prepareSegment(4*r.length,m,p,this.canOverlap?f.sortKey:void 0),E=this.glyphOffsetArray.length,T=C.vertexLength,k=this.allowVerticalPlacement&&g===si.vertical?Math.PI/2:0,N=f.text&&f.text.sections;for(let $=0;$<r.length;$++){const{tl:q,tr:Z,bl:X,br:K,texPrimary:J,texSecondary:st,pixelOffsetTL:ot,pixelOffsetBR:rt,minFontScaleX:ct,minFontScaleY:yt,glyphOffset:Ot,isSDF:Tt,sectionIndex:zt}=r[$],Nt=C.vertexLength,$t=Ot[1];if(ey(m,b.x,b.y,q.x,$t+q.y,J.x,J.y,s,Tt,ot.x,ot.y,ct,yt),ey(m,b.x,b.y,Z.x,$t+Z.y,J.x+J.w,J.y,s,Tt,rt.x,ot.y,ct,yt),ey(m,b.x,b.y,X.x,$t+X.y,J.x,J.y+J.h,s,Tt,ot.x,rt.y,ct,yt),ey(m,b.x,b.y,K.x,$t+K.y,J.x+J.w,J.y+J.h,s,Tt,rt.x,rt.y,ct,yt),y){const{x:Rt,y:ie,z:Ee}=y.anchor,[Oe,Be,je]=y.up;jx(v,Rt,ie,Ee,Oe,Be,je),jx(v,Rt,ie,Ee,Oe,Be,je),jx(v,Rt,ie,Ee,Oe,Be,je),jx(v,Rt,ie,Ee,Oe,Be,je),uo(t.dynamicLayoutVertexArray,Rt,ie,Ee,k)}else uo(t.dynamicLayoutVertexArray,b.x,b.y,b.z,k);if(u){const Rt=st||J;ny(t.iconTransitioningVertexArray,Rt.x,Rt.y),ny(t.iconTransitioningVertexArray,Rt.x+Rt.w,Rt.y),ny(t.iconTransitioningVertexArray,Rt.x,Rt.y+Rt.h),ny(t.iconTransitioningVertexArray,Rt.x+Rt.w,Rt.y+Rt.h)}p.emplaceBack(Nt,Nt+1,Nt+2),p.emplaceBack(Nt+1,Nt+2,Nt+3),C.vertexLength+=4,C.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ot[0]),$!==r.length-1&&zt===r[$+1].sectionIndex||t.programConfigurations.populatePaintArrays(m.length,f,f.index,{},I,A,l,N&&N[zt])}const F=y?y.anchor:b;t.placedSymbolArray.emplaceBack(F.x,F.y,F.z,b.x,b.y,E,this.glyphOffsetArray.length-E,T,w,P,b.segment,s?s[0]:0,s?s[1]:0,c[0],c[1],g,0,!1,0,O,0)}_commitLayoutVertex(t,r,s,c,d,f,g){t.emplaceBack(r,s,c,d,f,Math.round(g.x),Math.round(g.y))}_addCollisionDebugVertices(t,r,s,c,d,f,g){const y=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),b=y.vertexLength,w=g.tileAnchorX,P=g.tileAnchorY;for(let I=0;I<4;I++)s.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(s.collisionVertexArrayExt,r,t.padding,g.zOffset),this._commitLayoutVertex(s.layoutVertexArray,c,d,f,w,P,new tt(t.x1,t.y1)),this._commitLayoutVertex(s.layoutVertexArray,c,d,f,w,P,new tt(t.x2,t.y1)),this._commitLayoutVertex(s.layoutVertexArray,c,d,f,w,P,new tt(t.x2,t.y2)),this._commitLayoutVertex(s.layoutVertexArray,c,d,f,w,P,new tt(t.x1,t.y2)),y.vertexLength+=4;const O=s.indexArray;O.emplaceBack(b,b+1),O.emplaceBack(b+1,b+2),O.emplaceBack(b+2,b+3),O.emplaceBack(b+3,b),y.primitiveLength+=4}_addTextDebugCollisionBoxes(t,r,s,c,d,f){for(let g=c;g<d;g++){const y=s.get(g),b=this.getSymbolInstanceTextSize(t,f,r,g);this._addCollisionDebugVertices(y,b,this.textCollisionBox,y.projectedAnchorX,y.projectedAnchorY,y.projectedAnchorZ,f)}}_addIconDebugCollisionBoxes(t,r,s,c,d,f){for(let g=c;g<d;g++){const y=s.get(g),b=this.getSymbolInstanceIconSize(t,r,f.placedIconSymbolIndex);this._addCollisionDebugVertices(y,b,this.iconCollisionBox,y.projectedAnchorX,y.projectedAnchorY,y.projectedAnchorZ,f)}}generateCollisionDebugBuffers(t,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Kv(_0,j_.members,ku),this.iconCollisionBox=new Kv(_0,j_.members,ku);const s=co(this.iconSizeData,t),c=co(this.textSizeData,t);for(let d=0;d<this.symbolInstances.length;d++){const f=this.symbolInstances.get(d);this._addTextDebugCollisionBoxes(c,t,r,f.textBoxStartIndex,f.textBoxEndIndex,f),this._addTextDebugCollisionBoxes(c,t,r,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f),this._addIconDebugCollisionBoxes(s,t,r,f.iconBoxStartIndex,f.iconBoxEndIndex,f),this._addIconDebugCollisionBoxes(s,t,r,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f)}}getSymbolInstanceTextSize(t,r,s,c){const d=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:c),f=Wg(this.textSizeData,t,d)/is;return this.tilePixelRatio*f}getSymbolInstanceIconSize(t,r,s){const c=this.icon.placedSymbolArray.get(s),d=Wg(this.iconSizeData,t,c);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(t,r,s,c){t.emplaceBack(r,-s,-s,c),t.emplaceBack(r,s,-s,c),t.emplaceBack(r,s,s,c),t.emplaceBack(r,-s,s,c)}_updateTextDebugCollisionBoxes(t,r,s,c,d,f){for(let g=c;g<d;g++){const y=s.get(g),b=this.getSymbolInstanceTextSize(t,f,r,g);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,b,y.padding,f.zOffset)}}_updateIconDebugCollisionBoxes(t,r,s,c,d,f){for(let g=c;g<d;g++){const y=s.get(g),b=this.getSymbolInstanceIconSize(t,r,f.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,b,y.padding,f.zOffset)}}updateCollisionDebugBuffers(t,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=co(this.iconSizeData,t),c=co(this.textSizeData,t);for(let d=0;d<this.symbolInstances.length;d++){const f=this.symbolInstances.get(d);this._updateTextDebugCollisionBoxes(c,t,r,f.textBoxStartIndex,f.textBoxEndIndex,f),this._updateTextDebugCollisionBoxes(c,t,r,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f),this._updateIconDebugCollisionBoxes(s,t,r,f.iconBoxStartIndex,f.iconBoxEndIndex,f),this._updateIconDebugCollisionBoxes(s,t,r,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,r,s,c,d,f,g,y,b){const w={};if(r<s){const{x1:P,y1:O,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:C,featureIndex:E}=t.get(r);w.textBox={x1:P,y1:O,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:C},w.textFeatureIndex=E}if(c<d){const{x1:P,y1:O,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:C,featureIndex:E}=t.get(c);w.verticalTextBox={x1:P,y1:O,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:C},w.verticalTextFeatureIndex=E}if(f<g){const{x1:P,y1:O,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:C,featureIndex:E}=t.get(f);w.iconBox={x1:P,y1:O,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:C},w.iconFeatureIndex=E}if(y<b){const{x1:P,y1:O,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:C,featureIndex:E}=t.get(y);w.verticalIconBox={x1:P,y1:O,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:C},w.verticalIconFeatureIndex=E}return w}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,r){const s=t.placedSymbolArray.get(r),c=s.vertexStartIndex+4*s.numGlyphs;for(let d=s.vertexStartIndex;d<c;d+=4)t.indexArray.emplaceBack(d,d+1,d+2),t.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const r=Math.sin(t),s=Math.cos(t),c=[],d=[],f=[];for(let g=0;g<this.symbolInstances.length;++g){f.push(g);const y=this.symbolInstances.get(g);c.push(0|Math.round(r*y.tileAnchorX+s*y.tileAnchorY)),d.push(y.featureIndex)}return f.sort((g,y)=>c[g]-c[y]||d[y]-d[g]),f}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,r)=>this.symbolInstances.get(r).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,r){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===r?s.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const s=this.symbolInstances.get(r);this.featureSortOrder.push(s.featureIndex);const{rightJustifiedTextSymbolIndex:c,centerJustifiedTextSymbolIndex:d,leftJustifiedTextSymbolIndex:f,verticalPlacedTextSymbolIndex:g,placedIconSymbolIndex:y,verticalPlacedIconSymbolIndex:b}=s;c>=0&&this.addIndicesForPlacedSymbol(this.text,c),d>=0&&d!==c&&this.addIndicesForPlacedSymbol(this.text,d),f>=0&&f!==d&&f!==c&&this.addIndicesForPlacedSymbol(this.text,f),g>=0&&this.addIndicesForPlacedSymbol(this.text,g),y>=0&&this.addIndicesForPlacedSymbol(this.icon,y),b>=0&&this.addIndicesForPlacedSymbol(this.icon,b)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}De(im,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),im.MAX_GLYPHS=65535,im.addDynamicAttributes=uo;var xf=im;const sC=Dr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:sE}=sC,aC=Dr([{name:"a_packed",components:4,type:"Float32"}]),{members:Yv}=aC,th=Iv.types,Xv=Math.cos(Math.PI/180*37.5);class Vp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new p0,this.layoutVertexArray2=new Du,this.indexArray=new Mo,this.programConfigurations=new ga(t.layers,t.zoom),this.segments=new li,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,s,c){this.hasPattern=ll("line",this.layers,r);const d=this.layers[0].layout.get("line-sort-key"),f=[];for(const{feature:w,id:P,index:O,sourceLayerIndex:I}of t){const A=this.layers[0]._featureFilter.needGeometry,l=jc(w,A);if(!this.layers[0]._featureFilter.filter(new Ri(this.zoom),l,s))continue;const u=d?d.evaluate(l,{},s):void 0,p={id:P,properties:w.properties,type:w.type,sourceLayerIndex:I,index:O,geometry:A?l.geometry:Ei(w,s,c),patterns:{},sortKey:u};f.push(p)}d&&f.sort((w,P)=>w.sortKey-P.sortKey);const{lineAtlas:g,featureIndex:y}=r,b=this.addConstantDashes(g);for(const w of f){const{geometry:P,index:O,sourceLayerIndex:I}=w;if(b&&this.addFeatureDashes(w,g),this.hasPattern){const A=ff("line",this.layers,w,this.zoom,r);this.patternFeatures.push(A)}else this.addFeature(w,P,O,s,g.positions,r.availableImages,r.brightness);y.insert(t[O].feature,P,O,I,this.index)}}addConstantDashes(t){let r=!1;for(const s of this.layers){const c=s.paint.get("line-dasharray").value,d=s.layout.get("line-cap").value;if("constant"!==c.kind||"constant"!==d.kind)r=!0;else{const f=d.value,g=c.value;if(!g)continue;t.addDash(g,f)}}return r}addFeatureDashes(t,r){const s=this.zoom;for(const c of this.layers){const d=c.paint.get("line-dasharray").value,f=c.layout.get("line-cap").value;if("constant"===d.kind&&"constant"===f.kind)continue;let g,y;if("constant"===d.kind){if(g=d.value,!g)continue}else g=d.evaluate({zoom:s},t);y="constant"===f.kind?f.value:f.evaluate({zoom:s},t),r.addDash(g,y),t.patterns[c.id]=r.getKey(g,y)}}update(t,r,s,c,d){const f=0!==Object.keys(t).length;f&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,f?this.stateDependentLayers:this.layers,s,c,d)}addFeatures(t,r,s,c,d,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,s,c,f)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Yv)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,sE),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,s,c,d,f,g){const y=this.layers[0].layout,b=y.get("line-join").evaluate(t,{}),w=y.get("line-cap").evaluate(t,{}),P=y.get("line-miter-limit"),O=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const I of r)this.addLine(I,t,b,w,P,O);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,d,f,c,g)}addLine(t,r,s,c,d,f){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let p=0;p<t.length-1;p++)this.totalDistance+=t[p].dist(t[p+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const g="Polygon"===th[r.type];let y=t.length;for(;y>=2&&t[y-1].equals(t[y-2]);)y--;let b=0;for(;b<y-1&&t[b].equals(t[b+1]);)b++;if(y<(g?3:2))return;"bevel"===s&&(d=1.05);const w=this.overscaling<=16?15*Dt/(512*this.overscaling):0,P=this.segments.prepareSegment(10*y,this.layoutVertexArray,this.indexArray);let O,I,A,l,u;this.e1=this.e2=-1,g&&(O=t[y-2],u=t[b].sub(O)._unit()._perp());for(let p=b;p<y;p++){if(A=p===y-1?g?t[b+1]:void 0:t[p+1],A&&t[p].equals(A))continue;u&&(l=u),O&&(I=O),O=t[p],u=A?A.sub(O)._unit()._perp():l,l=l||u;let m=l.add(u);0===m.x&&0===m.y||m._unit();const v=l.x*u.x+l.y*u.y,C=m.x*u.x+m.y*u.y,E=0!==C?1/C:1/0,T=2*Math.sqrt(2-2*C),k=C<Xv&&I&&A,N=l.x*u.y-l.y*u.x>0;if(k&&p>b){const q=O.dist(I);if(q>2*w){const Z=O.sub(O.sub(I)._mult(w/q)._round());this.updateDistance(I,Z),this.addCurrentVertex(Z,l,0,0,P),I=Z}}const F=I&&A;let $=F?s:g?"butt":c;if(F&&"round"===$&&(E<f?$="miter":E<=2&&($="fakeround")),"miter"===$&&E>d&&($="bevel"),"bevel"===$&&(E>2&&($="flipbevel"),E<d&&($="miter")),I&&this.updateDistance(I,O),"miter"===$)m._mult(E),this.addCurrentVertex(O,m,0,0,P);else if("flipbevel"===$){if(E>100)m=u.mult(-1);else{const q=E*l.add(u).mag()/l.sub(u).mag();m._perp()._mult(q*(N?-1:1))}this.addCurrentVertex(O,m,0,0,P),this.addCurrentVertex(O,m.mult(-1),0,0,P)}else if("bevel"===$||"fakeround"===$){const q=-Math.sqrt(E*E-1),Z=N?q:0,X=N?0:q;if(I&&this.addCurrentVertex(O,l,Z,X,P),"fakeround"===$){const K=Math.round(180*T/Math.PI/20);for(let J=1;J<K;J++){let st=J/K;if(.5!==st){const rt=st-.5;st+=st*rt*(st-1)*((1.0904+v*(v*(3.55645-1.43519*v)-3.2452))*rt*rt+(.848013+v*(.215638*v-1.06021)))}const ot=u.sub(l)._mult(st)._add(l)._unit()._mult(N?-1:1);this.addHalfVertex(O,ot.x,ot.y,!1,N,0,P)}}A&&this.addCurrentVertex(O,u,-Z,-X,P)}else if("butt"===$)this.addCurrentVertex(O,m,0,0,P);else if("square"===$){const q=I?1:-1;I||this.addCurrentVertex(O,m,q,q,P),this.addCurrentVertex(O,m,0,0,P),I&&this.addCurrentVertex(O,m,q,q,P)}else"round"===$&&(I&&(this.addCurrentVertex(O,l,0,0,P),this.addCurrentVertex(O,l,1,1,P,!0)),A&&(this.addCurrentVertex(O,u,-1,-1,P,!0),this.addCurrentVertex(O,u,0,0,P)));if(k&&p<y-1){const q=O.dist(A);if(q>2*w){const Z=O.add(A.sub(O)._mult(w/q)._round());this.updateDistance(O,Z),this.addCurrentVertex(Z,u,0,0,P),O=Z}}}}addCurrentVertex(t,r,s,c,d,f=!1){const g=r.y*c-r.x,y=-r.y-r.x*c;this.addHalfVertex(t,r.x+r.y*s,r.y-r.x*s,f,!1,s,d),this.addHalfVertex(t,g,y,f,!0,-c,d)}addHalfVertex({x:t,y:r},s,c,d,f,g,y){this.layoutVertexArray.emplaceBack((t<<1)+(d?1:0),(r<<1)+(f?1:0),Math.round(63*s)+128,Math.round(63*c)+128,1+(0===g?0:g<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const b=y.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,b),y.primitiveLength++),f?this.e2=b:this.e1=b}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}De(Vp,"LineBucket",{omit:["layers","patternFeatures"]});class bi{constructor(t,r,s,c){this.context=t,this.format=s,this.texture=t.gl.createTexture(),this.update(r,c)}update(t,r,s){const{width:c,height:d}=t,{context:f}=this,{gl:g}=f,{HTMLImageElement:y,HTMLCanvasElement:b,HTMLVideoElement:w,ImageData:P,ImageBitmap:O}=lt;if(g.bindTexture(g.TEXTURE_2D,this.texture),f.pixelStoreUnpackFlipY.set(!1),f.pixelStoreUnpack.set(1),f.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!r||!1!==r.premultiply)),s||this.size&&this.size[0]===c&&this.size[1]===d){const{x:I,y:A}=s||{x:0,y:0};if(t instanceof y||t instanceof b||t instanceof w||t instanceof P||O&&t instanceof O)g.texSubImage2D(g.TEXTURE_2D,0,I,A,g.RGBA,g.UNSIGNED_BYTE,t);else{let l=this.format,u=g.UNSIGNED_BYTE;this.format===g.R32F&&(l=g.RED,u=g.FLOAT),g.texSubImage2D(g.TEXTURE_2D,0,I,A,c,d,l,u,t.data)}}else if(this.size=[c,d],t instanceof y||t instanceof b||t instanceof w||t instanceof P||O&&t instanceof O){let I=this.format;this.format===g.R8&&(I=g.RED),g.texImage2D(g.TEXTURE_2D,0,this.format,I,g.UNSIGNED_BYTE,t)}else{let I=this.format,A=this.format,l=g.UNSIGNED_BYTE;this.format===g.DEPTH_COMPONENT&&(I=g.DEPTH_COMPONENT16,l=g.UNSIGNED_SHORT),this.format===g.R32F&&(l=g.FLOAT,A=g.RED),g.texImage2D(g.TEXTURE_2D,0,I,c,d,0,A,l,t.data)}this.useMipmap=!(!r||!r.useMipmap),this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(t,r){const{context:s}=this,{gl:c}=s;c.bindTexture(c.TEXTURE_2D,this.texture),t!==this.minFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,t),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,this.useMipmap?t===c.NEAREST?c.NEAREST_MIPMAP_NEAREST:c.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),r!==this.wrapS&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,r),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,r),this.wrapS=r)}bindExtraParam(t,r,s,c){const{context:d}=this,{gl:f}=d;f.bindTexture(f.TEXTURE_2D,this.texture),r!==this.magFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,r),this.magFilter=r),t!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap?t===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),s!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,s),this.wrapS=s),c!==this.wrapT&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,c),this.wrapT=c)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class pc{constructor(t,r){this.context=t,this.texture=r}bind(t,r){const{context:s}=this,{gl:c}=s;c.bindTexture(c.TEXTURE_2D,this.texture),t!==this.minFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,t),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,t),this.minFilter=t),r!==this.wrapS&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,r),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,r),this.wrapS=r)}}const Qu=new Uint16Array(8184);for(let e=0;e<2046;e++){let t=e+2,r=0,s=0,c=0,d=0,f=0,g=0;for(1&t?c=d=f=32:r=s=g=32;(t>>=1)>1;){const b=r+c>>1,w=s+d>>1;1&t?(c=r,d=s,r=f,s=g):(r=c,s=d,c=f,d=g),f=b,g=w}const y=4*e;Qu[y+0]=r,Qu[y+1]=s,Qu[y+2]=c,Qu[y+3]=d}const wf=new Uint16Array(2178),jp=new Uint8Array(1089),Qv=new Uint16Array(1089);function aE(e){return 0===e?-.03125:32===e?.03125:0}var $x=Dr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const lE={type:2,extent:Dt,loadGeometry:()=>[[new tt(0,0),new tt(Dt+1,0),new tt(Dt+1,Dt+1),new tt(0,Dt+1),new tt(0,0)]]};class Ko{constructor(t,r,s,c,d){this.tileID=t,this.uid=In(),this.uses=0,this.tileSize=r,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=d,c&&c.style&&(this._lastUpdatedBrightness=c.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",c&&c.transform&&(this.projection=c.transform.projection)}registerFadeDuration(t){const r=t+this.timeAdded;r<Mn.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Ku(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,r,s){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(c,d){const f={};if(!d)return f;for(const g of c){const y=g.layerIds.map(b=>d.getLayer(b)).filter(Boolean);if(0!==y.length){g.layers=y,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(b=>y.filter(w=>w.id===b)[0]));for(const b of y)f[b.fqid]=g}}return f}(t.buckets,r.style),this.hasSymbolBuckets=!1;for(const c in this.buckets){const d=this.buckets[c];if(d instanceof xf){if(this.hasSymbolBuckets=!0,!s)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const c in this.buckets){const d=this.buckets[c];if(d instanceof xf&&d.hasRTLText){this.hasRTLText=!0,tl.isLoading()||tl.isLoaded()||"deferred"!==Au()||Vh();break}}this.queryPadding=0;for(const c in this.buckets){const d=this.buckets[c],f=r.style.getOwnLayer(c);if(!f)continue;const g=f.queryRadius(d);this.queryPadding=Math.max(this.queryPadding,g)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new tv}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const s in this.buckets){const c=this.buckets[s];c.uploadPending()&&c.upload(t)}const r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new bi(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new bi(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new bi(t,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t,r,s){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,s),!r||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const c=r.style.getBrightness();(this._lastUpdatedBrightness||c)&&(this._lastUpdatedBrightness&&c&&Math.abs(this._lastUpdatedBrightness-c)<.001||(this._lastUpdatedBrightness=c,this.updateBuckets(void 0,r)))}queryRenderedFeatures(t,r,s,c,d,f,g,y){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:c,pixelPosMatrix:g,transform:f,params:d,tileTransform:this.tileTransform},t,r,s):{}}querySourceFeatures(t,r){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const c=s.loadVTLayers(),d=r?r.sourceLayer:"",f=c._geojsonTileLayer||c[d];if(!f)return;const g=Ou(r&&r.filter),{z:y,x:b,y:w}=this.tileID.canonical,P={z:y,x:b,y:w};for(let O=0;O<f.length;O++){const I=f.feature(O);if(g.needGeometry){const u=jc(I,!0);if(!g.filter(new Ri(this.tileID.overscaledZ),u,this.tileID.canonical))continue}else if(!g.filter(new Ri(this.tileID.overscaledZ),I))continue;const A=s.getId(I,d),l=new ys(I,y,b,w,A);l.tile=P,t.push(l)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}bucketsLoaded(){for(const t in this.buckets)if(this.buckets[t].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const r=this.expirationTime;if(t.cacheControl){const s=Xe(t.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const s=Date.now();let c=!1;if(this.expirationTime>s)c=!1;else if(r)if(this.expirationTime<r)c=!0;else{const d=this.expirationTime-r;d?this.expirationTime=s+Math.max(d,3e4):c=!0}else c=!0;c?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,r){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length&&r&&this.updateBuckets(t,r)}updateBuckets(t,r){if(!this.latestFeatureIndex)return;const s=this.latestFeatureIndex.loadVTLayers(),c=r.style.listImages(),d=r.style.getBrightness();for(const f in this.buckets){if(!r.style.hasLayer(f))continue;const g=this.buckets[f],y=g.layers[0].sourceLayer||"_geojsonTileLayer",b=s[y];let w={};if(t&&(w=t[y],!b||!w||0===Object.keys(w).length))continue;if(g.update(w,b,c,this.imageAtlas&&this.imageAtlas.patternPositions||{},d),g instanceof Vp||g instanceof Ev){const O=r.style.getOwnSourceCache(g.layers[0].source);r._terrain&&r._terrain.enabled&&O&&g.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(O.id,this.tileID)}const P=r&&r.style&&r.style.getOwnLayer(f);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(g)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Mn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Mn.now()+t}setTexture(t,r){const s=r.context,c=s.gl;this.texture=this.texture||r.getTileTexture(t.width),this.texture&&this.texture instanceof bi?this.texture.update(t,{useMipmap:!0}):(this.texture=new bi(s,t,c.RGBA,{useMipmap:!0}),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE))}setDependencies(t,r){const s={};for(const c of r)s[c]=!0;this.dependencies[t]=s}hasDependency(t,r){for(const s of t){const c=this.dependencies[s];if(c)for(const d of r)if(c[d])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,r){if(!r||"mercator"===r.name||this._tileDebugBuffer)return;const s=Ei(lE,this.tileID.canonical,this.tileTransform)[0],c=new pa,d=new c_;for(let f=0;f<s.length;f++){const{x:g,y}=s[f];c.emplaceBack(g,y),d.emplaceBack(f)}d.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(d),this._tileDebugBuffer=t.createVertexBuffer(c,wp.members),this._tileDebugSegments=li.simpleSegment(0,0,c.length,d.length)}_makeTileBoundsBuffers(t,r){if(this._tileBoundsBuffer||!r||"mercator"===r.name)return;const s=Ei(lE,this.tileID.canonical,this.tileTransform)[0];let c,d;if(this.isRaster){const f=function(g,y){const b=Ku(g,y),w=Math.pow(2,g.z);for(let u=0;u<33;u++)for(let p=0;p<33;p++){const m=Da((g.x+(p+aE(p))/32)/w),v=Ji((g.y+(u+aE(u))/32)/w),C=y.project(m,v),E=33*u+p;wf[2*E+0]=Math.round((C.x*b.scale-b.x)*Dt),wf[2*E+1]=Math.round((C.y*b.scale-b.y)*Dt)}jp.fill(0),Qv.fill(0);for(let u=2045;u>=0;u--){const p=4*u,m=Qu[p+0],v=Qu[p+1],C=Qu[p+2],E=Qu[p+3],T=m+C>>1,k=v+E>>1,N=T+k-v,F=k+m-T,$=33*v+m,q=33*E+C,Z=33*k+T,X=Math.hypot((wf[2*$+0]+wf[2*q+0])/2-wf[2*Z+0],(wf[2*$+1]+wf[2*q+1])/2-wf[2*Z+1])>=16;jp[Z]=jp[Z]||(X?1:0),u<1022&&(jp[Z]=jp[Z]||jp[33*(v+F>>1)+(m+N>>1)]||jp[33*(E+F>>1)+(C+N>>1)])}const P=new el,O=new Mo;let I=0;function A(u,p){const m=33*p+u;return 0===Qv[m]&&(P.emplaceBack(wf[2*m+0],wf[2*m+1],u*Dt/32,p*Dt/32),Qv[m]=++I),Qv[m]-1}function l(u,p,m,v,C,E){const T=u+m>>1,k=p+v>>1;if(Math.abs(u-C)+Math.abs(p-E)>1&&jp[33*k+T])l(C,E,u,p,T,k),l(m,v,C,E,T,k);else{const N=A(u,p),F=A(m,v),$=A(C,E);O.emplaceBack(N,F,$)}}return l(0,0,32,32,32,0),l(32,32,0,0,0,32),{vertices:P,indices:O}}(this.tileID.canonical,r);c=f.vertices,d=f.indices}else{c=new el,d=new Mo;for(const{x:g,y}of s)c.emplaceBack(g,y,0,0);const f=Pv(c.int16,void 0,4);for(let g=0;g<f.length;g+=3)d.emplaceBack(f[g],f[g+1],f[g+2])}this._tileBoundsBuffer=t.createVertexBuffer(c,$x.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(d),this._tileBoundsSegments=li.simpleSegment(0,0,c.length,d.length)}_makeGlobeTileDebugBuffers(t,r){const s=r.projection;if(!s||"globe"!==s.name||r.freezeTileCoverage)return;const c=this.tileID.canonical,d=lf(SP(c,r)),f=Po(r.zoom);let g;f>0&&(g=bt.invert(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,c,r,d,g,f),this._makeGlobeTileDebugTextBuffer(t,c,r,d,g,f)}_globePoint(t,r,s,c,d,f,g){let y=af(t,r,s);if(f){const b=1<<s.z,w=yo(c.center.lng),P=Pi(c.center.lat),O=(s.x+.5)/b-w;let I=0;O>.5?I=-1:O<-.5&&(I=1);let A=(t/Dt+s.x)/b+I,l=(r/Dt+s.y)/b;A=(A-w)*c._pixelsPerMercatorPixel+w,l=(l-P)*c._pixelsPerMercatorPixel+P;const u=[A*c.worldSize,l*c.worldSize,0];dt.transformMat4(u,u,f),y=Ud(y,u,g)}return dt.transformMat4(y,y,d)}_makeGlobeTileDebugBorderBuffer(t,r,s,c,d,f){const g=new pa,y=new c_,b=new l_,w=(O,I,A,l,u)=>{const p=(A-O)/(u-1),m=(l-I)/(u-1),v=g.length;for(let C=0;C<u;C++){const E=O+C*p,T=I+C*m;g.emplaceBack(E,T);const k=this._globePoint(E,T,r,s,c,d,f);b.emplaceBack(k[0],k[1],k[2]),y.emplaceBack(v+C)}},P=Dt;w(0,0,P,0,16),w(P,0,P,P,16),w(P,P,0,P,16),w(0,P,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(y),this._tileDebugBuffer=t.createVertexBuffer(g,wp.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(b,OP.members),this._tileDebugSegments=li.simpleSegment(0,0,g.length,y.length)}_makeGlobeTileDebugTextBuffer(t,r,s,c,d,f){const g=Dt/4,y=new pa,b=new Mo,w=new l_,P=25;b.reserve(32),y.reserve(P),w.reserve(P);const O=(I,A)=>P*I+A;for(let I=0;I<P;I++){const A=I*g;for(let l=0;l<P;l++){const u=l*g;y.emplaceBack(u,A);const p=this._globePoint(u,A,r,s,c,d,f);w.emplaceBack(p[0],p[1],p[2])}}for(let I=0;I<4;I++)for(let A=0;A<4;A++){const l=O(I,A),u=O(I,A+1),p=O(I+1,A),m=O(I+1,A+1);b.emplaceBack(l,u,p),b.emplaceBack(p,u,m)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(b),this._tileDebugTextBuffer=t.createVertexBuffer(y,wp.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(w,OP.members),this._tileDebugTextSegments=li.simpleSegment(0,0,P,32)}destroy(t=!1){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!t&&this.texture&&this.texture instanceof bi&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.latestFeatureIndex=null,this.state="unloaded"}}class Gx{constructor(t,r){this.max=t,this.onRemove=r,this.reset()}reset(){for(const t in this.data)for(const r of this.data[t])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(t,r,s){const c=t.wrapped().key;void 0===this.data[c]&&(this.data[c]=[]);const d={value:r,timeout:void 0};if(void 0!==s&&(d.timeout=setTimeout(()=>{this.remove(t,d)},s)),this.data[c].push(d),this.order.push(c),this.order.length>this.max){const f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const r=this.data[t].shift();return r.timeout&&clearTimeout(r.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),r.value}getByKey(t){const r=this.data[t];return r?r[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,r){if(!this.has(t))return this;const s=t.wrapped().key,c=void 0===r?0:this.data[s].indexOf(r),d=this.data[s][c];return this.data[s].splice(c,1),d.timeout&&clearTimeout(d.timeout),0===this.data[s].length&&delete this.data[s],this.onRemove(d.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(t){const r=[];for(const s in this.data)for(const c of this.data[s])t(c.value)||r.push(c);for(const s of r)this.remove(s.value.tileID,s)}}let om=(()=>{class e{constructor(r,s,c,d){this.id=e.uniqueIdxCounter,e.uniqueIdxCounter++,this.context=r;const f=r.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||d||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=e.uniqueIdxCounter,e.uniqueIdxCounter++;const s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}return e.uniqueIdxCounter=0,e})();const cE={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class uE{constructor(t,r,s,c,d,f){this.length=r.length,this.attributes=s,this.itemSize=r.bytesPerElement,this.dynamicDraw=c,this.instanceCount=f,this.context=t;const g=t.gl;this.buffer=g.createBuffer(),t.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||d||r.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,r){for(let s=0;s<this.attributes.length;s++){const c=r.attributes[this.attributes[s].name];void 0!==c&&t.enableVertexAttribArray(c)}}setVertexAttribPointers(t,r,s){for(let c=0;c<this.attributes.length;c++){const d=this.attributes[c],f=r.attributes[d.name];void 0!==f&&t.vertexAttribPointer(f,d.components,t[cE[d.type]],!1,this.itemSize,d.offset+this.itemSize*(s||0))}}setVertexAttribDivisor(t,r,s){for(let c=0;c<this.attributes.length;c++){const d=r.attributes[this.attributes[c].name];void 0!==d&&this.instanceCount&&this.instanceCount>0&&t.vertexAttribDivisor(d,s)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class _r{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Hx extends _r{getDefault(){return bn.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class lC extends _r{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class eh extends _r{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class nh extends _r{getDefault(){return[!0,!0,!0,!0]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class cC extends _r{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class uC extends _r{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Jv extends _r{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const r=this.current;(t.func!==r.func||t.ref!==r.ref||t.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class dC extends _r{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class kT extends _r{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=t,this.dirty=!1}}class hC extends _r{getDefault(){return[0,1]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class fC extends _r{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=t,this.dirty=!1}}class rh extends _r{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class tb extends _r{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.BLEND):r.disable(r.BLEND),this.current=t,this.dirty=!1}}class pC extends _r{getDefault(){const t=this.gl;return[t.ONE,t.ZERO,t.ONE,t.ZERO]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ih extends _r{getDefault(){return bn.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Wc extends _r{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(t,t),this.current=t,this.dirty=!1)}}class gc extends _r{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=t,this.dirty=!1}}class gC extends _r{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class dE extends _r{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let hE=class extends _r{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};class RT extends _r{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class LT extends _r{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class NT extends _r{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class oh extends _r{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class sh extends _r{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class fE extends _r{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class pE extends _r{getDefault(){return null}set(t){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class gE extends _r{getDefault(){return null}set(t){this.gl&&(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class Cf extends _r{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class mC extends _r{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class mE extends _r{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class sm extends _r{constructor(t,r){super(t),this.context=t,this.parent=r}getDefault(){return null}}class qx extends sm{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Mf extends sm{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,this.attachment(),r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class $p extends sm{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,this.attachment(),r.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Gp extends Mf{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class eb{constructor(t,r,s,c,d){this.context=t,this.width=r,this.height=s;const f=this.framebuffer=t.gl.createFramebuffer();c&&(this.colorAttachment=new qx(t,f)),d&&(this.depthAttachmentType=d,this.depthAttachment="renderbuffer"===d?new Mf(t,f):new $p(t,f))}destroy(){const t=this.context.gl;if(this.colorAttachment){const r=this.colorAttachment.get();r&&t.deleteTexture(r)}if(this.depthAttachment&&this.depthAttachmentType)if("renderbuffer"===this.depthAttachmentType){const r=this.depthAttachment.get();r&&t.deleteRenderbuffer(r)}else{const r=this.depthAttachment.get();r&&t.deleteTexture(r)}t.deleteFramebuffer(this.framebuffer)}}class Pn{constructor(t,r,s){this.func=t,this.mask=r,this.range=s}}Pn.ReadOnly=!1,Pn.ReadWrite=!0,Pn.disabled=new Pn(519,Pn.ReadOnly,[0,1]);class Gn{constructor(t,r,s,c,d,f){this.test=t,this.ref=r,this.mask=s,this.fail=c,this.depthFail=d,this.pass=f}}Gn.disabled=new Gn({func:519,mask:0},0,0,7680,7680,7680);class Sr{constructor(t,r,s,c){this.blendFunction=t,this.blendColor=r,this.mask=s,this.blendEquation=c}}Sr.Replace=[1,0,1,0],Sr.disabled=new Sr(Sr.Replace,bn.transparent,[!1,!1,!1,!1]),Sr.unblended=new Sr(Sr.Replace,bn.transparent,[!0,!0,!0,!0]),Sr.alphaBlended=new Sr([1,771,1,771],bn.transparent,[!0,!0,!0,!0]),Sr.multiply=new Sr([774,0,774,0],bn.transparent,[!0,!0,!0,!0]);class Jn{constructor(t,r,s){this.enable=t,this.mode=r,this.frontFace=s}}Jn.disabled=new Jn(!1,1029,2305),Jn.backCCW=new Jn(!0,1029,2305),Jn.backCW=new Jn(!0,1029,2304),Jn.frontCW=new Jn(!0,1028,2304),Jn.frontCCW=new Jn(!0,1028,2305);class rb{constructor(t,r){this.gl=t,this.clearColor=new Hx(this),this.clearDepth=new lC(this),this.clearStencil=new eh(this),this.colorMask=new nh(this),this.depthMask=new cC(this),this.stencilMask=new uC(this),this.stencilFunc=new Jv(this),this.stencilOp=new dC(this),this.stencilTest=new kT(this),this.depthRange=new hC(this),this.depthTest=new fC(this),this.depthFunc=new rh(this),this.blend=new tb(this),this.blendFunc=new pC(this),this.blendColor=new ih(this),this.blendEquation=new Wc(this),this.cullFace=new gc(this),this.cullFaceSide=new gC(this),this.frontFace=new dE(this),this.program=new hE(this),this.activeTexture=new RT(this),this.viewport=new LT(this),this.bindFramebuffer=new NT(this),this.bindRenderbuffer=new oh(this),this.bindTexture=new sh(this),this.bindVertexBuffer=new fE(this),this.bindElementBuffer=new pE(this),this.bindVertexArrayOES=new gE(this),this.pixelStoreUnpack=new Cf(this),this.pixelStoreUnpackPremultiplyAlpha=new mC(this),this.pixelStoreUnpackFlipY=new mE(this),this.options=r?{...r}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=t.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,r,s){return new om(this,t,r,s)}createVertexBuffer(t,r,s,c,d){return new uE(this,t,r,s,c,d)}createRenderbuffer(t,r,s){const c=this.gl,d=c.createRenderbuffer();return this.bindRenderbuffer.set(d),c.renderbufferStorage(c.RENDERBUFFER,t,r,s),this.bindRenderbuffer.set(null),d}createFramebuffer(t,r,s,c){return new eb(this,t,r,s,c)}clear({color:t,depth:r,stencil:s,colorMask:c}){const d=this.gl;let f=0;t&&(f|=d.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(c||[!0,!0,!0,!0])),void 0!==r&&(f|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),void 0!==s&&(f|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(s),this.stencilMask.set(255)),d.clear(f)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){Xt(t.blendFunction,Sr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor),t.blendEquation?this.blendEquation.set(t.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(t.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class Na extends ki{constructor(t,r,s){super(),this.id=t,this._onlySymbols=s,r.on("data",c=>{"source"===c.dataType&&"metadata"===c.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===c.dataType&&"content"===c.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new Gx(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this._coveredTiles={},this._shadowCasterTiles={},this._state=new kv,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(t){this.map=t,this._minTileCacheSize=void 0===this._minTileCacheSize&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const r=this._tiles[t];if("errored"!==r.state&&("loaded"!==r.state||!r.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,r){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,r)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const s=this._tiles[r];s.upload(t),s.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return pe(this._tiles).map(t=>t.tileID).sort(Pf).map(t=>t.key)}getRenderableIds(t,r){const s=[];for(const c in this._tiles)this._isIdRenderable(+c,t,r)&&s.push(this._tiles[c]);return t?s.sort((c,d)=>{const f=c.tileID,g=d.tileID,y=new tt(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),b=new tt(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-g.overscaledZ||b.y-y.y||b.x-y.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort(Pf).map(c=>c.key)}hasRenderableParent(t){const r=this.findLoadedParent(t,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(t,r,s){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(r||!this._tiles[t].holdingForFade())&&(s||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(+t,"reloading")}}_reloadTile(t,r){const s=this._tiles[t];s&&("loading"!==s.state&&(s.state=r),this._loadTile(s,this._tileLoaded.bind(this,s,t,r)))}_tileLoaded(t,r,s,c){if(c)if(t.state="errored",404!==c.status)this._source.fire(new Cn(c,{tile:t}));else{if(!(t.tileID.key in this._loadedParentTiles))return void this._source.fire(new de("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const d=this.map.painter.terrain;this.update(this.transform,d.getScaledDemTileSize(),!0),d.resetTileLookupCache(this.id)}else this.update(this.transform)}else t.timeAdded=Mn.now(),"expired"===s&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(r,t),"raster-dem"===this._source.type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new de("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const r=this.getRenderableIds();for(let c=0;c<r.length;c++){const d=r[c];if(t.neighboringTiles&&t.neighboringTiles[d]){const f=this.getTileByID(d);s(t,f),s(f,t)}}function s(c,d){if(!c.dem||c.dem.borderReady)return;c.needsHillshadePrepare=!0,c.needsDEMTextureUpload=!0;let f=d.tileID.canonical.x-c.tileID.canonical.x;const g=d.tileID.canonical.y-c.tileID.canonical.y,y=Math.pow(2,c.tileID.canonical.z),b=d.tileID.key;0===f&&0===g||Math.abs(g)>1||(Math.abs(f)>1&&(1===Math.abs(f+y)?f+=y:1===Math.abs(f-y)&&(f-=y)),d.dem&&c.dem&&(c.dem.backfillBorder(d.dem,f,g),c.neighboringTiles&&c.neighboringTiles[b]&&(c.neighboringTiles[b].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,r,s,c){for(const d in this._tiles){let f=this._tiles[d];if(c[d]||!f.hasData()||f.tileID.overscaledZ<=r||f.tileID.overscaledZ>s)continue;let g=f.tileID;for(;f&&f.tileID.overscaledZ>r+1;){const b=f.tileID.scaledTo(f.tileID.overscaledZ-1);f=this._tiles[b.key],f&&f.hasData()&&(g=b)}let y=g;for(;y.overscaledZ>r;)if(y=y.scaledTo(y.overscaledZ-1),t[y.key]){c[g.key]=g;break}}}findLoadedParent(t,r){if(t.key in this._loadedParentTiles){const s=this._loadedParentTiles[t.key];return s&&s.tileID.overscaledZ>=r?s:null}for(let s=t.overscaledZ-1;s>=r;s--){const c=t.scaledTo(s),d=this._getLoadedTile(c);if(d)return d}}_getLoadedTile(t){const r=this._tiles[t.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,r){r=r||this._source.tileSize;const s=Math.ceil(t.width/r)+1,c=Math.ceil(t.height/r)+1,d=Math.floor(s*c*5),f="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,d):d,g="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(g)}handleWrapJump(t){const r=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,r){const s={};for(const c in this._tiles){const d=this._tiles[c];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+r),s[d.tileID.key]=d}this._tiles=s;for(const c in this._timers)clearTimeout(this._timers[c]),delete this._timers[c];for(const c in this._tiles)this._setTileReloadTimer(+c,this._tiles[c])}}update(t,r,s,c){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let d;if(this.updateCacheSize(t,r),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new Ir(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y)):(d=t.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(d=d.filter(y=>this._source.hasTile(y)))):d=[],d.length>0&&this.castsShadows&&c&&"globe"!==this.transform.projection.name&&!this.usedForTerrain&&!_C(this._source.type)){const y=t.coveringZoomLevel({tileSize:r||this._source.tileSize,roundZoom:this._source.roundZoom&&!s}),b=Math.min(y,this._source.maxzoom),w=t.extendTileCoverForShadows(d,c,b);for(const P of w)this._shadowCasterTiles[P.key]=!0,d.push(P)}const f=this._updateRetainedTiles(d);if(_C(this._source.type)&&0!==d.length){const y={},b={},w=Object.keys(f);for(const O of w){const I=f[O],A=this._tiles[O];if(!A||A.fadeEndTime&&A.fadeEndTime<=Mn.now())continue;const l=this.findLoadedParent(I,Math.max(I.overscaledZ-Na.maxOverzooming,this._source.minzoom));l&&(this._addTile(l.tileID),y[l.tileID.key]=l.tileID),b[O]=I}const P=d[d.length-1].overscaledZ;for(const O in this._tiles){const I=this._tiles[O];if(f[O]||!I.hasData())continue;let A=I.tileID;for(;A.overscaledZ>P;){A=A.scaledTo(A.overscaledZ-1);const l=this._tiles[A.key];if(l&&l.hasData()&&b[A.key]){f[O]=I.tileID;break}}}for(const O in y)f[O]||(this._coveredTiles[O]=!0,f[O]=y[O])}for(const y in f)this._tiles[y].clearFadeHold();const g=function(y,b){const w=[];for(const P in y)P in b||w.push(P);return w}(this._tiles,f);for(const y of g){const b=this._tiles[y];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(+y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const r={};if(0===t.length)return r;const s={},c=t.reduce((b,w)=>Math.min(b,w.overscaledZ),1/0),d=t[0].overscaledZ,f=Math.max(d-Na.maxOverzooming,this._source.minzoom),g=Math.max(d+Na.maxUnderzooming,this._source.minzoom),y={};for(const b of t){const w=this._addTile(b);r[b.key]=b,w.hasData()||c<this._source.maxzoom&&(y[b.key]=b)}this._retainLoadedChildren(y,c,g,r);for(const b of t){let w=this._tiles[b.key];if(w.hasData())continue;if(b.canonical.z>=this._source.maxzoom){const O=b.children(this._source.maxzoom)[0],I=this.getTile(O);if(I&&I.hasData()){r[O.key]=O;continue}}else{const O=b.children(this._source.maxzoom);if(r[O[0].key]&&r[O[1].key]&&r[O[2].key]&&r[O[3].key])continue}let P=w.wasRequested();for(let O=b.overscaledZ-1;O>=f;--O){const I=b.scaledTo(O);if(s[I.key]||(s[I.key]=!0,w=this.getTile(I),!w&&P&&(w=this._addTile(I)),w&&(r[I.key]=I,P=w.wasRequested(),w.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const r=[];let s,c=this._tiles[t].tileID;for(;c.overscaledZ>0;){if(c.key in this._loadedParentTiles){s=this._loadedParentTiles[c.key];break}r.push(c.key);const d=c.scaledTo(c.overscaledZ-1);if(s=this._getLoadedTile(d),s)break;c=d}for(const d of r)this._loadedParentTiles[d]=s}}_addTile(t){let r=this._tiles[t.key];if(r)return!0!==r.isExtraShadowCaster||this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),r;r=this._cache.getAndRemove(t),r&&(this._setTileReloadTimer(t.key,r),r.tileID=t,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,r)));const s=!!r;if(!s){const c=this.map?this.map.painter:null;r=new Ko(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,c,this._isRaster),this._loadTile(r,this._tileLoaded.bind(this,r,t.key,r.state))}return r?(r.uses++,this._tiles[t.key]=r,s||this._source.fire(new de("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(t,r){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const s=r.getExpiryTimeout();s&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},s))}_removeTile(t){const r=this._tiles[t];r&&(r.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),r.uses>0||(r.hasData()&&"reloading"!==r.state?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,r,s){const c=[],d=this.transform;if(!d)return c;const f="globe"===d.projection.name,g=yo(d.center.lng);for(const y in this._tiles){const b=this._tiles[y];if(s&&b.clearQueryDebugViz(),b.holdingForFade())continue;let w;if(f){const P=b.tileID.canonical;if(0===P.z){const O=[Math.abs(Ne(g,...ry(P,-1))-g),Math.abs(Ne(g,...ry(P,1))-g)];w=[0,2*O.indexOf(Math.min(...O))-1]}else{const O=[Math.abs(Ne(g,...ry(P,-1))-g),Math.abs(Ne(g,...ry(P,0))-g),Math.abs(Ne(g,...ry(P,1))-g)];w=[O.indexOf(Math.min(...O))-1]}}else w=[0];for(const P of w){const O=t.containsTile(b,d,r,P);O&&c.push(O)}}return c}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,r){const s=this.getRenderableIds(t,r).map(d=>this._tiles[d].tileID),c="globe"===this.transform.projection.name;for(const d of s)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped()),d.expandedProjMatrix=c?this.transform.calculateProjMatrix(d.toUnwrapped(),!1,!0):d.projMatrix;return s}sortCoordinatesByDistance(t){const r=t.slice(),s=this.transform._camera.position,c=this.transform._camera.forward(),d={};for(const f of r){const g=1/(1<<f.canonical.z);d[f.key]=((f.canonical.x+.5)*g+f.wrap-s[0])*c[0]+((f.canonical.y+.5)*g-s[1])*c[1]-s[2]*c[2]}return r.sort((f,g)=>d[f.key]-d[g.key]),r}hasTransition(){if(this._source.hasTransition())return!0;if(_C(this._source.type))for(const t in this._tiles){const r=this._tiles[t];if(void 0!==r.fadeEndTime&&r.fadeEndTime>=Mn.now())return!0}return!1}setFeatureState(t,r,s){this._state.updateState(t=t||"_geojsonTileLayer",r,s)}removeFeatureState(t,r,s){this._state.removeFeatureState(t=t||"_geojsonTileLayer",r,s)}getFeatureState(t,r){return this._state.getState(t=t||"_geojsonTileLayer",r)}setDependencies(t,r,s){const c=this._tiles[t];c&&c.setDependencies(r,s)}reloadTilesForDependencies(t,r){for(const s in this._tiles)this._tiles[s].hasDependency(t,r)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(t,r))}_preloadTiles(t,r){if(!this._sourceLoaded){const g=()=>{this._sourceLoaded&&(this._source.off("data",g),this._preloadTiles(t,r))};return void this._source.on("data",g)}const s=new Map,c=Array.isArray(t)?t:[t],d=this.map.painter.terrain,f=this.usedForTerrain&&d?d.getScaledDemTileSize():this._source.tileSize;for(const g of c){const y=g.coveringTiles({tileSize:f,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const b of y)s.set(b.key,b);this.usedForTerrain&&g.updateElevation(!1)}Kt(Array.from(s.values()),(g,y)=>{const b=new Ko(g,this._source.tileSize*g.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(b,w=>{"raster-dem"===this._source.type&&b.dem&&this._backfillDEM(b),y(w,b)})},r)}}function Pf(e,t){const r=Math.abs(2*e.wrap)-+(e.wrap<0),s=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||s-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function _C(e){return"raster"===e||"image"===e||"video"===e||"custom"===e}function ry(e,t){const r=1<<e.z;return[e.x/r+t,(e.x+1)/r+t]}Na.maxOverzooming=10,Na.maxUnderzooming=3;const FT=Dr([{name:"a_pos_3f",components:3,type:"Float32"}]),zT=Dr([{name:"a_color_3f",components:3,type:"Float32"}]),BT=Dr([{name:"a_color_4f",components:4,type:"Float32"}]),ib=Dr([{name:"a_uv_2f",components:2,type:"Float32"}]),cm=Dr([{name:"a_normal_3f",components:3,type:"Float32"}]),Hp=Dr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),_E=Dr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class yC{constructor(t=0,r=0,s=0,c=0){if(isNaN(t)||t<0||isNaN(r)||r<0||isNaN(s)||s<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=r,this.left=s,this.right=c}interpolate(t,r,s){return null!=r.top&&null!=t.top&&(this.top=vn(t.top,r.top,s)),null!=r.bottom&&null!=t.bottom&&(this.bottom=vn(t.bottom,r.bottom,s)),null!=r.left&&null!=t.left&&(this.left=vn(t.left,r.left,s)),null!=r.right&&null!=t.right&&(this.right=vn(t.right,r.right,s)),this}getCenter(t,r){const s=Ne((this.left+t-this.right)/2,0,t),c=Ne((this.top+r-this.bottom)/2,0,r);return new tt(s,c)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new yC(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function vC(e,t){const r=ur(e,3);bt.fromQuat(e,t),yn(e,3,r)}function bC(e,t){const r=Bo.identity([]);return Bo.rotateZ(r,r,-t),Bo.rotateX(r,r,-e),r}function Wx(e,t){const r=[e[0],e[1],0],s=[t[0],t[1],0];if(dt.length(r)>=1e-15){const f=dt.normalize([],r);dt.scale(s,f,dt.dot(s,f)),t[0]=s[0],t[1]=s[1]}const c=dt.cross([],t,e);if(dt.len(c)<1e-15)return null;const d=Math.atan2(-c[1],c[0]);return bC(Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2]),d)}class Kx{constructor(t,r){this.position=t,this.orientation=r}get position(){return this._position}set position(t){if(t){const r=t instanceof Xn?t:new Xn(t[0],t[1],t[2]);this._renderWorldCopies&&(r.x=Wt(r.x,0,1)),this._position=r}else this._position=null}lookAtPoint(t,r){if(this.orientation=null,!this.position)return;const s=this.position,c=this._elevation?this._elevation.getAtPointOrZero(Xn.fromLngLat(t)):0,d=Xn.fromLngLat(t,c),f=[d.x-s.x,d.y-s.y,d.z-s.z];r||(r=[0,0,1]),r[2]=Math.abs(r[2]),this.orientation=Wx(f,r)}setPitchBearing(t,r){this.orientation=bC(Ct(t),Ct(-r))}}class ob{constructor(t,r){this._transform=bt.identity([]),this.orientation=r,this.position=t}get mercatorPosition(){const t=this.position;return new Xn(t[0],t[1],t[2])}get position(){const t=ur(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var r;t&&yn(this._transform,3,[(r=t)[0],r[1],r[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||Bo.identity([]),t&&vC(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),r=this.right();return{bearing:Math.atan2(-r[1],r[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,r){this._orientation=bC(t,r),vC(this._transform,this._orientation)}forward(){const t=ur(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=ur(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=ur(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,r){const s=new Float64Array(16);return bt.invert(s,this.getWorldToCamera(t,r)),s}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(t,r,s){const c=this.position;dt.scale(c,c,-t);const d=new Float64Array(16);return bt.fromScaling(d,[s,s,s]),bt.translate(d,d,c),d[10]*=r,d}getWorldToCamera(t,r){const s=new Float64Array(16),c=new Float64Array(4),d=this.position;return Bo.conjugate(c,this._orientation),dt.scale(d,d,-t),bt.fromQuat(s,c),bt.translate(s,s,d),s[1]*=-1,s[5]*=-1,s[9]*=-1,s[13]*=-1,s[8]*=r,s[9]*=r,s[10]*=r,s[11]*=r,s}getCameraToClipPerspective(t,r,s,c){const d=new Float64Array(16);return bt.perspective(d,t,r,s,c),d}getCameraToClipOrthographic(t,r,s,c,d,f){const g=new Float64Array(16);return bt.ortho(g,t,r,s,c,d,f),g}getDistanceToElevation(t,r=!1){const s=0===t?0:ii(t,r?Ji(this.position[1]):this.position[1]),c=this.forward();return(s-this.position[2])/c[2]}clone(){return new ob([...this.position],[...this.orientation])}}function Yx(e,t){const r=iy(e.projection,e.zoom,e.width,e.height),s=function(d,f,g,y,b){const w=new kn(g.lng-180*Kc,g.lat),P=new kn(g.lng+180*Kc,g.lat),O=d.project(w.lng,w.lat),I=d.project(P.lng,P.lat),A=-Math.atan2(I.y-O.y,I.x-O.x),l=Xn.fromLngLat(g);l.y=Ne(l.y,-1+Kc,1-Kc);const u=l.toLngLat(),p=d.project(u.lng,u.lat),m=Xn.fromLngLat(u);m.x+=Kc;const v=m.toLngLat(),C=d.project(v.lng,v.lat),E=sb(C.x-p.x,C.y-p.y,A),T=Xn.fromLngLat(u);T.y+=Kc;const k=T.toLngLat(),N=d.project(k.lng,k.lat),F=sb(N.x-p.x,N.y-p.y,A),$=Math.abs(E.x)/Math.abs(F.y),q=bt.identity([]);bt.rotateZ(q,q,-A*(1-(b?0:y)));const Z=bt.identity([]);return bt.scale(Z,Z,[1,1-(1-$)*y,1]),Z[4]=-F.x/F.y*y,bt.rotateZ(Z,Z,A),bt.multiply(Z,q,Z),Z}(e.projection,0,e.center,r,t),c=Xx(e);return bt.scale(s,s,[c,c,1]),s}function Xx(e){const t=e.projection,r=iy(e.projection,e.zoom,e.width,e.height),s=xC(t,e.center),c=xC(t,kn.convert(t.center));return Math.pow(2,s*r+(1-r)*c)}function iy(e,t,r,s,c=1/0){const d=e.range;if(!d)return 0;const f=Math.min(c,Math.max(r,s)),g=Math.log(f/1024)/Math.LN2;return vs(d[0]+g,d[1]+g,t)}const Kc=1/4e4;function xC(e,t){const r=Ne(t.lat,-yi,yi),s=new kn(t.lng-180*Kc,r),c=new kn(t.lng+180*Kc,r),d=e.project(s.lng,r),f=e.project(c.lng,r),g=Xn.fromLngLat(s),y=Xn.fromLngLat(c),b=f.x-d.x,w=f.y-d.y,P=y.x-g.x,O=y.y-g.y,I=Math.sqrt((P*P+O*O)/(b*b+w*w));return Math.log(I)/Math.LN2}function sb(e,t,r){const s=Math.cos(r),c=Math.sin(r);return{x:e*s-t*c,y:e*c+t*s}}function Ju(e,t,r){return t*(Dt/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}const um={unknown:0,flipRequired:1,flipNotRequired:2},wC=Math.tan(85*Math.PI/180);function Ef(e,t,r,s,c,d,f){const g=bt.create();if(r)if("globe"===d.name){const y=function(b,w){const{x:P,y:O}=b.point,I=cx(P,O,b.worldSize/b._pixelsPerMercatorPixel,0,0);return bt.multiply(I,I,D_(Mi(w)))}(c,t);bt.multiply(g,g,y)}else{const y=Rg.invert([],f);g[0]=y[0],g[1]=y[1],g[4]=y[2],g[5]=y[3],s||bt.rotateZ(g,g,c.angle)}else bt.multiply(g,c.labelPlaneMatrix,e);return g}function oy(e,t,r,s,c,d,f){const g=Ef(e,t,r,s,c,d,f);return"globe"===d.name&&r||(g[2]=g[6]=g[10]=g[14]=0),g}function dm(e,t,r,s,c,d,f){if(r){if("globe"===d.name){const g=Ef(e,t,r,s,c,d,f);return bt.invert(g,g),bt.multiply(g,e,g),g}{const g=bt.clone(e),y=bt.identity([]);return y[0]=f[0],y[1]=f[1],y[4]=f[2],y[5]=f[3],bt.multiply(g,g,y),s||bt.rotateZ(g,g,-c.angle),g}}return c.glCoordMatrix}function mc(e,t,r,s){const c=[e,t,r,1];r?kr.transformMat4(c,c,s):UT(c,c,s);const d=c[3];return c[0]/=d,c[1]/=d,c[2]/=d,c}function Qx(e,t){return Math.min(.5+e/t*.5,1.5)}function os(e,t){const r=e[0]/e[3],s=e[1]/e[3];return r>=-t[0]&&r<=t[0]&&s>=-t[1]&&s<=t[1]}function yE(e,t,r,s,c,d,f,g,y,b){const w=r.transform,P=s?e.textSizeData:e.iconSizeData,O=co(P,r.transform.zoom),I="globe"===w.projection.name,A=[256/r.width*2+1,256/r.height*2+1],l=s?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;l.clear();let u=null;I&&(u=s?e.text.globeExtVertexArray:e.icon.globeExtVertexArray);const p=e.lineVertexArray,m=s?e.text.placedSymbolArray:e.icon.placedSymbolArray,v=r.transform.width/r.transform.height;let C,E=!1;for(let T=0;T<m.length;T++){const k=m.get(T),{numGlyphs:N,writingMode:F}=k;if(F!==si.vertical||E||C===si.horizontal||(E=!0),C=F,(k.hidden||F===si.vertical)&&!E){_c(N,l);continue}E=!1;const $=new tt(k.tileAnchorX,k.tileAnchorY);let{x:q,y:Z,z:X}=w.projection.projectTilePoint($.x,$.y,b.canonical);if(y){const[zt,Nt,$t]=y($);q+=zt,Z+=Nt,X+=$t}const K=[q,Z,X,1];if(kr.transformMat4(K,K,t),!os(K,A)){_c(N,l);continue}const J=K[3],st=Qx(r.transform.getCameraToCenterDistance(w.projection),J),ot=Wg(P,O,k),rt=f?ot/st:ot*st,ct=mc(q,Z,X,c);if(ct[3]<=0){_c(N,l);continue}let yt={};const Ot=f?null:y,Tt=vE(k,rt,!1,g,t,c,d,e.glyphOffsetArray,p,l,u,ct,$,yt,v,Ot,w.projection,b,f);E=Tt.useVertical,Ot&&Tt.needsFlipping&&(yt={}),(Tt.notEnoughRoom||E||Tt.needsFlipping&&vE(k,rt,!0,g,t,c,d,e.glyphOffsetArray,p,l,u,ct,$,yt,v,Ot,w.projection,b,f).notEnoughRoom)&&_c(N,l)}s?(e.text.dynamicLayoutVertexBuffer.updateData(l),u&&e.text.globeExtVertexBuffer&&e.text.globeExtVertexBuffer.updateData(u)):(e.icon.dynamicLayoutVertexBuffer.updateData(l),u&&e.icon.globeExtVertexBuffer&&e.icon.globeExtVertexBuffer.updateData(u))}function ab(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l){const{lineStartIndex:u,glyphStartIndex:p,segment:m}=g,v=p+g.numGlyphs,C=u+g.lineLength,E=t.getoffsetX(p),T=t.getoffsetX(v-1),k=ay(e*E,r,s,c,d,f,m,u,C,y,b,w,P,O,!0,I,A,l);if(!k)return null;const N=ay(e*T,r,s,c,d,f,m,u,C,y,b,w,P,O,!0,I,A,l);return N?{first:k,last:N}:null}function ah(e,t,r,s){return e===si.horizontal&&Math.abs(s)>Math.abs(r)?{useVertical:!0}:e===si.vertical?s>0?{needsFlipping:!0}:null:t!==um.unknown&&(0===(c=r)||Math.abs(s/c)>wC)?t===um.flipRequired?{needsFlipping:!0}:null:r<0?{needsFlipping:!0}:null;var c}function vE(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p,m){const v=t/24,C=e.lineOffsetX*v,E=e.lineOffsetY*v,{lineStartIndex:T,glyphStartIndex:k,numGlyphs:N,segment:F,writingMode:$,flipState:q}=e,Z=T+e.lineLength,X=K=>{if(w){const[rt,ct,yt]=K.up,Ot=b.length;Zv(w,Ot+0,rt,ct,yt),Zv(w,Ot+1,rt,ct,yt),Zv(w,Ot+2,rt,ct,yt),Zv(w,Ot+3,rt,ct,yt)}const[J,st,ot]=K.point;uo(b,J,st,ot,K.angle)};if(N>1){const K=ab(v,g,C,E,r,P,O,e,y,d,I,l,!1,u,p,m);if(!K)return{notEnoughRoom:!0};if(s&&!r){let[J,st,ot]=K.first.point,[rt,ct,yt]=K.last.point;[J,st]=mc(J,st,ot,f),[rt,ct]=mc(rt,ct,yt,f);const Ot=ah($,q,(rt-J)*A,ct-st);if(e.flipState=Ot&&Ot.needsFlipping?um.flipRequired:um.flipNotRequired,Ot)return Ot}X(K.first);for(let J=k+1;J<k+N-1;J++){const st=ay(v*g.getoffsetX(J),C,E,r,P,O,F,T,Z,y,d,I,l,!1,!1,u,p,m);if(!st)return b.length-=4*(J-k),{notEnoughRoom:!0};X(st)}X(K.last)}else{if(s&&!r){const J=mc(O.x,O.y,0,c),st=T+F+1,ot=new tt(y.getx(st),y.gety(st)),rt=mc(ot.x,ot.y,0,c),ct=rt[3]>0?rt:sy(O,ot,J,1,c,void 0,u,p.canonical),yt=ah($,q,(ct[0]-J[0])*A,ct[1]-J[1]);if(e.flipState=yt&&yt.needsFlipping?um.flipRequired:um.flipNotRequired,yt)return yt}const K=ay(v*g.getoffsetX(k),C,E,r,P,O,F,T,Z,y,d,I,l,!1,!1,u,p,m);if(!K)return{notEnoughRoom:!0};X(K)}return{}}function td(e,t,r,s,c){const{x:d,y:f,z:g}=s.projectTilePoint(e.x,e.y,t);if(!c)return mc(d,f,g,r);const[y,b,w]=c(e);return mc(d+y,f+b,g+w,r)}function sy(e,t,r,s,c,d,f,g){const y=td(e.sub(t)._unit()._add(e),g,c,f,d);return dt.sub(y,r,y),dt.normalize(y,y),dt.scaleAndAdd(y,r,y,s)}function ay(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p){const m=s?e-t:e+t;let v=m>0?1:-1,C=0;s&&(v*=-1,C=Math.PI),v<0&&(C+=Math.PI);let E=g+f+(v>0?0:1)|0,T=c,k=c,N=0,F=0;const $=Math.abs(m),q=[],Z=[];let X=d,K=X;const J=()=>sy(K,X,k,$-N+1,w,O,l,u.canonical);for(;N+F<=$;){if(E+=v,E<g||E>=y)return null;if(k=T,K=X,q.push(k),I&&Z.push(K),X=new tt(b.getx(E),b.gety(E)),T=P[E],!T){const Nt=td(X,u.canonical,w,l,O);T=Nt[3]>0?P[E]=Nt:J()}N+=F,F=dt.distance(k,T)}A&&O&&(P[E]&&(T=J(),F=dt.distance(k,T)),P[E]=T);const st=($-N)/F,ot=X.sub(K)._mult(st)._add(K),rt=dt.sub([],T,k),ct=dt.scaleAndAdd([],k,rt,st);let yt=[0,0,1],Ot=rt[0],Tt=rt[1];if(p&&(yt=l.upVector(u.canonical,ot.x,ot.y),0!==yt[0]||0!==yt[1]||1!==yt[2])){const Nt=[yt[2],0,-yt[0]],$t=dt.cross([],yt,Nt);dt.normalize(Nt,Nt),dt.normalize($t,$t),Ot=dt.dot(rt,Nt),Tt=dt.dot(rt,$t)}if(r){const Nt=dt.cross([],yt,rt);dt.normalize(Nt,Nt),dt.scaleAndAdd(ct,ct,Nt,r*v)}const zt=C+Math.atan2(Tt,Ot);return q.push(ct),I&&Z.push(ot),{point:ct,angle:zt,path:q,tilePath:Z,up:yt}}function _c(e,t){const r=t.length,s=r+4*e;t.resize(s),t.float32.fill(-1/0,4*r,4*s)}function UT(e,t,r){const s=t[0],c=t[1];return e[0]=r[0]*s+r[4]*c+r[12],e[1]=r[1]*s+r[5]*c+r[13],e[3]=r[3]*s+r[7]*c+r[15],e}const Yc=(e,t,r)=>(1-r)*e+r*t,CC=e=>e*e*e*e*e;class lh{constructor(t,r,s,c,d,f,g){this.tileSize=512,this._renderWorldCopies=void 0===d||d,this._minZoom=t||0,this._maxZoom=r||22,this._minPitch=s??0,this._maxPitch=c??60,this.setProjection(f),this.setMaxBounds(g),this.width=0,this.height=0,this._center=new kn(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new yC,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new ob,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const t=new lh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get isOrthographic(){return"globe"!==this.projection.name&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return"globe"!==this.projection.name&&!this.isOrthographic}updateElevation(t,r=!1){const s=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||s)&&this._updateCameraOnTerrain(),(t||s)&&this._constrainCamera(r),this._calcMatrices()}getProjection(){return he(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const r=this.projection?this.getProjection():void 0;this.projection=Dl(this.projectionOptions);const s=!Xt(r,this.getProjection());return s&&this._calcMatrices(),this.mercatorFromTransition=!1,s}setOrthographicProjectionAtLowPitch(t){return this._orthographicProjectionAtLowPitch!==t&&(this._orthographicProjectionAtLowPitch=t,this._calcMatrices(),!0)}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=Dl({name:"mercator"});const r=t!==this.projection.name;return r&&this._calcMatrices(),r}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return ii(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new tt(this.width,this.height)}get bearing(){return Wt(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const r=-t*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=Rg.create(),Rg.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const r=Ne(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=Ct(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const r=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==r&&(this._unmodified=!1,this._setZoom(r),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){const t=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,r=this.elevation&&t===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||t===Number.NEGATIVE_INFINITY&&(!r||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const s=this._elevation;r||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&s.exaggeration()&&this._centerAltitudeValidForExaggeration!==s.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*s.exaggeration(),this._centerAltitudeValidForExaggeration=s.exaggeration()):(this._centerAltitude=t||0,this._centerAltitudeValidForExaggeration=s.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,r=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],s=this.horizonLineFromTop();let c=0,d=0;for(let f=0;f<r.length;f++){const g=new tt(r[f][0]*this.width,s+r[f][1]*(this.height-s)),y=t.pointCoordinate(g);if(!y)continue;const b=1/Math.hypot(y[0]-this._camera.position[0],y[1]-this._camera.position[1]);c+=y[3]*b,d+=b}return 0===d?NaN:c/d}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const t=this._seaLevelZoom,r=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),s=this.pixelsPerMeter/this.worldSize*r,c=this._mercatorZfromZoom(t),d=this._mercatorZfromZoom(this._maxZoom),f=Math.max(c-s,d);this._setZoom(this._zoomFromMercatorZ(f))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const r=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let s;s=t.z<this._camera.position[2]?[r.x,r.y,r.z]:[t.x,t.y,t.z];const c=dt.length(dt.sub([],this._camera.position,s));return Ne(this._zoomFromMercatorZ(c),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let r=!1;if(t.orientation&&!Bo.exactEquals(t.orientation,this._camera.orientation)&&(r=this._setCameraOrientation(t.orientation)),t.position){const s=[t.position.x,t.position.y,t.position.z];dt.exactEquals(s,this._camera.position)||(this._setCameraPosition(s),r=!0)}r&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,r=new Kx;return r.position=new Xn(t[0],t[1],t[2]),r.orientation=this._camera.orientation,r._elevation=this.elevation,r._renderWorldCopies=this.renderWorldCopies,r}_setCameraOrientation(t){if(!Bo.length(t))return!1;Bo.normalize(t,t);const r=dt.transformQuat([],[0,0,-1],t),s=dt.transformQuat([],[0,-1,0],t);if(s[2]<0)return!1;const c=Wx(r,s);return!!c&&(this._camera.orientation=c,!0)}_setCameraPosition(t){const r=this.zoomScale(this.minZoom)*this.tileSize,s=this.zoomScale(this.maxZoom)*this.tileSize,c=this.cameraToCenterDistance;t[2]=Ne(t[2],c/s,c/r),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,r,s){this._unmodified=!1,this._edgeInsets.interpolate(t,r,s),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const r=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,r)}getVisibleUnwrappedCoordinates(t){const r=[new hv(0,t)];if(this.renderWorldCopies){const s=this.pointCoordinate(new tt(0,0)),c=this.pointCoordinate(new tt(this.width,0)),d=this.pointCoordinate(new tt(this.width,this.height)),f=this.pointCoordinate(new tt(0,this.height)),g=Math.floor(Math.min(s.x,c.x,d.x,f.x)),y=Math.floor(Math.max(s.x,c.x,d.x,f.x)),b=1;for(let w=g-b;w<=y+b;w++)0!==w&&r.push(new hv(w,t))}return r}isLODDisabled(t){return(!t||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(t,r,s){let c=[];if(0===r[0]&&0===r[1])return c;for(const f of t){const g=f.canonical,y=f.overscaledZ,b=f.wrap,w=1<<g.z,P=g.x+1<w,O=g.x>0,I=g.y+1<w,A=g.y>0,l=f.wrap-(O?0:1),u=f.wrap+(P?0:1),p=O?g.x-1:w-1,m=P?g.x+1:0;r[0]<0?(c.push(new Ir(y,u,g.z,m,g.y)),r[1]<0&&I&&(c.push(new Ir(y,b,g.z,g.x,g.y+1)),c.push(new Ir(y,u,g.z,m,g.y+1))),r[1]>0&&A&&(c.push(new Ir(y,b,g.z,g.x,g.y-1)),c.push(new Ir(y,u,g.z,m,g.y-1)))):r[0]>0?(c.push(new Ir(y,l,g.z,p,g.y)),r[1]<0&&I&&(c.push(new Ir(y,b,g.z,g.x,g.y+1)),c.push(new Ir(y,l,g.z,p,g.y+1))),r[1]>0&&A&&(c.push(new Ir(y,b,g.z,g.x,g.y-1)),c.push(new Ir(y,l,g.z,p,g.y-1)))):r[1]<0&&I?c.push(new Ir(y,b,g.z,g.x,g.y+1)):A&&c.push(new Ir(y,b,g.z,g.x,g.y-1))}if(c.length>1){c.sort((y,b)=>y.overscaledZ-b.overscaledZ||y.wrap-b.wrap||y.canonical.z-b.canonical.z||y.canonical.x-b.canonical.x||y.canonical.y-b.canonical.y);let f=0,g=0;for(;g<c.length;)c[g].equals(c[f])?++g:c[++f]=c[g++];c.length=f+1}const d=[];for(const f of c)c.some(g=>f.isChildOf(g))||d.push(f);return c=d.filter(f=>!t.some(g=>!!(f.overscaledZ<s&&g.isChildOf(f))||f.equals(g)||f.isChildOf(g))),c}coveringTiles(t){let r=this.coveringZoomLevel(t);const s=r,c=this.elevation&&this.elevation.exaggeration(),d=c&&!t.isTerrainDEM,f="mercator"===this.projection.name;if(void 0!==t.minzoom&&r<t.minzoom)return[];void 0!==t.maxzoom&&r>t.maxzoom&&(r=t.maxzoom);const g=this.locationCoordinate(this.center),y=this.center.lat,b=1<<r,w=[b*g.x,b*g.y,0],P="globe"===this.projection.name,O=!P,I=sc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,O),A=P?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),l=b*ii(1,this.center.lat),u=this._camera.position[2]/ii(1,this.center.lat),p=[b*A.x,b*A.y,u*(O?1:l)],m=P||c,v=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),C=this.isLODDisabled(!0)?r:0;let E;if(this._elevation&&t.isTerrainDEM)E=1e4*this._elevation.exaggeration();else if(this._elevation){const rt=this._elevation.getMinMaxForVisibleTiles();E=rt?rt.max:this._centerAltitude}else E=this._centerAltitude;const T=t.isTerrainDEM?-E:this._elevation?this._elevation.getMinElevationBelowMSL():0,k=this.projection.isReprojectedInTileSpace?Xx(this):1,N=rt=>{const yt=new Xn(rt.x+25e-6,rt.y,rt.z),Ot=new Xn(rt.x,rt.y+25e-6,rt.z),Tt=rt.toLngLat(),zt=yt.toLngLat(),Nt=Ot.toLngLat(),$t=this.locationCoordinate(Tt),Rt=this.locationCoordinate(zt),ie=this.locationCoordinate(Nt),Ee=Math.hypot(Rt.x-$t.x,Rt.y-$t.y),Oe=Math.hypot(ie.x-$t.x,ie.y-$t.y);return Math.sqrt(Ee*Oe)*k/25e-6},F=rt=>{const ct=E,yt=T;return{aabb:rE(this,b,0,0,0,rt,yt,ct,this.projection),zoom:0,x:0,y:0,minZ:yt,maxZ:ct,wrap:rt,fullyVisible:!1}},$=[];let q=[];const Z=r,X=t.reparseOverscaled?s:r,K=rt=>rt*rt,J=K((u-this._centerAltitude)*l),st=rt=>{if(!this._elevation||!rt.tileID||!f)return;const ct=this._elevation.getMinMaxForTile(rt.tileID),yt=rt.aabb;ct?(yt.min[2]=ct.min,yt.max[2]=ct.max,yt.center[2]=(yt.min[2]+yt.max[2])/2):(rt.shouldSplit=ot(rt),rt.shouldSplit||(yt.min[2]=yt.max[2]=yt.center[2]=this._centerAltitude))},ot=rt=>{if(rt.zoom<C)return!0;if(rt.zoom===Z)return!1;if(null!=rt.shouldSplit)return rt.shouldSplit;const ct=rt.aabb.distanceX(p),yt=rt.aabb.distanceY(p);let Ot=J,Tt=1;if(P){Ot=K(rt.aabb.distanceZ(p));const $t=Math.pow(2,rt.zoom),Rt=Ji((rt.y+1)/$t),ie=Ji(rt.y/$t),Ee=Math.min(Math.max(y,Rt),ie),Oe=bv(Ee)/bv(y);if(Tt=Ee===y?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Oe/this._mercatorScaleRatio),this.zoom<=zu&&rt.zoom===Z-1&&Oe>=.9)return!0}else if(d&&(Ot=K(rt.aabb.distanceZ(p)*l)),this.projection.isReprojectedInTileSpace&&s<=5){const $t=Math.pow(2,rt.zoom),Rt=N(new Xn((rt.x+.5)/$t,(rt.y+.5)/$t));Tt=Rt>.85?1:Rt}const zt=ct*ct+yt*yt+Ot;return zt<K((1<<Z-rt.zoom)*v*Tt*(($t,Rt)=>{if(Rt*K(.707)<$t)return 1;const ie=Math.sqrt(Rt/$t);return ie/(1.4144271570014144+(Math.pow(1.1,ie-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ot,J),zt))};if(this.renderWorldCopies)for(let rt=1;rt<=3;rt++)$.push(F(-rt)),$.push(F(rt));for($.push(F(0));$.length>0;){const rt=$.pop(),ct=rt.x,yt=rt.y;let Ot=rt.fullyVisible;const Tt=()=>"globe"===this.projection.name&&(0===rt.y||rt.y===(1<<rt.zoom)-1);if(!Ot){let zt=m?rt.aabb.intersects(I):rt.aabb.intersectsFlat(I);if(0===zt&&Tt()){const Nt=new oc(rt.zoom,ct,yt);zt=ax(this,b,Nt,!0).intersects(I)}if(0===zt)continue;Ot=2===zt}if(rt.zoom!==Z&&ot(rt))for(let zt=0;zt<4;zt++){const Nt=(ct<<1)+zt%2,$t=(yt<<1)+(zt>>1),Rt={aabb:f?rt.aabb.quadrant(zt):rE(this,b,rt.zoom+1,Nt,$t,rt.wrap,rt.minZ,rt.maxZ,this.projection),zoom:rt.zoom+1,x:Nt,y:$t,wrap:rt.wrap,fullyVisible:Ot,tileID:void 0,shouldSplit:void 0,minZ:rt.minZ,maxZ:rt.maxZ};d&&!P&&(Rt.tileID=new Ir(rt.zoom+1===Z?X:rt.zoom+1,rt.wrap,rt.zoom+1,Nt,$t),st(Rt)),$.push(Rt)}else{const zt=rt.zoom===Z?X:rt.zoom;if(t.minzoom&&t.minzoom>zt)continue;if(!Ot){let ie=m?rt.aabb.intersectsPrecise(I):rt.aabb.intersectsPreciseFlat(I);if(0===ie&&Tt()){const Ee=new oc(rt.zoom,ct,yt);ie=ax(this,b,Ee,!0).intersectsPrecise(I)}if(0===ie)continue}const Nt=w[0]-(.5+ct+(rt.wrap<<rt.zoom))*(1<<r-rt.zoom),$t=w[1]-.5-yt,Rt=rt.tileID?rt.tileID:new Ir(zt,rt.wrap,rt.zoom,ct,yt);q.push({tileID:Rt,distanceSq:Nt*Nt+$t*$t})}}if(this.fogCullDistSq){const rt=this.fogCullDistSq,ct=this.horizonLineFromTop();q=q.filter(yt=>{const Ot=[0,0,0,1],Tt=[Dt,Dt,0,1],zt=this.calculateFogTileMatrix(yt.tileID.toUnwrapped());kr.transformMat4(Ot,Ot,zt),kr.transformMat4(Tt,Tt,zt);const Nt=function(ie,Ee,Oe){let Be=0;for(let je=0;je<2;++je)ie[je]>0&&(Be+=(ie[je]-0)*(ie[je]-0)),Ee[je]<0&&(Be+=(0-Ee[je])*(0-Ee[je]));return Be}(kr.min([],Ot,Tt),kr.max([],Ot,Tt));if(0===Nt)return!0;let $t=!1;const Rt=this._elevation;if(Rt&&Nt>rt&&0!==ct){const ie=this.calculateProjMatrix(yt.tileID.toUnwrapped());let Ee;t.isTerrainDEM||(Ee=Rt.getMinMaxForTile(yt.tileID)),Ee||(Ee={min:T,max:E});const Oe=function(je){const En=Math.round((je+45+360)%360/90)%4;return en[En]}(this.rotation),Be=[Oe[0]*Dt,Oe[1]*Dt,Ee.max];dt.transformMat4(Be,Be,ie),$t=(1-Be[1])*this.height*.5<ct}return Nt<rt||$t})}return q.sort((rt,ct)=>rt.distanceSq-ct.distanceSq).map(rt=>rt.tileID)}resize(t,r){this.width=t,this.height=r,this.pixelsToGLUnits=[2/t,-2/r],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const r=Ne(t.lat,-yi,yi),s=this.projection.project(t.lng,r);return new tt(s.x*this.worldSize,s.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/ii(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,r){let s,c;const d=this.centerPoint;if("globe"===this.projection.name){const g=this.worldSize;s=(r.x-d.x)/g,c=(r.y-d.y)/g}else{const g=this.pointCoordinate(r),y=this.pointCoordinate(d);s=g.x-y.x,c=g.y-y.y}const f=this.locationCoordinate(t);this.setLocation(new Xn(f.x-s,f.y-c))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,r){const s=r?ii(r,t.lat):void 0,c=this.projection.project(t.lng,t.lat);return new Xn(c.x,c.y,s)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,r){const s=r??this._centerAltitude,c=[t.x,t.y,0,1],d=[t.x,t.y,1,1];kr.transformMat4(c,c,this.pixelMatrixInverse),kr.transformMat4(d,d,this.pixelMatrixInverse);const f=d[3];kr.scale(c,c,1/c[3]),kr.scale(d,d,1/f);const g=c[2],y=d[2];return{p0:c,p1:d,t:g===y?0:(s-g)/(y-g)}}screenPointToMercatorRay(t){const r=[t.x,t.y,0,1],s=[t.x,t.y,1,1];return kr.transformMat4(r,r,this.pixelMatrixInverse),kr.transformMat4(s,s,this.pixelMatrixInverse),kr.scale(r,r,1/r[3]),kr.scale(s,s,1/s[3]),r[2]=ii(r[2],this._center.lat)*this.worldSize,s[2]=ii(s[2],this._center.lat)*this.worldSize,kr.scale(r,r,1/this.worldSize),kr.scale(s,s,1/this.worldSize),new ex([r[0],r[1],r[2]],dt.normalize([],dt.sub([],s,r)))}rayIntersectionCoordinate(t){const{p0:r,p1:s,t:c}=t,d=ii(r[2],this._center.lat),f=ii(s[2],this._center.lat);return new Xn(vn(r[0],s[0],c)/this.worldSize,vn(r[1],s[1],c)/this.worldSize,vn(d,f,c))}pointCoordinate(t,r=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,r)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let r=this.projection.pointCoordinate3D(this,t.x,t.y);if(r)return new Xn(r[0],r[1],r[2]);let s=0,c=this.horizonLineFromTop();if(t.y>c)return this.pointCoordinate(t);const d=.02*c,f=t.clone();for(let g=0;g<10&&c-s>d;g++){f.y=vn(s,c,.66);const y=this.projection.pointCoordinate3D(this,f.x,f.y);y?(c=f.y,r=y):s=f.y}return r?new Xn(r[0],r[1],r[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=Bd)return!this.isPointAboveHorizon(t);const r=this.pointCoordinate(t);return r.y>=0&&r.y<=1}_coordinatePoint(t,r){const s=r&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,c=[t.x*this.worldSize,t.y*this.worldSize,s+t.toAltitude(),1];return kr.transformMat4(c,c,this.pixelMatrix),c[3]>0?new tt(c[0]/c[3],c[1]/c[3]):new tt(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:r}=this._edgeInsets,s=this.height-this._edgeInsets.bottom,c=this.width-this._edgeInsets.right,d=this.pointLocation3D(new tt(r,t)),f=this.pointLocation3D(new tt(c,t)),g=this.pointLocation3D(new tt(c,s)),y=this.pointLocation3D(new tt(r,s));let b=Math.min(d.lng,f.lng,g.lng,y.lng),w=Math.max(d.lng,f.lng,g.lng,y.lng),P=Math.min(d.lat,f.lat,g.lat,y.lat),O=Math.max(d.lat,f.lat,g.lat,y.lat);const I=Math.pow(2,-this.zoom)/16*270,A="globe"===this.projection.name?1:4,l=(u,p,m,v,C)=>{const E=(u+m)/2,T=(p+v)/2,k=new tt(E,T),{lng:N,lat:F}=this.pointLocation3D(k),$=Math.max(0,b-N,P-F,N-w,F-O);b=Math.min(b,N),w=Math.max(w,N),P=Math.min(P,F),O=Math.max(O,F),(C<A||$>I)&&(l(u,p,E,T,C+1),l(E,T,m,v,C+1))};if(l(r,t,c,t,1),l(c,t,c,s,1),l(c,s,r,s,1),l(r,s,r,t,1),"globe"===this.projection.name){const[u,p]=function(m){const v=bt.identity(new Float64Array(16));bt.multiply(v,m.pixelMatrix,m.globeMatrix);const C=[0,na,0],E=[0,ma,0];return dt.transformMat4(C,C,v),dt.transformMat4(E,E,v),[C[0]>0&&C[0]<=m.width&&C[1]>0&&C[1]<=m.height&&!_v(m,new kn(m.center.lat,90)),E[0]>0&&E[0]<=m.width&&E[1]>0&&E[1]<=m.height&&!_v(m,new kn(m.center.lat,-90))]}(this);u?(O=90,w=180,b=-180):p&&(P=-90,w=180,b=-180)}return new Xi(new kn(b,P),new kn(w,O))}_getBoundsRectangular(t,r){const{top:s,left:c}=this._edgeInsets,d=this.height-this._edgeInsets.bottom,f=this.width-this._edgeInsets.right,g=new tt(c,s),y=new tt(f,s),b=new tt(f,d),w=new tt(c,d);let P=this.pointCoordinate(g,t),O=this.pointCoordinate(y,t);const I=this.pointCoordinate(b,r),A=this.pointCoordinate(w,r),l=(u,p)=>(p.y-u.y)/(p.x-u.x);return P.y>1&&O.y>=0?P=new Xn((1-A.y)/l(A,P)+A.x,1):P.y<0&&O.y<=1&&(P=new Xn(-A.y/l(A,P)+A.x,0)),O.y>1&&P.y>=0?O=new Xn((1-I.y)/l(I,O)+I.x,1):O.y<0&&P.y<=1&&(O=new Xn(-I.y/l(I,O)+I.x,0)),(new Xi).extend(this.coordinateLocation(P)).extend(this.coordinateLocation(O)).extend(this.coordinateLocation(A)).extend(this.coordinateLocation(I))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const r=t.visibleDemTiles.reduce((s,c)=>{if(c.dem){const d=c.dem.tree;s.min=Math.min(s.min,d.minimums[0]),s.max=Math.max(s.max,d.maximums[0])}return s},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(r.min*t.exaggeration(),r.max*t.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(t=!0){const r=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,s=this.height/2-r*(1-this._horizonShift);return t?Math.max(0,s):s}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-yi,this.maxLat=yi,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=yo(this.minLng)*this.tileSize,this.worldMaxX=yo(this.maxLng)*this.tileSize,this.worldMinY=Pi(this.maxLat)*this.tileSize,this.worldMaxY=Pi(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,r){return this.projection.createTileMatrix(this,r,t)}calculateDistanceTileData(t){const r=t.key,s=this._distanceTileDataCache;if(s[r])return s[r];const c=t.canonical,d=1/this.height,f=this.cameraWorldSize,g=f/this.zoomScale(c.z),y=(c.x+Math.pow(2,c.z)*t.wrap)*g,b=c.y*g,w=this.point;w.x*=f/this.worldSize,w.y*=f/this.worldSize;const P=this.angle,O=Math.sin(-P),I=-Math.cos(-P);return s[r]={bearing:[O,I],center:[(w.x-y)*d,(w.y-b)*d],scale:g/Dt*d},s[r]}calculateFogTileMatrix(t){const r=t.key,s=this._fogTileMatrixCache;if(s[r])return s[r];const c=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return bt.multiply(c,this.worldToFogMatrix,c),s[r]=new Float32Array(c),s[r]}calculateProjMatrix(t,r=!1,s=!1){const c=t.key;let d;if(d=s?this._expandedProjMatrixCache:r?this._alignedProjMatrixCache:this._projMatrixCache,d[c])return d[c];const f=this.calculatePosMatrix(t,this.worldSize);let g;return g=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:s?this.expandedFarZProjMatrix:r?this.alignedProjMatrix:this.projMatrix,bt.multiply(f,g,f),d[c]=new Float32Array(f),d[c]}calculatePixelsToTileUnitsMatrix(t){const r=t.tileID.key,s=this._pixelsToTileUnitsCache;if(s[r])return s[r];const c=function(d,f){const{scale:g}=d.tileTransform,y=g*Dt/(d.tileSize*Math.pow(2,f.zoom-d.tileID.overscaledZ+d.tileID.canonical.z));return Rg.scale(new Float32Array(4),f.inverseAdjustmentMatrix,[y,y])}(t,this);return s[r]=c,s[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const t=1/this.worldSize,r=bt.fromScaling([],[t,t,t]);return bt.multiply(r,r,this.globeMatrix),r}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const t=this._elevation;this._updateCameraState();const r=ii(1,this._center.lat)*this.worldSize,s=this._computeCameraPosition(r),c=this._camera.forward(),d=ii(1,this._center.lat);s[2]/=d,c[2]/=d,dt.normalize(c,c);const f=t.raycast(s,c,t.exaggeration());if(f){const g=dt.scaleAndAdd([],s,c,f),y=new Xn(g[0],g[1],ii(g[2],Ji(g[1]))),b=(y.z+dt.length([y.x-s[0],y.y-s[1],y.z-s[2]*d]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(b),this._centerAltitude=y.toAltitude(),this._center=this.coordinateLocation(y),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const r=this._elevation,s=ii(1,this._center.lat)*this.worldSize,c=this._computeCameraPosition(s),d=r.getAtPointOrZero(new Xn(...c)),f=this.pixelsPerMeter/this.worldSize*d,g=this._minimumHeightOverTerrain(),y=c[2]-f;if(y<=g)if(y<0||t){const b=this.locationCoordinate(this._center,this._centerAltitude),w=[c[0],c[1],b.z-c[2]],P=dt.length(w);w[2]-=(g-y)/this._pixelsPerMercatorPixel;const O=dt.length(w);if(0===O)return;dt.scale(w,w,P/O*this._pixelsPerMercatorPixel),this._camera.position=[c[0],c[1],b.z*this._pixelsPerMercatorPixel-w[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const O=this.center;return O.lat=Ne(O.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(O.lng=Ne(O.lng,this.minLng,this.maxLng)),this.center=O,void(this._constraining=!1)}const r=this._unmodified,{x:s,y:c}=this.point;let d=0,f=s,g=c;const y=this.width/2,b=this.height/2,w=this.worldMinY*this.scale,P=this.worldMaxY*this.scale;if(c-b<w&&(g=w+b),c+b>P&&(g=P-b),P-w<this.height&&(d=Math.max(d,this.height/(P-w)),g=(P+w)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const O=this.worldMinX*this.scale,I=this.worldMaxX*this.scale,A=this.worldSize/2-(O+I)/2;f=(s+A+this.worldSize)%this.worldSize-A,f-y<O&&(f=O+y),f+y>I&&(f=I-y),I-O<this.width&&(d=Math.max(d,this.width/(I-O)),f=(I+O)/2)}f===s&&g===c||(this.center=this.unproject(new tt(f,g))),d&&(this.zoom+=this.scaleZoom(d)),this._constrainCamera(),this._unmodified=r,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,r="globe"===this.projection.name,s=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=ii(1,this.center.lat)/ii(1,45));const c=iy(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,c),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const d="meters"===this.projection.zAxisUnit?s:1,f=this._camera.getWorldToCamera(this.worldSize,d);let g;const y=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(y[8]=2*-t.x/this.width,y[9]=2*t.y/this.height,this.isOrthographic){let F=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),$=F*this.aspect,q=-$,Z=-F;$-=t.x,q-=t.x,F+=t.y,Z+=t.y,g=this._camera.getCameraToClipOrthographic(q,$,Z,F,this._nearZ,this._farZ),((X,K,J,st)=>{for(let ot=0;ot<16;ot++)X[ot]=Yc(K[ot],J[ot],st)})(g,g,y,CC(this.pitch>=15?1:this.pitch/15))}else g=y;const b=bt.mul([],y,f);let w=bt.mul([],g,f);if(this.projection.isReprojectedInTileSpace){const F=this.locationCoordinate(this.center),$=bt.identity([]);bt.translate($,$,[F.x*this.worldSize,F.y*this.worldSize,0]),bt.multiply($,$,Yx(this)),bt.translate($,$,[-F.x*this.worldSize,-F.y*this.worldSize,0]),bt.multiply(w,w,$),bt.multiply(b,b,$),this.inverseAdjustmentMatrix=function(q){const Z=Yx(q,!0);return Rg.invert([],[Z[0],Z[1],Z[4],Z[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=bt.scale([],w,[this.worldSize,this.worldSize,this.worldSize/d,1]),this.projMatrix=w,this.invProjMatrix=bt.invert(new Float64Array(16),this.projMatrix),r){const F=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);F[8]=2*-t.x/this.width,F[9]=2*t.y/this.height,this.expandedFarZProjMatrix=bt.mul([],F,f)}else this.expandedFarZProjMatrix=this.projMatrix;const P=bt.invert([],g);this.frustumCorners=nx.fromInvProjectionMatrix(P,this.horizonLineFromTop(),this.height),this.cameraFrustum=sc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!r);const O=new Float32Array(16);bt.identity(O),bt.scale(O,O,[1,-1,1]),bt.rotateX(O,O,this._pitch),bt.rotateZ(O,O,this.angle);const I=bt.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=bt.clone(I);const A=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;I[8]=2*-t.x/this.width,I[9]=2*(t.y+A)/this.height,this.skyboxMatrix=bt.multiply(O,I,O);const l=this.point,u=l.x,p=l.y,m=this.width%2/2,v=this.height%2/2,C=Math.cos(this.angle),E=Math.sin(this.angle),T=u-Math.round(u)+C*m+E*v,k=p-Math.round(p)+C*v+E*m,N=new Float64Array(w);if(bt.translate(N,N,[T>.5?T-1:T,k>.5?k-1:k,0]),this.alignedProjMatrix=N,w=bt.create(),bt.scale(w,w,[this.width/2,-this.height/2,1]),bt.translate(w,w,[1,-1,0]),this.labelPlaneMatrix=w,w=bt.create(),bt.scale(w,w,[1,-1,1]),bt.translate(w,w,[-1,-1,0]),bt.scale(w,w,[2/this.width,2/this.height,1]),this.glCoordMatrix=w,this.pixelMatrix=bt.multiply(new Float64Array(16),this.labelPlaneMatrix,b),this._calcFogMatrices(),this._distanceTileDataCache={},w=bt.invert(new Float64Array(16),this.pixelMatrix),!w)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=w,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=function($){const{x:q,y:Z}=$.point,{lng:X,lat:K}=$._center;return cx(q,Z,$.worldSize,X,K)}(this);const F=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=dt.transformMat4(F,F,f),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=w;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,r=this.cameraPixelsPerMeter,s=this._camera.position,c=1/this.height/this._pixelsPerMercatorPixel,d=[t,t,r];dt.scale(d,d,c),dt.scale(s,s,-1),dt.multiply(s,s,d);const f=bt.create();bt.translate(f,f,s),bt.scale(f,f,d),this.mercatorFogMatrix=f,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,r,c)}_computeCameraPosition(t){const r=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,s=this._camera.forward(),c=this.point,d=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*r-t/this.worldSize*this._centerAltitude;return[c.x/this.worldSize-s[0]*d,c.y/this.worldSize-s[1]*d,t/this.worldSize*this._centerAltitude-s[2]*d]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const r=this._maxCameraBoundsDistance()*Math.cos(this._pitch),s=this._camera.position[2],c=t[2];let d=1;this.projection.wrap&&(this.center=this.center.wrap()),c>0&&(d=Math.min((r-s)/c,1)),this._camera.position=dt.scaleAndAdd([],this._camera.position,t,d),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,r=this._camera.forward(),{pitch:s,bearing:c}=this._camera.getPitchBearing(),d=ii(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,f=this._mercatorZfromZoom(this._maxZoom)*Math.cos(Ct(this._maxPitch)),g=Math.max((t[2]-d)/Math.cos(s),f),y=this._zoomFromMercatorZ(g);dt.scaleAndAdd(t,t,r,g),this._pitch=Ne(s,Ct(this.minPitch),Ct(this.maxPitch)),this.angle=Wt(c,-Math.PI,Math.PI),this._setZoom(Ne(y,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new Xn(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(t){let r=0,s=Bd,c=0,d=1/0;for(;s-r>1e-6&&s>r;){const f=r+.5*(s-r),g=this.tileSize*Math.pow(2,f),y=this.getCameraToCenterDistance(this.projection,f,g),b=this.scaleZoom(y/(t*this.tileSize)),w=Math.abs(f-b);w<d&&(d=w,c=f),f<b?r=f:s=f}return c}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(gt("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,r){const s=Math.min(t.x,r.x),c=Math.max(t.x,r.x),d=Math.min(t.y,r.y),f=Math.max(t.y,r.y);if(d<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const g=[new tt(s,d),new tt(c,f),new tt(s,f),new tt(c,d)],y=this.renderWorldCopies?-3:0,b=this.renderWorldCopies?4:1;for(const w of g){const P=this.pointRayIntersection(w);if(P.t<0)return!0;const O=this.rayIntersectionCoordinate(P);if(O.x<y||O.y<0||O.x>b||O.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+ge(this.fovAboveCenter)>88||this.anyCornerOffEdge(new tt(0,0),new tt(this.width,this.height))}zoomDeltaToMovement(t,r){const s=dt.length(dt.sub([],this._camera.position,t)),c=this._zoomFromMercatorZ(s)+r;return s-this._mercatorZfromZoom(c)}getCameraPoint(){if("globe"===this.projection.name){const t=function([r,s,c],d){const f=[r,s,c,1];kr.transformMat4(f,f,d);const g=f[3]=Math.max(f[3],1e-6);return f[0]/=g,f[1]/=g,f[2]/=g,f}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new tt(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new tt(0,t))}}getCameraToCenterDistance(t,r=this.zoom,s=this.worldSize){const c=iy(t,r,this.width,this.height,1024),d=t.pixelSpaceConversion(this.center.lat,s,c);let f=.5/Math.tan(.5*this._fov)*this.height*d;return this.isOrthographic&&(f=Yc(1,f,CC(this.pitch>=15?1:this.pitch/15))),f}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&bt.multiply(t,t,this.globeMatrix),t}getFrustum(t){return sc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,t,"meters"===this.projection.zAxisUnit)}}function MC(e,t,r){bt.identity(e),bt.rotateZ(e,e,Ct(t[2])),bt.rotateX(e,e,Ct(t[0])),bt.rotateY(e,e,Ct(t[1])),bt.scale(e,e,r),bt.multiply(e,e,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Of(e,t,r,s,c,d,f,g){const y=[r[0]-t[0],r[1]-t[1],0],b=[s[0]-t[0],s[1]-t[1],0];if(dt.length(y)<1e-12||dt.length(b)<1e-12)return Bo.identity(e);const w=dt.cross([],y,b);dt.normalize(w,w),dt.subtract(b,s,t),y[2]=(d-c)*g,b[2]=(f-c)*g;const P=y;return dt.cross(P,y,b),dt.normalize(P,P),Bo.rotationTo(e,w,P)}function PC(e,t,r=!1){const s=Po(t.zoom),c=function(d,f,g){const y=f.worldSize,b=[d[12],d[13],d[14]],w=Ji(b[1]/y),P=Da(b[0]/y),O=bt.identity([]),I=ii(1,w)*y,A=ii(1,0)*y*pi(w,f.zoom),l=1/Pp(y);let u=A*l;if(g){const C=iy(f.projection,f.zoom,f.width,f.height,1024);u=l*f.projection.pixelSpaceConversion(f.center.lat,y,C)}const p=ra(w,P);dt.add(p,p,dt.scale([],dt.normalize([],p),I*u*b[2]));const m=function(C){const E=[C[0],C[1],C[2]];let T=[0,1,0];const k=dt.cross([],T,E);return dt.cross(T,E,k),0===dt.squaredLength(T)&&(T=[0,1,0],dt.cross(k,E,T)),dt.normalize(k,k),dt.normalize(T,T),dt.normalize(E,E),[k[0],k[1],k[2],0,T[0],T[1],T[2],0,E[0],E[1],E[2],0,C[0],C[1],C[2],1]}(p);bt.scale(O,O,[u,u,u*I]),bt.translate(O,O,[-b[0],-b[1],-b[2]]);const v=bt.multiply([],f.globeMatrix,m);return bt.multiply(v,v,O),bt.multiply(v,v,d),v}(e,t,r);return s>0?function(f,g,y){const b=(A,l,u)=>{const p=dt.length(A),m=dt.length(l),v=Ud(A,l,u);return dt.scale(v,v,1/dt.length(v)*vn(p,m,u))},w=b([f[0],f[1],f[2]],[g[0],g[1],g[2]],y),P=b([f[4],f[5],f[6]],[g[4],g[5],g[6]],y),O=b([f[8],f[9],f[10]],[g[8],g[9],g[10]],y),I=Ud([f[12],f[13],f[14]],[g[12],g[13],g[14]],y);return[w[0],w[1],w[2],0,P[0],P[1],P[2],0,O[0],O[1],O[2],0,I[0],I[1],I[2],1]}(c,function(f,g){const y=g.worldSize,b=ii(1,0)*y*pi(g.center.lat,g.zoom)/Pp(y),w=ii(1,g.center.lat)*y,P=bt.identity([]);return bt.rotateY(P,P,Ct(g.center.lng)),bt.rotateX(P,P,Ct(g.center.lat)),bt.translate(P,P,[0,0,ea]),bt.scale(P,P,[b,b,b*w]),bt.translate(P,P,[g.point.x-.5*y,g.point.y-.5*y,0]),bt.multiply(P,P,f),bt.multiply(P,g.globeMatrix,P)}(e,t),s):c}const lb=[1,1,1];class fl{constructor(t,r,s,c){this.id=t,this.position=null!=r?new kn(r[0],r[1]):new kn(0,0),this.orientation=s??[0,0,0],this.nodes=c,this.uploaded=!1,this.aabb=new _i([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,r){if(bt.multiply(t.matrix,r,t.matrix),t.meshes)for(const s of t.meshes){const c=_i.applyTransform(s.aabb,t.matrix);this.aabb.encapsulate(c)}if(t.children)for(const s of t.children)this._applyTransformations(s,t.matrix)}computeBoundsAndApplyParent(){const t=bt.identity([]);for(const r of this.nodes)this._applyTransformations(r,t)}_positionModelOnTerrain(t,r){const s=t.elevation;if(!s)return 0;const c=_i.projectAabbCorners(this.aabb,this.matrix),d=ii(1,this.position.lat)*t.worldSize,f=function(p,m){const v=[0,0,1],C=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const E of C){const T=p[E.corners[0]],k=p[E.corners[1]],N=p[E.corners[2]],F=[k[0]-T[0],k[1]-T[1],m*(k[2]-T[2])],$=dt.cross(F,F,[N[0]-T[0],N[1]-T[1],m*(N[2]-T[2])]);dt.normalize($,$),E.dotProductWithUp=dt.dot($,v)}return C.sort((E,T)=>E.dotProductWithUp-T.dotProductWithUp),C[0].corners}(c,d),g=c[f[0]],y=c[f[1]],b=c[f[2]],w=c[f[3]],P=s.getAtPointOrZero(new Xn(g[0]/t.worldSize,g[1]/t.worldSize),0),O=s.getAtPointOrZero(new Xn(y[0]/t.worldSize,y[1]/t.worldSize),0),I=s.getAtPointOrZero(new Xn(b[0]/t.worldSize,b[1]/t.worldSize),0),A=s.getAtPointOrZero(new Xn(w[0]/t.worldSize,w[1]/t.worldSize),0),l=(P+A)/2,u=(O+I)/2;return l>u?O<I?Of(r,y,w,g,O,A,P,d):Of(r,b,g,w,I,P,A,d):P<A?Of(r,g,y,b,P,O,I,d):Of(r,w,b,y,A,I,O,d),Math.max(l,u)}computeModelMatrix(t,r,s,c,d,f,g=!1){const y=t.transform,b=y.zoom,w=y.project(this.position),P=pi(this.position.lat,b),O=1/P;bt.identity(this.matrix),bt.translate(this.matrix,this.matrix,[w.x+c[0]*O,w.y+c[1]*O,c[2]]);let I=1,A=1;const l=y.worldSize;if(g){if("mercator"===y.projection.name){let v=0;y.elevation&&(v=y.elevation.getAtPointOrZero(new Xn(w.x/l,w.y/l),0));const C=kr.transformMat4([],[w.x,w.y,v,1],y.projMatrix)[3]/y.cameraToCenterDistance;I=C,A=C*pi(y.center.lat,b)}else if("globe"===y.projection.name){const v=PC(this.matrix,y),C=bt.multiply([],y.projMatrix,v),E=[0,0,0,1];kr.transformMat4(E,E,C);const T=E[3]/y.cameraToCenterDistance,k=Po(b),N=y.projection.pixelsPerMeter(this.position.lat,l)*pi(this.position.lat,b),F=y.projection.pixelsPerMeter(y.center.lat,l)*pi(y.center.lat,b);I=T/vn(N,xv(y.center.lat),k),A=T*P/N,I*=F,A*=F}}else I=O;bt.scale(this.matrix,this.matrix,[I,I,A]);const u=[...this.matrix],p=this.orientation,m=[];if(MC(m,[p[0]+r[0],p[1]+r[1],p[2]+r[2]],s),bt.multiply(this.matrix,u,m),d&&y.elevation){let v=0;const C=[];if(f&&y.elevation){v=this._positionModelOnTerrain(y,C);const E=bt.fromQuat([],C),T=bt.multiply([],E,m);bt.multiply(this.matrix,u,T)}else v=y.elevation.getAtPointOrZero(new Xn(w.x/l,w.y/l),0);0!==v&&(this.matrix[14]+=v)}}upload(t){if(!this.uploaded){for(const r of this.nodes)Jx(r,t);for(const r of this.nodes)cb(r);this.uploaded=!0}}destroy(){for(const t of this.nodes)ub(t)}}function hm(e,t,r=!1){e.uploaded||(e.gfxTexture=new bi(t,e.image,r?t.gl.R8:t.gl.RGBA,{useMipmap:e.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),e.uploaded=!0,e.image=null)}function bE(e,t,r){e.indexBuffer=t.createIndexBuffer(e.indexArray,!1,!0),e.vertexBuffer=t.createVertexBuffer(e.vertexArray,FT.members,!1,!0),e.normalArray&&(e.normalBuffer=t.createVertexBuffer(e.normalArray,cm.members,!1,!0)),e.texcoordArray&&(e.texcoordBuffer=t.createVertexBuffer(e.texcoordArray,ib.members,!1,!0)),e.colorArray&&(e.colorBuffer=t.createVertexBuffer(e.colorArray,(12===e.colorArray.bytesPerElement?zT:BT).members,!1,!0)),e.featureArray&&(e.pbrBuffer=t.createVertexBuffer(e.featureArray,_E.members,!0)),e.segments=li.simpleSegment(0,0,e.vertexArray.length,e.indexArray.length);const s=e.material;s.pbrMetallicRoughness.baseColorTexture&&hm(s.pbrMetallicRoughness.baseColorTexture,t),s.pbrMetallicRoughness.metallicRoughnessTexture&&hm(s.pbrMetallicRoughness.metallicRoughnessTexture,t),s.normalTexture&&hm(s.normalTexture,t),s.occlusionTexture&&hm(s.occlusionTexture,t,r),s.emissionTexture&&hm(s.emissionTexture,t)}function Jx(e,t,r){if(e.meshes)for(const s of e.meshes)bE(s,t,r);if(e.children)for(const s of e.children)Jx(s,t,r)}function cb(e){if(e.meshes)for(const t of e.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(e.children)for(const t of e.children)cb(t)}function ub(e){if(e.meshes)for(const r of e.meshes)r.vertexBuffer&&(r.vertexBuffer.destroy(),r.indexBuffer.destroy(),r.normalBuffer&&r.normalBuffer.destroy(),r.texcoordBuffer&&r.texcoordBuffer.destroy(),r.colorBuffer&&r.colorBuffer.destroy(),r.pbrBuffer&&r.pbrBuffer.destroy(),r.segments.destroy(),r.material&&((t=r.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(e.children)for(const r of e.children)ub(r)}class t1{constructor(t,r){this.feature=t,this.instancedDataOffset=r,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class Tf{constructor(){this.instancedDataArray=new gT,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class fm{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(t,r,s,c){this.tileToMeter=Op(s);const d=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:f,id:g,index:y,sourceLayerIndex:b}of t){const w=jc(f,d);if(!this.layers[0]._featureFilter.filter(new Ri(this.zoom),w,s))continue;const P={id:g,sourceLayerIndex:b,index:y,geometry:d?w.geometry:Ei(f,s,c),properties:f.properties,type:f.type,patterns:{}},O=this.addFeature(P,P.geometry,w);O&&r.featureIndex.insert(f,P.geometry,y,b,this.index,this.instancesPerModel[O].instancedDataArray.length)}this.lookup=null}update(t,r,s,c){for(const d in this.instancesPerModel){const f=this.instancesPerModel[d];for(const g in t)f.idToFeaturesIndex.hasOwnProperty(g)&&this.evaluate(f.features[f.idToFeaturesIndex[g]],t[g],f,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const r in this.instancesPerModel){const s=this.instancesPerModel[r];for(const c of s.features){const d=this.layers[0],f=c.feature,g=this.canonical,y=d.paint.get("model-rotation").evaluate(f,{},g),b=d.paint.get("model-scale").evaluate(f,{},g),w=d.paint.get("model-translation").evaluate(f,{},g);dt.exactEquals(c.rotation,y)&&dt.exactEquals(c.scale,b)&&dt.exactEquals(c.translation,w)||(this.evaluate(c,c.featureStates,s,!0),t=!0)}}return t}isEmpty(){for(const t in this.instancesPerModel)if(0!==this.instancesPerModel[t].instancedDataArray.length)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const r in this.instancesPerModel){const s=this.instancesPerModel[r];s.instancedDataArray.length<0||0===s.instancedDataArray.length||(s.instancedDataBuffer?s.instancedDataBuffer.updateData(s.instancedDataArray):s.instancedDataBuffer=t.createVertexBuffer(s.instancedDataArray,Hp.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const r=this.instancesPerModel[t];0!==r.instancedDataArray.length&&r.instancedDataBuffer&&r.instancedDataBuffer.destroy()}}addFeature(t,r,s){const c=this.layers[0],d=c.layout.get("model-id").evaluate(s,{},this.canonical);if(!d)return gt(`modelId is not evaluated for layer ${c.id} and it is not going to get rendered.`),d;this.instancesPerModel[d]||(this.instancesPerModel[d]=new Tf);const f=this.instancesPerModel[d],g=f.instancedDataArray,y=new t1(s,g.length);for(const b of r)for(const w of b){if(w.x<0||w.x>=Dt||w.y<0||w.y>=Dt)continue;const P=(this.lookupDim-1)/Dt,O=this.lookupDim*(w.y*P|0)+w.x*P|0;if(this.lookup){if(0!==this.lookup[O])continue;this.lookup[O]=1}this.instanceCount++;const I=g.length;g.resize(I+1),f.instancesEvaluatedElevation.push(0),g.float32[16*I]=w.x,g.float32[16*I+1]=w.y}return y.instancedDataCount=f.instancedDataArray.length-y.instancedDataOffset,y.instancedDataCount>0&&(t.id&&(f.idToFeaturesIndex[t.id]=f.features.length),f.features.push(y),this.evaluate(y,{},f,!1)),d}evaluate(t,r,s,c){const d=this.layers[0],f=t.feature,g=this.canonical,y=t.rotation=d.paint.get("model-rotation").evaluate(f,r,g),b=t.scale=d.paint.get("model-scale").evaluate(f,r,g),w=t.translation=d.paint.get("model-translation").evaluate(f,r,g),P=d.paint.get("model-color").evaluate(f,r,g);P.a=d.paint.get("model-color-mix-intensity").evaluate(f,r,g);const O=[];this.maxVerticalOffset<w[2]&&(this.maxVerticalOffset=w[2]),this.maxScale=Math.max(Math.max(this.maxScale,b[0]),Math.max(b[1],b[2])),MC(O,y,b);const I=Math.round(100*P.a)+P.b/1.05;for(let A=0;A<t.instancedDataCount;++A){const l=t.instancedDataOffset+A,u=16*l,p=s.instancedDataArray.float32;let m=0;c&&(m=p[u+6]-s.instancesEvaluatedElevation[l]);const v=0|p[u+1];p[u]=(0|p[u])+P.r/1.05,p[u+1]=v+P.g/1.05,p[u+2]=I,p[u+3]=1/(g.z>10?this.tileToMeter:Op(g,v)),p[u+4]=w[0],p[u+5]=w[1],p[u+6]=w[2]+m,p[u+7]=O[0],p[u+8]=O[1],p[u+9]=O[2],p[u+10]=O[4],p[u+11]=O[5],p[u+12]=O[6],p[u+13]=O[8],p[u+14]=O[9],p[u+15]=O[10],s.instancesEvaluatedElevation[l]=w[2]}}}De(fm,"ModelBucket",{omit:["layers"]}),De(Tf,"PerModelAttributes"),De(t1,"ModelFeature");const xE=new jt({visibility:new G(wt.layout_model.visibility),"model-id":new Q(wt.layout_model["model-id"])});var wE={paint:new jt({"model-opacity":new G(wt.paint_model["model-opacity"]),"model-rotation":new Q(wt.paint_model["model-rotation"]),"model-scale":new Q(wt.paint_model["model-scale"]),"model-translation":new Q(wt.paint_model["model-translation"]),"model-color":new Q(wt.paint_model["model-color"]),"model-color-mix-intensity":new Q(wt.paint_model["model-color-mix-intensity"]),"model-type":new G(wt.paint_model["model-type"]),"model-cast-shadows":new G(wt.paint_model["model-cast-shadows"]),"model-receive-shadows":new G(wt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new G(wt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Q(wt.paint_model["model-emissive-strength"]),"model-roughness":new Q(wt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Q(wt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new G(wt.paint_model["model-cutoff-fade-range"])}),layout:xE};const EC=new Float32Array(262144),Xc=new Uint8Array(262144);function CE(e){let t=0;if(e.meshes)for(const r of e.meshes)t=Math.max(t,r.aabb.max[2]);if(e.children)for(const r of e.children)t=Math.max(t,CE(r));return t}const ME=["","wall","door","roof","window","lamp","logo"];class e1{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:t.id,geometry:[],properties:{height:CE(t)}}}}class ss{constructor(t,r,s,c){this.nodes=t,this.id=r,this.modelTraits|=1,this.uploaded=!1,this.hasPattern=!1,s&&(this.modelTraits|=4),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=c,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const r=this.getNodesInfo();for(const s of r){const c=s.node;this.uploaded?this.updatePbrBuffer(c):Jx(c,t,!0)}for(const s of r)cb(s.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let r=!1;if(!t.meshes)return r;for(const s of t.meshes)s.pbrBuffer&&(s.pbrBuffer.updateData(s.featureArray),r=!0);return r}needsReEvaluation(t,r,s){const c=t.transform.projectionOptions,d=t.style.getBrightness(),f=this.brightness!==d;return!!(!this.uploaded||this.dirty||c.name!==this.projection.name||ly(s.paint.get("model-color").value,f)||ly(s.paint.get("model-color-mix-intensity").value,f)||ly(s.paint.get("model-roughness").value,f)||ly(s.paint.get("model-emissive-strength").value,f)||ly(s.paint.get("model-height-based-emissive-strength-multiplier").value,f))&&(this.projection=c,this.brightness=d,!0)}evaluateScale(t,r){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const s=this.getNodesInfo(),c=this.id.canonical;for(const d of s){const f=d.feature;d.evaluatedScale=r.paint.get("model-scale").evaluate(f,{},c)}}evaluate(t){const r=this.getNodesInfo();for(const s of r){if(!s.node.meshes)continue;const c=s.feature,d=s.node.meshes&&s.node.meshes[0].featureData,f=s.evaluatedColor[2],g=s.evaluatedRMEA[2],y=this.id.canonical;if(s.hasTranslucentParts=!1,d){for(let b=0;b<ME.length;b++){const w=ME[b];w.length&&(c.properties.part=w);const P=t.paint.get("model-color").evaluate(c,{},y),O=t.paint.get("model-color-mix-intensity").evaluate(c,{},y);s.evaluatedColor[b]=[P.r,P.g,P.b,O],s.evaluatedRMEA[b][0]=t.paint.get("model-roughness").evaluate(c,{},y),s.evaluatedRMEA[b][2]=t.paint.get("model-emissive-strength").evaluate(c,{},y),s.evaluatedRMEA[b][3]=P.a,s.emissionHeightBasedParams[b]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(c,{},y),!s.hasTranslucentParts&&P.a<1&&(s.hasTranslucentParts=!0)}delete c.properties.part,EE(s,f!==s.evaluatedColor[2]||g!==s.evaluatedRMEA[2])}s.evaluatedScale=t.paint.get("model-scale").evaluate(c,{},y),this.updatePbrBuffer(s.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,r,s,c){const d=t.findDEMTileFor(s);if(d&&(d.tileID.canonical!==this.terrainTile||r!==this.terrainExaggeration)){if(d.dem&&d.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=d.tileID.overscaledZ;const f=dc.create(t,s,d);if(!f)return;4&this.modelTraits&&this.updateDEM(t,f,s,c);for(const g of this.getNodesInfo()){const y=g.node;if(!y.footprint||!y.footprint.vertices||!y.footprint.vertices.length)continue;const b=y.footprint.vertices;let w=f.getElevationAt(b[0].x,b[0].y,!0,!0);for(let P=1;P<b.length;P++)w=Math.min(w,f.getElevationAt(b[P].x,b[P].y,!0,!0));y.elevation=w}}this.terrainTile=d.tileID.canonical,this.terrainExaggeration=r}}updateDEM(t,r,s,c){let d=r._dem._modifiedForSources[c];if(void 0===d&&(r._dem._modifiedForSources[c]=[],d=r._dem._modifiedForSources[c]),d.includes(s.canonical))return;const f=r._dem.dim;d.push(s.canonical);let g=!1;for(const y of this.getNodesInfo()){const b=y.node;if(!b.footprint||!b.footprint.grid)continue;const w=b.footprint.grid,P=r.tileCoordToPixel(w.min.x,w.min.y),O=r.tileCoordToPixel(w.max.x,w.max.y),I=Math.min(Math.min(f-O.y,P.x),Math.min(P.y,f-O.x));if(I<0)continue;const A=Ne(I,2,5);let l=Math.max(0,P.x-A),u=Math.max(0,P.y-A),p=Math.min(O.x+A,f-1),m=Math.min(O.y+A,f-1);for(let T=u;T<=m;++T)for(let k=l;k<=p;++k)Xc[T*f+k]=255;let v=0,C=0;for(let T=0;T<w.cellsY;++T)for(let k=0;k<w.cellsX;++k){if(!w.cells[T*w.cellsX+k])continue;const N=r.tileCoordToPixel(w.min.x+k/w.xScale,w.min.y+T/w.yScale),F=r.tileCoordToPixel(w.min.x+(k+1)/w.xScale,w.min.y+(T+1)/w.yScale);for(let $=N.y;$<=Math.min(F.y+1,f-1);++$)for(let q=N.x;q<=Math.min(F.x+1,f-1);++q)255===Xc[$*f+q]&&(Xc[$*f+q]=0,v+=r.getElevationAtPixel(q,$),C++)}const E=v/C;l=Math.max(1,P.x-A),u=Math.max(1,P.y-A),p=Math.min(O.x+A,f-2),m=Math.min(O.y+A,f-2),g=!0;for(let T=u;T<=m;++T)for(let k=l;k<=p;++k)0===Xc[T*f+k]&&(EC[T*f+k]=r._dem.set(k,T,E));for(let T=1;T<A;++T){l=Math.max(1,P.x-T),u=Math.max(1,P.y-T),p=Math.min(O.x+T,f-2),m=Math.min(O.y+T,f-2);for(let k=u;k<=m;++k)for(let N=l;N<=p;++N){const F=k*f+N;if(255===Xc[F]){let $=0,q=0,Z=-1,X=-1;for(let K=-1;K<=1;++K)for(let J=-1;J<=1;++J){const st=(k+K)*f+N+J;if(Xc[st]>=T)continue;const ot=EC[st],rt=Math.abs(ot);rt>q&&($=ot,q=rt,Z=J,X=K)}if(q>.1){const K=1-(T+.5*Math.abs(Z*X))/A;let J=r._dem.get(N,k)+$*K;const st=r._dem.get(N+Z,k+X),ot=r._dem.get(N-Z,k-X,!0);(J-st)*(J-ot)>0&&(J=(st+ot)/2),EC[F]=r._dem.set(N,k,J),Xc[F]=T}}}}}g&&(r._demTile.needsDEMTextureUpload=!0,r._dem._timestamp=Mn.now())}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const t of this.nodes)this.nodesInfo.push(new e1(t));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const t of this.nodes)ub(t);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const t=this.getNodesInfo();for(const r of t)cb(r.node),ub(r.node)}isEmpty(){return!this.nodes.length}updateReplacement(t,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;const s=r.getReplacementRegionsForTile(t.toUnwrapped()),c=this.getNodesInfo();for(let d=0;d<this.nodesInfo.length;d++){const f=c[d].node;c[d].hiddenByReplacement=!!f.footprint&&!s.find(g=>g.footprint===f.footprint)}}getHeightAtTileCoord(t,r){const s=this.getNodesInfo(),c=[];for(let d=0;d<this.nodesInfo.length;d++){const f=s[d],g=f.node.meshes[0];if(t<g.aabb.min[0]||r<g.aabb.min[1]||t>g.aabb.max[0]||r>g.aabb.max[1])continue;const y=(t-g.aabb.min[0])/(g.aabb.max[0]-g.aabb.min[0])*64|0,b=64*Math.min(63,(r-g.aabb.min[1])/(g.aabb.max[1]-g.aabb.min[1])*64|0)+Math.min(63,y);if(!(g.heightmap[b]<0&&f.node.footprint))return f.hiddenByReplacement?void 0:{height:g.heightmap[b],maxHeight:f.feature.properties.height,hidden:!1,verticalScale:f.evaluatedScale[2]};if(f.node.footprint.grid.query(new tt(t,r),new tt(t,r),c),c.length>0)return{height:void 0,maxHeight:f.feature.properties.height,hidden:f.hiddenByReplacement,verticalScale:f.evaluatedScale[2]}}}}function ly(e,t){return!e.isLightConstant&&t}function PE(e,t,r,s,c,d,f,g){let y=(61440&t|(61440&t)>>4)>>8,b=(3840&t|(3840&t)>>4)>>4,w=240&t|(240&t)>>4;r[3]>0&&(y=vn(y,255*r[0],r[3]),b=vn(b,255*r[1],r[3]),w=vn(w,255*r[2],r[3]));const P=y<<8|b,O=w<<8|Math.floor(255*s[3]),I=function(T){const k=Ne(T,0,2);return Math.min(Math.round(.5*k*255),255)}(s[2])<<8|15*s[0]<<4|15*s[1],A=Ne(c[0],0,1),l=Ne(c[1],0,1),u=Ne(c[2],0,1),p=Ne(c[3],0,1);let m,v,C,E;if(A!==l&&f!==d&&l!==A){const T=f-d;v=1/(T*(l-A)),C=-(d+T*A)/(T*(l-A));const k=Ne(c[4],-1,1);E=Math.pow(10,k),m=255*u<<8|255*p}else m=65535,v=0,C=1,E=1;if(e.emplaceBack(P,O,I,m,v,C,E),g){const T=g.length;g.clear();for(let k=0;k<T;k++)g.emplaceBack(P,O,I,m,v,C,E)}}function EE(e,t){const r=e.node;let s=0;for(const c of r.meshes){if(r.lights&&r.lightMeshIndex===s||!c.featureData)continue;c.featureArray=new rP,c.featureArray.reserve(c.featureData.length);let d=t;for(const f of c.featureData){let g;const y=65535&f,b=(15&y)<8?15&y:0,w=f>>16&65535,P=e.evaluatedRMEA[b],O=e.evaluatedColor[b],I=e.emissionHeightBasedParams[b];if(d&&2===b&&r.lights&&(g=new rP,g.resize(10*r.lights.length)),PE(c.featureArray,w,O,P,I,c.aabb.min[2],c.aabb.max[2],g),g&&d){d=!1;const A=r.meshes[r.lightMeshIndex];A.featureArray=g,A.featureArray._trim()}}c.featureArray._trim(),s++}}De(ss,"Tiled3dModelBucket",{omit:["layers"]}),De(e1,"Tiled3dModelFeature");class VT{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t){const r=hb(new tt(0,0),new tt(Dt,Dt),t),s=[];for(const c of this._activeRegions){if(c.hiddenByOverlap||!db(r,c))continue;const d=jT(c.min,c.max,t);s.push({min:d.min,max:d.max,sourceId:this._sourceIds[c.priority],footprint:c.footprint,footprintTileId:c.tileId})}return s}setSources(t){this._setSources(t.map(r=>({getSourceId:()=>r.cache.id,getFootprints:()=>{const s=[];for(const c of r.cache.getVisibleCoordinates()){const d=r.cache.getTile(c).buckets[r.layer];if(d)for(const f of d.getNodesInfo()){const g=f.node;g.footprint&&s.push({footprint:g.footprint,id:c.toUnwrapped()})}}return s}})))}_addSource(t){const r=t.getFootprints();if(0!==r.length){for(const s of r){if(!s.footprint)continue;const c=hb(s.footprint.min,s.footprint.max,s.id);this._activeRegions.push({min:c.min,max:c.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:s.id,footprint:s.footprint})}this._sourceIds.push(t.getSourceId())}}_computeReplacement(){this._activeRegions.sort((r,s)=>r.priority-s.priority||uh(r.min,s.min)||uh(r.max,s.max));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let r=0,s=0;for(;!t&&r!==this._activeRegions.length;){const c=this._activeRegions[r],d=this._prevRegions[s];t=c.priority!==d.priority||!cy(c,d),++r,++s}}if(t){++this._updateTime;const r=s=>{const c=this._activeRegions;if(s>=c.length)return s;const d=c[s].priority;for(;s<c.length&&c[s].priority===d;)++s;return s};if(this._sourceIds.length>1){let s=0,c=r(s);for(;s!==c;){let d=s;const f=s;for(;d!==c;){const g=this._activeRegions[d];g.hiddenByOverlap=!1;for(let y=0;y<f;y++){const b=this._activeRegions[y];if(!b.hiddenByOverlap&&db(g,b)&&(g.hiddenByOverlap=fb(g.footprint,g.tileId,b.footprint,b.tileId),g.hiddenByOverlap))break}++d}s=c,c=r(s)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let r=t.length-1;r>=0;r--)this._addSource(t[r]);this._computeReplacement()}}function uh(e,t){return e.x-t.x||e.y-t.y}function cy(e,t){return 0===uh(e.min,t.min)&&0===uh(e.max,t.max)}function db(e,t){return!(e.min.x>t.max.x||e.max.x<t.min.x||e.min.y>t.max.y||e.max.y<t.min.y)}function hb(e,t,r){const s=1/Dt,c=1/(1<<r.canonical.z),d=(t.x*s+r.canonical.x)*c+r.wrap,f=(t.y*s+r.canonical.y)*c;return{min:new tt((e.x*s+r.canonical.x)*c+r.wrap,(e.y*s+r.canonical.y)*c),max:new tt(d,f)}}function jT(e,t,r){const s=1<<r.canonical.z,c=((t.x-r.wrap)*s-r.canonical.x)*Dt,d=(t.y*s-r.canonical.y)*Dt;return{min:new tt(((e.x-r.wrap)*s-r.canonical.x)*Dt,(e.y*s-r.canonical.y)*Dt),max:new tt(c,d)}}function n1(e,t,r,s,c,d,f){const g=e.indices,y=e.vertices,b=[];for(let w=s;w<s+c;w+=3){const P=t[r[w+0]+d],O=t[r[w+1]+d],I=t[r[w+2]+d],A=Math.min(P.x,O.x,I.x),l=Math.max(P.x,O.x,I.x),u=Math.min(P.y,O.y,I.y),p=Math.max(P.y,O.y,I.y);b.length=0,e.grid.query(new tt(A,u),new tt(l,p),b);for(let m=0;m<b.length;m++){const v=b[m];if(wv(y[g[3*v+0]],y[g[3*v+1]],y[g[3*v+2]],P,O,I,f))return!0}}return!1}function fb(e,t,r,s){if(!e||!r)return!1;let c=e.vertices;if(!t.canonical.equals(s.canonical)||t.wrap!==s.wrap){if(r.vertices.length<e.vertices.length)return fb(r,s,e,t);const d=t.canonical,f=s.canonical,g=Math.pow(2,f.z-d.z);c=e.vertices.map(y=>new tt(y.x*d.x*Dt*g-f.x*Dt,y.y*d.y*Dt*g-f.y*Dt))}return n1(r,c,e.indices,0,e.indices.length,0,0)}const r1=Iv.types,pb=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],gb=["fill-extrusion-flood-light-ground-radius"],OC=Math.pow(2,13),TC=Math.pow(2,15)-1,OE=new tt(0,1),If=2147483648;function mb(e,t,r,s,c,d,f,g){e.emplaceBack((t<<1)+f,(r<<1)+d,(Math.floor(s*OC)<<1)+c,Math.round(g))}function i1(e,t,r,s,c,d){e.emplaceBack(t.x,t.y,(r.x<<1)+s,(r.y<<1)+c,d)}function qp(e,t,r){e.emplaceBack(t.x,t.y,t.z,16384*r[0],16384*r[1],16384*r[2])}class _b{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class IC{constructor(){this.centroidXY=new tt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new tt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new tt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new tt(this.max.x-this.min.x,this.max.y-this.min.y)}}class TE{constructor(){this.acc=new tt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,r){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=r.x,t.min.y=t.max.y=r.y)}appendEdge(t,r,s){this.accCount++,this.acc._add(r);let c=!!this.borders;r.x<t.min.x?(t.min.x=r.x,c=!0):r.x>t.max.x&&(t.max.x=r.x,c=!0),r.y<t.min.y?(t.min.y=r.y,c=!0):r.y>t.max.y&&(t.max.y=r.y,c=!0),((0===r.x||r.x===Dt)&&r.x===s.x)!=((0===r.y||r.y===Dt)&&r.y===s.y)&&this.processBorderOverlap(r,s),c&&this.checkBorderIntersection(r,s)}checkBorderIntersection(t,r){r.x<0!=t.x<0&&this.addBorderIntersection(0,vn(r.y,t.y,(0-r.x)/(t.x-r.x))),r.x>Dt!=t.x>Dt&&this.addBorderIntersection(1,vn(r.y,t.y,(Dt-r.x)/(t.x-r.x))),r.y<0!=t.y<0&&this.addBorderIntersection(2,vn(r.x,t.x,(0-r.y)/(t.y-r.y))),r.y>Dt!=t.y>Dt&&this.addBorderIntersection(3,vn(r.x,t.x,(Dt-r.y)/(t.y-r.y)))}addBorderIntersection(t,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[t];r<s[0]&&(s[0]=r),r>s[1]&&(s[1]=r)}processBorderOverlap(t,r){if(t.x===r.x){if(t.y===r.y)return;const s=0===t.x?0:1;this.addBorderIntersection(s,r.y),this.addBorderIntersection(s,t.y)}else{const s=0===t.y?2:3;this.addBorderIntersection(s,r.x),this.addBorderIntersection(s,t.x)}}centroid(){return 0===this.accCount?new tt(0,0):new tt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,r)=>t+ +(r[0]!==Number.MAX_VALUE),0):0}}function o1(e,t){const r=e.add(t)._unit(),s=Ne(e.x*r.x+e.y*r.y,-1,1);var c,d,f;return c=Math.acos(s),Math.min(4,Math.max(-4,Math.tan(c)))/4*TC*((d=e).x*(f=t).y-d.y*f.x<0?-1:1)}const yb=[e=>e.x<0,e=>e.x>Dt,e=>e.y<0,e=>e.y>Dt];function uy(e,t,r,s){const c=[4];if(0===s)return c;r._mult(s);const d=e.sub(r),f=t.sub(r),g=[e,t,d,f];for(let y=0;y<4;y++)for(const b of g)if(yb[y](b)){c.push(y);break}return c}class pm{constructor(t){this.vertexArray=new Gh,this.indexArray=new Mo,this.programConfigurations=new ga(t.layers,t.zoom,r=>gb.includes(r)),this._segments=new li,this.hiddenByLandmarkVertexArray=new mT,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new li}getDefaultSegment(){return this.regionSegments[4]}hasData(){return 0!==this.vertexArray.length}addData(t,r,s,c=!1){const d=t.length;if(d>2){let f=Math.max(0,this._segments.get().length-1);const g=this._segments._prepareSegment(4*d,this.vertexArray.length,2*this._segmentToGroundQuads[f].length);let y;f!==this._segments.get().length-1&&(f++,this._segmentToGroundQuads[f]=[],this._segmentToRegionTriCounts[f]=[0,0,0,0,0]);{const b=t[0],w=t[1];y=o1(b.sub(t[d-1])._perp()._unit(),w.sub(b)._perp()._unit())}for(let b=0;b<d;b++){const w=b===d-1?0:b+1,P=t[b],O=t[w],I=t[w===d-1?0:w+1],A=O.sub(P)._perp()._unit(),l=o1(A,I.sub(O)._perp()._unit()),u=y,p=l;if(bb(P,O,r)||c&&IE(P,r)&&IE(O,r)){y=l;continue}const m=g.vertexLength;i1(this.vertexArray,P,O,1,1,u),i1(this.vertexArray,P,O,1,0,u),i1(this.vertexArray,P,O,0,1,p),i1(this.vertexArray,P,O,0,0,p),g.vertexLength+=4;const v=uy(P,O,A,s);for(const C of v)this._segmentToGroundQuads[f].push({id:m,region:C}),this._segmentToRegionTriCounts[f][C]+=2,g.primitiveLength+=2;y=l}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),r=t.length;for(let s=0;s<r;s++)this._segmentToGroundQuads[s].sort((c,d)=>c.region-d.region);for(let s=0;s<r;s++){const c=this._segmentToGroundQuads[s],d=t[s],f=this._segmentToRegionTriCounts[s];f.reduce((y,b)=>y+b,0);let g=0;for(let y=0;y<=4;y++){const b=f[y];if(0!==b){let w=this.regionSegments[y];w||(w=this.regionSegments[y]=new li);const P={vertexOffset:d.vertexOffset,primitiveOffset:d.primitiveOffset+g,vertexLength:d.vertexLength,primitiveLength:b};w.get().push(P)}g+=b}for(let y=0;y<c.length;y++){const b=c[y].id;this.indexArray.emplaceBack(b,b+1,b+3),this.indexArray.emplaceBack(b,b+3,b+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,r,s,c,d,f){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,r,s,c,d,f)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,cc.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,r,s,c,d,f){this.hasData()&&this.programConfigurations.updatePaintArrays(t,r,s,c,d,f)}updateHiddenByLandmark(t){if(!this.hasData())return;const r=t.groundVertexCount+t.groundVertexArrayOffset;if(0===t.groundVertexCount)return;const s=t.flags&If?1:0;for(let c=t.groundVertexArrayOffset;c<r;++c)this.hiddenByLandmarkVertexArray.emplace(c,s);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,Tv.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const r=this.regionSegments[t];r&&r.destroy()}}}}class gm{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Mo,this.footprintVertices=new pa,this.footprintSegments=[],this.layoutVertexArray=new el,this.centroidVertexArray=new w0,this.indexArray=new Mo,this.programConfigurations=new ga(t.layers,t.zoom,r=>pb.includes(r)),this.segments=new li,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.groundEffect=new pm(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(t,r,s,c){this.features=[],this.hasPattern=ll("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=Op(s),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:d,id:f,index:g,sourceLayerIndex:y}of t){const b=this.layers[0]._featureFilter.needGeometry,w=jc(d,b);if(!this.layers[0]._featureFilter.filter(new Ri(this.zoom),w,s))continue;const P={id:f,sourceLayerIndex:y,index:g,geometry:b?w.geometry:Ei(d,s,c),properties:d.properties,type:d.type,patterns:{}},O=this.layoutVertexArray.length;this.hasPattern?this.features.push(ff("fill-extrusion",this.layers,P,this.zoom,r)):this.addFeature(P,P.geometry,g,s,{},r.availableImages,c,r.brightness),r.featureIndex.insert(d,P.geometry,g,y,this.index,O)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,r,s,c,d,f){for(const g of this.features){const{geometry:y}=g;this.addFeature(g,y,g.index,r,s,c,d,f)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles()}update(t,r,s,c,d){const f=0!==Object.keys(t).length;if(f&&!this.stateDependentLayers.length)return;const g=f?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,r,g,s,c,d),this.groundEffect.update(t,r,g,s,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ka),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,qw.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Ov.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,s,c,d,f,g,y){const b=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,w=[new tt(0,0),new tt(Dt,Dt)],P=g.projection,O="globe"===P.name,I="Polygon"===r1[t.type],A=new TE;A.centroidDataIndex=this.centroidData.length;const l=new IC,u=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},c)<=0,p=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},c);l.height=p,l.vertexArrayOffset=this.layoutVertexArray.length,l.groundVertexArrayOffset=this.groundEffect.vertexArray.length,O&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Xy);const m=Vg(r,500);for(let N=m.length-1;N>=0;N--){const F=m[N];(0===F.length||(v=F[0]).every($=>$.x<=0)||v.every($=>$.x>=Dt)||v.every($=>$.y<=0)||v.every($=>$.y>=Dt))&&m.splice(N,1)}var v;let C;if(O)C=l1(m,w,c);else{C=[];for(const N of m)C.push({polygon:N,bounds:w})}const E=I?this.edgeRadius:0,T=E>0&&this.zoom<17,k=(N,F)=>{if(0===N.length)return!1;const $=N[N.length-1];return F.x===$.x&&F.y===$.y};for(const{polygon:N,bounds:F}of C){let $=0,q=0;for(const J of N)I&&!J[0].equals(J[J.length-1])&&J.push(J[0]),q+=I?J.length-1:J.length;const Z=this.segments.prepareSegment((I?5:4)*q,this.layoutVertexArray,this.indexArray);l.footprintSegIdx<0&&(l.footprintSegIdx=this.footprintSegments.length),l.polygonSegIdx<0&&(l.polygonSegIdx=this.polygonSegments.length);const X={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},K=new _b;if(K.vertexOffset=this.footprintVertices.length,K.indexOffset=3*this.footprintIndices.length,K.ringIndices=[],I){const J=[],st=[];$=Z.vertexLength;for(let rt=0;rt<N.length;rt++){const ct=N[rt];ct.length&&0!==rt&&st.push(J.length/2);const yt=[];let Ot,Tt;Ot=ct[1].sub(ct[0])._perp()._unit(),K.ringIndices.push(ct.length-1);for(let zt=1;zt<ct.length;zt++){const Nt=ct[zt],$t=ct[zt===ct.length-1?1:zt+1],Rt=Nt.clone();if(E){Tt=$t.sub(Nt)._perp()._unit();const ie=Ot.add(Tt)._unit(),Ee=E*Math.min(4,1/(Ot.x*ie.x+Ot.y*ie.y));Rt.x+=Ee*ie.x,Rt.y+=Ee*ie.y,Rt.x=Math.round(Rt.x),Rt.y=Math.round(Rt.y),Ot=Tt}!u||0!==E&&!T||k(yt,Rt)||yt.push(Rt),mb(this.layoutVertexArray,Rt.x,Rt.y,0,0,1,1,0),Z.vertexLength++,this.footprintVertices.emplaceBack(Nt.x,Nt.y),J.push(Nt.x,Nt.y),O&&qp(this.layoutVertexExtArray,P.projectTilePoint(Rt.x,Rt.y,c),P.upVector(c,Rt.x,Rt.y))}u&&(0===E||T)&&(0!==yt.length&&k(yt,yt[0])&&yt.pop(),this.groundEffect.addData(yt,F,b))}const ot=Pv(J,st);for(let rt=0;rt<ot.length;rt+=3)this.footprintIndices.emplaceBack(K.vertexOffset+ot[rt+0],K.vertexOffset+ot[rt+1],K.vertexOffset+ot[rt+2]),this.indexArray.emplaceBack($+ot[rt],$+ot[rt+2],$+ot[rt+1]),Z.primitiveLength++;K.indexCount+=ot.length,K.vertexCount+=this.footprintVertices.length-K.vertexOffset}for(let J=0;J<N.length;J++){const st=N[J];A.startRing(l,st[0]);let ot=st.length>4&&s1(st[st.length-2],st[0],st[1]),rt=E?$T(st[st.length-2],st[0],st[1],E):0;const ct=[];let yt,Ot,Tt;Ot=st[1].sub(st[0])._perp()._unit();let zt=!0;for(let Nt=1,$t=0;Nt<st.length;Nt++){let Rt=st[Nt-1],ie=st[Nt];const Ee=st[Nt===st.length-1?1:Nt+1];if(A.appendEdge(l,ie,Rt),bb(ie,Rt,F)){E&&(Ot=Ee.sub(ie)._perp()._unit(),zt=!zt);continue}const Oe=ie.sub(Rt)._perp(),Be=Oe.x/(Math.abs(Oe.x)+Math.abs(Oe.y)),je=Oe.y>0?1:0,En=Rt.dist(ie);if($t+En>32768&&($t=0),E){Tt=Ee.sub(ie)._perp()._unit();let Ln=SC(Rt,ie,Ee,vb(Ot,Tt),E);isNaN(Ln)&&(Ln=0);const On=ie.sub(Rt)._unit();Rt=Rt.add(On.mult(rt))._round(),ie=ie.add(On.mult(-Ln))._round(),rt=Ln,Ot=Tt,u&&this.zoom>=17&&(k(ct,Rt)||ct.push(Rt),k(ct,ie)||ct.push(ie))}const Qe=Z.vertexLength,nr=st.length>4&&s1(Rt,ie,Ee);let ln=dy($t,ot,zt);if(mb(this.layoutVertexArray,Rt.x,Rt.y,Be,je,0,0,ln),mb(this.layoutVertexArray,Rt.x,Rt.y,Be,je,0,1,ln),$t+=En,ln=dy($t,nr,!zt),ot=nr,mb(this.layoutVertexArray,ie.x,ie.y,Be,je,0,0,ln),mb(this.layoutVertexArray,ie.x,ie.y,Be,je,0,1,ln),Z.vertexLength+=4,this.indexArray.emplaceBack(Qe+0,Qe+1,Qe+2),this.indexArray.emplaceBack(Qe+1,Qe+3,Qe+2),Z.primitiveLength+=2,E){const Ln=$+(1===Nt?st.length-2:Nt-2),On=1===Nt?$:Ln+1;if(this.indexArray.emplaceBack(Qe+1,Ln,Qe+3),this.indexArray.emplaceBack(Ln,On,Qe+3),Z.primitiveLength+=2,void 0===yt&&(yt=Qe),!bb(Ee,st[Nt],F)){const mn=Nt===st.length-1?yt:Z.vertexLength;this.indexArray.emplaceBack(Qe+2,Qe+3,mn),this.indexArray.emplaceBack(Qe+3,mn+1,mn),this.indexArray.emplaceBack(Qe+3,On,mn+1),Z.primitiveLength+=3}zt=!zt}if(O){const Ln=this.layoutVertexExtArray,On=P.projectTilePoint(Rt.x,Rt.y,c),mn=P.projectTilePoint(ie.x,ie.y,c),wr=P.upVector(c,Rt.x,Rt.y),Lr=P.upVector(c,ie.x,ie.y);qp(Ln,On,wr),qp(Ln,On,wr),qp(Ln,mn,Lr),qp(Ln,mn,Lr)}}I&&($+=st.length-1),u&&E&&this.zoom>=17&&(0!==ct.length&&k(ct,ct[0])&&ct.pop(),this.groundEffect.addData(ct,F,b,E>0))}this.footprintSegments.push(K),X.triangleCount=this.indexArray.length-X.triangleArrayOffset,this.polygonSegments.push(X),++l.footprintSegLen,++l.polygonSegLen}if(l.vertexCount=this.layoutVertexArray.length-l.vertexArrayOffset,l.groundVertexCount=this.groundEffect.vertexArray.length-l.groundVertexArrayOffset,0!==l.vertexCount){if(l.centroidXY=A.borders?OE:this.encodeCentroid(A,l),this.centroidData.push(l),A.borders){this.featuresOnBorder.push(A);const N=this.featuresOnBorder.length-1;for(let F=0;F<A.borders.length;F++)A.borders[F][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[F].push(N)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,d,f,c,y),this.groundEffect.addPaintPropertiesData(t,s,d,f,c,y),this.maxHeight=Math.max(this.maxHeight,p)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((r,s)=>this.featuresOnBorder[r].borders[t][0]-this.featuresOnBorder[s].borders[t][0])}splitToSubtiles(){const t=[];for(let g=0;g<this.centroidData.length;g++){const y=this.centroidData[g],b=+(y.min.y+y.max.y>Dt),w=2*b+(+(y.min.x+y.max.x>Dt)^b);for(let P=0;P<y.polygonSegLen;P++){const O=y.polygonSegIdx+P;t.push({centroidIdx:g,subtile:w,polygonSegmentIdx:O,triangleSegmentIdx:this.polygonSegments[O].triangleSegIdx})}}const r=new Mo;t.sort((g,y)=>g.triangleSegmentIdx===y.triangleSegmentIdx?g.subtile-y.subtile:g.triangleSegmentIdx-y.triangleSegmentIdx);let s=0,c=0,d=0;for(const g of t){if(g.triangleSegmentIdx!==s)break;d++}const f=t.length;for(;c!==t.length;){s=t[c].triangleSegmentIdx;let g=0,y=c,b=c;for(let w=y;w<d&&t[w].subtile===g;w++)b++;for(;y!==d;){const w=t[y];g=w.subtile;const P=this.centroidData[w.centroidIdx].min.clone(),O=this.centroidData[w.centroidIdx].max.clone(),I={vertexOffset:this.segments.segments[s].vertexOffset,primitiveOffset:r.length,vertexLength:this.segments.segments[s].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let A=y;A<b;A++){const l=t[A],u=this.polygonSegments[l.polygonSegmentIdx],p=this.centroidData[l.centroidIdx].min,m=this.centroidData[l.centroidIdx].max,v=this.indexArray.uint16;for(let C=u.triangleArrayOffset;C<u.triangleArrayOffset+u.triangleCount;C++)r.emplaceBack(v[3*C],v[3*C+1],v[3*C+2]);I.primitiveLength+=u.triangleCount,P.x=Math.min(P.x,p.x),P.y=Math.min(P.y,p.y),O.x=Math.max(O.x,m.x),O.y=Math.max(O.y,m.y)}I.primitiveLength>0&&this.triangleSubSegments.push({segment:I,min:P,max:O}),y=b;for(let A=y;A<d&&t[A].subtile===t[y].subtile;A++)b++}c=d;for(let w=c;w<f&&t[w].triangleSegmentIdx===t[c].triangleSegmentIdx;w++)d++}r._trim(),this.indexArray=r}getVisibleSegments(t,r,s){let c=0,d=0;const f=1<<t.canonical.z;if(r){const l=r.getMinMaxForTile(t);l&&(c=l.min,d=l.max)}d+=this.maxHeight;const g=t.toUnwrapped();let y;const b=[g.canonical.x/f+g.wrap,g.canonical.y/f],w=[(g.canonical.x+1)/f+g.wrap,(g.canonical.y+1)/f],P=new li,O=(l,u,p)=>[l[0]*(1-p[0])+u[0]*p[0],l[1]*(1-p[1])+u[1]*p[1]],I=[],A=[];for(const l of this.triangleSubSegments){I[0]=l.min.x/Dt,I[1]=l.min.y/Dt,A[0]=l.max.x/Dt,A[1]=l.max.y/Dt;const u=O(b,w,I),p=O(b,w,A);if(0===new _i([u[0],u[1],c],[p[0],p[1],d]).intersectsPrecise(s)){y&&(P.segments.push(y),y=void 0);continue}const m=l.segment;y&&y.vertexOffset!==m.vertexOffset&&(P.segments.push(y),y=void 0),y?(y.vertexLength+=m.vertexLength,y.primitiveLength+=m.primitiveLength):y={vertexOffset:m.vertexOffset,primitiveLength:m.primitiveLength,vertexLength:m.vertexLength,primitiveOffset:m.primitiveOffset,sortKey:void 0,vaos:{}}}return y&&P.segments.push(y),P}encodeCentroid(t,r){const s=t.centroid(),c=r.span(),d=Math.min(7,Math.round(c.x*this.tileToMeter/10)),f=Math.min(7,Math.round(c.y*this.tileToMeter/10));return new tt(Ne(s.x,1,Dt-1)<<3|d,Ne(s.y,1,Dt-1)<<3|f)}showCentroid(t){const r=this.centroidData[t.centroidDataIndex];r.flags&=If,r.centroidXY.x=0,r.centroidXY.y=0,this.writeCentroidToBuffer(r)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const r=t.vertexArrayOffset,s=t.vertexCount+t.vertexArrayOffset,c=t.flags&If?OE:t.centroidXY,d=this.centroidVertexArray.geta_centroid_pos0(r);if(this.centroidVertexArray.geta_centroid_pos1(r)!==c.y||d!==c.x){for(let f=r;f<s;++f)this.centroidVertexArray.emplace(f,c.x,c.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;const s=r.getReplacementRegionsForTile(t.toUnwrapped());if(function(d,f){if(d.length!==f.length)return!1;for(let g=0;g<d.length;g++)if(d[g].sourceId!==f[g].sourceId||!cy(d[g],f[g]))return!1;return!0}(this.activeReplacements,s))return;if(this.activeReplacements=s,0===this.centroidVertexArray.length)this.createCentroidsBuffer();else for(const d of this.centroidData)d.flags&=2147483647;const c=[];for(const d of this.activeReplacements){const f=Math.pow(2,d.footprintTileId.canonical.z-t.canonical.z);for(const g of this.centroidData)if(!(g.flags&If||d.min.x>g.max.x||g.min.x>d.max.x||d.min.y>g.max.y||g.min.y>d.max.y))for(let y=0;y<g.footprintSegLen;y++){const b=this.footprintSegments[g.footprintSegIdx+y];if(c.length=0,SE(this.footprintVertices,b.vertexOffset,b.vertexCount,d.footprintTileId.canonical,t.canonical,c),n1(d.footprint,c,this.footprintIndices.uint16,b.indexOffset,b.indexCount,-b.vertexOffset,-f)){g.flags|=If;break}}}for(const d of this.centroidData)this.writeCentroidToBuffer(d);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,r,s){let c=!1;for(let d=0;d<s.footprintSegLen;d++){const f=this.footprintSegments[s.footprintSegIdx+d];let g=0;for(const y of f.ringIndices){for(let b=g,w=y+g-1;b<y+g;w=b++){const P=this.footprintVertices.int16[2*(b+f.vertexOffset)+0],O=this.footprintVertices.int16[2*(b+f.vertexOffset)+1],I=this.footprintVertices.int16[2*(w+f.vertexOffset)+1];O>r!=I>r&&t<(this.footprintVertices.int16[2*(w+f.vertexOffset)+0]-P)*(r-O)/(I-O)+P&&(c=!c)}g=y}}return c}getHeightAtTileCoord(t,r){let s=Number.NEGATIVE_INFINITY,c=!0;const d=4*(t+Dt)*Dt+(r+Dt);if(this.partLookup.hasOwnProperty(d)){const f=this.partLookup[d];return f?{height:f.height,hidden:!!(f.flags&If)}:void 0}for(const f of this.centroidData)t>f.max.x||f.min.x>t||r>f.max.y||f.min.y>r||this.footprintContainsPoint(t,r,f)&&f&&f.height>s&&(s=f.height,this.partLookup[d]=f,c=!!(f.flags&If));if(s!==Number.NEGATIVE_INFINITY)return{height:s,hidden:c};this.partLookup[d]=void 0}}function vb(e,t){const r=e.add(t)._unit();return e.x*r.x+e.y*r.y}function $T(e,t,r,s){const c=t.sub(e)._perp()._unit(),d=r.sub(t)._perp()._unit();return SC(e,t,r,vb(c,d),s)}function SC(e,t,r,s,c){const d=Math.sqrt(1-s*s);return Math.min(e.dist(t)/3,t.dist(r)/3,c*d/s)}function bb(e,t,r){return e.x<r[0].x&&t.x<r[0].x||e.x>r[1].x&&t.x>r[1].x||e.y<r[0].y&&t.y<r[0].y||e.y>r[1].y&&t.y>r[1].y}function IE(e,t){return e.x<t[0].x||e.x>t[1].x||e.y<t[0].y||e.y>t[1].y}function s1(e,t,r){if(e.x<0||e.x>=Dt||t.x<0||t.x>=Dt||r.x<0||r.x>=Dt)return!1;const s=r.sub(t),c=s.perp(),d=e.sub(t);return(s.x*d.x+s.y*d.y)/Math.sqrt((s.x*s.x+s.y*s.y)*(d.x*d.x+d.y*d.y))>-.866&&c.x*d.x+c.y*d.y<0}function dy(e,t,r){const s=t?2|e:-3&e;return r?1|s:-2&s}function a1(){const e=Math.PI/32,t=Math.tan(e),r=Ep;return r*Math.sqrt(1+2*t*t)-r}function l1(e,t,r){const s=1<<r.z,c=Da(r.x/s),d=Da((r.x+1)/s),f=Ji(r.y/s),g=Ji((r.y+1)/s);return function(y,b,w,P,O=0,I){const A=[];if(!y.length||!w||!P)return A;const l=(T,k)=>{for(const N of T)A.push({polygon:N,bounds:k})},u=Math.ceil(Math.log2(w)),p=Math.ceil(Math.log2(P)),m=u-p,v=[];for(let T=0;T<Math.abs(m);T++)v.push(m>0?0:1);for(let T=0;T<Math.min(u,p);T++)v.push(0),v.push(1);let C=y;if(C=$g(C,b[0].y-O,b[1].y+O,1),C=$g(C,b[0].x-O,b[1].x+O,0),!C.length)return A;const E=[];for(v.length?E.push({polygons:C,bounds:b,depth:0}):l(C,b);E.length;){const T=E.pop(),k=T.depth,N=v[k],F=T.bounds[0],$=T.bounds[1],q=0===N?F.x:F.y,Z=0===N?$.x:$.y,X=I?I(N,q,Z):.5*(q+Z),K=$g(T.polygons,q-O,X+O,N),J=$g(T.polygons,X-O,Z+O,N);if(K.length){const st=[F,new tt(0===N?X:$.x,1===N?X:$.y)];v.length>k+1?E.push({polygons:K,bounds:st,depth:k+1}):l(K,st)}if(J.length){const st=[new tt(0===N?X:F.x,1===N?X:F.y),$];v.length>k+1?E.push({polygons:J,bounds:st,depth:k+1}):l(J,st)}}return A}(e,t,Math.ceil((d-c)/11.25),Math.ceil((f-g)/11.25),1,(y,b,w)=>{if(0===y)return.5*(b+w);{const P=Ji((r.y+b/Dt)/s);return(Pi(.5*(Ji((r.y+w/Dt)/s)+P))*s-r.y)*Dt}})}function SE(e,t,r,s,c,d){const f=Math.pow(2,s.z-c.z);for(let g=0;g<r;g++){let y=e.int16[2*(g+t)+0],b=e.int16[2*(g+t)+1];y=(y+c.x*Dt)*f-s.x*Dt,b=(b+c.y*Dt)*f-s.y*Dt,d.push(new tt(y,b))}}De(gm,"FillExtrusionBucket",{omit:["layers","features"]}),De(IC,"PartData"),De(_b,"FootprintSegment"),De(TE,"BorderCentroidData"),De(pm,"GroundEffect");const c1=new jt({visibility:new G(wt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new G(wt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var u1={paint:new jt({"fill-extrusion-opacity":new G(wt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Q(wt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new G(wt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new G(wt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Q(wt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Q(wt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Q(wt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new G(wt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new G(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new G(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new G(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new G(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new G(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new G(wt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new G(wt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Q(wt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Q(wt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new G(wt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new G(wt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new G(wt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new G(wt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new G(wt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:c1};class ed extends tt{constructor(t,r,s){super(t,r),this.z=s}}function Zp(e,t){return e.x*t.x+e.y*t.y}function hy(e,t){if(1===e.length){let r=0;const s=t[r++];let c;for(;!c||s.equals(c);)if(c=t[r++],!c)return 1/0;for(;r<t.length;r++){const d=t[r],f=e[0],g=c.sub(s),y=d.sub(s),b=f.sub(s),w=Zp(g,g),P=Zp(g,y),O=Zp(y,y),I=Zp(b,g),A=Zp(b,y),l=w*O-P*P,u=(O*I-P*A)/l,p=(w*A-P*I)/l,m=s.z*(1-u-p)+c.z*u+d.z*p;if(isFinite(m))return m}return 1/0}{let r=1/0;for(const s of t)r=Math.min(r,s.z);return r}}function d1(e,t,r,s,c,d,f,g){const y=f*c.getElevationAt(e,t,!0,!0),b=0!==d[0],w=b?0===d[1]?f*(d[0]/7-450):f*function(P,O,I){const A=Math.floor(O[0]/8),l=Math.floor(O[1]/8),u=10*(O[0]-8*A),p=10*(O[1]-8*l),m=P.getElevationAt(A,l,!0,!0),v=P.getMeterToDEM(I),C=Math.floor(.5*(u*v-1)),E=Math.floor(.5*(p*v-1)),T=P.tileCoordToPixel(A,l),k=2*C+1,N=2*E+1,F=(rt=k,ct=N,[(J=P).getElevationAtPixel(st=T.x-C,ot=T.y-E,!0),J.getElevationAtPixel(st+ct,ot,!0),J.getElevationAtPixel(st,ot+ct,!0),J.getElevationAtPixel(st+rt,ot+ct,!0)]),$=Math.abs(F[0]-F[1]),q=Math.abs(F[2]-F[3]),Z=Math.abs(F[0]-F[2])+Math.abs(F[1]-F[3]),X=Math.min(.25,.5*v*($+q)/k),K=Math.min(.25,.5*v*Z/N);var J,st,ot,rt,ct;return m+Math.max(X*u,K*p)}(c,d,g):y;return{base:y+(0===r)?-1:r,top:b?Math.max(w+s,y+r+2):y+s}}const h1=new jt({"line-cap":new Q(wt.layout_line["line-cap"]),"line-join":new Q(wt.layout_line["line-join"]),"line-miter-limit":new G(wt.layout_line["line-miter-limit"]),"line-round-limit":new G(wt.layout_line["line-round-limit"]),"line-sort-key":new Q(wt.layout_line["line-sort-key"]),visibility:new G(wt.layout_line.visibility)});var f1={paint:new jt({"line-opacity":new Q(wt.paint_line["line-opacity"]),"line-color":new Q(wt.paint_line["line-color"]),"line-translate":new G(wt.paint_line["line-translate"]),"line-translate-anchor":new G(wt.paint_line["line-translate-anchor"]),"line-width":new Q(wt.paint_line["line-width"]),"line-gap-width":new Q(wt.paint_line["line-gap-width"]),"line-offset":new Q(wt.paint_line["line-offset"]),"line-blur":new Q(wt.paint_line["line-blur"]),"line-dasharray":new Q(wt.paint_line["line-dasharray"]),"line-pattern":new Q(wt.paint_line["line-pattern"]),"line-gradient":new St(wt.paint_line["line-gradient"]),"line-trim-offset":new G(wt.paint_line["line-trim-offset"]),"line-emissive-strength":new G(wt.paint_line["line-emissive-strength"]),"line-border-width":new Q(wt.paint_line["line-border-width"]),"line-border-color":new Q(wt.paint_line["line-border-color"])}),layout:h1};const GT=(e,t,r,s,c,d,f)=>{const g=e.transform,y=g.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:fy(e,t,r,s),u_pixels_to_tile_units:y,u_device_pixel_ratio:d,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:c,u_texsize:AC(r)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:xb(t,e.transform),u_alpha_discard_threshold:0,u_trim_offset:f,u_emissive_strength:r.paint.get("line-emissive-strength")}},AE=(e,t,r,s,c)=>{const d=e.transform;return{u_matrix:fy(e,t,r,s),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:d.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:c,u_image:0,u_tile_units_to_pixels:xb(t,d),u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function xb(e,t){return 1/Ju(e,1,t.tileZoom)}function fy(e,t,r,s){return e.translatePosMatrix(s||t.tileID.projMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const DE=e=>{const t=[];AC(e)&&t.push("RENDER_LINE_DASH"),e.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const r=e.paint.get("line-trim-offset");return 0===r[0]&&0===r[1]||t.push("RENDER_LINE_TRIM_OFFSET"),0!==e.paint.get("line-border-width").constantOr(1)&&t.push("RENDER_LINE_BORDER"),t};function AC(e){const t=e.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}const ya=new class extends Q{possiblyEvaluate(e,t){return t=new Ri(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,s){return t=_t({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,s)}}(f1.paint.properties["line-width"].specification);function kE(e,t){return t>0?t+2*e:e}ya.useIntegerZoom=!0;const RE=new jt({visibility:new G(wt.layout_background.visibility)});var p1={paint:new jt({"background-color":new G(wt.paint_background["background-color"]),"background-pattern":new G(wt.paint_background["background-pattern"]),"background-opacity":new G(wt.paint_background["background-opacity"]),"background-emissive-strength":new G(wt.paint_background["background-emissive-strength"])}),layout:RE};const wb=new jt({visibility:new G(wt.layout_raster.visibility)});var DC={paint:new jt({"raster-opacity":new G(wt.paint_raster["raster-opacity"]),"raster-color":new St(wt.paint_raster["raster-color"]),"raster-color-mix":new G(wt.paint_raster["raster-color-mix"]),"raster-color-range":new G(wt.paint_raster["raster-color-range"]),"raster-hue-rotate":new G(wt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new G(wt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new G(wt.paint_raster["raster-brightness-max"]),"raster-saturation":new G(wt.paint_raster["raster-saturation"]),"raster-contrast":new G(wt.paint_raster["raster-contrast"]),"raster-resampling":new G(wt.paint_raster["raster-resampling"]),"raster-fade-duration":new G(wt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new G(wt.paint_raster["raster-emissive-strength"]),"raster-array-band":new G(wt.paint_raster["raster-array-band"]),"raster-elevation":new G(wt.paint_raster["raster-elevation"])}),layout:wb};function kC(e,t,r,s,c,d,f,g){const y=[e,r,c,t,s,d,1,1,1],b=[f,g,1],w=sl.adjoint([],y),[P,O,I]=dt.transformMat3(b,b,sl.transpose(w,w));return sl.multiply(y,[P,0,0,0,O,0,0,0,I],y)}class Qc extends ki{constructor(t,r,s,c){super(),this.id=t,this.dispatcher=s,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(c),this.options=r,this._dirty=!1}load(t,r){if(this._loaded=r||!1,this.fire(new de("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=Bt(this.map._requestManager.transformRequest(this.url,Ft.Image),(s,c)=>{if(this._imageRequest=null,this._loaded=!0,s)this.fire(new Cn(s));else if(c){const{HTMLImageElement:d}=lt;this.image=c instanceof d?Mn.getImageData(c):c,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new pc(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new de("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof pc||this.texture.destroy()}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let r=t[0][1],s=t[0][1];for(const d of t)d[1]>s&&(s=d[1]),d[1]<r&&(r=d[1]);const c=(s+r)/2;if(c>yi?this.onNorthPole=!0:c<-yi&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const d=t.map(Xn.fromLngLat);this.tileID=function(f){let g=1/0,y=1/0,b=-1/0,w=-1/0;for(const A of f)g=Math.min(g,A.x),y=Math.min(y,A.y),b=Math.max(b,A.x),w=Math.max(w,A.y);const P=Math.max(b-g,w-y),O=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),I=Math.pow(2,O);return new oc(O,Math.floor((g+b)/2*I),Math.floor((y+w)/2*I))}(d),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new de("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const y in this.tiles){const b=this.tiles[y];"loaded"!==b.state&&(b.state="loaded",b.texture=this.texture)}if(this._boundsArray)return;const r=Ku(this.tileID,this.map.transform.projection),[s,c,d,f]=this.coordinates.map(y=>{const b=r.projection.project(y[0],y[1]);return iE(r,b)._round()});this.perspectiveTransform=function(y,b,w,P,O,I,A,l,u,p){const m=kC(0,0,y,0,0,b,y,b),v=kC(w,P,O,I,A,l,u,p);return sl.multiply(v,sl.adjoint(m,m),v),[v[6]/v[8]*y/Dt,v[7]/v[8]*b/Dt]}(this.width,this.height,s.x,s.y,c.x,c.y,f.x,f.y,d.x,d.y);const g=this._boundsArray=new el;g.emplaceBack(s.x,s.y,0,0),g.emplaceBack(c.x,c.y,Dt,0),g.emplaceBack(f.x,f.y,0,Dt),g.emplaceBack(d.x,d.y,Dt,Dt),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(g,$x.members),this.boundsSegments=li.simpleSegment(0,0,4,2)}prepare(){const t=0!==Object.keys(this.tiles).length;if(this.tileID&&!t)return;const r=this.map.painter.context,s=r.gl;!this._dirty||this.texture instanceof pc||(this.texture?this.texture.update(this.image):(this.texture=new bi(r,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(r)}loadTile(t,r){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},r(null)):(t.state="errored",r(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class LE extends gs{constructor(t){super(t,{}),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(t){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}const NE=new jt({visibility:new G(wt.layout_sky.visibility)});var HT={paint:new jt({"sky-type":new G(wt.paint_sky["sky-type"]),"sky-atmosphere-sun":new G(wt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new G(wt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new G(wt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new G(wt.paint_sky["sky-gradient-radius"]),"sky-gradient":new St(wt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new G(wt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new G(wt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new G(wt.paint_sky["sky-opacity"])}),layout:NE};function Cb(e,t,r){const s=[0,0,1],c=Bo.identity([]);return Bo.rotateY(c,c,r?-Ct(e)+Math.PI:Ct(e)),Bo.rotateX(c,c,-Ct(t)),dt.transformQuat(s,s,c),dt.normalize(s,s)}var FE={paint:new jt({})};const qT={circle:class extends gs{constructor(e,t){super(e,ze,t)}createBucket(e){return new Wo(e)}queryRadius(e){const t=e;return so("circle-radius",this,t)+so("circle-stroke-width",this,t)+_a(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,r,s,c,d,f,g){const y=px(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,e.pixelToTileUnitsFactor),b=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r);return wn(e,s,d,f,g,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),y,b)}getProgramIds(){return["circle"]}getDefaultProgramParams(e,t){const r=Ip(this);return{config:new Ru(this,t),defines:r,overrideFog:!1}}},heatmap:class extends gs{createBucket(e){return new Se(e)}constructor(e,t){super(e,Vw,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=jw({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(e){return so("heatmap-radius",this,e)}queryIntersectsFeature(e,t,r,s,c,d,f,g){const y=this.paint.get("heatmap-radius").evaluate(t,r);return wn(e,s,d,f,g,!0,!0,new tt(0,0),y)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(e,t){return"heatmap"===e?{config:new Ru(this,t),overrideFog:!1}:{}}},hillshade:class extends gs{constructor(e,t){super(e,jP,t)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(e,t){return{overrideFog:!1}}},fill:class extends gs{constructor(e,t){super(e,Hw,t)}getProgramIds(){const e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),r=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getDefaultProgramParams(e,t){return{config:new Ru(this,t),overrideFog:!1}}recalculate(e,t){super.recalculate(e,t);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Ev(e)}queryRadius(){return _a(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,r,s,c,d){return!e.queryGeometry.isAboveHorizon&&LP(Tl(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,e.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends gs{constructor(e,t){super(e,u1,t),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(e){return new gm(e)}queryRadius(){return _a(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(e,t,r,s,c,d,f,g,y){const b=px(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,e.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(t,r),P=this.paint.get("fill-extrusion-base").evaluate(t,r),O=[0,0],I=g&&d.elevation,A=d.elevation?d.elevation.exaggeration():1,l=e.tile.getBucket(this);if(I&&l instanceof gm){const C=l.centroidVertexArray,E=y+1;E<C.length&&(O[0]=C.geta_centroid_pos0(E),O[1]=C.geta_centroid_pos1(E))}if(0===O[0]&&1===O[1])return!1;"globe"===d.projection.name&&(s=l1([s],[new tt(0,0),new tt(Dt,Dt)],e.tileID.canonical).map(C=>C.polygon).flat());const u=I?g:null,[p,m]=(E=s,T=P,k=w,N=b,F=f,$=u,q=O,Z=A,X=d.center.lat,"globe"===(C=d).projection.name?function(J,st,ot,rt,ct,yt,Ot,Tt,zt,Nt,$t){const Rt=[],ie=[],Ee=J.projection.upVectorScale($t,J.center.lat,J.worldSize).metersToTile,Oe=[0,0,0,1],Be=[0,0,0,1],je=(Qe,nr,ln,Ln)=>{Qe[0]=nr,Qe[1]=ln,Qe[2]=Ln,Qe[3]=1},En=a1();ot>0&&(ot+=En),rt+=En;for(const Qe of st){const nr=[],ln=[];for(const Ln of Qe){const On=Ln.x+ct.x,mn=Ln.y+ct.y,wr=J.projection.projectTilePoint(On,mn,$t),Lr=J.projection.upVector($t,Ln.x,Ln.y);let rr=ot,Kr=rt;if(Ot){const Si=d1(On,mn,ot,rt,Ot,Tt,zt,Nt);rr+=Si.base,Kr+=Si.top}0!==ot?je(Oe,wr.x+Lr[0]*Ee*rr,wr.y+Lr[1]*Ee*rr,wr.z+Lr[2]*Ee*rr):je(Oe,wr.x,wr.y,wr.z),je(Be,wr.x+Lr[0]*Ee*Kr,wr.y+Lr[1]*Ee*Kr,wr.z+Lr[2]*Ee*Kr),dt.transformMat4(Oe,Oe,yt),dt.transformMat4(Be,Be,yt),nr.push(new ed(Oe[0],Oe[1],Oe[2])),ln.push(new ed(Be[0],Be[1],Be[2]))}Rt.push(nr),ie.push(ln)}return[Rt,ie]}(C,E,T,k,N,F,$,q,Z,X,e.tileID.canonical):$?function(J,st,ot,rt,ct,yt,Ot,Tt,zt){const Nt=[],$t=[],Rt=[0,0,0,1];for(const ie of J){const Ee=[],Oe=[];for(const Be of ie){const je=Be.x+rt.x,En=Be.y+rt.y,Qe=d1(je,En,st,ot,yt,Ot,Tt,zt);Rt[0]=je,Rt[1]=En,Rt[2]=Qe.base,Rt[3]=1,kr.transformMat4(Rt,Rt,ct),Rt[3]=Math.max(Rt[3],1e-5);const nr=new ed(Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]);Rt[0]=je,Rt[1]=En,Rt[2]=Qe.top,Rt[3]=1,kr.transformMat4(Rt,Rt,ct),Rt[3]=Math.max(Rt[3],1e-5);const ln=new ed(Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]);Ee.push(nr),Oe.push(ln)}Nt.push(Ee),$t.push(Oe)}return[Nt,$t]}(E,T,k,N,F,$,q,Z,X):function(J,st,ot,rt,ct){const yt=[],Ot=[],Tt=ct[8]*st,zt=ct[9]*st,Nt=ct[10]*st,$t=ct[11]*st,Rt=ct[8]*ot,ie=ct[9]*ot,Ee=ct[10]*ot,Oe=ct[11]*ot;for(const Be of J){const je=[],En=[];for(const Qe of Be){const nr=Qe.x+rt.x,ln=Qe.y+rt.y,Ln=ct[0]*nr+ct[4]*ln+ct[12],On=ct[1]*nr+ct[5]*ln+ct[13],mn=ct[2]*nr+ct[6]*ln+ct[14],wr=ct[3]*nr+ct[7]*ln+ct[15],Lr=Ln+Tt,rr=On+zt,Kr=mn+Nt,Si=Math.max(wr+$t,1e-5),gi=Ln+Rt,Ni=On+ie,$o=mn+Ee,Io=Math.max(wr+Oe,1e-5);je.push(new ed(Lr/Si,rr/Si,Kr/Si)),En.push(new ed(gi/Io,Ni/Io,$o/Io))}yt.push(je),Ot.push(En)}return[yt,Ot]}(E,T,k,N,F)),v=e.queryGeometry;var C,E,T,k,N,F,$,q,Z,X;return function(C,E,T){let k=1/0;LP(T,E)&&(k=hy(T,E[0]));for(let N=0;N<E.length;N++){const F=E[N],$=C[N];for(let q=0;q<F.length-1;q++){const Z=F[q],X=[Z,F[q+1],$[q+1],$[q],Z];zw(T,X)&&(k=Math.min(k,hy(T,X)))}}return k!==1/0&&k}(p,m,v.isPointQuery()?v.screenBounds:v.screenGeometry)}},line:class extends gs{constructor(e,t){super(e,f1,t),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Ym,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=ya.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Vp(e)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(e,t){const r=DE(this);return{config:new Ru(this,t),defines:r,overrideFog:!1}}queryRadius(e){const t=e,r=kE(so("line-width",this,t),so("line-gap-width",this,t)),s=so("line-offset",this,t);return r/2+Math.abs(s)+_a(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,r,s,c,d){if(e.queryGeometry.isAboveHorizon)return!1;const f=Tl(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,e.pixelToTileUnitsFactor),g=e.pixelToTileUnitsFactor/2*kE(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),y=this.paint.get("line-offset").evaluate(t,r);return y&&(s=function(b,w){const P=[],O=new tt(0,0);for(let I=0;I<b.length;I++){const A=b[I],l=[];for(let u=0;u<A.length;u++){const p=A[u],m=A[u+1],v=0===u?O:p.sub(A[u-1])._unit()._perp(),C=u===A.length-1?O:m.sub(p)._unit()._perp(),E=v._add(C)._unit();E._mult(1/(E.x*C.x+E.y*C.y)),l.push(E._mult(w)._add(p))}P.push(l)}return P}(s,y*e.pixelToTileUnitsFactor)),function(b,w,P){for(let O=0;O<w.length;O++){const I=w[O];if(b.length>=3)for(let A=0;A<I.length;A++)if($c(b,I[A]))return!0;if(MT(b,I,P))return!0}return!1}(f,s,g)}isTileClipped(){return!0}},symbol:Jd,background:class extends gs{constructor(e,t){super(e,p1,t)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(e,t){return{overrideFog:!1}}},raster:class extends gs{constructor(e,t){super(e,DC,t),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}isLayerDraped(e){return!(e&&e._source instanceof Qc)||!e._source.onNorthPole&&!e._source.onSouthPole&&0===this.paint.get("raster-elevation")}_handleSpecialPaintPropertyUpdate(e){"raster-color"!==e&&"raster-color-range"!==e||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const e=this._transitionablePaint._values["raster-color"].value.expression,[t,r]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=jw({expression:e,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:t,end:r}],resolution:256}),this.colorRampTexture=null}},sky:class extends gs{constructor(e,t){super(e,HT,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"sky-gradient"===e?this._updateColorRamp():"sky-atmosphere-sun"!==e&&"sky-atmosphere-halo-color"!==e&&"sky-atmosphere-color"!==e&&"sky-atmosphere-sun-intensity"!==e||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=jw({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(e){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=e.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(e,t){if("atmosphere"===this.paint.get("sky-type")){const s=this.paint.get("sky-atmosphere-sun"),c=!s,d=e.style.light,f=d.properties.get("position");return c&&"viewport"===d.properties.get("anchor")&&gt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),c?Cb(f.azimuthal,90-f.polar,t):Cb(s[0],90-s[1],t)}const r=this.paint.get("sky-gradient-center");return Cb(r[0],90-r[1],t)}isSky(){return!0}markSkyboxValid(e){this._skyboxInvalidated=!1,this._lightPosition=e.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const e=this.paint.get("sky-type");return"atmosphere"===e?["skyboxCapture","skybox"]:"gradient"===e?["skyboxGradient"]:null}},slot:class extends gs{constructor(e,t){super(e,FE)}},model:class extends gs{constructor(e,t){super(e,wE,t)}createBucket(e){return new fm(e)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(){return 0}queryIntersectsFeature(){return!1}_handleOverridablePaintPropertyUpdate(e,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven()||"model-color"!==e&&"model-color-mix-intensity"!==e&&"model-rotation"!==e&&"model-scale"!==e&&"model-translation"!==e&&"model-emissive-strength"!==e)}_isPropertyZoomDependent(e){const t=this._transitionablePaint._values[e];return null!=t&&null!=t.value&&null!=t.value.expression&&t.value.expression instanceof Os}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}}};function Wp(e,t){return"custom"===e.type?new LE(e):new qT[e.type](e,t)}function RC(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class py extends ki{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(t){this.images[t]={},this.loaded[t]=!1,this.updatedImages[t]={},this.patterns[t]={},this.callbackDispatchedThisFrame[t]={},this.atlasImage[t]=new Uo({width:1,height:1})}isLoaded(){for(const t in this.loaded)if(!this.loaded[t])return!1;return!0}setLoaded(t,r){if(this.loaded[r]!==t&&(this.loaded[r]=t,t)){for(const{ids:s,callback:c}of this.requestors)this._notify(s,r,c);this.requestors=[]}}hasImage(t,r){return!!this.getImage(t,r)}getImage(t,r){return this.images[r][t]}addImage(t,r,s){this._validate(t,s)&&(this.images[r][t]=s)}_validate(t,r){let s=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new Cn(new Error(`Image "${t}" has invalid "stretchX" value`))),s=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new Cn(new Error(`Image "${t}" has invalid "stretchY" value`))),s=!1),this._validateContent(r.content,r)||(this.fire(new Cn(new Error(`Image "${t}" has invalid "content" value`))),s=!1),s}_validateStretch(t,r){if(!t)return!0;let s=0;for(const c of t){if(c[0]<s||c[1]<c[0]||r<c[1])return!1;s=c[1]}return!0}_validateContent(t,r){return!(t&&(4!==t.length||t[0]<0||r.data.width<t[0]||t[1]<0||r.data.height<t[1]||t[2]<0||r.data.width<t[2]||t[3]<0||r.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,r,s){s.version=this.images[r][t].version+1,this.images[r][t]=s,this.updatedImages[r][t]=!0}removeImage(t,r){const s=this.images[r][t];delete this.images[r][t],delete this.patterns[r][t],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(t){return Object.keys(this.images[t])}getImages(t,r,s){let c=!0;const d=!!this.loaded[r];if(!d)for(const f of t)this.images[r][f]||(c=!1);d||c?this._notify(t,r,s):this.requestors.push({ids:t,scope:r,callback:s})}getUpdatedImages(t){return this.updatedImages[t]}_notify(t,r,s){const c={};for(const d of t){this.images[r][d]||this.fire(new de("styleimagemissing",{id:d}));const f=this.images[r][d];f?c[d]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,hasRenderCallback:!(!f.userImage||!f.userImage.render)}:gt(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}s(null,c)}getPixelSize(t){const{width:r,height:s}=this.atlasImage[t];return{width:r,height:s}}getPattern(t,r){const s=this.patterns[r][t],c=this.getImage(t,r);if(!c)return null;if(s&&s.position.version===c.version)return s.position;if(s)s.position.version=c.version;else{const d={w:c.data.width+2,h:c.data.height+2,x:0,y:0},f=new tC(d,c);this.patterns[r][t]={bin:d,position:f}}return this._updatePatternAtlas(r),this.patterns[r][t].position}bind(t,r){const s=t.gl;let c=this.atlasTexture[r];c?this.dirty&&(c.update(this.atlasImage[r]),this.dirty=!1):(c=new bi(t,this.atlasImage[r],s.RGBA),this.atlasTexture[r]=c),c.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(t){const r=[];for(const f in this.patterns[t])r.push(this.patterns[t][f].bin);const{w:s,h:c}=Sx(r),d=this.atlasImage[t];d.resize({width:s||1,height:c||1});for(const f in this.patterns[t]){const{bin:g}=this.patterns[t][f],y=g.x+1,b=g.y+1,w=this.images[t][f].data,P=w.width,O=w.height;Uo.copy(w,d,{x:0,y:0},{x:y,y:b},{width:P,height:O}),Uo.copy(w,d,{x:0,y:O-1},{x:y,y:b-1},{width:P,height:1}),Uo.copy(w,d,{x:0,y:0},{x:y,y:b+O},{width:P,height:1}),Uo.copy(w,d,{x:P-1,y:0},{x:y-1,y:b},{width:1,height:O}),Uo.copy(w,d,{x:0,y:0},{x:y+P,y:b},{width:1,height:O})}this.dirty=!0}beginFrame(){for(const t in this.images)this.callbackDispatchedThisFrame[t]={}}dispatchRenderCallbacks(t,r){for(const s of t){if(this.callbackDispatchedThisFrame[r][s])continue;this.callbackDispatchedThisFrame[r][s]=!0;const c=this.images[r][s];RC(c)&&this.updateImage(s,r,c)}}}const Mb=new jt({anchor:new G(wt.light.anchor),position:new class{constructor(e){this.specification=e}possiblyEvaluate(e,t){return Pe(e.expression.evaluate(t))}interpolate(e,t,r){return{x:vn(e.x,t.x,r),y:vn(e.y,t.y,r),z:vn(e.z,t.z,r),azimuthal:vn(e.azimuthal,t.azimuthal,r),polar:vn(e.polar,t.polar,r)}}}(wt.light.position),color:new G(wt.light.color),intensity:new G(wt.light.intensity)});class mm extends ki{constructor(t,r="flat"){super(),this._transitionable=new Xs(Mb),this.setLight(t,r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,r,s={}){this._validate(dp,t,s)||(this._transitionable.setTransitionOrValue(t),this.id=r)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,s){return(!s||!1!==s.validate)&&Uh(this,t.call(Ea,_t({value:r,style:{glyphs:!0,sprite:!0},styleSpec:wt})))}}const gy=new jt({source:new G(wt.terrain.source),exaggeration:new G(wt.terrain.exaggeration)});let Pb=class extends ki{constructor(e,t,r,s){super(),this.scope=r,this._transitionable=new Xs(gy,s),this._transitionable.setTransitionOrValue(e,s),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=t}get(){return this._transitionable.serialize()}set(e,t){this._transitionable.setTransitionOrValue(e,t)}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}getExaggeration(e){return this._transitioning.possiblyEvaluate(new Ri(e)).get("exaggeration")}isZoomDependent(){const e=this._transitionable._values.exaggeration;return null!=e&&null!=e.value&&null!=e.value.expression&&e.value.expression instanceof Os}};const LC=45,g1=65,nd=.05;function rd(e,t,r,s){const c=vs(LC,g1,r),[d,f]=m1(e,s);let g=1-Math.min(1,Math.exp((t-d)/(f-d)*-6));return g*=g*g,g=Math.min(1,1.00747*g),g*c*e.alpha}function m1(e,t){const r=.5/Math.tan(.5*t);return[e.range[0]+r,e.range[1]+r]}function Kp(e,t,r,s,c){const d=dt.transformMat4([],[t,r,s],c.mercatorFogMatrix);return rd(e,dt.length(d),c.pitch,c._fov)}function Eb(e,t,r,s,c,d,f){const g=[[r,s,0],[c,s,0],[c,d,0],[r,d,0]];let y=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(const w of g){const P=dt.transformMat4([],w,t),O=dt.length(P);y=Math.min(y,O),b=Math.max(b,O)}return[rd(e,y,f.pitch,f._fov),rd(e,b,f.pitch,f._fov)]}const ZT=new jt({range:new G(wt.fog.range),color:new G(wt.fog.color),"high-color":new G(wt.fog["high-color"]),"space-color":new G(wt.fog["space-color"]),"horizon-blend":new G(wt.fog["horizon-blend"]),"star-intensity":new G(wt.fog["star-intensity"]),"vertical-range":new G(wt.fog["vertical-range"])});class zE extends ki{constructor(t,r){super(),this._transitionable=new Xs(ZT),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=r}get state(){const t=this._transform,r="globe"===t.projection.name,s=Po(t.zoom),c=this.properties.get("range"),d=[.5,3];return{range:r?[vn(d[0],c[0],s),vn(d[1],c[1],s)]:c,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,r={}){if(this._validate(Bh,t,r))return;const s=_t({},t);for(const c of Object.keys(wt.fog))void 0===s[c]&&(s[c]=wt.fog[c].default);this._transitionable.setTransitionOrValue(s)}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const r=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:vs(LC,g1,t))*r.a}getOpacityAtLatLng(t,r){return this._transform.projection.supportsFog?function(s,c,d){const f=Xn.fromLngLat(c),g=d.elevation?d.elevation.getAtPointOrZero(f):0;return Kp(s,f.x,f.y,g,d)}(this.state,t,r):0}getOpacityForTile(t){if(!this._transform.projection.supportsFog)return[1,1];const r=this._transform.calculateFogTileMatrix(t.toUnwrapped());return Eb(this.state,r,0,0,Dt,Dt,this._transform)}getOpacityForBounds(t,r,s,c,d){return this._transform.projection.supportsFog?Eb(this.state,t,r,s,c,d,this._transform):[1,1]}getFovAdjustedRange(t){return this._transform.projection.supportsFog?m1(this.state,t):[0,1]}isVisibleOnFrustum(t){if(!this._transform.projection.supportsFog)return!1;const r=[4,5,6,7];for(const s of r){const c=t.points[s];let d;if(c[2]>=0)d=c;else{const f=t.points[s-4];d=mg(f,c,f[2]/(f[2]-c[2]))}if(Kp(this.state,d[0],d[1],0,this._transform)>=nd)return!0}return!1}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,s){return(!s||!1!==s.validate)&&Uh(this,t.call(Ea,_t({value:r,style:{glyphs:!0,sprite:!0},styleSpec:wt})))}}class NC{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Ob{constructor(){this.tasks={},this.taskQueue=[],Tn(["process"],this),this.invoker=new NC(this.process),this.nextId=0}add(t,r){const s=this.nextId++,c=function({type:d,isSymbolTile:f,zoom:g}){return g=g||0,"message"===d?0:"maybePrepare"!==d||f?"parseTile"!==d||f?"parseTile"===d&&f?300-g:"maybePrepare"===d&&f?400-g:500:200-g:100-g}(r);if(0===c){ae();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:t,metadata:r,priority:c,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){ae();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const t=this.pick();if(null===t)return;const r=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let t=null,r=1/0;for(let c=0;c<this.taskQueue.length;c++){const d=this.tasks[this.taskQueue[c]];d.priority<r&&(r=d.priority,t=c)}if(null===t)return null;const s=this.taskQueue[t];return this.taskQueue.splice(t,1),s}remove(){this.invoker.remove()}}class Tb{constructor(t,r,s){this.target=t,this.parent=r,this.mapId=s,this.callbacks={},this.cancelCallbacks={},Tn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Ob}send(t,r,s,c,d=!1,f){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=f,this.callbacks[g]=s);const y=new Set;return this.target.postMessage({id:g,type:t,hasCallback:!!s,targetMapId:c,mustQueue:d,sourceMapId:this.mapId,data:nc(r,y)},y),{cancel:()=>{s&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(t){const r=t.data,s=r.id;if(s&&(!r.targetMapId||this.mapId===r.targetMapId))if("<cancel>"===r.type){const c=this.cancelCallbacks[s];delete this.cancelCallbacks[s],c&&c.cancel()}else if(r.mustQueue||ae()){const c=this.callbacks[s];this.cancelCallbacks[s]=this.scheduler.add(()=>this.processTask(s,r),c&&c.metadata||{type:"message"})}else this.processTask(s,r)}processTask(t,r){if("<response>"===r.type){const s=this.callbacks[t];delete this.callbacks[t],s&&(r.error?s(U(r.error)):s(null,U(r.data)))}else{const s=new Set,c=r.hasCallback?(f,g)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:f?nc(f):null,data:nc(g,s)},s)}:f=>{},d=U(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,d,c);else if(this.parent.getWorkerSource){const f=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,f[0],d.source,d.scope)[f[1]](d,c)}else c(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}let _m=(()=>{class e{constructor(r,s){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=In();const c=this.workerPool.acquire(this.id);for(let d=0;d<c.length;d++){const f=new e.Actor(c[d],s,this.id);f.name=`Worker ${d}`,this.actors.push(f)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,s,c){Kt(this.actors,(d,f)=>{d.send(r,s,f)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}return e.Actor=Tb,e})();class _1 extends ki{constructor(t,r,s,c){super(),this.scope=s,this._options=t,this.properties=new j(r),this._transitionable=new Xs(r,new Map(c)),this._transitionable.setTransitionOrValue(t.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(t){this._transitionable.setTransitionOrValue(this._options.properties,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(t,r){this._options=t,this._transitionable.setTransitionOrValue(t.properties,r)}shadowsEnabled(){return!!this.properties&&!0===this.properties.get("cast-shadows")}}const my=new jt({color:new G(wt.properties_light_ambient.color),intensity:new G(wt.properties_light_ambient.intensity)}),y1=new jt({direction:new class{constructor(e){this.specification=e}possiblyEvaluate(e,t){return function([r,s]){const c=Pe([1,r,s]);return{x:c.x,y:c.y,z:c.z}}(e.expression.evaluate(t))}interpolate(e,t,r){return{x:vn(e.x,t.x,r),y:vn(e.y,t.y,r),z:vn(e.z,t.z,r)}}}(wt.properties_light_directional.direction),color:new G(wt.properties_light_directional.color),intensity:new G(wt.properties_light_directional.intensity),"cast-shadows":new G(wt.properties_light_directional["cast-shadows"]),"shadow-intensity":new G(wt.properties_light_directional["shadow-intensity"])});class Ib{constructor(t,r,s,c){this.screenBounds=t,this.cameraPoint=r,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=s,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,c)}static createFromScreenPoints(t,r){let s,c;if(t instanceof tt||"number"==typeof t[0]){const d=tt.convert(t);s=[d],c=r.isPointAboveHorizon(d)}else{const d=tt.convert(t[0]),f=tt.convert(t[1]);s=[d,f],c=Go(d,f).every(g=>r.isPointAboveHorizon(g))}return new Ib(s,r.getCameraPoint(),c,r)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(t){return Go(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const r=this.screenBounds[0],s=1===this.screenBounds.length?this.screenBounds[0].add(new tt(1,1)):this.screenBounds[1],c=Go(r,s,0,!1);return this.cameraPoint.y>s.y&&(this.cameraPoint.x>r.x&&this.cameraPoint.x<s.x?c.splice(3,0,this.cameraPoint):this.cameraPoint.x>=s.x?c[2]=this.cameraPoint:this.cameraPoint.x<=r.x&&(c[3]=this.cameraPoint)),function(d,f){const g=[];for(let y=0;y<d.length;y++){const b=Wt(y-1,-1,d.length-1),w=Wt(y+1,-1,d.length-1),P=d[y],O=d[w],I=d[b].sub(P).unit(),A=O.sub(P).unit(),l=A.angleWithSep(I.x,I.y),u=I.add(A).unit().mult(-1*f/Math.sin(l/2));g.push(P.add(u))}return g}(c,t)}bufferedCameraGeometryGlobe(t){const r=this.screenBounds[0],s=1===this.screenBounds.length?this.screenBounds[0].add(new tt(1,1)):this.screenBounds[1],c=Go(r,s,t),d=this.cameraPoint.clone();switch(3*((d.y>r.y)+(d.y>s.y))+((d.x>r.x)+(d.x>s.x))){case 0:c[0]=d,c[4]=d.clone();break;case 1:c.splice(1,0,d);break;case 2:c[1]=d;break;case 3:c.splice(4,0,d);break;case 5:c.splice(2,0,d);break;case 6:c[3]=d;break;case 7:c.splice(3,0,d);break;case 8:c[2]=d}return c}containsTile(t,r,s,c=0){const d=t.queryPadding/r._pixelsPerMercatorPixel+1,f=s?this._bufferedCameraMercator(d,r):this._bufferedScreenMercator(d,r);let g=t.tileID.wrap+(f.unwrapped?c:0);const y=f.polygon.map(u=>iE(t.tileTransform,u,g));if(!FP(y,0,0,Dt,Dt))return;g=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?c:0);const b=this.screenGeometryMercator.polygon.map(u=>iC(t.tileTransform,u,g)),w=b.map(u=>new tt(u[0],u[1])),P=r.getFreeCameraOptions().position||new Xn(0,0,0),O=iC(t.tileTransform,P,g),I=b.map(u=>{const p=dt.sub(u,u,O);return dt.normalize(p,p),new ex(O,p)}),A=Ju(t,1,r.zoom)*r._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:w,tilespaceRays:I,bufferedTilespaceGeometry:y,bufferedTilespaceBounds:(l=cs(y),l.min.x=Ne(l.min.x,0,Dt),l.min.y=Ne(l.min.y,0,Dt),l.max.x=Ne(l.max.x,0,Dt),l.max.y=Ne(l.max.y,0,Dt),l),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:A};var l}_bufferedScreenMercator(t,r){const s=b1(t);if(this._screenRaycastCache[s])return this._screenRaycastCache[s];{let c;return c="globe"===r.projection.name?this._projectAndResample(this.bufferedScreenGeometry(t),r):{polygon:this.bufferedScreenGeometry(t).map(d=>r.pointCoordinate3D(d)),unwrapped:!0},this._screenRaycastCache[s]=c,c}}_bufferedCameraMercator(t,r){const s=b1(t);if(this._cameraRaycastCache[s])return this._cameraRaycastCache[s];{let c;return c="globe"===r.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),r):{polygon:this.bufferedCameraGeometry(t).map(d=>r.pointCoordinate3D(d)),unwrapped:!0},this._cameraRaycastCache[s]=c,c}}_projectAndResample(t,r){const s=function(d,f){const g=bt.multiply([],f.pixelMatrix,f.globeMatrix),y=[0,-ea,0,1],b=[0,ea,0,1],w=[0,0,0,1];kr.transformMat4(y,y,g),kr.transformMat4(b,b,g),kr.transformMat4(w,w,g);const P=new tt(y[0]/y[3],y[1]/y[3]),O=new tt(b[0]/b[3],b[1]/b[3]),I=$c(d,P)&&y[3]<w[3],A=$c(d,O)&&b[3]<w[3];if(!I&&!A)return null;const l=function(k,N,F){for(let $=1;$<k.length;$++){const q=ym(N.pointCoordinate3D(k[$-1]).x),Z=ym(N.pointCoordinate3D(k[$]).x);if(F<0){if(q<Z)return{idx:$,t:-q/(Z-1-q)}}else if(Z<q)return{idx:$,t:(1-q)/(Z+1-q)}}return null}(d,f,I?-1:1);if(!l)return null;const{idx:u,t:p}=l;let m=u>1?v1(d.slice(0,u),f):[],v=u<d.length?v1(d.slice(u),f):[];m=m.map(k=>new tt(ym(k.x),k.y)),v=v.map(k=>new tt(ym(k.x),k.y));const C=[...m];0===C.length&&C.push(v[v.length-1]);const E=vn(C[C.length-1].y,(0===v.length?m[0]:v[0]).y,p);let T;return T=I?[new tt(0,E),new tt(0,0),new tt(1,0),new tt(1,E)]:[new tt(1,E),new tt(1,1),new tt(0,1),new tt(0,E)],C.push(...T),0===v.length?C.push(m[0]):C.push(...v),{polygon:C.map(k=>new Xn(k.x,k.y)),unwrapped:!1}}(t,r);if(s)return s;const c=function(d,f){let g=!1,y=-1/0,b=0;for(let P=0;P<d.length-1;P++)d[P].x>y&&(y=d[P].x,b=P);for(let P=0;P<d.length-1;P++){const O=(b+P)%(d.length-1),I=d[O],A=d[O+1];Math.abs(I.x-A.x)>.5&&(I.x<A.x?(I.x+=1,0===O&&(d[d.length-1].x+=1)):(A.x+=1,O+1===d.length-1&&(d[0].x+=1)),g=!0)}const w=yo(f.center.lng);return g&&w<Math.abs(w-1)&&d.forEach(P=>{P.x-=1}),{polygon:d,unwrapped:g}}(v1(t,r).map(d=>new tt(ym(d.x),d.y)),r);return{polygon:c.polygon.map(d=>new Xn(d.x,d.y)),unwrapped:c.unwrapped}}}function v1(e,t){return Vu(e,r=>{const s=t.pointCoordinate3D(r);r.x=s.x,r.y=s.y},1/256)}function ym(e){return e<0?1+e%1:e%1}function b1(e){return 100*e|0}function x1(e,t,r,s,c){const d=function(f,g){if(f)return c(f);if(g){e.url&&g.tiles&&e.tiles&&delete e.tiles;const y=he(_t(g,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);g.vector_layers&&(y.vectorLayers=g.vector_layers,y.vectorLayerIds=y.vectorLayers.map(b=>b.id)),y.tiles=t.canonicalizeTileset(y,e.url),c(null,y)}};return e.url?_e(t.transformRequest(t.normalizeSourceURL(e.url,null,r,s),Ft.Source),d):Mn.frame(()=>d(null,e))}class _y{constructor(t,r,s){this.bounds=Xi.convert(this.validateBounds(t)),this.minzoom=r||0,this.maxzoom=s||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const r=Math.pow(2,t.z),s=Math.floor(yo(this.bounds.getWest())*r),c=Math.floor(Pi(this.bounds.getNorth())*r),d=Math.ceil(yo(this.bounds.getEast())*r),f=Math.ceil(Pi(this.bounds.getSouth())*r);return t.x>=s&&t.x<d&&t.y>=c&&t.y<f}}class BE{constructor(t,r){this.width=t,this.height=r,this.nextRow=0,this.image=new cf({width:t,height:r}),this.positions={},this.uploaded=!1}getDash(t,r){const s=this.getKey(t,r);return this.positions[s]}trim(){const t=this.width,r=this.height=wi(this.nextRow);this.image.resize({width:t,height:r})}getKey(t,r){return t.join(",")+r}getDashRanges(t,r,s){const c=[];let d=t.length%2==1?-t[t.length-1]*s:0,f=t[0]*s,g=!0;c.push({left:d,right:f,isDash:g,zeroLength:0===t[0]});let y=t[0];for(let b=1;b<t.length;b++){g=!g;const w=t[b];d=y*s,y+=w,f=y*s,c.push({left:d,right:f,isDash:g,zeroLength:0===w})}return c}addRoundDash(t,r,s){const c=r/2;for(let d=-s;d<=s;d++){const f=this.width*(this.nextRow+s+d);let g=0,y=t[g];for(let b=0;b<this.width;b++){b/y.right>1&&(y=t[++g]);const w=Math.abs(b-y.left),P=Math.abs(b-y.right),O=Math.min(w,P);let I;const A=d/s*(c+1);if(y.isDash){const l=c-Math.abs(A);I=Math.sqrt(O*O+l*l)}else I=c-Math.sqrt(O*O+A*A);this.image.data[f+b]=Math.max(0,Math.min(255,I+128))}}}addRegularDash(t,r){for(let y=t.length-1;y>=0;--y){const b=t[y],w=t[y+1];b.zeroLength?t.splice(y,1):w&&w.isDash===b.isDash&&(w.left=b.left,t.splice(y,1))}const s=t[0],c=t[t.length-1];s.isDash===c.isDash&&(s.left=c.left-this.width,c.right=s.right+this.width);const d=this.width*this.nextRow;let f=0,g=t[f];for(let y=0;y<this.width;y++){y/g.right>1&&(g=t[++f]);const b=Math.abs(y-g.left),w=Math.abs(y-g.right),P=Math.min(b,w);this.image.data[d+y]=Math.max(0,Math.min(255,(g.isDash?P:-P)+r+128))}}addDash(t,r){const s=this.getKey(t,r);if(this.positions[s])return this.positions[s];const c="round"===r,d=c?7:0,f=2*d+1;if(this.nextRow+f>this.height)return gt("LineAtlas out of space"),null;0===t.length&&t.push(1);let g=0;for(let w=0;w<t.length;w++)t[w]<0&&(gt("Negative value is found in line dasharray, replacing values with 0"),t[w]=0),g+=t[w];if(0!==g){const w=this.width/g,P=this.getDashRanges(t,this.width,w);c?this.addRoundDash(P,w,d):this.addRegularDash(P,"square"===r?.5*w:0)}const y=this.nextRow+d;this.nextRow+=f;const b={tl:[y,d],br:[g,0]};return this.positions[s]=b,b}}De(BE,"LineAtlas");const w1=1*To;class UE{constructor(t){const r={},s=[];for(const g in t){const y=t[g],b=r[g]={};for(const w in y.glyphs){const P=y.glyphs[+w];if(!P||0===P.bitmap.width||0===P.bitmap.height)continue;const O=P.metrics.localGlyph?w1:1,I={x:0,y:0,w:P.bitmap.width+2*O,h:P.bitmap.height+2*O};s.push(I),b[w]=I}}const{w:c,h:d}=Sx(s),f=new cf({width:c||1,height:d||1});for(const g in t){const y=t[g];for(const b in y.glyphs){const w=y.glyphs[+b];if(!w||0===w.bitmap.width||0===w.bitmap.height)continue;const P=r[g][b],O=w.metrics.localGlyph?w1:1;cf.copy(w.bitmap,f,{x:0,y:0},{x:P.x+O,y:P.y+O},w.bitmap)}}this.image=f,this.positions=r}}De(UE,"GlyphAtlas");class C1{constructor(t){this.tileID=new Ir(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.scope=t.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.promoteId=t.promoteId,this.isSymbolTile=t.isSymbolTile,this.tileTransform=Ku(t.tileID.canonical,t.projection),this.projection=t.projection,this.brightness=t.brightness,this.extraShadowCaster=!!t.extraShadowCaster}parse(t,r,s,c,d){this.status="parsing",this.data=t,this.collisionBoxArray=new tv;const f=new Cx(Object.keys(t.layers).sort()),g=new Fv(this.tileID,this.promoteId);g.bucketLayerIDs=[];const y={},b=new BE(256,256),w={featureIndex:g,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:b,availableImages:s,brightness:this.brightness},P=r.familiesBySource[this.source];for(const m in P){const v=t.layers[m];if(!v)continue;let C=!1,E=!1,T=!1;for(const F of P[m])"symbol"===F[0].type?C=!0:E=!0,F[0].is3D()&&"model"!==F[0].type&&(T=!0);if(this.extraShadowCaster&&!T||!0===this.isSymbolTile&&!C||!1===this.isSymbolTile&&!E)continue;1===v.version&&gt(`Vector tile source "${this.source}" layer "${m}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const k=f.encode(m),N=[];for(let F=0;F<v.length;F++){const $=v.feature(F),q=g.getId($,m);N.push({feature:$,id:q,index:F,sourceLayerIndex:k})}for(const F of P[m]){const $=F[0];(!this.extraShadowCaster||$.is3D()&&"model"!==$.type)&&(void 0!==this.isSymbolTile&&"symbol"===$.type!==this.isSymbolTile||$.minzoom&&this.zoom<Math.floor($.minzoom)||$.maxzoom&&this.zoom>=$.maxzoom||"none"!==$.visibility&&(VE(F,this.zoom,w.brightness,s),(y[$.id]=$.createBucket({index:g.bucketLayerIDs.length,layers:F,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:k,sourceID:this.source,projection:this.projection.spec})).populate(N,w,this.tileID.canonical,this.tileTransform),g.bucketLayerIDs.push(F.map(q=>q.id))))}}let O,I,A,l;b.trim();const u={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},p=()=>{if(O)return this.status="done",d(O);if(this.extraShadowCaster)this.status="done",d(null,{buckets:pe(y).filter(m=>!m.isEmpty()),featureIndex:g,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:w.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(I&&A&&l){const m=new UE(I),v=new Ax(A,l);for(const C in y){const E=y[C];E instanceof xf?(VE(E.layers,this.zoom,w.brightness,s),hc(E,I,m.positions,A,v.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):E.hasPattern&&(E instanceof Vp||E instanceof Ev||E instanceof gm)&&(VE(E.layers,this.zoom,w.brightness,s),E.addFeatures(w,this.tileID.canonical,v.patternPositions,s,this.tileTransform,this.brightness))}this.status="done",d(null,{buckets:pe(y).filter(C=>!C.isEmpty()),featureIndex:g,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:m.image,lineAtlas:b,imageAtlas:v,brightness:w.brightness})}};if(!this.extraShadowCaster){const m=hi(w.glyphDependencies,E=>Object.keys(E).map(Number));Object.keys(m).length?c.send("getGlyphs",{uid:this.uid,stacks:m,scope:this.scope},(E,T)=>{O||(O=E,I=T,p())},void 0,!1,u):I={};const v=Object.keys(w.iconDependencies);v.length?c.send("getImages",{icons:v,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(E,T)=>{O||(O=E,A=T,p())},void 0,!1,u):A={};const C=Object.keys(w.patternDependencies);C.length?c.send("getImages",{icons:C,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(E,T)=>{O||(O=E,l=T,p())},void 0,!1,u):l={}}p()}}function VE(e,t,r,s){const c=new Ri(t,{brightness:r});for(const d of e)d.recalculate(c,s)}class Sb{constructor(t){this.entries={},this.scheduler=t}request(t,r,s,c){const d=this.entries[t]=this.entries[t]||{callbacks:[]};if(d.result){const[f,g]=d.result;return this.scheduler?this.scheduler.add(()=>{c(f,g)},r):c(f,g),()=>{}}return d.callbacks.push(c),d.cancel||(d.cancel=s((f,g)=>{d.result=[f,g];for(const y of d.callbacks)this.scheduler?this.scheduler.add(()=>{y(f,g)},r):y(f,g);setTimeout(()=>delete this.entries[t],3e3)})),()=>{d.result||(d.callbacks=d.callbacks.filter(f=>f!==c),d.callbacks.length||(d.cancel(),delete this.entries[t]))}}}function FC(e,t,r){const s=JSON.stringify(e.request);return e.data&&(this.deduped.entries[s]={result:[null,e.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom},c=>{const d=ve(e.request,(f,g,y,b)=>{f?c(f):g&&c(null,{vectorTile:r?void 0:new wx(new Dv(g)),rawData:g,cacheControl:y,expires:b})});return()=>{d.cancel(),c()}},t)}class M1 extends ki{constructor(t,r,s,c){if(super(),this.id=t,this.dispatcher=s,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,_t(this,he(r,["url","scheme","tileSize","promoteId"])),this._options=_t({type:"vector"},r),this._collectResourceTiming=!!r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(c),this._tileWorkers={},this._deduped=new Sb}load(t){this._loaded=!1,this.fire(new de("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,s=this.map._worldview;this._tileJSONRequest=x1(this._options,this.map._requestManager,r,s,(c,d)=>{this._tileJSONRequest=null,this._loaded=!0,c?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),s&&2!==s.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${s}`),this.fire(new Cn(c))):d&&(_t(this,d),d.bounds&&(this.tileBounds=new _y(d.bounds,this.minzoom,this.maxzoom)),Re(d.tiles,this.map._requestManager._customAccessToken),this.fire(new de("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new de("data",{dataType:"source",sourceDataType:"content"}))),t&&t(c)})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=sn(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return _t({},this._options)}loadTile(t,r){const s=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),c={request:this.map._requestManager.transformRequest(s,Ft.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:Mn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:t.isExtraShadowCaster};if(c.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state)"loading"===t.state?t.reloadCallback=r:t.request=t.actor.send("reloadTile",c,d.bind(this));else if(t.actor=this._tileWorkers[s]=this._tileWorkers[s]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",c,d.bind(this),void 0,!0);else{const f=FC.call({deduped:this._deduped},c,(g,y)=>{g||!y?d.call(this,g):(c.data={cacheControl:y.cacheControl,expires:y.expires,rawData:y.rawData.slice(0)},t.actor&&t.actor.send("loadTile",c,d.bind(this),void 0,!0))},!0);t.request={cancel:f}}function d(f,g){return delete t.request,t.aborted?r(null):f&&404!==f.status?r(f):(g&&g.resourceTiming&&(t.resourceTiming=g.resourceTiming),this.map._refreshExpiredTiles&&g&&t.setExpiryData(g),t.loadVectorData(g,this.map.painter),ds(this.dispatcher),r(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t){t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope}),t.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class P1 extends ki{constructor(t,r,s,c){super(),this.id=t,this.dispatcher=s,this.setEventedParent(c),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=_t({type:"raster"},r),_t(this,he(r,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new de("dataloading",{dataType:"source"})),this._tileJSONRequest=x1(this._options,this.map._requestManager,null,null,(r,s)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new Cn(r)):s&&(_t(this,s),s.bounds&&(this.tileBounds=new _y(s.bounds,this.minzoom,this.maxzoom)),Re(s.tiles),this.fire(new de("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new de("data",{dataType:"source",sourceDataType:"content"}))),t&&t(r)})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=sn(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return _t({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,r){const s=Mn.devicePixelRatio>=2,c=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),s,this.tileSize);t.request=Bt(this.map._requestManager.transformRequest(c,Ft.Tile),(d,f,g,y)=>(delete t.request,t.aborted?(t.state="unloaded",r(null)):d?(t.state="errored",r(d)):f?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:g,expires:y}),t.setTexture(f,this.map.painter),t.state="loaded",ds(this.dispatcher),void r(null)):r(null)))}abortTile(t,r){t.request&&(t.request.cancel(),delete t.request),r()}unloadTile(t,r){t.texture&&t.texture instanceof bi?(t.destroy(!0),t.texture&&t.texture instanceof bi&&this.map.painter.saveTileTexture(t.texture)):t.destroy(),r()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function zC(){return null!=FM.workerClass?new FM.workerClass:new lt.Worker(FM.workerUrl)}const Yp="mapboxgl_preloaded_worker_pool";class yc{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<yc.workerCount;)this.workers.push(new zC);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&0===this.numActive()&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Yp]}numActive(){return Object.keys(this.active).length}}let Xp;function dh(){return Xp||(Xp=new yc),Xp}yc.workerCount=2;let Sf,E1,Fa,BC=null;function jE(){return ae()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:E1||ue.DRACO_URL}const Ab=5123,Db=5126,Af={5120:Int8Array,5121:Uint8Array,5122:Int16Array,[Ab]:Uint16Array,5125:Uint32Array,[Db]:Float32Array},O1={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",[Ab]:"DT_UINT16",5125:"DT_UINT32",[Db]:"DT_FLOAT32"},T1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function UC(e,t,r){const s=r.json.bufferViews.length,c=r.buffers.length;t.bufferView=s,r.json.bufferViews[s]={buffer:c,byteLength:e.byteLength},r.buffers[c]=e}const yy="KHR_draco_mesh_compression";function I1(e,t){const r=e.extensions&&e.extensions[yy];if(!r)return;const s=new Fa.Decoder,c=jC(t,r.bufferView),d=new Fa.Mesh;if(!s.DecodeArrayToMesh(c,c.byteLength,d))throw new Error("Failed to decode Draco mesh");const f=t.json.accessors[e.indices],g=Af[f.componentType],y=f.count*g.BYTES_PER_ELEMENT,b=Fa._malloc(y);g===Uint16Array?s.GetTrianglesUInt16Array(d,y,b):s.GetTrianglesUInt32Array(d,y,b),UC(Fa.memory.buffer.slice(b,b+y),f,t),Fa._free(b);for(const w of Object.keys(r.attributes)){const P=s.GetAttributeByUniqueId(d,r.attributes[w]),O=t.json.accessors[e.attributes[w]],I=O1[O.componentType],A=O.count*T1[O.type]*Af[O.componentType].BYTES_PER_ELEMENT,l=Fa._malloc(A);s.GetAttributeDataArrayForAllPoints(d,P,Fa[I],A,l),UC(Fa.memory.buffer.slice(l,l+A),O,t),Fa._free(l)}s.destroy(),d.destroy(),delete e.extensions[yy]}const $E=1179937895,VC=new TextDecoder("utf8");function WT(e,t){return new URL(e,t).href}function KT(e,t,r,s){return fetch(WT(e.uri,s)).then(c=>c.arrayBuffer()).then(c=>{t.buffers[r]=c})}function jC(e,t){const r=e.json.bufferViews[t];return new Uint8Array(e.buffers[r.buffer],r.byteOffset||0,r.byteLength)}function GE(e,t,r,s){if(e.uri){const c=WT(e.uri,s);return fetch(c).then(d=>d.blob()).then(d=>lt.createImageBitmap(d)).then(d=>{t.images[r]=d})}if(void 0!==e.bufferView){const c=jC(t,e.bufferView),d=new lt.Blob([c],{type:e.mimeType});return lt.createImageBitmap(d).then(f=>{t.images[r]=f})}}function $C(e,t=0,r){const s={json:null,images:[],buffers:[]};if(new Uint32Array(e,t,1)[0]===$E){const b=new Uint32Array(e,t);let w=2;const P=(b[w++]>>2)-3,O=b[w++]>>2;if(w++,s.json=JSON.parse(VC.decode(b.subarray(w,w+O))),w+=O,w<P){const I=b[w++];w++;const A=t+(w<<2);s.buffers[0]=e.slice(A,A+I)}}else s.json=JSON.parse(VC.decode(new Uint8Array(e,t)));const{buffers:c,images:d,meshes:f,extensionsUsed:g}=s.json;let y=Promise.resolve();if(c){const b=[];for(let w=0;w<c.length;w++){const P=c[w];P.uri?b.push(KT(P,s,w,r)):s.buffers[w]||(s.buffers[w]=null)}y=Promise.all(b)}return y.then(()=>{const b=[],w=g&&g.includes(yy);if(w&&b.push(function(){if(!Fa)return Sf||(Sf=function(P){let O,I=null;function A(){O=new Uint8Array(I.buffer)}function l(){throw new Error("Unexpected Draco error.")}const u={a:{a:l,d:function(p,m,v){return O.copyWithin(p,m,m+v)},c:function(p){const m=O.length,v=Math.max(p>>>0,Math.ceil(1.2*m)),C=Math.ceil((v-m)/65536);try{return I.grow(C),A(),!0}catch{return!1}},b:l}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(P,u):P.then(p=>p.arrayBuffer()).then(p=>WebAssembly.instantiate(p,u))).then(p=>{const{Rb:m,Qb:v,P:C,T:E,X:T,Ja:k,La:N,Qa:F,Va:$,Wa:q,eb:Z,jb:X,f:K,e:J,yb:st,zb:ot,Ab:rt,Bb:ct,Db:yt,Gb:Ot}=p.instance.exports;I=J;const Tt=(()=>{let zt=0,Nt=0,$t=0,Rt=0;return ie=>{$t&&(m(Rt),m(zt),Nt+=$t,$t=zt=0),zt||(Nt+=128,zt=v(Nt));const Ee=ie.length+7&-8;let Oe=zt;Ee>=Nt&&($t=Ee,Oe=Rt=v(Ee));for(let Be=0;Be<ie.length;Be++)O[Oe+Be]=ie[Be];return Oe}})();return A(),K(),{memory:J,_free:m,_malloc:v,Mesh:class{constructor(){this.ptr=C()}destroy(){E(this.ptr)}},Decoder:class{constructor(){this.ptr=k()}destroy(){X(this.ptr)}DecodeArrayToMesh(zt,Nt,$t){const Rt=Tt(zt),ie=N(this.ptr,Rt,Nt,$t.ptr);return!!T(ie)}GetAttributeByUniqueId(zt,Nt){return{ptr:F(this.ptr,zt.ptr,Nt)}}GetTrianglesUInt16Array(zt,Nt,$t){$(this.ptr,zt.ptr,Nt,$t)}GetTrianglesUInt32Array(zt,Nt,$t){q(this.ptr,zt.ptr,Nt,$t)}GetAttributeDataArrayForAllPoints(zt,Nt,$t,Rt,ie){Z(this.ptr,zt.ptr,Nt.ptr,$t,Rt,ie)}},DT_INT8:st(),DT_UINT8:ot(),DT_INT16:rt(),DT_UINT16:ct(),DT_UINT32:yt(),DT_FLOAT32:Ot()}})}(fetch(jE())),Sf.then(P=>{Fa=P,Sf=void 0}))}()),d)for(let P=0;P<d.length;P++)b.push(GE(d[P],s,P,r));return(b.length?Promise.all(b):Promise.resolve()).then(()=>{if(w&&f)for(const{primitives:P}of f)for(const O of P)I1(O,s);return s})})}function HE(e){return fetch(e).then(t=>t.arrayBuffer()).then(t=>$C(t,0,e))}class qE{constructor(t,r,s){if(this.triangleCount=r.length/3,this.min=new tt(0,0),this.max=new tt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],0===this.triangleCount||0===t.length||0===s)return;const c=t.map(w=>w.x),d=t.map(w=>w.y);this.min=new tt(Math.min(...c),Math.min(...d)),this.max=new tt(Math.max(...c),Math.max(...d));const f=this.max.sub(this.min);f.x=Math.max(f.x,1),f.y=Math.max(f.y,1);const g=Math.max(f.x,f.y)/s;this.cellsX=Math.max(1,Math.ceil(f.x/g)),this.cellsY=Math.max(1,Math.ceil(f.y/g)),this.xScale=1/g,this.yScale=1/g;const y=[];for(let w=0;w<this.triangleCount;w++){const P=t[r[3*w+0]].sub(this.min),O=t[r[3*w+1]].sub(this.min),I=t[r[3*w+2]].sub(this.min),A=Jc(Math.floor(Math.min(P.x,O.x,I.x)),this.xScale,this.cellsX),l=Jc(Math.floor(Math.max(P.x,O.x,I.x)),this.xScale,this.cellsX),u=Jc(Math.floor(Math.min(P.y,O.y,I.y)),this.yScale,this.cellsY),p=Jc(Math.floor(Math.max(P.y,O.y,I.y)),this.yScale,this.cellsY),m=new tt(0,0),v=new tt(0,0),C=new tt(0,0),E=new tt(0,0);for(let T=u;T<=p;++T){m.y=v.y=T*g,C.y=E.y=(T+1)*g;for(let k=A;k<=l;++k)m.x=C.x=k*g,v.x=E.x=(k+1)*g,(wv(P,O,I,m,v,E)||wv(P,O,I,m,E,C))&&y.push({cellIdx:T*this.cellsX+k,triIdx:w})}}if(0===y.length)return;y.sort((w,P)=>w.cellIdx-P.cellIdx||w.triIdx-P.triIdx);let b=0;for(;b<y.length;){const w=y[b].cellIdx,P={start:this.payload.length,len:0};for(;b<y.length&&y[b].cellIdx===w;)++P.len,this.payload.push(y[b++].triIdx);this.cells[w]=P}}query(t,r,s){if(0===this.triangleCount||0===this.cells.length||t.x>this.max.x||this.min.x>r.x||t.y>this.max.y||this.min.y>r.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let y=0;y<this.lookup.length;y++)this.lookup[y]=0;const c=Jc(t.x-this.min.x,this.xScale,this.cellsX),d=Jc(r.x-this.min.x,this.xScale,this.cellsX),f=Jc(t.y-this.min.y,this.yScale,this.cellsY),g=Jc(r.y-this.min.y,this.yScale,this.cellsY);for(let y=f;y<=g;y++)for(let b=c;b<=d;b++){const w=this.cells[y*this.cellsX+b];if(w)for(let P=0;P<w.len;P++){const O=this.payload[w.start+P],I=Math.floor(O/8),A=1<<O%8;if(!(this.lookup[I]&A)&&(this.lookup[I]|=A,s.push(O),s.length===this.triangleCount))return}}}}function Jc(e,t,r){return Math.max(0,Math.min(r-1,Math.floor(e*t)))}function vm(e,t){const r=e.json.bufferViews[t.bufferView];return new Af[t.componentType](e.buffers[r.buffer],(t.byteOffset||0)+(r.byteOffset||0),t.count*T1[t.type])}function kb(e,t,r){const s=e.indices,c=e.attributes,d={};d.indexArray=new Mo;const f=t.json.accessors[s],g=f.count/3;d.indexArray.reserve(g);const y=vm(t,f);for(let O=0;O<g;O++)d.indexArray.emplaceBack(y[3*O],y[3*O+1],y[3*O+2]);d.indexArray._trim(),d.vertexArray=new Jy;const b=t.json.accessors[c.POSITION];d.vertexArray.reserve(b.count);const w=vm(t,b);for(let O=0;O<b.count;O++)d.vertexArray.emplaceBack(w[3*O],w[3*O+1],w[3*O+2]);if(d.vertexArray._trim(),d.aabb=new _i(b.min,b.max),d.centroid=function(O,I){const A=[0,0,0],l=O.length;if(l>0){for(let u=0;u<l;u++){const p=3*O[u];A[0]+=I[p],A[1]+=I[p+1],A[2]+=I[p+2]}A[0]/=l,A[1]/=l,A[2]/=l}return A}(y,w),void 0!==c.COLOR_0){const O=t.json.accessors[c.COLOR_0],I=T1[O.type];if(O.componentType===Db){d.colorArray=3===I?new Jy:new Du,d.colorArray.reserve(O.count);const A=vm(t,O);if(3===I)for(let l=0;l<O.count;l++)d.colorArray.emplaceBack(A[3*l],A[3*l+1],A[3*l+2]);else for(let l=0;l<O.count;l++)d.colorArray.emplaceBack(A[4*l],A[4*l+1],A[4*l+2],A[4*l+3]);d.colorArray._trim()}else if(O.componentType===Ab&&4===I){d.colorArray=new Du,d.colorArray.resize(O.count);const A=vm(t,O),l=1/65535,u=d.colorArray.float32;for(let p=0;p<4*A.length;++p)u[p]=A[p]*l}else gt(`glTF color buffer parsing for accessor ${JSON.stringify(O)} is not supported`)}if(void 0!==c.NORMAL){d.normalArray=new Jy;const O=t.json.accessors[c.NORMAL];d.normalArray.reserve(O.count);const I=vm(t,O);for(let A=0;A<O.count;A++)d.normalArray.emplaceBack(I[3*A],I[3*A+1],I[3*A+2]);d.normalArray._trim()}if(void 0!==c.TEXCOORD_0&&r.length>0){d.texcoordArray=new _w;const O=t.json.accessors[c.TEXCOORD_0];d.texcoordArray.reserve(O.count);const I=vm(t,O);for(let A=0;A<O.count;A++)d.texcoordArray.emplaceBack(I[2*A],I[2*A+1]);d.texcoordArray._trim()}const P=e.material;return d.material=function(O,I){const{emissiveFactor:A=[0,0,0],alphaMode:l="OPAQUE",alphaCutoff:u=.5,normalTexture:p,occlusionTexture:m,emissiveTexture:v,doubleSided:C}=O,{baseColorFactor:E=[1,1,1,1],metallicFactor:T=1,roughnessFactor:k=1,baseColorTexture:N,metallicRoughnessTexture:F}=O.pbrMetallicRoughness||{};return{pbrMetallicRoughness:{baseColorFactor:new bn(...E),metallicFactor:T,roughnessFactor:k,baseColorTexture:N?I[N.index]:void 0,metallicRoughnessTexture:F?I[F.index]:void 0},doubleSided:C,emissiveFactor:A,alphaMode:l,alphaCutoff:u,normalTexture:p?I[p.index]:void 0,occlusionTexture:m?I[m.index]:void 0,emissionTexture:v?I[v.index]:void 0,defined:void 0===O.defined}}(void 0!==P?t.json.materials[P]:{defined:!1},r),void 0!==c._FEATURE_RGBA4444&&(d.featureData=new Uint32Array(vm(t,t.json.accessors[c._FEATURE_RGBA4444]).buffer)),d}function S1(e,t,r){const{matrix:s,rotation:c,translation:d,scale:f,mesh:g,extras:y,children:b}=e,w={};if(w.matrix=s||bt.fromRotationTranslationScale([],c||[0,0,0,1],d||[0,0,0],f||[1,1,1]),void 0!==g){w.meshes=r[g];const P=w.anchor=[0,0];for(const O of w.meshes){const{min:I,max:A}=O.aabb;P[0]+=I[0]+A[0],P[1]+=I[1]+A[1]}P[0]=Math.floor(P[0]/w.meshes.length/2),P[1]=Math.floor(P[1]/w.meshes.length/2)}if(y&&(y.id&&(w.id=y.id),y.lights&&(w.lights=function(P){if(!P.length)return[];const O=function(p){const m=atob(p),v=new Uint8Array(m.length);for(let C=0;C<m.length;C++)v[C]=m.codePointAt(C);return v}(P),I=[],A=O.length/24,l=new Uint16Array(O.buffer),u=new Float32Array(O.buffer);for(let p=0;p<A;p++){const m=l[2*p*6]/30,v=l[2*p*6+1]/30,C=l[2*p*6+10]/100,E=u[6*p+1],T=u[6*p+2],k=u[6*p+3],N=u[6*p+4],F=k-E,$=N-T,q=Math.hypot(F,$);I.push({pos:[E+.5*F,T+.5*$,v],normal:[$/q,-F/q,0],width:q,height:m,depth:C,points:[E,T,k,N]})}return I}(y.lights))),b){const P=[];for(const O of b)P.push(S1(t.json.nodes[O],t,r));w.children=P}return w}function ZE(e){if(0===e.vertices.length||0===e.indices.length)return null;const[t,r]=[e.vertices[0].clone(),e.vertices[0].clone()];for(let f=1;f<e.vertices.length;++f){const g=e.vertices[f];t.x=Math.min(t.x,g.x),t.y=Math.min(t.y,g.y),r.x=Math.max(r.x,g.x),r.y=Math.max(r.y,g.y)}const s=Math.ceil(Math.max(r.x-t.x,r.y-t.y)/256),c=Math.max(8,s),d=new qE(e.vertices,e.indices,c);return{vertices:e.vertices,indices:e.indices,grid:d,min:t,max:r}}function YT(e){if(!e.extras||!e.extras.ground)return null;const t=e.extras.ground;if(!t||!Array.isArray(t)||0===t.length)return null;const r=t[0];if(!r||!Array.isArray(r)||0===r.length)return null;const s=[];for(const f of r){if(!Array.isArray(f)||2!==f.length)continue;const g=f[0],y=f[1];"number"==typeof g&&"number"==typeof y&&s.push(new tt(g,y))}if(s.length<3)return null;s.length>1&&s[s.length-1].equals(s[0])&&s.pop();let c=0;for(let f=0;f<s.length;f++){const g=s[f],y=s[(f+1)%s.length],b=s[(f+2)%s.length];c+=(g.x-y.x)*(b.y-y.y)-(b.x-y.x)*(g.y-y.y)}c>0&&s.reverse();const d=Pv(s.flatMap(f=>[f.x,f.y]),[]);return 0===d.length?null:{vertices:s,indices:d}}function WE(e){const t=[],r=[];let s=0;for(const c of e){s=t.length;const d=c.vertexArray.float32,f=c.indexArray.uint16;for(let g=0;g<c.vertexArray.length;g++)t.push(new tt(d[3*g+0],d[3*g+1]));for(let g=0;g<3*c.indexArray.length;g++)r.push(f[g]+s)}if(r.length%3!=0)return null;for(let c=0;c<r.length;c+=3){const d=t[r[c+0]],f=t[r[c+1]],g=t[r[c+2]];(d.x-f.x)*(g.y-f.y)-(g.x-f.x)*(d.y-f.y)>0&&([r[c+1],r[c+2]]=[r[c+2],r[c+1]])}return{vertices:t,indices:r}}function bm(e){const r=function(y,b){const w=[];for(const P of y.json.meshes){const O=[];for(const I of P.primitives)O.push(kb(I,y,b));w.push(O)}return w}(e,function(y,b){const w=[],P=lt.WebGL2RenderingContext;if(y.json.textures)for(const O of y.json.textures){const I={magFilter:P.LINEAR,minFilter:P.NEAREST,wrapS:P.REPEAT,wrapT:P.REPEAT};void 0!==O.sampler&&Object.assign(I,y.json.samplers[O.sampler]),w.push({image:b[O.source],sampler:I,uploaded:!1})}return w}(e,e.images)),{scenes:s,scene:c,nodes:d}=e.json,f=s?s[c||0].nodes:d,g=[];for(const y of f)g.push(S1(d[y],e,r));return function(y,b,w){const P={},O=new Set;for(let I=0;I<y.length;I++){const A=w[b[I]];if(!A.extras)continue;const l=A.extras["mapbox:footprint:version"],u=A.extras["mapbox:footprint:id"];(l||u)&&O.add(I),"1.0.0"===l&&u&&(P[u]=I)}for(let I=0;I<y.length;I++){if(O.has(I))continue;const A=y[I],l=w[b[I]];if(!l.extras)continue;let u=null;A.id in P&&(u=WE(y[P[A.id]].meshes)),u||(u=YT(l)),u&&(A.footprint=ZE(u))}if(O.size>0){const I=Array.from(O.values()).sort((A,l)=>A-l);for(let A=I.length-1;A>=0;A--)y.splice(I[A],1)}}(g,f,e.json.nodes),g}function GC(e){e.heightmap=new Float32Array(4096),e.heightmap.fill(-1);const t=e.vertexArray.float32,r=e.aabb.min[0]-1,s=e.aabb.min[1]-1,c=64/(e.aabb.max[0]-r+2),d=64/(e.aabb.max[1]-s+2);for(let f=0;f<t.length;f+=3){const g=t[f+2],y=(t[f+0]-r)*c|0,b=(t[f+1]-s)*d|0;g>e.heightmap[64*b+y]&&(e.heightmap[64*b+y]=g)}}function KE(e,t){const r={};r.indexArray=new Mo,r.indexArray.reserve(4*e.length),r.vertexArray=new Jy,r.vertexArray.reserve(10*e.length),r.colorArray=new Du,r.vertexArray.reserve(10*e.length);let s=0;for(const f of e){const g=Math.min(10,Math.max(4,1.3*f.height))*t,y=[-f.normal[1],f.normal[0],0],b=Math.min(.29,.1*f.width/f.depth),w=f.width-2*f.depth*t*(b+.01),P=dt.scaleAndAdd([],f.pos,y,w/2),O=dt.scaleAndAdd([],f.pos,y,-w/2),I=[P[0],P[1],P[2]+f.height],A=[O[0],O[1],O[2]+f.height],l=dt.scaleAndAdd([],f.normal,y,b);dt.scale(l,l,g);const u=dt.scaleAndAdd([],f.normal,y,-b);dt.scale(u,u,g),dt.add(l,P,l),dt.add(u,O,u),P[2]+=.1,O[2]+=.1,r.vertexArray.emplaceBack(l[0],l[1],l[2]),r.vertexArray.emplaceBack(u[0],u[1],u[2]),r.vertexArray.emplaceBack(P[0],P[1],P[2]),r.vertexArray.emplaceBack(O[0],O[1],O[2]),r.vertexArray.emplaceBack(I[0],I[1],I[2]),r.vertexArray.emplaceBack(A[0],A[1],A[2]),r.vertexArray.emplaceBack(P[0],P[1],P[2]),r.vertexArray.emplaceBack(O[0],O[1],O[2]),r.vertexArray.emplaceBack(l[0],l[1],l[2]),r.vertexArray.emplaceBack(u[0],u[1],u[2]);const p=w/g/2;r.colorArray.emplaceBack(-p-b,-1,p,.8),r.colorArray.emplaceBack(p+b,-1,p,.8),r.colorArray.emplaceBack(-p,0,p,1.3),r.colorArray.emplaceBack(p,0,p,1.3),r.colorArray.emplaceBack(p+b,-.8,p,.7),r.colorArray.emplaceBack(p+b,-.8,p,.7),r.colorArray.emplaceBack(0,0,p,1.3),r.colorArray.emplaceBack(0,0,p,1.3),r.colorArray.emplaceBack(p+b,-1.2,p,.8),r.colorArray.emplaceBack(p+b,-1.2,p,.8),r.indexArray.emplaceBack(6+s,4+s,8+s),r.indexArray.emplaceBack(7+s,9+s,5+s),r.indexArray.emplaceBack(0+s,1+s,2+s),r.indexArray.emplaceBack(1+s,3+s,2+s),s+=10}const c={defined:!0,emissiveFactor:[0,0,0]},d={};return d.baseColorFactor=bn.white,c.pbrMetallicRoughness=d,r.material=c,r.aabb=new _i([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),r}De(qE,"TriangleGridIndex");const Rb={vector:M1,raster:P1,"raster-dem":class extends P1{constructor(e,t,r,s){super(e,t,r,s),this.type="raster-dem",this.maxzoom=22,this._options=_t({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(e,t){const r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function s(c,d){c&&(e.state="errored",t(c)),d&&(e.dem=d,e.dem.onDeserialize(),e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0,e.state="loaded",t(null))}e.request=Bt(this.map._requestManager.transformRequest(r,Ft.Tile),function(c,d,f,g){if(delete e.request,e.aborted)e.state="unloaded",t(null);else if(c)e.state="errored",t(c);else if(d){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:f,expires:g});const b=lt.ImageBitmap&&d instanceof lt.ImageBitmap&&hd(),w=1-(d.width-((y=d.width)<=1?1:Math.pow(2,Math.floor(Math.log(y)/Math.LN2))))/2;w<1||e.neighboringTiles||(e.neighboringTiles=this._getNeighboringTiles(e.tileID));const P=b?d:Mn.getImageData(d,w),O={uid:e.uid,coord:e.tileID,source:this.id,scope:this.scope,rawImageData:P,encoding:this.encoding,padding:w};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",O,s.bind(this),void 0,!0))}var y}.bind(this))}_getNeighboringTiles(e){const t=e.canonical,r=Math.pow(2,t.z),s=(t.x-1+r)%r,c=0===t.x?e.wrap-1:e.wrap,d=(t.x+1+r)%r,f=t.x+1===r?e.wrap+1:e.wrap,g={};return g[new Ir(e.overscaledZ,c,t.z,s,t.y).key]={backfilled:!1},g[new Ir(e.overscaledZ,f,t.z,d,t.y).key]={backfilled:!1},t.y>0&&(g[new Ir(e.overscaledZ,c,t.z,s,t.y-1).key]={backfilled:!1},g[new Ir(e.overscaledZ,e.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},g[new Ir(e.overscaledZ,f,t.z,d,t.y-1).key]={backfilled:!1}),t.y+1<r&&(g[new Ir(e.overscaledZ,c,t.z,s,t.y+1).key]={backfilled:!1},g[new Ir(e.overscaledZ,e.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},g[new Ir(e.overscaledZ,f,t.z,d,t.y+1).key]={backfilled:!1}),g}},geojson:class extends ki{constructor(e,t,r,s){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(s),this._data=t.data,this._options=_t({},t),this._collectResourceTiming=t.collectResourceTiming,void 0!==t.maxzoom&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const c=Dt/this.tileSize;this.workerOptions=_t({source:this.id,scope:this.scope,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(void 0!==t.buffer?t.buffer:128)*c,tolerance:(void 0!==t.tolerance?t.tolerance:.375)*c,extent:Dt,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:void 0!==t.clusterMaxZoom?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:Dt,radius:(void 0!==t.clusterRadius?t.clusterRadius:50)*c,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(e){this.map=e,this.setData(this._data)}setData(e){return this._data=e,this._updateWorkerData(),this}getClusterExpansionZoom(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id,scope:this.scope},t),this}getClusterChildren(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id,scope:this.scope},t),this}getClusterLeaves(e,t,r,s){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:e,limit:t,offset:r},s),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new de("dataloading",{dataType:"source"})),this._loaded=!1;const e=_t({},this.workerOptions);e.scope=this.scope;const t=this._data;"string"==typeof t?(e.request=this.map._requestManager.transformRequest(Mn.resolveURL(t),Ft.Source),e.request.collectResourceTiming=this._collectResourceTiming):e.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,e,(r,s)=>{if(this._loaded=!0,this._pendingLoad=null,r)this.fire(new Cn(r));else{const c={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&s&&s.resourceTiming&&s.resourceTiming[this.id]&&(c.resourceTiming=s.resourceTiming[this.id]),this.fire(new de("data",c)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(e,t){const r=e.actor?"reloadTile":"loadTile";e.actor=this.actor;const s={type:this.type,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:Mn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};e.request=this.actor.send(r,s,(c,d)=>(delete e.request,e.destroy(),e.aborted?t(null):c?t(c):(e.loadVectorData(d,this.map.painter,"reloadTile"===r),t(null))),void 0,"loadTile"===r)}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}unloadTile(e){this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope}),e.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return _t({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Qc{constructor(e,t,r,s){super(e,t,r,s),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,Ft.Source).url);!function(t,r){const s=lt.document.createElement("video");s.muted=!0,s.onloadstart=function(){r(null,s)};for(let c=0;c<t.length;c++){const d=lt.document.createElement("source");xe(t[c])||(s.crossOrigin="Anonymous"),d.src=t[c],s.appendChild(d)}}(this.urls,(t,r)=>{this._loaded=!0,t?this.fire(new Cn(t)):r&&(this.video=r,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const t=this.video.seekable;e<t.start(0)||e>t.end(0)?this.fire(new Cn(new Fe(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,t=e.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new bi(e,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(e)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Qc,model:class extends ki{constructor(e,t,r,s){super(),this.id=e,this.type="model",this.models=[],this._loaded=!1,this._options=t}load(){const e=[];for(const t in this._options.models){const r=this._options.models[t],s=HE(this.map._requestManager.transformRequest(r.uri,Ft.Model).url).then(c=>{if(!c)return;const d=bm(c),f=new fl(t,r.position,r.orientation,d);f.computeBoundsAndApplyParent(),this.models.push(f)}).catch(c=>{this.fire(new Cn(new Error(`Could not load model ${t} from ${r.uri}: ${c.message}`)))});e.push(s)}return Promise.allSettled(e).then(()=>{this._loaded=!0,this.fire(new de("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(t=>{this.fire(new Cn(new Error(`Could not load models: ${t.message}`)))})}onAdd(e){this.map=e,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(e,t){}serialize(){return{type:"model"}}},"batched-model":class extends ki{constructor(e,t,r,s){super(),this.type="batched-model",this.id=e,this.tileSize=512,this._options=t,this.tiles=this._options.tiles,this.maxzoom=t.maxzoom||19,this.minzoom=t.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=r,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(s)}onAdd(e){this.map=e,this.load()}load(e){this._loaded=!1,this.fire(new de("dataloading",{dataType:"source"}));const t=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map._worldview;this._tileJSONRequest=x1(this._options,this.map._requestManager,t,r,(s,c)=>{this._tileJSONRequest=null,this._loaded=!0,s?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${t}`),r&&2!==r.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${r}`),this.fire(new Cn(s))):c&&(_t(this,c),c.bounds&&(this.tileBounds=new _y(c.bounds,this.minzoom,this.maxzoom)),Re(c.tiles,this.map._requestManager._customAccessToken),this.fire(new de("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new de("data",{dataType:"source",sourceDataType:"content"}))),e&&e(s)})}hasTransition(){return!1}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loaded(){return this._loaded}loadTile(e,t){const r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),s={request:this.map._requestManager.transformRequest(r,Ft.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:e.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(e.actor&&"expired"!==e.state)if("loading"===e.state)e.reloadCallback=t;else{if(e.buckets){const d=Object.values(e.buckets);for(const f of d)f.dirty=!0;return void(e.state="loaded")}e.request=e.actor.send("reloadTile",s,c.bind(this))}else e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",s,c.bind(this),void 0,!0);function c(d,f){return e.aborted?t(null):d&&404!==d.status?t(d):(f&&(f.resourceTiming&&(e.resourceTiming=f.resourceTiming),this.map._refreshExpiredTiles&&e.setExpiryData(f),e.buckets={...e.buckets,...f.buckets}),e.state="loaded",void t(null))}}serialize(){return _t({},this._options)}},canvas:class extends Qc{constructor(e,t,r,s){super(e,t,r,s),t.coordinates?Array.isArray(t.coordinates)&&4===t.coordinates.length&&!t.coordinates.some(c=>!Array.isArray(c)||2!==c.length||c.some(d=>"number"!=typeof d))||this.fire(new Cn(new Fe(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new Cn(new Fe(`sources.${e}`,null,'missing required property "coordinates"'))),t.animate&&"boolean"!=typeof t.animate&&this.fire(new Cn(new Fe(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),t.canvas?"string"==typeof t.canvas||t.canvas instanceof lt.HTMLCanvasElement||this.fire(new Cn(new Fe(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new Cn(new Fe(`sources.${e}`,null,'missing required property "canvas"'))),this.options=t,this.animate=void 0===t.animate||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof lt.HTMLCanvasElement?this.options.canvas:lt.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new Cn(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const t=this.map.painter.context;this.texture?!e&&!this._playing||this.texture instanceof pc||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new bi(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}},custom:class extends ki{constructor(e,t,r,s){super(),this.id=e,this.type="custom",this._dataType="raster",this._dispatcher=r,this._implementation=t,this.setEventedParent(s),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new Cn(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new Cn(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new _y(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.clearTiles=this._clearTiles.bind(this),t.coveringTiles=this._coveringTiles.bind(this),_t(this,he(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return he(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new de("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new de("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(e){this._map=e,this._loaded=!1,this.fire(new de("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(e),this.load()}onRemove(e){this._implementation.onRemove&&this._implementation.onRemove(e)}hasTile(e){if(this._implementation.hasTile){const{x:t,y:r,z:s}=e.canonical;return this._implementation.hasTile({x:t,y:r,z:s})}return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e,t){const{x:r,y:s,z:c}=e.tileID.canonical,d=new lt.AbortController;e.request=Promise.resolve(this._implementation.loadTile({x:r,y:s,z:c},{signal:d.signal})).then(function(f){return delete e.request,e.aborted?(e.state="unloaded",t(null)):void 0===f?(e.state="errored",t(null)):null===f?(this.loadTileData(e,{width:this.tileSize,height:this.tileSize,data:null}),e.state="loaded",t(null)):(g=f)instanceof lt.ImageData||g instanceof lt.HTMLCanvasElement||g instanceof lt.ImageBitmap||g instanceof lt.HTMLImageElement?(this.loadTileData(e,f),e.state="loaded",void t(null)):(e.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var g}.bind(this)).catch(f=>{20!==f.code&&(e.state="errored",t(f))}),e.request.cancel=()=>d.abort()}loadTileData(e,t){e.setTexture(t,this._map.painter)}unloadTile(e,t){if(e.texture&&e.texture instanceof bi?(e.destroy(!0),e.texture&&e.texture instanceof bi&&this._map.painter.saveTileTexture(e.texture)):e.destroy(),this._implementation.unloadTile){const{x:r,y:s,z:c}=e.tileID.canonical;this._implementation.unloadTile({x:r,y:s,z:c})}t()}abortTile(e,t){e.request&&e.request.cancel&&(e.request.cancel(),delete e.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(e=>({x:e.canonical.x,y:e.canonical.y,z:e.canonical.z}))}_clearTiles(){const e=sn(this.id,this.scope);this._map.style.clearSource(e)}_update(){this.fire(new de("data",{dataType:"source",sourceDataType:"content"}))}}},xm=function(e,t,r,s){const c=new Rb[t.type](e,t,r,s);if(c.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${c.id}`);return Tn(["load","abort","unload","serialize","prepare"],c),c};function YE(e,t){const r=bt.identity([]);return bt.scale(r,r,[.5*e.width,.5*-e.height,1]),bt.translate(r,r,[1,-1,0]),bt.multiply(r,r,e.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(r)}function HC(e,t,r,s,c,d,f,g=!1){const y=e.tilesIn(s,f,g);y.sort(wm);const b=[];for(const P of y)b.push({wrappedTileID:P.tile.tileID.wrapped().key,queryResults:P.tile.queryRenderedFeatures(t,r,e._state,P,c,d,YE(e.transform,P.tile.tileID),g)});const w=function(P){const O={},I={};for(const A of P){const l=A.queryResults,u=A.wrappedTileID,p=I[u]=I[u]||{};for(const m in l){const v=l[m],C=p[m]=p[m]||{},E=O[m]=O[m]||[];for(const T of v)C[T.featureIndex]||(C[T.featureIndex]=!0,E.push(T))}}return O}(b);for(const P in w)w[P].forEach(O=>{const I=O.feature,A=I.layer;A&&"background"!==A.type&&"sky"!==A.type&&"slot"!==A.type&&(I.source=A.source,A["source-layer"]&&(I.sourceLayer=A["source-layer"]),I.state=void 0!==I.id?e.getFeatureState(A["source-layer"],I.id):{})});return w}function XE(e,t){const r=e.getRenderableIds().map(d=>e.getTileByID(d)),s=[],c={};for(let d=0;d<r.length;d++){const f=r[d],g=f.tileID.canonical.key;c[g]||(c[g]=!0,f.querySourceFeatures(s,t))}return s}function wm(e,t){const r=e.tileID,s=t.tileID;return r.overscaledZ-s.overscaledZ||r.canonical.y-s.canonical.y||r.wrap-s.wrap||r.canonical.x-s.canonical.x}class XT{constructor(t){this.style=t}processLayersChanged(){this.layers=[];for(const t in this.style._mergedLayers){const r=this.style._mergedLayers[t];if("fill-extrusion"===r.type)this.layers.push(r);else if("model"===r.type){const s=this.style.getLayerSource(r);s&&"batched-model"===s.type&&this.layers.push(r)}}}updateZOffset(t,r){this.currentBuildingBuckets=[];for(let c=0;c<this.layers.length;++c){const d=this.layers[c],f=this.style.getLayerSourceCache(d);let g=1;"fill-extrusion"===d.type&&(g=d.paint.get("fill-extrusion-opacity")>0?d.paint.get("fill-extrusion-vertical-scale"):0);let y=f?f.getTile(r):null;if(!y&&f&&r.canonical.z>f.getSource().minzoom){let b=r.scaledTo(Math.min(f.getSource().maxzoom,r.overscaledZ-1));for(;b.overscaledZ>=f.getSource().minzoom&&(y=f.getTile(b),!y&&0!==b.overscaledZ);)b=b.scaledTo(b.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:y?y.getBucket(d):null,tileID:y?y.tileID:r,verticalScale:g})}t.hasAnyZOffset=!1;let s=!1;for(let c=0;c<t.symbolInstances.length;c++){const d=t.symbolInstances.get(c),f=d.zOffset,g=this._getHeightAtTileOffset(r,d.tileAnchorX,d.tileAnchorY);d.zOffset=-1!==g?g:f,s||f===d.zOffset||(s=!0),t.hasAnyZOffset||0===d.zOffset||(t.hasAnyZOffset=!0)}s&&(t.zOffsetBuffersNeedUpload=!0,t.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(t,r,s,c){let d=r,f=s;if(t.canonical.z!==c.canonical.z){const g=c.canonical,y=1/(1<<t.canonical.z-g.z);d=(r+t.canonical.x*Dt)*y-g.x*Dt|0,f=(s+t.canonical.y*Dt)*y-g.y*Dt|0}return{tileX:d,tileY:f}}_getHeightAtTileOffset(t,r,s){let c;for(let d=0;d<this.layers.length;++d){if("fill-extrusion"!==this.layers[d].type)continue;const{bucket:f,tileID:g,verticalScale:y}=this.currentBuildingBuckets[d];if(!f)continue;const{tileX:b,tileY:w}=this._mapCoordToOverlappingTile(t,r,s,g),P=f.getHeightAtTileCoord(b,w);if(P&&void 0!==P.height){if(!P.hidden)return P.height*y;c=P.height}}for(let d=0;d<this.layers.length;++d){if("model"!==this.layers[d].type)continue;const{bucket:f,tileID:g}=this.currentBuildingBuckets[d];if(!f)continue;const{tileX:y,tileY:b}=this._mapCoordToOverlappingTile(t,r,s,g),w=f.getHeightAtTileCoord(y,b);if(w&&!w.hidden)return void 0===w.height&&void 0!==c?Math.min(w.maxHeight,c)*w.verticalScale:(w.height||0)*w.verticalScale}return-1}}var A1=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function QE(e,t){const r={};for(const s in e)"ref"!==s&&(r[s]=e[s]);return A1.forEach(s=>{s in t&&(r[s]=t[s])}),r}function D1(e){e=e.slice();const t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=QE(e[r],t[e[r].ref]));return e}const Vr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",setImportUrl:"setImportUrl",setImportData:"setImportData",setImportConfig:"setImportConfig"};function Lb(e,t,r){r.push({command:Vr.addSource,args:[e,t[e]]})}function hh(e,t,r){t.push({command:Vr.removeSource,args:[e]}),r[e]=!0}function JE(e,t,r,s){hh(e,r,s),Lb(e,t,r)}function qC(e,t,r){let s;for(s in e[r])if(e[r].hasOwnProperty(s)&&"data"!==s&&!Xt(e[r][s],t[r][s]))return!1;for(s in t[r])if(t[r].hasOwnProperty(s)&&"data"!==s&&!Xt(e[r][s],t[r][s]))return!1;return!0}function Nb(e,t,r,s,c,d){let f;for(f in t=t||{},e=e||{})e.hasOwnProperty(f)&&(Xt(e[f],t[f])||r.push({command:d,args:[s,f,t[f],c]}));for(f in t)t.hasOwnProperty(f)&&!e.hasOwnProperty(f)&&(Xt(e[f],t[f])||r.push({command:d,args:[s,f,t[f],c]}))}function Cm(e){return e.id}function kl(e,t){return e[t.id]=t,e}class k1{constructor(t,r){this.reset(t,r)}reset(t,r){this.points=t||[],this._distances=[0];for(let s=1;s<this.points.length;s++)this._distances[s]=this._distances[s-1]+this.points[s].dist(this.points[s-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=Ne(t,0,1);let r=1,s=this._distances[r];const c=t*this.paddedLength+this.padding;for(;s<c&&r<this._distances.length;)s=this._distances[++r];const d=r-1,f=this._distances[d],g=s-f,y=g>0?(c-f)/g:0;return this.points[d].mult(1-y).add(this.points[r].mult(y))}}class tO{constructor(t,r,s){const c=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(t/s),this.yCellCount=Math.ceil(r/s);for(let f=0;f<this.xCellCount*this.yCellCount;f++)c.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=r,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,r,s,c,d){this._forEachCell(r,s,c,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(d)}insertCircle(t,r,s,c){this._forEachCell(r-c,s-c,r+c,s+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(r),this.circles.push(s),this.circles.push(c)}_insertBoxCell(t,r,s,c,d,f){this.boxCells[d].push(f)}_insertCircleCell(t,r,s,c,d,f){this.circleCells[d].push(f)}_query(t,r,s,c,d,f){if(s<0||t>this.width||c<0||r>this.height)return!d&&[];const g=[];if(t<=0&&r<=0&&this.width<=s&&this.height<=c){if(d)return!0;for(let y=0;y<this.boxKeys.length;y++)g.push({key:this.boxKeys[y],x1:this.bboxes[4*y],y1:this.bboxes[4*y+1],x2:this.bboxes[4*y+2],y2:this.bboxes[4*y+3]});for(let y=0;y<this.circleKeys.length;y++){const b=this.circles[3*y],w=this.circles[3*y+1],P=this.circles[3*y+2];g.push({key:this.circleKeys[y],x1:b-P,y1:w-P,x2:b+P,y2:w+P})}return f?g.filter(f):g}return this._forEachCell(t,r,s,c,this._queryCell,g,{hitTest:d,seenUids:{box:{},circle:{}}},f),d?g.length>0:g}_queryCircle(t,r,s,c,d){const f=t-s,g=t+s,y=r-s,b=r+s;if(g<0||f>this.width||b<0||y>this.height)return!c&&[];const w=[];return this._forEachCell(f,y,g,b,this._queryCellCircle,w,{hitTest:c,circle:{x:t,y:r,radius:s},seenUids:{box:{},circle:{}}},d),c?w.length>0:w}query(t,r,s,c,d){return this._query(t,r,s,c,!1,d)}hitTest(t,r,s,c,d){return this._query(t,r,s,c,!0,d)}hitTestCircle(t,r,s,c){return this._queryCircle(t,r,s,!0,c)}_queryCell(t,r,s,c,d,f,g,y){const b=g.seenUids,w=this.boxCells[d];if(null!==w){const O=this.bboxes;for(const I of w)if(!b.box[I]){b.box[I]=!0;const A=4*I;if(t<=O[A+2]&&r<=O[A+3]&&s>=O[A+0]&&c>=O[A+1]&&(!y||y(this.boxKeys[I]))){if(g.hitTest)return f.push(!0),!0;f.push({key:this.boxKeys[I],x1:O[A],y1:O[A+1],x2:O[A+2],y2:O[A+3]})}}}const P=this.circleCells[d];if(null!==P){const O=this.circles;for(const I of P)if(!b.circle[I]){b.circle[I]=!0;const A=3*I;if(this._circleAndRectCollide(O[A],O[A+1],O[A+2],t,r,s,c)&&(!y||y(this.circleKeys[I]))){if(g.hitTest)return f.push(!0),!0;{const l=O[A],u=O[A+1],p=O[A+2];f.push({key:this.circleKeys[I],x1:l-p,y1:u-p,x2:l+p,y2:u+p})}}}}}_queryCellCircle(t,r,s,c,d,f,g,y){const b=g.circle,w=g.seenUids,P=this.boxCells[d];if(null!==P){const I=this.bboxes;for(const A of P)if(!w.box[A]){w.box[A]=!0;const l=4*A;if(this._circleAndRectCollide(b.x,b.y,b.radius,I[l+0],I[l+1],I[l+2],I[l+3])&&(!y||y(this.boxKeys[A])))return f.push(!0),!0}}const O=this.circleCells[d];if(null!==O){const I=this.circles;for(const A of O)if(!w.circle[A]){w.circle[A]=!0;const l=3*A;if(this._circlesCollide(I[l],I[l+1],I[l+2],b.x,b.y,b.radius)&&(!y||y(this.circleKeys[A])))return f.push(!0),!0}}}_forEachCell(t,r,s,c,d,f,g,y){const b=this._convertToXCellCoord(t),w=this._convertToYCellCoord(r),P=this._convertToXCellCoord(s),O=this._convertToYCellCoord(c);for(let I=b;I<=P;I++)for(let A=w;A<=O;A++)if(d.call(this,t,r,s,c,this.xCellCount*A+I,f,g,y))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,r,s,c,d,f){const g=c-t,y=d-r,b=s+f;return b*b>g*g+y*y}_circleAndRectCollide(t,r,s,c,d,f,g){const y=(f-c)/2,b=Math.abs(t-(c+y));if(b>y+s)return!1;const w=(g-d)/2,P=Math.abs(r-(d+w));if(P>w+s)return!1;if(b<=y||P<=w)return!0;const O=b-y,I=P-w;return O*O+I*I<=s*s}}const vc=100;class eO{constructor(t,r,s=new tO(t.width+200,t.height+200,25),c=new tO(t.width+200,t.height+200,25)){this.transform=t,this.grid=s,this.ignoredGrid=c,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+vc,this.screenBottomBoundary=t.height+vc,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=r}placeCollisionBox(t,r,s,c,d,f,g,y){let b=s.projectedAnchorX,w=s.projectedAnchorY,P=s.projectedAnchorZ;const O=s.elevation,I=s.tileID,A=t.getProjection();if(O&&I){const[T,k,N]=A.upVector(I.canonical,s.tileAnchorX,s.tileAnchorY),F=A.upVectorScale(I.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;b+=T*O*F,w+=k*O*F,P+=N*O*F}const l=this.projectAndGetPerspectiveRatio(g,b,w,P,s.tileID,"globe"===A.name||!!O||this.transform.pitch>0,A),u=f*l.perspectiveRatio,p=(s.x1*r+c.x-s.padding)*u+l.point.x,m=(s.y1*r+c.y-s.padding)*u+l.point.y,v=(s.x2*r+c.x+s.padding)*u+l.point.x,C=(s.y2*r+c.y+s.padding)*u+l.point.y,E=l.perspectiveRatio<=.55||l.occluded;return!this.isInsideGrid(p,m,v,C)||!d&&this.grid.hitTest(p,m,v,C,y)||E?{box:[],offscreen:!1,occluded:l.occluded}:{box:[p,m,v,C],offscreen:this.isOffscreen(p,m,v,C),occluded:!1}}placeCollisionCircles(t,r,s,c,d,f,g,y,b,w,P,O,I,A,l){const u=[],p=this.transform.elevation,m=t.getProjection(),v=p?p.getAtTileOffsetFunc(l,this.transform.center.lat,this.transform.worldSize,m):null,C=new tt(s.tileAnchorX,s.tileAnchorY);let{x:E,y:T,z:k}=m.projectTilePoint(C.x,C.y,l.canonical);if(v){const[ot,rt,ct]=v(C);E+=ot,T+=rt,k+=ct}const N="globe"===m.name,F=this.projectAndGetPerspectiveRatio(g,E,T,k,l,N||!!p||this.transform.pitch>0,m),{perspectiveRatio:$}=F,q=(P?f/$:f*$)/is,Z=mc(E,T,k,y),X=F.signedDistanceFromCamera>0?ab(q,d,s.lineOffsetX*q,s.lineOffsetY*q,!1,Z,C,s,c,y,{},p&&!P?v:null,P&&!!p,m,l,P):null;let K=!1,J=!1,st=!0;if(X&&!F.occluded){const ot=.5*I*$+A,rt=new tt(-100,-100),ct=new tt(this.screenRightBoundary,this.screenBottomBoundary),yt=new k1,{first:Ot,last:Tt}=X,zt=Ot.path.length;let Nt=[];for(let ie=zt-1;ie>=1;ie--)Nt.push(Ot.path[ie]);for(let ie=1;ie<Tt.path.length;ie++)Nt.push(Tt.path[ie]);const $t=2.5*ot;b&&(Nt=Nt.map(([ie,Ee,Oe],Be)=>(v&&!N&&(Oe=v(Be<zt-1?Ot.tilePath[zt-1-Be]:Tt.tilePath[Be-zt+2])[2]),mc(ie,Ee,Oe,b))),Nt.some(ie=>ie[3]<=0)&&(Nt=[]));let Rt=[];if(Nt.length>0){let ie=1/0,Ee=-1/0,Oe=1/0,Be=-1/0;for(const je of Nt)ie=Math.min(ie,je[0]),Oe=Math.min(Oe,je[1]),Ee=Math.max(Ee,je[0]),Be=Math.max(Be,je[1]);Ee>=rt.x&&ie<=ct.x&&Be>=rt.y&&Oe<=ct.y&&(Rt=[Nt.map(je=>new tt(je[0],je[1]))],(ie<rt.x||Ee>ct.x||Oe<rt.y||Be>ct.y)&&(Rt=yf(Rt,rt.x,rt.y,ct.x,ct.y)))}for(const ie of Rt){yt.reset(ie,.25*ot);let Ee=0;Ee=yt.length<=.5*ot?1:Math.ceil(yt.paddedLength/$t)+1;for(let Oe=0;Oe<Ee;Oe++){const Be=Oe/Math.max(Ee-1,1),je=yt.lerp(Be),En=je.x+vc,Qe=je.y+vc;u.push(En,Qe,ot,0);const nr=En-ot,ln=Qe-ot,Ln=En+ot,On=Qe+ot;if(st=st&&this.isOffscreen(nr,ln,Ln,On),J=J||this.isInsideGrid(nr,ln,Ln,On),!r&&this.grid.hitTestCircle(En,Qe,ot,O)&&(K=!0,!w))return{circles:[],offscreen:!1,collisionDetected:K,occluded:!1}}}}return{circles:!w&&K||!J?[]:u,offscreen:st,collisionDetected:K,occluded:F.occluded}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const r=[];let s=1/0,c=1/0,d=-1/0,f=-1/0;for(const w of t){const P=new tt(w.x+vc,w.y+vc);s=Math.min(s,P.x),c=Math.min(c,P.y),d=Math.max(d,P.x),f=Math.max(f,P.y),r.push(P)}const g=this.grid.query(s,c,d,f).concat(this.ignoredGrid.query(s,c,d,f)),y={},b={};for(const w of g){const P=w.key;void 0===y[P.bucketInstanceId]&&(y[P.bucketInstanceId]={}),y[P.bucketInstanceId][P.featureIndex]||zw(r,[new tt(w.x1,w.y1),new tt(w.x2,w.y1),new tt(w.x2,w.y2),new tt(w.x1,w.y2)])&&(y[P.bucketInstanceId][P.featureIndex]=!0,void 0===b[P.bucketInstanceId]&&(b[P.bucketInstanceId]=[]),b[P.bucketInstanceId].push(P.featureIndex))}return b}insertCollisionBox(t,r,s,c,d){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:s,featureIndex:c,collisionGroupID:d},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,r,s,c,d){const f=r?this.ignoredGrid:this.grid,g={bucketInstanceId:s,featureIndex:c,collisionGroupID:d};for(let y=0;y<t.length;y+=4)f.insertCircle(g,t[y],t[y+1],t[y+2])}projectAndGetPerspectiveRatio(t,r,s,c,d,f,g){const y=[r,s,c,1];let b=!1;c||this.transform.pitch>0?(kr.transformMat4(y,y,t),this.fogState&&d&&"globe"!==g.name&&(b=function(O,I,A,l,u,p){const m=p.calculateFogTileMatrix(u),v=[I,A,l];return dt.transformMat4(v,v,m),rd(O,dt.length(v),p.pitch,p._fov)}(this.fogState,r,s,c,d.toUnwrapped(),this.transform)>.9)):UT(y,y,t);const w=y[3];return{point:new tt((y[0]/w+1)/2*this.transform.width+vc,(-y[1]/w+1)/2*this.transform.height+vc),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(g)/w*.5,1.5),signedDistanceFromCamera:w,occluded:f&&y[2]>w||b}}isOffscreen(t,r,s,c){return s<vc||t>=this.screenRightBoundary||c<vc||r>this.screenBottomBoundary}isInsideGrid(t,r,s,c){return s>=0&&t<this.gridRightBoundary&&c>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const t=bt.identity([]);return bt.translate(t,t,[-100,-100,0]),t}}function ZC(e,t,r){const s=t.createTileMatrix(e,e.worldSize,r.toUnwrapped());return bt.multiply(new Float32Array(16),e.projMatrix,s)}function WC(e,t,r){if(t.projection.name===r.projection.name)return e.projMatrix;const s=r.clone();return s.setProjection(t.projection),ZC(s,t.getProjection(),e)}function Fb(e,t,r){return t.name===r.projection.name?e.projMatrix:ZC(r,t,e)}class vy{constructor(t,r,s,c){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?r:-r))):c&&s?1:0,this.placed=s}isHidden(){return 0===this.opacity&&!this.placed}}class by{constructor(t,r,s,c,d,f=!1){this.text=new vy(t?t.text:null,r,s,d),this.icon=new vy(t?t.icon:null,r,c,d),this.clipped=f}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Mm{constructor(t,r,s,c=!1){this.text=t,this.icon=r,this.skipFade=s,this.clipped=c}}class KC{constructor(){this.invProjMatrix=bt.create(),this.viewportMatrix=bt.create(),this.circles=[]}}class YC{constructor(t,r,s,c,d){this.bucketInstanceId=t,this.featureIndex=r,this.sourceLayerIndex=s,this.bucketIndex=c,this.tileID=d}}class nO{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const r=++this.maxGroupID;this.collisionGroups[t]={ID:r,predicate:s=>s.collisionGroupID===r}}return this.collisionGroups[t]}}function R1(e,t,r,s,c){const{horizontalAlign:d,verticalAlign:f}=Bv(e),g=-(d-.5)*t,y=-(f-.5)*r,b=em(e,s);return new tt(g+b[0]*c,y+b[1]*c)}function L1(e,t,r,s,c){const d=new tt(e,t);return r&&d._rotate(s?c:-c),d}class rO{constructor(t,r,s,c,d,f){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new eO(this.transform,d),this.buildingIndex=f,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new nO(s),this.collisionCircleArrays={},this.prevPlacement=c,c&&(c.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,r,s,c){const d=s.getBucket(r),f=s.latestFeatureIndex;if(!d||!f||r.fqid!==d.layerIds[0])return;const g=d.layers[0].layout,y=s.collisionBoxArray,b=Math.pow(2,this.transform.zoom-s.tileID.overscaledZ),w=s.tileSize/Dt,P=s.tileID.toUnwrapped();this.transform.setProjection(d.projection);const O=(I=s.tileID,A=d.getProjection(),l=this.transform,A.name===this.projection?l.calculateProjMatrix(I.toUnwrapped()):ZC(l,A,I));var I,A,l;const u="map"===g.get("text-pitch-alignment"),p="map"===g.get("text-rotation-alignment");r.compileFilter();const m=r.dynamicFilter(),v=r.dynamicFilterNeedsFeature(),C=this.transform.calculatePixelsToTileUnitsMatrix(s),E=oy(O,s.tileID.canonical,u,p,this.transform,d.getProjection(),C);let T=null;if(u){const F=dm(O,s.tileID.canonical,u,p,this.transform,d.getProjection(),C);T=bt.multiply([],this.transform.labelPlaneMatrix,F)}let k=null;m&&s.latestFeatureIndex&&(k={unwrappedTileID:P,dynamicFilter:m,dynamicFilterNeedsFeature:v,featureIndex:s.latestFeatureIndex}),this.retainedQueryData[d.bucketInstanceId]=new YC(d.bucketInstanceId,f,d.sourceLayerIndex,d.index,s.tileID);const N={bucket:d,layout:g,posMatrix:O,textLabelPlaneMatrix:E,labelToScreenMatrix:T,clippingData:k,scale:b,textPixelRatio:w,holdingForFade:s.holdingForFade(),collisionBoxArray:y,partiallyEvaluatedTextSize:co(d.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:co(d.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(c)for(const F of d.sortKeyRanges){const{sortKey:$,symbolInstanceStart:q,symbolInstanceEnd:Z}=F;t.push({sortKey:$,symbolInstanceStart:q,symbolInstanceEnd:Z,parameters:N})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:N})}attemptAnchorPlacement(t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p,m){const{textOffset0:v,textOffset1:C,crossTileID:E}=O,T=[v,C],k=R1(t,s,c,T,d),N=this.collisionIndex.placeCollisionBox(A,d,r,L1(k.x,k.y,f,g,this.transform.angle),P,y,b,w.predicate);if(u){const F=A.getSymbolInstanceIconSize(m,this.transform.zoom,O.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(A,F,u,L1(k.x,k.y,f,g,this.transform.angle),P,y,b,w.predicate).box.length)return}if(N.box.length>0){let F;return this.prevPlacement&&this.prevPlacement.variableOffsets[E]&&this.prevPlacement.placements[E]&&this.prevPlacement.placements[E].text&&(F=this.prevPlacement.variableOffsets[E].anchor),this.variableOffsets[E]={textOffset:T,width:s,height:c,anchor:t,textScale:d,prevAnchor:F},this.markUsedJustification(A,t,O,l),A.allowVerticalPlacement&&(this.markUsedOrientation(A,l,O),this.placedOrientations[E]=l),{shift:k,placedGlyphBoxes:N}}}placeLayerBucketPart(t,r,s,c){const{bucket:d,layout:f,posMatrix:g,textLabelPlaneMatrix:y,labelToScreenMatrix:b,clippingData:w,textPixelRatio:P,holdingForFade:O,collisionBoxArray:I,partiallyEvaluatedTextSize:A,partiallyEvaluatedIconSize:l,collisionGroup:u}=t.parameters,p=f.get("text-optional"),m=f.get("icon-optional"),v=f.get("text-allow-overlap"),C=f.get("icon-allow-overlap"),E="map"===f.get("text-rotation-alignment"),T="map"===f.get("text-pitch-alignment"),k="viewport-y"===f.get("symbol-z-order"),N=f.get("symbol-z-elevate");this.transform.setProjection(d.projection);let F=v&&(C||!d.hasIconData()||m),$=C&&(v||!d.hasTextData()||p);!d.collisionArrays&&I&&d.deserializeCollisionBoxes(I),s&&c&&d.updateCollisionDebugBuffers(this.transform.zoom,I);const q=(Z,X,K)=>{const{crossTileID:J,numVerticalGlyphVertices:st}=Z;if(w){const Ln={zoom:this.transform.zoom,pitch:this.transform.pitch};let On=null;if(w.dynamicFilterNeedsFeature){const mn=this.retainedQueryData[d.bucketInstanceId];On=w.featureIndex.loadFeature({featureIndex:Z.featureIndex,bucketIndex:mn.bucketIndex,sourceLayerIndex:mn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,w.dynamicFilter)(Ln,On,this.retainedQueryData[d.bucketInstanceId].tileID.canonical,new tt(Z.tileAnchorX,Z.tileAnchorY),this.transform.calculateDistanceTileData(w.unwrappedTileID)))return this.placements[J]=new Mm(!1,!1,!1,!0),void r.add(J)}if(r.has(J))return;if(O)return void(this.placements[J]=new Mm(!1,!1,!1));let ot=!1,rt=!1,ct=!0,yt=!1,Ot=!1,Tt=null,zt={box:null,offscreen:null,occluded:null},Nt={box:null,offscreen:null,occluded:null},$t=null,Rt=null,ie=null,Ee=0,Oe=0,Be=0;K.textFeatureIndex?Ee=K.textFeatureIndex:Z.useRuntimeCollisionCircles&&(Ee=Z.featureIndex),K.verticalTextFeatureIndex&&(Oe=K.verticalTextFeatureIndex);const je=Ln=>{Ln.tileID=this.retainedQueryData[d.bucketInstanceId].tileID;const On=this.transform.elevation;Ln.elevation=Z.zOffset+(On?On.getAtTileOffset(Ln.tileID,Ln.tileAnchorX,Ln.tileAnchorY):0)},En=K.textBox;if(En){je(En);const Ln=mn=>{let wr=si.horizontal;if(d.allowVerticalPlacement&&!mn&&this.prevPlacement){const Lr=this.prevPlacement.placedOrientations[J];Lr&&(this.placedOrientations[J]=Lr,wr=Lr,this.markUsedOrientation(d,wr,Z))}return wr},On=(mn,wr)=>{if(d.allowVerticalPlacement&&st>0&&K.verticalTextBox){for(const Lr of d.writingModes)if(Lr===si.vertical?(zt=wr(),Nt=zt):zt=mn(),zt&&zt.box&&zt.box.length)break}else zt=mn()};if(f.get("text-variable-anchor")){let mn=f.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[J]){const rr=this.prevPlacement.variableOffsets[J];mn.indexOf(rr.anchor)>0&&(mn=mn.filter(Kr=>Kr!==rr.anchor),mn.unshift(rr.anchor))}const wr=(rr,Kr,Si)=>{const gi=d.getSymbolInstanceTextSize(A,Z,this.transform.zoom,X),Ni=(rr.x2-rr.x1)*gi+2*rr.padding,$o=(rr.y2-rr.y1)*gi+2*rr.padding,Io=Z.hasIconTextFit&&!C?Kr:null;Io&&je(Io);let Gi={box:[],offscreen:!1,occluded:!1};const Gr=v?2*mn.length:mn.length;for(let So=0;So<Gr;++So){const zf=this.attemptAnchorPlacement(mn[So%mn.length],rr,Ni,$o,gi,E,T,P,g,u,So>=mn.length,Z,X,d,Si,Io,A,l);if(zf&&(Gi=zf.placedGlyphBoxes,Gi&&Gi.box&&Gi.box.length)){ot=!0,Tt=zf.shift;break}}return Gi};On(()=>wr(En,K.iconBox,si.horizontal),()=>{const rr=K.verticalTextBox;return rr&&je(rr),d.allowVerticalPlacement&&!(zt&&zt.box&&zt.box.length)&&st>0&&rr?wr(rr,K.verticalIconBox,si.vertical):{box:null,offscreen:null,occluded:null}}),zt&&(ot=zt.box,ct=zt.offscreen,yt=zt.occluded);const Lr=Ln(!(!zt||!zt.box));if(!ot&&this.prevPlacement){const rr=this.prevPlacement.variableOffsets[J];rr&&(this.variableOffsets[J]=rr,this.markUsedJustification(d,rr.anchor,Z,Lr))}}else{const mn=(wr,Lr)=>{const rr=d.getSymbolInstanceTextSize(A,Z,this.transform.zoom,X),Kr=this.collisionIndex.placeCollisionBox(d,rr,wr,new tt(0,0),v,P,g,u.predicate);return Kr&&Kr.box&&Kr.box.length&&(this.markUsedOrientation(d,Lr,Z),this.placedOrientations[J]=Lr),Kr};On(()=>mn(En,si.horizontal),()=>{const wr=K.verticalTextBox;return d.allowVerticalPlacement&&st>0&&wr?(je(wr),mn(wr,si.vertical)):{box:null,offscreen:null,occluded:null}}),Ln(!!(zt&&zt.box&&zt.box.length))}}if($t=zt,ot=$t&&$t.box&&$t.box.length>0,ct=$t&&$t.offscreen,yt=$t&&$t.occluded,Z.useRuntimeCollisionCircles){const Ln=d.text.placedSymbolArray.get(Z.centerJustifiedTextSymbolIndex>=0?Z.centerJustifiedTextSymbolIndex:Z.verticalPlacedTextSymbolIndex),On=Wg(d.textSizeData,A,Ln),mn=f.get("text-padding");Rt=this.collisionIndex.placeCollisionCircles(d,v,Ln,d.lineVertexArray,d.glyphOffsetArray,On,g,y,b,s,T,u.predicate,Z.collisionCircleDiameter*On/is,mn,this.retainedQueryData[d.bucketInstanceId].tileID),ot=v||Rt.circles.length>0&&!Rt.collisionDetected,ct=ct&&Rt.offscreen,yt=Rt.occluded}if(K.iconFeatureIndex&&(Be=K.iconFeatureIndex),K.iconBox){const Ln=On=>{je(On);const mn=Z.hasIconTextFit&&Tt?L1(Tt.x,Tt.y,E,T,this.transform.angle):new tt(0,0),wr=d.getSymbolInstanceIconSize(l,this.transform.zoom,Z.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(d,wr,On,mn,C,P,g,u.predicate)};Nt&&Nt.box&&Nt.box.length&&K.verticalIconBox?(ie=Ln(K.verticalIconBox),rt=ie.box.length>0):(ie=Ln(K.iconBox),rt=ie.box.length>0),ct=ct&&ie.offscreen,Ot=ie.occluded}const Qe=p||0===Z.numHorizontalGlyphVertices&&0===st,nr=m||0===Z.numIconVertices;if(Qe||nr?nr?Qe||(rt=rt&&ot):ot=rt&&ot:rt=ot=rt&&ot,ot&&$t&&$t.box&&this.collisionIndex.insertCollisionBox($t.box,f.get("text-ignore-placement"),d.bucketInstanceId,Nt&&Nt.box&&Oe?Oe:Ee,u.ID),rt&&ie&&this.collisionIndex.insertCollisionBox(ie.box,f.get("icon-ignore-placement"),d.bucketInstanceId,Be,u.ID),Rt&&(ot&&this.collisionIndex.insertCollisionCircles(Rt.circles,f.get("text-ignore-placement"),d.bucketInstanceId,Ee,u.ID),s)){const Ln=d.bucketInstanceId;let On=this.collisionCircleArrays[Ln];void 0===On&&(On=this.collisionCircleArrays[Ln]=new KC);for(let mn=0;mn<Rt.circles.length;mn+=4)On.circles.push(Rt.circles[mn+0]),On.circles.push(Rt.circles[mn+1]),On.circles.push(Rt.circles[mn+2]),On.circles.push(Rt.collisionDetected?1:0)}const ln="globe"!==d.projection.name;F=F&&(ln||!yt),$=$&&(ln||!Ot),this.placements[J]=new Mm(ot||F,rt||$,ct||d.justReloaded),r.add(J)};if(N&&this.buildingIndex&&(this.buildingIndex.updateZOffset(d,this.retainedQueryData[d.bucketInstanceId].tileID),d.updateZOffset()),k){const Z=d.getSortedSymbolIndexes(this.transform.angle);for(let X=Z.length-1;X>=0;--X){const K=Z[X];q(d.symbolInstances.get(K),K,d.collisionArrays[K])}d.hasAnyZOffset&&gt(`${d.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(d.hasAnyZOffset){const Z=d.getSortedIndexesByZOffset();for(let X=0;X<Z.length;++X){const K=Z[X];q(d.symbolInstances.get(K),K,d.collisionArrays[K])}}else for(let Z=t.symbolInstanceStart;Z<t.symbolInstanceEnd;Z++)q(d.symbolInstances.get(Z),Z,d.collisionArrays[Z]);if(s&&d.bucketInstanceId in this.collisionCircleArrays){const Z=this.collisionCircleArrays[d.bucketInstanceId];bt.invert(Z.invProjMatrix,g),Z.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}markUsedJustification(t,r,s,c){const{leftJustifiedTextSymbolIndex:d,centerJustifiedTextSymbolIndex:f,rightJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:y,crossTileID:b}=s,w=eC(r),P=c===si.vertical?y:"left"===w?d:"center"===w?f:"right"===w?g:-1;d>=0&&(t.text.placedSymbolArray.get(d).crossTileID=P>=0&&d!==P?0:b),f>=0&&(t.text.placedSymbolArray.get(f).crossTileID=P>=0&&f!==P?0:b),g>=0&&(t.text.placedSymbolArray.get(g).crossTileID=P>=0&&g!==P?0:b),y>=0&&(t.text.placedSymbolArray.get(y).crossTileID=P>=0&&y!==P?0:b)}markUsedOrientation(t,r,s){const c=r===si.horizontal||r===si.horizontalOnly?r:0,d=r===si.vertical?r:0,{leftJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:g,rightJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:b}=s,w=t.text.placedSymbolArray;f>=0&&(w.get(f).placedOrientation=c),g>=0&&(w.get(g).placedOrientation=c),y>=0&&(w.get(y).placedOrientation=c),b>=0&&(w.get(b).placedOrientation=d)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let s=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const c=r?r.symbolFadeChange(t):1,d=r?r.opacities:{},f=r?r.variableOffsets:{},g=r?r.placedOrientations:{};for(const y in this.placements){const b=this.placements[y],w=d[y];w?(this.opacities[y]=new by(w,c,b.text,b.icon,null,b.clipped),s=s||b.text!==w.text.placed||b.icon!==w.icon.placed):(this.opacities[y]=new by(null,c,b.text,b.icon,b.skipFade,b.clipped),s=s||b.text||b.icon)}for(const y in d){const b=d[y];if(!this.opacities[y]){const w=new by(b,c,!1,!1);w.isHidden()||(this.opacities[y]=w,s=s||b.text.placed||b.icon.placed)}}for(const y in f)this.variableOffsets[y]||!this.opacities[y]||this.opacities[y].isHidden()||(this.variableOffsets[y]=f[y]);for(const y in g)this.placedOrientations[y]||!this.opacities[y]||this.opacities[y].isHidden()||(this.placedOrientations[y]=g[y]);s?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:t)}updateLayerOpacities(t,r){const s=new Set;for(const c of r){const d=c.getBucket(t);d&&c.latestFeatureIndex&&t.fqid===d.layerIds[0]&&(this.updateBucketOpacities(d,s,c.collisionBoxArray),d.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(d,c.tileID),d.updateZOffset()))}}updateBucketOpacities(t,r,s){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const c=t.layers[0].layout,d=!!t.layers[0].dynamicFilter(),f=new by(null,0,!1,!1,!0),g=c.get("text-allow-overlap"),y=c.get("icon-allow-overlap"),b=c.get("text-variable-anchor"),w="map"===c.get("text-rotation-alignment"),P="map"===c.get("text-pitch-alignment"),O=new by(null,0,g&&(y||!t.hasIconData()||c.get("icon-optional")),y&&(g||!t.hasTextData()||c.get("text-optional")),!0);!t.collisionArrays&&s&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(s);const I=(l,u,p)=>{for(let m=0;m<u/4;m++)l.opacityVertexArray.emplaceBack(p)};let A=0;for(let l=0;l<t.symbolInstances.length;l++){const u=t.symbolInstances.get(l),{numHorizontalGlyphVertices:p,numVerticalGlyphVertices:m,crossTileID:v,numIconVertices:C}=u,E=r.has(v);let T=this.opacities[v];E?T=f:T||(T=O,this.opacities[v]=T),r.add(v);const k=p>0||m>0,N=C>0,F=this.placedOrientations[v],$=F===si.vertical,q=F===si.horizontal||F===si.horizontalOnly;if(!k&&!N||T.isHidden()||A++,k){const Z=sO(T.text);I(t.text,p,$?wy:Z),I(t.text,m,q?wy:Z);const X=T.text.isHidden(),{leftJustifiedTextSymbolIndex:K,centerJustifiedTextSymbolIndex:J,rightJustifiedTextSymbolIndex:st,verticalPlacedTextSymbolIndex:ot}=u,rt=t.text.placedSymbolArray,ct=X||$?1:0;K>=0&&(rt.get(K).hidden=ct),J>=0&&(rt.get(J).hidden=ct),st>=0&&(rt.get(st).hidden=ct),ot>=0&&(rt.get(ot).hidden=X||q?1:0);const yt=this.variableOffsets[v];yt&&this.markUsedJustification(t,yt.anchor,u,F);const Ot=this.placedOrientations[v];Ot&&(this.markUsedJustification(t,"left",u,Ot),this.markUsedOrientation(t,Ot,u))}if(N){const Z=sO(T.icon),{placedIconSymbolIndex:X,verticalPlacedIconSymbolIndex:K}=u,J=t.icon.placedSymbolArray,st=T.icon.isHidden()?1:0;X>=0&&(I(t.icon,C,$?wy:Z),J.get(X).hidden=st),K>=0&&(I(t.icon,u.numVerticalIconVertices,q?wy:Z),J.get(K).hidden=st)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Z=t.collisionArrays[l];if(Z){let X=new tt(0,0),K=!0;if(Z.textBox||Z.verticalTextBox){if(b){const st=this.variableOffsets[v];st?(X=R1(st.anchor,st.width,st.height,st.textOffset,st.textScale),w&&X._rotate(P?this.transform.angle:-this.transform.angle)):K=!1}d&&(K=!T.clipped),Z.textBox&&xy(t.textCollisionBox.collisionVertexArray,T.text.placed,!K||$,X.x,X.y),Z.verticalTextBox&&xy(t.textCollisionBox.collisionVertexArray,T.text.placed,!K||q,X.x,X.y)}const J=K&&!(q||!Z.verticalIconBox);Z.iconBox&&xy(t.iconCollisionBox.collisionVertexArray,T.icon.placed,J,u.hasIconTextFit?X.x:0,u.hasIconTextFit?X.y:0),Z.verticalIconBox&&xy(t.iconCollisionBox.collisionVertexArray,T.icon.placed,!J,u.hasIconTextFit?X.x:0,u.hasIconTextFit?X.y:0)}}}if(t.fullyClipped=0===A,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const l=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=l.invProjMatrix,t.placementViewportMatrix=l.viewportMatrix,t.collisionCircleArray=l.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,r){const s=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*s>t}setStale(){this.stale=!0}}function xy(e,t,r,s,c){e.emplaceBack(t?1:0,r?1:0,s||0,c||0),e.emplaceBack(t?1:0,r?1:0,s||0,c||0),e.emplaceBack(t?1:0,r?1:0,s||0,c||0),e.emplaceBack(t?1:0,r?1:0,s||0,c||0)}const N1=Math.pow(2,25),iO=Math.pow(2,24),F1=Math.pow(2,17),z1=Math.pow(2,16),XC=Math.pow(2,9),oO=Math.pow(2,8),zb=Math.pow(2,1);function sO(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,r=Math.floor(127*e.opacity);return r*N1+t*iO+r*F1+t*z1+r*XC+t*oO+r*zb+t}const wy=0;class QC{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,r,s,c,d){const f=this._bucketParts;for(;this._currentTileIndex<t.length;)if(r.getBucketParts(f,c,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,f.sort((g,y)=>g.sortKey-y.sortKey));this._currentPartIndex<f.length;){const g=f[this._currentPartIndex];if(r.placeLayerBucketPart(g,this._seenCrossTileIDs,s,0===g.symbolInstanceStart),this._currentPartIndex++,d())return!0}return!1}}class As{constructor(t,r,s,c,d,f,g,y,b){this.placement=new rO(t,d,f,g,y,b),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=s,this._showCollisionBoxes=c,this._done=!1}isDone(){return this._done}continuePlacement(t,r,s,c){const d=Mn.now(),f=()=>{const g=Mn.now()-d;return!this._forceFullPlacement&&g>2};for(;this._currentPlacementIndex>=0;){const g=r[t[this._currentPlacementIndex]],y=this.placement.collisionIndex.transform.zoom;if("symbol"===g.type&&(!g.minzoom||g.minzoom<=y)&&(!g.maxzoom||g.maxzoom>y)){const b=g,w=b.layout.get("symbol-z-elevate"),P=this._inProgressLayer=this._inProgressLayer||new QC(b),O=sn(g.source,g.scope);if(P.continuePlacement(w?c[O]:s[O],this.placement,this._showCollisionBoxes,g,f))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Qp=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Pm{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,s]=new Uint8Array(t,0,2);if(219!==r)throw new Error("Data does not appear to be in a KDBush format.");const c=s>>4;if(1!==c)throw new Error(`Got v${c} data when expected v1.`);const d=Qp[15&s];if(!d)throw new Error("Unrecognized array type.");const[f]=new Uint16Array(t,2,1),[g]=new Uint32Array(t,4,1);return new Pm(g,f,d,t)}constructor(t,r=64,s=Float64Array,c){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const d=Qp.indexOf(this.ArrayType),f=2*t*this.ArrayType.BYTES_PER_ELEMENT,g=t*this.IndexArrayType.BYTES_PER_ELEMENT,y=(8-g%8)%8;if(d<0)throw new Error(`Unexpected typed array class: ${s}.`);c&&c instanceof ArrayBuffer?(this.data=c,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+y,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+f+g+y),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+y,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+d]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=r,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return JC(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,s,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:f,nodeSize:g}=this,y=[0,d.length-1,0],b=[];for(;y.length;){const w=y.pop()||0,P=y.pop()||0,O=y.pop()||0;if(P-O<=g){for(let u=O;u<=P;u++){const p=f[2*u],m=f[2*u+1];p>=t&&p<=s&&m>=r&&m<=c&&b.push(d[u])}continue}const I=O+P>>1,A=f[2*I],l=f[2*I+1];A>=t&&A<=s&&l>=r&&l<=c&&b.push(d[I]),(0===w?t<=A:r<=l)&&(y.push(O),y.push(I-1),y.push(1-w)),(0===w?s>=A:c>=l)&&(y.push(I+1),y.push(P),y.push(1-w))}return b}within(t,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:c,coords:d,nodeSize:f}=this,g=[0,c.length-1,0],y=[],b=s*s;for(;g.length;){const w=g.pop()||0,P=g.pop()||0,O=g.pop()||0;if(P-O<=f){for(let u=O;u<=P;u++)Em(d[2*u],d[2*u+1],t,r)<=b&&y.push(c[u]);continue}const I=O+P>>1,A=d[2*I],l=d[2*I+1];Em(A,l,t,r)<=b&&y.push(c[I]),(0===w?t-s<=A:r-s<=l)&&(g.push(O),g.push(I-1),g.push(1-w)),(0===w?t+s>=A:r+s>=l)&&(g.push(I+1),g.push(P),g.push(1-w))}return y}}function JC(e,t,r,s,c,d){if(c-s<=r)return;const f=s+c>>1;QT(e,t,f,s,c,d),JC(e,t,r,s,f-1,1-d),JC(e,t,r,f+1,c,1-d)}function QT(e,t,r,s,c,d){for(;c>s;){if(c-s>600){const b=c-s+1,w=r-s+1,P=Math.log(b),O=.5*Math.exp(2*P/3),I=.5*Math.sqrt(P*O*(b-O)/b)*(w-b/2<0?-1:1);QT(e,t,r,Math.max(s,Math.floor(r-w*O/b+I)),Math.min(c,Math.floor(r+(b-w)*O/b+I)),d)}const f=t[2*r+d];let g=s,y=c;for(B1(e,t,s,r),t[2*c+d]>f&&B1(e,t,s,c);g<y;){for(B1(e,t,g,y),g++,y--;t[2*g+d]<f;)g++;for(;t[2*y+d]>f;)y--}t[2*s+d]===f?B1(e,t,s,y):(y++,B1(e,t,y,c)),y<=r&&(s=y+1),r<=y&&(c=y-1)}}function B1(e,t,r,s){U1(e,r,s),U1(t,2*r,2*s),U1(t,2*r+1,2*s+1)}function U1(e,t,r){const s=e[t];e[t]=e[r],e[r]=s}function Em(e,t,r,s){const c=e-r,d=t-s;return c*c+d*d}const V1=512/Dt/2;class aO{constructor(t,r,s){this.tileID=t,this.bucketInstanceId=s,this.index=new Pm(r.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const c=t.canonical.x*Dt,d=t.canonical.y*Dt;for(let f=0;f<r.length;f++){const{key:g,crossTileID:y,tileAnchorX:b,tileAnchorY:w}=r.get(f),P=Math.floor((c+b)*V1),O=Math.floor((d+w)*V1);this.index.add(P,O),this.keys.push(g),this.crossTileIDs.push(y)}this.index.finish()}findMatches(t,r,s){const c=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z),d=V1/Math.pow(2,r.canonical.z-this.tileID.canonical.z),f=r.canonical.x*Dt,g=r.canonical.y*Dt;for(let y=0;y<t.length;y++){const b=t.get(y);if(b.crossTileID)continue;const{key:w,tileAnchorX:P,tileAnchorY:O}=b,I=Math.floor((f+P)*d),A=Math.floor((g+O)*d),l=this.index.range(I-c,A-c,I+c,A+c);for(const u of l){const p=this.crossTileIDs[u];if(this.keys[u]===w&&!s.has(p)){s.add(p),b.crossTileID=p;break}}}}}class lO{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Cy{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const r=Math.round((t-this.lng)/360);if(0!==r)for(const s in this.indexes){const c=this.indexes[s],d={};for(const f in c){const g=c[f];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+r),d[g.tileID.key]=g}this.indexes[s]=d}this.lng=t}addBucket(t,r,s){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let d=0;d<r.symbolInstances.length;d++)r.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const c=this.usedCrossTileIDs[t.overscaledZ];for(const d in this.indexes){const f=this.indexes[d];if(Number(d)>t.overscaledZ)for(const g in f){const y=f[g];y.tileID.isChildOf(t)&&y.findMatches(r.symbolInstances,t,c)}else{const g=f[t.scaledTo(Number(d)).key];g&&g.findMatches(r.symbolInstances,t,c)}}for(let d=0;d<r.symbolInstances.length;d++){const f=r.symbolInstances.get(d);f.crossTileID||(f.crossTileID=s.generate(),c.add(f.crossTileID))}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new aO(t,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(t,r){for(const s of r.crossTileIDs)this.usedCrossTileIDs[t].delete(s)}removeStaleBuckets(t){let r=!1;for(const s in this.indexes){const c=this.indexes[s];for(const d in c)t[c[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(s,c[d]),delete c[d],r=!0)}return r}}class tM{constructor(){this.layerIndexes={},this.crossTileIDs=new lO,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,r,s,c){let d=this.layerIndexes[t.fqid];void 0===d&&(d=this.layerIndexes[t.fqid]=new Cy);let f=!1;const g={};"globe"!==c.name&&d.handleWrapJump(s);for(const y of r){const b=y.getBucket(t);b&&t.fqid===b.layerIds[0]&&(b.bucketInstanceId||(b.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(y.tileID,b,this.crossTileIDs)&&(f=!0),g[b.bucketInstanceId]=!0)}return d.removeStaleBuckets(g)&&(f=!0),f}pruneUnusedLayers(t){const r={};t.forEach(s=>{r[s]=!0});for(const s in this.layerIndexes)r[s]||delete this.layerIndexes[s]}}var My="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef RENDER_CUTOFF\nfloat cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w-0.0001;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}\n#endif",Bb="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Ub="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",eM="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Vb="highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {\n#ifdef FOG_DITHERING\nvec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);\n#else\nreturn color;\n#endif\n}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",nM="#ifdef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);vec4 _raTexLinearCoord(vec2 texCoord,vec2 texResolution,out vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return (texCoord.xxyy+vec2(1.5,0.5).xyxy)/texResolution.xxyy;}vec2 _raTexLinearMix(vec2 fxy,vec4 colorMix,float colorOffset,vec4 t00,vec4 t10,vec4 t01,vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image0,c.yz),texture(u_image0,c.xz),texture(u_image0,c.yw),texture(u_image0,c.xw)\n);}vec2 raTexture2D_image1_linear(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image1,c.yz),texture(u_image1,c.xz),texture(u_image1,c.yw),texture(u_image1,c.xw)\n);}vec2 raTexture2D_image0_nearest(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec4 t=texture(u_image0,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec4 t=texture(u_image1,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}\n#endif",Py="#ifdef RENDER_SHADOWS\nuniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}\n#endif//RENDER_SHADOWS",j1="#ifdef RENDER_SHADOWS\n#ifdef DEPTH_TEXTURE\nuniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;\n#else\nuniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;\n#endif\nuniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_1,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_0,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;\n#ifdef NATIVE\nhighp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));\n#else\nhighp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(\nshadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)\n);\n#endif\nvec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {\n#ifdef SHADOWS_SINGLE_CASCADE\nlight_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);\n#else\nlight_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));\n#endif\n}highp float calculate_shadow_bias(float NDotL) {\n#ifdef NORMAL_OFFSET\nreturn 0.5*u_shadow_bias.x;\n#else\nreturn 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));\n#endif\n}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}\n#endif";const Om=[];jb(My,Om);const Df={"_prelude_fog.vertex.glsl":eM,"_prelude_terrain.vertex.glsl":Ub,"_prelude_shadow.vertex.glsl":Py,"_prelude_fog.fragment.glsl":Vb,"_prelude_shadow.fragment.glsl":j1,"_prelude_lighting.glsl":"\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}\n#endif//LIGHTING_3D_MODE","_prelude_raster_array.glsl":nM},Ey={};Rr("",Ub),Rr(Vb,eM),Rr(j1,Py),Rr(nM,"");const JT=Rr("\nout vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#ifdef INDICATOR_CUTOUT\nuniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;\n#endif\nvec4 applyCutout(vec4 color) {\n#ifdef INDICATOR_CUTOUT\nfloat holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);\n#else\nreturn color;\n#endif\n}\n#ifdef DEBUG_WIREFRAME\n#define HANDLE_WIREFRAME_DEBUG \\\nglFragColor=vec4(0.7,0.0,0.0,0.7); \\\ngl_FragDepth=gl_FragCoord.z-0.0001;\n#else\n#define HANDLE_WIREFRAME_DEBUG\n#endif\n#ifdef RENDER_CUTOFF\nuniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;\n#endif","\n#define EXTENT 8192.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}\n#ifdef RENDER_CUTOFF\nuniform vec4 u_cutoff_params;out float v_cutoff_opacity;\n#endif\nconst vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}"),rM=My;var iM={background:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nin vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),backgroundPattern:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),circle:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\nglFragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}'),clippingMask:Rr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Rr('#include "_prelude_fog.fragment.glsl"\nuniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),heatmapTexture:Rr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(0.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}","in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Rr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",'#include "_prelude_terrain.vertex.glsl"\nin vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}'),collisionCircle:Rr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}","in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Rr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",'#include "_prelude_terrain.vertex.glsl"\nin vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;\n#endif\nout vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}'),fill:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutline:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutlinePattern:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in vec2 v_pos;in vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;out vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillPattern:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillExtrusion:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec4 v_color;in vec4 v_flat;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;\n#endif\nuniform lowp float u_opacity;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec2 v_ao;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nin vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nin highp vec3 v_normal;\n#endif\nuniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nin float v_flood_radius;in float v_has_floodlight;\n#endif\nuniform float u_emissive_strength;in float v_height;void main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nvec3 normal=normalize(v_normal);\n#endif\nfloat z;vec4 color=v_color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);\n#ifdef LIGHTING_3D_MODE\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#else\ncolor=mix(v_color,v_roof_color,z);\n#endif\n#endif\nfloat h=max(0.0,v_height);float ao_shade=1.0;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\ncolor.rgb*=mix(ao_shade,1.0,v_has_floodlight);\n#else\ncolor.rgb*=ao_shade;\n#endif\n#else\ncolor.rgb*=ao_shade;\n#endif\n#endif\n#ifdef LIGHTING_3D_MODE\nfloat flood_radiance=0.0;\n#ifdef FLOOD_LIGHT\nflood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef FLOOD_LIGHT\nfloat ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);\n#else\nfloat shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);\n#endif\n#else\ncolor.rgb=apply_lighting(color.rgb,normal);\n#ifdef FLOOD_LIGHT\ncolor.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);\n#endif\n#endif\ncolor.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));\n#endif\n#ifdef RENDER_CUTOFF\ncolor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_lighting.glsl"\n#ifdef RENDER_CUTOFF\ninvariant gl_Position;\n#endif\nuniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nuniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nout vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nout highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec2 v_ao;\n#endif\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nout float v_flood_radius;out float v_has_floodlight;\n#endif\nout float v_height;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define highp float flood_light_wall_radius\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize highp float flood_light_wall_radius\nbase*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);h=h-ele;v_height=h;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=pos;vec3 shd_pos1=pos;\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifndef LIGHTING_3D_MODE\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#endif\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\nfloat is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;\n#endif\nv_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);\n#else\nv_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),fillExtrusionDepth:Rr("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\nout highp float v_depth;void main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\nbase*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nvec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);\n#else\npos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}'),fillExtrusionPattern:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nin vec3 v_normal;\n#endif\nin vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nout vec2 v_pos;out vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nout vec3 v_normal;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_normal=normal;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}'),groundShadow:Rr('#include "_prelude_shadow.fragment.glsl"\nprecision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\nvoid main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);\n#ifdef RENDER_CUTOFF\nshadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,v_depth));\n#endif\n#ifdef FOG\nshadow=mix(shadow,vec3(1.0),v_fog_opacity);\n#endif\n#ifdef INDICATOR_CUTOUT\nshadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);\n#endif\nglFragColor=vec4(shadow,1.0);}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);\n#endif\n}'),fillExtrusionGroundEffect:Rr("uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;\n#ifdef SDF_SUBPASS\nin highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}\n#ifdef FOG\nin highp float v_fog;\n#endif\n#endif\nvoid main() {\n#ifdef CLEAR_SUBPASS\nvec4 color=vec4(1.0);\n#ifdef CLEAR_FROM_TEXTURE\ncolor=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));\n#endif\nglFragColor=color;\n#else\n#ifdef SDF_SUBPASS\nhighp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;\n#ifdef FOG\nfog=v_fog;\n#endif\n#ifdef RENDER_CUTOFF\nfog*=v_cutoff_opacity;\n#endif\nglFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));\n#else\nvec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);\n#ifdef OVERDRAW_INSPECTOR\ncolor=vec4(1.0);\n#endif\nglFragColor=color;HANDLE_WIREFRAME_DEBUG;\n#endif\n#endif\n}",'#include "_prelude_fog.vertex.glsl"\nin highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;\n#ifdef SDF_SUBPASS\nout highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;\n#ifdef FOG\nout highp float v_fog;\n#endif\n#endif\nuniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;\n#pragma mapbox: define highp float flood_light_ground_radius\nconst float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {\n#pragma mapbox: initialize highp float flood_light_ground_radius\nvec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;\n#ifdef FORCE_ABS_FL_GROUND_RADIUS\nfl_ground_radius=abs(flood_light_ground_radius);\n#endif\nfloat flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;\n#ifdef SDF_SUBPASS\nv_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);\n#ifdef FOG\nv_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);\n#endif\n#endif\nfloat hidden_by_landmark=0.0;\n#ifdef HAS_CENTROID\nhidden_by_landmark=a_hidden_by_landmark;\n#endif\nfloat isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),hillshadePrepare:Rr("precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\nglFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);\n#endif\n#ifdef FOG\nglFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),line:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;in vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nfloat luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\nif (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    \nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#define EXTRUDE_SCALE 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nin highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nin float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),linePattern:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting_ground(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;in float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),raster:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_raster_array.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;\n#ifndef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;\n#endif\n#ifdef RASTER_COLOR\nuniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;\n#endif\nvoid main() {vec4 color0,color1,color;vec2 value;\n#ifdef RASTER_COLOR\n#ifdef RASTER_ARRAY\n#ifdef RASTER_ARRAY_LINEAR\nvalue=mix(\nraTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#else\nvalue=mix(\nraTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#endif\nif (value.y > 0.0) value.x/=value.y;\n#else\ncolor=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);\n#endif\ncolor=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;\n#else\ncolor0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);\n#endif\ncolor.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef RENDER_CUTOFF\nglFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform vec4 u_tl_br;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#elif defined(PROJECTION_GLOBE_VIEW)\nin vec2 a_pos;\n#else\nin vec2 a_pos;in vec2 a_texture_pos;\n#endif\nout vec2 v_pos0;out vec2 v_pos1;out float v_depth;void main() {vec2 uv;\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);\n#endif\n#else\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec2 globe_tl=vec2(u_tl_br.x,u_tl_br.y);vec2 globe_br=vec2(u_tl_br.z,u_tl_br.w);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=1.0-((mercatorY-globe_br.y)/(globe_tl.y-globe_br.y));float mercatorX=mercatorXfromLng(latLng[1]);float uvX=(mercatorX-globe_br.x)/(globe_tl.x-globe_br.x);vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);uv=vec2(uvX,uvY);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\nfloat w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\nuv=a_texture_pos/8192.0;\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;\n#ifdef RENDER_CUTOFF\nv_depth=gl_Position.z;\n#endif\n}'),symbolIcon:Rr('#include "_prelude_lighting.glsl"\nuniform sampler2D u_texture;\n#ifdef ICON_TRANSITION\nuniform float u_icon_transition;\n#endif\nin float v_fade_opacity;in vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nin vec2 v_tex_b;\n#endif\nuniform mediump float u_icon_saturation;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nlowp float alpha=opacity*v_fade_opacity;vec4 out_color;\n#ifdef ICON_TRANSITION\nvec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;\n#else\nout_color=texture(u_texture,v_tex_a)*alpha;\n#endif\n#ifdef SATURATION\nvec3 luma=vec3(dot(out_color.rgb,vec3(0.2126,0.7152,0.0722)));out_color.rgb=mix(luma,out_color.rgb,u_icon_saturation);\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef ICON_TRANSITION\nin vec2 a_texb;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nout vec2 v_tex_b;\n#endif\nout float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nv_tex_a=a_tex/u_texsize;\n#ifdef ICON_TRANSITION\nv_tex_b=a_texb/u_texsize;\n#endif\nv_fade_opacity=out_fade_opacity;}'),symbolSDF:Rr('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\nuniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}'),symbolTextAndIcon:Rr('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nfloat out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}'),terrainRaster:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;\n#endif\nuniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;\n#ifdef LIGHTING_3D_MODE\nconst vec3 normal=vec3(0.0,0.0,1.0);\n#ifdef RENDER_SHADOWS\nfloat cutoffOpacity=1.0;\n#ifdef RENDER_CUTOFF\ncutoffOpacity=cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nvec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;\n#else\nfloat lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));\n#endif\n#else\nfloat lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;\n#endif\n#endif\n#else\ncolor=image_color;\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#endif\nvoid main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}'),terrainDepth:Rr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}'),skybox:Rr('#include "_prelude_fog.fragment.glsl"\nin lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Bb),skyboxGradient:Rr('#include "_prelude_fog.fragment.glsl"\nin highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Bb),skyboxCapture:Rr("\nin highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}","in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nraster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);\n#else\nraster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;\n#else\ncolor=apply_lighting_ground(color);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;\n#endif\nout vec2 v_pos0;void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);globe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}'),globeAtmosphere:Rr('#include "_prelude_fog.fragment.glsl"\nuniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {\n#ifdef ALPHA_PASS\nglFragColor=vec4(0,0,0,0);return;\n#else\n#ifdef NATIVE\nglFragColor=vec4(1,1,1,1);\n#else\nglFragColor=vec4(0,0,0,1);\n#endif\nreturn;\n#endif\n}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;\n#ifdef ALPHA_PASS\nfloat a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);\n#else\nvec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;\n#ifndef NATIVE\nc=dither(c,gl_FragCoord.xy+u_temporal_offset);\n#endif\nglFragColor=vec4(c*t,t);\n#endif\n}',"in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}"),model:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;\n#endif\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#ifdef HAS_ATTRIBUTE_a_pbr\nin lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;\n#endif\n#ifdef HAS_TEXTURE_u_baseColorTexture\nuniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;\n#endif\n#ifdef HAS_TEXTURE_u_metallicRoughnessTexture\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\n#ifdef HAS_TEXTURE_u_occlusionTexture\nuniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;\n#endif\n#ifdef HAS_TEXTURE_u_normalTexture\nuniform sampler2D u_normalTexture;\n#endif\n#ifdef HAS_TEXTURE_u_emissionTexture\nuniform sampler2D u_emissionTexture;\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nin highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}\n#endif\n#define saturate(_x) clamp(_x,0.,1.)\nvec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)\n{\n#ifdef LIGHTING_3D_MODE\nvec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));\n#endif\nreturn apply_lighting(albedo,transformed_normal,lighting_factor);\n#else\nvec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;\n#endif\n}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;\n#ifdef HAS_ATTRIBUTE_a_color_3f\nalbedo*=vec4(color_3f,1.0);\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#else\n#ifdef HAS_ATTRIBUTE_a_color_4f\nalbedo*=color_4f;\n#endif\n#endif\n#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)\nvec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}\n#ifdef UNPREMULT_TEXTURE_IN_SHADER\nif(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;\n#endif\ntexColor.rgb=sRGBToLinear(texColor.rgb);if(u_baseTextureIsAlpha) {if (texColor.w < 0.5) {discard;}albedo*=mix(vec4(texColor.rgb,texColor.a),vec4(texColor.a),float(u_baseTextureIsAlpha));} else {albedo*=texColor;}\n#endif\nreturn vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {\n#ifdef HAS_TEXTURE_u_normalTexture\nhighp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;\n#else\nreturn mat3(1.0);\n#endif\n}highp vec3 getNormal(){highp vec3 n;\n#ifdef HAS_ATTRIBUTE_a_normal_3f\nn=normalize(normal_3f);\n#else\nhighp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;\n#endif\n#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nvec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);\n#endif\nreturn n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;\n#ifdef HAS_ATTRIBUTE_a_pbr\nmat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;\n#endif\n#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) \nvec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;\n#endif\nconst float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)\n{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)\n{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)\n{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)\n{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)\n{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)\n{\n#ifdef LIGHTING_3D_MODE\nreturn mat.diffuseColor;\n#else\nreturn mat.diffuseColor/PI;\n#endif\n}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)\n{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)\n{vec3 env_light=vec3(0.65,0.65,0.65);\n#ifdef LIGHTING_3D_MODE\nfloat ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;\n#endif\nvec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)\n{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=NdotL;\n#endif\nvec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;\n#if !defined(LIGHTING_3D_MODE)\nconst vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);\n#endif\ncolor*=intensityFactor;return color;}void main() {\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nif (isOccluded()) {discard;}\n#endif\nvec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;\n#ifdef LIGHTING_3D_MODE\nlightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;\n#endif\nvec4 finalColor;\n#ifdef DIFFUSE_SHADED\nvec3 N=getNormal();vec3 diffuse=getDiffuseShadedColor(getBaseColor().rgb,N,lightDir,lightColor);\n#ifdef HAS_TEXTURE_u_occlusionTexture\nfloat ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;\n#endif\nfinalColor=vec4(diffuse,1.0)*u_opacity;\n#else\nMaterial mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;\n#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nao=(texture(u_occlusionTexture,uv_2f).x-1.0)*u_aoIntensity+1.0;color*=ao;\n#endif\nvec4 emissive=u_emissiveFactor;\n#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nemissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);\n#endif\ncolor+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;\n#ifdef HAS_ATTRIBUTE_a_pbr\nfloat resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));\n#ifdef HAS_ATTRIBUTE_a_color_4f\nfloat distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);\n#endif\n#endif\nvec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);\n#endif\n#ifdef FOG\nfinalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));\n#endif\n#ifdef RENDER_CUTOFF\nfinalColor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nfinalColor=applyCutout(finalColor);\n#endif\nglFragColor=finalColor;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec3 a_pos_3f;\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr\n#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength\nuniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_normal_matrix;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;\n#endif\nout vec4 v_position_height;out lowp vec4 v_color_mix;\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nout highp float v_depth;\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\nout lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;\n#endif\nvec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute-custom highp vec4 pbr\n#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength\nhighp mat4 normal_matrix;\n#ifdef INSTANCED_ARRAYS\nnormal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\nnormal_matrix=u_normal_matrix;\n#endif\nvec3 local_pos;mat3 rs;\n#ifdef MODEL_POSITION_ON_GPU\nvec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;\n#else\nlocal_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);\n#endif\nv_position_height.w=a_pos_3f.z;\n#ifdef HAS_ATTRIBUTE_a_pbr\nvec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(local_pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nfloat x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);\n#else\nnormal_3f=vec3(normal_matrix*vec4(normal_3f,0));\n#endif\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#ifdef HAS_ATTRIBUTE_a_color_4f\nv_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 shadow_pos=local_pos;\n#ifdef NORMAL_OFFSET\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nvec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();\n#else\nvec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();\n#endif\n#endif\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;\n#endif\n}'),modelDepth:Rr("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}","in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;\n#ifdef MODEL_POSITION_ON_GPU\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_instance;\n#endif\nuniform highp mat4 u_node_matrix;\n#endif\nvoid main() {\n#ifdef MODEL_POSITION_ON_GPU\nhighp mat4 instance;\n#ifdef INSTANCED_ARRAYS\ninstance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\ninstance=u_instance;\n#endif\nvec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;\n#else\ngl_Position=u_matrix*vec4(a_pos_3f,1);\n#endif\nv_depth=gl_Position.z/gl_Position.w;}"),stars:Rr("in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)\n{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}","\nin vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}")};function jb(e,t){const r=e.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let s of r)if(s=s.trim(),"#"===s[0]&&s.includes("if")&&!s.includes("endif")){s=s.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const c=s.split(" ");for(const d of c)t.includes(d)||t.push(d)}}function Rr(e,t){const r=/#include\s+"([^"]+)"/g,s=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let c=t.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);c&&(c=c.map(b=>{const w=b.split(" ");return w[w.length-1]}),c=[...new Set(c)]);const d={},f=[],g=[];e=e.replace(r,(b,w)=>(g.push(w),"")),t=t.replace(r,(b,w)=>(f.push(w),""));let y=[...Om];jb(e,y),jb(t,y);for(const b of[...f,...g])Df[b]||console.error(`Undefined include: ${b}`),Ey[b]||(Ey[b]=[],jb(Df[b],Ey[b])),y=[...y,...Ey[b]];return{fragmentSource:e=e.replace(s,(b,w,P,O,I)=>(d[I]=!0,"define"===w?`\n#ifndef HAS_UNIFORM_u_${I}\nin ${P} ${O} ${I};\n#else\nuniform ${P} ${O} u_${I};\n#endif\n`:"initialize"===w?`\n#ifdef HAS_UNIFORM_u_${I}\n    ${P} ${O} ${I} = u_${I};\n#endif\n`:"define-attribute"===w?`\n#ifdef HAS_ATTRIBUTE_a_${I}\n    in ${P} ${O} ${I};\n#endif\n`:"initialize-attribute"===w?"":void 0)),vertexSource:t=t.replace(s,(b,w,P,O,I)=>{const A="float"===O?"vec2":O,l=I.match(/color/)?"color":A;return"define-attribute-vertex-shader-only"===w?`\n#ifdef HAS_ATTRIBUTE_a_${I}\nin ${P} ${O} a_${I};\n#endif\n`:d[I]?"define"===w?`\n#ifndef HAS_UNIFORM_u_${I}\nuniform lowp float u_${I}_t;\nin ${P} ${A} a_${I};\nout ${P} ${O} ${I};\n#else\nuniform ${P} ${O} u_${I};\n#endif\n`:"initialize"===w?"vec4"===l?`\n#ifndef HAS_UNIFORM_u_${I}\n    ${I} = a_${I};\n#else\n    ${P} ${O} ${I} = u_${I};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${I}\n    ${I} = unpack_mix_${l}(a_${I}, u_${I}_t);\n#else\n    ${P} ${O} ${I} = u_${I};\n#endif\n`:"define-attribute"===w?`\n#ifdef HAS_ATTRIBUTE_a_${I}\n    in ${P} ${O} a_${I};\n    out ${P} ${O} ${I};\n#endif\n`:"initialize-attribute"===w?`\n#ifdef HAS_ATTRIBUTE_a_${I}\n    ${I} = a_${I};\n#endif\n`:void 0:"define"===w?`\n#ifndef HAS_UNIFORM_u_${I}\nuniform lowp float u_${I}_t;\nin ${P} ${A} a_${I};\n#else\nuniform ${P} ${O} u_${I};\n#endif\n`:"define-instanced"===w?"mat4"===l?`\n#ifdef INSTANCED_ARRAYS\nin vec4 a_${I}0;\nin vec4 a_${I}1;\nin vec4 a_${I}2;\nin vec4 a_${I}3;\n#else\nuniform ${P} ${O} u_${I};\n#endif\n`:`\n#ifdef INSTANCED_ARRAYS\nin ${P} ${A} a_${I};\n#else\nuniform ${P} ${O} u_${I};\n#endif\n`:"initialize-attribute-custom"===w?`\n#ifdef HAS_ATTRIBUTE_a_${I}\n    ${P} ${O} ${I} = a_${I};\n#endif\n`:"vec4"===l?`\n#ifndef HAS_UNIFORM_u_${I}\n    ${P} ${O} ${I} = a_${I};\n#else\n    ${P} ${O} ${I} = u_${I};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${I}\n    ${P} ${O} ${I} = unpack_mix_${l}(a_${I}, u_${I}_t);\n#else\n    ${P} ${O} ${I} = u_${I};\n#endif\n`}),staticAttributes:c,usedDefines:y,vertexIncludes:f,fragmentIncludes:g}}class tI{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,r,s,c,d,f,g,y){this.context=t;let b=this.boundPaintVertexBuffers.length!==c.length;for(let P=0;!b&&P<c.length;P++)this.boundPaintVertexBuffers[P]!==c[P]&&(b=!0);let w=this.boundDynamicVertexBuffers.length!==g.length;for(let P=0;!w&&P<g.length;P++)this.boundDynamicVertexBuffers[P]!==g[P]&&(w=!0);if(!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==s||b||w||this.boundIndexBuffer!==d||this.boundVertexOffset!==f)this.freshBind(r,s,c,d,f,g,y);else{t.bindVertexArrayOES.set(this.vao);for(const P of g)P&&(P.bind(),y&&P.instanceCount&&P.setVertexAttribDivisor(t.gl,r,y));d&&d.dynamicDraw&&d.bind()}}freshBind(t,r,s,c,d,f,g){const y=t.numAttributes,b=this.context,w=b.gl;this.vao&&this.destroy(),this.vao=b.gl.createVertexArray(),b.bindVertexArrayOES.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=s,this.boundIndexBuffer=c,this.boundVertexOffset=d,this.boundDynamicVertexBuffers=f,r.enableAttributes(w,t),r.bind(),r.setVertexAttribPointers(w,t,d);for(const P of s)P.enableAttributes(w,t),P.bind(),P.setVertexAttribPointers(w,t,d);for(const P of f)P&&(P.enableAttributes(w,t),P.bind(),P.setVertexAttribPointers(w,t,d),g&&P.instanceCount&&P.setVertexAttribDivisor(w,t,g));c&&c.bind(),b.currentNumAttributes=y}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function cO(e,t){const r=Math.pow(2,t.canonical.z),s=t.canonical.y;return[new Xn(0,s/r).toLngLat().lat,new Xn(0,(s+1)/r).toLngLat().lat]}function oM(e,t,r,s,c,d,f){const g=e.context,y=g.gl,b=r.hillshadeFBO;if(!b)return;e.prepareDrawTile();const w=e.isTileAffectedByFog(t),P=e.getOrCreateProgram("hillshade",{overrideFog:w});g.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,b.colorAttachment.get());const O=((u,p,m,v)=>{const C=m.paint.get("hillshade-shadow-color"),E=m.paint.get("hillshade-highlight-color"),T=m.paint.get("hillshade-accent-color"),k=m.paint.get("hillshade-emissive-strength");let N=Ct(m.paint.get("hillshade-illumination-direction"));if("viewport"===m.paint.get("hillshade-illumination-anchor"))N-=u.transform.angle;else if(u.style&&u.style.enable3dLights()&&u.style.directionalLight){const $=u.style.directionalLight.properties.get("direction");N=Ct(Ge($.x,$.y,$.z)[1])}const F=!u.options.moving;return{u_matrix:v||u.transform.calculateProjMatrix(p.tileID.toUnwrapped(),F),u_image:0,u_latrange:cO(0,p.tileID),u_light:[m.paint.get("hillshade-exaggeration"),N],u_shadow:C,u_highlight:E,u_emissive_strength:k,u_accent:T}})(e,r,s,e.terrain?t.projMatrix:null);e.uploadCommonUniforms(g,P,t.toUnwrapped());const{tileBoundsBuffer:I,tileBoundsIndexBuffer:A,tileBoundsSegments:l}=e.getTileBoundsBuffers(r);P.draw(e,y.TRIANGLES,c,d,f,Jn.disabled,O,s.id,I,A,l)}function eI(e,t,r){if(!t.needsDEMTextureUpload)return;const s=e.context,c=s.gl;s.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||e.getTileTexture(r.stride);const d=r.getPixels();t.demTexture?t.demTexture.update(d,{premultiply:!1}):t.demTexture=new bi(s,d,c.R32F,{premultiply:!1}),t.needsDEMTextureUpload=!1}function uO(e,t,r){const s=e.context,c=s.gl;if(!t.dem)return;const d=t.dem;if(s.activeTexture.set(c.TEXTURE1),eI(e,t,d),!t.demTexture)return;t.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);const f=d.dim;s.activeTexture.set(c.TEXTURE0);let g=t.hillshadeFBO;if(!g){const O=new bi(s,{width:f,height:f,data:null},c.RGBA);O.bind(c.LINEAR,c.CLAMP_TO_EDGE),g=t.hillshadeFBO=s.createFramebuffer(f,f,!0,"renderbuffer"),g.colorAttachment.set(O.texture)}s.bindFramebuffer.set(g.framebuffer),s.viewport.set([0,0,f,f]);const{tileBoundsBuffer:y,tileBoundsIndexBuffer:b,tileBoundsSegments:w}=e.getMercatorTileBoundsBuffers(),P=[];e.linearFloatFilteringSupported()&&P.push("TERRAIN_DEM_FLOAT_FORMAT"),e.getOrCreateProgram("hillshadePrepare",{defines:P}).draw(e,c.TRIANGLES,Pn.disabled,Gn.disabled,Sr.unblended,Jn.disabled,((O,I)=>{const A=I.stride,l=bt.create();return bt.ortho(l,0,Dt,-Dt,0,0,1),bt.translate(l,l,[0,-Dt,0]),{u_matrix:l,u_image:1,u_dimension:[A,A],u_zoom:O.overscaledZ}})(t.tileID,d),r.id,y,b,w),t.needsHillshadePrepare=!1}const dO=e=>({u_matrix:new Vn(e),u_image0:new cr(e),u_skirt_height:new fe(e),u_ground_shadow_factor:new Kn(e)}),$1=(e,t,r)=>({u_matrix:e,u_image0:0,u_skirt_height:t,u_ground_shadow_factor:r}),hO=(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A)=>({u_proj_matrix:Float32Array.from(e),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(s),u_merc_matrix:r,u_zoom_transition:c,u_merc_center:d,u_image0:0,u_frustum_tl:f,u_frustum_tr:g,u_frustum_br:y,u_frustum_bl:b,u_globe_pos:w,u_globe_radius:P,u_viewport:O,u_grid_matrix:A?Float32Array.from(A):new Float32Array(9),u_skirt_height:I}),Tm=(e,t)=>{if(t>0&&e.terrain&&gt("Cutoff is currently disabled on terrain"),t<=0||e.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,0]}};const r=e.transform,s=Math.max(Math.abs(r._zoom-(e.minCutoffZoom-1)),1),c=r.isLODDisabled(!1)?vs(60,45,r.pitch):vs(30,15,r.pitch),d=r._farZ-r._nearZ,f=t*r.height,g=((1-(y=c))*(.75*r.cameraToCenterDistance)+y*(r._farZ+f))*s;var y;return{shouldRenderCutoff:c<1,uniformValues:{u_cutoff_params:[r._nearZ,r._farZ,(g-r._nearZ)/d,(g-f-r._nearZ)/d]}}};function G1(e,t){return null!=e&&null!=t&&!(!e.hasData()||!t.hasData())&&null!=e.demTexture&&null!=t.demTexture&&e.tileID.key!==t.tileID.key}const fh=new class{constructor(){this.operations={}}newMorphing(e,t,r,s,c){if(e in this.operations){const d=this.operations[e];d.to.tileID.key!==r.tileID.key&&(d.queued=r)}else this.operations[e]={startTime:s,phase:0,duration:c,from:t,to:r,queued:null}}getMorphValuesForProxy(e){if(!(e in this.operations))return null;const t=this.operations[e];return{from:t.from,to:t.to,phase:t.phase}}update(e){for(const t in this.operations){const r=this.operations[t];for(r.phase=(e-r.startTime)/r.duration;r.phase>=1||!this._validOp(r);)if(!this._nextOp(r,e)){delete this.operations[t];break}}}_nextOp(e,t){return!!e.queued&&(e.from=e.to,e.to=e.queued,e.queued=null,e.phase=0,e.startTime=t,!0)}_validOp(e){return e.from.hasData()&&e.to.hasData()}},xi={0:null,1:"TERRAIN_VERTEX_MORPHING"};function H1(e,t,r){if(0===t)return 0;const s=t<1&&514===r?.25/t:1;return 6*Math.pow(1.5,22-e)*Math.max(t,1)*s}function sM(e,t){const r=1<<e.z;return!t&&(0===e.x||e.x===r-1)||0===e.y||e.y===r-1}const Im=e=>({u_matrix:e});function fO(e,t,r,s,c){if(c>0){const d=Mn.now(),f=(d-e.timeAdded)/c,g=t?(d-t.timeAdded)/c:-1,y=r.getSource(),b=s.coveringZoomLevel({tileSize:y.tileSize,roundZoom:y.roundZoom}),w=!t||Math.abs(t.tileID.overscaledZ-b)>Math.abs(e.tileID.overscaledZ-b),P=w&&e.refreshedUponExpiration?1:Ne(w?f:1-g,0,1);return e.refreshedUponExpiration&&f>=1&&(e.refreshedUponExpiration=!1),t?{opacity:1,mix:1-P}:{opacity:P,mix:0}}return{opacity:1,mix:0}}class as extends Na{constructor(t){const r={type:"raster-dem",maxzoom:t.transform.maxZoom},s=new _m(dh(),null),c=xm("mock-dem",r,s,t.style);super("mock-dem",c,!1),c.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,r){t.state="loaded",r(null)}}class va extends Na{constructor(t){const r=xm("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new _m(dh(),null),t.style);super("proxy",r,!1),r.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,r,s){if(t.freezeTileCoverage)return;this.transform=t;const c=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((d,f)=>{if(d[f.key]="",!this._tiles[f.key]){const g=new Ko(f,this._source.tileSize*f.overscaleFactor(),t.tileZoom);g.state="loaded",this._tiles[f.key]=g}return d},{});for(const d in this._tiles)d in c||(this.freeFBO(d),this._tiles[d].unloadVectorData(),delete this._tiles[d])}freeFBO(t){const r=this.proxyCachedFBO[t];if(void 0!==r){const s=Object.values(r);this.renderCachePool.push(...s),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class tu extends Ir{constructor(t,r,s){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=r,this.projMatrix=s}}class pO extends Nv{constructor(t,r){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[s,c,d]=function(y){const b=new pa,w=new Mo,P=131;b.reserve(17161),w.reserve(33800);const O=Dt/128,I=Dt+O/2,A=I+O;for(let u=-O;u<A;u+=O)for(let p=-O;p<A;p+=O){const m=p<0||p>I||u<0||u>I?24575:0,v=Ne(Math.round(p),0,Dt),C=Ne(Math.round(u),0,Dt);b.emplaceBack(v+m,C)}const l=(u,p)=>{const m=p*P+u;w.emplaceBack(m+1,m,m+P),w.emplaceBack(m+P,m+P+1,m+1)};for(let u=1;u<129;u++)for(let p=1;p<129;p++)l(p,u);return[0,129].forEach(u=>{for(let p=0;p<130;p++)l(p,u),l(u,p)}),[b,w,32768]}(),f=t.context;this.gridBuffer=f.createVertexBuffer(s,wp.members),this.gridIndexBuffer=f.createIndexBuffer(c),this.gridSegments=li.simpleSegment(0,0,s.length,c.length),this.gridNoSkirtSegments=li.simpleSegment(0,0,s.length,d),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new va(r.map),this.orthoMatrix=bt.create(),bt.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,Dt,0,Dt,0,1);const g=f.gl;this._overlapStencilMode=new Gn({func:g.GEQUAL,mask:255},0,255,g.KEEP,g.KEEP,g.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=r,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new as(r.map),this._pendingGroundEffectLayers=[]}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),this._style=t,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(t,r,s){if(t&&t.terrain){this._style!==t&&(this.style=t,this._evaluationZoom=void 0);const c=t.terrain.properties,d=0===t.terrain.drapeRenderMode,f=t.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=Mn.now();const g=t.terrain&&t.terrain.scope,y=c.get("source"),b=d?this._mockSourceCache:t.getSourceCache(y,g);if(!b)return void gt(`Couldn't find terrain source "${y}".`);if(this.sourceCache=b,this._exaggeration=f?this.calculateExaggeration(r):c.get("exaggeration"),!r.projection.requiresDraping&&f&&0===this._exaggeration)return void this._disable();this.enabled=!0;const w=()=>{this.sourceCache.used&&gt(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const P=this.getScaledDemTileSize();this.sourceCache.update(r,P,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,w(),this._initializing=!0),w(),r.updateElevation(!0,s),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(r),this._emptyDEMTextureDirty=!0,this._previousZoom=r.zoom}else this._disable()}calculateExaggeration(t){const r=this._previousCameraAltitude,s=t.getFreeCameraOptions().position.z/t.pixelsPerMeter*t.worldSize;this._previousCameraAltitude=s;const c=null!=r?s-r:Number.MAX_VALUE;if(Math.abs(c)<2)return this._exaggeration;const d=t.zoom,f=this._style.terrain;if(!this._previousUpdateTimestamp)return f.getExaggeration(d);let g=d-this._previousZoom;const y=this._previousUpdateTimestamp;let b=d;null!=this._evaluationZoom&&(b=this._evaluationZoom,Math.abs(d-b)>.5&&(g=.5*(d-b+g)),g*c<0&&(b+=g)),this._evaluationZoom=b;const w=f.getExaggeration(b),P=w===f.getExaggeration(Math.max(0,b-.1));if(P&&Math.abs(w-this._exaggeration)<.01)return w;let O=Math.min(.1,.00375*(this._updateTimestamp-y));return(P||w<.1||Math.abs(g)<1e-4)&&(O=Math.min(.2,4*O)),vn(this._exaggeration,w,O)}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._mergedSourceCaches)this._style._mergedSourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const r=this.proxySourceCache,s=this.painter.transform;this._initializing&&(this._initializing=0===s._centerAltitude&&-1===this.getAtPointOrZero(Xn.fromLngLat(s.center),-1),this._emptyDEMTextureDirty=!this._initializing);const c=this.proxyCoords=r.getIds().map(y=>{const b=r.getTileByID(y).tileID;return b.projMatrix=s.calculateProjMatrix(b.toUnwrapped()),b});!function(y,b){const w=b.transform.pointCoordinate(b.transform.getCameraPoint()),P=new tt(w.x,w.y);y.sort((O,I)=>{if(I.overscaledZ-O.overscaledZ)return I.overscaledZ-O.overscaledZ;const A=new tt(O.canonical.x+(1<<O.canonical.z)*O.wrap,O.canonical.y),l=new tt(I.canonical.x+(1<<I.canonical.z)*I.wrap,I.canonical.y),u=P.mult(1<<O.canonical.z);return u.x-=.5,u.y-=.5,u.distSqr(A)-u.distSqr(l)})}(c,this.painter);const d=this.proxyToSource||{};this.proxyToSource={},c.forEach(y=>{this.proxyToSource[y.key]={}}),this.terrainTileForTile={};const f=this._style._mergedSourceCaches;for(const y in f){const b=f[y];if(!b.used||(b!==this.sourceCache&&this.resetTileLookupCache(b.id),this._setupProxiedCoordsForOrtho(b,t[y],d),b.usedForTerrain))continue;const w=t[y];b.getSource().reparseOverscaled&&this._assignTerrainTiles(w)}this.proxiedCoords[r.id]=c.map(y=>new tu(y,y.key,this.orthoMatrix)),this._assignTerrainTiles(c),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(d),this.renderingToTexture=!1;const g={};this._visibleDemTiles=[];for(const y of this.proxyCoords){const b=this.terrainTileForTile[y.key];if(!b)continue;const w=b.tileID.key;w in g||(this._visibleDemTiles.push(b),g[w]=w)}}_assignTerrainTiles(t){this._initializing||t.forEach(r=>{if(this.terrainTileForTile[r.key])return;const s=this._findTileCoveringTileID(r,this.sourceCache);s&&(this.terrainTileForTile[r.key]=s)})}_prepareDEMTextures(){const t=this.painter.context,r=t.gl;for(const s in this.terrainTileForTile){const c=this.terrainTileForTile[s],d=c.dem;!d||c.demTexture&&!c.needsDEMTextureUpload||(t.activeTexture.set(r.TEXTURE1),eI(this.painter,c,d))}}_prepareDemTileUniforms(t,r,s,c){if(!r||null==r.demTexture)return!1;const d=t.tileID.canonical,f=Math.pow(2,r.tileID.canonical.z-d.z),g=c||"";return s[`u_dem_tl${g}`]=[d.x*f%1,d.y*f%1],s[`u_dem_scale${g}`]=f,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,r=t.gl;if(!this._emptyDepthBufferTexture){const s=new Uo({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new bi(t,s,r.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const r=this._visibleDemTiles.reduce((s,c)=>{if(!c.dem)return s;const d=c.dem.tree.minimums[0];return d>0&&t++,s+d},0);return t?r/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,r=t.gl;t.activeTexture.set(r.TEXTURE2);const s=this._getLoadedAreaMinimum(),[c,d]=(()=>{const g=new PT({width:1,height:1},new Float32Array([s]));return[r.R32F,g]})();this._emptyDEMTextureDirty=!1;let f=this._emptyDEMTexture;return f?f.update(d,{premultiply:!1}):f=this._emptyDEMTexture=new bi(t,d,c,{premultiply:!1}),f}setupElevationDraw(t,r,s){const c=this.painter.context,d=c.gl,f={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};f.u_exaggeration=this.exaggeration();let g=null,y=null,b=1;if(s&&s.morphing&&this._useVertexMorphing){const O=s.morphing.srcDemTile,I=s.morphing.dstDemTile;b=s.morphing.phase,O&&I&&(this._prepareDemTileUniforms(t,O,f,"_prev")&&(y=O),this._prepareDemTileUniforms(t,I,f)&&(g=I))}const w=O=>O&&O.demTexture&&this.painter.linearFloatFilteringSupported()?d.LINEAR:d.NEAREST,P=O=>{f.u_dem_size=1===O.size[0]?1:O.size[0]-2};if(y&&g)c.activeTexture.set(d.TEXTURE2),g.demTexture.bind(w(g),d.CLAMP_TO_EDGE),c.activeTexture.set(d.TEXTURE4),y.demTexture.bind(w(y),d.CLAMP_TO_EDGE),g.demTexture&&P(g.demTexture),f.u_dem_lerp=b;else{g=this.terrainTileForTile[t.tileID.key],c.activeTexture.set(d.TEXTURE2);const O=this._prepareDemTileUniforms(t,g,f)?g.demTexture:this.emptyDEMTexture;O.bind(w(g),d.CLAMP_TO_EDGE),P(O)}if(c.activeTexture.set(d.TEXTURE3),s&&s.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(d.NEAREST,d.CLAMP_TO_EDGE),this._depthFBO&&(f.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(d.NEAREST,d.CLAMP_TO_EDGE),f.u_depth_size_inv=[1,1]),s&&s.useMeterToDem&&g){const O=(1<<g.tileID.canonical.z)*ii(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;f.u_meter_to_dem=O}if(s&&s.labelPlaneMatrixInv&&(f.u_label_plane_matrix_inv=s.labelPlaneMatrixInv),r.setTerrainUniformValues(c,f),"globe"===this.painter.transform.projection.name){const O=this.globeUniformValues(this.painter.transform,t.tileID.canonical,s&&s.useDenormalizedUpVectorScale);r.setGlobeUniformValues(c,O)}}globeUniformValues(t,r,s){const c=t.projection;return{u_tile_tl_up:c.upVector(r,0,0),u_tile_tr_up:c.upVector(r,Dt,0),u_tile_br_up:c.upVector(r,Dt,Dt),u_tile_bl_up:c.upVector(r,0,Dt),u_tile_up_scale:s?ox(1):c.upVectorScale(r,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const r=this.painter,s=this.painter.context;0!==t.length&&(s.bindFramebuffer.set(null),s.viewport.set([0,0,r.width,r.height]),r.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(c,d,f,g,y){if("globe"===c.transform.projection.name)!function(b,w,P,O,I){const A=b.context,l=A.gl;let u,p;const m=b.transform,v=gv(b,A,m),C=(X,K)=>{if(p===K)return;const J=[xi[K],"PROJECTION_GLOBE_VIEW"];v&&J.push("CUSTOM_ANTIALIASING");const st=b.isTileAffectedByFog(X);u=b.getOrCreateProgram("globeRaster",{defines:J,overrideFog:st}),p=K},E=b.colorModeForRenderPass(),T=new Pn(l.LEQUAL,Pn.ReadWrite,b.depthRangeFor3D);fh.update(I);const k=ux(m),N=[yo(m.center.lng),Pi(m.center.lat)],F=b.globeSharedBuffers,$=[m.width*Mn.devicePixelRatio,m.height*Mn.devicePixelRatio],q=Float32Array.from(m.globeMatrix),Z={useDenormalizedUpVectorScale:!0};{const X=b.transform,K=H1(X.zoom,w.exaggeration(),w.sourceCache._source.tileSize);p=-1;const J=l.TRIANGLES;for(const st of O){const ot=P.getTile(st),rt=Gn.disabled,ct=w.prevTerrainTileForTile[st.key],yt=w.terrainTileForTile[st.key];G1(ct,yt)&&fh.newMorphing(st.key,ct,yt,I,250),A.activeTexture.set(l.TEXTURE0),ot.texture&&ot.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE);const Ot=fh.getMorphValuesForProxy(st.key),Tt=Ot?1:0;Ot&&Zs(Z,{morphing:{srcDemTile:Ot.from,dstDemTile:Ot.to,phase:Ui(Ot.phase)}});const zt=pv(st.canonical),Nt=DP(zt.getCenter().lat),$t=mv(st.canonical,zt,Nt,X.worldSize/X._pixelsPerMercatorPixel),Rt=lf(Mi(st.canonical)),ie=hO(X.expandedFarZProjMatrix,q,k,Rt,Po(X.zoom),N,X.frustumCorners.TL,X.frustumCorners.TR,X.frustumCorners.BR,X.frustumCorners.BL,X.globeCenterInViewSpace,X.globeRadius,$,K,$t);if(C(st,Tt),u&&(w.setupElevationDraw(ot,u,Z),b.uploadCommonUniforms(A,u,st.toUnwrapped()),F)){const[Ee,Oe,Be]=F.getGridBuffers(Nt,0!==K);u.draw(b,J,T,rt,E,Jn.backCCW,ie,"globe_raster",Ee,Oe,Be)}}}if(F&&(b.renderDefaultNorthPole||b.renderDefaultSouthPole)){const X=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];v&&X.push("CUSTOM_ANTIALIASING"),u=b.getOrCreateProgram("globeRaster",{defines:X});for(const K of O){const{x:J,y:st,z:ot}=K.canonical,rt=0===st,ct=st===(1<<ot)-1,[yt,Ot,Tt,zt]=F.getPoleBuffers(ot,!1);if(zt&&(rt||ct)){const Nt=P.getTile(K);A.activeTexture.set(l.TEXTURE0),Nt.texture&&Nt.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE);let $t=AP(ot,J,m);const Rt=lf(Mi(K.canonical)),ie=(Ee,Oe)=>Ee.draw(b,l.TRIANGLES,T,Gn.disabled,E,Jn.disabled,hO(m.expandedFarZProjMatrix,$t,$t,Rt,0,N,m.frustumCorners.TL,m.frustumCorners.TR,m.frustumCorners.BR,m.frustumCorners.BL,m.globeCenterInViewSpace,m.globeRadius,$,0),"globe_pole_raster",Oe,Tt,zt);w.setupElevationDraw(Nt,u,Z),b.uploadCommonUniforms(A,u,K.toUnwrapped()),rt&&b.renderDefaultNorthPole&&ie(u,yt),ct&&b.renderDefaultSouthPole&&($t=bt.scale(bt.create(),$t,[1,-1,1]),ie(u,Ot))}}}}(c,d,f,g,y);else{const b=c.context,w=b.gl;let P,O;const I=c.shadowRenderer,A=Tm(c,c.longestCutoffRange),l=E=>{if(O===E)return;const T=[];T.push(xi[E]),A.shouldRenderCutoff&&T.push("RENDER_CUTOFF"),P=c.getOrCreateProgram("terrainRaster",{defines:T}),O=E},u=c.colorModeForRenderPass(),p=new Pn(w.LEQUAL,Pn.ReadWrite,c.depthRangeFor3D);fh.update(y);const m=c.transform,v=H1(m.zoom,d.exaggeration(),d.sourceCache._source.tileSize);let C=[0,0,0];if(I){const E=c.style.directionalLight,T=c.style.ambientLight;E&&T&&(C=xM(E,T))}{O=-1;const E=w.TRIANGLES,[T,k]=[d.gridIndexBuffer,d.gridSegments];for(const N of g){const F=f.getTile(N),$=Gn.disabled,q=d.prevTerrainTileForTile[N.key],Z=d.terrainTileForTile[N.key];G1(q,Z)&&fh.newMorphing(N.key,q,Z,y,250),b.activeTexture.set(w.TEXTURE0),F.texture&&F.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE);const X=fh.getMorphValuesForProxy(N.key),K=X?1:0;let J;X&&(J={morphing:{srcDemTile:X.from,dstDemTile:X.to,phase:Ui(X.phase)}});const st=$1(N.projMatrix,sM(N.canonical,m.renderWorldCopies)?v/10:v,C);if(l(K),!P)continue;d.setupElevationDraw(F,P,J);const ot=N.toUnwrapped();I&&I.setupShadows(ot,P),c.uploadCommonUniforms(b,P,ot,null,A),P.draw(c,E,p,$,u,Jn.backCCW,st,"terrain_raster",d.gridBuffer,T,k)}}}}(r,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,r.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;const r=this.painter,s=this.painter.context,c=this.proxySourceCache,d=this.proxiedCoords[c.id],f=this._drapedRenderBatches.shift(),g=r.style.order,y=[];let b=0;for(const w of d){const P=c.getTileByID(w.proxyTileKey),O=c.proxyCachedFBO[w.key]?c.proxyCachedFBO[w.key][t]:void 0,I=void 0!==O?c.renderCache[O]:this.pool[b++],A=void 0!==O;if(P.texture=I.tex,A&&!I.dirty){y.push(P.tileID);continue}let l;s.bindFramebuffer.set(I.fb.framebuffer),this.renderedToTile=!1,I.dirty&&(s.clear({color:bn.transparent,stencil:0}),I.dirty=!1);for(let u=f.start;u<=f.end;++u){const p=r.style._mergedLayers[g[u]];if(p.isHidden(r.transform.zoom))continue;const m=r.style.getLayerSourceCache(p),v=m?this.proxyToSource[w.key][m.id]:[w];if(!v)continue;const C=v;s.viewport.set([0,0,I.fb.width,I.fb.height]),l!==(m?m.id:null)&&(this._setupStencil(I,v,p,m),l=m?m.id:null),r.renderLayer(r,m,p,C)}if(0===this._drapedRenderBatches.length)for(const u of this._pendingGroundEffectLayers){const p=r.style._mergedLayers[g[u]];if(p.isHidden(r.transform.zoom))continue;const m=r.style.getLayerSourceCache(p),v=m?this.proxyToSource[w.key][m.id]:[w];if(!v)continue;const C=v;s.viewport.set([0,0,I.fb.width,I.fb.height]),l!==(m?m.id:null)&&(this._setupStencil(I,v,p,m),l=m?m.id:null),r.renderLayer(r,m,p,C)}this.renderedToTile?(I.dirty=!0,y.push(P.tileID)):A||--b,5===b&&(b=0,this.renderToBackBuffer(y))}return this.renderToBackBuffer(y),this.renderingToTexture=!1,s.bindFramebuffer.set(null),s.viewport.set([0,0,r.width,r.height]),f.end+1}postRender(){}isLayerOrderingCorrect(t){const r=t.order.length;let s=-1,c=r;for(let d=0;d<r;++d)this._style.isLayerDraped(t._mergedLayers[t.order[d]])?s=Math.max(s,d):c=Math.min(c,d);return c>s}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(r=>r.dem).forEach(r=>{t=Math.min(t,r.dem.tree.minimums[0])}),0===t?t:(t-30)*this._exaggeration}raycast(t,r,s){if(!this._visibleDemTiles)return null;const c=this._visibleDemTiles.filter(d=>d.dem).map(d=>{const f=d.tileID,g=1<<f.overscaledZ,{x:y,y:b}=f.canonical,w=y/g,P=(y+1)/g,O=b/g,I=(b+1)/g;return{minx:w,miny:O,maxx:P,maxy:I,t:d.dem.tree.raycastRoot(w,O,P,I,t,r,s),tile:d}});c.sort((d,f)=>(null!==d.t?d.t:Number.MAX_VALUE)-(null!==f.t?f.t:Number.MAX_VALUE));for(const d of c){if(null==d.t)return null;const f=d.tile.dem.tree.raycast(d.minx,d.miny,d.maxx,d.maxy,t,r,s);if(null!=f)return f}return null}_createFBO(){const t=this.painter.context,r=t.gl,s=this.drapeBufferSize;t.activeTexture.set(r.TEXTURE0);const c=new bi(t,{width:s[0],height:s[1],data:null},r.RGBA);c.bind(r.LINEAR,r.CLAMP_TO_EDGE);const d=t.createFramebuffer(s[0],s[1],!0,null);return d.colorAttachment.set(c.texture),d.depthAttachment=new Gp(t,d.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,s[0],s[1]),this._stencilRef=0,d.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):d.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&r.texParameterf(r.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:d,tex:c,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.hasLightTransitions())return!0;for(const t in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const r=this._style._mergedLayers[t],s=r.isHidden(this.painter.transform.zoom);return"custom"===r.type?!s&&r.shouldRedrape():!s&&r.hasTransition()})}_clearLineLayersFromRenderCache(){let t=!1;for(const s of this._style.getSources())if(s instanceof M1){t=!0;break}if(!t)return;const r={};for(let s=0;s<this._style.order.length;++s){const c=this._style._mergedLayers[this._style.order[s]],d=this._style.getLayerSourceCache(c);if(d&&!r[d.id]&&!c.isHidden(this.painter.transform.zoom)&&"line"===c.type&&c.widthExpression()instanceof Os){r[d.id]=!0;for(const f of this.proxyCoords){const g=this.proxyToSource[f.key][d.id];if(g)for(const y of g)this._clearRenderCacheForTile(d.id,y)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s]._source instanceof P1){t=!0;break}if(!t)return;const r={};for(let s=0;s<this._style.order.length;++s){const c=this._style._mergedLayers[this._style.order[s]],d=this._style.getLayerSourceCache(c);if(!d||r[d.id]||c.isHidden(this.painter.transform.zoom)||"raster"!==c.type)continue;const f=c.paint.get("raster-fade-duration");for(const g of this.proxyCoords){const y=this.proxyToSource[g.key][d.id];if(y)for(const b of y){const w=fO(d.getTile(b),d.findLoadedParent(b,0),d,this.painter.transform,f);(1!==w.opacity||0!==w.mix)&&this._clearRenderCacheForTile(d.id,b)}}}}_setupDrapedRenderBatches(){const t=this._style.order,r=t.length;if(0===r)return;const s=[];this._pendingGroundEffectLayers=[];let c,d=0,f=this._style._mergedLayers[t[d]];for(;!this._style.isLayerDraped(f)&&f.isHidden(this.painter.transform.zoom)&&++d<r;)f=this._style._mergedLayers[t[d]];for(;d<r;++d){const g=this._style._mergedLayers[t[d]];g.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(g)?void 0===c&&(c=d):("fill-extrusion"===g.type&&this._pendingGroundEffectLayers.push(d),void 0!==c&&(s.push({start:c,end:d-1}),c=void 0)))}if(void 0!==c&&s.push({start:c,end:d-1}),0!==s.length){const g=s[s.length-1];this._pendingGroundEffectLayers.every(b=>b>g.end)||gt("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=s}_setupRenderCache(t){const r=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,r.renderCache.length>r.renderCachePool.length){const f=Object.values(r.proxyCachedFBO);r.proxyCachedFBO={};for(let g=0;g<f.length;++g){const y=Object.values(f[g]);r.renderCachePool.push(...y)}}return}this._clearRasterLayersFromRenderCache();const s=this.proxyCoords,c=this._tilesDirty;for(let f=s.length-1;f>=0;f--){const g=s[f];if(r.getTileByID(g.key),void 0!==r.proxyCachedFBO[g.key]){const y=t[g.key],b=this.proxyToSource[g.key];let w=0;for(const P in b){const O=b[P],I=y[P];if(!I||I.length!==O.length||O.some((A,l)=>A!==I[l]||c[P]&&c[P].hasOwnProperty(A.key))){w=-1;break}++w}for(const P in r.proxyCachedFBO[g.key])r.renderCache[r.proxyCachedFBO[g.key][P]].dirty=w<0||w!==Object.values(y).length}}const d=[...this._drapedRenderBatches];d.sort((f,g)=>g.end-g.start-(f.end-f.start));for(const f of d)for(const g of s){if(r.proxyCachedFBO[g.key])continue;let y=r.renderCachePool.pop();void 0===y&&r.renderCache.length<50&&(y=r.renderCache.length,r.renderCache.push(this._createFBO())),void 0!==y&&(r.proxyCachedFBO[g.key]={},r.proxyCachedFBO[g.key][f.start]=y,r.renderCache[y].dirty=!0)}this._tilesDirty={}}_setupStencil(t,r,s,c){if(!c||!this._sourceTilesOverlap[c.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const d=this.painter.context,f=d.gl;if(r.length<=1)return void(this._overlapStencilType=!1);let g;if(s.isTileClipped())g=r.length,this._overlapStencilMode.test={func:f.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(r[0].overscaledZ>r[r.length-1].overscaledZ))return void(this._overlapStencilType=!1);g=1,this._overlapStencilMode.test={func:f.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+g>255&&(d.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=g,this._overlapStencilMode.ref=this._stencilRef,s.isTileClipped()&&this._renderTileClippingMasks(r,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):Gn.disabled}_renderTileClippingMasks(t,r){const s=this.painter,c=this.painter.context,d=c.gl;s._tileClippingMaskIDs={},c.setColorMode(Sr.disabled),c.setDepthMode(Pn.disabled);const f=s.getOrCreateProgram("clippingMask");for(const g of t){const y=s._tileClippingMaskIDs[g.key]=--r;f.draw(s,d.TRIANGLES,Pn.disabled,new Gn({func:d.ALWAYS,mask:0},y,255,d.KEEP,d.KEEP,d.REPLACE),Sr.disabled,Jn.disabled,Im(g.projMatrix),"$clipping",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments)}}pointCoordinate(t){const r=this.painter.transform;if(t.x<0||t.x>r.width||t.y<0||t.y>r.height)return null;const s=[t.x,t.y,1,1];kr.transformMat4(s,s,r.pixelMatrixInverse),kr.scale(s,s,1/s[3]),s[0]/=r.worldSize,s[1]/=r.worldSize;const c=r._camera.position,d=ii(1,r.center.lat),f=[c[0],c[1],c[2]/d,0],g=dt.subtract([],s.slice(0,3),f);dt.normalize(g,g);const y=this.raycast(f,g,this._exaggeration);return null!==y&&y?(dt.scaleAndAdd(f,f,g,y),f[3]=f[2],f[2]*=d,f):null}drawDepth(){const t=this.painter,r=t.context,s=this.proxySourceCache,c=Math.ceil(t.width),d=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===c&&this._depthFBO.height===d||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const f=r.gl,g=r.createFramebuffer(c,d,!0,"renderbuffer");r.activeTexture.set(f.TEXTURE0);const y=new bi(r,{width:c,height:d,data:null},f.RGBA);y.bind(f.NEAREST,f.CLAMP_TO_EDGE),g.colorAttachment.set(y.texture);const b=r.createRenderbuffer(r.gl.DEPTH_COMPONENT16,c,d);g.depthAttachment.set(b),this._depthFBO=g,this._depthTexture=y}r.bindFramebuffer.set(this._depthFBO.framebuffer),r.viewport.set([0,0,c,d]),function(f,g,y,b){if("globe"===f.transform.projection.name)return;const w=f.context,P=w.gl;w.clear({depth:1});const O=f.getOrCreateProgram("terrainDepth"),I=new Pn(P.LESS,Pn.ReadWrite,f.depthRangeFor3D);for(const A of b){const l=y.getTile(A),u=$1(A.projMatrix,0,[0,0,0]);g.setupElevationDraw(l,O),O.draw(f,P.TRIANGLES,I,Gn.disabled,Sr.unblended,Jn.backCCW,u,"terrain_depth",g.gridBuffer,g.gridIndexBuffer,g.gridNoSkirtSegments)}}(t,this,s,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,r,s){if(t.getSource()instanceof Qc)return this._setupProxiedCoordsForImageSource(t,r,s);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const c=this.proxiedCoords[t.id]=[],d=this.proxyCoords;for(let g=0;g<d.length;g++){const y=d[g],b=this._findTileCoveringTileID(y,t);if(b){const w=this._createProxiedId(y,b,s[y.key]&&s[y.key][t.id]);c.push(w),this.proxyToSource[y.key][t.id]=[w]}}let f=!1;for(let g=0;g<r.length;g++){const y=t.getTile(r[g]);if(!y||!y.hasData())continue;const b=this._findTileCoveringTileID(y.tileID,this.proxySourceCache);if(b&&b.tileID.canonical.z!==y.tileID.canonical.z){const w=this.proxyToSource[b.tileID.key][t.id],P=this._createProxiedId(b.tileID,y,s[b.tileID.key]&&s[b.tileID.key][t.id]);w?w.splice(w.length-1,0,P):this.proxyToSource[b.tileID.key][t.id]=[P],c.push(P),f=!0}}this._sourceTilesOverlap[t.id]=f}_setupProxiedCoordsForImageSource(t,r,s){if(!t.getSource().loaded())return;const c=this.proxiedCoords[t.id]=[],d=this.proxyCoords,f=t.getSource(),g=f.tileID;if(!g)return;const y=new tt(g.x,g.y)._div(1<<g.z),b=f.coordinates.map(Xn.fromLngLat).reduce((P,O)=>(P.min.x=Math.min(P.min.x,O.x-y.x),P.min.y=Math.min(P.min.y,O.y-y.y),P.max.x=Math.max(P.max.x,O.x-y.x),P.max.y=Math.max(P.max.y,O.y-y.y),P),{min:new tt(Number.MAX_VALUE,Number.MAX_VALUE),max:new tt(-Number.MAX_VALUE,-Number.MAX_VALUE)}),w=(P,O)=>{const I=P.wrap+P.canonical.x/(1<<P.canonical.z),A=P.canonical.y/(1<<P.canonical.z),l=Dt/(1<<P.canonical.z),u=O.wrap+O.canonical.x/(1<<O.canonical.z),p=O.canonical.y/(1<<O.canonical.z);return I+l<u+b.min.x||I>u+b.max.x||A+l<p+b.min.y||A>p+b.max.y};for(let P=0;P<d.length;P++){const O=d[P];for(let I=0;I<r.length;I++){const A=t.getTile(r[I]);if(!A||!A.hasData()||w(O,A.tileID))continue;const l=this._createProxiedId(O,A,s[O.key]&&s[O.key][t.id]),u=this.proxyToSource[O.key][t.id];u?u.push(l):this.proxyToSource[O.key][t.id]=[l],c.push(l)}}}_createProxiedId(t,r,s){let c=this.orthoMatrix;if(s){const d=s.find(f=>f.key===r.tileID.key);if(d)return d}if(r.tileID.key!==t.key){const d=t.canonical.z-r.tileID.canonical.z;let f,g,y;c=bt.create();const b=r.tileID.wrap-t.wrap<<t.overscaledZ;d>0?(f=Dt>>d,g=f*((r.tileID.canonical.x<<d)-t.canonical.x+b),y=f*((r.tileID.canonical.y<<d)-t.canonical.y)):(f=Dt<<-d,g=Dt*(r.tileID.canonical.x-(t.canonical.x+b<<-d)),y=Dt*(r.tileID.canonical.y-(t.canonical.y<<-d))),bt.ortho(c,0,f,0,f,0,1),bt.translate(c,c,[g,y,0])}return new tu(r.tileID,t.key,c)}_findTileCoveringTileID(t,r){let s=r.getTile(t);if(s&&s.hasData())return s;const c=this._findCoveringTileCache[r.id],d=c[t.key];if(s=d?r.getTileByID(d):null,s&&s.hasData()||null===d)return s;let f=s?s.tileID:t,g=f.overscaledZ;const y=r.getSource().minzoom,b=[];if(!d){const P=r.getSource().maxzoom;if(t.canonical.z>=P){const O=t.canonical.z-P;r.getSource().reparseOverscaled?(g=Math.max(t.canonical.z+2,r.transform.tileZoom),f=new Ir(g,t.wrap,P,t.canonical.x>>O,t.canonical.y>>O)):0!==O&&(g=P,f=new Ir(g,t.wrap,P,t.canonical.x>>O,t.canonical.y>>O))}f.key!==t.key&&(b.push(f.key),s=r.getTile(f))}const w=P=>{b.forEach(O=>{c[O]=P}),b.length=0};for(g-=1;g>=y&&(!s||!s.hasData());g--){s&&w(s.tileID.key);const P=f.calculateScaledKey(g);if(s=r.getTileByID(P),s&&s.hasData())break;const O=c[P];if(null===O)break;void 0===O?b.push(P):s=r.getTileByID(O)}return w(s?s.tileID.key:null),s&&s.hasData()?s:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,r){let s=this._tilesDirty[t];s||(s=this._tilesDirty[t]={}),s[r.key]=!0}}function nI(e,t,r){const s=function(g,y,b){const w=dt.dot(y,g),P=dt.dot(b,[.2126,.7152,.0722]),O=(A,l,u)=>(1-u)*A+u*l,I=O(1-.3*Math.min(P,1),1,Math.min(w+1,1));return O(.92,1,Math.asin(Ne(y[2],-1,1))/Math.PI+.5)*I}(e,[0,0,1],t),c=[0,0,0];dt.scale(c,r.slice(0,3),s);const d=[0,0,0];dt.scale(d,t.slice(0,3),e[2]);const f=[0,0,0];return dt.add(f,c,d),Xr(f)}const aM=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],RS=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class lM{static cacheKey(t,r,s,c){let d=`${r}${c?c.cacheKey:""}`;for(const f of s)t.usedDefines.includes(f)&&(d+=`/${f}`);return d}constructor(t,r,s,c,d,f){const g=t.gl;this.program=g.createProgram(),this.configuration=c,this.name=r,this.fixedDefines=[...f];const y=c?c.getBinderAttributes():[],b=(s.staticAttributes||[]).concat(y);let w=c?c.defines():[];w=w.concat(f.map(u=>`#define ${u}`));const P="#version 300 es\n";let O=P+w.concat("precision mediump float;",rM,JT.fragmentSource).join("\n");for(const u of s.fragmentIncludes)O+=`\n${Df[u]}`;O+=`\n${s.fragmentSource}`;let I=P+w.concat("precision highp float;",rM,JT.vertexSource).join("\n");for(const u of s.vertexIncludes)I+=`\n${Df[u]}`;I+=`\n${s.vertexSource}`;const A=g.createShader(g.FRAGMENT_SHADER);if(g.isContextLost())return void(this.failedToCreate=!0);g.shaderSource(A,O),g.compileShader(A),g.attachShader(this.program,A);const l=g.createShader(g.VERTEX_SHADER);if(g.isContextLost())this.failedToCreate=!0;else{g.shaderSource(l,I),g.compileShader(l),g.attachShader(this.program,l),this.attributes={},this.numAttributes=b.length;for(let u=0;u<this.numAttributes;u++)if(b[u]){const p=b[u].startsWith("a_")?b[u]:`a_${b[u]}`;g.bindAttribLocation(this.program,u,p),this.attributes[p]=u}g.linkProgram(this.program),g.deleteShader(l),g.deleteShader(A),this.fixedUniforms=d(t),this.binderUniforms=c?c.getUniforms(t):[],f.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new cr(u=t),u_dem_prev:new cr(u),u_dem_tl:new fr(u),u_dem_scale:new fe(u),u_dem_tl_prev:new fr(u),u_dem_scale_prev:new fe(u),u_dem_size:new fe(u),u_dem_lerp:new fe(u),u_exaggeration:new fe(u),u_depth:new cr(u),u_depth_size_inv:new fr(u),u_meter_to_dem:new fe(u),u_label_plane_matrix_inv:new Vn(u)}),f.includes("GLOBE")&&(this.globeUniforms=(u=>({u_tile_tl_up:new Kn(u),u_tile_tr_up:new Kn(u),u_tile_br_up:new Kn(u),u_tile_bl_up:new Kn(u),u_tile_up_scale:new fe(u)}))(t)),f.includes("FOG")&&(this.fogUniforms=(u=>({u_fog_matrix:new Vn(u),u_fog_range:new fr(u),u_fog_color:new ic(u),u_fog_horizon_blend:new fe(u),u_fog_vertical_limit:new fr(u),u_fog_temporal_offset:new fe(u),u_frustum_tl:new Kn(u),u_frustum_tr:new Kn(u),u_frustum_br:new Kn(u),u_frustum_bl:new Kn(u),u_globe_pos:new Kn(u),u_globe_radius:new fe(u),u_globe_transition:new fe(u),u_is_globe:new cr(u),u_viewport:new fr(u)}))(t)),f.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(u=>({u_cutoff_params:new ic(u)}))(t)),f.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(u=>({u_lighting_ambient_color:new Kn(u),u_lighting_directional_dir:new Kn(u),u_lighting_directional_color:new Kn(u),u_ground_radiance:new Kn(u)}))(t)),f.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(u=>({u_light_matrix_0:new Vn(u),u_light_matrix_1:new Vn(u),u_fade_range:new fr(u),u_shadow_normal_offset:new Kn(u),u_shadow_intensity:new fe(u),u_shadow_texel_size:new fe(u),u_shadow_map_resolution:new fe(u),u_shadow_direction:new Kn(u),u_shadow_bias:new Kn(u),u_shadowmap_0:new cr(u),u_shadowmap_1:new cr(u)}))(t))}var u}setTerrainUniformValues(t,r){if(!this.terrainUniforms)return;const s=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in r)s[c]&&s[c].set(this.program,c,r[c])}}setGlobeUniformValues(t,r){if(!this.globeUniforms)return;const s=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in r)s[c]&&s[c].set(this.program,c,r[c])}}setFogUniformValues(t,r){if(!this.fogUniforms)return;const s=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in r)s[c].set(this.program,c,r[c])}}setCutoffUniformValues(t,r){if(!this.cutoffUniforms)return;const s=this.cutoffUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in r)s[c].set(this.program,c,r[c])}}setLightsUniformValues(t,r){if(!this.lightsUniforms)return;const s=this.lightsUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in r)s[c].set(this.program,c,r[c])}}setShadowUniformValues(t,r){if(this.failedToCreate||!this.shadowUniforms)return;const s=this.shadowUniforms;t.program.set(this.program);for(const c in r)s[c].set(this.program,c,r[c])}_drawDebugWireframe(t,r,s,c,d,f,g,y,b,w){const P=t.options.wireframe;if(!1===P.terrain&&!1===P.layers2D&&!1===P.layers3D)return;const O=t.context;if(!(()=>!(!P.terrain||"terrainRaster"!==this.name&&"globeRaster"!==this.name)||!(!P.layers2D||t._terrain&&t._terrain.renderingToTexture||!aM.includes(this.name))||!(!P.layers3D||!RS.includes(this.name)))())return;const I=O.gl,A=t.wireframeDebugCache.getLinesFromTrianglesBuffer(t.frameCounter,d,O);if(!A)return;const l=[...this.fixedDefines];l.push("DEBUG_WIREFRAME");const u=t.getOrCreateProgram(this.name,{config:this.configuration,defines:l});O.program.set(u.program);const p=(C,E,T)=>{if(E[C]&&T[C])for(const k in E[C])T[C][k]&&T[C][k].set(T.program,k,E[C][k].current)};b&&b.setUniforms(u.program,O,u.binderUniforms,g,{zoom:y}),p("fixedUniforms",this,u),p("terrainUniforms",this,u),p("globeUniforms",this,u),p("fogUniforms",this,u),p("lightsUniforms",this,u),p("shadowUniforms",this,u),A.bind(),O.setColorMode(new Sr([I.ONE,I.ONE_MINUS_SRC_ALPHA,I.ZERO,I.ONE],bn.transparent,[!0,!0,!0,!1])),O.setDepthMode(new Pn(r.func===I.LESS?I.LEQUAL:r.func,Pn.ReadOnly,r.range)),O.setStencilMode(Gn.disabled);const m=3*f.primitiveLength*2,v=3*f.primitiveOffset*2*2;w&&w>1?I.drawElementsInstanced(I.LINES,m,I.UNSIGNED_SHORT,v,w):I.drawElements(I.LINES,m,I.UNSIGNED_SHORT,v),d.bind(),O.program.set(this.program),O.setDepthMode(r),O.setStencilMode(s),O.setColorMode(c)}draw(t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u){const p=t.context,m=p.gl;if(this.failedToCreate)return;p.program.set(this.program),p.setDepthMode(s),p.setStencilMode(c),p.setColorMode(d),p.setCullFace(f);for(const E of Object.keys(this.fixedUniforms))this.fixedUniforms[E].set(this.program,E,g[E]);A&&A.setUniforms(this.program,p,this.binderUniforms,O,{zoom:I});const v={[m.LINES]:2,[m.TRIANGLES]:3,[m.LINE_STRIP]:1}[r],C=u&&u>0?1:void 0;for(const E of P.get()){const T=E.vaos||(E.vaos={});(T[y]||(T[y]=new tI)).bind(p,this,b,A?A.getPaintVertexBuffers():[],w,E.vertexOffset,l||[],C),u&&u>1?m.drawElementsInstanced(r,E.primitiveLength*v,m.UNSIGNED_SHORT,E.primitiveOffset*v*2,u):m.drawElements(r,E.primitiveLength*v,m.UNSIGNED_SHORT,E.primitiveOffset*v*2),r===m.TRIANGLES&&this._drawDebugWireframe(t,s,c,d,w,E,O,I,A,u)}}}function rI(e,t){const r=Math.pow(2,t.tileID.overscaledZ),s=t.tileSize*Math.pow(2,e.transform.tileZoom)/r,c=s*(t.tileID.canonical.x+t.tileID.wrap*r),d=s*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/Ju(t,1,e.transform.tileZoom),u_pixel_coord_upper:[c>>16,d>>16],u_pixel_coord_lower:[65535&c,65535&d]}}const q1=bt.create(),iI=(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l)=>{const u=t.style.light,p=u.properties.get("position"),m=[p.x,p.y,p.z],v=sl.create();"viewport"===u.properties.get("anchor")&&(sl.fromRotation(v,-t.transform.angle),dt.transformMat3(m,m,v));const C=u.properties.get("color"),E=t.transform,T={u_matrix:e,u_lightpos:m,u_lightintensity:u.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+r,u_opacity:s,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:q1,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:c,u_edge_radius:d,u_flood_light_color:P,u_vertical_scale:O,u_flood_light_intensity:I,u_ground_shadow_factor:A,u_emissive_strength:l};return"globe"===E.projection.name&&(T.u_tile_id=[f.canonical.x,f.canonical.y,1<<f.canonical.z],T.u_zoom_transition=y,T.u_inv_rot_matrix=w,T.u_merc_center=b,T.u_up_dir=E.projection.upVector(new oc(0,0,0),b[0]*Dt,b[1]*Dt),T.u_height_lift=g),T},sD=(e,t,r)=>({u_matrix:e,u_edge_radius:t,u_vertical_scale:r}),jo=(e,t,r,s,c,d,f,g,y,b,w,P,O,I)=>{const A=iI(e,t,r,s,c,d,f,y,b,w,P,O,I,1,[0,0,0],0),l={u_height_factor:-Math.pow(2,f.overscaledZ)/g.tileSize/8};return _t(A,rI(t,g),l)},LS=(e,t)=>({u_matrix:e,u_emissive_strength:t}),oI=(e,t,r,s)=>_t(LS(e,t),rI(r,s)),Vs=(e,t,r)=>({u_matrix:e,u_world:r,u_emissive_strength:t}),sI=(e,t,r,s,c)=>_t(oI(e,t,r,s),{u_world:c}),aD=(e,t,r,s)=>{const c=Dt/r.tileSize;return{u_matrix:e,u_camera_to_center_distance:t.getCameraToCenterDistance(s),u_extrude_scale:[t.pixelsToGLUnits[0]/c,t.pixelsToGLUnits[1]/c]}},NS=(e,t,r=1)=>({u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:r}),cM=bt.create(),gO=(e,t,r,s,c,d,f)=>{const g=e.transform,y="globe"===g.projection.name,b=y?k_(g.zoom,t.canonical)*g._pixelsPerMercatorPixel:Ju(r,1,d),w={u_matrix:t.projMatrix,u_extrude_scale:b,u_intensity:f,u_inv_rot_matrix:cM,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(y){w.u_inv_rot_matrix=s,w.u_merc_center=c,w.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],w.u_zoom_transition=Po(g.zoom);const P=c[0]*Dt,O=c[1]*Dt;w.u_up_dir=g.projection.upVector(new oc(0,0,0),P,O)}return w},mO=(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p,m,v,C,E)=>{return{u_matrix:e,u_normalize_matrix:t,u_globe_matrix:r,u_merc_matrix:s,u_grid_matrix:c,u_tl_parent:d,u_scale_parent:w,u_fade_t:P.mix,u_opacity:P.opacity*O.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:O.paint.get("raster-brightness-min"),u_brightness_high:O.paint.get("raster-brightness-max"),u_saturation_factor:(k=O.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(T=O.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:FS(O.paint.get("raster-hue-rotate")),u_perspective_transform:I,u_raster_elevation:A,u_tl_br:f,u_zoom_transition:g,u_merc_center:y,u_cutoff_params:b,u_colorization_mix:uM(u,m),u_colorization_offset:zS(p,m),u_color_ramp:l,u_texture_offset:[C/(v+2*C),v/(v+2*C)],u_texture_res:[v+2*C,v+2*C],u_emissive_strength:E};var T,k};function FS(e){e*=Math.PI/180;const t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}function uM([e,t,r,s],[c,d]){if(c===d)return[0,0,0,0];const f=259/257/(d-c);return[e*f,t*f,r*f,s*f]}function zS(e,[t,r]){return t===r?0:((e-t)/(r-t)*259-1)/257}const BS=bt.create(),US=(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p)=>{const m=c.transform,v={u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:m.getCameraToCenterDistance(l),u_rotate_symbol:+r,u_aspect_ratio:m.width/m.height,u_fade_change:c.options.fadeDuration?c.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:f,u_coord_matrix:g,u_is_text:+y,u_pitch_with_map:+s,u_texsize:b,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:BS,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:BS,u_up_vector:[0,-1,0],u_icon_transition:p||0,u_icon_saturation:u};return"globe"===l.name&&(v.u_tile_id=[w.canonical.x,w.canonical.y,1<<w.canonical.z],v.u_zoom_transition=P,v.u_inv_rot_matrix=I,v.u_merc_center=O,v.u_camera_forward=m._camera.forward(),v.u_ecef_origin=function(C,E){const T=[0,0,0],k=lf(Mi(E.canonical));return dt.transformMat4(T,T,k),dt.transformMat4(T,T,C),T}(m.globeMatrix,w.toUnwrapped()),v.u_tile_matrix=Float32Array.from(m.globeMatrix),v.u_up_vector=A),v},dM=(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u)=>_t(US(e,t,r,s,c,d,f,g,y,b,P,O,I,A,l,u,1),{u_gamma_scale:s?c.transform.getCameraToCenterDistance(u)*Math.cos(c.terrain?0:c.transform._pitch):1,u_device_pixel_ratio:Mn.devicePixelRatio,u_is_halo:+w,undefined:void 0}),Oy=(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l)=>_t(dM(e,t,r,s,c,d,f,g,!0,y,!0,w,P,O,I,A,l),{u_texsize_icon:b,u_texture_icon:1}),aI=(e,t,r,s)=>({u_matrix:e,u_emissive_strength:t,u_opacity:r,u_color:s}),Sm=(e,t,r,s,c,d,f)=>_t(function(g,y,b,w){const P=b.imageManager.getPattern(g.toString(),y),{width:O,height:I}=b.imageManager.getPixelSize(y),A=Math.pow(2,w.tileID.overscaledZ),l=w.tileSize*Math.pow(2,b.transform.tileZoom)/A,u=l*(w.tileID.canonical.x+w.tileID.wrap*A),p=l*w.tileID.canonical.y;return{u_image:0,u_pattern_tl:P.tl,u_pattern_br:P.br,u_texsize:[O,I],u_pattern_size:P.displaySize,u_tile_units_to_pixels:1/Ju(w,1,b.transform.tileZoom),u_pixel_coord_upper:[u>>16,p>>16],u_pixel_coord_lower:[65535&u,65535&p]}}(c,d,s,f),{u_matrix:e,u_emissive_strength:t,u_opacity:r}),js={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},lI=(e,t,r,s,c,d,f,g,y,b,w,P,O=[0,0,0])=>{const I=s.style.light,A=I.properties.get("position"),l=[-A.x,-A.y,A.z],u=sl.create();"viewport"===I.properties.get("anchor")&&(sl.fromRotation(u,-s.transform.angle),dt.transformMat3(l,l,u));const p="MASK"===b.alphaMode,m=I.properties.get("color"),v=P.paint.get("model-ambient-occlusion-intensity"),C=P.paint.get("model-color").constantOr(bn.white),E=P.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:e,u_lighting_matrix:t,u_normal_matrix:r,u_lightpos:l,u_lightintensity:I.properties.get("intensity"),u_lightcolor:[m.r,m.g,m.b],u_camera_pos:O,u_opacity:c,u_baseTextureIsAlpha:0,u_alphaMask:+p,u_alphaCutoff:b.alphaCutoff,u_baseColorFactor:[d.r,d.g,d.b,d.a],u_emissiveFactor:[f[0],f[1],f[2],1],u_metallicFactor:g,u_roughnessFactor:y,u_baseColorTexture:js.BaseColor,u_metallicRoughnessTexture:js.MetallicRoughness,u_normalTexture:js.Normal,u_occlusionTexture:js.Occlusion,u_emissionTexture:js.Emission,u_color_mix:[C.r,C.g,C.b,E],u_aoIntensity:v,u_emissive_strength:w}},hM=new Float32Array(16),Jp=(e,t=hM,r=hM)=>({u_matrix:e,u_instance:t,u_node_matrix:r}),Z1={fillExtrusion:e=>({u_matrix:new Vn(e),u_lightpos:new Kn(e),u_lightintensity:new fe(e),u_lightcolor:new Kn(e),u_vertical_gradient:new fe(e),u_opacity:new fe(e),u_edge_radius:new fe(e),u_ao:new fr(e),u_tile_id:new Kn(e),u_zoom_transition:new fe(e),u_inv_rot_matrix:new Vn(e),u_merc_center:new fr(e),u_up_dir:new Kn(e),u_height_lift:new fe(e),u_flood_light_color:new Kn(e),u_vertical_scale:new fe(e),u_flood_light_intensity:new fe(e),u_ground_shadow_factor:new Kn(e),u_emissive_strength:new fe(e)}),fillExtrusionDepth:e=>({u_matrix:new Vn(e),u_edge_radius:new fe(e),u_vertical_scale:new fe(e)}),fillExtrusionPattern:e=>({u_matrix:new Vn(e),u_lightpos:new Kn(e),u_lightintensity:new fe(e),u_lightcolor:new Kn(e),u_vertical_gradient:new fe(e),u_height_factor:new fe(e),u_edge_radius:new fe(e),u_ao:new fr(e),u_tile_id:new Kn(e),u_zoom_transition:new fe(e),u_inv_rot_matrix:new Vn(e),u_merc_center:new fr(e),u_up_dir:new Kn(e),u_height_lift:new fe(e),u_image:new cr(e),u_texsize:new fr(e),u_pixel_coord_upper:new fr(e),u_pixel_coord_lower:new fr(e),u_tile_units_to_pixels:new fe(e),u_opacity:new fe(e)}),fillExtrusionGroundEffect:e=>({u_matrix:new Vn(e),u_opacity:new fe(e),u_ao_pass:new fe(e),u_meter_to_tile:new fe(e),u_ao:new fr(e),u_flood_light_intensity:new fe(e),u_flood_light_color:new Kn(e),u_attenuation:new fe(e),u_edge_radius:new fe(e),u_fb:new cr(e),u_fb_size:new fe(e)}),fill:e=>({u_matrix:new Vn(e),u_emissive_strength:new fe(e)}),fillPattern:e=>({u_matrix:new Vn(e),u_emissive_strength:new fe(e),u_image:new cr(e),u_texsize:new fr(e),u_pixel_coord_upper:new fr(e),u_pixel_coord_lower:new fr(e),u_tile_units_to_pixels:new fe(e)}),fillOutline:e=>({u_matrix:new Vn(e),u_emissive_strength:new fe(e),u_world:new fr(e)}),fillOutlinePattern:e=>({u_matrix:new Vn(e),u_emissive_strength:new fe(e),u_world:new fr(e),u_image:new cr(e),u_texsize:new fr(e),u_pixel_coord_upper:new fr(e),u_pixel_coord_lower:new fr(e),u_tile_units_to_pixels:new fe(e)}),circle:e=>({u_camera_to_center_distance:new fe(e),u_extrude_scale:new M0(e),u_device_pixel_ratio:new fe(e),u_matrix:new Vn(e),u_inv_rot_matrix:new Vn(e),u_merc_center:new fr(e),u_tile_id:new Kn(e),u_zoom_transition:new fe(e),u_up_dir:new Kn(e),u_emissive_strength:new fe(e)}),collisionBox:e=>({u_matrix:new Vn(e),u_camera_to_center_distance:new fe(e),u_extrude_scale:new fr(e)}),collisionCircle:e=>({u_matrix:new Vn(e),u_inv_matrix:new Vn(e),u_camera_to_center_distance:new fe(e),u_viewport_size:new fr(e)}),debug:e=>({u_color:new h_(e),u_matrix:new Vn(e),u_overlay:new cr(e),u_overlay_scale:new fe(e)}),clippingMask:e=>({u_matrix:new Vn(e)}),heatmap:e=>({u_extrude_scale:new fe(e),u_intensity:new fe(e),u_matrix:new Vn(e),u_inv_rot_matrix:new Vn(e),u_merc_center:new fr(e),u_tile_id:new Kn(e),u_zoom_transition:new fe(e),u_up_dir:new Kn(e)}),heatmapTexture:e=>({u_image:new cr(e),u_color_ramp:new cr(e),u_opacity:new fe(e)}),hillshade:e=>({u_matrix:new Vn(e),u_image:new cr(e),u_latrange:new fr(e),u_light:new fr(e),u_shadow:new h_(e),u_highlight:new h_(e),u_emissive_strength:new fe(e),u_accent:new h_(e)}),hillshadePrepare:e=>({u_matrix:new Vn(e),u_image:new cr(e),u_dimension:new fr(e),u_zoom:new fe(e)}),line:e=>({u_matrix:new Vn(e),u_pixels_to_tile_units:new M0(e),u_device_pixel_ratio:new fe(e),u_units_to_pixels:new fr(e),u_dash_image:new cr(e),u_gradient_image:new cr(e),u_image_height:new fe(e),u_texsize:new fr(e),u_tile_units_to_pixels:new fe(e),u_alpha_discard_threshold:new fe(e),u_trim_offset:new fr(e),u_emissive_strength:new fe(e)}),linePattern:e=>({u_matrix:new Vn(e),u_texsize:new fr(e),u_pixels_to_tile_units:new M0(e),u_device_pixel_ratio:new fe(e),u_image:new cr(e),u_units_to_pixels:new fr(e),u_tile_units_to_pixels:new fe(e),u_alpha_discard_threshold:new fe(e)}),raster:e=>({u_matrix:new Vn(e),u_normalize_matrix:new Vn(e),u_globe_matrix:new Vn(e),u_merc_matrix:new Vn(e),u_grid_matrix:new fP(e),u_tl_parent:new fr(e),u_scale_parent:new fe(e),u_fade_t:new fe(e),u_opacity:new fe(e),u_image0:new cr(e),u_image1:new cr(e),u_brightness_low:new fe(e),u_brightness_high:new fe(e),u_saturation_factor:new fe(e),u_contrast_factor:new fe(e),u_spin_weights:new Kn(e),u_perspective_transform:new fr(e),u_raster_elevation:new fe(e),u_tl_br:new ic(e),u_zoom_transition:new fe(e),u_merc_center:new fr(e),u_cutoff_params:new ic(e),u_colorization_mix:new ic(e),u_colorization_offset:new fe(e),u_color_ramp:new cr(e),u_texture_offset:new fr(e),u_texture_res:new fr(e),u_emissive_strength:new fe(e)}),symbolIcon:e=>({u_is_size_zoom_constant:new cr(e),u_is_size_feature_constant:new cr(e),u_size_t:new fe(e),u_size:new fe(e),u_camera_to_center_distance:new fe(e),u_rotate_symbol:new cr(e),u_aspect_ratio:new fe(e),u_fade_change:new fe(e),u_matrix:new Vn(e),u_label_plane_matrix:new Vn(e),u_coord_matrix:new Vn(e),u_is_text:new cr(e),u_pitch_with_map:new cr(e),u_texsize:new fr(e),u_tile_id:new Kn(e),u_zoom_transition:new fe(e),u_inv_rot_matrix:new Vn(e),u_merc_center:new fr(e),u_camera_forward:new Kn(e),u_tile_matrix:new Vn(e),u_up_vector:new Kn(e),u_ecef_origin:new Kn(e),u_texture:new cr(e),u_icon_transition:new fe(e),u_icon_saturation:new fe(e)}),symbolSDF:e=>({u_is_size_zoom_constant:new cr(e),u_is_size_feature_constant:new cr(e),u_size_t:new fe(e),u_size:new fe(e),u_camera_to_center_distance:new fe(e),u_rotate_symbol:new cr(e),u_aspect_ratio:new fe(e),u_fade_change:new fe(e),u_matrix:new Vn(e),u_label_plane_matrix:new Vn(e),u_coord_matrix:new Vn(e),u_is_text:new cr(e),u_pitch_with_map:new cr(e),u_texsize:new fr(e),u_texture:new cr(e),u_gamma_scale:new fe(e),u_device_pixel_ratio:new fe(e),u_tile_id:new Kn(e),u_zoom_transition:new fe(e),u_inv_rot_matrix:new Vn(e),u_merc_center:new fr(e),u_camera_forward:new Kn(e),u_tile_matrix:new Vn(e),u_up_vector:new Kn(e),u_ecef_origin:new Kn(e),u_is_halo:new cr(e)}),symbolTextAndIcon:e=>({u_is_size_zoom_constant:new cr(e),u_is_size_feature_constant:new cr(e),u_size_t:new fe(e),u_size:new fe(e),u_camera_to_center_distance:new fe(e),u_rotate_symbol:new cr(e),u_aspect_ratio:new fe(e),u_fade_change:new fe(e),u_matrix:new Vn(e),u_label_plane_matrix:new Vn(e),u_coord_matrix:new Vn(e),u_is_text:new cr(e),u_pitch_with_map:new cr(e),u_texsize:new fr(e),u_texsize_icon:new fr(e),u_texture:new cr(e),u_texture_icon:new cr(e),u_gamma_scale:new fe(e),u_device_pixel_ratio:new fe(e),u_is_halo:new cr(e)}),background:e=>({u_matrix:new Vn(e),u_emissive_strength:new fe(e),u_opacity:new fe(e),u_color:new h_(e)}),backgroundPattern:e=>({u_matrix:new Vn(e),u_emissive_strength:new fe(e),u_opacity:new fe(e),u_image:new cr(e),u_pattern_tl:new fr(e),u_pattern_br:new fr(e),u_texsize:new fr(e),u_pattern_size:new fr(e),u_pixel_coord_upper:new fr(e),u_pixel_coord_lower:new fr(e),u_tile_units_to_pixels:new fe(e)}),terrainRaster:dO,terrainDepth:dO,skybox:e=>({u_matrix:new Vn(e),u_sun_direction:new Kn(e),u_cubemap:new cr(e),u_opacity:new fe(e),u_temporal_offset:new fe(e)}),skyboxGradient:e=>({u_matrix:new Vn(e),u_color_ramp:new cr(e),u_center_direction:new Kn(e),u_radius:new fe(e),u_opacity:new fe(e),u_temporal_offset:new fe(e)}),skyboxCapture:e=>({u_matrix_3f:new fP(e),u_sun_direction:new Kn(e),u_sun_intensity:new fe(e),u_color_tint_r:new ic(e),u_color_tint_m:new ic(e),u_luminance:new fe(e)}),globeRaster:e=>({u_proj_matrix:new Vn(e),u_globe_matrix:new Vn(e),u_normalize_matrix:new Vn(e),u_merc_matrix:new Vn(e),u_zoom_transition:new fe(e),u_merc_center:new fr(e),u_image0:new cr(e),u_grid_matrix:new fP(e),u_skirt_height:new fe(e),u_frustum_tl:new Kn(e),u_frustum_tr:new Kn(e),u_frustum_br:new Kn(e),u_frustum_bl:new Kn(e),u_globe_pos:new Kn(e),u_globe_radius:new fe(e),u_viewport:new fr(e)}),globeAtmosphere:e=>({u_frustum_tl:new Kn(e),u_frustum_tr:new Kn(e),u_frustum_br:new Kn(e),u_frustum_bl:new Kn(e),u_horizon:new fe(e),u_transition:new fe(e),u_fadeout_range:new fe(e),u_color:new ic(e),u_high_color:new ic(e),u_space_color:new ic(e),u_temporal_offset:new fe(e),u_horizon_angle:new fe(e)}),model:e=>({u_matrix:new Vn(e),u_lighting_matrix:new Vn(e),u_normal_matrix:new Vn(e),u_lightpos:new Kn(e),u_lightintensity:new fe(e),u_lightcolor:new Kn(e),u_camera_pos:new Kn(e),u_opacity:new fe(e),u_baseColorFactor:new ic(e),u_emissiveFactor:new ic(e),u_metallicFactor:new fe(e),u_roughnessFactor:new fe(e),u_baseTextureIsAlpha:new cr(e),u_alphaMask:new cr(e),u_alphaCutoff:new fe(e),u_baseColorTexture:new cr(e),u_metallicRoughnessTexture:new cr(e),u_normalTexture:new cr(e),u_occlusionTexture:new cr(e),u_emissionTexture:new cr(e),u_color_mix:new ic(e),u_aoIntensity:new fe(e),u_emissive_strength:new fe(e)}),modelDepth:e=>({u_matrix:new Vn(e),u_instance:new Vn(e),u_node_matrix:new Vn(e)}),groundShadow:e=>({u_matrix:new Vn(e),u_ground_shadow_factor:new Kn(e)}),stars:e=>({u_matrix:new Vn(e),u_up:new Kn(e),u_right:new Kn(e),u_intensity_multiplier:new fe(e)})};let W1;function fM(e,t,r,s,c,d,f){const g=e.context,y=g.gl,b=e.transform,w=e.getOrCreateProgram("collisionBox"),P=[];let O=0,I=0;for(let C=0;C<s.length;C++){const E=s[C],T=t.getTile(E),k=T.getBucket(r);if(!k)continue;const N=WC(E,k,b);let F=N;0===c[0]&&0===c[1]||(F=e.translatePosMatrix(N,T,c,d));const $=f?k.textCollisionBox:k.iconCollisionBox,q=k.collisionCircleArray;if(q.length>0){const Z=bt.create(),X=F;bt.mul(Z,k.placementInvProjMatrix,b.glCoordMatrix),bt.mul(Z,Z,k.placementViewportMatrix),P.push({circleArray:q,circleOffset:I,transform:X,invTransform:Z,projection:k.getProjection()}),O+=q.length/4,I=O}$&&(e.terrain&&e.terrain.setupElevationDraw(T,w),w.draw(e,y.LINES,Pn.disabled,Gn.disabled,e.colorModeForRenderPass(),Jn.disabled,aD(F,b,T,k.getProjection()),r.id,$.layoutVertexBuffer,$.indexBuffer,$.segments,null,b.zoom,null,[$.collisionVertexBuffer,$.collisionVertexBufferExt]))}if(!f||!P.length)return;const A=e.getOrCreateProgram("collisionCircle"),l=new y0;l.resize(4*O),l._trim();let u=0;for(const C of P)for(let E=0;E<C.circleArray.length/4;E++){const T=4*E,k=C.circleArray[T+0],N=C.circleArray[T+1],F=C.circleArray[T+2],$=C.circleArray[T+3];l.emplace(u++,k,N,F,$,0),l.emplace(u++,k,N,F,$,1),l.emplace(u++,k,N,F,$,2),l.emplace(u++,k,N,F,$,3)}(!W1||W1.length<2*O)&&(W1=function(C){const E=2*C,T=new Mo;T.resize(E),T._trim();for(let k=0;k<E;k++){const N=6*k;T.uint16[N+0]=4*k+0,T.uint16[N+1]=4*k+1,T.uint16[N+2]=4*k+2,T.uint16[N+3]=4*k+2,T.uint16[N+4]=4*k+3,T.uint16[N+5]=4*k+0}return T}(O));const p=g.createIndexBuffer(W1,!0),m=g.createVertexBuffer(l,Xw.members,!0);for(const C of P){const E={u_matrix:C.transform,u_inv_matrix:C.invTransform,u_camera_to_center_distance:(v=b).getCameraToCenterDistance(C.projection),u_viewport_size:[v.width,v.height]};A.draw(e,y.TRIANGLES,Pn.disabled,Gn.disabled,e.colorModeForRenderPass(),Jn.disabled,E,r.id,m,p,li.simpleSegment(0,2*C.circleOffset,C.circleArray.length,C.circleArray.length/2),null,b.zoom)}var v;m.destroy(),p.destroy()}const pM=bt.create();function K1({width:e,height:t,anchor:r,textOffset:s,textScale:c},d){const{horizontalAlign:f,verticalAlign:g}=Bv(r),y=-(f-.5)*e,b=-(g-.5)*t,w=em(r,s);return new tt((y/c+w[0])*d,(b/c+w[1])*d)}function cI(e,t,r,s,c,d,f,g,y,b,w){const P=e.text.placedSymbolArray,O=e.text.dynamicLayoutVertexArray,I=e.icon.dynamicLayoutVertexArray,A={},l=e.getProjection(),u=Fb(g,l,d),p=d.elevation,m=l.upVectorScale(g.canonical,d.center.lat,d.worldSize).metersToTile;O.clear();for(let v=0;v<P.length;v++){const C=P.get(v),{tileAnchorX:E,tileAnchorY:T,numGlyphs:k}=C,N=C.hidden||!C.crossTileID||e.allowVerticalPlacement&&!C.placedOrientation?null:s[C.crossTileID];if(N){let F=0,$=0,q=0;if(p){const yt=p?p.getAtTileOffset(g,E,T):0,[Ot,Tt,zt]=l.upVector(g.canonical,E,T);F=yt*Ot*m,$=yt*Tt*m,q=yt*zt*m}let[Z,X,K,J]=mc(C.projectedAnchorX+F,C.projectedAnchorY+$,C.projectedAnchorZ+q,r?u:f);const st=Qx(d.getCameraToCenterDistance(l),J);let ot=c.evaluateSizeForFeature(e.textSizeData,b,C)*st/is;r&&(ot*=e.tilePixelRatio/y);const rt=K1(N,ot);r?(({x:Z,y:X,z:K}=l.projectTilePoint(E+rt.x,T+rt.y,g.canonical)),[Z,X,K]=mc(Z+F,X+$,K+q,f)):(t&&rt._rotate(-d.angle),Z+=rt.x,X+=rt.y,K=0);const ct=e.allowVerticalPlacement&&C.placedOrientation===si.vertical?Math.PI/2:0;for(let yt=0;yt<k;yt++)uo(O,Z,X,K,ct);w&&C.associatedIconIndex>=0&&(A[C.associatedIconIndex]={x:Z,y:X,z:K,angle:ct})}else _c(k,O)}if(w){I.clear();const v=e.icon.placedSymbolArray;for(let C=0;C<v.length;C++){const E=v.get(C),{numGlyphs:T}=E,k=A[C];if(E.hidden||!k)_c(T,I);else{const{x:N,y:F,z:$,angle:q}=k;for(let Z=0;Z<T;Z++)uo(I,N,F,$,q)}}e.icon.dynamicLayoutVertexBuffer.updateData(I)}e.text.dynamicLayoutVertexBuffer.updateData(O)}function Ty(e,t,r){return r.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function Iy(e,t,r,s,c,d,f,g,y,b,w,P,O){const I=e.context,A=I.gl,l=e.transform,u="map"===g,p="map"===y,m=u&&"point"!==r.layout.get("symbol-placement"),v=u&&!p&&!m,C=void 0!==r.layout.get("symbol-sort-key").constantOr(1);let E=!1;const T=e.depthModeForSublayer(0,Pn.ReadOnly),k=[yo(l.center.lng),Pi(l.center.lat)],N=r.layout.get("text-variable-anchor"),F="globe"===l.projection.name,$=[],q=[0,-1,0];let Z=q;!F&&!l.mercatorFromTransition||u||(Z=function(X){const K=X._camera.getWorldToCamera(X.worldSize,1),J=bt.multiply([],K,X.globeMatrix);bt.invert(J,J);const st=[0,0,0],ot=[0,1,0,0];return kr.transformMat4(ot,ot,J),st[0]=ot[0],st[1]=ot[1],st[2]=ot[2],dt.normalize(st,st),st}(l));for(const X of s){const K=t.getTile(X),J=K.getBucket(r);if(!J||"mercator"===J.projection.name&&F)continue;const st=c?J.text:J.icon;if(!st||J.fullyClipped||!st.segments.get().length)continue;const ot=st.programConfigurations.get(r.id),rt=c||J.sdfIcons,ct=c?J.textSizeData:J.iconSizeData,yt=p||0!==l.pitch,Ot=co(ct,l.zoom);let Tt,zt,Nt,$t,Rt=[0,0],ie=null;if(c)zt=K.glyphAtlasTexture?K.glyphAtlasTexture:null,Nt=A.LINEAR,Tt=K.glyphAtlasTexture?K.glyphAtlasTexture.size:[0,0],J.iconsInText&&(Rt=K.imageAtlasTexture?K.imageAtlasTexture.size:[0,0],ie=K.imageAtlasTexture?K.imageAtlasTexture:null,$t=yt||e.options.rotating||e.options.zooming||"composite"===ct.kind||"camera"===ct.kind?A.LINEAR:A.NEAREST);else{const Gi=1!==r.layout.get("icon-size").constantOr(0)||J.iconsNeedLinear;zt=K.imageAtlasTexture?K.imageAtlasTexture:null,Nt=rt||e.options.rotating||e.options.zooming||Gi||yt?A.LINEAR:A.NEAREST,Tt=K.imageAtlasTexture?K.imageAtlasTexture.size:[0,0]}const Ee="globe"===J.projection.name,Oe=Ee?Z:q,Be=Ee?Po(l.zoom):0,je=Fb(X,J.getProjection(),l),En=l.calculatePixelsToTileUnitsMatrix(K),Qe=Ef(je,K.tileID.canonical,p,u,l,J.getProjection(),En),nr=e.terrain&&p&&m?bt.invert(bt.create(),Qe):pM,ln=dm(je,K.tileID.canonical,p,u,l,J.getProjection(),En),Ln=N&&J.hasTextData(),On=J.hasIconTextFit()&&Ln&&J.hasIconData();if(m){const Gi=l.elevation,Gr=Gi?Gi.getAtTileOffsetFunc(X,l.center.lat,l.worldSize,J.getProjection()):null,So=oy(je,K.tileID.canonical,p,u,l,J.getProjection(),En);yE(J,je,e,c,So,ln,p,b,Gr,X)}const mn=m||c&&N||On,wr=e.translatePosMatrix(je,K,d,f),Lr=mn?pM:Qe,rr=e.translatePosMatrix(ln,K,d,f,!0),Kr=J.getProjection().createInversionMatrix(l,X.canonical),Si=r.paint.get("icon-image-cross-fade").constantOr(0),gi=[];e.terrainRenderModeElevated()&&p&&gi.push("PITCH_WITH_MAP_TERRAIN"),Ee&&(gi.push("PROJECTION_GLOBE_VIEW"),mn&&gi.push("PROJECTED_POS_ON_VIEWPORT")),Si>0&&gi.push("ICON_TRANSITION"),st.zOffsetVertexBuffer&&gi.push("Z_OFFSET");const Ni=rt&&0!==r.paint.get(c?"text-halo-width":"icon-halo-width").constantOr(1);let $o;rt?$o=J.iconsInText?Oy(ct.kind,Ot,v,p,e,wr,Lr,rr,Tt,Rt,X,Be,k,Kr,Oe,J.getProjection()):dM(ct.kind,Ot,v,p,e,wr,Lr,rr,c,Tt,!0,X,Be,k,Kr,Oe,J.getProjection()):(w<1&&gi.push("SATURATION"),$o=US(ct.kind,Ot,v,p,e,wr,Lr,rr,c,Tt,X,Be,k,Kr,Oe,J.getProjection(),w,Si));const Io={program:e.getOrCreateProgram(Ty(rt,c,J),{config:ot,defines:gi}),buffers:st,uniformValues:$o,atlasTexture:zt,atlasTextureIcon:ie,atlasInterpolation:Nt,atlasInterpolationIcon:$t,isSDF:rt,hasHalo:Ni,tile:K,labelPlaneMatrixInv:nr};if(C&&J.canOverlap){E=!0;const Gi=st.segments.get();for(const Gr of Gi)$.push({segments:new li([Gr]),sortKey:Gr.sortKey,state:Io})}else $.push({segments:st.segments,sortKey:0,state:Io})}E&&$.sort((X,K)=>X.sortKey-K.sortKey);for(const X of $){const K=X.state;if(e.terrain&&e.terrain.setupElevationDraw(K.tile,K.program,{useDepthForOcclusion:l.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:K.labelPlaneMatrixInv}),I.activeTexture.set(A.TEXTURE0),K.atlasTexture&&K.atlasTexture.bind(K.atlasInterpolation,A.CLAMP_TO_EDGE),K.atlasTextureIcon&&(I.activeTexture.set(A.TEXTURE1),K.atlasTextureIcon&&K.atlasTextureIcon.bind(K.atlasInterpolationIcon,A.CLAMP_TO_EDGE)),e.uploadCommonLightUniforms(e.context,K.program),K.hasHalo){const J=K.uniformValues;J.u_is_halo=1,Am(K.buffers,X.segments,r,e,K.program,T,P,O,J,2),J.u_is_halo=0}else{if(K.isSDF){const J=K.uniformValues;K.hasHalo&&(J.u_is_halo=1,Am(K.buffers,X.segments,r,e,K.program,T,P,O,J,1)),J.u_is_halo=0}Am(K.buffers,X.segments,r,e,K.program,T,P,O,K.uniformValues,1)}}}function Am(e,t,r,s,c,d,f,g,y,b){const w=[e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer,e.iconTransitioningVertexBuffer,e.globeExtVertexBuffer,e.zOffsetVertexBuffer];c.draw(s,s.context.gl.TRIANGLES,d,f,g,Jn.disabled,y,r.id,e.layoutVertexBuffer,e.indexBuffer,t,r.paint,s.transform.zoom,e.programConfigurations.get(r.id),w,b)}function gM(e,t,r,s,c,d,f){const g=e.context.gl,y=r.paint.get("fill-pattern"),b=y&&y.constantOr(1);let w,P,O,I,A;f?(P=b&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",w=g.LINES):(P=b?"fillPattern":"fill",w=g.TRIANGLES);for(const l of s){const u=t.getTile(l);if(b&&!u.patternsLoaded())continue;const p=u.getBucket(r);if(!p)continue;e.prepareDrawTile();const m=p.programConfigurations.get(r.id),v=e.isTileAffectedByFog(l),C=e.getOrCreateProgram(P,{config:m,overrideFog:v});b&&(e.context.activeTexture.set(g.TEXTURE0),u.imageAtlasTexture&&u.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),m.updatePaintBuffers());const E=y.constantOr(null);if(E&&u.imageAtlas){const N=u.imageAtlas.patternPositions[E.toString()];N&&m.setConstantPatternPositions(N)}const T=e.translatePosMatrix(l.projMatrix,u,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor")),k=r.paint.get("fill-emissive-strength");if(f){I=p.indexBuffer2,A=p.segments2;const N=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[g.drawingBufferWidth,g.drawingBufferHeight];O="fillOutlinePattern"===P&&b?sI(T,k,e,u,N):Vs(T,k,N)}else I=p.indexBuffer,A=p.segments,O=b?oI(T,k,e,u):LS(T,k);e.uploadCommonUniforms(e.context,C,l.toUnwrapped()),C.draw(e,w,c,e.stencilModeForClipping(l),d,Jn.disabled,O,r.id,p.layoutVertexBuffer,I,A,r.paint,e.transform.zoom,m,void 0)}}function Sy(e,t,r,s,c,d,f,g){r.resetLayerRenderingStats();const y=e.context,b=y.gl,w=e.transform,P=r.paint.get("fill-extrusion-pattern"),O=P.constantOr(1),I=r.paint.get("fill-extrusion-opacity"),A=e.style.enable3dLights(),l=r.paint.get(A&&!O?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),u=[r.paint.get("fill-extrusion-ambient-occlusion-intensity"),l],p=r.layout.get("fill-extrusion-edge-radius"),m=p>0&&!r.paint.get("fill-extrusion-rounded-roof"),v=m?0:p,C="globe"===w.projection.name?a1():0,E="globe"===w.projection.name,T=E?Po(w.zoom):0,k=[yo(w.center.lng),Pi(w.center.lat)],N=r.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),F=r.paint.get("fill-extrusion-flood-light-intensity"),$=r.paint.get("fill-extrusion-vertical-scale"),q=Tm(e,r.paint.get("fill-extrusion-cutoff-fade-range")),Z=r.paint.get("fill-extrusion-emissive-strength"),X=[];let K;E&&X.push("PROJECTION_GLOBE_VIEW"),u[0]>0&&X.push("FAUX_AO"),m&&X.push("ZERO_ROOF_RADIUS"),g&&X.push("HAS_CENTROID"),F>0&&X.push("FLOOD_LIGHT"),q.shouldRenderCutoff&&X.push("RENDER_CUTOFF");const J="shadow"===e.renderPass,st=e.shadowRenderer,ot=J&&!!st;e.shadowRenderer&&(e.shadowRenderer.useNormalOffset=!0);let rt=[0,0,0];if(st){const Ot=e.style.directionalLight,Tt=e.style.ambientLight;Ot&&Tt&&(rt=xM(Ot,Tt)),K=X.concat(["SHADOWS_SINGLE_CASCADE"])}const ct=ot?"fillExtrusionDepth":O?"fillExtrusionPattern":"fillExtrusion",yt=r.getLayerRenderingStats();for(const Ot of s){const Tt=t.getTile(Ot),zt=Tt.getBucket(r);if(!zt||zt.projection.name!==w.projection.name)continue;let Nt=!1;st&&(Nt=0===st.getMaxCascadeForTile(Ot.toUnwrapped()));const $t=e.isTileAffectedByFog(Ot),Rt=zt.programConfigurations.get(r.id),ie=e.getOrCreateProgram(ct,{config:Rt,defines:Nt?K:X,overrideFog:$t});if(e.terrain&&e.terrain.setupElevationDraw(Tt,ie,{useMeterToDem:!0}),!zt.centroidVertexBuffer){const Qe=ie.attributes.a_centroid_pos;void 0!==Qe&&b.vertexAttrib2f(Qe,0,0)}!J&&st&&st.setupShadows(Tt.tileID.toUnwrapped(),ie,"vector-tile",Tt.tileID.overscaledZ),O&&(e.context.activeTexture.set(b.TEXTURE0),Tt.imageAtlasTexture&&Tt.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),Rt.updatePaintBuffers());const Ee=P.constantOr(null);if(Ee&&Tt.imageAtlas){const Qe=Tt.imageAtlas.patternPositions[Ee.toString()];Qe&&Rt.setConstantPatternPositions(Qe)}const Oe=r.paint.get("fill-extrusion-vertical-gradient");let Be;if(J&&st){if(vO(Tt.tileID,zt,e))continue;const Qe=st.calculateShadowPassMatrixFromTile(Tt.tileID.toUnwrapped());Be=sD(Qe,v,$)}else{const Qe=e.translatePosMatrix(Ot.expandedProjMatrix,Tt,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),nr=w.projection.createInversionMatrix(w,Ot.canonical);Be=O?jo(Qe,e,Oe,I,u,v,Ot,Tt,C,T,k,nr,N,$):iI(Qe,e,Oe,I,u,v,Ot,C,T,k,nr,N,$,F,rt,Z)}e.uploadCommonUniforms(y,ie,Ot.toUnwrapped(),null,q);let je=zt.segments;if("mercator"===w.projection.name&&!J&&(je=zt.getVisibleSegments(Tt.tileID,e.terrain,e.transform.getFrustum(0)),!je.get().length))continue;if(yt)if(J)for(const Qe of je.get())yt.numRenderedVerticesInShadowPass+=Qe.primitiveLength;else for(const Qe of je.get())yt.numRenderedVerticesInTransparentPass+=Qe.primitiveLength;const En=[];(e.terrain||g)&&En.push(zt.centroidVertexBuffer),E&&En.push(zt.layoutVertexExtBuffer),ie.draw(e,y.gl.TRIANGLES,c,d,f,Jn.backCCW,Be,r.id,zt.layoutVertexBuffer,zt.indexBuffer,je,r.paint,e.transform.zoom,Rt,En)}e.shadowRenderer&&(e.shadowRenderer.useNormalOffset=!1)}function Ay(e,t,r,s,c,d,f,g,y,b,w,P,O,I,A,l,u,p,m){const v=e.context,C=v.gl,E=e.transform,T=e.transform.zoom,k=[],N=Tm(e,r.paint.get("fill-extrusion-cutoff-fade-range"));"clear"===b?(k.push("CLEAR_SUBPASS"),m&&(k.push("CLEAR_FROM_TEXTURE"),v.activeTexture.set(C.TEXTURE0),m.bind(C.LINEAR,C.CLAMP_TO_EDGE))):"sdf"===b&&k.push("SDF_SUBPASS"),u&&k.push("HAS_CENTROID"),N.shouldRenderCutoff&&k.push("RENDER_CUTOFF");const F=r.layout.get("fill-extrusion-edge-radius"),$=(q,Z,X,K,J)=>{const st=Z.programConfigurations.get(r.id),ot=e.isTileAffectedByFog(q),rt=e.getOrCreateProgram("fillExtrusionGroundEffect",{config:st,defines:k,overrideFog:ot}),ct={u_matrix:K,u_opacity:w,u_ao_pass:y?1:0,u_meter_to_tile:J,u_ao:[P,O*J],u_flood_light_intensity:I,u_flood_light_color:A,u_attenuation:l,u_edge_radius:T>=17?0:F*J,u_fb:0,u_fb_size:m?m.size[0]:0},yt=[];u&&yt.push(Z.hiddenByLandmarkVertexBuffer),e.uploadCommonUniforms(v,rt,q.toUnwrapped(),null,N),rt.draw(e,v.gl.TRIANGLES,c,d,f,g,ct,r.id,Z.vertexBuffer,Z.indexBuffer,X,r.paint,T,st,yt)};for(const q of s){const Z=t.getTile(q),X=Z.getBucket(r);if(!X||X.projection.name!==E.projection.name||!X.groundEffect||X.groundEffect&&!X.groundEffect.hasData())continue;const K=X.groundEffect,J=1/X.tileToMeter;{const st=e.translatePosMatrix(q.projMatrix,Z,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),ot=K.getDefaultSegment();$(q,K,ot,st,J)}if(p)for(let st=0;st<4;st++){const ot=TP[st](q),rt=t.getTile(ot);if(!rt)continue;const ct=rt.getBucket(r);if(!ct||ct.projection.name!==E.projection.name||!ct.groundEffect||ct.groundEffect&&!ct.groundEffect.hasData())continue;const yt=ct.groundEffect;let Ot,Tt;0===st?(Ot=[-Dt,0,0],Tt=1):1===st?(Ot=[Dt,0,0],Tt=0):2===st?(Ot=[0,-Dt,0],Tt=3):(Ot=[0,Dt,0],Tt=2);const zt=yt.regionSegments[Tt];if(!zt)continue;const Nt=new Float32Array(16);bt.translate(Nt,q.projMatrix,Ot),$(q,yt,zt,e.translatePosMatrix(Nt,Z,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),J)}}}function uI(e,t,r,s,c,d,f){0===s.centroidVertexArray.length&&s.createCentroidsBuffer();const g=d?d.findDEMTileFor(r):null;if(!(g&&g.dem||f))return;const y=p=>{const m=t.getSource().minzoom,v=E=>{const T=t.getTileByID(E);if(T&&T.hasData())return T.getBucket(c)},C=[0,-1,1];for(const E of C){if(p.overscaledZ+E<m)continue;const T=v(p.calculateScaledKey(p.overscaledZ+E));if(T)return T}},b=[0,0,0],w=(p,m)=>(b[0]=Math.min(p.min.y,m.min.y),b[1]=Math.max(p.max.y,m.max.y),b[2]=Dt-m.min.x>p.max.x?m.min.x-Dt:p.max.x,b),P=(p,m)=>(b[0]=Math.min(p.min.x,m.min.x),b[1]=Math.max(p.max.x,m.max.x),b[2]=Dt-m.min.y>p.max.y?m.min.y-Dt:p.max.y,b),O=[(p,m)=>w(p,m),(p,m)=>w(m,p),(p,m)=>P(p,m),(p,m)=>P(m,p)],I=(p,m,v,C,E,T,k)=>{if(!d)return 0;const N=[[T?v:p,T?p:v,0],[T?v:m,T?m:v,0]],F=k<0?Dt+k:k,$=[T?F:(p+m)/2,T?(p+m)/2:F,0];return 0===v&&k<0||0!==v&&k>0?d.getForTilePoints(E,[$],!0,C):N.push($),d.getForTilePoints(r,N,!0,g),Math.max(N[0][2],N[1][2],$[2])/d.exaggeration()};for(let p=0;p<4;p++){const m=s.borderFeatureIndices[p];if(0===m.length)continue;const v=TP[p](r),C=y(v);if(!(C&&C instanceof gm)||s.borderDoneWithNeighborZ[p]===C.canonical.z)continue;0===C.centroidVertexArray.length&&C.createCentroidsBuffer();const E=d?d.findDEMTileFor(v):null;if(!(E&&E.dem||f))continue;const T=(p<2?1:5)-p,k=C.borderDoneWithNeighborZ[T]!==s.canonical.z,N=C.borderFeatureIndices[T];let F=0;if(s.canonical.z!==C.canonical.z){for(const $ of m)s.showCentroid(s.featuresOnBorder[$]);if(k)for(const $ of N)C.showCentroid(C.featuresOnBorder[$]);s.borderDoneWithNeighborZ[p]=C.canonical.z,C.borderDoneWithNeighborZ[T]=s.canonical.z}for(const $ of m){const q=s.featuresOnBorder[$],Z=s.centroidData[q.centroidDataIndex],X=q.borders[p];let K;for(;F<N.length;){K=C.featuresOnBorder[N[F]];const J=K.borders[T];if(J[1]>X[0]+3||J[0]>X[0]-3)break;C.showCentroid(K),F++}if(K&&F<N.length){const J=F;let st=0;for(;!(K.borders[T][0]>X[1]-3)&&(st++,++F!==N.length);)K=C.featuresOnBorder[N[F]];if(K=C.featuresOnBorder[N[J]],st>1){const ct=K.borders[T];Math.abs(X[0]-ct[0])<3&&Math.abs(X[1]-ct[1])<3&&(st=1,F=J+1)}else if(0===st){s.showCentroid(q);continue}const ot=C.centroidData[K.centroidDataIndex];f&&1===st&&(((l=Z).flags|(u=ot).flags)&If?(l.flags|=If,u.flags|=If):(l.flags&=2147483647,u.flags&=2147483647));let rt=new tt(0,0);if(st>1)F=J;else if(E&&E.dem&&!(q.intersectsCount()>1||K.intersectsCount()>1)){const ct=O[p](Z,ot),yt=p%2?Dt-1:0;A=I(ct[0],Math.min(Dt-1,ct[1]),yt,E,v,p<2,ct[2]),rt=new tt(Math.ceil(7*(A+450)),0)}Z.centroidXY=ot.centroidXY=rt,s.writeCentroidToBuffer(Z),C.writeCentroidToBuffer(ot)}else s.showCentroid(q)}s.borderDoneWithNeighborZ[p]=C.canonical.z,C.borderDoneWithNeighborZ[T]=s.canonical.z}var A,l,u;(s.needsCentroidUpdate||!s.centroidVertexBuffer&&0!==s.centroidVertexArray.length)&&s.uploadCentroid(e)}const dI=[1,0,0],_O=[0,1,0],yO=[0,0,1];function vO(e,t,r){const s=r.transform,c=r.shadowRenderer;if(!c)return!0;const d=e.toUnwrapped(),f=s.tileSize*c._cascades[r.currentShadowCascade].scale;let g=t.maxHeight;if(s.elevation){const l=s.elevation.getMinMaxForTile(e);l&&(g+=l.max)}const y=[...c.shadowDirection];y[2]=-y[2];const b=c.computeSimplifiedTileShadowVolume(d,g,f,y);if(!b)return!1;const w=[dI,_O,yO,y,[y[0],0,y[2]],[0,y[1],y[2]]],P="globe"===s.projection.name,O=s.scaleZoom(f),I=sc.fromInvProjectionMatrix(s.invProjMatrix,s.worldSize,O,!P),A=c.getCurrentCascadeFrustum();return 0===I.intersectsPrecise(b.vertices,b.planes,w)||0===A.intersectsPrecise(b.vertices,b.planes,w)}function Dm(e){const t=e._nearZ,r=e.projection.farthestPixelDistance(e),s=r-t,c=.2*e.height,d=t+c;return[t,r,(d-c-t)/s,(d-t)/s]}const bO=new bn(1,0,0,1),mM=new bn(0,1,0,1),$b=new bn(0,0,1,1),Gb=new bn(1,0,1,1),hI=new bn(0,1,1,1);function Hb(e,t,r){const s=e.context,c=e.transform,d=s.gl,f="globe"===c.projection.name,g=f?["PROJECTION_GLOBE_VIEW"]:[];let y=r.projMatrix;if(f&&Po(c.zoom)>0){const $=D_(SP(r.canonical,c));y=bt.multiply(new Float32Array(16),c.globeMatrix,$),bt.multiply(y,c.projMatrix,y)}const b=e.getOrCreateProgram("debug",{defines:g}),w=t.getTileByID(r.key);e.terrain&&e.terrain.setupElevationDraw(w,b);const P=Pn.disabled,O=Gn.disabled,I=e.colorModeForRenderPass(),A="$debug";s.activeTexture.set(d.TEXTURE0),e.emptyTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE),f?w._makeGlobeTileDebugBuffers(e.context,c):w._makeDebugTileBoundsBuffers(e.context,c.projection);const l=w._tileDebugBuffer||e.debugBuffer,u=w._tileDebugIndexBuffer||e.debugIndexBuffer,p=w._tileDebugSegments||e.debugSegments;b.draw(e,d.LINE_STRIP,P,O,I,Jn.disabled,NS(y,bn.red),A,l,u,p,null,null,null,[w._globeTileDebugBorderBuffer]);const m=w.latestRawTileData,v=Math.floor((m&&m.byteLength||0)/1024),C=t.getTile(r).tileSize,E=512/Math.min(C,512)*(r.overscaledZ/c.zoom)*.5;let T=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(T+=` => ${r.overscaledZ}`),T+=` ${v}kb`,function($,q){$.initDebugOverlayCanvas();const Z=$.debugOverlayCanvas,X=$.context.gl,K=$.debugOverlayCanvas.getContext("2d");K.clearRect(0,0,Z.width,Z.height),K.shadowColor="white",K.shadowBlur=2,K.lineWidth=1.5,K.strokeStyle="white",K.textBaseline="top",K.font="bold 36px Open Sans, sans-serif",K.fillText(q,5,5),K.strokeText(q,5,5),$.debugOverlayTexture.update(Z),$.debugOverlayTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE)}(e,T);const k=w._tileDebugTextBuffer||e.debugBuffer,N=w._tileDebugTextIndexBuffer||e.quadTriangleIndexBuffer,F=w._tileDebugTextSegments||e.debugSegments;b.draw(e,d.TRIANGLES,P,O,Sr.alphaBlended,Jn.disabled,NS(y,bn.transparent,E),A,k,N,F,null,null,null,[w._globeTileDebugTextBuffer])}function Dy(e,t,r,s){$s(e,0,t+r/2,e.transform.width,r,s)}function xO(e,t,r,s){$s(e,t-r/2,0,r,e.transform.height,s)}function $s(e,t,r,s,c,d){const f=e.context,g=f.gl;g.enable(g.SCISSOR_TEST),g.scissor(t*Mn.devicePixelRatio,r*Mn.devicePixelRatio,s*Mn.devicePixelRatio,c*Mn.devicePixelRatio),f.clear({color:d}),g.disable(g.SCISSOR_TEST)}const wO=Dr([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:qb}=wO;function kf(e,t,r,s){e.emplaceBack(t,r,s)}class _M{constructor(t){this.vertexArray=new Jy,this.indices=new Mo,kf(this.vertexArray,-1,-1,1),kf(this.vertexArray,1,-1,1),kf(this.vertexArray,-1,1,1),kf(this.vertexArray,1,1,1),kf(this.vertexArray,-1,-1,-1),kf(this.vertexArray,1,-1,-1),kf(this.vertexArray,-1,1,-1),kf(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,qb),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=li.simpleSegment(0,0,36,12)}}function Zb(e,t,r,s,c,d){const f=e.context.gl,g=t.paint.get("sky-atmosphere-color"),y=t.paint.get("sky-atmosphere-halo-color"),b=t.paint.get("sky-atmosphere-sun-intensity"),w={u_matrix_3f:sl.fromMat4(sl.create(),s),u_sun_direction:c,u_sun_intensity:b,u_color_tint_r:[(A=g).r,A.g,A.b,A.a],u_color_tint_m:[(l=y).r,l.g,l.b,l.a],u_luminance:5e-5};var A,l;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+d,t.skyboxTexture,0),r.draw(e,f.TRIANGLES,Pn.disabled,Gn.disabled,Sr.unblended,Jn.frontCW,w,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const CO=Dr([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class eu{constructor(t){const r=new fp;r.emplaceBack(-1,1,1,0,0),r.emplaceBack(1,1,1,1,0),r.emplaceBack(1,-1,1,1,1),r.emplaceBack(-1,-1,1,0,1);const s=new Mo;s.emplaceBack(0,1,2),s.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(r,CO.members),this.indexBuffer=t.createIndexBuffer(s),this.segments=li.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const fI=Dr([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class tg{constructor(){this.colorModeAlphaBlendedWriteRGB=new Sr([1,771,1,771],bn.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Sr([1,0,1,0],bn.transparent,[!1,!1,!1,!0])}update(t){const r=t.context;if(!this.atmosphereBuffer){this.atmosphereBuffer=new eu(r);const s=100,c=200,d=function(w){const P=Rh(30),O=[];for(let I=0;I<16e3;++I){const A=2*Math.PI*P(),l=Math.acos(1-2*P())-.5*Math.PI;O.push(dt.fromValues(Math.cos(l)*Math.cos(A),Math.cos(l)*Math.sin(A),Math.sin(l)))}return O}(),f=Rh(300),g=new fT,y=new Mo;let b=0;for(let w=0;w<d.length;++w){const P=dt.scale([],d[w],200),O=Math.max(0,1+.01*s*(1*f()-.5)),I=Math.max(0,1+.01*c*(1*f()-.5));g.emplaceBack(P[0],P[1],P[2],-1,-1,O,I),g.emplaceBack(P[0],P[1],P[2],1,-1,O,I),g.emplaceBack(P[0],P[1],P[2],1,1,O,I),g.emplaceBack(P[0],P[1],P[2],-1,1,O,I),y.emplaceBack(b+0,b+1,b+2),y.emplaceBack(b+0,b+2,b+3),b+=4}this.starsVx=r.createVertexBuffer(g,fI.members),this.starsIdx=r.createIndexBuffer(y),this.starsSegments=li.simpleSegment(0,0,g.length,y.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(t,r){const s=t.context,c=s.gl,d=t.transform,f=new Pn(c.LEQUAL,Pn.ReadOnly,[0,1]),g=Po(d.zoom),y=r.properties.get("color").toArray01(),b=r.properties.get("high-color").toArray01(),w=r.properties.get("space-color").toArray01PremultipliedAlpha(),P=5e-4,O=Ne((r.properties.get("horizon-blend")-0)/1*.2495+P,5e-4,.25),I=gv(t,s,d)&&O===P?d.worldSize/(2*Math.PI*1.025)-1:d.globeRadius,A=t.frameCounter/1e3%1,l=dt.length(d.globeCenterInViewSpace),u=Math.sqrt(Math.pow(l,2)-Math.pow(I,2)),p=Math.acos(u/l),m=v=>{const C="globe"===d.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];v&&C.push("ALPHA_PASS");const E=t.getOrCreateProgram("globeAtmosphere",{defines:C}),T={u_frustum_tl:d.frustumCorners.TL,u_frustum_tr:d.frustumCorners.TR,u_frustum_br:d.frustumCorners.BR,u_frustum_bl:d.frustumCorners.BL,u_horizon:d.frustumCorners.horizon,u_transition:g,u_fadeout_range:O,u_color:y,u_high_color:b,u_space_color:w,u_temporal_offset:A,u_horizon_angle:p};t.uploadCommonUniforms(s,E);const k=this.atmosphereBuffer;k&&E.draw(t,c.TRIANGLES,f,Gn.disabled,v?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Jn.backCW,T,v?"atmosphere_glow_alpha":"atmosphere_glow",k.vertexBuffer,k.indexBuffer,k.segments)};m(!1),m(!0)}drawStars(t,r){const s=Ne(r.properties.get("star-intensity"),0,1);if(0===s)return;const c=t.context,d=c.gl,f=t.transform,g=t.getOrCreateProgram("stars"),y=Bo.identity([]);Bo.rotateX(y,y,-f._pitch),Bo.rotateZ(y,y,-f.angle),Bo.rotateX(y,y,Ct(f._center.lat)),Bo.rotateY(y,y,-Ct(f._center.lng));const b=bt.fromQuat(new Float32Array(16),y),w=bt.multiply([],f.starsProjMatrix,b),P=sl.fromMat4([],b),O=sl.invert([],P),I=[0,1,0];dt.transformMat3(I,I,O),dt.scale(I,I,.15);const A=[1,0,0];dt.transformMat3(A,A,O),dt.scale(A,A,.15);const l=(p=I,m=A,v=s,{u_matrix:Float32Array.from(w),u_up:p,u_right:m,u_intensity_multiplier:v});var p,m,v;t.uploadCommonUniforms(c,g),this.starsVx&&this.starsIdx&&g.draw(t,d.TRIANGLES,Pn.disabled,Gn.disabled,this.colorModeAlphaBlendedWriteRGB,Jn.disabled,l,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function yM(e,t){const r=[...e],s=t.cameraWorldSizeForFog/t.worldSize,c=bt.identity([]);return bt.scale(c,c,[s,s,1]),bt.multiply(r,c,r),bt.multiply(r,t.worldToFogMatrix,r),r}function MO(e,t,r,s){const c=r.material,d=s.context,{baseColorTexture:f,metallicRoughnessTexture:g}=c.pbrMetallicRoughness,{normalTexture:y,occlusionTexture:b,emissionTexture:w}=c;function P(O,I,A){if(O&&(e.push(I),d.activeTexture.set(d.gl.TEXTURE0+A),O.gfxTexture)){const{minFilter:l,magFilter:u,wrapS:p,wrapT:m}=O.sampler;O.gfxTexture.bindExtraParam(l,u,p,m)}}P(f,"HAS_TEXTURE_u_baseColorTexture",js.BaseColor),P(g,"HAS_TEXTURE_u_metallicRoughnessTexture",js.MetallicRoughness),P(y,"HAS_TEXTURE_u_normalTexture",js.Normal),P(b,"HAS_TEXTURE_u_occlusionTexture",js.Occlusion),P(w,"HAS_TEXTURE_u_emissionTexture",js.Emission),r.texcoordBuffer&&(e.push("HAS_ATTRIBUTE_a_uv_2f"),t.push(r.texcoordBuffer)),r.colorBuffer&&(e.push(12===r.colorBuffer.itemSize?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),t.push(r.colorBuffer)),r.normalBuffer&&(e.push("HAS_ATTRIBUTE_a_normal_3f"),t.push(r.normalBuffer)),r.pbrBuffer&&(e.push("HAS_ATTRIBUTE_a_pbr"),e.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),t.push(r.pbrBuffer)),"OPAQUE"!==c.alphaMode&&"MASK"!==c.alphaMode||e.push("UNPREMULT_TEXTURE_IN_SHADER"),c.defined||e.push("DIFFUSE_SHADED"),e.push("USE_STANDARD_DERIVATIVES")}function Wb(e,t,r,s,c,d){const f=r.paint.get("model-opacity"),g=t.context,y=new Pn(t.context.gl.LEQUAL,Pn.ReadWrite,t.depthRangeFor3D),b=t.transform,w=e.mesh,P=w.material,O=P.pbrMetallicRoughness,I=t.style.fog;let A;A="pixels"===t.transform.projection.zAxisUnit?[...e.nodeModelMatrix]:bt.multiply([],s.zScaleMatrix,e.nodeModelMatrix),bt.multiply(A,s.negCameraPosMatrix,A);const l=bt.invert([],A);bt.transpose(l,l);const u=r.paint.get("model-emissive-strength").constantOr(0),p=lI(new Float32Array(e.worldViewProjection),new Float32Array(A),new Float32Array(l),t,f,O.baseColorFactor,P.emissiveFactor,O.metallicFactor,O.roughnessFactor,P,u,r),m={defines:[]},v=[];MO(m.defines,v,w,t);const C=t.shadowRenderer;C&&(C.useNormalOffset=!1);let E=null;if(I){const N=yM(e.nodeModelMatrix,t.transform);if(E=new Float32Array(N),"globe"!==b.projection.name){const F=w.aabb.min,$=w.aabb.max,[q,Z]=I.getOpacityForBounds(N,F[0],F[1],$[0],$[1]);m.overrideFog=q>=nd||Z>=nd}}const T=Tm(t,r.paint.get("model-cutoff-fade-range"));T.shouldRenderCutoff&&m.defines.push("RENDER_CUTOFF");const k=t.getOrCreateProgram("model",m);t.uploadCommonUniforms(g,k,null,E,T),"shadow"!==t.renderPass&&C&&C.setupShadowsFromMatrix(e.nodeModelMatrix,k),k.draw(t,g.gl.TRIANGLES,y,c,d,w.material.doubleSided?Jn.disabled:Jn.backCCW,p,r.id,w.vertexBuffer,w.indexBuffer,w.segments,r.paint,t.transform.zoom,void 0,v)}function PO(e,t,r,s,c,d,f){let g;g="globe"===e.projection.name?PC(r,e):[...r],bt.multiply(g,g,t.matrix);const y=bt.multiply([],s,g);if(t.meshes)for(const b of t.meshes){if("BLEND"!==b.material.alphaMode){f.push({mesh:b,depth:0,modelIndex:c,worldViewProjection:y,nodeModelMatrix:g});continue}const w=dt.transformMat4([],b.centroid,y);w[2]>0&&d.push({mesh:b,depth:w[2],modelIndex:c,worldViewProjection:y,nodeModelMatrix:g})}if(t.children)for(const b of t.children)PO(e,b,r,s,c,d,f)}function ky(e,t,r,s){const c=r.shadowRenderer;if(!c)return;const d=c.getShadowPassDepthMode(),f=c.getShadowPassColorMode(),g=c.calculateShadowPassMatrixFromMatrix(t),y=Jp(g);r.getOrCreateProgram("modelDepth",{defines:["DEPTH_TEXTURE"]}).draw(r,r.context.gl.TRIANGLES,d,Gn.disabled,f,Jn.backCCW,y,s.id,e.vertexBuffer,e.indexBuffer,e.segments,s.paint,r.transform.zoom,void 0,void 0)}function VS(e,t,r){const s=t.updateZoomBasedPaintProperties(),c=function(d,f,g){let y,b,w,P=d.terrain?d.terrain.exaggeration():0;if(d.terrain&&P>0){const O=d.terrain,I=O.findDEMTileFor(g);I&&I.dem?y=dc.create(O,g,I):P=0}if(0===P&&(f.terrainElevationMin=0,f.terrainElevationMax=0),P===f.validForExaggeration&&(0===P||y&&y._demTile&&y._demTile.tileID===f.validForDEMTile.id&&y._dem._timestamp===f.validForDEMTile.timestamp))return!1;for(const O in f.instancesPerModel){const I=f.instancesPerModel[O];for(let A=0;A<I.instancedDataArray.length;++A){const l=(y?P*y.getElevationAt(0|I.instancedDataArray.float32[16*A],0|I.instancedDataArray.float32[16*A+1],!0,!0):0)+I.instancesEvaluatedElevation[A];I.instancedDataArray.float32[16*A+6]=l,b=b?Math.min(f.terrainElevationMin,l):l,w=w?Math.max(f.terrainElevationMax,l):l}}return f.terrainElevationMin=b||0,f.terrainElevationMax=w||0,f.validForExaggeration=P,f.validForDEMTile=y&&y._demTile?{id:y._demTile.tileID,timestamp:y._dem._timestamp}:{id:void 0,timestamp:0},!0}(e,t,r);(s||c)&&(t.uploaded=!1,t.upload(e.context))}const Rf={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new _i([0,0,0],[Dt,Dt,0])};function Y1(e,t){const r=1<<e.canonical.z,s=t.getFreeCameraOptions().position,c=t.elevation,d=e.canonical.x/r,f=(e.canonical.x+1)/r,g=e.canonical.y/r,y=(e.canonical.y+1)/r;let b=t._centerAltitude;if(c){const I=c.getMinMaxForTile(e);I&&I.max>b&&(b=I.max)}const w=Ne(s.x,d,f)-s.x,P=Ne(s.y,g,y)-s.y,O=ii(b,t.center.lat)-s.z;return t._zoomFromMercatorZ(Math.sqrt(w*w+P*P+O*O))}function EO(e,t,r,s,c,d,f){const g=e.context,y="shadow"===e.renderPass,b=e.shadowRenderer,w=y&&b?b.getShadowPassDepthMode():new Pn(g.gl.LEQUAL,Pn.ReadWrite,e.depthRangeFor3D),P=e.isTileAffectedByFog(d);if(r.meshes)for(const O of r.meshes){const I=["MODEL_POSITION_ON_GPU"],A=[];let l,u,p;s.instancedDataArray.length>20&&I.push("INSTANCED_ARRAYS");const m=Tm(e,t.paint.get("model-cutoff-fade-range"));if(m.shouldRenderCutoff&&I.push("RENDER_CUTOFF"),y&&b)l=e.getOrCreateProgram("modelDepth",{defines:I}),u=Jp(f.shadowTileMatrix,f.shadowTileMatrix,Float32Array.from(r.matrix)),p=b.getShadowPassColorMode();else{MO(I,A,O,e),l=e.getOrCreateProgram("model",{defines:I,overrideFog:P});const C=O.material,E=C.pbrMetallicRoughness,T=t.paint.get("model-opacity"),k=t.paint.get("model-emissive-strength").constantOr(0);u=lI(d.expandedProjMatrix,Float32Array.from(r.matrix),new Float32Array(16),e,T,E.baseColorFactor,C.emissiveFactor,E.metallicFactor,E.roughnessFactor,C,k,t,c),b&&(f.shadowUniformsInitialized?l.setShadowUniformValues(g,b.getShadowUniformValues()):(b.setupShadows(d.toUnwrapped(),l,"model-tile",d.overscaledZ),f.shadowUniformsInitialized=!0)),p=m.shouldRenderCutoff||T<1||"OPAQUE"!==C.alphaMode?Sr.alphaBlended:Sr.unblended}e.uploadCommonUniforms(g,l,d.toUnwrapped(),null,m);const v=O.material.doubleSided?Jn.disabled:Jn.backCCW;if(s.instancedDataArray.length>20)A.push(s.instancedDataBuffer),l.draw(e,g.gl.TRIANGLES,w,Gn.disabled,p,v,u,t.id,O.vertexBuffer,O.indexBuffer,O.segments,t.paint,e.transform.zoom,void 0,A,s.instancedDataArray.length);else{const C=y?"u_instance":"u_normal_matrix";for(let E=0;E<s.instancedDataArray.length;++E)u[C]=new Float32Array(s.instancedDataArray.arrayBuffer,64*E,16),l.draw(e,g.gl.TRIANGLES,w,Gn.disabled,p,v,u,t.id,O.vertexBuffer,O.indexBuffer,O.segments,t.paint,e.transform.zoom,void 0,A)}}if(r.children)for(const O of r.children)EO(e,t,O,s,c,d,f)}const lD=[1,-1,1];function Kb(e,t,r,s){if(!r.modelManager)return!0;const c=r.modelManager;if(!r.shadowRenderer)return!0;const d=r.shadowRenderer,f=t.aabb;let g=!0,y=e.maxHeight;if(0===y){let w=0;for(const P in e.instancesPerModel){const O=c.getModel(P,s);O?w=Math.max(w,Math.max(Math.max(O.aabb.max[0],O.aabb.max[1]),O.aabb.max[2])):g=!1}y=e.maxScale*w*1.41+e.maxVerticalOffset,g&&(e.maxHeight=y)}f.max[2]=y,f.min[2]+=e.terrainElevationMin,f.max[2]+=e.terrainElevationMax,dt.transformMat4(f.min,f.min,t.tileMatrix),dt.transformMat4(f.max,f.max,t.tileMatrix);const b=f.intersects(d.getCurrentCascadeFrustum());return 0===r.currentShadowCascade&&(e.isInsideFirstShadowMapFrustum=2===b),0===b}class jS{}class pI{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(t,r,s){{const P=this._storage.get(r.id);if(P)return P.lastUsedFrameIdx=t,P.buf}const c=s.gl,d=c.getBufferParameter(c.ELEMENT_ARRAY_BUFFER,c.BUFFER_SIZE),f=new ArrayBuffer(d),g=new Int16Array(f);c.getBufferSubData(c.ELEMENT_ARRAY_BUFFER,0,new Int16Array(f));const y=new ku;for(let P=0;P<d/2;P+=3){const O=g[P],I=g[P+1],A=g[P+2];y.emplaceBack(O,I),y.emplaceBack(I,A),y.emplaceBack(A,O)}const b=s.bindVertexArrayOES.current,w=new jS;return w.buf=new om(s,y),w.lastUsedFrameIdx=t,this._storage.set(r.id,w),s.bindVertexArrayOES.set(b),w.buf}update(t){for(const[r,s]of this._storage)t-s.lastUsedFrameIdx>30&&(s.buf.destroy(),this._storage.delete(r))}destroy(){for(const[t,r]of this._storage)r.buf.destroy(),this._storage.delete(t)}}const OO={symbol:function(e,t,r,s,c){if("translucent"!==e.renderPass)return;const d=Gn.disabled,f=e.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(g,y,b,w,P,O,I){const A=y.transform,l="map"===P,u="map"===O;for(const p of g){const m=w.getTile(p),v=m.getBucket(b);if(!v||!v.text||!v.text.segments.get().length)continue;const C=co(v.textSizeData,A.zoom),E=Fb(p,v.getProjection(),A),T=A.calculatePixelsToTileUnitsMatrix(m),k=Ef(E,m.tileID.canonical,u,l,A,v.getProjection(),T),N=v.hasIconTextFit()&&v.hasIconData();if(C){const F=Math.pow(2,A.zoom-m.tileID.overscaledZ);cI(v,l,u,I,ST,A,k,p,F,C,N)}}}(s,e,r,t,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),c),0!==r.paint.get("icon-opacity").constantOr(1)&&Iy(e,t,r,s,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),r.paint.get("icon-color-saturation"),d,f),0!==r.paint.get("text-opacity").constantOr(1)&&Iy(e,t,r,s,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),r.paint.get("icon-color-saturation"),d,f),t.map.showCollisionBoxes&&(fM(e,t,r,s,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),fM(e,t,r,s,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))},circle:function(e,t,r,s){if("translucent"!==e.renderPass)return;const c=r.paint.get("circle-opacity"),d=r.paint.get("circle-stroke-width"),f=r.paint.get("circle-stroke-opacity"),g=void 0!==r.layout.get("circle-sort-key").constantOr(1),y=r.paint.get("circle-emissive-strength");if(0===c.constantOr(1)&&(0===d.constantOr(1)||0===f.constantOr(1)))return;const b=e.context,w=b.gl,P=e.transform,O=e.depthModeForSublayer(0,Pn.ReadOnly),I=Gn.disabled,A=e.colorModeForDrapableLayerRenderPass(y),l="globe"===P.projection.name,u=[yo(P.center.lng),Pi(P.center.lat)],p=[];for(let v=0;v<s.length;v++){const C=s[v],E=t.getTile(C),T=E.getBucket(r);if(!T||T.projection.name!==P.projection.name)continue;const k=T.programConfigurations.get(r.id),N=Ip(r),F=e.isTileAffectedByFog(C);l&&N.push("PROJECTION_GLOBE_VIEW");const $=e.getOrCreateProgram("circle",{config:k,defines:N,overrideFog:F}),q=T.layoutVertexBuffer,Z=T.globeExtVertexBuffer,X=T.indexBuffer,K=P.projection.createInversionMatrix(P,C.canonical),J={programConfiguration:k,program:$,layoutVertexBuffer:q,globeExtVertexBuffer:Z,indexBuffer:X,uniformValues:lc(e,C,E,K,u,r),tile:E};if(g){const st=T.segments.get();for(const ot of st)p.push({segments:new li([ot]),sortKey:ot.sortKey,state:J})}else p.push({segments:T.segments,sortKey:0,state:J})}g&&p.sort((v,C)=>v.sortKey-C.sortKey);const m={useDepthForOcclusion:P.depthOcclusionForSymbolsAndCircles};for(const v of p){const{programConfiguration:C,program:E,layoutVertexBuffer:T,globeExtVertexBuffer:k,indexBuffer:N,uniformValues:F,tile:$}=v.state,q=v.segments;e.terrain&&e.terrain.setupElevationDraw($,E,m),e.uploadCommonUniforms(b,E,$.tileID.toUnwrapped()),E.draw(e,w.TRIANGLES,O,I,A,Jn.disabled,F,r.id,T,N,q,r.paint,P.zoom,C,[k])}},heatmap:function(e,t,r,s){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const c=e.context,d=c.gl,f=Gn.disabled,g=new Sr([d.ONE,d.ONE,d.ONE,d.ONE],bn.transparent,[!0,!0,!0,!0]);(function(I,A,l,u){const p=I.gl,m=A.width*u,v=A.height*u;I.activeTexture.set(p.TEXTURE1),I.viewport.set([0,0,m,v]);let C=l.heatmapFbo;if(!C||C&&(C.width!==m||C.height!==v)){C&&C.destroy();const E=p.createTexture();p.bindTexture(p.TEXTURE_2D,E),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),C=l.heatmapFbo=I.createFramebuffer(m,v,!0,null),function(T,k,N,F,$,q){const Z=T.gl;Z.texImage2D(Z.TEXTURE_2D,0,T.extRenderToTextureHalfFloat?Z.RGBA16F:Z.RGBA,$,q,0,Z.RGBA,T.extRenderToTextureHalfFloat?Z.HALF_FLOAT:Z.UNSIGNED_BYTE,null),F.colorAttachment.set(N)}(I,0,E,C,m,v)}else p.bindTexture(p.TEXTURE_2D,C.colorAttachment.get()),I.bindFramebuffer.set(C.framebuffer)})(c,e,r,"globe"===e.transform.projection.name?.5:.25),c.clear({color:bn.transparent});const y=e.transform,b="globe"===y.projection.name,w=b?["PROJECTION_GLOBE_VIEW"]:[],P=b?Jn.frontCCW:Jn.disabled,O=[yo(y.center.lng),Pi(y.center.lat)];for(let I=0;I<s.length;I++){const A=s[I];if(t.hasRenderableParent(A))continue;const l=t.getTile(A),u=l.getBucket(r);if(!u||u.projection.name!==y.projection.name)continue;const p=e.isTileAffectedByFog(A),m=u.programConfigurations.get(r.id),v=e.getOrCreateProgram("heatmap",{config:m,defines:w,overrideFog:p}),{zoom:C}=e.transform;e.terrain&&e.terrain.setupElevationDraw(l,v),e.uploadCommonUniforms(c,v,A.toUnwrapped());const E=y.projection.createInversionMatrix(y,A.canonical);v.draw(e,d.TRIANGLES,Pn.disabled,f,g,P,gO(e,A,l,E,O,C,r.paint.get("heatmap-intensity")),r.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,r.paint,e.transform.zoom,m,b?[u.globeExtVertexBuffer]:null)}c.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(c,d){const f=c.context,g=f.gl,y=d.heatmapFbo;if(!y)return;f.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,y.colorAttachment.get()),f.activeTexture.set(g.TEXTURE1);let b=d.colorRampTexture;b||(b=d.colorRampTexture=new bi(f,d.colorRamp,g.RGBA)),b.bind(g.LINEAR,g.CLAMP_TO_EDGE),c.getOrCreateProgram("heatmapTexture").draw(c,g.TRIANGLES,Pn.disabled,Gn.disabled,c.colorModeForRenderPass(),Jn.disabled,{u_image:0,u_color_ramp:1,u_opacity:d.paint.get("heatmap-opacity")},d.id,c.viewportBuffer,c.quadTriangleIndexBuffer,c.viewportSegments,d.paint,c.transform.zoom)}(e,r))},line:function(e,t,r,s){if("translucent"!==e.renderPass)return;const c=r.paint.get("line-opacity"),d=r.paint.get("line-width");if(0===c.constantOr(1)||0===d.constantOr(1))return;const f=r.paint.get("line-emissive-strength"),g=e.depthModeForSublayer(0,Pn.ReadOnly),y=e.colorModeForDrapableLayerRenderPass(f),b=e.terrain&&e.terrain.renderingToTexture?1:Mn.devicePixelRatio,w=r.paint.get("line-dasharray"),P=w.constantOr(1),O=r.layout.get("line-cap"),I=r.paint.get("line-pattern"),A=I.constantOr(1),l=r.paint.get("line-pattern").constantOr(1),u=1!==r.paint.get("line-opacity").constantOr(1);let p=!l&&u;const m=r.paint.get("line-gradient"),v=A?"linePattern":"line",C=e.context,E=C.gl,T=DE(r);e.terrain&&e.terrain.clipOrMaskOverlapStencilType()&&(p=!1);for(const k of s){const N=t.getTile(k);if(A&&!N.patternsLoaded())continue;const F=N.getBucket(r);if(!F)continue;e.prepareDrawTile();const $=F.programConfigurations.get(r.id),q=e.isTileAffectedByFog(k),Z=e.getOrCreateProgram(v,{config:$,defines:T,overrideFog:q}),X=I.constantOr(null);if(X&&N.imageAtlas){const Ot=N.imageAtlas.patternPositions[X.toString()];Ot&&$.setConstantPatternPositions(Ot)}const K=w.constantOr(null),J=O.constantOr(null);if(!A&&K&&J&&N.lineAtlas){const Ot=N.lineAtlas.getDash(K,J);Ot&&$.setConstantPatternPositions(Ot)}let[st,ot]=r.paint.get("line-trim-offset");("round"===J||"square"===J)&&st!==ot&&(0===st&&(st-=1),1===ot&&(ot+=1));const rt=e.terrain?k.projMatrix:null,ct=A?AE(e,N,r,rt,b):GT(e,N,r,rt,F.lineClipsArray.length,b,[st,ot]);if(m){const Ot=F.gradients[r.id];let Tt=Ot.texture;if(r.gradientVersion!==Ot.version){let zt=256;if(r.stepInterpolant){const Nt=t.getSource().maxzoom,$t=k.canonical.z===Nt?Math.ceil(1<<e.transform.maxZoom-k.canonical.z):1;zt=Ne(wi(F.maxLineLength/Dt*1024*$t),256,C.maxTextureSize)}Ot.gradient=jw({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:zt,image:Ot.gradient||void 0,clips:F.lineClipsArray}),Ot.texture?Ot.texture.update(Ot.gradient):Ot.texture=new bi(C,Ot.gradient,E.RGBA),Ot.version=r.gradientVersion,Tt=Ot.texture}C.activeTexture.set(E.TEXTURE1),Tt.bind(r.stepInterpolant?E.NEAREST:E.LINEAR,E.CLAMP_TO_EDGE)}P&&(C.activeTexture.set(E.TEXTURE0),N.lineAtlasTexture&&N.lineAtlasTexture.bind(E.LINEAR,E.REPEAT),$.updatePaintBuffers()),A&&(C.activeTexture.set(E.TEXTURE0),N.imageAtlasTexture&&N.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),$.updatePaintBuffers()),e.uploadCommonUniforms(C,Z,k.toUnwrapped());const yt=Ot=>{Z.draw(e,E.TRIANGLES,g,Ot,y,Jn.disabled,ct,r.id,F.layoutVertexBuffer,F.indexBuffer,F.segments,r.paint,e.transform.zoom,$,[F.layoutVertexBuffer2])};if(p){const Ot=e.stencilModeForClipping(k).ref;0===Ot&&e.terrain&&C.clear({stencil:0});const Tt={func:E.EQUAL,mask:255};ct.u_alpha_discard_threshold=.8,yt(new Gn(Tt,Ot,255,E.KEEP,E.KEEP,E.INVERT)),ct.u_alpha_discard_threshold=0,yt(new Gn(Tt,Ot,255,E.KEEP,E.KEEP,E.KEEP))}else yt(e.stencilModeForClipping(k))}p&&(e.resetStencilClippingMasks(),e.terrain&&C.clear({stencil:0}))},fill:function(e,t,r,s){const c=r.paint.get("fill-color"),d=r.paint.get("fill-opacity");if(0===d.constantOr(1))return;const f=r.paint.get("fill-emissive-strength"),g=e.colorModeForDrapableLayerRenderPass(f),y=r.paint.get("fill-pattern"),b=e.opaquePassEnabledForLayer()&&!y.constantOr(1)&&1===c.constantOr(bn.transparent).a&&1===d.constantOr(0)?"opaque":"translucent";if(e.renderPass===b){const w=e.depthModeForSublayer(1,"opaque"===e.renderPass?Pn.ReadWrite:Pn.ReadOnly);gM(e,t,r,s,w,g,!1)}if("translucent"===e.renderPass&&r.paint.get("fill-antialias")){const w=e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Pn.ReadOnly);gM(e,t,r,s,w,g,!0)}},"fill-extrusion":function(e,t,r,s){const c=r.paint.get("fill-extrusion-opacity"),d=e.context,f=d.gl,g=e.terrain,y=g&&g.renderingToTexture,b=r.paint.get("fill-extrusion-cutoff-fade-range");if(0===c)return;const w=e.conflationActive&&e.layerUsedInConflation(r,t.getSource());if(w&&function(P,O,I,A){for(const l of A){const u=O.getTile(l).getBucket(I);u&&(u.updateReplacement(l,P.replacementSource),u.uploadCentroid(P.context))}}(e,t,r,s),g||w)for(const P of s){const O=t.getTile(P).getBucket(r);O&&uI(e.context,t,P,O,r,g,w)}if("shadow"===e.renderPass&&e.shadowRenderer){const P=e.shadowRenderer;if(g&&c<.65&&r._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof Os)return;const O=P.getShadowPassDepthMode(),I=P.getShadowPassColorMode();Sy(e,t,r,s,O,Gn.disabled,I,w)}else if("translucent"===e.renderPass){const P=!r.paint.get("fill-extrusion-pattern").constantOr(1);if(!y){const O=new Pn(e.context.gl.LEQUAL,Pn.ReadWrite,e.depthRangeFor3D);0===b&&1===c&&P?Sy(e,t,r,s,O,Gn.disabled,Sr.unblended,w):(Sy(e,t,r,s,O,Gn.disabled,Sr.disabled,w),Sy(e,t,r,s,O,e.stencilModeFor3D(),e.colorModeForRenderPass(),w),e.resetStencilClippingMasks())}if(e.style.enable3dLights()&&P&&(!g&&"globe"!==e.transform.projection.name||y)){const O=r.paint.get("fill-extrusion-opacity"),I=r.paint.get("fill-extrusion-ambient-occlusion-intensity"),A=r.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),l=r.paint.get("fill-extrusion-flood-light-intensity"),u=r.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),p=I>0&&A>0,m=l>0,v=(E,T,k)=>(1-k)*E+k*T,C=E=>{const T=e.depthModeForSublayer(1,Pn.ReadOnly,f.LEQUAL,!0),k=r.paint.get(E?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),N=v(.1,3,k),F=e._showOverdrawInspector;if(!F){const $=new Gn({func:f.ALWAYS,mask:255},255,255,f.KEEP,f.KEEP,f.REPLACE),q=new Sr([f.ONE,f.ONE,f.ONE,f.ONE],bn.transparent,[!1,!1,!1,!0],f.MIN);Ay(e,t,r,s,T,$,q,Jn.disabled,E,"sdf",O,I,A,l,u,N,w,!1)}{const $=F?Gn.disabled:new Gn({func:f.EQUAL,mask:255},255,255,f.KEEP,f.DECR,f.DECR),q=F?e.colorModeForRenderPass():new Sr([f.ONE_MINUS_DST_ALPHA,f.DST_ALPHA,f.ONE,f.ONE],bn.transparent,[!0,!0,!0,!0]);Ay(e,t,r,s,T,$,q,Jn.disabled,E,"color",O,I,A,l,u,N,w,!1)}};if(y){const E=(T,k,N)=>{const F=e.depthModeForSublayer(1,Pn.ReadOnly,f.LEQUAL,!1),$=r.paint.get(T?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),q=v(.1,3,$);{const Z=new Sr([f.ONE,f.ONE,f.ONE,f.ONE],bn.transparent,[!1,!1,!1,!0]);Ay(e,t,r,s,F,Gn.disabled,Z,Jn.disabled,T,"clear",O,I,A,l,u,q,w,k)}{const Z=new Gn({func:f.ALWAYS,mask:255},255,255,f.KEEP,f.KEEP,f.REPLACE),X=new Sr([f.ONE,f.ONE,f.ONE,f.ONE],bn.transparent,[!1,!1,!1,!0],f.MIN);Ay(e,t,r,s,F,Z,X,Jn.disabled,T,"sdf",O,I,A,l,u,q,w,k)}{const Z=T?f.ZERO:f.ONE_MINUS_DST_ALPHA,X=new Gn({func:f.EQUAL,mask:255},255,255,f.KEEP,f.DECR,f.DECR),K=new Sr([Z,f.DST_ALPHA,f.ONE_MINUS_DST_ALPHA,f.ZERO],bn.transparent,[!0,!0,!0,!0]);Ay(e,t,r,s,F,X,K,Jn.disabled,T,"color",O,I,A,l,u,q,w,k)}{const Z=new Sr([f.ONE,f.ONE,f.ONE,T?f.ZERO:f.ONE],bn.transparent,[!1,!1,!1,!0],T?f.FUNC_ADD:f.MAX);Ay(e,t,r,s,F,Gn.disabled,Z,Jn.disabled,T,"clear",O,I,A,l,u,q,w,k,N)}};if(p||m){let T;if(e.prepareDrawTile(),g){const k=g.drapeBufferSize[0],N=g.drapeBufferSize[1];T=g.framebufferCopyTexture,T&&(!T||T.size[0]===k&&T.size[1]===N)||(T&&T.destroy(),T=g.framebufferCopyTexture=new bi(d,new Uo({width:k,height:N}),f.RGBA)),T.bind(f.LINEAR,f.CLAMP_TO_EDGE),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGBA,0,0,k,N,0)}p&&E(!0,!1,T),m&&E(!1,!0,T)}}else p&&C(!0),m&&C(!1)}}},hillshade:function(e,t,r,s){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass||e.style.disableElevatedTerrain)return;const c=e.context,d=e.terrain&&e.terrain.renderingToTexture,[f,g]="translucent"!==e.renderPass||d?[{},s]:e.stencilConfigForOverlap(s);for(const y of g){const b=t.getTile(y);if(b.needsHillshadePrepare&&"offscreen"===e.renderPass)uO(e,b,r);else if("translucent"===e.renderPass){const w=e.depthModeForSublayer(0,Pn.ReadOnly),P=r.paint.get("hillshade-emissive-strength"),O=e.colorModeForDrapableLayerRenderPass(P),I=d&&e.terrain?e.terrain.stencilModeForRTTOverlap(y):f[y.overscaledZ];oM(e,y,b,r,w,I,O)}}c.viewport.set([0,0,e.width,e.height]),e.resetStencilClippingMasks()},raster:function(e,t,r,s,c,d){if("translucent"!==e.renderPass||0===r.paint.get("raster-opacity"))return;const f=e.context,g=f.gl,y=t.getSource(),b=function(k,N,F){const $=k.paint.get("raster-color"),q=[],Z=k.paint.get("raster-resampling"),X=k.paint.get("raster-color-mix"),K=k.paint.get("raster-color-range"),J=[X[0],X[1],X[2],0],st=X[3],ot="nearest"===Z?F.NEAREST:F.LINEAR;if($&&q.push("RASTER_COLOR"),$){N.activeTexture.set(F.TEXTURE2);let rt=k.colorRampTexture;rt||(rt=k.colorRampTexture=new bi(N,k.colorRamp,F.RGBA)),rt.bind(F.LINEAR,F.CLAMP_TO_EDGE)}return{mix:J,range:K,offset:st,defines:q,resampling:ot}}(r,f,g),w=b.defines,P="globe"===e.transform.projection.name;let O=!1;if(y instanceof Qc&&!s.length){if(!P)return;if(y.onNorthPole)O=!0,w.push("GLOBE_POLES");else{if(!y.onSouthPole)return;O=!0,w.push("GLOBE_POLES")}}const I=r.paint.get("raster-emissive-strength"),A=e.colorModeForDrapableLayerRenderPass(I),l=e.terrain&&e.terrain.renderingToTexture,u=y instanceof Qc&&0!==r.paint.get("raster-elevation"),p=!e.options.moving,m="nearest"===r.paint.get("raster-resampling")?g.NEAREST:g.LINEAR;if(O){const k=t.getSource();if(!(k instanceof Qc))return;const N=k.texture;if(!N)return;const F=e.globeSharedBuffers;if(!F)return;const $=new Pn(g.LEQUAL,Pn.ReadWrite,e.depthRangeFor3D),q=Float32Array.from(e.transform.expandedFarZProjMatrix);let Z=AP(0,0,e.transform);const X=Float32Array.from(lf(Mi(new oc(0,0,0)))),K={opacity:1,mix:0};e.terrain&&e.terrain.prepareDrawTile(),f.activeTexture.set(g.TEXTURE0),N.bind(m,g.CLAMP_TO_EDGE),f.activeTexture.set(g.TEXTURE1),N.bind(m,g.CLAMP_TO_EDGE),N.useMipmap&&f.extTextureFilterAnisotropic&&e.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f.extTextureFilterAnisotropicMax);const[J,st,ot,rt]=F.getPoleBuffers(0,!0);let ct;k.onNorthPole?(ct=J,e.renderDefaultNorthPole=!1):(Z=bt.scale(bt.create(),Z,[1,-1,1]),ct=st,e.renderDefaultSouthPole=!1);const yt=(Tt=q,zt=X,Nt=Z,$t=K,Rt=r,ie=k.perspectiveTransform||[0,0],Ee=r.paint.get("raster-elevation"),Be=b.mix,je=b.offset,En=b.range,Qe=I,mO(Tt,zt,Nt,new Float32Array(16),new Float32Array(9),[0,0],[0,0,0,0],0,[0,0],[0,0,0,0],1,$t,Rt,ie||[0,0],Ee,2,Be,je,En,1,0,Qe)),Ot=e.getOrCreateProgram("raster",{defines:b.defines});return e.uploadCommonUniforms(f,Ot,null),void Ot.draw(e,g.TRIANGLES,$,Gn.disabled,A,Jn.disabled,yt,r.id,ct,ot,rt)}var Tt,zt,Nt,$t,Rt,ie,Ee,Be,je,En,Qe;if(!s.length)return;const[v,C]=y instanceof Qc||l?[{},s]:e.stencilConfigForOverlap(s),E=C[C.length-1].overscaledZ,T=u&&P;T&&b.defines.push("PROJECTION_GLOBE_VIEW"),u&&b.defines.push("RENDER_CUTOFF");for(const k of C){const N=k.toUnwrapped(),F=t.getTile(k);if(l&&(!F||!F.hasData())||!F.texture)continue;let $,q;l?($=Pn.disabled,q=k.projMatrix):u?($=new Pn(g.LEQUAL,Pn.ReadWrite,e.depthRangeFor3D),q=P?Float32Array.from(e.transform.expandedFarZProjMatrix):e.transform.calculateProjMatrix(N,p)):($=e.depthModeForSublayer(k.overscaledZ-E,1===r.paint.get("raster-opacity")?Pn.ReadWrite:Pn.ReadOnly,g.LESS),q=e.transform.calculateProjMatrix(N,p));const Z=e.terrain&&l?e.terrain.stencilModeForRTTOverlap(k):v[k.overscaledZ],X=d?0:r.paint.get("raster-fade-duration");F.registerFadeDuration(X);const K=t.findLoadedParent(k,0),J=fO(F,K,t,e.transform,X);let st,ot;e.terrain&&e.terrain.prepareDrawTile(),f.activeTexture.set(g.TEXTURE0),F.texture&&F.texture.bind(m,g.CLAMP_TO_EDGE),f.activeTexture.set(g.TEXTURE1),K?(K.texture&&K.texture.bind(m,g.CLAMP_TO_EDGE),st=Math.pow(2,K.tileID.overscaledZ-F.tileID.overscaledZ),ot=[F.tileID.canonical.x*st%1,F.tileID.canonical.y*st%1]):F.texture&&F.texture.bind(m,g.CLAMP_TO_EDGE),F.texture&&F.texture.useMipmap&&f.extTextureFilterAnisotropic&&e.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f.extTextureFilterAnisotropicMax);const rt=e.transform,ct=y instanceof Qc?y.perspectiveTransform:[0,0],yt=u?Dm(rt):[0,0,0,0];let Ot,Tt,zt,Nt,$t,Rt;if(T&&y instanceof Qc&&y.coordinates.length>3){Ot=Float32Array.from(lf(Mi(new oc(0,0,0)))),Tt=Float32Array.from(rt.globeMatrix),zt=Float32Array.from(ux(rt)),Nt=[yo(rt.center.lng),Pi(rt.center.lat)],Rt=[yo(y.coordinates[1][0]),Pi(y.coordinates[1][1]),yo(y.coordinates[3][0]),Pi(y.coordinates[3][1])];const Be=new Xi(y.coordinates[1],y.coordinates[3]);$t=Float32Array.from(mv(new oc(0,0,0),Be,0,rt.worldSize/e.transform._pixelsPerMercatorPixel))}else Ot=new Float32Array(16),Tt=new Float32Array(9),zt=new Float32Array(16),Nt=[0,0],$t=new Float32Array(16),Rt=[0,0,0,0];const ie=mO(q,Ot,Tt,zt,$t,ot||[0,0],Rt,Po(e.transform.zoom),Nt,yt,st||1,J,r,ct,u?r.paint.get("raster-elevation"):0,2,b.mix,b.offset,b.range,1,0,I),Ee=e.isTileAffectedByFog(k),Oe=e.getOrCreateProgram("raster",{defines:b.defines,overrideFog:Ee});if(e.uploadCommonUniforms(f,Oe,N),y instanceof Qc){if(l||!P)y.boundsBuffer&&y.boundsSegments&&Oe.draw(e,g.TRIANGLES,$,Gn.disabled,A,Jn.disabled,ie,r.id,y.boundsBuffer,e.quadTriangleIndexBuffer,y.boundsSegments);else if(e.globeSharedBuffers){const[Be,je,En]=e.globeSharedBuffers.getGridBuffers(0,!1);Oe.draw(e,g.TRIANGLES,$,Gn.disabled,A,Jn.frontCCW,ie,r.id,Be,je,En),Oe.draw(e,g.TRIANGLES,$,Gn.disabled,A,Jn.backCCW,ie,r.id,Be,je,En)}}else{const{tileBoundsBuffer:Be,tileBoundsIndexBuffer:je,tileBoundsSegments:En}=e.getTileBoundsBuffers(F);Oe.draw(e,g.TRIANGLES,$,Z,A,Jn.disabled,ie,r.id,Be,je,En)}}e.resetStencilClippingMasks()},background:function(e,t,r,s){const c=r.paint.get("background-color"),d=r.paint.get("background-opacity"),f=r.paint.get("background-emissive-strength");if(0===d)return;const g=e.context,y=g.gl,b=e.transform,w=b.tileSize,P=r.paint.get("background-pattern");if(e.isPatternMissing(P,r.scope))return;const O=!P&&1===c.a&&1===d&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==O)return;const I=Gn.disabled,A=e.depthModeForSublayer(0,"opaque"===O?Pn.ReadWrite:Pn.ReadOnly),l=e.colorModeForDrapableLayerRenderPass(f),u=P?"backgroundPattern":"background";let p,m=s;m||(p=e.getBackgroundTiles(),m=Object.values(p).map(v=>v.tileID)),P&&(g.activeTexture.set(y.TEXTURE0),e.imageManager.bind(e.context,r.scope));for(const v of m){const C=e.isTileAffectedByFog(v),E=e.getOrCreateProgram(u,{overrideFog:C}),T=v.toUnwrapped(),k=s?v.projMatrix:e.transform.calculateProjMatrix(T);e.prepareDrawTile();const N=t?t.getTile(v):p?p[v.key]:new Ko(v,w,b.zoom,e),F=P?Sm(k,f,d,e,P,r.scope,{tileID:v,tileSize:w}):aI(k,f,d,c);e.uploadCommonUniforms(g,E,T);const{tileBoundsBuffer:$,tileBoundsIndexBuffer:q,tileBoundsSegments:Z}=e.getTileBoundsBuffers(N);E.draw(e,y.TRIANGLES,A,I,l,Jn.disabled,F,r.id,$,q,Z)}},sky:function(e,t,r){const s=e._atmosphere?Po(e.transform.zoom):1,c=r.paint.get("sky-opacity")*s;if(0===c)return;const d=e.context,f=r.paint.get("sky-type"),g=new Pn(d.gl.LEQUAL,Pn.ReadOnly,[0,1]),y=e.frameCounter/1e3%1;"atmosphere"===f?"offscreen"===e.renderPass?r.needsSkyboxCapture(e)&&(function(b,w,P,O){const I=b.context,A=I.gl;let l=w.skyboxFbo;if(!l){l=w.skyboxFbo=I.createFramebuffer(32,32,!0,null),w.skyboxGeometry=new _M(I),w.skyboxTexture=I.gl.createTexture(),A.bindTexture(A.TEXTURE_CUBE_MAP,w.skyboxTexture),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_MAG_FILTER,A.LINEAR);for(let v=0;v<6;++v)A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,A.RGBA,32,32,0,A.RGBA,A.UNSIGNED_BYTE,null)}I.bindFramebuffer.set(l.framebuffer),I.viewport.set([0,0,32,32]);const u=w.getCenter(b,!0),p=b.getOrCreateProgram("skyboxCapture"),m=new Float64Array(16);bt.identity(m),bt.rotateY(m,m,.5*-Math.PI),Zb(b,w,p,m,u,0),bt.identity(m),bt.rotateY(m,m,.5*Math.PI),Zb(b,w,p,m,u,1),bt.identity(m),bt.rotateX(m,m,.5*-Math.PI),Zb(b,w,p,m,u,2),bt.identity(m),bt.rotateX(m,m,.5*Math.PI),Zb(b,w,p,m,u,3),bt.identity(m),Zb(b,w,p,m,u,4),bt.identity(m),bt.rotateY(m,m,Math.PI),Zb(b,w,p,m,u,5),I.viewport.set([0,0,b.width,b.height])}(e,r),r.markSkyboxValid(e)):"sky"===e.renderPass&&function(b,w,P,O,I){const A=b.context,l=A.gl,u=b.transform,p=b.getOrCreateProgram("skybox");A.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_CUBE_MAP,w.skyboxTexture);const m={u_matrix:u.skyboxMatrix,u_sun_direction:w.getCenter(b,!1),u_cubemap:0,u_opacity:O,u_temporal_offset:I};b.uploadCommonUniforms(A,p),p.draw(b,l.TRIANGLES,P,Gn.disabled,b.colorModeForRenderPass(),Jn.backCW,m,"skybox",w.skyboxGeometry.vertexBuffer,w.skyboxGeometry.indexBuffer,w.skyboxGeometry.segment)}(e,r,g,c,y):"gradient"===f&&"sky"===e.renderPass&&function(b,w,P,O,I){const A=b.context,l=A.gl,u=b.transform,p=b.getOrCreateProgram("skyboxGradient");w.skyboxGeometry||(w.skyboxGeometry=new _M(A)),A.activeTexture.set(l.TEXTURE0);let m=w.colorRampTexture;m||(m=w.colorRampTexture=new bi(A,w.colorRamp,l.RGBA)),m.bind(l.LINEAR,l.CLAMP_TO_EDGE);const v=(k=O,N=I,{u_matrix:u.skyboxMatrix,u_color_ramp:0,u_center_direction:w.getCenter(b,!1),u_radius:Ct(w.paint.get("sky-gradient-radius")),u_opacity:k,u_temporal_offset:N});var k,N;b.uploadCommonUniforms(A,p),p.draw(b,l.TRIANGLES,P,Gn.disabled,b.colorModeForRenderPass(),Jn.backCW,v,"skyboxGradient",w.skyboxGeometry.vertexBuffer,w.skyboxGeometry.indexBuffer,w.skyboxGeometry.segment)}(e,r,g,c,y)},debug:function(e,t,r){for(let s=0;s<r.length;s++)Hb(e,t,r[s])},custom:function(e,t,r,s){const c=e.context,d=r.implementation;if(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes("custom")||e.terrain&&(e.terrain.renderingToTexture||"offscreen"===e.renderPass)&&r.isLayerDraped(t)){if("offscreen"===e.renderPass){const f=d.prerender;if(f){if(e.setCustomLayerDefaults(),c.setColorMode(e.colorModeForRenderPass()),"globe"===e.transform.projection.name){const g=e.transform.pointMerc;f.call(d,c.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),Po(e.transform.zoom),[g.x,g.y],e.transform.pixelsPerMeterRatio)}else f.call(d,c.gl,e.transform.customLayerMatrix());c.setDirty(),e.setBaseState()}}else if("translucent"===e.renderPass){if(e.terrain&&e.terrain.renderingToTexture){const g=d.renderToTile;if(g){const y=s[0].canonical,b=new Xn(y.x+s[0].wrap*(1<<y.z),y.y,y.z);c.setDepthMode(Pn.disabled),c.setStencilMode(Gn.disabled),c.setColorMode(e.colorModeForRenderPass()),e.setCustomLayerDefaults(),g.call(d,c.gl,b),c.setDirty(),e.setBaseState()}return}e.setCustomLayerDefaults(),c.setColorMode(e.colorModeForRenderPass()),c.setStencilMode(Gn.disabled);const f="3d"===d.renderingMode?new Pn(e.context.gl.LEQUAL,Pn.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,Pn.ReadOnly);if(c.setDepthMode(f),"globe"===e.transform.projection.name){const g=e.transform.pointMerc;d.render(c.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),Po(e.transform.zoom),[g.x,g.y],e.transform.pixelsPerMeterRatio)}else d.render(c.gl,e.transform.customLayerMatrix());c.setDirty(),e.setBaseState(),c.bindFramebuffer.set(null)}}else gt("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(e,t,r,s){if("opaque"===e.renderPass)return;const c=r.paint.get("model-opacity");if(0===c)return;const d=r.paint.get("model-cast-shadows");if("shadow"===e.renderPass&&(!d||e.terrain&&c<.65&&r._transitionablePaint._values["model-opacity"].value.expression instanceof Os))return;const f=e.shadowRenderer,g=r.paint.get("model-receive-shadows");f&&(f.useNormalOffset=!0,g||(f.enabled=!1));const y=()=>{f&&(f.useNormalOffset=!0,g||(f.enabled=!0))},b=t.getSource();if("light-beam"===e.renderPass&&"batched-model"!==b.type)return;if("vector"===b.type||"geojson"===b.type)return function(p,m,v,C){const E=p.transform;if("mercator"!==E.projection.name)return void gt(`Drawing 3D models for ${E.projection.name} projection is not yet implemented`);const T=E.getFreeCameraOptions().position;if(!p.modelManager)return;const k=p.modelManager,N=p.shadowRenderer;if(!v._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const F=v._unevaluatedLayout._values["model-id"],$={...v.layout.get("model-id").parameters};for(const q of C){const Z=m.getTile(q).getBucket(v);if(!Z||Z.projection.name!==E.projection.name)continue;const X=Y1(q,E);$.zoom=X;const K=F.possiblyEvaluate($);if(VS(p,Z,q),Rf.shadowUniformsInitialized=!1,Rf.useSingleShadowCascade=!!N&&0===N.getMaxCascadeForTile(q.toUnwrapped()),"shadow"===p.renderPass&&N){if(1===p.currentShadowCascade&&Z.isInsideFirstShadowMapFrustum)continue;const ot=E.calculatePosMatrix(q.toUnwrapped(),E.worldSize);if(Rf.tileMatrix.set(ot),Rf.shadowTileMatrix=Float32Array.from(N.calculateShadowPassMatrixFromMatrix(ot)),Rf.aabb.min.fill(0),Rf.aabb.max[0]=Rf.aabb.max[1]=Dt,Rf.aabb.max[2]=0,Kb(Z,Rf,p,v.scope))continue}const J=1<<q.canonical.z,st=[((T.x-q.wrap)*J-q.canonical.x)*Dt,(T.y*J-q.canonical.y)*Dt,T.z*J*Dt];for(let ot in Z.instancesPerModel){const rt=Z.instancesPerModel[ot];rt.features.length>0&&(ot=K.evaluate(rt.features[0].feature,{}));const ct=k.getModel(ot,v.scope);if(ct&&ct.uploaded)for(const yt of ct.nodes)EO(p,v,yt,rt,st,q,Rf)}}}(e,t,r,s),void y();if(!b.loaded())return;if("batched-model"===b.type)return function(p,m,v,C){const E=p.context,T=p.transform,k=p.style.fog,N=p.shadowRenderer;if("mercator"!==T.projection.name)return void gt(`Drawing 3D landmark models for ${T.projection.name} projection is not yet implemented`);const F=p.transform.getFreeCameraOptions().position,$=dt.scale([],[F.x,F.y,F.z],p.transform.worldSize);dt.negate($,$);const q=bt.identity([]),Z=pi(T.center.lat,T.zoom),X=bt.fromScaling([],[1,1,1/Z]);bt.translate(q,q,$);const K=v.paint.get("model-opacity"),J=new Pn(E.gl.LEQUAL,Pn.ReadWrite,p.depthRangeFor3D),st=new Pn(E.gl.LEQUAL,Pn.ReadOnly,p.depthRangeFor3D),ot=function(rt,ct){for(const yt of C){const Ot=m.getTile(yt).getBucket(v);if(!Ot||!Ot.uploaded)continue;let Tt=!1;N&&(Tt=0===N.getMaxCascadeForTile(yt.toUnwrapped()));const zt=T.calculatePosMatrix(yt.toUnwrapped(),T.worldSize),Nt=Ot.modelTraits;for(const $t of Ot.getNodesInfo()){if($t.hiddenByReplacement||!$t.node.meshes)continue;const Rt=$t.node,ie="light-beam"===p.renderPass,Ee=[...zt],Oe=$t.evaluatedScale;let Be=0;p.terrain&&Rt.elevation&&(Be=Rt.elevation*p.terrain.exaggeration()),bt.translate(Ee,Ee,[(Rt.anchor?Rt.anchor[0]:0)*(Oe[0]-1),(Rt.anchor?Rt.anchor[1]:0)*(Oe[1]-1),Be]),Oe!==lb&&bt.scale(Ee,Ee,Oe),bt.multiply(Ee,Ee,Rt.matrix);const je=bt.multiply([],X,Ee);bt.multiply(je,q,je);const En=bt.invert([],je);bt.transpose(En,En),bt.scale(En,En,lD);const Qe=bt.multiply([],T.expandedFarZProjMatrix,Ee);for(let nr=0;nr<Rt.meshes.length;++nr){const ln=Rt.meshes[nr],Ln=nr===Rt.lightMeshIndex;if(Ln){if(!ie&&!p.terrain&&p.shadowRenderer){p.currentLayer<p.firstLightBeamLayer&&(p.firstLightBeamLayer=p.currentLayer);continue}}else if(ie)continue;const On={defines:[]},mn=[];MO(On.defines,mn,ln,p),4&Nt||On.defines.push("DIFFUSE_SHADED"),Tt&&On.defines.push("SHADOWS_SINGLE_CASCADE");const wr="shadow"===p.renderPass;if(wr){ky(ln,Ee,p,v);continue}let Lr=null;if(k){const $o=yM(Ee,p.transform);if(Lr=new Float32Array($o),"globe"!==T.projection.name){const Io=ln.aabb.min,Gi=ln.aabb.max,[Gr,So]=k.getOpacityForBounds($o,Io[0],Io[1],Gi[0],Gi[1]);On.overrideFog=Gr>=nd||So>=nd}}const rr=p.getOrCreateProgram("model",On);!wr&&N&&(N.useNormalOffset=!!ln.normalBuffer,N.setupShadowsFromMatrix(Ee,rr,N.useNormalOffset)),p.uploadCommonUniforms(E,rr,yt.toUnwrapped(),Lr);const Kr=ln.material,Si=Kr.pbrMetallicRoughness;Si.metallicFactor=.9,Si.roughnessFactor=.5;const gi=0,Ni=lI(new Float32Array(Qe),new Float32Array(je),new Float32Array(En),p,K,Si.baseColorFactor,Kr.emissiveFactor,Si.metallicFactor,Si.roughnessFactor,Kr,gi,v);rr.draw(p,E.gl.TRIANGLES,ct&&!Ln?J:st,Gn.disabled,rt?Ln||K<1||$t.hasTranslucentParts?Sr.alphaBlended:Sr.unblended:Sr.disabled,Jn.backCCW,Ni,v.id,ln.vertexBuffer,ln.indexBuffer,ln.segments,v.paint,p.transform.zoom,void 0,mn)}}}};(function(rt,ct,yt,Ot){const Tt=rt.terrain?rt.terrain.exaggeration():0,zt=rt.transform.zoom;for(const Nt of Ot){const $t=ct.getTile(Nt).getBucket(yt);$t&&(rt.conflationActive&&$t.updateReplacement(Nt,rt.replacementSource),$t.evaluateScale(rt,yt),rt.terrain&&Tt>0&&$t.elevationUpdate(rt.terrain,Tt,Nt,yt.source),$t.needsReEvaluation(rt,zt,yt)&&$t.evaluate(yt))}})(p,m,v,C),1===K?ot(!0,!0):(ot(!1,!0),ot(!0,!1))}(e,t,r,s),void y();const w=b.getModels(),P=[],O=e.transform.getFreeCameraOptions().position,I=dt.scale([],[O.x,O.y,O.z],e.transform.worldSize);dt.negate(I,I);const A=[],l=[];let u=0;for(const p of w){const m=r.paint.get("model-rotation").constantOr(null),v=r.paint.get("model-scale").constantOr(null),C=r.paint.get("model-translation").constantOr(null);p.computeModelMatrix(e,m,v,C,!0,!0,!1);const E=bt.identity([]),T=pi(p.position.lat,e.transform.zoom),k=bt.fromScaling([],[1,1,1/T]);bt.translate(E,E,I),P.push({zScaleMatrix:k,negCameraPosMatrix:E});for(const N of p.nodes)PO(e.transform,N,p.matrix,e.transform.expandedFarZProjMatrix,u,A,l);u++}if(A.sort((p,m)=>m.depth-p.depth),"shadow"!==e.renderPass){if(1===c)for(const p of l)Wb(p,e,r,P[p.modelIndex],Gn.disabled,e.colorModeForRenderPass());else{for(const p of l)Wb(p,e,r,P[p.modelIndex],Gn.disabled,Sr.disabled);for(const p of l)Wb(p,e,r,P[p.modelIndex],e.stencilModeFor3D(),e.colorModeForRenderPass());e.resetStencilClippingMasks()}for(const p of A)Wb(p,e,r,P[p.modelIndex],Gn.disabled,e.colorModeForRenderPass());y()}else{for(const p of l)ky(p.mesh,p.nodeModelMatrix,e,r);for(const p of A)ky(p.mesh,p.nodeModelMatrix,e,r);y()}}},Yb={modelUpload:function(e,t,r){const s=t.getSource();if(!s.loaded())return;if("vector"===s.type||"geojson"===s.type)return void(e.modelManager&&e.modelManager.upload(e,r));if("batched-model"===s.type)return;const c=s.getModels();for(const d of c)d.upload(e.context)}};class vM{constructor(t,r,s){this.context=new rb(t,r),this.transform=s,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=Na.maxUnderzooming+Na.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new VT,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new IO(this),this._wireframeDebugCache=new pI,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(t,r){const s=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(s||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new pO(this,t));const c=this._terrain;this.transform.elevation=s?c:null,c.update(t,this.transform,r),this.transform.elevation&&!c.enabled&&(this.transform.elevation=null)}_updateFog(t){const r=t.fog;if(!r||"globe"===this.transform.projection.name||r.getOpacity(this.transform.pitch)<1||r.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[s,c]=r.getFovAdjustedRange(this.transform._fov);if(s>c)return void(this.transform.fogCullDistSq=null);const d=s+.78*(c-s);this.transform.fogCullDistSq=d*d}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(t,r){if(this.width=t*Mn.devicePixelRatio,this.height=r*Mn.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const s of this.style.order)this.style._mergedLayers[s].resize()}setup(){const t=this.context,r=new pa;r.emplaceBack(0,0),r.emplaceBack(Dt,0),r.emplaceBack(0,Dt),r.emplaceBack(Dt,Dt),this.tileExtentBuffer=t.createVertexBuffer(r,wp.members),this.tileExtentSegments=li.simpleSegment(0,0,4,2);const s=new pa;s.emplaceBack(0,0),s.emplaceBack(Dt,0),s.emplaceBack(0,Dt),s.emplaceBack(Dt,Dt),this.debugBuffer=t.createVertexBuffer(s,wp.members),this.debugSegments=li.simpleSegment(0,0,4,5);const c=new pa;c.emplaceBack(-1,-1),c.emplaceBack(1,-1),c.emplaceBack(-1,1),c.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(c,wp.members),this.viewportSegments=li.simpleSegment(0,0,4,2);const d=new el;d.emplaceBack(0,0,0,0),d.emplaceBack(Dt,0,Dt,0),d.emplaceBack(0,Dt,0,Dt),d.emplaceBack(Dt,Dt,Dt,Dt),this.mercatorBoundsBuffer=t.createVertexBuffer(d,$x.members),this.mercatorBoundsSegments=li.simpleSegment(0,0,4,2);const f=new Mo;f.emplaceBack(0,1,2),f.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(f);const g=new c_;for(const b of[0,1,3,2,0])g.emplaceBack(b);this.debugIndexBuffer=t.createIndexBuffer(g),this.emptyTexture=new bi(t,new Uo({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=bt.create();const y=this.context.gl;this.stencilClearMode=new Gn({func:y.ALWAYS,mask:0},0,255,y.ZERO,y.ZERO,y.ZERO),this.loadTimeStamps.push(lt.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,t.TRIANGLES,Pn.disabled,this.stencilClearMode,Sr.disabled,Jn.disabled,Im(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,r,s){if(!r||this.currentStencilSource===r.id||!t.isTileClipped()||!s||0===s.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let g=!1;for(const y of s)if(void 0===this._tileClippingMaskIDs[y.key]){g=!0;break}if(!g)return}this.currentStencilSource=r.id;const c=this.context,d=c.gl;this.nextStencilID+s.length>256&&this.clearStencil(),c.setColorMode(Sr.disabled),c.setDepthMode(Pn.disabled);const f=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const g of s){const y=r.getTile(g),b=this._tileClippingMaskIDs[g.key]=this.nextStencilID++,{tileBoundsBuffer:w,tileBoundsIndexBuffer:P,tileBoundsSegments:O}=this.getTileBoundsBuffers(y);f.draw(this,d.TRIANGLES,Pn.disabled,new Gn({func:d.ALWAYS,mask:0},b,255,d.KEEP,d.KEEP,d.REPLACE),Sr.disabled,Jn.disabled,Im(g.projMatrix),"$clipping",w,P,O)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,r=this.context.gl;return new Gn({func:r.NOTEQUAL,mask:255},t,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const r=this.context.gl;return new Gn({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,r.KEEP,r.KEEP,r.REPLACE)}stencilConfigForOverlap(t){const r=this.context.gl,s=t.sort((f,g)=>g.overscaledZ-f.overscaledZ),c=s[s.length-1].overscaledZ,d=s[0].overscaledZ-c+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const f={};for(let g=0;g<d;g++)f[g+c]=new Gn({func:r.GEQUAL,mask:255},g+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=d,[f,s]}return[{[c]:Gn.disabled},s]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Sr([t.CONSTANT_COLOR,t.ONE,t.CONSTANT_COLOR,t.ONE],new bn(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Sr.unblended:Sr.alphaBlended}colorModeForDrapableLayerRenderPass(t){const r=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&"translucent"===this.renderPass?new Sr([r.ONE,r.ONE_MINUS_SRC_ALPHA,r.CONSTANT_ALPHA,r.ONE_MINUS_SRC_ALPHA],new bn(0,0,0,void 0===t?0:t),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(t,r,s,c=!1){if(!this.opaquePassEnabledForLayer()&&!c)return Pn.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Pn(s||this.context.gl.LEQUAL,r,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,r){this._wireframeDebugCache.update(this.frameCounter),this.style=t,this.options=r;const s=this.style._mergedLayers,c=this.style.order,d=c.map(E=>s[E]),f=this.style._mergedSourceCaches;this.imageManager=t.imageManager,this.modelManager=t.modelManager,this.symbolFadeChange=t.placement.symbolFadeChange(Mn.now()),this.imageManager.beginFrame();let g=0,y=!1;for(const E in f){const T=f[E];T.used&&(T.prepare(this.context),T.getSource().usedInConflation&&++g)}const b={},w={},P={},O={},I={};for(const E in f){const T=f[E];b[E]=T.getVisibleCoordinates(),w[E]=b[E].slice().reverse(),P[E]=T.getVisibleCoordinates(!0).reverse(),O[E]=T.getShadowCasterCoordinates(),I[E]=T.sortCoordinatesByDistance(b[E])}const A=E=>{const T=this.style.getLayerSourceCache(E);return T&&T.used?T.getSource():null};if(g){const E=[];for(const T of d)this.layerUsedInConflation(T,A(T))&&E.push(T);if(E&&E.length>1){const T=[];for(const k of E){const N=this.style.getLayerSourceCache(k);N&&N.used&&N.getSource().usedInConflation&&T.push({layer:k.fqid,cache:N})}this.replacementSource.setSources(T),y=!0}}y||this.replacementSource.clear(),this.conflationActive=y,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const E of d){const T=E.cutoffRange();if(this.longestCutoffRange=Math.max(T,this.longestCutoffRange),T>0){const k=A(E);k&&(this.minCutoffZoom=Math.max(k.minzoom,this.minCutoffZoom)),E.minzoom&&(this.minCutoffZoom=Math.max(E.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let E=0;E<d.length;E++)if(d[E].is3D()){this.opaquePassCutoff=E;break}const l=this.style&&this.style.fog;l?(this._fogVisible=0!==l.getOpacity(this.transform.pitch),this._fogVisible&&"globe"!==this.transform.projection.name&&(this._fogVisible=l.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(P),this.opaquePassCutoff=0);const u=this._shadowRenderer;if(u){u.updateShadowParameters(this.transform,this.style.directionalLight);for(const E in f)for(const T of b[E]){let k={min:0,max:0};this.terrain&&(k=this.terrain.getMinMaxForTile(T)||k),u.addShadowReceiver(T.toUnwrapped(),k.min,k.max)}}"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new dx(this.context));for(const E of d){if(E.isHidden(this.transform.zoom))continue;const T=t.getLayerSourceCache(E);this.uploadLayer(this,E,T)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new tg),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!zr.has(this.context.gl))return;this.renderPass="offscreen";for(const E of d){const T=t.getLayerSourceCache(E);if(!E.hasOffscreenPass()||E.isHidden(this.transform.zoom))continue;const k=T?w[T.id]:void 0;("custom"===E.type||"raster"===E.type||E.isSky()||k&&k.length)&&this.renderLayer(this,T,E,k)}this.depthRangeFor3D=[0,1-(d.length+2)*this.numSublayers*this.depthEpsilon];const p=this.terrain;p&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&p.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,O)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const m="globe"===this.transform.projection.name||this.transform.isHorizonVisible(),v=(()=>{if(r.showOverdrawInspector)return bn.black;if(this.style.fog&&this.transform.projection.supportsFog&&!m){const E=this.style.fog.properties.get("color").toArray01();return new bn(...E)}if(this.style.fog&&this.transform.projection.supportsFog&&m){const E=this.style.fog.properties.get("space-color").toArray01();return new bn(...E)}return bn.transparent})();if(this.context.clear({color:v,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&m&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const E=d[this.currentLayer],T=t.getLayerSourceCache(E);if(E.isSky())continue;const k=T?(E.is3D()?I:w)[T.id]:void 0;this._renderTileClippingMasks(E,T,k),this.renderLayer(this,T,E,k)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&m&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||Po(this.transform.zoom)>0)&&("globe"===this.transform.projection.name||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const E=d[this.currentLayer],T=t.getLayerSourceCache(E);E.isSky()&&this.renderLayer(this,T,E,T?w[T.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let C=0;for(u&&(C=u.getShadowCastingLayerCount());this.currentLayer<c.length;){const E=d[this.currentLayer],T=t.getLayerSourceCache(E);if(E.isSky()){++this.currentLayer;continue}if(p&&this.style.isLayerDraped(E)){if(E.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=p.renderBatch(this.currentLayer);continue}let k;if(T&&(k=("symbol"===E.type?P:E.is3D()?I:w)[T.id]),this._renderTileClippingMasks(E,T,T?b[T.id]:void 0),this.renderLayer(this,T,E,k),!p&&u&&C>0&&E.hasShadowPass()&&0==--C&&(u.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const N=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=N;this.currentLayer++){const F=d[this.currentLayer];if(!F.hasLightBeamPass())continue;const $=t.getLayerSourceCache(F);this.renderLayer(this,$,F,$?w[$.id]:void 0)}this.currentLayer=N,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let E=null;d.forEach(T=>{const k=t.getLayerSourceCache(T);k&&!T.isHidden(this.transform.zoom)&&k.getVisibleCoordinates().length&&(!E||E.getSource().maxzoom<k.getSource().maxzoom)&&(E=k)}),E&&this.options.showTileBoundaries&&OO.debug(this,E,E.getVisibleCoordinates())}this.options.showPadding&&function(E){const T=E.transform.padding;Dy(E,E.transform.height-(T.top||0),3,bO),Dy(E,T.bottom||0,3,mM),xO(E,T.left||0,3,$b),xO(E,E.transform.width-(T.right||0),3,Gb);const k=E.transform.centerPoint;var N,F,$,q;$s(N=E,(F=k.x)-1,($=E.transform.height-k.y)-10,2,20,q=hI),$s(N,F-10,$-1,20,2,q)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(lt.performance.now()),this.saveCanvasCopy()),y||(this.conflationActive=!1)}uploadLayer(t,r,s){this.gpuTimingStart(r),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(r.type)||t.terrain&&"custom"===r.type)&&Yb[`${r.type}Upload`]&&Yb[`${r.type}Upload`](t,s,r.scope),this.gpuTimingEnd()}renderLayer(t,r,s,c){s.isHidden(this.transform.zoom)||("background"===s.type||"sky"===s.type||"custom"===s.type||"model"===s.type||"raster"===s.type||c&&c.length)&&(this.id=s.id,this.gpuTimingStart(s),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(s.type)||t.terrain&&"custom"===s.type)&&OO[s.type](t,r,s,c,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery,s=this.context.gl;let c=this.gpuTimers[t.id];c||(c=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:s.createQuery()}),c.calls++,s.beginQuery(r.TIME_ELAPSED_EXT,c.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,r=this.context.gl,s=r.createQuery();this.deferredRenderGpuTimeQueries.push(s),r.beginQuery(t.TIME_ELAPSED_EXT,s)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const r={};for(const s in t){const c=t[s],d=this.context.extTimerQuery,f=d.getQueryParameter(c.query,this.context.gl.QUERY_RESULT)/1e6;d.deleteQueryEXT(c.query),r[s]=f}return r}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const r=this.context.extTimerQuery,s=this.context.gl;let c=0;for(const d of t)c+=r.getQueryParameter(d,s.QUERY_RESULT)/1e6,r.deleteQueryEXT(d);return c}translatePosMatrix(t,r,s,c,d){if(!s[0]&&!s[1])return t;const f=d?"map"===c?this.transform.angle:0:"viewport"===c?-this.transform.angle:0;if(f){const b=Math.sin(f),w=Math.cos(f);s=[s[0]*w-s[1]*b,s[0]*b+s[1]*w]}const g=[d?s[0]:Ju(r,s[0],this.transform.zoom),d?s[1]:Ju(r,s[1],this.transform.zoom),0],y=new Float32Array(16);return bt.translate(y,t,g),y}saveTileTexture(t){const r=t.size[0],s=this._tileTextures[r];s?s.push(t):this._tileTextures[r]=[t]}getTileTexture(t){const r=this._tileTextures[t];return r&&r.length>0?r.pop():null}isPatternMissing(t,r){return null===t||void 0!==t&&!this.imageManager.getPattern(t.toString(),r)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return null!=this.context.extTextureFloatLinear}currentGlobalDefines(t,r,s){const c=void 0===s?this.terrain&&this.terrain.renderingToTexture:s,d=this.terrain&&0===this.terrain.exaggeration(),f=[];return this.style&&this.style.enable3dLights()&&("globeRaster"===t||"terrainRaster"===t?(f.push("LIGHTING_3D_MODE"),f.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):c||f.push("LIGHTING_3D_MODE")),"shadow"===this.renderPass?this._shadowMapDebug||f.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?f.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):f.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(f.push("TERRAIN"),this.linearFloatFilteringSupported()&&f.push("TERRAIN_DEM_FLOAT_FORMAT"),d&&f.push("ZERO_EXAGGERATION")),"globe"===this.transform.projection.name&&f.push("GLOBE"),!this._fogVisible||c||void 0!==r&&!r||f.push("FOG","FOG_DITHERING"),c&&f.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&f.push("OVERDRAW_INSPECTOR"),f}getOrCreateProgram(t,r){this.cache=this.cache||{};const s=r&&r.defines||[],c=r&&r.config,d=this.currentGlobalDefines(t,r&&r.overrideFog,r&&r.overrideRtt).concat(s),f=lM.cacheKey(iM[t],t,d,c);return this.cache[f]||(this.cache[f]=new lM(this.context,t,iM[t],c,Z1[t],d)),this.cache[f]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=lt.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new bi(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(t,r){if(this.style.enable3dLights()){const s=this.style.directionalLight,c=this.style.ambientLight;if(s&&c){const d=((f,g)=>{const y=f.properties.get("direction"),b=f.properties.get("color").toArray01(),w=f.properties.get("intensity"),P=g.properties.get("color").toArray01(),O=g.properties.get("intensity"),I=[y.x,y.y,y.z],A=Fr(P,O),l=Fr(b,w);return{u_lighting_ambient_color:A,u_lighting_directional_dir:I,u_lighting_directional_color:l,u_ground_radiance:nI(I,l,A)}})(s,c);r.setLightsUniformValues(t,d)}}}uploadCommonUniforms(t,r,s,c,d){if(this.uploadCommonLightUniforms(t,r),this.terrain&&this.terrain.renderingToTexture)return;const f=this.style.fog;if(f){const g=f.getOpacity(this.transform.pitch),y=((b,w,P,O,I,A,l,u,p,m,v,C)=>{const E=b.transform,T=w.properties.get("color").toArray01();T[3]=O;const k=b.frameCounter/1e3%1,[N,F]=w.properties.get("vertical-range");return{u_fog_matrix:P?E.calculateFogTileMatrix(P):C||b.identityMat,u_fog_range:w.getFovAdjustedRange(E._fov),u_fog_color:T,u_fog_horizon_blend:w.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(N,F),F],u_fog_temporal_offset:k,u_frustum_tl:I,u_frustum_tr:A,u_frustum_br:l,u_frustum_bl:u,u_globe_pos:p,u_globe_radius:m,u_viewport:v,u_globe_transition:Po(E.zoom),u_is_globe:+("globe"===E.projection.name)}})(this,f,s,g,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*Mn.devicePixelRatio,this.transform.height*Mn.devicePixelRatio],c);r.setFogUniformValues(t,y)}d&&r.setCutoffUniformValues(t,d.uniformValues)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),r}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&0!==t.getOpacity(this.transform.pitch)}getBackgroundTiles(){const t=this._backgroundTiles,r=this._backgroundTiles={},s=this.transform.coveringTiles({tileSize:512});for(const c of s)r[c.key]=t[c.key]||new Ko(c,512,this.transform.tileZoom,this);return r}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(t,r){return!(!t.is3D()||t.minzoom&&t.minzoom>this.transform.zoom||"building"!==t.sourceLayer&&(!r||"batched-model"!==r.type))}isTileAffectedByFog(t){if(!this.style||!this.style.fog)return!1;if("globe"===this.transform.projection.name)return!0;let r=this._cachedTileFogOpacities[t.key];return r||(this._cachedTileFogOpacities[t.key]=r=this.style.fog.getOpacityForTile(t)),r[0]>=nd||r[1]>=nd}}const Lf=2048;class TO{constructor(t,r){this.aabb=t,this.lastCascade=r}}class bM{add(t,r){const s=this.receivers[t.key];void 0!==s?(s.aabb.min[0]=Math.min(s.aabb.min[0],r.min[0]),s.aabb.min[1]=Math.min(s.aabb.min[1],r.min[1]),s.aabb.min[2]=Math.min(s.aabb.min[2],r.min[2]),s.aabb.max[0]=Math.max(s.aabb.max[0],r.max[0]),s.aabb.max[1]=Math.max(s.aabb.max[1],r.max[1]),s.aabb.max[2]=Math.max(s.aabb.max[2],r.max[2])):this.receivers[t.key]=new TO(r,null)}clear(){this.receivers={}}get(t){return this.receivers[t.key]}computeRequiredCascades(t,r,s){const c=_i.fromPoints(t.points);let d=0;for(const f in this.receivers){const g=this.receivers[f];if(!g||!c.intersectsAabb(g.aabb))continue;g.aabb.min=c.closestPoint(g.aabb.min),g.aabb.max=c.closestPoint(g.aabb.max);const y=g.aabb.getCorners();for(let b=0;b<s.length;b++){let w=!0;for(const P of y){const O=[P[0]*r,P[1]*r,P[2]];if(dt.transformMat4(O,O,s[b].matrix),O[0]<-1||O[0]>1||O[1]<-1||O[1]>1){w=!1;break}}if(g.lastCascade=b,d=Math.max(d,b),w)break}}return d+1}}class IO{constructor(t){this.painter=t,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new bM,this._depthMode=new Pn(t.context.gl.LEQUAL,Pn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1}destroy(){for(const t of this._cascades)t.texture.destroy(),t.framebuffer.destroy();this._cascades=[]}updateShadowParameters(t,r){const s=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!r||!r.properties)return;const c=r.properties.get("shadow-intensity");if(!r.shadowsEnabled()||c<=0||(this._shadowLayerCount=s.style.order.reduce((I,A)=>{const l=s.style._mergedLayers[A];return I+(l.hasShadowPass()&&!l.isHidden(t.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const d=s.context,f=Lf,g=Lf;if(0===this._cascades.length)for(let I=0;I<2;++I){const A=s._shadowMapDebug,l=d.gl,u=d.createFramebuffer(f,g,A,"texture"),p=new bi(d,{width:f,height:g,data:null},l.DEPTH_COMPONENT);if(u.depthAttachment.set(p.texture),A){const m=new bi(d,{width:f,height:g,data:null},l.RGBA);u.colorAttachment.set(m.texture)}this._cascades.push({framebuffer:u,texture:p,matrix:[],far:0,boundingSphereRadius:0,frustum:new sc,scale:0})}this.shadowDirection=X1(r);let y=0;if(t.elevation){const I=t.elevation,A=[1e4,-1e4];I.visibleDemTiles.filter(l=>l.dem).forEach(l=>{const u=l.dem.tree;A[0]=Math.min(A[0],u.minimums[0]),A[1]=Math.max(A[1],u.maximums[0])}),1e4!==A[0]&&(y=(A[1]-A[0])*I.exaggeration())}const b=1.5*t.cameraToCenterDistance,w=3*b,P=new Float64Array(16);for(let I=0;I<2;++I){const A=this._cascades[I];let l=t.height/50,u=1;0===I?u=b:(l=b,u=w);const[p,m]=gI(t,this.shadowDirection,l,u,Lf,y);A.scale=t.scale,A.matrix=p,A.boundingSphereRadius=m,bt.invert(P,A.matrix),A.frustum=sc.fromInvProjectionMatrix(P,1,0,!0),A.far=u}this._uniformValues.u_fade_range=[.75*this._cascades[1].far,this._cascades[1].far],this._uniformValues.u_shadow_intensity=c,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=.00048828125,this._uniformValues.u_shadow_map_resolution=Lf,this._uniformValues.u_shadowmap_0=js.ShadowMap0,this._uniformValues.u_shadowmap_1=js.ShadowMap0+1,this._groundShadowTiles=s.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const O=s.transform.elevation;for(const I of this._groundShadowTiles){let A={min:0,max:0};if(O){const l=O.getMinMaxForTile(I);l&&(A=l)}this.addShadowReceiver(I.toUnwrapped(),A.min,A.max)}}get enabled(){return this._enabled}set enabled(t){this._enabled=t}drawShadowPass(t,r){if(!this._enabled)return;const s=this.painter,c=s.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(s.transform.getFrustum(0),s.transform.worldSize,this._cascades),c.viewport.set([0,0,Lf,Lf]);for(let d=0;d<this._numCascadesToRender;++d){s.currentShadowCascade=d,c.bindFramebuffer.set(this._cascades[d].framebuffer.framebuffer),c.clear({color:bn.white,depth:1});for(const f of t.order){const g=t._mergedLayers[f];if(!g.hasShadowPass()||g.isHidden(s.transform.zoom))continue;const y=t.getLayerSourceCache(g),b=y?r[y.id]:void 0;("model"===g.type||b&&b.length)&&s.renderLayer(s,y,g,b)}}s.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const t=this.painter,r=t.style,s=t.context,c=r.directionalLight,d=r.ambientLight;if(!c||!d)return;const f=[],g=Tm(t,t.longestCutoffRange);g.shouldRenderCutoff&&f.push("RENDER_CUTOFF");const y=xM(c,d),b=new Pn(s.gl.LEQUAL,Pn.ReadOnly,t.depthRangeFor3D);for(const w of this._groundShadowTiles){const P=w.toUnwrapped(),O=t.isTileAffectedByFog(w),I=t.getOrCreateProgram("groundShadow",{defines:f,overrideFog:O});this.setupShadows(P,I),t.uploadCommonUniforms(s,I,P,null,g);const A={u_matrix:t.transform.calculateProjMatrix(P),u_ground_shadow_factor:y};I.draw(t,s.gl.TRIANGLES,b,Gn.disabled,Sr.multiply,Jn.disabled,A,"ground_shadow",t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments,{},t.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Sr.unblended:Sr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(t){const r=this.painter.transform,s=r.calculatePosMatrix(t,r.worldSize);return bt.multiply(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}calculateShadowPassMatrixFromMatrix(t){return bt.multiply(t,this._cascades[this.painter.currentShadowCascade].matrix,t),Float32Array.from(t)}setupShadows(t,r,s,c=0){if(!this._enabled)return;const d=this.painter.transform,f=this.painter.context,g=f.gl,y=this._uniformValues,b=new Float64Array(16),w=d.calculatePosMatrix(t,d.worldSize);for(let P=0;P<2;P++)bt.multiply(b,this._cascades[P].matrix,w),y[0===P?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(b),f.activeTexture.set(g.TEXTURE0+js.ShadowMap0+P),this._cascades[P].texture.bind(g.NEAREST,g.CLAMP_TO_EDGE);if(this.useNormalOffset=!!s,this.useNormalOffset){const P=Op(t.canonical),O=2/d.tileSize*Dt/Lf,I=O*this._cascades[0].boundingSphereRadius,A=O*this._cascades[1].boundingSphereRadius,l=("vector-tile"===s?1:3)/Math.pow(2,c-t.canonical.z-(1-d.zoom+Math.floor(d.zoom)));y.u_shadow_normal_offset=[P,I*l,A*l],y.u_shadow_bias=[6e-5,.0012,.012]}else y.u_shadow_bias=[36e-5,.0012,.012];r.setShadowUniformValues(f,y)}setupShadowsFromMatrix(t,r,s=!1){if(!this._enabled)return;const c=this.painter.context,d=c.gl,f=this._uniformValues,g=new Float64Array(16);for(let y=0;y<2;y++)bt.multiply(g,this._cascades[y].matrix,t),f[0===y?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(g),c.activeTexture.set(d.TEXTURE0+js.ShadowMap0+y),this._cascades[y].texture.bind(d.NEAREST,d.CLAMP_TO_EDGE);this.useNormalOffset=s,s?(f.u_shadow_normal_offset=[1,5,5],f.u_shadow_bias=[6e-5,.0012,.012]):f.u_shadow_bias=[36e-5,.0012,.012],r.setShadowUniformValues(c,f)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(t,r,s,c){if(c[2]>=0)return{};const d=function(y,b,w){const P=w/(1<<y.canonical.z);return new _i([y.canonical.x*P+y.wrap*w,y.canonical.y*P+y.wrap*w,0],[(y.canonical.x+1)*P+y.wrap*w,(y.canonical.y+1)*P+y.wrap*w,b])}(t,r,s).getCorners(),f=r/-c[2];c[0]<0?(dt.add(d[0],d[0],[c[0]*f,0,0]),dt.add(d[3],d[3],[c[0]*f,0,0])):c[0]>0&&(dt.add(d[1],d[1],[c[0]*f,0,0]),dt.add(d[2],d[2],[c[0]*f,0,0])),c[1]<0?(dt.add(d[0],d[0],[0,c[1]*f,0]),dt.add(d[1],d[1],[0,c[1]*f,0])):c[1]>0&&(dt.add(d[2],d[2],[0,c[1]*f,0]),dt.add(d[3],d[3],[0,c[1]*f,0]));const g={};return g.vertices=d,g.planes=[id(d[1],d[0],d[4]),id(d[2],d[1],d[5]),id(d[3],d[2],d[6]),id(d[0],d[3],d[7])],g}addShadowReceiver(t,r,s){this._receivers.add(t,_i.fromTileIdAndHeight(t,r,s))}getMaxCascadeForTile(t){const r=this._receivers.get(t);return r&&r.lastCascade?r.lastCascade:0}}function id(e,t,r){const s=dt.sub([],r,t),c=dt.sub([],e,t),d=dt.cross([],s,c),f=dt.length(d);return 0===f?[0,0,1,0]:(dt.scale(d,d,1/f),[d[0],d[1],d[2],-dt.dot(d,t)])}function X1(e){const t=e.properties.get("direction"),r=Ge(t.x,t.y,t.z);r[2]=Ne(r[2],0,75);const s=Pe([r[0],r[1],r[2]]);return dt.fromValues(s.x,s.y,s.z)}function xM(e,t){const r=e.properties.get("color"),s=e.properties.get("intensity"),c=e.properties.get("direction"),d=[c.x,c.y,c.z],f=t.properties.get("color"),g=t.properties.get("intensity"),y=Math.max(dt.dot([0,0,1],d),0),b=[0,0,0];dt.scale(b,f.toArray01Linear().slice(0,3),g);const w=[0,0,0];return dt.scale(w,r.toArray01Linear().slice(0,3),y*s),Xr([b[0]>0?b[0]/(b[0]+w[0]):0,b[1]>0?b[1]/(b[1]+w[1]):0,b[2]>0?b[2]/(b[2]+w[2]):0])}function gI(e,t,r,s,c,d){const f=e.zoom,g=e.scale,y=e.worldSize,b=1/y,w=e.aspect,P=Math.sqrt(1+w*w)*Math.tan(.5*e.fovX),O=P*P,I=s-r,A=s+r;let l,u;O>I/A?(l=s,u=s*P):(l=.5*A*(1+O),u=.5*Math.sqrt(I*I+2*(s*s+r*r)*O+A*A*O*O));const p=e.projection.pixelsPerMeter(e.center.lat,y),m=e._camera.getCameraToWorldMercator(),v=[0,0,-l*b];dt.transformMat4(v,v,m);let C=u*b;const E=e._edgeInsets;if(!(0===E.left&&0===E.top&&0===E.right&&0===E.bottom||E.left===E.right&&E.top===E.bottom)){const Ot=e._camera.getWorldToCamera(e.worldSize,"meters"===e.projection.zAxisUnit?p:1),Tt=e._camera.getCameraToClipPerspective(e._fov,e.width/e.height,r,s);Tt[8]=2*-e.centerOffset.x/e.width,Tt[9]=2*e.centerOffset.y/e.height;const zt=new Float64Array(16);bt.mul(zt,Tt,Ot);const Nt=new Float64Array(16);bt.invert(Nt,zt);const $t=sc.fromInvProjectionMatrix(Nt,y,f,!0);for(const Rt of $t.points){const ie=((T=Rt)[0]/=g,T[1]/=g,T[2]=ii(T[2],e._center.lat),T);C=Math.max(C,dt.len(dt.subtract([],v,ie)))}}var T;C*=c/(c-1);const k=Math.acos(t[2]),N=Math.atan2(-t[0],-t[1]),F=new ob;F.position=v,F.setPitchBearing(k,N);const $=F.getWorldToCamera(y,p),q=C*y,Z=Math.min(e._mercatorZfromZoom(17)*y*-2,-2*q),X=F.getCameraToClipOrthographic(-q,q,-q,q,Z,(q+d*p)/t[2]),K=new Float64Array(16);bt.multiply(K,X,$);const J=dt.fromValues(Math.floor(1e6*v[0])/1e6*y,Math.floor(1e6*v[1])/1e6*y,0),st=.5*c,ot=[0,0,0];dt.transformMat4(ot,J,K),dt.scale(ot,ot,st);const rt=[Math.floor(ot[0]),Math.floor(ot[1]),Math.floor(ot[2])],ct=[0,0,0];dt.sub(ct,ot,rt),dt.scale(ct,ct,-1/st);const yt=new Float64Array(16);return bt.identity(yt),bt.translate(yt,yt,ct),bt.multiply(K,yt,K),[K,q]}class mI extends ki{constructor(t){super(),this.requestManager=t,this.models={"":{}},this.numModelsLoading={}}loadModel(t,r){return HE(this.requestManager.transformRequest(r,Ft.Model).url).then(s=>{if(!s)return;const c=bm(s),d=new fl(t,void 0,void 0,c);return d.computeBoundsAndApplyParent(),d}).catch(s=>{this.fire(new Cn(new Error(`Could not load model ${t} from ${r}: ${s.message}`)))})}load(t,r){this.models[r]||(this.models[r]={});const s=Object.keys(t);this.numModelsLoading[r]=(this.numModelsLoading[r]||0)+s.length;const c=[];for(const d of s)c.push(this.loadModel(d,t[d]));Promise.allSettled(c).then(d=>{for(let f=0;f<d.length;f++){const{status:g,value:y}=d[f];"fulfilled"===g&&y&&(this.models[r][s[f]]=y)}this.numModelsLoading[r]-=s.length,this.fire(new de("data",{dataType:"style"}))}).catch(d=>{this.fire(new Cn(new Error(`Could not load models: ${d.message}`)))})}isLoaded(){for(const t in this.numModelsLoading)if(this.numModelsLoading[t]>0)return!1;return!0}hasModel(t,r){return!!this.getModel(t,r)}getModel(t,r){return this.models[r]||(this.models[r]={}),this.models[r][t]}addModel(t,r,s){this.models[s]||(this.models[s]={}),this.hasModel(t,s)&&this.removeModel(t,s),this.load({[t]:this.requestManager.normalizeModelURL(r)},s)}addModels(t,r){const s={};for(const c in t)s[c]=this.requestManager.normalizeModelURL(t[c]);this.load(s,r)}removeModel(t,r){this.models[r]||(this.models[r]={});const s=this.models[r][t];delete this.models[r][t],s.destroy()}listModels(t){return this.models[t]||(this.models[t]={}),Object.keys(this.models[t])}upload(t,r){this.models[r]||(this.models[r]={});for(const s in this.models[r])this.models[r][s].upload(t.context)}}const Q1=(e,t)=>Uh(e,t&&t.filter(r=>"source.canvas"!==r.identifier)),cD=he(Vr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","setImportUrl","setImportData","setImportConfig"]),eg=he(Vr,["setCenter","setZoom","setBearing","setPitch"]),km={version:8,layers:[],sources:{}},Xb={duration:300,delay:0},Qb=new Set(["fill","line","background","hillshade","raster"]);class ph extends ki{constructor(t,r={}){super(),this.map=t,this.scope=r.scope||"",this.fragments=[],this.importDepth=r.importDepth||0,this.importsCache=r.importsCache||new Map,this.resolvedImports=r.resolvedImports||new Set,this.transition=_t({},Xb),this._buildingIndex=new XT(this),this.crossTileSymbolIndex=new tM,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=r.styleChanges||new jh,this.dispatcher=r.dispatcher?r.dispatcher:new _m(dh(),this),r.imageManager?this.imageManager=r.imageManager:(this.imageManager=new py,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=r.glyphManager?r.glyphManager:new Xd(t._requestManager,r.localFontFamily?2:r.localIdeographFontFamily?1:0,r.localFontFamily||r.localIdeographFontFamily),r.modelManager?this.modelManager=r.modelManager:(this.modelManager=new mI(t._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=new Map,this._configDependentLayers=new Set,this._config=r.config,this.dispatcher.broadcast("setReferrer",te());const s=this;this._rtlTextPluginCallback=ph.registerForPluginStateChange(c=>{s.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:c.pluginStatus,pluginURL:c.pluginURL},(d,f)=>{if(_o(d),f&&f.every(g=>g))for(const g in s._sourceCaches){const y=s._sourceCaches[g],b=y.getSource().type;"vector"!==b&&"geojson"!==b||y.reload()}})}),this.on("data",c=>{if("source"!==c.dataType||"metadata"!==c.sourceDataType)return;const d=this.getOwnSource(c.sourceId);if(d&&d.vectorLayerIds)for(const f in this._layers){const g=this._layers[f];g.source===d.id&&this._validateLayer(g)}})}loadURL(t,r={}){this.fire(new de("dataloading",{dataType:"style"}));const s="boolean"==typeof r.validate?r.validate:!Ke(t);t=this.map._requestManager.normalizeStyleURL(t,r.accessToken),this.resolvedImports.add(t);const c=this.importsCache.get(t);if(c)return this._load(c,s);const d=this.map._requestManager.transformRequest(t,Ft.Style);this._request=_e(d,(f,g)=>{if(this._request=null,f)this.fire(new Cn(f));else if(g)return this.importsCache.set(t,g),this._load(g,s)})}loadJSON(t,r={}){this.fire(new de("dataloading",{dataType:"style"})),this._request=Mn.frame(()=>{this._request=null,this._load(t,!1!==r.validate)})}loadEmpty(){this.fire(new de("dataloading",{dataType:"style"})),this._load(km,!1)}_loadImports(t,r){if(this.importDepth>=4)return gt("Style doesn't support nesting deeper than 5"),Promise.resolve();const s=[];for(const c of t){const d=this._createFragmentStyle(c),f=new Promise(y=>{d.once("style.import.load",y),d.once("error",y)}).then(()=>this.mergeAll());if(s.push(f),this.resolvedImports.has(c.url)){d.loadEmpty();continue}const g=c.data||this.importsCache.get(c.url);g?d.loadJSON(g,{validate:r}):c.url?d.loadURL(c.url,{validate:r}):d.loadEmpty(),this.fragments.push({style:d,id:c.id,config:c.config})}return Promise.allSettled(s)}_createFragmentStyle(t){const r=this.scope?sn(t.id,this.scope):t.id,s=new ph(this.map,{scope:r,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:t.config});return s.setEventedParent(this.map,{style:s}),s}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const t=this.isRootStyle();this._shouldPrecompile=t,this.fire(new de(t?"style.load":"style.import.load"))}_load(t,r){const s=t.schema;if(this.isRootStyle()&&(t.fragment||s&&!1!==t.fragment)){const f=_t({},km,{imports:[{id:"basemap",data:t,url:""}]});return void this._load(f,r)}if(this.setConfig(this._config,s),r&&Q1(this,Ea(t)))return;this._loaded=!0,this.stylesheet=et(t);for(const f in t.sources)this.addSource(f,t.sources[f],{validate:!1,isInitialLoad:!0});t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(t.glyphs,this.scope);const c=D1(this.stylesheet.layers);if(this._order=c.map(f=>f.id),this.stylesheet.light&&gt("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(1===this.stylesheet.lights.length&&"flat"===this.stylesheet.lights[0].type){const f=this.stylesheet.lights[0];this.light=new mm(f.properties,f.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new mm(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const f of c){const g=Wp(f,this.options);g.setScope(this.scope),g.isConfigDependent&&this._configDependentLayers.add(g.fqid),g.setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g,this._serializedLayers[g.id]=g.serialize();const y=this.getOwnLayerSourceCache(g),b=!!this.directionalLight&&this.directionalLight.shadowsEnabled();y&&g.canCastShadows()&&b&&(y.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const d=this.stylesheet.terrain;d&&(void 0===this.disableElevatedTerrain&&(this.disableElevatedTerrain=Mn.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?gt("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(d,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new de("data",{dataType:"style"})),t.imports?this._loadImports(t.imports,r).then(()=>this._reloadImports()):this._reloadImports()}isRootStyle(){return 0===this.importDepth}mergeAll(){let t,r,s,c,d,f,g,y;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(b=>{if(b.stylesheet){if(null!=b.light&&(t=b.light),b.stylesheet.lights)for(const w of b.stylesheet.lights)"ambient"===w.type&&null!=b.ambientLight&&(r=b.ambientLight),"directional"===w.type&&null!=b.directionalLight&&(s=b.directionalLight);c=this._prioritizeTerrain(c,b.terrain,b.stylesheet.terrain),b.stylesheet.fog&&null!=b.fog&&(d=b.fog),null!=b.stylesheet.camera&&(y=b.stylesheet.camera),null!=b.stylesheet.projection&&(f=b.stylesheet.projection),null!=b.stylesheet.transition&&(g=b.stylesheet.transition)}}),this.light=t,this.ambientLight=r,this.directionalLight=s,this.fog=d,null===c?delete this.terrain:this.terrain=c,this.camera=y||{"camera-projection":"perspective"},this.projection=f||{name:"mercator"},this.transition=_t({},Xb,g),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(t){const r=s=>{for(const c of s.fragments)r(c.style);t(s)};r(this)}_prioritizeTerrain(t,r,s){const c=t&&0===t.drapeRenderMode;return null===s?r&&0===r.drapeRenderMode?r:c?t:null:null!=r&&(!t||c||r&&1===r.drapeRenderMode)?r:t}mergeTerrain(){let t;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(r=>{t=this._prioritizeTerrain(t,r.terrain,r.stylesheet.terrain)}),null===t?delete this.terrain:this.terrain=t}mergeProjection(){let t;this.forEachFragmentStyle(r=>{null!=r.stylesheet.projection&&(t=r.stylesheet.projection)}),this.projection=t||{name:"mercator"}}mergeSources(){const t={},r={},s={};this.forEachFragmentStyle(c=>{for(const d in c._sourceCaches){const f=sn(d,c.scope);t[f]=c._sourceCaches[d]}for(const d in c._otherSourceCaches){const f=sn(d,c.scope);r[f]=c._otherSourceCaches[d]}for(const d in c._symbolSourceCaches){const f=sn(d,c.scope);s[f]=c._symbolSourceCaches[d]}}),this._mergedSourceCaches=t,this._mergedOtherSourceCaches=r,this._mergedSymbolSourceCaches=s}mergeLayers(){const t={},r=[],s={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(d=>{for(const f of d._order){const g=d._layers[f];if("slot"===g.type){const y=ti(f);if(t[y])continue;t[y]=[]}g.slot&&t[g.slot]?t[g.slot].push(g):r.push(g)}}),this._mergedOrder=[];const c=(d=[])=>{for(const f of d)if("slot"===f.type){const g=ti(f.id);t[g]&&c(t[g])}else{const g=sn(f.id,f.scope);this._mergedOrder.push(g),s[g]=f,f.is3D()&&(this._has3DLayers=!0),"circle"===f.type&&(this._hasCircleLayers=!0),"symbol"===f.type&&(this._hasSymbolLayers=!0)}};c(r),this._mergedLayers=s,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}getCamera(){return this.stylesheet.camera}setCamera(t){return this.stylesheet.camera=_t({},this.stylesheet.camera,t),this.camera=this.stylesheet.camera,this}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(t){this._spriteRequest=function(r,s,c){let d,f,g;const y=Mn.devicePixelRatio>1?"@2x":"";let b=_e(s.transformRequest(s.normalizeSpriteURL(r,y,".json"),Ft.SpriteJSON),(O,I)=>{b=null,g||(g=O,d=I,P())}),w=Bt(s.transformRequest(s.normalizeSpriteURL(r,y,".png"),Ft.SpriteImage),(O,I)=>{w=null,g||(g=O,f=I,P())});function P(){if(g)c(g);else if(d&&f){const O=Mn.getImageData(f),I={};for(const A in d){const{width:l,height:u,x:p,y:m,sdf:v,pixelRatio:C,stretchX:E,stretchY:T,content:k}=d[A],N=new Uo({width:l,height:u});Uo.copy(O,N,{x:p,y:m},{x:0,y:0},{width:l,height:u}),I[A]={data:N,pixelRatio:C,sdf:v,stretchX:E,stretchY:T,content:k}}c(null,I)}}return{cancel(){b&&(b.cancel(),b=null),w&&(w.cancel(),w=null)}}}(t,this.map._requestManager,(r,s)=>{if(this._spriteRequest=null,r)this.fire(new Cn(r));else if(s)for(const c in s)this.imageManager.addImage(c,this.scope,s[c]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new de("data",{dataType:"style"}))})}_validateLayer(t){const r=this.getOwnSource(t.source);if(!r)return;const s=t.sourceLayer;s&&("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(s))&&this.fire(new Cn(new Error(`Source layer "${s}" does not exist on source "${r.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:t}of this.fragments)if(!t.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((t,r)=>{const s=this.fragments[r];return s&&s.style&&(t.data=s.style.serialize()),t})}_serializeSources(){const t={};for(const r in this._sourceCaches){const s=this._sourceCaches[r].getSource();t[s.id]||(t[s.id]=s.serialize())}return t}_serializeLayers(t){const r=[];for(const s of t){const c=this._layers[s];c&&"custom"!==c.type&&r.push(c.serialize())}return r}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(t){return!!this.terrain&&("function"==typeof t.isLayerDraped?t.isLayerDraped(this.getLayerSourceCache(t)):Qb.has(t.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(t){const r=this.getOwnLayer(t);if(r)return r;this.fire(new Cn(new Error(`The layer '${t}' does not exist in the map's style.`)))}_checkSource(t){const r=this.getOwnSource(t);if(r)return r;this.fire(new Cn(new Error(`The source '${t}' does not exist in the map's style.`)))}update(t){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(t),this.directionalLight&&this.directionalLight.recalculate(t);const r=this.calculateLightsBrightness();t.brightness=r||0,r!==this._brightness&&(this._brightness=r,this.dispatcher.broadcast("setBrightness",r));const s=this._changes.isDirty();if(this._changes.isDirty()){const d=this._changes.getLayerUpdatesByScope();for(const f in d){const{updatedIds:g,removedIds:y}=d[f];(g||y)&&this._updateWorkerLayers(f,g,y)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(t),this.light&&this.light.updateTransitions(t),this.ambientLight&&this.ambientLight.updateTransitions(t),this.directionalLight&&this.directionalLight.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._changes.reset()}const c={};for(const d in this._mergedSourceCaches){const f=this._mergedSourceCaches[d];c[d]=f.used,f.used=!1}for(const d of this._mergedOrder){const f=this._mergedLayers[d];if(f.recalculate(t,this._availableImages),!f.isHidden(t.zoom)){const g=this.getLayerSourceCache(f);g&&(g.used=!0)}if(!this._precompileDone&&this._shouldPrecompile)for(let g=f.minzoom||0;g<(f.maxzoom||25.5);g++){const y=this.map.painter;if(y){const b=f.getProgramIds();if(!b)continue;for(const w of b){const P=f.getDefaultProgramParams(w,t.zoom);P&&(y.style=this,this.fog&&(y._fogVisible=!0,P.overrideFog=!0,y.getOrCreateProgram(w,P)),y._fogVisible=!1,P.overrideFog=!1,y.getOrCreateProgram(w,P),(this.stylesheet.terrain||this.stylesheet.projection&&"globe"===this.stylesheet.projection.name)&&(P.overrideRtt=!0,y.getOrCreateProgram(w,P)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const d in c){const f=this._mergedSourceCaches[d];c[d]!==f.used&&f.getSource().fire(new de("data",{sourceDataType:"visibility",dataType:"source",sourceId:f.getSource().id}))}this.light&&this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),s&&this.fire(new de("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=this._changes.getUpdatedImages();if(t.length){for(const r in this._sourceCaches)this._sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],t);this._changes.resetUpdatedImages()}}_updateWorkerLayers(t,r,s){const c=this.getFragmentStyle(t);c&&this.dispatcher.broadcast("updateLayers",{layers:r?c._serializeLayers(r):[],scope:t,removedIds:s||[],options:c.options})}setState(t){if(this._checkLoaded(),Q1(this,Ea(t)))return!1;(t=et(t)).layers=D1(t.layers);const r=function(c,d){if(!c)return[{command:Vr.setStyle,args:[d]}];let f=[];try{if(!Xt(c.version,d.version))return[{command:Vr.setStyle,args:[d]}];Xt(c.center,d.center)||f.push({command:Vr.setCenter,args:[d.center]}),Xt(c.zoom,d.zoom)||f.push({command:Vr.setZoom,args:[d.zoom]}),Xt(c.bearing,d.bearing)||f.push({command:Vr.setBearing,args:[d.bearing]}),Xt(c.pitch,d.pitch)||f.push({command:Vr.setPitch,args:[d.pitch]}),Xt(c.sprite,d.sprite)||f.push({command:Vr.setSprite,args:[d.sprite]}),Xt(c.glyphs,d.glyphs)||f.push({command:Vr.setGlyphs,args:[d.glyphs]}),Xt(c.imports,d.imports)||function(P=[],O=[],I){O=O||[];const A=(P=P||[]).map(Cm),l=O.map(Cm),u=P.reduce(kl,{}),p=O.reduce(kl,{}),m=A.slice();let v,C,E,T;for(v=0,C=0;v<A.length;v++)E=A[v],p.hasOwnProperty(E)?C++:(I.push({command:Vr.removeImport,args:[E]}),m.splice(m.indexOf(E,C),1));for(v=0,C=0;v<l.length;v++)E=l[l.length-1-v],m[m.length-1-v]!==E&&(u.hasOwnProperty(E)?(I.push({command:Vr.removeImport,args:[E]}),m.splice(m.lastIndexOf(E,m.length-C),1)):C++,T=m[m.length-v],I.push({command:Vr.addImport,args:[p[E],T]}),m.splice(m.length-v,0,E));for(const k of O){const N=u[k.id];if(!N||Xt(N,k))continue;Xt(N.config,k.config)||I.push({command:Vr.setImportConfig,args:[k.id,k.config]}),Xt(N.url,k.url)||I.push({command:Vr.setImportUrl,args:[k.id,k.url]});const F=k.data;Xt(N&&N.data,F)||I.push({command:Vr.setImportData,args:[k.id,F]})}}(c.imports,d.imports,f),Xt(c.transition,d.transition)||f.push({command:Vr.setTransition,args:[d.transition]}),Xt(c.light,d.light)||f.push({command:Vr.setLight,args:[d.light]}),Xt(c.fog,d.fog)||f.push({command:Vr.setFog,args:[d.fog]}),Xt(c.projection,d.projection)||f.push({command:Vr.setProjection,args:[d.projection]}),Xt(c.lights,d.lights)||f.push({command:Vr.setLights,args:[d.lights]}),Xt(c.camera,d.camera)||f.push({command:Vr.setCamera,args:[d.camera]});const g={},y=[];!function(P,O,I,A){let l;for(l in O=O||{},P=P||{})P.hasOwnProperty(l)&&(O.hasOwnProperty(l)||hh(l,I,A));for(l in O){if(!O.hasOwnProperty(l))continue;const u=O[l];P.hasOwnProperty(l)?Xt(P[l],u)||("geojson"===P[l].type&&"geojson"===u.type&&qC(P,O,l)?I.push({command:Vr.setGeoJSONSourceData,args:[l,u.data]}):JE(l,O,I,A)):Lb(l,O,I)}}(c.sources,d.sources,y,g);const b=[];c.layers&&c.layers.forEach(P=>{P.source&&g[P.source]?f.push({command:Vr.removeLayer,args:[P.id]}):b.push(P)});let w=c.terrain;w&&g[w.source]&&(f.push({command:Vr.setTerrain,args:[void 0]}),w=void 0),f=f.concat(y),Xt(w,d.terrain)||f.push({command:Vr.setTerrain,args:[d.terrain]}),function(P,O,I){O=O||[];const A=(P=P||[]).map(Cm),l=O.map(Cm),u=P.reduce(kl,{}),p=O.reduce(kl,{}),m=A.slice(),v=Object.create(null);let C,E,T,k,N,F,$;for(C=0,E=0;C<A.length;C++)T=A[C],p.hasOwnProperty(T)?E++:(I.push({command:Vr.removeLayer,args:[T]}),m.splice(m.indexOf(T,E),1));for(C=0,E=0;C<l.length;C++)T=l[l.length-1-C],m[m.length-1-C]!==T&&(u.hasOwnProperty(T)?(I.push({command:Vr.removeLayer,args:[T]}),m.splice(m.lastIndexOf(T,m.length-E),1)):E++,F=m[m.length-C],I.push({command:Vr.addLayer,args:[p[T],F]}),m.splice(m.length-C,0,T),v[T]=!0);for(C=0;C<l.length;C++)if(T=l[C],k=u[T],N=p[T],!v[T]&&!Xt(k,N))if(Xt(k.source,N.source)&&Xt(k["source-layer"],N["source-layer"])&&Xt(k.type,N.type)){for($ in Nb(k.layout,N.layout,I,T,null,Vr.setLayoutProperty),Nb(k.paint,N.paint,I,T,null,Vr.setPaintProperty),Xt(k.slot,N.slot)||I.push({command:Vr.setSlot,args:[T,N.slot]}),Xt(k.filter,N.filter)||I.push({command:Vr.setFilter,args:[T,N.filter]}),Xt(k.minzoom,N.minzoom)&&Xt(k.maxzoom,N.maxzoom)||I.push({command:Vr.setLayerZoomRange,args:[T,N.minzoom,N.maxzoom]}),k)k.hasOwnProperty($)&&"layout"!==$&&"paint"!==$&&"filter"!==$&&"metadata"!==$&&"minzoom"!==$&&"maxzoom"!==$&&"slot"!==$&&(0===$.indexOf("paint.")?Nb(k[$],N[$],I,T,$.slice(6),Vr.setPaintProperty):Xt(k[$],N[$])||I.push({command:Vr.setLayerProperty,args:[T,$,N[$]]}));for($ in N)N.hasOwnProperty($)&&!k.hasOwnProperty($)&&"layout"!==$&&"paint"!==$&&"filter"!==$&&"metadata"!==$&&"minzoom"!==$&&"maxzoom"!==$&&"slot"!==$&&(0===$.indexOf("paint.")?Nb(k[$],N[$],I,T,$.slice(6),Vr.setPaintProperty):Xt(k[$],N[$])||I.push({command:Vr.setLayerProperty,args:[T,$,N[$]]}))}else I.push({command:Vr.removeLayer,args:[T]}),F=m[m.lastIndexOf(T)+1],I.push({command:Vr.addLayer,args:[N,F]})}(b,d.layers,f)}catch(g){console.warn("Unable to compute style diff:",g),f=[{command:Vr.setStyle,args:[d]}]}return f}(this.serialize(),t).filter(c=>!(c.command in eg));if(0===r.length)return!1;const s=r.filter(c=>!(c.command in cD));if(s.length>0)throw new Error(`Unimplemented: ${s.map(c=>c.command).join(", ")}.`);return r.forEach(c=>{this[c.command].apply(this,c.args)}),this.stylesheet=t,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(t,r){return this.getImage(t)?this.fire(new Cn(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,this.scope,r),this._afterImageUpdated(t),this)}updateImage(t,r){this.imageManager.updateImage(t,this.scope,r)}getImage(t){return this.imageManager.getImage(t,this.scope)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t,this.scope),this._afterImageUpdated(t),this):this.fire(new Cn(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(t),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new de("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(t,r,s={}){return this._checkLoaded(),this._validate(es,`models.${t}`,r,null,s)||(this.modelManager.addModel(t,r,this.scope),this._changes.setDirty()),this}hasModel(t){return this.modelManager.hasModel(t,this.scope)}removeModel(t){return this.hasModel(t)?(this.modelManager.removeModel(t,this.scope),this):this.fire(new Cn(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(t,r,s={}){if(this._checkLoaded(),void 0!==this.getOwnSource(t))throw new Error(`There is already a source with ID "${t}".`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(Nd,`sources.${t}`,r,null,s))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const c=xm(t,r,this.dispatcher,this);c.scope=this.scope,c.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(c.id),source:c.serialize(),sourceId:c.id}));const d=f=>{const g=(f?"symbol:":"other:")+c.id,y=sn(g,this.scope),b=this._sourceCaches[g]=new Na(y,c,f);(f?this._symbolSourceCaches:this._otherSourceCaches)[c.id]=b,b.onAdd(this.map)};d(!1),"vector"!==r.type&&"geojson"!==r.type||d(!0),c.onAdd&&c.onAdd(this.map),s.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(t){this._checkLoaded();const r=this.getOwnSource(t);if(!r)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new Cn(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===t)return this.fire(new Cn(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const s=this.getOwnSourceCaches(t);for(const c of s){const d=ti(c.id);delete this._sourceCaches[d],this._changes.discardSourceCacheUpdate(c.id),c.fire(new de("data",{sourceDataType:"metadata",dataType:"source",sourceId:c.getSource().id})),c.setEventedParent(null),c.clearTiles()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],this.mergeSources(),r.setEventedParent(null),r.onRemove&&r.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(t,r){this._checkLoaded(),this.getOwnSource(t).setData(r),this._changes.setDirty()}getOwnSource(t){const r=this.getOwnSourceCache(t);return r&&r.getSource()}getOwnSources(){const t=[];for(const r in this._otherSourceCaches){const s=this.getOwnSourceCache(r);s&&t.push(s.getSource())}return t}setLights(t){if(this._checkLoaded(),!t)return delete this.ambientLight,void delete this.directionalLight;const r=this._getTransitionParameters();for(const c of t){if(this._validate(Ja,"lights",c))return;switch(c.type){case"ambient":if(this.ambientLight){const d=this.ambientLight;d.set(c),d.updateTransitions(r)}else this.ambientLight=new _1(c,my,this.scope,this.options);break;case"directional":if(this.directionalLight){const d=this.directionalLight;d.set(c),d.updateTransitions(r)}else this.directionalLight=new _1(c,y1,this.scope,this.options)}}const s=new Ri(this.z||0,r);this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const t=this.directionalLight,r=this.ambientLight;if(!t||!r)return;const s=P=>.2126*(P[0]<=.03928?P[0]/12.92:Math.pow((P[0]+.055)/1.055,2.4))+.7152*(P[1]<=.03928?P[1]/12.92:Math.pow((P[1]+.055)/1.055,2.4))+.0722*(P[2]<=.03928?P[2]/12.92:Math.pow((P[2]+.055)/1.055,2.4)),c=t.properties.get("color").toArray01(),d=t.properties.get("intensity"),f=t.properties.get("direction"),g=1-Ge(f.x,f.y,f.z)[2]/90,y=s(c)*d*g,b=r.properties.get("color").toArray01(),w=r.properties.get("intensity");return(y+s(b)*w)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const t=[];return this.directionalLight&&t.push(this.directionalLight.get()),this.ambientLight&&t.push(this.ambientLight.get()),t}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(t){if(!t)return this;if(un(t)){const r=function(d){const f=d.indexOf("\x1f");return f>=0?d.slice(f+1):""}(t),s=this.fragments.find(({id:d})=>d===r);if(!s)throw new Error(`Style import not found: ${t}`);const c=ti(t);return s.style.getFragmentStyle(c)}{const r=this.fragments.find(({id:s})=>s===t);if(!r)throw new Error(`Style import not found: ${t}`);return r.style}}getConfigProperty(t,r){const s=this.getFragmentStyle(t);if(!s)return null;const c=s.options.get(r),d=c?c.value||c.default:null;return d?d.serialize():null}setConfigProperty(t,r,s){const c=Wl(s);if("success"!==c.result)return void Q1(this,c.value);const d=c.value.expression,f=this.getFragmentStyle(t);if(!f)return;const g=f.options.get(r);g&&(f.options.set(r,{...g,value:d}),f.updateConfigDependencies())}setConfig(t,r){if(this._config=t,t||r)if(r){this.options.clear();for(const s in r){let c,d;const f=Wl(r[s].default);if("success"===f.result&&(c=f.value.expression),t&&void 0!==t[s]){const O=Wl(t[s]);"success"===O.result&&(d=O.value.expression)}const{minValue:g,maxValue:y,stepValue:b,type:w,values:P}=r[s];c?this.options.set(s,{default:c,value:d,minValue:g,maxValue:y,stepValue:b,type:w,values:P}):this.fire(new Cn(new Error(`No schema defined for config option "${s}".`)))}}else this.fire(new Cn(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const t of this._configDependentLayers){const r=this.getLayer(t);r&&(r.possiblyEvaluateVisibility(),this._updateLayer(r))}this.ambientLight&&this.ambientLight.scope===this.scope&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.scope===this.scope&&this.directionalLight.updateConfig(this.options),this._changes.setDirty()}addLayer(t,r,s={}){this._checkLoaded();const c=t.id;if(this._layers[c])return void this.fire(new Cn(new Error(`Layer with id "${c}" already exists on this map`)));let d;if("custom"===t.type){if(Q1(this,function(w){const P=[],O=w.id;return void 0===O&&P.push({message:`layers.${O}: missing required property "id"`}),void 0===w.render&&P.push({message:`layers.${O}: missing required method "render"`}),w.renderingMode&&"2d"!==w.renderingMode&&"3d"!==w.renderingMode&&P.push({message:`layers.${O}: property "renderingMode" must be either "2d" or "3d"`}),P}(t)))return;d=Wp(t,this.options)}else{if("object"==typeof t.source&&(this.addSource(c,t.source),t=_t(t=et(t),{source:c})),this._validate(Pg,`layers.${c}`,t,{arrayIndex:-1},s))return;d=Wp(t,this.options),this._validateLayer(d),d.setEventedParent(this,{layer:{id:c}}),this._serializedLayers[d.id]=d.serialize()}d.isConfigDependent&&this._configDependentLayers.add(d.fqid),d.setScope(this.scope);let f=this._order.length;if(r){const w=this._order.indexOf(r);if(-1===w)return void this.fire(new Cn(new Error(`Layer with id "${r}" does not exist on this map.`)));d.slot===this._layers[r].slot?f=w:gt(`Layer with id "${r}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(f,0,c),this._layerOrderChanged=!0,this._layers[c]=d;const g=this.getOwnLayerSourceCache(d),y=!!this.directionalLight&&this.directionalLight.shadowsEnabled();g&&d.canCastShadows()&&y&&(g.castsShadows=!0);const b=this._changes.getRemovedLayer(d);if(b&&d.source&&g&&"custom"!==d.type){this._changes.discardLayerRemoval(d);const w=sn(d.source,d.scope);b.type!==d.type?this._changes.updateSourceCache(w,"clear"):(this._changes.updateSourceCache(w,"reload"),g.pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map),d.scope=this.scope,this.mergeLayers()}moveLayer(t,r){this._checkLoaded();const s=this._checkLayer(t);if(!s||t===r)return;const c=this._order.indexOf(t);this._order.splice(c,1);let d=this._order.length;if(r){const f=this._order.indexOf(r);if(-1===f)return void this.fire(new Cn(new Error(`Layer with id "${r}" does not exist on this map.`)));s.slot===this._layers[r].slot?d=f:gt(`Layer with id "${r}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(d,0,t),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(t){this._checkLoaded();const r=this._checkLayer(t);if(!r)return;r.setEventedParent(null);const s=this._order.indexOf(t);this._order.splice(s,1),delete this._layers[t],delete this._serializedLayers[t],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(r.fqid),this._changes.removeLayer(r);const c=this.getOwnLayerSourceCache(r);if(c&&c.castsShadows){let d=!1;for(const f in this._layers)if(this._layers[f].source===r.source&&this._layers[f].canCastShadows()){d=!0;break}c.castsShadows=d}r.onRemove&&r.onRemove(this.map),this.mergeLayers()}getOwnLayer(t){return this._layers[t]}hasLayer(t){return t in this._mergedLayers}hasLayerType(t){for(const r in this._layers)if(this._layers[r].type===t)return!0;return!1}setLayerZoomRange(t,r,s){this._checkLoaded();const c=this._checkLayer(t);c&&(c.minzoom===r&&c.maxzoom===s||(null!=r&&(c.minzoom=r),null!=s&&(c.maxzoom=s),this._updateLayer(c)))}setSlot(t,r){this._checkLoaded();const s=this._checkLayer(t);s&&s.slot!==r&&(s.slot=r,this._updateLayer(s))}setFilter(t,r,s={}){this._checkLoaded();const c=this._checkLayer(t);if(c&&!Xt(c.filter,r))return null==r?(c.filter=void 0,void this._updateLayer(c)):void(this._validate(hp,`layers.${c.id}.filter`,r,{layerType:c.type},s)||(c.filter=et(r),this._updateLayer(c)))}getFilter(t){const r=this._checkLayer(t);if(r)return et(r.filter)}setLayoutProperty(t,r,s,c={}){this._checkLoaded();const d=this._checkLayer(t);d&&(Xt(d.getLayoutProperty(r),s)||(d.setLayoutProperty(r,s,c),d.isConfigDependent&&this._configDependentLayers.add(d.fqid),this._updateLayer(d)))}getLayoutProperty(t,r){const s=this._checkLayer(t);if(s)return s.getLayoutProperty(r)}setPaintProperty(t,r,s,c={}){this._checkLoaded();const d=this._checkLayer(t);if(!d||Xt(d.getPaintProperty(r),s))return;const f=d.setPaintProperty(r,s,c);d.isConfigDependent&&this._configDependentLayers.add(d.fqid),f&&this._updateLayer(d),this._changes.updatePaintProperties(d)}getPaintProperty(t,r){const s=this._checkLayer(t);if(s)return s.getPaintProperty(r)}setFeatureState(t,r){this._checkLoaded();const s=t.source,c=t.sourceLayer,d=this._checkSource(s);if(!d)return;const f=d.type;if("geojson"===f&&c)return void this.fire(new Cn(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===f&&!c)return void this.fire(new Cn(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===t.id&&this.fire(new Cn(new Error("The feature id parameter must be provided.")));const g=this.getOwnSourceCaches(s);for(const y of g)y.setFeatureState(c,t.id,r)}removeFeatureState(t,r){this._checkLoaded();const s=t.source,c=this._checkSource(s);if(!c)return;const d=c.type,f="vector"===d?t.sourceLayer:void 0;if("vector"===d&&!f)return void this.fire(new Cn(new Error("The sourceLayer parameter must be provided for vector source types.")));if(r&&"string"!=typeof t.id&&"number"!=typeof t.id)return void this.fire(new Cn(new Error("A feature id is required to remove its specific state property.")));const g=this.getOwnSourceCaches(s);for(const y of g)y.removeFeatureState(f,t.id,r)}getFeatureState(t){this._checkLoaded();const r=t.source,s=t.sourceLayer,c=this._checkSource(r);if(c){if("vector"!==c.type||s)return void 0===t.id&&this.fire(new Cn(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(r)[0].getFeatureState(s,t.id);this.fire(new Cn(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(t){return this.stylesheet.transition=_t({},this.stylesheet.transition,t),this.transition=this.stylesheet.transition,this}getTransition(){return _t({},this.stylesheet.transition)}serialize(){this._checkLoaded();const t=this.getTerrain(),r=t&&this.terrain&&this.terrain.scope===this.scope?t:this.stylesheet.terrain;return ce({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:r,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},s=>void 0!==s)}_updateLayer(t){this._changes.updateLayer(t);const r=this.getLayerSourceCache(t),s=sn(t.source,t.scope),c=this._changes.getUpdatedSourceCaches();t.source&&!c[s]&&r&&"raster"!==r.getSource().type&&(this._changes.updateSourceCache(s,"reload"),r.pause()),t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const r=g=>"fill-extrusion"===this._mergedLayers[g].type,s=this.order,c={},d=[];for(let g=s.length-1;g>=0;g--){const y=s[g];if(r(y)){c[y]=g;for(const b of t){const w=b[y];if(w)for(const P of w)d.push(P)}}}d.sort((g,y)=>y.intersectionZ-g.intersectionZ);const f=[];for(let g=s.length-1;g>=0;g--){const y=s[g];if(r(y))for(let b=d.length-1;b>=0;b--){const w=d[b].feature;if(c[w.layer.id]<g)break;f.push(w),d.pop()}else for(const b of t){const w=b[y];if(w)for(const P of w)f.push(P.feature)}}return f}queryRenderedFeatures(t,r,s){r&&r.filter&&this._validate(hp,"queryRenderedFeatures.filter",r.filter,null,r),r.scope=this.scope,r.availableImages=this._availableImages,r.serializedLayers=this._serializedLayers;const c={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new Cn(new Error("parameters.layers must be an Array."))),[];for(const b of r.layers){const w=this._mergedLayers[b];if(!w)return this.fire(new Cn(new Error(`The layer '${b}' does not exist in the map's style and cannot be queried for features.`))),[];c[w.source]=!0}}const d=[],f=r.serializedLayers||{},g=r&&r.layers?r.layers.some(b=>{const w=this.getLayer(b);return w&&w.is3D()}):this.has3DLayers(),y=Ib.createFromScreenPoints(t,s);for(const b in this._mergedSourceCaches){const w=this._mergedSourceCaches[b].getSource();if(!w||w.scope!==r.scope)continue;const P=this._mergedSourceCaches[b].getSource().id;r.layers&&!c[P]||d.push(HC(this._mergedSourceCaches[b],this._mergedLayers,f,y,r,s,g,!!this.map._showQueryGeometry))}return this.placement&&d.push(function(b,w,P,O,I,A,l){const u={},p=A.queryRenderedSymbols(O),m=[];for(const v of Object.keys(p).map(Number))m.push(l[v]);m.sort(wm);for(const v of m){const C=v.featureIndex.lookupSymbolFeatures(p[v.bucketInstanceId],w,v.bucketIndex,v.sourceLayerIndex,I.filter,I.layers,I.availableImages,b);for(const E in C){const T=u[E]=u[E]||[],k=C[E];k.sort((N,F)=>{const $=v.featureSortOrder;if($){const q=$.indexOf(N.featureIndex);return $.indexOf(F.featureIndex)-q}return F.featureIndex-N.featureIndex});for(const N of k)T.push(N)}}for(const v in u)u[v].forEach(C=>{const E=C.feature,T=P(b[v]);if(!T)return;const k=T.getFeatureState(E.layer["source-layer"],E.id);E.source=E.layer.source,E.layer["source-layer"]&&(E.sourceLayer=E.layer["source-layer"]),E.state=k});return u}(this._mergedLayers,f,this.getLayerSourceCache.bind(this),y.screenGeometry,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(t,r){r&&r.filter&&this._validate(hp,"querySourceFeatures.filter",r.filter,null,r);const s=this.getOwnSourceCaches(t);let c=[];for(const d of s)c=c.concat(XE(d,r));return c}addSourceType(t,r,s){return ph.getSourceType(t)?s(new Error(`A source type called "${t}" already exists.`)):(ph.setSourceType(t,r),r.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:r.workerSourceURL},s):s(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,r,s={}){this._checkLoaded();const c=this.light.getLight();let d=!1;for(const g in t)if(!Xt(t[g],c[g])){d=!0;break}if(!d)return;const f=this._getTransitionParameters();this.light.setLight(t,r,s),this.light.updateTransitions(f)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,r=1){if(this._checkLoaded(),!t)return delete this.terrain,null===t?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let s=t;const c=null==t.source;if(1===r){if("object"==typeof s.source){const g="terrain-dem-src";this.addSource(g,s.source),s=et(s),s=_t(s,{source:g})}const d=_t({},s),f={};if(this.terrain&&c){d.source=this.terrain.get().source;const g=this.terrain?this.getFragmentStyle(this.terrain.scope):null;g&&(f.style=g.serialize())}if(this._validate(Fd,"terrain",d,f))return}if(!this.terrain||this.terrain.scope!==this.scope&&!c||this.terrain&&r!==this.terrain.drapeRenderMode){if(!s)return;this._createTerrain(s,r),this.fire(new de("data",{dataType:"style"}))}else{const d=this.terrain,f=d.get();for(const g of Object.keys(wt.terrain))!s.hasOwnProperty(g)&&wt.terrain[g].default&&(s[g]=wt.terrain[g].default);for(const g in t)if(!Xt(t[g],f[g])){d.set(t,this.options),this.stylesheet.terrain=t;const y=this._getTransitionParameters({duration:0});d.updateTransitions(y),this.fire(new de("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const r=this.fog=new zE(t,this.map.transform);this.stylesheet.fog=r.get();const s=this._getTransitionParameters({duration:0});r.updateTransitions(s)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const r=this.fog;if(!Xt(r.get(),t)){r.set(t),this.stylesheet.fog=r.get();const s=this._getTransitionParameters({duration:0});r.updateTransitions(s)}}else this._createFog(t);this._markersNeedUpdate=!0}_getTransitionParameters(t){return{now:Mn.now(),transition:_t(this.transition,t)}}updateDrapeFirstLayers(){if(!this.terrain)return;const t=[],r=[];for(const s in this._mergedLayers)this.isLayerDraped(this._mergedLayers[s])?t.push(s):r.push(s);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...r)}_createTerrain(t,r){const s=this.terrain=new Pb(t,r,this.scope,this.options);1===r&&(this.stylesheet.terrain=t),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const c=this._getTransitionParameters({duration:0});s.updateTransitions(c)}_force3DLayerUpdate(){for(const t in this._layers){const r=this._layers[t];"fill-extrusion"===r.type&&this._updateLayer(r)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const r=this._layers[t];"symbol"===r.type&&this._updateLayer(r)}}_validate(t,r,s,c,d={}){if(d&&!1===d.validate)return!1;const f=_t({},this.serialize());return Q1(this,t.call(Ea,_t({key:r,style:f,value:s,styleSpec:wt},c)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),Ta.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._mergedLayers)this._mergedLayers[t].setEventedParent(null);for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles(),this._mergedSourceCaches[t].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(t){const r=this.getSourceCaches(t);for(const s of r)s.clearTiles()}clearSources(){for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles()}reloadSource(t){const r=this.getSourceCaches(t);for(const s of r)s.resume(),s.reload()}reloadSources(){for(const t of this.getSources())t.reload&&t.reload()}updateSources(t){let r;this.directionalLight&&(r=X1(this.directionalLight));for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].update(t,void 0,void 0,r)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const r=this._sourceCaches[t];r.resume(),r.reload()}}_updatePlacement(t,r,s,c,d=!1){let f=!1,g=!1;const y={},b={};for(const w of this._mergedOrder){const P=this._mergedLayers[w];if("symbol"!==P.type)continue;const O=sn(P.source,P.scope);let I=y[O];if(!I){const l=this.getLayerSourceCache(P);if(!l)continue;const u=l.getRenderableIds(!0).map(p=>l.getTileByID(p));b[O]=u.slice(),I=y[O]=u.sort((p,m)=>m.tileID.overscaledZ-p.tileID.overscaledZ||(p.tileID.isLessThan(m.tileID)?-1:1))}const A=this.crossTileSymbolIndex.addLayer(P,I,t.center.lng,t.projection);f=f||A}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),d=d||this._layerOrderChanged||0===s,this._layerOrderChanged&&this.fire(new de("neworder")),(d||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Mn.now(),t.zoom))&&(this.pauseablePlacement=new As(t,this._mergedOrder,d,r,s,c,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,y,b),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Mn.now()),g=!0),f&&this.pauseablePlacement.placement.setStale()),g||f)for(const w of this._mergedOrder){const P=this._mergedLayers[w];"symbol"===P.type&&this.placement.updateLayerOpacities(P,y[sn(P.source,P.scope)])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Mn.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}addImport(t){this._checkLoaded();const r=this.stylesheet.imports=this.stylesheet.imports||[];return-1!==r.findIndex(({id:c})=>c===t.id)?this.fire(new Cn(new Error(`Import with id '${t.id}' already exists in the map's style.`))):(r.push(t),this._loadImports([t],!0),this)}setImportUrl(t,r){this._checkLoaded();const s=this.stylesheet.imports||[],c=this.getImportIndex(t);if(-1===c)return this;s[c].url=r;const d=this.fragments[c];return d.style=this._createFragmentStyle(s[c]),d.style.on("style.import.load",()=>this.mergeAll()),d.style.loadURL(r),this}setImportData(t,r){this._checkLoaded();const s=this.getImportIndex(t),c=this.stylesheet.imports||[];return-1===s?this:r?(this.fragments[s].style.setState(r),this._reloadImports(),this):(delete c[s].data,this.setImportUrl(t,c[s].url))}setImportConfig(t,r){this._checkLoaded();const s=this.getImportIndex(t),c=this.stylesheet.imports||[];if(-1===s)return this;r?c[s].config=r:delete c[s].config;const d=this.fragments[s],f=d.style.stylesheet&&d.style.stylesheet.schema;return d.config=r,d.style.setConfig(r,f),d.style.updateConfigDependencies(),this}removeImport(t){this._checkLoaded();const r=this.stylesheet.imports||[],s=this.getImportIndex(t);return-1===s||(r.splice(s,1),this.fragments[s].style._remove(),this.fragments.splice(s,1),this._reloadImports()),this}getImportIndex(t){const r=(this.stylesheet.imports||[]).findIndex(s=>s.id===t);return-1===r&&this.fire(new Cn(new Error(`Import '${t}' does not exist in the map's style and cannot be updated.`))),r}getLayer(t){return this._mergedLayers[t]}getSources(){const t=[];for(const r in this._mergedOtherSourceCaches){const s=this._mergedOtherSourceCaches[r];s&&t.push(s.getSource())}return t}getSource(t,r){const s=this.getSourceCache(t,r);return s&&s.getSource()}getLayerSource(t){const r=this.getLayerSourceCache(t);return r&&r.getSource()}getSourceCache(t,r){const s=sn(t,r);return this._mergedOtherSourceCaches[s]}getLayerSourceCache(t){const r=sn(t.source,t.scope);return"symbol"===t.type?this._mergedSymbolSourceCaches[r]:this._mergedOtherSourceCaches[r]}getSourceCaches(t){const r=[];return this._mergedOtherSourceCaches[t]&&r.push(this._mergedOtherSourceCaches[t]),this._mergedSymbolSourceCaches[t]&&r.push(this._mergedSymbolSourceCaches[t]),r}updateSourceCaches(){const t=this._changes.getUpdatedSourceCaches();for(const r in t){const s=t[r];"reload"===s?this.reloadSource(r):"clear"===s&&this.clearSource(r)}}updateLayers(t){const r=this._changes.getUpdatedPaintProperties();for(const s of r){const c=this.getLayer(s);c&&c.updateTransitions(t)}}getImages(t,r,s){this.imageManager.getImages(r.icons,r.scope,s),this._updateTilesForChangedImages();const c=d=>{d&&d.setDependencies(r.tileID.key,r.type,r.icons)};c(this._otherSourceCaches[r.source]),c(this._symbolSourceCaches[r.source])}getGlyphs(t,r,s){this.glyphManager.getGlyphs(r.stacks,r.scope,s)}getResource(t,r,s){return le(r,s)}getOwnSourceCache(t){return this._otherSourceCaches[t]}getOwnLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}getOwnSourceCaches(t){const r=[];return this._otherSourceCaches[t]&&r.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&r.push(this._symbolSourceCaches[t]),r}_isSourceCacheLoaded(t){const r=this.getOwnSourceCaches(t);return 0===r.length?(this.fire(new Cn(new Error(`There is no source with ID '${t}'`))),!1):r.every(s=>s.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function $S(e,t){let r=!1,s=null;const c=()=>{s=null,r&&(e(),s=setTimeout(c,t),r=!1)};return()=>(r=!0,s||c(),s)}ph.getSourceType=function(e){return Rb[e]},ph.setSourceType=function(e,t){Rb[e]=t},ph.registerForPluginStateChange=function(e){return e({pluginStatus:oo,pluginURL:Oa}),Ta.on("pluginStateChange",e),e};class _I{constructor(t){this._hashName=t&&encodeURIComponent(t),Tn(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=$S(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,lt.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),lt.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const r=Nf(t);if(this._hashName){const s=this._hashName;let c=!1;const d=lt.location.hash.slice(1).split("&").map(f=>{const g=f.split("=")[0];return g===s?(c=!0,`${g}=${r}`):f}).filter(f=>f);return c||d.push(`${s}=${r}`),`#${d.join("&")}`}return`#${r}`}_getCurrentHash(){const t=lt.location.hash.replace("#","");if(this._hashName){let r;return t.split("&").map(s=>s.split("=")).forEach(s=>{s[0]===this._hashName&&(r=s)}),(r&&r[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const r=this._getCurrentHash();if(r.length>=3&&!r.some(s=>isNaN(s))){const s=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(r[3]||0):t.getBearing();return t.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:s,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=lt.location.href.replace(/(#.+)?$/,this.getHashString());lt.history.replaceState(lt.history.state,null,t)}}function Nf(e,t){const r=e.getCenter(),s=Math.round(100*e.getZoom())/100,c=Math.ceil((s*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,c),f=Math.round(r.lng*d)/d,g=Math.round(r.lat*d)/d,y=e.getBearing(),b=e.getPitch();let w=t?`/${f}/${g}/${s}`:`${s}/${g}/${f}`;return(y||b)&&(w+="/"+Math.round(10*y)/10),b&&(w+=`/${Math.round(b)}`),w}const wM={linearity:.3,easing:us(0,0,.3,1)},GS=_t({deceleration:2500,maxSpeed:1400},wM),uD=_t({deceleration:20,maxSpeed:1400},wM),dD=_t({deceleration:1e3,maxSpeed:360},wM),hD=_t({deceleration:1e3,maxSpeed:90},wM);class fD{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Mn.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,r=Mn.now();for(;t.length>0&&r-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const r={zoom:0,bearing:0,pitch:0,pan:new tt(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)r.zoom+=d.zoomDelta||0,r.bearing+=d.bearingDelta||0,r.pitch+=d.pitchDelta||0,d.panDelta&&r.pan._add(d.panDelta),d.around&&(r.around=d.around),d.pinchAround&&(r.pinchAround=d.pinchAround);const s=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,c={};if(r.pan.mag()){const d=J1(r.pan.mag(),s,_t({},GS,t||{}));c.offset=r.pan.mult(d.amount/r.pan.mag()),c.center=this._map.transform.center,SO(c,d)}if(r.zoom){const d=J1(r.zoom,s,uD);c.zoom=this._map.transform.zoom+d.amount,SO(c,d)}if(r.bearing){const d=J1(r.bearing,s,dD);c.bearing=this._map.transform.bearing+Ne(d.amount,-179,179),SO(c,d)}if(r.pitch){const d=J1(r.pitch,s,hD);c.pitch=this._map.transform.pitch+d.amount,SO(c,d)}if(c.zoom||c.bearing){const d=void 0===r.pinchAround?r.around:r.pinchAround;c.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),c.noMoveStart=!0,c}}function SO(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function J1(e,t,r){const{maxSpeed:s,linearity:c,deceleration:d}=r,f=Ne(e*c/(t/1e3),-s,s),g=Math.abs(f)/(d*c);return{easing:r.easing,duration:1e3*g,amount:f*(g/2)}}class za extends de{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,s,c={}){const d=vo(r.getCanvasContainer(),s);super(t,_t({point:d,lngLat:r.unproject(d),originalEvent:s},c)),this._defaultPrevented=!1,this.target=r}}class tw extends de{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,s){const c="touchend"===t?s.changedTouches:s.touches,d=lu(r.getCanvasContainer(),c),f=d.map(y=>r.unproject(y)),g=d.reduce((y,b,w,P)=>y.add(b.div(P.length)),new tt(0,0));super(t,{points:d,point:g,lngLats:f,lngLat:r.unproject(g),originalEvent:s}),this._defaultPrevented=!1}}class HS extends de{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,s){super(t,{originalEvent:s}),this._defaultPrevented=!1}}class Ry{constructor(t,r){this._map=t,this._clickTolerance=r.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new HS(t.type,this._map,t))}mousedown(t,r){return this._mousedownPos=r,this._firePreventable(new za(t.type,this._map,t))}mouseup(t){this._map.fire(new za(t.type,this._map,t))}preclick(t){const r=_t({},t);r.type="preclick",this._map.fire(new za(r.type,this._map,r))}click(t,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||(this.preclick(t),this._map.fire(new za(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new za(t.type,this._map,t))}mouseover(t){this._map.fire(new za(t.type,this._map,t))}mouseout(t){this._map.fire(new za(t.type,this._map,t))}touchstart(t){return this._firePreventable(new tw(t.type,this._map,t))}touchmove(t){this._map.fire(new tw(t.type,this._map,t))}touchend(t){this._map.fire(new tw(t.type,this._map,t))}touchcancel(t){this._map.fire(new tw(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ff{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new za(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new za("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new za(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class yI{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,r){this.isEnabled()&&t.shiftKey&&0===t.button&&($f(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(t,r){if(!this._active)return;const s=r,c=this._startPos,d=this._lastPos;if(!c||!d||d.equals(s)||!this._box&&s.dist(c)<this._clickTolerance)return;this._lastPos=s,this._box||(this._box=ei("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const f=Math.min(c.x,s.x),g=Math.max(c.x,s.x),y=Math.min(c.y,s.y),b=Math.max(c.y,s.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${f}px,${y}px)`,this._box.style.width=g-f+"px",this._box.style.height=b-y+"px")})}mouseupWindow(t,r){if(!this._active)return;const s=this._startPos,c=r;if(s&&0===t.button){if(this.reset(),_h(),s.x!==c.x||s.y!==c.y)return this._map.fire(new de("boxzoomend",{originalEvent:t})),{cameraAnimation:d=>d.fitScreenCoordinates(s,c,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Hy(),delete this._startPos,delete this._lastPos}_fireEvent(t,r){return this._map.fire(new de(t,{originalEvent:r}))}}function Jb(e,t){const r={};for(let s=0;s<e.length;s++)r[e[s].identifier]=t[s];return r}class CM{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,r,s){(this.centroid||s.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),s.length===this.numTouches&&(this.centroid=function(c){const d=new tt(0,0);for(const f of c)d._add(f);return d.div(c.length)}(r),this.touches=Jb(s,r)))}touchmove(t,r,s){if(this.aborted||!this.centroid)return;const c=Jb(s,r);for(const d in this.touches){const f=c[d];(!f||f.dist(this.touches[d])>30)&&(this.aborted=!0)}}touchend(t,r,s){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===s.length){const c=!this.aborted&&this.centroid;if(this.reset(),c)return c}}}class MM{constructor(t){this.singleTap=new CM(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,r,s){this.singleTap.touchstart(t,r,s)}touchmove(t,r,s){this.singleTap.touchmove(t,r,s)}touchend(t,r,s){const c=this.singleTap.touchend(t,r,s);if(c){const d=t.timeStamp-this.lastTime<500,f=!this.lastTap||this.lastTap.dist(c)<30;if(d&&f||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}}}class PM{constructor(){this._zoomIn=new MM({numTouches:1,numTaps:2}),this._zoomOut=new MM({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,r,s){this._zoomIn.touchstart(t,r,s),this._zoomOut.touchstart(t,r,s)}touchmove(t,r,s){this._zoomIn.touchmove(t,r,s),this._zoomOut.touchmove(t,r,s)}touchend(t,r,s){const c=this._zoomIn.touchend(t,r,s),d=this._zoomOut.touchend(t,r,s);return c?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:f=>f.easeTo({duration:300,zoom:f.getZoom()+1,around:f.unproject(c)},{originalEvent:t})}):d?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:f=>f.easeTo({duration:300,zoom:f.getZoom()-1,around:f.unproject(d)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const EM={0:1,2:2};class t0{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,r){return!1}_move(t,r){return{}}mousedown(t,r){if(this._lastPoint)return;const s=Gf(t);this._correctButton(t,s)&&(this._lastPoint=r,this._eventButton=s)}mousemoveWindow(t,r){const s=this._lastPoint;if(s)if(t.preventDefault(),null!=this._eventButton&&function(c,d){const f=EM[d];return void 0===c.buttons||(c.buttons&f)!==f}(t,this._eventButton))this.reset();else if(this._moved||!(r.dist(s)<this._clickTolerance))return this._moved=!0,this._lastPoint=r,this._move(s,r)}mouseupWindow(t){this._lastPoint&&Gf(t)===this._eventButton&&(this._moved&&_h(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pD extends t0{mousedown(t,r){super.mousedown(t,r),this._lastPoint&&(this._active=!0)}_correctButton(t,r){return 0===r&&!t.ctrlKey}_move(t,r){return{around:r,panDelta:r.sub(t)}}}class qS extends t0{_correctButton(t,r){return 0===r&&t.ctrlKey||2===r}_move(t,r){const s=.8*(r.x-t.x);if(s)return this._active=!0,{bearingDelta:s}}contextmenu(t){t.preventDefault()}}class ZS extends t0{_correctButton(t,r){return 0===r&&t.ctrlKey||2===r}_move(t,r){const s=-.5*(r.y-t.y);if(s)return this._active=!0,{pitchDelta:s}}contextmenu(t){t.preventDefault()}}class AO{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=r.clickTolerance||1,this.reset(),Tn(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new tt(0,0)}touchstart(t,r,s){return this._calculateTransform(t,r,s)}touchmove(t,r,s){if(this._active&&!(s.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===s.length&&!Ie())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,r,s)}}touchend(t,r,s){this._calculateTransform(t,r,s),this._active&&s.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,r,s){s.length>0&&(this._active=!0);const c=Jb(s,r),d=new tt(0,0),f=new tt(0,0);let g=0;for(const b in c){const w=c[b],P=this._touches[b];P&&(d._add(w),f._add(w.sub(P)),g++,c[b]=w)}if(this._touches=c,g<this._minTouches||!f.mag())return;const y=f.div(g);return this._sum._add(y),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(g),panDelta:y}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ei("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class OM{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,r,s){return{}}touchstart(t,r,s){this._firstTwoTouches||s.length<2||(this._firstTwoTouches=[s[0].identifier,s[1].identifier],this._start([r[0],r[1]]))}touchmove(t,r,s){const c=this._firstTwoTouches;if(!c)return;t.preventDefault();const[d,f]=c,g=ew(s,r,d),y=ew(s,r,f);if(!g||!y)return;const b=this._aroundCenter?null:g.add(y).div(2);return this._move([g,y],b,t)}touchend(t,r,s){if(!this._firstTwoTouches)return;const[c,d]=this._firstTwoTouches,f=ew(s,r,c),g=ew(s,r,d);f&&g||(this._active&&_h(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ew(e,t,r){for(let s=0;s<e.length;s++)if(e[s].identifier===r)return t[s]}function vI(e,t){return Math.log(e/t)/Math.LN2}class bI extends OM{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,r){const s=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(vI(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:vI(this._distance,s),pinchAround:r}}}function TM(e,t){return 180*e.angleWith(t)/Math.PI}class e0 extends OM{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,r){const s=this._vector;if(this._vector=t[0].sub(t[1]),s&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:TM(this._vector,s),pinchAround:r}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const r=25/(Math.PI*this._minDiameter)*360,s=this._startVector;if(!s)return!1;const c=TM(t,s);return Math.abs(c)<r}}function nw(e){return Math.abs(e.y)>Math.abs(e.x)}class WS extends OM{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,nw(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,r,s){const c=this._lastPoints;if(!c)return;const d=t[0].sub(c[0]),f=t[1].sub(c[1]);return this._map._cooperativeGestures&&!Ie()&&s.touches.length<3||(this._valid=this.gestureBeginsVertically(d,f,s.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(d.y+f.y)/2*-.5})}gestureBeginsVertically(t,r,s){if(void 0!==this._valid)return this._valid;const c=t.mag()>=2,d=r.mag()>=2;if(!c&&!d)return;if(!c||!d)return null==this._firstMove&&(this._firstMove=s),s-this._firstMove<100&&void 0;const f=t.y>0==r.y>0;return nw(t)&&nw(r)&&f}}const KS={panStep:100,bearingStep:15,pitchStep:10};class xI{constructor(){const t=KS;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let r=0,s=0,c=0,d=0,f=0;switch(t.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:t.shiftKey?s=-1:(t.preventDefault(),d=-1);break;case 39:t.shiftKey?s=1:(t.preventDefault(),d=1);break;case 38:t.shiftKey?c=1:(t.preventDefault(),f=-1);break;case 40:t.shiftKey?c=-1:(t.preventDefault(),f=1);break;default:return}return this._rotationDisabled&&(s=0,c=0),{cameraAnimation:g=>{const y=g.getZoom();g.easeTo({duration:300,easeId:"keyboardHandler",easing:DO,zoom:r?Math.round(y)+r*(t.shiftKey?2:1):y,bearing:g.getBearing()+s*this._bearingStep,pitch:g.getPitch()+c*this._pitchStep,offset:[-d*this._panStep,-f*this._panStep],center:g.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function DO(e){return e*(2-e)}const YS=4.000244140625;class wI{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._handler=r,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,Tn(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||Ie()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let r=t.deltaMode===lt.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const s=Mn.now(),c=s-(this._lastWheelEventTime||0);this._lastWheelEventTime=s,0!==r&&r%YS==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(c*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=vo(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:r,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;"wheel"===this._type&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const r=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(0!==this._delta){const b="wheel"===this._type&&Math.abs(this._delta)>YS?this._wheelZoomRate:this._defaultZoomRate;let w=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&0!==w&&(w=1/w);const P=r(),O=Math.pow(2,P),I="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):O;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(I*w))),"wheel"===this._type&&(this._startZoom=P,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const s="number"==typeof this._targetZoom?this._targetZoom:r(),c=this._startZoom,d=this._easing;let f,g=!1;if("wheel"===this._type&&c&&d){const b=Math.min((Mn.now()-this._lastWheelEventTime)/200,1);f=vn(c,s,d(b)),b<1?this._frameId||(this._frameId=!0):g=!0}else f=s,g=!0;this._active=!0,g&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let y=f-r();return y*this._lastDelta<0&&(y=0),{noInertia:!0,needsRenderFrame:!g,zoomDelta:y,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let r=Yr;if(this._prevEase){const s=this._prevEase,c=(Mn.now()-s.start)/s.duration,d=s.easing(c+.01)-s.easing(c),f=.27/Math.sqrt(d*d+1e-4)*.01;r=us(f,Math.sqrt(.0729-f*f),.25,1)}return this._prevEase={start:Mn.now(),duration:t,easing:r},r}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ei("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(lt.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class kO{constructor(t,r){this._clickZoom=t,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class XS{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,r){return t.preventDefault(),{cameraAnimation:s=>{s.easeTo({duration:300,zoom:s.getZoom()+(t.shiftKey?-1:1),around:s.unproject(r)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class RO{constructor(){this._tap=new MM({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,r,s){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?s.length>0&&(this._swipePoint=r[0],this._swipeTouch=s[0].identifier):this._tap.touchstart(t,r,s))}touchmove(t,r,s){if(this._tapTime){if(this._swipePoint){if(s[0].identifier!==this._swipeTouch)return;const c=r[0],d=c.y-this._swipePoint.y;return this._swipePoint=c,t.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(t,r,s)}touchend(t,r,s){this._tapTime?this._swipePoint&&0===s.length&&this.reset():this._tap.touchend(t,r,s)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class IM{constructor(t,r,s){this._el=t,this._mousePan=r,this._touchPan=s}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class CI{constructor(t,r,s){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=r,this._mousePitch=s}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class MI{constructor(t,r,s,c){this._el=t,this._touchZoom=r,this._touchRotate=s,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const SM=e=>e.zoom||e.drag||e.pitch||e.rotate;class AM extends de{}class PI{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,r){const s=dt.sub([],r,t);this.radius=dt.length(s[2]<0?dt.div([],s,this.constants):[s[0],s[1],0])}projectRay(t){dt.div(t,t,this.constants),dt.normalize(t,t),dt.mul(t,t,this.constants);const r=dt.scale([],t,this.radius);if(r[2]>0){const s=dt.scale([],[0,0,1],dt.dot(r,[0,0,1])),c=dt.scale([],dt.normalize([],[r[0],r[1],0]),this.radius),d=dt.add([],r,dt.scale([],dt.sub([],dt.add([],c,s),r),2));r[0]=d[0],r[1]=d[1]}return r}}function n0(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class LO{constructor(t,r){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new fD(t),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new PI,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(r),Tn(["handleEvent","handleWindowEvent"],this);const s=this._el;this._listeners=[[s,"touchstart",{passive:!0}],[s,"touchmove",{passive:!1}],[s,"touchend",void 0],[s,"touchcancel",void 0],[s,"mousedown",void 0],[s,"mousemove",void 0],[s,"mouseup",void 0],[lt.document,"mousemove",{capture:!0}],[lt.document,"mouseup",void 0],[s,"mouseover",void 0],[s,"mouseout",void 0],[s,"dblclick",void 0],[s,"click",void 0],[s,"keydown",{capture:!1}],[s,"keyup",void 0],[s,"wheel",{passive:!1}],[s,"contextmenu",void 0],[lt,"blur",void 0]];for(const[c,d,f]of this._listeners)c.addEventListener(d,c===lt.document?this.handleWindowEvent:this.handleEvent,f)}destroy(){for(const[t,r,s]of this._listeners)t.removeEventListener(r,t===lt.document?this.handleWindowEvent:this.handleEvent,s)}_addDefaultHandlers(t){const r=this._map,s=r.getCanvasContainer();this._add("mapEvent",new Ry(r,t));const c=r.boxZoom=new yI(r,t);this._add("boxZoom",c);const d=new PM,f=new XS;r.doubleClickZoom=new kO(f,d),this._add("tapZoom",d),this._add("clickZoom",f);const g=new RO;this._add("tapDragZoom",g);const y=r.touchPitch=new WS(r);this._add("touchPitch",y);const b=new qS(t),w=new ZS(t);r.dragRotate=new CI(t,b,w),this._add("mouseRotate",b,["mousePitch"]),this._add("mousePitch",w,["mouseRotate"]);const P=new pD(t),O=new AO(r,t);r.dragPan=new IM(s,P,O),this._add("mousePan",P),this._add("touchPan",O,["touchZoom","touchRotate"]);const I=new e0,A=new bI;r.touchZoomRotate=new MI(s,A,I,g),this._add("touchRotate",I,["touchPan","touchZoom"]),this._add("touchZoom",A,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ff(r));const l=r.scrollZoom=new wI(r,this);this._add("scrollZoom",l,["mousePan"]);const u=r.keyboard=new xI;this._add("keyboard",u);for(const p of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[p]&&r[p].enable(t[p])}_add(t,r,s){this._handlers.push({handlerName:t,handler:r,allowed:s}),this._handlersById[t]=r}stop(t){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!SM(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,r,s){for(const c in t)if(c!==s&&(!r||r.indexOf(c)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const r=[];for(const s of t)this._el.contains(s.target)&&r.push(s);return r}handleEvent(t,r){this._updatingCamera=!0;const s="renderFrame"===t.type,c=s?void 0:t,d={needsRenderFrame:!1},f={},g={},y=t.touches?this._getMapTouches(t.touches):void 0,b=y?lu(this._el,y):s?void 0:vo(this._el,t);for(const{handlerName:O,handler:I,allowed:A}of this._handlers){if(!I.isEnabled())continue;let l;this._blockedByActive(g,A,O)?I.reset():I[r||t.type]&&(l=I[r||t.type](t,b,y),this.mergeHandlerResult(d,f,l,O,c),l&&l.needsRenderFrame&&this._triggerRenderFrame()),(l||I.isActive())&&(g[O]=I)}const w={};for(const O in this._previousActiveHandlers)g[O]||(w[O]=c);this._previousActiveHandlers=g,(Object.keys(w).length||n0(d))&&(this._changes.push([d,f,w]),this._triggerRenderFrame()),(Object.keys(g).length||n0(d))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:P}=d;P&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],P(this._map))}mergeHandlerResult(t,r,s,c,d){if(!s)return;_t(t,s);const f={handlerName:c,originalEvent:s.originalEvent||d};void 0!==s.zoomDelta&&(r.zoom=f),void 0!==s.panDelta&&(r.drag=f),void 0!==s.pitchDelta&&(r.pitch=f),void 0!==s.bearingDelta&&(r.rotate=f)}_applyChanges(){const t={},r={},s={};for(const[c,d,f]of this._changes)c.panDelta&&(t.panDelta=(t.panDelta||new tt(0,0))._add(c.panDelta)),c.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+c.zoomDelta),c.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+c.bearingDelta),c.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+c.pitchDelta),void 0!==c.around&&(t.around=c.around),void 0!==c.aroundCoord&&(t.aroundCoord=c.aroundCoord),void 0!==c.pinchAround&&(t.pinchAround=c.pinchAround),c.noInertia&&(t.noInertia=c.noInertia),_t(r,d),_t(s,f);this._updateMapTransform(t,r,s),this._changes=[]}_updateMapTransform(t,r,s){const c=this._map,d=c.transform,f=m=>[m.x,m.y,m.z];if((m=>{const v=this._eventsInProgress.drag;return v&&!this._handlersById[v.handlerName].isActive()})()&&!n0(t)){const m=d.zoom;d.cameraElevationReference="sea",null!=this._originalZoom&&d._orthographicProjectionAtLowPitch&&"globe"!==d.projection.name&&0===d.pitch?(d.cameraElevationReference="ground",d.zoom=this._originalZoom):(d.recenterOnTerrain(),d.cameraElevationReference="ground"),m!==d.zoom&&this._map._update(!0)}if(d._isCameraConstrained&&c._stop(!0),!n0(t))return void this._fireEvents(r,s,!0);let{panDelta:g,zoomDelta:y,bearingDelta:b,pitchDelta:w,around:P,aroundCoord:O,pinchAround:I}=t;d._isCameraConstrained&&(y>0&&(y=0),d._isCameraConstrained=!1),void 0!==I&&(P=I),(y||(m=>r[m]&&!this._eventsInProgress[m])("drag"))&&P&&(this._dragOrigin=f(d.pointCoordinate3D(P)),this._originalZoom=d.zoom,this._trackingEllipsoid.setup(d._camera.position,this._dragOrigin)),d.cameraElevationReference="sea",c._stop(!0),P=P||c.transform.centerPoint,b&&(d.bearing+=b),w&&(d.pitch+=w),d._updateCameraState();const A=[0,0,0];if(g)if("mercator"===d.projection.name){const m=this._trackingEllipsoid.projectRay(d.screenPointToMercatorRay(P).dir),v=this._trackingEllipsoid.projectRay(d.screenPointToMercatorRay(P.sub(g)).dir);A[0]=v[0]-m[0],A[1]=v[1]-m[1]}else{const m=d.pointCoordinate(P);if("globe"===d.projection.name){g=g.rotate(-d.angle);const v=d._pixelsPerMercatorPixel/d.worldSize;A[0]=-g.x*ac(Ji(m.y))*v,A[1]=-g.y*ac(d.center.lat)*v}else{const v=d.pointCoordinate(P.sub(g));m&&v&&(A[0]=v.x-m.x,A[1]=v.y-m.y)}}const l=d.zoom,u=[0,0,0];if(y){const m=f(O||d.pointCoordinate3D(P)),v={dir:dt.normalize([],dt.sub([],m,d._camera.position))};if(v.dir[2]<0){const C=d.zoomDeltaToMovement(m,y);dt.scale(u,v.dir,C)}}const p=dt.add(A,A,u);d._translateCameraConstrained(p),y&&Math.abs(d.zoom-l)>1e-4&&d.recenterOnTerrain(),d.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(r,s,!0)}_fireEvents(t,r,s){const c=SM(this._eventsInProgress),d=SM(t),f={};for(const w in t){const{originalEvent:P}=t[w];this._eventsInProgress[w]||(f[`${w}start`]=P),this._eventsInProgress[w]=t[w]}!c&&d&&this._fireEvent("movestart",d.originalEvent);for(const w in f)this._fireEvent(w,f[w]);d&&this._fireEvent("move",d.originalEvent);for(const w in t){const{originalEvent:P}=t[w];this._fireEvent(w,P)}const g={};let y;for(const w in this._eventsInProgress){const{handlerName:P,originalEvent:O}=this._eventsInProgress[w];this._handlersById[P].isActive()||(delete this._eventsInProgress[w],y=r[P]||O,g[`${w}end`]=y)}for(const w in g)this._fireEvent(w,g[w]);const b=SM(this._eventsInProgress);if(s&&(c||d)&&!b){this._updatingCamera=!0;const w=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),P=O=>0!==O&&-this._bearingSnap<O&&O<this._bearingSnap;w?(P(w.bearing||this._map.getBearing())&&(w.bearing=0),this._map.easeTo(w,{originalEvent:y})):(this._map.fire(new de("moveend",{originalEvent:y})),P(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,r){this._map.fire(new de(t,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new AM("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const NO="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class FO extends ki{constructor(t,r){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=r.bearingSnap,this._respectPrefersReducedMotion=!1!==r.respectPrefersReducedMotion,Tn(["_renderFrameCallback"],this)}getCenter(){return new kn(this.transform.center.lng,this.transform.center.lat)}setCenter(t,r){return this.jumpTo({center:t},r)}panBy(t,r,s){return t=tt.convert(t).mult(-1),this.panTo(this.transform.center,_t({offset:t},r),s)}panTo(t,r,s){return this.easeTo(_t({center:t},r),s)}getZoom(){return this.transform.zoom}setZoom(t,r){return this.jumpTo({zoom:t},r),this}zoomTo(t,r,s){return this.easeTo(_t({zoom:t},r),s)}zoomIn(t,r){return this.zoomTo(this.getZoom()+1,t,r),this}zoomOut(t,r){return this.zoomTo(this.getZoom()-1,t,r),this}getBearing(){return this.transform.bearing}setBearing(t,r){return this.jumpTo({bearing:t},r),this}getPadding(){return this.transform.padding}setPadding(t,r){return this.jumpTo({padding:t},r),this}rotateTo(t,r,s){return this.easeTo(_t({bearing:t},r),s)}resetNorth(t,r){return this.rotateTo(0,_t({duration:1e3},t),r),this}resetNorthPitch(t,r){return this.easeTo(_t({bearing:0,pitch:0,duration:1e3},t),r),this}snapToNorth(t,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,r):this}getPitch(){return this.transform.pitch}setPitch(t,r){return this.jumpTo({pitch:t},r),this}cameraForBounds(t,r){t=Xi.convert(t);const s=r&&r.bearing||0,c=r&&r.pitch||0,d=t.getNorthWest(),f=t.getSouthEast();return this._cameraForBounds(this.transform,d,f,s,c,r)}_extendCameraOptions(t){const r={top:0,bottom:0,right:0,left:0};if("number"==typeof(t=_t({padding:r,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding){const s=t.padding;t.padding={top:s,bottom:s,right:s,left:s}}return t.padding=_t(r,t.padding),t}_minimumAABBFrustumDistance(t,r){const s=r.max[0]-r.min[0],c=r.max[1]-r.min[1];return s/c>t.aspect?s/(2*Math.tan(.5*t.fovX)*t.aspect):c/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(t,r,s,c,d,f){const g=t.clone(),y=this._extendCameraOptions(f);g.bearing=c,g.pitch=d;const b=kn.convert(r),w=kn.convert(s),P=.5*(b.lat+w.lat),O=.5*(b.lng+w.lng),I=ra(P,O),A=dt.normalize([],I),l=dt.normalize([],dt.cross([],A,[0,1,0])),u=dt.cross([],l,A),p=[l[0],l[1],l[2],0,u[0],u[1],u[2],0,A[0],A[1],A[2],0,0,0,0,1],m=[I,ra(b.lat,b.lng),ra(w.lat,b.lng),ra(w.lat,w.lng),ra(b.lat,w.lng),ra(P,b.lng),ra(P,w.lng),ra(b.lat,O),ra(w.lat,O)];let v=_i.fromPoints(m.map(ct=>[dt.dot(l,ct),dt.dot(u,ct),dt.dot(A,ct)]));const C=dt.transformMat4([],v.center,p);0===dt.squaredLength(C)&&dt.set(C,0,0,1),dt.normalize(C,C),dt.scale(C,C,ea),g.center=function([ct,yt,Ot]){const Tt=Math.hypot(ct,yt,Ot),zt=Math.atan2(ct,Ot),Nt=.5*Math.PI-Math.acos(-yt/Tt);return new kn(ge(zt),ge(Nt))}(C);const E=g.getWorldToCameraMatrix(),T=bt.invert(new Float64Array(16),E);v=_i.applyTransform(v,bt.multiply([],E,p)),dt.transformMat4(C,C,E);const k=.5*(v.max[2]-v.min[2]),N=this._minimumAABBFrustumDistance(g,v),F=dt.scale([],[0,0,1],k),$=dt.add(F,C,F),q=N+(0===g.pitch?0:dt.distance(C,$)),Z=g.globeCenterInViewSpace,X=dt.sub([],C,[Z[0],Z[1],Z[2]]);dt.normalize(X,X),dt.scale(X,X,q);const K=dt.add([],C,X);dt.transformMat4(K,K,T);const J=Ep/ea,st=dt.length(K),ot=ii(Math.max(st*J-Ep,Number.EPSILON),0),rt=Math.min(g.zoomFromMercatorZAdjusted(ot),y.maxZoom);return rt>.5*(zu+Bd)?(g.setProjection({name:"mercator"}),g.zoom=rt,this._cameraForBounds(g,r,s,c,d,f)):{center:g.center,zoom:rt,bearing:c,pitch:d}}queryTerrainElevation(t,r){const s=this.transform.elevation;return s?(r=_t({},{exaggerated:!0},r),s.getAtPoint(Xn.fromLngLat(t),null,r.exaggerated)):null}_cameraForBounds(t,r,s,c,d,f){if("globe"===t.projection.name)return this._cameraForBoundsOnGlobe(t,r,s,c,d,f);const g=t.clone(),y=this._extendCameraOptions(f),b=g.padding;g.bearing=c,g.pitch=d;const w=kn.convert(r),P=kn.convert(s),O=new kn(w.lng,P.lat),I=new kn(P.lng,w.lat),A=g.project(w),l=g.project(P),u=this.queryTerrainElevation(w),p=this.queryTerrainElevation(P),m=this.queryTerrainElevation(O),v=this.queryTerrainElevation(I),C=[[A.x,A.y,Math.min(u||0,p||0,m||0,v||0)],[l.x,l.y,Math.max(u||0,p||0,m||0,v||0)]];let E=_i.fromPoints(C);const T=g.getWorldToCameraMatrix(),k=bt.invert(new Float64Array(16),T);E=_i.applyTransform(E,T);const N=dt.sub([],E.max,E.min),F=b.left||0,$=b.right||0,q=b.bottom||0,Z=b.top||0,{left:X,right:K,top:J,bottom:st}=y.padding,ot=.5*(F+$),rt=.5*(Z+q),ct=Math.min(g.scaleZoom(g.scale*Math.min((g.width-(F+$+X+K))/N[0],(g.height-(q+Z+st+J))/N[1])),y.maxZoom),yt=g.scale/g.zoomScale(ct);E=new _i([E.min[0]-(X+ot)*yt,E.min[1]-(st+rt)*yt,E.min[2]],[E.max[0]+(K+ot)*yt,E.max[1]+(J+rt)*yt,E.max[2]]);const Ot=.5*N[2],Tt=this._minimumAABBFrustumDistance(g,E),zt=[0,0,1,0];kr.transformMat4(zt,zt,T),kr.normalize(zt,zt);const Nt=dt.scale([],zt,Tt+Ot),$t=dt.add([],E.center,Nt),Rt=("number"==typeof y.offset.x&&"number"==typeof y.offset.y?new tt(y.offset.x,y.offset.y):tt.convert(y.offset)).rotate(-Ct(c));E.center[0]-=Rt.x*yt,E.center[1]+=Rt.y*yt,dt.transformMat4(E.center,E.center,k),dt.transformMat4($t,$t,k);const ie=[E.center[0],E.center[1],$t[2]*g.pixelsPerMeter];dt.scale(ie,ie,1/g.worldSize);const Ee=Da(ie[0]),Oe=Ji(ie[1]),Be=Math.min(g._zoomFromMercatorZ(ie[2]),y.maxZoom),je=new kn(Ee,Oe);return g.mercatorFromTransition&&Be<.5*(zu+Bd)?(g.setProjection({name:"globe"}),g.zoom=Be,this._cameraForBounds(g,r,s,c,d,f)):{center:je,zoom:Be,bearing:c,pitch:d}}fitBounds(t,r,s){const c=this.cameraForBounds(t,r);return this._fitInternal(c,r,s)}fitScreenCoordinates(t,r,s,c,d){const f=tt.convert(t),g=tt.convert(r),y=new tt(Math.min(f.x,g.x),Math.min(f.y,g.y)),b=new tt(Math.max(f.x,g.x),Math.max(f.y,g.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(f,g))return this;const w=this.transform.pointLocation3D(y),P=this.transform.pointLocation3D(b),O=this.transform.pointLocation3D(new tt(y.x,b.y)),I=this.transform.pointLocation3D(new tt(b.x,y.y)),A=[Math.min(w.lng,P.lng,O.lng,I.lng),Math.min(w.lat,P.lat,O.lat,I.lat)],l=[Math.max(w.lng,P.lng,O.lng,I.lng),Math.max(w.lat,P.lat,O.lat,I.lat)],u=c&&c.pitch?c.pitch:this.getPitch(),p=this._cameraForBounds(this.transform,A,l,s,u,c);return this._fitInternal(p,c,d)}_fitInternal(t,r,s){return t?(delete(r=_t(t,r)).padding,r.linear?this.easeTo(r,s):this.flyTo(r,s)):this}jumpTo(t,r){this.stop();const s=t.preloadOnly?this.transform.clone():this.transform;let c=!1,d=!1,f=!1;return"zoom"in t&&s.zoom!==+t.zoom&&(c=!0,s.zoom=+t.zoom),void 0!==t.center&&(s.center=kn.convert(t.center)),"bearing"in t&&s.bearing!==+t.bearing&&(d=!0,s.bearing=+t.bearing),"pitch"in t&&s.pitch!==+t.pitch&&(f=!0,s.pitch=+t.pitch),null==t.padding||s.isPaddingEqual(t.padding)||(s.padding=t.padding),t.preloadOnly?(this._preloadTiles(s),this):(this.fire(new de("movestart",r)).fire(new de("move",r)),c&&this.fire(new de("zoomstart",r)).fire(new de("zoom",r)).fire(new de("zoomend",r)),d&&this.fire(new de("rotatestart",r)).fire(new de("rotate",r)).fire(new de("rotateend",r)),f&&this.fire(new de("pitchstart",r)).fire(new de("pitch",r)).fire(new de("pitchend",r)),this.fire(new de("moveend",r)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||gt(NO),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,r){const s=this.transform;if(!s.projection.supportsFreeCamera)return gt(NO),this;this.stop();const c=s.zoom,d=s.pitch,f=s.bearing;s.setFreeCameraOptions(t);const g=c!==s.zoom,y=d!==s.pitch,b=f!==s.bearing;return this.fire(new de("movestart",r)).fire(new de("move",r)),g&&this.fire(new de("zoomstart",r)).fire(new de("zoom",r)).fire(new de("zoomend",r)),b&&this.fire(new de("rotatestart",r)).fire(new de("rotate",r)).fire(new de("rotateend",r)),y&&this.fire(new de("pitchstart",r)).fire(new de("pitch",r)).fire(new de("pitchend",r)),this.fire(new de("moveend",r)),this}easeTo(t,r){this._stop(!1,t.easeId),(!1===(t=_t({offset:[0,0],duration:500,easing:Yr},t)).animate||this._prefersReducedMotion(t))&&(t.duration=0);const s=this.transform,c=this.getZoom(),d=this.getBearing(),f=this.getPitch(),g=this.getPadding(),y="zoom"in t?+t.zoom:c,b="bearing"in t?this._normalizeBearing(t.bearing,d):d,w="pitch"in t?+t.pitch:f,P="padding"in t?t.padding:s.padding,O=tt.convert(t.offset);let I,A,l;if("globe"===s.projection.name){const F=Xn.fromLngLat(s.center),$=O.rotate(-s.angle);F.x+=$.x/s.worldSize,F.y+=$.y/s.worldSize;const q=F.toLngLat(),Z=kn.convert(t.center||q);this._normalizeCenter(Z),I=s.centerPoint.add($),A=new tt(F.x,F.y).mult(s.worldSize),l=new tt(yo(Z.lng),Pi(Z.lat)).mult(s.worldSize).sub(A)}else{I=s.centerPoint.add(O);const F=s.pointLocation(I),$=kn.convert(t.center||F);this._normalizeCenter($),A=s.project(F),l=s.project($).sub(A)}const u=s.zoomScale(y-c);let p,m;t.around&&(p=kn.convert(t.around),m=s.locationPoint(p));const v=this._zooming||y!==c,C=this._rotating||d!==b,E=this._pitching||w!==f,T=!s.isPaddingEqual(P),k=F=>$=>{if(v&&(F.zoom=vn(c,y,$)),C&&(F.bearing=vn(d,b,$)),E&&(F.pitch=vn(f,w,$)),T&&(F.interpolatePadding(g,P,$),I=F.centerPoint.add(O)),p)F.setLocationAtPoint(p,m);else{const q=F.zoomScale(F.zoom-c),Z=y>c?Math.min(2,u):Math.max(.5,u),X=Math.pow(Z,1-$),K=F.unproject(A.add(l.mult($*X)).mult(q));F.setLocationAtPoint(F.renderWorldCopies?K.wrap():K,I)}return t.preloadOnly||this._fireMoveEvents(r),F};if(t.preloadOnly){const F=this._emulate(k,t.duration,s);return this._preloadTiles(F),this}const N={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=v,this._rotating=C,this._pitching=E,this._padding=T,this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,N),this._ease(k(s),F=>{"sea"===s.cameraElevationReference&&s.recenterOnTerrain(),this._afterEase(r,F)},t),this}_prepareEase(t,r,s={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&0===this.transform.pitch&&"globe"!==this.transform.projection.name&&(this.transform.cameraElevationReference="ground"),r||s.moving||this.fire(new de("movestart",t)),this._zooming&&!s.zooming&&this.fire(new de("zoomstart",t)),this._rotating&&!s.rotating&&this.fire(new de("rotatestart",t)),this._pitching&&!s.pitching&&this.fire(new de("pitchstart",t))}_fireMoveEvents(t){this.fire(new de("move",t)),this._zooming&&this.fire(new de("zoom",t)),this._rotating&&this.fire(new de("rotate",t)),this._pitching&&this.fire(new de("pitch",t))}_afterEase(t,r){if(this._easeId&&r&&this._easeId===r)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const s=this._zooming,c=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,s&&this.fire(new de("zoomend",t)),c&&this.fire(new de("rotateend",t)),d&&this.fire(new de("pitchend",t)),this.fire(new de("moveend",t))}flyTo(t,r){if(this._prefersReducedMotion(t)){const ct=he(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ct,r)}this.stop(),t=_t({offset:[0,0],speed:1.2,curve:1.42,easing:Yr},t);const s=this.transform,c=this.getZoom(),d=this.getBearing(),f=this.getPitch(),g=this.getPadding(),y="zoom"in t?Ne(+t.zoom,s.minZoom,s.maxZoom):c,b="bearing"in t?this._normalizeBearing(t.bearing,d):d,w="pitch"in t?+t.pitch:f,P="padding"in t?t.padding:s.padding,O=s.zoomScale(y-c),I=tt.convert(t.offset);let A=s.centerPoint.add(I);const l=s.pointLocation(A),u=kn.convert(t.center||l);this._normalizeCenter(u);const p=s.project(l),m=s.project(u).sub(p);let v=t.curve;const C=Math.max(s.width,s.height),E=C/O,T=m.mag();if("minZoom"in t){const ct=Ne(Math.min(t.minZoom,c,y),s.minZoom,s.maxZoom),yt=C/s.zoomScale(ct-c);v=Math.sqrt(yt/T*2)}const k=v*v;function N(ct){const yt=(E*E-C*C+(ct?-1:1)*k*k*T*T)/(2*(ct?E:C)*k*T);return Math.log(Math.sqrt(yt*yt+1)-yt)}function F(ct){return(Math.exp(ct)-Math.exp(-ct))/2}function $(ct){return(Math.exp(ct)+Math.exp(-ct))/2}const q=N(0);let Z=function(ct){return $(q)/$(q+v*ct)},X=function(ct){return C*(($(q)*(F(yt=q+v*ct)/$(yt))-F(q))/k)/T;var yt},K=(N(1)-q)/v;if(Math.abs(T)<1e-6||!isFinite(K)){if(Math.abs(C-E)<1e-6)return this.easeTo(t,r);const ct=E<C?-1:1;K=Math.abs(Math.log(E/C))/v,X=function(){return 0},Z=function(yt){return Math.exp(ct*v*yt)}}t.duration="duration"in t?+t.duration:1e3*K/("screenSpeed"in t?+t.screenSpeed/v:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const J=d!==b,st=w!==f,ot=!s.isPaddingEqual(P),rt=ct=>yt=>{const Ot=yt*K,Tt=1/Z(Ot);ct.zoom=1===yt?y:c+ct.scaleZoom(Tt),J&&(ct.bearing=vn(d,b,yt)),st&&(ct.pitch=vn(f,w,yt)),ot&&(ct.interpolatePadding(g,P,yt),A=ct.centerPoint.add(I));const zt=1===yt?u:ct.unproject(p.add(m.mult(X(Ot))).mult(Tt));return ct.setLocationAtPoint(ct.renderWorldCopies?zt.wrap():zt,A),ct._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(r),ct};if(t.preloadOnly){const ct=this._emulate(rt,t.duration,s);return this._preloadTiles(ct),this}return this._zooming=!0,this._rotating=J,this._pitching=st,this._padding=ot,this._prepareEase(r,!1),this._ease(rt(s),()=>this._afterEase(r),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,r){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const s=this._onEaseEnd;this._onEaseEnd=void 0,s.call(this,r)}if(!t){const s=this.handlers;s&&s.stop(!1)}return this}_ease(t,r,s){!1===s.animate||0===s.duration?(t(1),r()):(this._easeStart=Mn.now(),this._easeOptions=s,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((Mn.now()-this._easeStart)/this._easeOptions.duration,1),r=this._onEaseFrame;r&&r(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,r){t=Wt(t,-180,180);const s=Math.abs(t-r);return Math.abs(t-360-r)<s&&(t-=360),Math.abs(t+360-r)<s&&(t+=360),t}_normalizeCenter(t){const r=this.transform;if(r.maxBounds||"globe"!==r.projection.name&&!r.renderWorldCopies)return;const s=t.lng-r.center.lng;t.lng+=s>180?-360:s<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&Mn.prefersReducedMotion&&!(t&&t.essential)}_emulate(t,r,s){const c=Math.ceil(15*r/1e3),d=[],f=t(s.clone());for(let g=0;g<=c;g++){const y=f(g/c);d.push(y.clone())}return d}}class DM{constructor(t={}){this.options=t,Tn(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const r=this.options&&this.options.compact;return this._map=t,this._container=ei("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ei("button","mapboxgl-ctrl-attrib-button",this._container),ei("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ei("div","mapboxgl-ctrl-attrib-inner",this._container),r&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===r&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,r){const s=this._map._getUIString(`AttributionControl.${r}`);t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",s)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||ue.ACCESS_TOKEN}];if(t){const s=r.reduce((c,d,f)=>(d.value&&(c+=`${d.key}=${d.value}${f<r.length-1?"&":""}`),c),"?");t.href=`${ue.FEEDBACK_URL}/${s}#${Nf(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const c=this._map.style.stylesheet;this.styleOwner=c.owner,this.styleId=c.id}const r=this._map.style._mergedSourceCaches;for(const c in r){const d=r[c];if(d.used){const f=d.getSource();f.attribution&&t.indexOf(f.attribution)<0&&t.push(f.attribution)}}t.sort((c,d)=>c.length-d.length),t=t.filter((c,d)=>{for(let f=d+1;f<t.length;f++)if(t[f].indexOf(c)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const s=t.join(" | ");s!==this._attribHTML&&(this._attribHTML=s,t.length?(this._innerContainer.innerHTML=s,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class QS{constructor(){Tn(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=ei("div","mapboxgl-ctrl");const r=ei("a","mapboxgl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://www.mapbox.com/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const r in t){const s=t[r].getSource();if(s.hasOwnProperty("mapbox_logo")&&!s.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const r=t[0];this._map.getCanvasContainer().offsetWidth<250?r.classList.add("mapboxgl-compact"):r.classList.remove("mapboxgl-compact")}}}class EI{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const r=++this._id;return this._queue.push({callback:t,id:r,cancelled:!1}),r}remove(t){const r=this._currentlyRunning,s=r?this._queue.concat(r):this._queue;for(const c of s)if(c.id===t)return void(c.cancelled=!0)}run(t=0){const r=this._currentlyRunning=this._queue;this._queue=[];for(const s of r)if(!s.cancelled&&(s.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function kM(e,t,r){if(e=new kn(e.lng,e.lat),t){const s=new kn(e.lng-360,e.lat),c=new kn(e.lng+360,e.lat),d=360*Math.ceil(Math.abs(e.lng-r.center.lng)/360),f=r.locationPoint(e).distSqr(t),g=t.x<0||t.y<0||t.x>r.width||t.y>r.height;r.locationPoint(s).distSqr(t)<f&&(g||Math.abs(s.lng-r.center.lng)<d)?e=s:r.locationPoint(c).distSqr(t)<f&&(g||Math.abs(c.lng-r.center.lng)<d)&&(e=c)}for(;Math.abs(e.lng-r.center.lng)>180;){const s=r.locationPoint(e);if(s.x>=0&&s.y>=0&&s.x<=r.width&&s.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}const RM={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class LM extends ki{constructor(t,r){if(super(),(t instanceof lt.HTMLElement||r)&&(t=_t({element:t},r)),Tn(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=tt.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=ei("div");const d=41,f=27,g=ia("svg",{display:"block",height:d*this._scale+"px",width:f*this._scale+"px",viewBox:`0 0 ${f} ${d}`},this._element),y=ia("radialGradient",{id:"shadowGradient"},ia("defs",{},g));ia("stop",{offset:"10%","stop-opacity":.4},y),ia("stop",{offset:"100%","stop-opacity":.05},y),ia("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},g),ia("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},g),ia("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},g),ia("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},g),this._offset=tt.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()});const s=this._element.classList;for(const d in RM)s.remove(`mapboxgl-marker-anchor-${d}`);s.add(`mapboxgl-marker-anchor-${this._anchor}`);const c=t&&t.className?t.className.trim().split(/\s+/):[];s.add(...c),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=kn.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const c=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(24.6+c)],"bottom-right":[-c,-1*(24.6+c)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const r=t.code,s=t.charCode||t.keyCode;"Space"!==r&&"Enter"!==r&&32!==s&&13!==s||this.togglePopup()}_onMapClick(t){const r=t.originalEvent.target,s=this._element;this._popup&&(r===s||s.contains(r))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,r=this._pos;if(!t||!r)return!1;const s=t.unproject(r),c=t.getFreeCameraOptions();if(!c.position)return!1;const d=c.position.toLngLat();return d.distanceTo(s)<.9*d.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const r=this._pos;if(!r||r.x<0||r.x>t.transform.width||r.y<0||r.y>t.transform.height)return void this._clearFadeTimer();const s=t.unproject(r);let c;t._showingGlobe()&&_v(t.transform,this._lngLat)?c=0:(c=1-t._queryFogOpacity(s),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(c*=this._occludedOpacity)),this._element.style.opacity=`${c}`,this._element.style.pointerEvents=c>0?"auto":"none",this._popup&&this._popup._setOpacity(c),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const r=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${t.x}px,${t.y}px)\n            ${RM[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${r.x}px,${r.y}px)\n        `}_calculateXYTransform(){const t=this._pos,r=this._map,s=this.getPitchAlignment();if(!r||!t||"map"!==s)return"";if(!r._showingGlobe()){const y=r.getPitch();return y?`rotateX(${y}deg)`:""}const c=ge(Lg(r.transform,this._lngLat)),d=t.sub(Uu(r.transform)),f=Math.abs(d.x)+Math.abs(d.y);if(0===f)return"";const g=c/f;return`rotateX(${-d.y*g}deg) rotateY(${d.x*g}deg)`}_calculateZTransform(){const t=this._pos,r=this._map;if(!r||!t)return"";let s=0;const c=this.getRotationAlignment();if("map"===c)if(r._showingGlobe()){const d=r.project(new kn(this._lngLat.lng,this._lngLat.lat+.001)),f=r.project(new kn(this._lngLat.lng,this._lngLat.lat-.001)).sub(d);s=ge(Math.atan2(f.y,f.x))-90}else s=-r.getBearing();else if("horizon"===c){const d=vs(4,6,r.getZoom()),f=Uu(r.transform);f.y+=d*r.transform.height;const g=t.sub(f),y=ge(Math.atan2(g.y,g.x));s=(y>90?y-270:y+90)*(1-d)}return s+=this._rotation,s?`rotateZ(${s}deg)`:""}_update(t){lt.cancelAnimationFrame(this._updateFrameId);const r=this._map;r&&(r.transform.renderWorldCopies&&(this._lngLat=kM(this._lngLat,this._pos,r.transform)),this._pos=r.project(this._lngLat),!0===t?this._updateFrameId=lt.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),r._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(r._showingGlobe()||r.getTerrain()||r.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=tt.convert(t),this._update(),this}addClassName(t){return this._element.classList.add(t),this}removeClassName(t){return this._element.classList.remove(t),this}toggleClassName(t){return this._element.classList.toggle(t)}_onMove(t){const r=this._map;if(!r)return;const s=this._pointerdownPos,c=this._positionDelta;if(s&&c){if(!this._isDragging){const d=this._clickTolerance||r._clickTolerance;if(t.point.dist(s)<d)return;this._isDragging=!0}this._pos=t.point.sub(c),this._lngLat=r.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new de("dragstart"))),this.fire(new de("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new de("dragend")),this._state="inactive"}_addDragHandler(t){const r=this._map,s=this._pos;r&&s&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(s),this._pointerdownPos=t.point,this._state="pending",r.on("mousemove",this._onMove),r.on("touchmove",this._onMove),r.once("mouseup",this._onUp),r.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const r=this._map;return r&&(t?(r.on("mousedown",this._addDragHandler),r.on("touchstart",this._addDragHandler)):(r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const JS={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},NM=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function OI(e=new tt(0,0),t="bottom"){if("number"==typeof e){const r=Math.round(Math.sqrt(.5*Math.pow(e,2)));switch(t){case"top":return new tt(0,e);case"top-left":return new tt(r,r);case"top-right":return new tt(-r,r);case"bottom":return new tt(0,-e);case"bottom-left":return new tt(r,-r);case"bottom-right":return new tt(-r,-r);case"left":return new tt(e,0);case"right":return new tt(-e,0)}return new tt(0,0)}return e instanceof tt||Array.isArray(e)?tt.convert(e):tt.convert(e[t]||[0,0])}class tA{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const r=Ui((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-r)+this._end*r}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,r,s){this._start=this.getValue(r),this._end=t,this._startTime=r,this._endTime=r+s}}const zO={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},TI={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},gD={showCompass:!0,showZoom:!0,visualizePitch:!1};class eA{constructor(t,r,s=!1){this._clickTolerance=10,this.element=r,this.mouseRotate=new qS({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,s&&(this.mousePitch=new ZS({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),Tn(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener("mousedown",this.mousedown),r.addEventListener("touchstart",this.touchstart,{passive:!1}),r.addEventListener("touchmove",this.touchmove),r.addEventListener("touchend",this.touchend),r.addEventListener("touchcancel",this.reset)}down(t,r){this.mouseRotate.mousedown(t,r),this.mousePitch&&this.mousePitch.mousedown(t,r),$f()}move(t,r){const s=this.map,c=this.mouseRotate.mousemoveWindow(t,r),d=c&&c.bearingDelta;if(d&&s.setBearing(s.getBearing()+d),this.mousePitch){const f=this.mousePitch.mousemoveWindow(t,r),g=f&&f.pitchDelta;g&&s.setPitch(s.getPitch()+g)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Hy(),lt.removeEventListener("mousemove",this.mousemove),lt.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(_t({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),vo(this.element,t)),lt.addEventListener("mousemove",this.mousemove),lt.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,vo(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=lu(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=lu(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const II={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},nA={maxWidth:100,unit:"metric"},mD={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},FM={version:ye,supported:ag,setRTLTextPlugin:function(e,t,r=!1){if(oo===mr||oo===hr||oo===mi)throw new Error("setRTLTextPlugin cannot be called multiple times.");Oa=Mn.resolveURL(e),oo=mr,Co=t,Zo(),r||Vh()},getRTLTextPluginStatus:Au,Map:class extends FO{constructor(e){mh.mark(gl.create);const t=e;if(null!=(e=_t({},TI,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(e.antialias&&function(r){const s=r.navigator?r.navigator.userAgent:null;return!!function(c){if(null==Ze){const d=c.navigator?c.navigator.userAgent:null;Ze=!!c.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return Ze}(r)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))}(lt)&&(e.antialias=!1,gt("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new lh(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),e),this._interactive=e.interactive,this._minTileCacheSize=e.minTileCacheSize,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=e.crossSourceCollisions,this._collectResourceTiming=e.collectResourceTiming,this._language=this._parseLanguage(e.language),this._worldview=e.worldview,this._renderTaskQueue=new EI,this._domRenderTaskQueue=new EI,this._controls=[],this._markers=[],this._popups=[],this._mapId=In(),this._locale=_t({},zO,e.locale),this._clickTolerance=e.clickTolerance,this._cooperativeGestures=e.cooperativeGestures,this._performanceMetricsCollection=e.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new tA(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new ee(e.transformRequest,e.accessToken,e.testMode),this._silenceAuthErrors=!!e.testMode,this._contextCreateOptions=e.contextCreateOptions?{...e.contextCreateOptions}:{},"string"==typeof e.container){if(this._container=lt.document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container.toString()}' not found.`)}else{if(!(e.container instanceof lt.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(this._container.childNodes.length>0&&gt("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),e.maxBounds&&this.setMaxBounds(e.maxBounds),Tn(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==lt&&(this._fullscreenchangeEvent="onfullscreenchange"in lt.document?"fullscreenchange":"webkitfullscreenchange",lt.addEventListener("online",this._onWindowOnline,!1),lt.addEventListener("resize",this._onWindowResize,!1),lt.addEventListener("orientationchange",this._onWindowResize,!1),lt.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),lt.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new LO(this,e),this._localFontFamily=e.localFontFamily,this._localIdeographFontFamily=e.localIdeographFontFamily,(e.style||!e.testMode)&&this.setStyle(e.style||ue.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),e.projection&&this.setProjection(e.projection),e.hash&&(this._hash=new _I("string"==typeof e.hash&&e.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){null==t.center&&null==t.zoom||(this.transform._unmodified=!1),this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch});const r=e.bounds;r&&(this.resize(),this.fitBounds(r,_t({},e.fitBoundsOptions,{duration:0})))}this.resize(),e.attributionControl&&this.addControl(new DM({customAttribution:e.customAttribution})),this._logoControl=new QS,this.addControl(this._logoControl,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update("style"===r.dataType),this.fire(new de(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new de(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(e,t){if(void 0===t&&(t=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new Cn(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=e.onAdd(this);this._controls.push(e);const s=this._controlPositions[t];return-1!==t.indexOf("bottom")?s.insertBefore(r,s.firstChild):s.appendChild(r),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new Cn(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(e);return t>-1&&this._controls.splice(t,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(e){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new de("movestart",e)).fire(new de("move",e)),this.fire(new de("resize",e)),t&&this.fire(new de("moveend",e)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(e){return this.transform.setMaxBounds(Xi.convert(e)),this._update()}setMinZoom(e){if((e=e??-2)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e?this.setZoom(e):this.fire(new de("zoomstart")).fire(new de("zoom")).fire(new de("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=e??22)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e?this.setZoom(e):this.fire(new de("zoomstart")).fire(new de("zoom")).fire(new de("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=e??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e?this.setPitch(e):this.fire(new de("pitchstart")).fire(new de("pitch")).fire(new de("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=e??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e?this.setPitch(e):this.fire(new de("pitchstart")).fire(new de("pitch")).fire(new de("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(e){return"auto"===e?lt.navigator.language:Array.isArray(e)?0===e.length?void 0:e.map(t=>"auto"===t?lt.navigator.language:t):e}setLanguage(e){const t=this._parseLanguage(e);if(!this.style||t===this._language)return this;this._language=t,this.style.reloadSources();for(const r of this._controls)r._setLanguage&&r._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(e){return this.style&&e!==this._worldview?(this._worldview=e,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(e){return this._lazyInitEmptyStyle(),e?"string"==typeof e&&(e={name:e}):e=null,this._useExplicitProjection=!!e,this._prioritizeAndUpdateProjection(e,this.style.projection)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const e=this.transform,t=e.projection.name;let r;"globe"===t&&e.zoom>=Bd?(e.setMercatorFromTransition(),r=!0):"mercator"===t&&e.zoom<Bd&&(e.setProjection({name:"globe"}),r=!0),r&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(e,t){return this._updateProjection(e||t||{name:"mercator"})}_updateProjection(e){let t;return t="globe"===e.name&&this.transform.zoom>=Bd?this.transform.setMercatorFromTransition():this.transform.setProjection(e),this.style.applyProjectionUpdate(),t&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(e){return this.transform.locationPoint3D(kn.convert(e))}unproject(e){return this.transform.pointLocation3D(tt.convert(e))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(e,t,r){if("mouseenter"===e||"mouseover"===e){let s=!1;const c=f=>{const g=t.filter(b=>this.getLayer(b)),y=g.length?this.queryRenderedFeatures(f.point,{layers:g}):[];y.length?s||(s=!0,r.call(this,new za(e,this,f.originalEvent,{features:y}))):s=!1},d=()=>{s=!1};return{layers:new Set(t),listener:r,delegates:{mousemove:c,mouseout:d}}}if("mouseleave"===e||"mouseout"===e){let s=!1;const c=f=>{const g=t.filter(y=>this.getLayer(y));(g.length?this.queryRenderedFeatures(f.point,{layers:g}):[]).length?s=!0:s&&(s=!1,r.call(this,new za(e,this,f.originalEvent)))},d=f=>{s&&(s=!1,r.call(this,new za(e,this,f.originalEvent)))};return{layers:new Set(t),listener:r,delegates:{mousemove:c,mouseout:d}}}{const s=c=>{const d=t.filter(g=>this.getLayer(g)),f=d.length?this.queryRenderedFeatures(c.point,{layers:d}):[];f.length&&(c.features=f,r.call(this,c),delete c.features)};return{layers:new Set(t),listener:r,delegates:{[e]:s}}}}on(e,t,r){if(void 0===r)return super.on(e,t);if(Array.isArray(t)||(t=[t]),t)for(const c of t)if(!this._isValidId(c))return this;const s=this._createDelegatedListener(e,t,r);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(s);for(const c in s.delegates)this.on(c,s.delegates[c]);return this}once(e,t,r){if(void 0===r)return super.once(e,t);if(Array.isArray(t)||(t=[t]),t)for(const c of t)if(!this._isValidId(c))return this;const s=this._createDelegatedListener(e,t,r);for(const c in s.delegates)this.once(c,s.delegates[c]);return this}off(e,t,r){if(void 0===r)return super.off(e,t);t=new Set(Array.isArray(t)?t:[t]);for(const d of t)if(!this._isValidId(d))return this;const s=(d,f)=>{if(d.size!==f.size)return!1;for(const g of d)if(!f.has(g))return!1;return!0},c=this._delegatedListeners?this._delegatedListeners[e]:void 0;return c&&(d=>{for(let f=0;f<d.length;f++){const g=d[f];if(g.listener===r&&s(g.layers,t)){for(const y in g.delegates)this.off(y,g.delegates[y]);return d.splice(f,1),this}}})(c),this}queryRenderedFeatures(e,t){if(!this.style)return[];if(void 0!==t||void 0===e||e instanceof tt||Array.isArray(e)||(t=e,e=void 0),e=e||[[0,0],[this.transform.width,this.transform.height]],(t=t||{}).layers&&Array.isArray(t.layers))for(const r of t.layers)if(!this._isValidId(r))return[];return this.style.queryRenderedFeatures(e,t,this.transform)}querySourceFeatures(e,t){return this._isValidId(e)?this.style.querySourceFeatures(e,t):[]}isPointOnSurface(e){const{name:t}=this.transform.projection;return"globe"!==t&&"mercator"!==t&&gt(`${t} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(tt.convert(e))}setStyle(e,t){return!1!==(t=_t({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&e?(this._diffStyle(e,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(e,t))}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),e&&(this.style=new ph(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ph(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,t){if("string"==typeof e){const r=this._requestManager.normalizeStyleURL(e),s=this._requestManager.transformRequest(r,Ft.Style);_e(s,(c,d)=>{c?this.fire(new Cn(c)):d&&this._updateDiff(d,t)})}else"object"==typeof e&&this._updateDiff(e,t)}_updateDiff(e,t){try{this.style.setState(e)&&this._update(!0)}catch(r){gt(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(e,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(gt("There is no style added to the map."),!1)}_isValidId(e){return null==e?(this.fire(new Cn(new Error("IDs can't be empty."))),!1):!un(e)||(this.fire(new Cn(new Error(`IDs can't contain special symbols: "${e}".`))),!1)}addSource(e,t){return this._isValidId(e)?(this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)):this}isSourceLoaded(e){return!!this._isValidId(e)&&!!this.style&&this.style._isSourceCacheLoaded(e)}areTilesLoaded(){const e=this.style&&this.style._sourceCaches;for(const t in e){const r=e[t]._tiles;for(const s in r){const c=r[s];if("loaded"!==c.state&&"errored"!==c.state)return!1}}return!0}addSourceType(e,t,r){this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,r)}removeSource(e){return this._isValidId(e)?(this.style.removeSource(e),this._updateTerrain(),this._update(!0)):this}getSource(e){return this._isValidId(e)?this.style.getOwnSource(e):null}addImage(e,t,{pixelRatio:r=1,sdf:s=!1,stretchX:c,stretchY:d,content:f}={}){if(this._lazyInitEmptyStyle(),t instanceof lt.HTMLImageElement||lt.ImageBitmap&&t instanceof lt.ImageBitmap){const{width:g,height:y,data:b}=Mn.getImageData(t);this.style.addImage(e,{data:new Uo({width:g,height:y},b),pixelRatio:r,stretchX:c,stretchY:d,content:f,sdf:s,version:0})}else if(void 0===t.width||void 0===t.height)this.fire(new Cn(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:g,height:y}=t,b=t;this.style.addImage(e,{data:new Uo({width:g,height:y},new Uint8Array(b.data)),pixelRatio:r,stretchX:c,stretchY:d,content:f,sdf:s,version:0,userImage:b}),b.onAdd&&b.onAdd(this,e)}}updateImage(e,t){this._lazyInitEmptyStyle();const r=this.style.getImage(e);if(!r)return void this.fire(new Cn(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const s=t instanceof lt.HTMLImageElement||lt.ImageBitmap&&t instanceof lt.ImageBitmap?Mn.getImageData(t):t,{width:c,height:d}=s;void 0!==c&&void 0!==d?c===r.data.width&&d===r.data.height?(r.data.replace(s.data,!(t instanceof lt.HTMLImageElement||lt.ImageBitmap&&t instanceof lt.ImageBitmap)),this.style.updateImage(e,r)):this.fire(new Cn(new Error(`The width and height of the updated image (${c}, ${d})\n                must be that same as the previous version of the image\n                (${r.data.width}, ${r.data.height})`))):this.fire(new Cn(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(e){return e?!!this.style&&!!this.style.getImage(e):(this.fire(new Cn(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e,t){Bt(this._requestManager.transformRequest(e,Ft.Image),(r,s)=>{t(r,s instanceof lt.HTMLImageElement?Mn.getImageData(s):s)})}listImages(){return this.style.listImages()}addModel(e,t){this._lazyInitEmptyStyle(),this.style.addModel(e,t)}hasModel(e){return e?this.style.hasModel(e):(this.fire(new Cn(new Error("Missing required model id"))),!1)}removeModel(e){this.style.removeModel(e)}listModels(){return this.style.listModels()}addLayer(e,t){return this._isValidId(e.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)):this}moveLayer(e,t){return this._isValidId(e)?(this.style.moveLayer(e,t),this._update(!0)):this}removeLayer(e){return this._isValidId(e)?(this.style.removeLayer(e),this._update(!0)):this}getLayer(e){return this._isValidId(e)?this.style.getOwnLayer(e):null}setLayerZoomRange(e,t,r){return this._isValidId(e)?(this.style.setLayerZoomRange(e,t,r),this._update(!0)):this}setFilter(e,t,r={}){return this._isValidId(e)?(this.style.setFilter(e,t,r),this._update(!0)):this}getFilter(e){return this._isValidId(e)?this.style.getFilter(e):null}setPaintProperty(e,t,r,s={}){return this._isValidId(e)?(this.style.setPaintProperty(e,t,r,s),this._update(!0)):this}getPaintProperty(e,t){return this._isValidId(e)?this.style.getPaintProperty(e,t):null}setLayoutProperty(e,t,r,s={}){return this._isValidId(e)?(this.style.setLayoutProperty(e,t,r,s),this._update(!0)):this}getLayoutProperty(e,t){return this._isValidId(e)?this.style.getLayoutProperty(e,t):null}getConfigProperty(e,t){return this.style.getConfigProperty(e,t)}setConfigProperty(e,t,r){return this.style.setConfigProperty(e,t,r),this._update(!0)}setLights(e){if(this._lazyInitEmptyStyle(),e&&1===e.length&&"flat"===e[0].type){const t=e[0];t.properties?this.style.setFlatLight(t.properties,t.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(e),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const e=this.style.getLights()||[];return 0===e.length&&e.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),e}setLight(e,t={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:e}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(e){return this._lazyInitEmptyStyle(),!e&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(e),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(e){return this._lazyInitEmptyStyle(),this.style.setFog(e),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(e){return this.style.setCamera(e),this._triggerCameraUpdate(e)}_triggerCameraUpdate(e){return this._update(this.transform.setOrthographicProjectionAtLowPitch("orthographic"===e["camera-projection"]))}getCamera(){return this.style.camera}_queryFogOpacity(e){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(kn.convert(e),this.transform):0}setFeatureState(e,t){return this._isValidId(e.source)?(this.style.setFeatureState(e,t),this._update()):this}removeFeatureState(e,t){return this._isValidId(e.source)?(this.style.removeFeatureState(e,t),this._update()):this}getFeatureState(e){return this._isValidId(e.source)?this.style.getFeatureState(e):null}_updateContainerDimensions(){if(!this._container)return;const e=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let r,s,c,d=this._container;for(;d&&(!s||!c);){const f=lt.getComputedStyle(d).transform;f&&"none"!==f&&(r=f.match(/matrix.*\((.+)\)/)[1].split(", "),r[0]&&"0"!==r[0]&&"1"!==r[0]&&(s=r[0]),r[3]&&"0"!==r[3]&&"1"!==r[3]&&(c=r[3])),d=d.parentElement}this._containerWidth=s?Math.abs(e/s):e,this._containerHeight=c?Math.abs(t/c):t}_detectMissingCSS(){"rgb(250, 128, 114)"!==lt.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&gt("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=ei("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=ei("div","mapboxgl-canvas-container",e);this._canvas=ei("canvas","mapboxgl-canvas",t),this._interactive&&(t.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const r=this._controlContainer=ei("div","mapboxgl-control-container",e),s=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(c=>{s[c]=ei("div",`mapboxgl-ctrl-${c}`,r)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,t){const r=Mn.devicePixelRatio||1;this._canvas.width=r*Math.ceil(e),this._canvas.height=r*Math.ceil(t),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`}_addMarker(e){this._markers.push(e)}_removeMarker(e){const t=this._markers.indexOf(e);-1!==t&&this._markers.splice(t,1)}_addPopup(e){this._popups.push(e)}_removePopup(e){const t=this._popups.indexOf(e);-1!==t&&this._popups.splice(t,1)}_setupPainter(){const e=_t({},ag.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl2",e);t?(pl(t,!0),this.painter=new vM(t,this._contextCreateOptions,this.transform),this.on("data",r=>{"source"===r.dataType&&this.painter.setTileLoadedFlag(!0)}),be.testSupport(t)):this.fire(new Cn(new Error("Failed to initialize WebGL")))}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new de("webglcontextlost",{originalEvent:e}))}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new de("webglcontextrestored",{originalEvent:e}))}_onMapScroll(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_requestDomTask(e){!this.loaded()||this.loaded()&&!this.isMoving()?e():this._domRenderTaskQueue.add(e)}_render(e){let t;this.fire(new de("renderstart"));const r=this.painter.context.extTimerQuery,s=Mn.now(),c=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(t=c.createQuery(),c.beginQuery(r.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],lt.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],lt.performance.now())),this._renderTaskQueue.run(e),this._domRenderTaskQueue.run(e),this._removed)return;this._updateProjectionTransition();const d=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const y=this.transform.zoom,b=this.transform.pitch,w=Mn.now(),P=new Ri(y,{now:w,fadeDuration:d,pitch:b,transition:this.style.transition});this.style.update(P)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let f=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),f=this._updateAverageElevation(s),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):f=this._updateAverageElevation(s),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,d,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:d,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new de("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new de("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const y=Mn.now()-s;c.endQuery(r.TIME_ELAPSED_EXT),setTimeout(()=>{const b=c.getQueryParameter(t,c.QUERY_RESULT)/1e6;c.deleteQuery(t),this.fire(new de("gpu-timing-frame",{cpuTime:y,gpuTime:b})),lt.performance.mark("frame-gpu",{startTime:s,detail:{gpuTime:b}})},50)}if(this.listens("gpu-timing-layer")){const y=this.painter.collectGpuTimers();setTimeout(()=>{const b=this.painter.queryGpuTimers(y);this.fire(new de("gpu-timing-layer",{layerTimes:b}))},50)}if(this.listens("gpu-timing-deferred-render")){const y=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const b=this.painter.queryGpuTimeDeferredRender(y);this.fire(new de("gpu-timing-deferred-render",{gpuTime:b}))},50)}const g=this._sourcesDirty||this._styleDirty||this._placementDirty||f;if(g||this._repaint)this.triggerRepaint();else{const y=!this.isMoving()&&this.loaded();if(y&&(f=this._updateAverageElevation(s,!0)),f)this.triggerRepaint();else if(this._triggerFrame(!1),y&&(this.fire(new de("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const b=this._calculateSpeedIndex();this.fire(new de("speedindexcompleted",{speedIndex:b})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,mh.mark(gl.fullLoad),this._performanceMetricsCollection&&ai(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(e){for(const t of this._markers)e&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!e||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(e,t=!1){const r=c=>(this.transform.averageElevation=c,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&r(0);const s=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(s||(t||e-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(e)){const c=this.transform.averageElevation;let d=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(d)?d=0:this._averageElevationLastSampledAt=e;const f=Math.abs(c-d);if(f>1){if(this._isInitialLoad||s)return this._averageElevation.jumpTo(d),r(d);this._averageElevation.easeTo(d,e,300)}else if(f>1e-4)return this._averageElevation.jumpTo(d),r(d)}return!!this._averageElevation.isEasing(e)&&r(this._averageElevation.getValue(e))}_authenticate(){Ti(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,e=>{if(e&&(e.message===kt||401===e.status)){const t=this.painter.context.gl;pl(t,!1),this._logoControl instanceof QS&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new Cn(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),vr(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const e=this._isDragging();this.painter.updateTerrain(this.style,e)}_calculateSpeedIndex(){const e=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const r=this.painter.context.gl,s=r.createFramebuffer();function c(d){r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,d,0);const f=new Uint8Array(r.drawingBufferWidth*r.drawingBufferHeight*4);return r.readPixels(0,0,r.drawingBufferWidth,r.drawingBufferHeight,r.RGBA,r.UNSIGNED_BYTE,f),f}return r.bindFramebuffer(r.FRAMEBUFFER,s),this._canvasPixelComparison(c(e),t.canvasCopies.map(c),t.timeStamps)}_canvasPixelComparison(e,t,r){let s=r[1]-r[0];const c=e.length/4;for(let d=0;d<t.length;d++){const f=t[d];let g=0;for(let y=0;y<f.length;y+=4)f[y]===e[y]&&f[y+1]===e[y+1]&&f[y+2]===e[y+2]&&f[y+3]===e[y+3]&&(g+=1);s+=(r[d+2]-r[d+1])*(1-g/c)}return s}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==lt&&(lt.removeEventListener("resize",this._onWindowResize,!1),lt.removeEventListener("orientationchange",this._onWindowResize,!1),lt.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),lt.removeEventListener("online",this._onWindowOnline,!1),lt.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),zr.delete(this.painter.context.gl),this._removed=!0,this.fire(new de("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(e){this._renderNextFrame=this._renderNextFrame||e,this.style&&!this._frame&&(this._frame=Mn.frame(t=>{const r=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,r&&this._render(t)}))}_preloadTiles(e){return Kt(this.style?Object.values(this.style._sourceCaches):[],(t,r)=>t._preloadTiles(e,r),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(e){this._trackResize&&this.resize({originalEvent:e})._update()}_onVisibilityChange(){"hidden"===lt.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(e){this._showTerrainWireframe!==e&&(this._showTerrainWireframe=e,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(e){this._showLayers2DWireframe!==e&&(this._showLayers2DWireframe=e,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(e){this._showLayers3DWireframe!==e&&(this._showLayers3DWireframe=e,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(e){this._speedIndexTiming!==e&&(this._speedIndexTiming=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(e){this._showTileAABBs!==e&&(this._showTileAABBs=e,e&&this._update())}_setCacheLimits(e,t){Vi=e,Ur=t}get version(){return ye}},NavigationControl:class{constructor(e){this.options=_t({},gD,e),this._container=ei("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(Tn(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),ei("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),ei("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(Tn(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const r=this._map;r&&(this.options.visualizePitch?r.resetNorthPitch({},{originalEvent:t}):r.resetNorth({},{originalEvent:t}))}),this._compassIcon=ei("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const e=this._map;if(!e)return;const t=e.getZoom(),r=t===e.getMaxZoom(),s=t===e.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=s,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",s.toString())}_rotateCompassArrow(){const e=this._map;if(!e)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(e.transform.pitch*(Math.PI/180)),.5)}) rotateX(${e.transform.pitch}deg) rotateZ(${e.transform.angle*(180/Math.PI)}deg)`:`rotate(${e.transform.angle*(180/Math.PI)}deg)`;e._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),e.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&e.on("pitch",this._rotateCompassArrow),e.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new eA(e,this._compass,this.options.visualizePitch)),this._container}onRemove(){const e=this._map;e&&(this._container.remove(),this.options.showZoom&&e.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&e.off("pitch",this._rotateCompassArrow),e.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(e,t){const r=ei("button",e,this._container);return r.type="button",r.addEventListener("click",t),r}_setButtonTitle(e,t){if(!this._map)return;const r=this._map._getUIString(`NavigationControl.${t}`);e.setAttribute("aria-label",r),e.firstElementChild&&e.firstElementChild.setAttribute("title",r)}},GeolocateControl:class extends ki{constructor(e){super(),this.options=_t({geolocation:lt.navigator.geolocation},II,e),Tn(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=$S(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(e){return this._map=e,this._container=ei("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(e){const t=(r=!!this.options.geolocation)=>{this._supportsGeolocation=r,e(r)};void 0!==this._supportsGeolocation?e(this._supportsGeolocation):void 0!==lt.navigator.permissions?lt.navigator.permissions.query({name:"geolocation"}).then(r=>t("denied"!==r.state)).catch(()=>t()):t()}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),r=e.coords;return!!t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new de("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new de("geolocate",e)),this._finish()}}_updateCamera(e){const t=new kn(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,s=_t({bearing:this._map.getBearing()},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(r),s,{geolocateSource:!0})}_updateMarker(e){if(e){const t=new kn(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const e=this._map.transform,t=ii(1,e._center.lat)*e.worldSize,r=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new de("error",e)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(e){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=ei("button","mapboxgl-ctrl-geolocate",this._container),ei("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===e){gt("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ei("div","mapboxgl-user-location"),this._dotElement.appendChild(ei("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ei("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new LM({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ei("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new LM({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new de("trackuserlocationend")))})}}_onDeviceOrientation(e){this._userLocationDotMarker&&(e.webkitCompassHeading?this._heading=e.webkitCompassHeading:!0===e.absolute&&(this._heading=-1*e.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return gt("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new de("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new de("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new de("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(e={maximumAge:6e5,timeout:0},this._noTimeout=!0):(e=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,e),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const e=()=>{lt.addEventListener("ondeviceorientationabsolute"in lt?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==lt.DeviceMotionEvent&&"function"==typeof lt.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(t=>{"granted"===t&&e()}).catch(console.error):e()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),lt.removeEventListener("deviceorientation",this._onDeviceOrientation),lt.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:DM,ScaleControl:class{constructor(e){this.options=_t({},nA,e),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),Tn(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const e=this.options.maxWidth||100,t=this._map,r=t._containerHeight/2,s=t._containerWidth/2-e/2,c=t.unproject([s,r]),d=t.unproject([s+e,r]),f=c.distanceTo(d);if("imperial"===this.options.unit){const g=3.2808*f;g>5280?this._setScale(e,g/5280,"mile"):this._setScale(e,g,"foot")}else"nautical"===this.options.unit?this._setScale(e,f/1852,"nautical-mile"):f>=1e3?this._setScale(e,f/1e3,"kilometer"):this._setScale(e,f,"meter")}_setScale(e,t,r){this._map._requestDomTask(()=>{const s=function(d){const f=Math.pow(10,`${Math.floor(d)}`.length-1);let g=d/f;return g=g>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:function(y){const b=Math.pow(10,Math.ceil(-Math.log(y)/Math.LN10));return Math.round(y*b)/b}(g),f*g}(t),c=s/t;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==r?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:r}).format(s):`${s}&nbsp;${mD[r]}`,this._container.style.width=e*c+"px"})}onAdd(e){return this._map=e,this._language=e.getLanguage(),this._container=ei("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(e){this._language=e,this._update()}setUnit(e){this.options.unit=e,this._update()}},FullscreenControl:class{constructor(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof lt.HTMLElement?this._container=e.container:gt("Full screen control 'container' must be a DOM element.")),Tn(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in lt.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in lt.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=ei("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",gt("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,lt.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!lt.document.fullscreenEnabled&&!lt.document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=ei("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ei("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),lt.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",e)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(lt.document.fullscreenElement||lt.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?lt.document.exitFullscreen?lt.document.exitFullscreen():lt.document.webkitCancelFullScreen&&lt.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends ki{constructor(e){super(),this.options=_t(Object.create(JS),e),Tn(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(e&&e.className?e.className.trim().split(/\s+/):[])}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&e.on("preclick",this._onClose),this.options.closeOnMove&&e.on("move",this._onClose),e.on("remove",this.remove),this._update(),e._addPopup(this),this._focusFirstElement(),this._trackPointer?(e.on("mousemove",this._onMouseEvent),e.on("mouseup",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")):e.on("move",this._update),this.fire(new de("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const e=this._map;return e&&(e.off("move",this._update),e.off("move",this._onClose),e.off("preclick",this._onClose),e.off("click",this._onClose),e.off("remove",this.remove),e.off("mousemove",this._onMouseEvent),e.off("mouseup",this._onMouseEvent),e.off("drag",this._onMouseEvent),e._canvasContainer&&e._canvasContainer.classList.remove("mapboxgl-track-pointer"),e._removePopup(this),this._map=void 0),this.fire(new de("close")),this}getLngLat(){return this._lngLat}setLngLat(e){this._lngLat=kn.convert(e),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const e=this._map;return e&&(e.off("move",this._update),e.on("mousemove",this._onMouseEvent),e.on("drag",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(lt.document.createTextNode(e))}setHTML(e){const t=lt.document.createDocumentFragment(),r=lt.document.createElement("body");let s;for(r.innerHTML=e;s=r.firstChild,s;)t.appendChild(s);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=ei("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(e),this.options.closeButton){const r=this._closeButton=ei("button","mapboxgl-popup-close-button",t);r.type="button",r.setAttribute("aria-label","Close popup"),r.setAttribute("aria-hidden","true"),r.innerHTML="&#215;",r.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(e){return this._classList.add(e),this._updateClassList(),this}removeClassName(e){return this._classList.delete(e),this._updateClassList(),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){let t;return this._classList.delete(e)?t=!1:(this._classList.add(e),t=!0),this._updateClassList(),t}_onMouseEvent(e){this._update(e.point)}_getAnchor(e){if(this.options.anchor)return this.options.anchor;const t=this._map,r=this._container,s=this._pos;if(!t||!r||!s)return"bottom";const c=r.offsetWidth,d=r.offsetHeight,f=s.x<c/2,g=s.x>t.transform.width-c/2;if(s.y+e<d)return f?"top-left":g?"top-right":"top";if(s.y>t.transform.height-d){if(f)return"bottom-left";if(g)return"bottom-right"}return f?"left":g?"right":"bottom"}_updateClassList(){const e=this._container;if(!e)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),e.className=t.join(" ")}_update(e){const t=this._map,r=this._content;if(!t||!this._lngLat&&!this._trackPointer||!r)return;let s=this._container;if(s||(s=this._container=ei("div","mapboxgl-popup",t.getContainer()),this._tip=ei("div","mapboxgl-popup-tip",s),s.appendChild(r)),this.options.maxWidth&&s.style.maxWidth!==this.options.maxWidth&&(s.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=kM(this._lngLat,this._pos,t.transform)),!this._trackPointer||e){const c=this._pos=this._trackPointer&&e?e:t.project(this._lngLat),d=OI(this.options.offset),f=this._anchor=this._getAnchor(d.y),g=OI(this.options.offset,f),y=c.add(g).round();t._requestDomTask(()=>{this._container&&f&&(this._container.style.transform=`${RM[f]} translate(${y.x}px,${y.y}px)`)})}if(!this._marker&&t._showingGlobe()){const c=_v(t.transform,this._lngLat)?0:1;this._setOpacity(c)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(NM);e&&e.focus()}_onClose(){this.remove()}_setOpacity(e){this._container&&(this._container.style.opacity=`${e}`),this._content&&(this._content.style.pointerEvents=e?"auto":"none")}},Marker:LM,Style:ph,LngLat:kn,LngLatBounds:Xi,Point:tt,MercatorCoordinate:Xn,FreeCameraOptions:Kx,Evented:ki,config:ue,prewarm:function(){dh().acquire(Yp)},clearPrewarmedResources:function(){const e=Xp;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(Yp),Xp=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return ue.ACCESS_TOKEN},set accessToken(e){ue.ACCESS_TOKEN=e},get baseApiUrl(){return ue.API_URL},set baseApiUrl(e){ue.API_URL=e},get workerCount(){return yc.workerCount},set workerCount(e){yc.workerCount=e},get maxParallelImageRequests(){return ue.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){ue.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(e){!function(t){if(!Fl())return;const r=lt.caches.delete(Sn);t&&r.catch(t).then(()=>t())}(e)},workerUrl:"",workerClass:null,get dracoUrl(){return jE()},set dracoUrl(e){E1=Mn.resolveURL(e),BC||(BC=new _m(dh(),new ki)),BC.broadcast("setDracoUrl",E1)},setNow:Mn.setNow,restoreNow:Mn.restoreNow};vt.A=Tb,vt.D=uc,vt.E=Dt,vt.F=Fv,vt.K=Pm,vt.O=Ir,vt.P=tt,vt.T=ss,vt.V=Iv,vt.a=yx,vt.b=Zw,vt.c=Wp,vt.d=class extends ki{constructor(e,t,r,s,c,d){super(),this.actor=e,this.layerIndex=t,this.availableImages=r,this.loadVectorData=c||FC,this.loading={},this.loaded={},this.deduped=new Sb(e.scheduler),this.isSpriteLoaded=s,this.scheduler=e.scheduler,this.brightness=d}loadTile(e,t){const r=e.uid,s=e&&e.request,c=s&&s.collectResourceTiming,d=this.loading[r]=new C1(e);d.abort=this.loadVectorData(e,(f,g)=>{const y=!this.loading[r];if(delete this.loading[r],y||f||!g)return d.status="done",y||(this.loaded[r]=d),t(f);const b=g.rawData,w={};g.expires&&(w.expires=g.expires),g.cacheControl&&(w.cacheControl=g.cacheControl),d.vectorTile=g.vectorTile||new wx(new Dv(b));const P=()=>{d.parse(d.vectorTile,this.layerIndex,this.availableImages,this.actor,(O,I)=>{if(O||!I)return t(O);const A={};if(c){const l=Ba(s);l.length>0&&(A.resourceTiming=JSON.parse(JSON.stringify(l)))}t(null,_t({rawTileData:b.slice(0)},I,w,A))})};this.isSpriteLoaded?P():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(P,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom}):P()}),this.loaded=this.loaded||{},this.loaded[r]=d})}reloadTile(e,t){const r=this.loaded,s=e.uid,c=this;if(r&&r[s]){const d=r[s];d.showCollisionBoxes=e.showCollisionBoxes,d.projection=e.projection,d.brightness=e.brightness,d.tileTransform=Ku(e.tileID.canonical,e.projection),d.extraShadowCaster=e.extraShadowCaster;const f=(g,y)=>{const b=d.reloadCallback;b&&(delete d.reloadCallback,d.parse(d.vectorTile,c.layerIndex,this.availableImages,c.actor,b)),t(g,y)};"parsing"===d.status?d.reloadCallback=f:"done"===d.status&&(d.vectorTile?d.parse(d.vectorTile,this.layerIndex,this.availableImages,this.actor,f):f())}else t(null,void 0)}abortTile(e,t){const r=e.uid,s=this.loading[r];s&&(s.abort&&s.abort(),delete this.loading[r]),t()}removeTile(e,t){const r=this.loaded,s=e.uid;r&&r[s]&&delete r[s],t()}},vt.e=Wl,vt.f=Ba,vt.g=We,vt.h=_e,vt.i=ve,vt.j=function(e,t){const r=bm(e);for(const s of r){for(const c of s.meshes)GC(c);s.lights&&(s.lightMeshIndex=s.meshes.length,s.meshes.push(KE(s.lights,t)))}return r},vt.k=Ri,vt.l=function(e){let t=0;if(new Uint32Array(e,0,1)[0]!==$E){const r=new Uint32Array(e,0,7),[,,s,c,d,f]=r;t=r.byteLength+c+d+f+d,(s!==e.byteLength||t>=e.byteLength)&&gt("Invalid b3dm header information.")}return $C(e,t)},vt.m=Dl,vt.n=tl,vt.o=de,vt.p=Ce,vt.q=function(e){er(),Ar&&Ar.then(t=>{t.keys().then(r=>{for(let s=0;s<r.length-e;s++)t.delete(r[s])})})},vt.r=A1,vt.s=FM,vt.t=Op,vt.v=pe,vt.w=lt}),mt(0,function(vt){function lt(ce){if("number"==typeof ce||"boolean"==typeof ce||"string"==typeof ce||null==ce)return JSON.stringify(ce);if(Array.isArray(ce)){let nt="[";for(const gt of ce)nt+=`${lt(gt)},`;return`${nt}]`}let et="{";for(const nt of Object.keys(ce).sort())et+=`${nt}:${lt(ce[nt])},`;return`${et}}`}function ye(ce){let et="";for(const nt of vt.r)et+=`/${lt(ce[nt])}`;return et}class ke{constructor(et){this.keyCache={},this._layers={},this._layerConfigs={},et&&this.replace(et)}replace(et,nt){this._layerConfigs={},this._layers={},this.update(et,[],nt)}update(et,nt,gt){this._options=gt;for(const oe of et){this._layerConfigs[oe.id]=oe;const Pe=this._layers[oe.id]=vt.c(oe,this._options);Pe.setScope(this.scope),Pe.compileFilter(),this.keyCache[oe.id]&&delete this.keyCache[oe.id]}for(const oe of nt)delete this.keyCache[oe],delete this._layerConfigs[oe],delete this._layers[oe];this.familiesBySource={};const Qt=function(oe,Pe){const Ge={};for(let Xe=0;Xe<oe.length;Xe++){const Ze=Pe&&Pe[oe[Xe].id]||ye(oe[Xe]);Pe&&(Pe[oe[Xe].id]=Ze);let Ie=Ge[Ze];Ie||(Ie=Ge[Ze]=[]),Ie.push(oe[Xe])}const ae=[];for(const Xe in Ge)ae.push(Ge[Xe]);return ae}(vt.v(this._layerConfigs),this.keyCache);for(const oe of Qt){const Pe=oe.map(gn=>this._layers[gn.id]),Ge=Pe[0];if("none"===Ge.visibility)continue;const ae=Ge.source||"";let Xe=this.familiesBySource[ae];Xe||(Xe=this.familiesBySource[ae]={});const Ze=Ge.sourceLayer||"_geojsonTileLayer";let Ie=Xe[Ze];Ie||(Ie=Xe[Ze]=[]),Ie.push(Pe)}}}class ue{loadTile(et,nt){const{uid:gt,encoding:Qt,rawImageData:oe,padding:Pe}=et,Ge=vt.w.ImageBitmap&&oe instanceof vt.w.ImageBitmap?this.getImageData(oe,Pe):oe;nt(null,new vt.D(gt,Ge,Qt,Pe<1))}getImageData(et,nt){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(et.width,et.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=et.width,this.offscreenCanvas.height=et.height,this.offscreenCanvasContext.drawImage(et,0,0,et.width,et.height);const gt=this.offscreenCanvasContext.getImageData(-nt,-nt,et.width+2*nt,et.height+2*nt);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),gt}}function be(ce,et){if(0!==ce.length){Pt(ce[0],et);for(var nt=1;nt<ce.length;nt++)Pt(ce[nt],!et)}}function Pt(ce,et){for(var nt=0,gt=0,Qt=0,oe=ce.length,Pe=oe-1;Qt<oe;Pe=Qt++){var Ge=(ce[Qt][0]-ce[Pe][0])*(ce[Pe][1]+ce[Qt][1]),ae=nt+Ge;gt+=Math.abs(nt)>=Math.abs(Ge)?nt-ae+Ge:Ge-ae+nt,nt=ae}nt+gt>=0!=!!et&&ce.reverse()}var Et=vt.g(function ce(et,nt){var gt,Qt=et&&et.type;if("FeatureCollection"===Qt)for(gt=0;gt<et.features.length;gt++)ce(et.features[gt],nt);else if("GeometryCollection"===Qt)for(gt=0;gt<et.geometries.length;gt++)ce(et.geometries[gt],nt);else if("Feature"===Qt)ce(et.geometry,nt);else if("Polygon"===Qt)be(et.coordinates,nt);else if("MultiPolygon"===Qt)for(gt=0;gt<et.coordinates.length;gt++)be(et.coordinates[gt],nt);return et});const Yt=vt.V.prototype.toGeoJSON;var Le={exports:{}},re=vt.p,tn=vt.a.VectorTileFeature,We=rn;function rn(ce,et){this.options=et||{},this.features=ce,this.length=ce.length}function Te(ce,et){this.id="number"==typeof ce.id?ce.id:void 0,this.type=ce.type,this.rawGeometry=1===ce.type?[ce.geometry]:ce.geometry,this.properties=ce.tags,this.extent=et||4096}rn.prototype.feature=function(ce){return new Te(this.features[ce],this.options.extent)},Te.prototype.loadGeometry=function(){var ce=this.rawGeometry;this.geometry=[];for(var et=0;et<ce.length;et++){for(var nt=ce[et],gt=[],Qt=0;Qt<nt.length;Qt++)gt.push(new re(nt[Qt][0],nt[Qt][1]));this.geometry.push(gt)}return this.geometry},Te.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ce=this.geometry,et=1/0,nt=-1/0,gt=1/0,Qt=-1/0,oe=0;oe<ce.length;oe++)for(var Pe=ce[oe],Ge=0;Ge<Pe.length;Ge++){var ae=Pe[Ge];et=Math.min(et,ae.x),nt=Math.max(nt,ae.x),gt=Math.min(gt,ae.y),Qt=Math.max(Qt,ae.y)}return[et,gt,nt,Qt]},Te.prototype.toGeoJSON=tn.prototype.toGeoJSON;var Fn=vt.b,Ce=We;function me(ce){var et=new Fn;return function(nt,gt){for(var Qt in nt.layers)gt.writeMessage(3,tt,nt.layers[Qt])}(ce,et),et.finish()}function tt(ce,et){var nt;et.writeVarintField(15,ce.version||1),et.writeStringField(1,ce.name||""),et.writeVarintField(5,ce.extent||4096);var gt={keys:[],values:[],keycache:{},valuecache:{}};for(nt=0;nt<ce.length;nt++)gt.feature=ce.feature(nt),et.writeMessage(2,Xt,gt);var Qt=gt.keys;for(nt=0;nt<Qt.length;nt++)et.writeStringField(3,Qt[nt]);var oe=gt.values;for(nt=0;nt<oe.length;nt++)et.writeMessage(4,en,oe[nt])}function Xt(ce,et){var nt=ce.feature;void 0!==nt.id&&et.writeVarintField(1,nt.id),et.writeMessage(2,Ve,ce),et.writeVarintField(3,nt.type),et.writeMessage(4,ge,nt)}function Ve(ce,et){var nt=ce.feature,gt=ce.keys,Qt=ce.values,oe=ce.keycache,Pe=ce.valuecache;for(var Ge in nt.properties){var ae=nt.properties[Ge],Xe=oe[Ge];if(null!==ae){void 0===Xe&&(gt.push(Ge),oe[Ge]=Xe=gt.length-1),et.writeVarint(Xe);var Ze=typeof ae;"string"!==Ze&&"boolean"!==Ze&&"number"!==Ze&&(ae=JSON.stringify(ae));var Ie=Ze+":"+ae,gn=Pe[Ie];void 0===gn&&(Qt.push(ae),Pe[Ie]=gn=Qt.length-1),et.writeVarint(gn)}}}function Gt(ce,et){return(et<<3)+(7&ce)}function Ct(ce){return ce<<1^ce>>31}function ge(ce,et){for(var nt=ce.loadGeometry(),gt=ce.type,Qt=0,oe=0,Pe=nt.length,Ge=0;Ge<Pe;Ge++){var ae=nt[Ge],Xe=1;1===gt&&(Xe=ae.length),et.writeVarint(Gt(1,Xe));for(var Ze=3===gt?ae.length-1:ae.length,Ie=0;Ie<Ze;Ie++){1===Ie&&1!==gt&&et.writeVarint(Gt(2,Ze-1));var gn=ae[Ie].x-Qt,ur=ae[Ie].y-oe;et.writeVarint(Ct(gn)),et.writeVarint(Ct(ur)),Qt+=gn,oe+=ur}3===gt&&et.writeVarint(Gt(7,1))}}function en(ce,et){var nt=typeof ce;"string"===nt?et.writeStringField(1,ce):"boolean"===nt?et.writeBooleanField(7,ce):"number"===nt&&(ce%1!=0?et.writeDoubleField(3,ce):ce<0?et.writeSVarintField(6,ce):et.writeVarintField(5,ce))}Le.exports=me,Le.exports.fromVectorTileJs=me,Le.exports.fromGeojsonVt=function(ce,et){et=et||{};var nt={};for(var gt in ce)nt[gt]=new Ce(ce[gt].features,et),nt[gt].name=gt,nt[gt].version=et.version,nt[gt].extent=et.extent;return me({layers:nt})},Le.exports.GeoJSONWrapper=Ce;var Ui=vt.g(Le.exports);const cs={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ce=>ce},Go=Math.fround||(us=new Float32Array(1),ce=>(us[0]=+ce,us[0]));var us;const Yr=3,Ne=5,vs=6;class Wt{constructor(et){this.options=Object.assign(Object.create(cs),et),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(et){const{log:nt,minZoom:gt,maxZoom:Qt}=this.options;nt&&console.time("total time");const oe=`prepare ${et.length} points`;nt&&console.time(oe),this.points=et;const Pe=[];for(let ae=0;ae<et.length;ae++){const Xe=et[ae];if(!Xe.geometry)continue;const[Ze,Ie]=Xe.geometry.coordinates,gn=Go(_t(Ze)),ur=Go(he(Ie));Pe.push(gn,ur,1/0,ae,-1,1),this.options.reduce&&Pe.push(0)}let Ge=this.trees[Qt+1]=this._createTree(Pe);nt&&console.timeEnd(oe);for(let ae=Qt;ae>=gt;ae--){const Xe=+Date.now();Ge=this.trees[ae]=this._createTree(this._cluster(Ge,ae)),nt&&console.log("z%d: %d clusters in %dms",ae,Ge.numItems,+Date.now()-Xe)}return nt&&console.timeEnd("total time"),this}getClusters(et,nt){let gt=((et[0]+180)%360+360)%360-180;const Qt=Math.max(-90,Math.min(90,et[1]));let oe=180===et[2]?180:((et[2]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,et[3]));if(et[2]-et[0]>=360)gt=-180,oe=180;else if(gt>oe){const Ie=this.getClusters([gt,Qt,180,Pe],nt),gn=this.getClusters([-180,Qt,oe,Pe],nt);return Ie.concat(gn)}const Ge=this.trees[this._limitZoom(nt)],ae=Ge.range(_t(gt),he(Pe),_t(oe),he(Qt)),Xe=Ge.data,Ze=[];for(const Ie of ae){const gn=this.stride*Ie;Ze.push(Xe[gn+Ne]>1?Kt(Xe,gn,this.clusterProps):this.points[Xe[gn+Yr]])}return Ze}getChildren(et){const nt=this._getOriginId(et),gt=this._getOriginZoom(et),Qt="No cluster with the specified id.",oe=this.trees[gt];if(!oe)throw new Error(Qt);const Pe=oe.data;if(nt*this.stride>=Pe.length)throw new Error(Qt);const Ge=this.options.radius/(this.options.extent*Math.pow(2,gt-1)),ae=oe.within(Pe[nt*this.stride],Pe[nt*this.stride+1],Ge),Xe=[];for(const Ze of ae){const Ie=Ze*this.stride;Pe[Ie+4]===et&&Xe.push(Pe[Ie+Ne]>1?Kt(Pe,Ie,this.clusterProps):this.points[Pe[Ie+Yr]])}if(0===Xe.length)throw new Error(Qt);return Xe}getLeaves(et,nt,gt){const Qt=[];return this._appendLeaves(Qt,et,nt=nt||10,gt=gt||0,0),Qt}getTile(et,nt,gt){const Qt=this.trees[this._limitZoom(et)],oe=Math.pow(2,et),{extent:Pe,radius:Ge}=this.options,ae=Ge/Pe,Xe=(gt-ae)/oe,Ze=(gt+1+ae)/oe,Ie={features:[]};return this._addTileFeatures(Qt.range((nt-ae)/oe,Xe,(nt+1+ae)/oe,Ze),Qt.data,nt,gt,oe,Ie),0===nt&&this._addTileFeatures(Qt.range(1-ae/oe,Xe,1,Ze),Qt.data,oe,gt,oe,Ie),nt===oe-1&&this._addTileFeatures(Qt.range(0,Xe,ae/oe,Ze),Qt.data,-1,gt,oe,Ie),Ie.features.length?Ie:null}getClusterExpansionZoom(et){let nt=this._getOriginZoom(et)-1;for(;nt<=this.options.maxZoom;){const gt=this.getChildren(et);if(nt++,1!==gt.length)break;et=gt[0].properties.cluster_id}return nt}_appendLeaves(et,nt,gt,Qt,oe){const Pe=this.getChildren(nt);for(const Ge of Pe){const ae=Ge.properties;if(ae&&ae.cluster?oe+ae.point_count<=Qt?oe+=ae.point_count:oe=this._appendLeaves(et,ae.cluster_id,gt,Qt,oe):oe<Qt?oe++:et.push(Ge),et.length===gt)break}return oe}_createTree(et){const nt=new vt.K(et.length/this.stride|0,this.options.nodeSize,Float32Array);for(let gt=0;gt<et.length;gt+=this.stride)nt.add(et[gt],et[gt+1]);return nt.finish(),nt.data=et,nt}_addTileFeatures(et,nt,gt,Qt,oe,Pe){for(const Ge of et){const ae=Ge*this.stride,Xe=nt[ae+Ne]>1;let Ze,Ie,gn;if(Xe)Ze=pe(nt,ae,this.clusterProps),Ie=nt[ae],gn=nt[ae+1];else{const Fr=this.points[nt[ae+Yr]];Ze=Fr.properties;const[Xr,Sn]=Fr.geometry.coordinates;Ie=_t(Xr),gn=he(Sn)}const ur={type:1,geometry:[[Math.round(this.options.extent*(Ie*oe-gt)),Math.round(this.options.extent*(gn*oe-Qt))]],tags:Ze};let yn;yn=Xe||this.options.generateId?nt[ae+Yr]:this.points[nt[ae+Yr]].id,void 0!==yn&&(ur.id=yn),Pe.features.push(ur)}}_limitZoom(et){return Math.max(this.options.minZoom,Math.min(Math.floor(+et),this.options.maxZoom+1))}_cluster(et,nt){const{radius:gt,extent:Qt,reduce:oe,minPoints:Pe}=this.options,Ge=gt/(Qt*Math.pow(2,nt)),ae=et.data,Xe=[],Ze=this.stride;for(let Ie=0;Ie<ae.length;Ie+=Ze){if(ae[Ie+2]<=nt)continue;ae[Ie+2]=nt;const gn=ae[Ie],ur=ae[Ie+1],yn=et.within(ae[Ie],ae[Ie+1],Ge),Fr=ae[Ie+Ne];let Xr=Fr;for(const Sn of yn){const Vi=Sn*Ze;ae[Vi+2]>nt&&(Xr+=ae[Vi+Ne])}if(Xr>Fr&&Xr>=Pe){let Sn,Vi=gn*Fr,Ur=ur*Fr,Ar=-1;const dr=((Ie/Ze|0)<<5)+(nt+1)+this.points.length;for(const Fl of yn){const er=Fl*Ze;if(ae[er+2]<=nt)continue;ae[er+2]=nt;const Rs=ae[er+Ne];Vi+=ae[er]*Rs,Ur+=ae[er+1]*Rs,ae[er+4]=dr,oe&&(Sn||(Sn=this._map(ae,Ie,!0),Ar=this.clusterProps.length,this.clusterProps.push(Sn)),oe(Sn,this._map(ae,er)))}ae[Ie+4]=dr,Xe.push(Vi/Xr,Ur/Xr,1/0,dr,-1,Xr),oe&&Xe.push(Ar)}else{for(let Sn=0;Sn<Ze;Sn++)Xe.push(ae[Ie+Sn]);if(Xr>1)for(const Sn of yn){const Vi=Sn*Ze;if(!(ae[Vi+2]<=nt)){ae[Vi+2]=nt;for(let Ur=0;Ur<Ze;Ur++)Xe.push(ae[Vi+Ur])}}}}return Xe}_getOriginId(et){return et-this.points.length>>5}_getOriginZoom(et){return(et-this.points.length)%32}_map(et,nt,gt){if(et[nt+Ne]>1){const Pe=this.clusterProps[et[nt+vs]];return gt?Object.assign({},Pe):Pe}const Qt=this.points[et[nt+Yr]].properties,oe=this.options.map(Qt);return gt&&oe===Qt?Object.assign({},oe):oe}}function Kt(ce,et,nt){return{type:"Feature",id:ce[et+Yr],properties:pe(ce,et,nt),geometry:{type:"Point",coordinates:[(gt=ce[et],360*(gt-.5)),Ue(ce[et+1])]}};var gt}function pe(ce,et,nt){const gt=ce[et+Ne],Qt=gt>=1e4?`${Math.round(gt/1e3)}k`:gt>=1e3?Math.round(gt/100)/10+"k":gt,oe=ce[et+vs],Pe=-1===oe?{}:Object.assign({},nt[oe]);return Object.assign(Pe,{cluster:!0,cluster_id:ce[et+Yr],point_count:gt,point_count_abbreviated:Qt})}function _t(ce){return ce/360+.5}function he(ce){const et=Math.sin(ce*Math.PI/180),nt=.5-.25*Math.log((1+et)/(1-et))/Math.PI;return nt<0?0:nt>1?1:nt}function Ue(ce){const et=(180-360*ce)*Math.PI/180;return 360*Math.atan(Math.exp(et))/Math.PI-90}var In={exports:{}};In.exports=function(){function ce(Ft,Ht,te,le){for(var _e,ve=le,xe=te-Ht>>1,it=te-Ht,at=Ft[Ht],ht=Ft[Ht+1],Bt=Ft[te],kt=Ft[te+1],ee=Ht+3;ee<te;ee+=3){var Ke=et(Ft[ee],Ft[ee+1],at,ht,Bt,kt);if(Ke>ve)_e=ee,ve=Ke;else if(Ke===ve){var Nn=Math.abs(ee-xe);Nn<it&&(_e=ee,it=Nn)}}ve>le&&(_e-Ht>3&&ce(Ft,Ht,_e,le),Ft[_e+2]=ve,te-_e>3&&ce(Ft,_e,te,le))}function et(Ft,Ht,te,le,_e,ve){var xe=_e-te,it=ve-le;if(0!==xe||0!==it){var at=((Ft-te)*xe+(Ht-le)*it)/(xe*xe+it*it);at>1?(te=_e,le=ve):at>0&&(te+=xe*at,le+=it*at)}return(xe=Ft-te)*xe+(it=Ht-le)*it}function nt(Ft,Ht,te,le){var _e={id:void 0===Ft?null:Ft,type:Ht,geometry:te,tags:le,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ve){var xe=ve.geometry,it=ve.type;if("Point"===it||"MultiPoint"===it||"LineString"===it)gt(ve,xe);else if("Polygon"===it||"MultiLineString"===it)for(var at=0;at<xe.length;at++)gt(ve,xe[at]);else if("MultiPolygon"===it)for(at=0;at<xe.length;at++)for(var ht=0;ht<xe[at].length;ht++)gt(ve,xe[at][ht])}(_e),_e}function gt(Ft,Ht){for(var te=0;te<Ht.length;te+=3)Ft.minX=Math.min(Ft.minX,Ht[te]),Ft.minY=Math.min(Ft.minY,Ht[te+1]),Ft.maxX=Math.max(Ft.maxX,Ht[te]),Ft.maxY=Math.max(Ft.maxY,Ht[te+1])}function Qt(Ft,Ht,te,le){if(Ht.geometry){var _e=Ht.geometry.coordinates,ve=Ht.geometry.type,xe=Math.pow(te.tolerance/((1<<te.maxZoom)*te.extent),2),it=[],at=Ht.id;if(te.promoteId?at=Ht.properties[te.promoteId]:te.generateId&&(at=le||0),"Point"===ve)oe(_e,it);else if("MultiPoint"===ve)for(var ht=0;ht<_e.length;ht++)oe(_e[ht],it);else if("LineString"===ve)Pe(_e,it,xe,!1);else if("MultiLineString"===ve){if(te.lineMetrics){for(ht=0;ht<_e.length;ht++)Pe(_e[ht],it=[],xe,!1),Ft.push(nt(at,"LineString",it,Ht.properties));return}Ge(_e,it,xe,!1)}else if("Polygon"===ve)Ge(_e,it,xe,!0);else{if("MultiPolygon"!==ve){if("GeometryCollection"===ve){for(ht=0;ht<Ht.geometry.geometries.length;ht++)Qt(Ft,{id:at,geometry:Ht.geometry.geometries[ht],properties:Ht.properties},te,le);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ht=0;ht<_e.length;ht++){var Bt=[];Ge(_e[ht],Bt,xe,!0),it.push(Bt)}}Ft.push(nt(at,ve,it,Ht.properties))}}function oe(Ft,Ht){Ht.push(ae(Ft[0])),Ht.push(Xe(Ft[1])),Ht.push(0)}function Pe(Ft,Ht,te,le){for(var _e,ve,xe=0,it=0;it<Ft.length;it++){var at=ae(Ft[it][0]),ht=Xe(Ft[it][1]);Ht.push(at),Ht.push(ht),Ht.push(0),it>0&&(xe+=le?(_e*ht-at*ve)/2:Math.sqrt(Math.pow(at-_e,2)+Math.pow(ht-ve,2))),_e=at,ve=ht}var Bt=Ht.length-3;Ht[2]=1,ce(Ht,0,Bt,te),Ht[Bt+2]=1,Ht.size=Math.abs(xe),Ht.start=0,Ht.end=Ht.size}function Ge(Ft,Ht,te,le){for(var _e=0;_e<Ft.length;_e++){var ve=[];Pe(Ft[_e],ve,te,le),Ht.push(ve)}}function ae(Ft){return Ft/360+.5}function Xe(Ft){var Ht=Math.sin(Ft*Math.PI/180),te=.5-.25*Math.log((1+Ht)/(1-Ht))/Math.PI;return te<0?0:te>1?1:te}function Ze(Ft,Ht,te,le,_e,ve,xe,it){if(le/=Ht,ve>=(te/=Ht)&&xe<le)return Ft;if(xe<te||ve>=le)return null;for(var at=[],ht=0;ht<Ft.length;ht++){var Bt=Ft[ht],kt=Bt.geometry,ee=Bt.type,Ke=0===_e?Bt.minX:Bt.minY,Nn=0===_e?Bt.maxX:Bt.maxY;if(Ke>=te&&Nn<le)at.push(Bt);else if(!(Nn<te||Ke>=le)){var yr=[];if("Point"===ee||"MultiPoint"===ee)Ie(kt,yr,te,le,_e);else if("LineString"===ee)gn(kt,yr,te,le,_e,!1,it.lineMetrics);else if("MultiLineString"===ee)yn(kt,yr,te,le,_e,!1);else if("Polygon"===ee)yn(kt,yr,te,le,_e,!0);else if("MultiPolygon"===ee)for(var Or=0;Or<kt.length;Or++){var Qr=[];yn(kt[Or],Qr,te,le,_e,!0),Qr.length&&yr.push(Qr)}if(yr.length){if(it.lineMetrics&&"LineString"===ee){for(Or=0;Or<yr.length;Or++)at.push(nt(Bt.id,ee,yr[Or],Bt.tags));continue}"LineString"!==ee&&"MultiLineString"!==ee||(1===yr.length?(ee="LineString",yr=yr[0]):ee="MultiLineString"),"Point"!==ee&&"MultiPoint"!==ee||(ee=3===yr.length?"Point":"MultiPoint"),at.push(nt(Bt.id,ee,yr,Bt.tags))}}}return at.length?at:null}function Ie(Ft,Ht,te,le,_e){for(var ve=0;ve<Ft.length;ve+=3){var xe=Ft[ve+_e];xe>=te&&xe<=le&&(Ht.push(Ft[ve]),Ht.push(Ft[ve+1]),Ht.push(Ft[ve+2]))}}function gn(Ft,Ht,te,le,_e,ve,xe){for(var it,at,ht=ur(Ft),Bt=0===_e?Xr:Sn,kt=Ft.start,ee=0;ee<Ft.length-3;ee+=3){var Ke=Ft[ee],Nn=Ft[ee+1],yr=Ft[ee+2],Or=Ft[ee+3],Qr=Ft[ee+4],Pr=0===_e?Ke:Nn,ir=0===_e?Or:Qr,ji=!1;xe&&(it=Math.sqrt(Math.pow(Ke-Or,2)+Math.pow(Nn-Qr,2))),Pr<te?ir>te&&(at=Bt(ht,Ke,Nn,Or,Qr,te),xe&&(ht.start=kt+it*at)):Pr>le?ir<le&&(at=Bt(ht,Ke,Nn,Or,Qr,le),xe&&(ht.start=kt+it*at)):Fr(ht,Ke,Nn,yr),ir<te&&Pr>=te&&(at=Bt(ht,Ke,Nn,Or,Qr,te),ji=!0),ir>le&&Pr<=le&&(at=Bt(ht,Ke,Nn,Or,Qr,le),ji=!0),!ve&&ji&&(xe&&(ht.end=kt+it*at),Ht.push(ht),ht=ur(Ft)),xe&&(kt+=it)}var or=Ft.length-3;Ke=Ft[or],Nn=Ft[or+1],yr=Ft[or+2],(Pr=0===_e?Ke:Nn)>=te&&Pr<=le&&Fr(ht,Ke,Nn,yr),or=ht.length-3,ve&&or>=3&&(ht[or]!==ht[0]||ht[or+1]!==ht[1])&&Fr(ht,ht[0],ht[1],ht[2]),ht.length&&Ht.push(ht)}function ur(Ft){var Ht=[];return Ht.size=Ft.size,Ht.start=Ft.start,Ht.end=Ft.end,Ht}function yn(Ft,Ht,te,le,_e,ve){for(var xe=0;xe<Ft.length;xe++)gn(Ft[xe],Ht,te,le,_e,ve,!1)}function Fr(Ft,Ht,te,le){Ft.push(Ht),Ft.push(te),Ft.push(le)}function Xr(Ft,Ht,te,le,_e,ve){var xe=(ve-Ht)/(le-Ht);return Ft.push(ve),Ft.push(te+(_e-te)*xe),Ft.push(1),xe}function Sn(Ft,Ht,te,le,_e,ve){var xe=(ve-te)/(_e-te);return Ft.push(Ht+(le-Ht)*xe),Ft.push(ve),Ft.push(1),xe}function Vi(Ft,Ht){for(var te=[],le=0;le<Ft.length;le++){var _e,ve=Ft[le],xe=ve.type;if("Point"===xe||"MultiPoint"===xe||"LineString"===xe)_e=Ur(ve.geometry,Ht);else if("MultiLineString"===xe||"Polygon"===xe){_e=[];for(var it=0;it<ve.geometry.length;it++)_e.push(Ur(ve.geometry[it],Ht))}else if("MultiPolygon"===xe)for(_e=[],it=0;it<ve.geometry.length;it++){for(var at=[],ht=0;ht<ve.geometry[it].length;ht++)at.push(Ur(ve.geometry[it][ht],Ht));_e.push(at)}te.push(nt(ve.id,xe,_e,ve.tags))}return te}function Ur(Ft,Ht){var te=[];te.size=Ft.size,void 0!==Ft.start&&(te.start=Ft.start,te.end=Ft.end);for(var le=0;le<Ft.length;le+=3)te.push(Ft[le]+Ht,Ft[le+1],Ft[le+2]);return te}function Ar(Ft,Ht){if(Ft.transformed)return Ft;var te,le,_e,ve=1<<Ft.z,xe=Ft.x,it=Ft.y;for(te=0;te<Ft.features.length;te++){var at=Ft.features[te],ht=at.geometry,Bt=at.type;if(at.geometry=[],1===Bt)for(le=0;le<ht.length;le+=2)at.geometry.push(dr(ht[le],ht[le+1],Ht,ve,xe,it));else for(le=0;le<ht.length;le++){var kt=[];for(_e=0;_e<ht[le].length;_e+=2)kt.push(dr(ht[le][_e],ht[le][_e+1],Ht,ve,xe,it));at.geometry.push(kt)}}return Ft.transformed=!0,Ft}function dr(Ft,Ht,te,le,_e,ve){return[Math.round(te*(Ft*le-_e)),Math.round(te*(Ht*le-ve))]}function Fl(Ft,Ht,te,le,_e){for(var ve=Ht===_e.maxZoom?0:_e.tolerance/((1<<Ht)*_e.extent),xe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:te,y:le,z:Ht,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},it=0;it<Ft.length;it++){xe.numFeatures++,er(xe,Ft[it],ve,_e);var at=Ft[it].minX,ht=Ft[it].minY,Bt=Ft[it].maxX,kt=Ft[it].maxY;at<xe.minX&&(xe.minX=at),ht<xe.minY&&(xe.minY=ht),Bt>xe.maxX&&(xe.maxX=Bt),kt>xe.maxY&&(xe.maxY=kt)}return xe}function er(Ft,Ht,te,le){var _e=Ht.geometry,ve=Ht.type,xe=[];if("Point"===ve||"MultiPoint"===ve)for(var it=0;it<_e.length;it+=3)xe.push(_e[it]),xe.push(_e[it+1]),Ft.numPoints++,Ft.numSimplified++;else if("LineString"===ve)Rs(xe,_e,Ft,te,!1,!1);else if("MultiLineString"===ve||"Polygon"===ve)for(it=0;it<_e.length;it++)Rs(xe,_e[it],Ft,te,"Polygon"===ve,0===it);else if("MultiPolygon"===ve)for(var at=0;at<_e.length;at++){var ht=_e[at];for(it=0;it<ht.length;it++)Rs(xe,ht[it],Ft,te,!0,0===it)}if(xe.length){var Bt=Ht.tags||null;if("LineString"===ve&&le.lineMetrics){for(var kt in Bt={},Ht.tags)Bt[kt]=Ht.tags[kt];Bt.mapbox_clip_start=_e.start/_e.size,Bt.mapbox_clip_end=_e.end/_e.size}var ee={geometry:xe,type:"Polygon"===ve||"MultiPolygon"===ve?3:"LineString"===ve||"MultiLineString"===ve?2:1,tags:Bt};null!==Ht.id&&(ee.id=Ht.id),Ft.features.push(ee)}}function Rs(Ft,Ht,te,le,_e,ve){var xe=le*le;if(le>0&&Ht.size<(_e?xe:le))te.numPoints+=Ht.length/3;else{for(var it=[],at=0;at<Ht.length;at+=3)(0===le||Ht[at+2]>xe)&&(te.numSimplified++,it.push(Ht[at]),it.push(Ht[at+1])),te.numPoints++;_e&&function(ht,Bt){for(var kt=0,ee=0,Ke=ht.length,Nn=Ke-2;ee<Ke;Nn=ee,ee+=2)kt+=(ht[ee]-ht[Nn])*(ht[ee+1]+ht[Nn+1]);if(kt>0===Bt)for(ee=0,Ke=ht.length;ee<Ke/2;ee+=2){var yr=ht[ee],Or=ht[ee+1];ht[ee]=ht[Ke-2-ee],ht[ee+1]=ht[Ke-1-ee],ht[Ke-2-ee]=yr,ht[Ke-1-ee]=Or}}(it,ve),Ft.push(it)}}function no(Ft,Ht){var te=(Ht=this.options=function(_e,ve){for(var xe in ve)_e[xe]=ve[xe];return _e}(Object.create(this.options),Ht)).debug;if(te&&console.time("preprocess data"),Ht.maxZoom<0||Ht.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ht.promoteId&&Ht.generateId)throw new Error("promoteId and generateId cannot be used together.");var _e,ve,xe,it,at,ht,le=function(_e,ve){var xe=[];if("FeatureCollection"===_e.type)for(var it=0;it<_e.features.length;it++)Qt(xe,_e.features[it],ve,it);else Qt(xe,"Feature"===_e.type?_e:{geometry:_e},ve);return xe}(Ft,Ht);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ht.indexMaxZoom,Ht.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(_e=le,ve=Ht,xe=ve.buffer/ve.extent,it=_e,at=Ze(_e,1,-1-xe,xe,0,-1,2,ve),ht=Ze(_e,1,1-xe,2+xe,0,-1,2,ve),(at||ht)&&(it=Ze(_e,1,-xe,1+xe,0,-1,2,ve)||[],at&&(it=Vi(at,1).concat(it)),ht&&(it=it.concat(Vi(ht,-1)))),le=it).length&&this.splitTile(le,0,0,0),te&&(le.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ds(Ft,Ht,te){return 32*((1<<Ft)*te+Ht)+Ft}return no.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},no.prototype.splitTile=function(Ft,Ht,te,le,_e,ve,xe){for(var it=[Ft,Ht,te,le],at=this.options,ht=at.debug;it.length;){le=it.pop(),te=it.pop(),Ht=it.pop(),Ft=it.pop();var Bt=1<<Ht,kt=ds(Ht,te,le),ee=this.tiles[kt];if(!ee&&(ht>1&&console.time("creation"),ee=this.tiles[kt]=Fl(Ft,Ht,te,le,at),this.tileCoords.push({z:Ht,x:te,y:le}),ht)){ht>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ht,te,le,ee.numFeatures,ee.numPoints,ee.numSimplified),console.timeEnd("creation"));var Ke="z"+Ht;this.stats[Ke]=(this.stats[Ke]||0)+1,this.total++}if(ee.source=Ft,_e){if(Ht===at.maxZoom||Ht===_e)continue;var Nn=1<<_e-Ht;if(te!==Math.floor(ve/Nn)||le!==Math.floor(xe/Nn))continue}else if(Ht===at.indexMaxZoom||ee.numPoints<=at.indexMaxPoints)continue;if(ee.source=null,0!==Ft.length){ht>1&&console.time("clipping");var yr,Or,Qr,Pr,ir,ji,or=.5*at.buffer/at.extent,qs=.5-or,ne=.5+or,Vt=1+or;yr=Or=Qr=Pr=null,ir=Ze(Ft,Bt,te-or,te+ne,0,ee.minX,ee.maxX,at),ji=Ze(Ft,Bt,te+qs,te+Vt,0,ee.minX,ee.maxX,at),Ft=null,ir&&(yr=Ze(ir,Bt,le-or,le+ne,1,ee.minY,ee.maxY,at),Or=Ze(ir,Bt,le+qs,le+Vt,1,ee.minY,ee.maxY,at),ir=null),ji&&(Qr=Ze(ji,Bt,le-or,le+ne,1,ee.minY,ee.maxY,at),Pr=Ze(ji,Bt,le+qs,le+Vt,1,ee.minY,ee.maxY,at),ji=null),ht>1&&console.timeEnd("clipping"),it.push(yr||[],Ht+1,2*te,2*le),it.push(Or||[],Ht+1,2*te,2*le+1),it.push(Qr||[],Ht+1,2*te+1,2*le),it.push(Pr||[],Ht+1,2*te+1,2*le+1)}}},no.prototype.getTile=function(Ft,Ht,te){var le=this.options,_e=le.extent,ve=le.debug;if(Ft<0||Ft>24)return null;var xe=1<<Ft,it=ds(Ft,Ht=(Ht%xe+xe)%xe,te);if(this.tiles[it])return Ar(this.tiles[it],_e);ve>1&&console.log("drilling down to z%d-%d-%d",Ft,Ht,te);for(var at,ht=Ft,Bt=Ht,kt=te;!at&&ht>0;)ht--,Bt=Math.floor(Bt/2),kt=Math.floor(kt/2),at=this.tiles[ds(ht,Bt,kt)];return at&&at.source?(ve>1&&console.log("found parent tile z%d-%d-%d",ht,Bt,kt),ve>1&&console.time("drilling down"),this.splitTile(at.source,ht,Bt,kt,Ft,Ht,te),ve>1&&console.timeEnd("drilling down"),this.tiles[it]?Ar(this.tiles[it],_e):null):null},function(Ft,Ht){return new no(Ft,Ht)}}();var qr=vt.g(In.exports);function wi(ce,et){const nt=ce.tileID.canonical;if(!this._geoJSONIndex)return et(null,null);const gt=this._geoJSONIndex.getTile(nt.z,nt.x,nt.y);if(!gt)return et(null,null);const Qt=new class{constructor(Pe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=vt.E,this.length=Pe.length,this._features=Pe}feature(Pe){return new class{constructor(Ge){this._feature=Ge,this.extent=vt.E,this.type=Ge.type,this.properties=Ge.tags,"id"in Ge&&!isNaN(Ge.id)&&(this.id=parseInt(Ge.id,10))}loadGeometry(){if(1===this._feature.type){const Ge=[];for(const ae of this._feature.geometry)Ge.push([new vt.P(ae[0],ae[1])]);return Ge}{const Ge=[];for(const ae of this._feature.geometry){const Xe=[];for(const Ze of ae)Xe.push(new vt.P(Ze[0],Ze[1]));Ge.push(Xe)}return Ge}}toGeoJSON(Ge,ae,Xe){return Yt.call(this,Ge,ae,Xe)}}(this._features[Pe])}}(gt.features);let oe=Ui(Qt);0===oe.byteOffset&&oe.byteLength===oe.buffer.byteLength||(oe=new Uint8Array(oe)),et(null,{vectorTile:Qt,rawData:oe.buffer})}class tr extends vt.d{constructor(et,nt,gt,Qt,oe,Pe){super(et,nt,gt,Qt,wi,Pe),oe&&(this.loadGeoJSON=oe)}loadData(et,nt){const gt=et&&et.request,Qt=gt&&gt.collectResourceTiming;this.loadGeoJSON(et,(oe,Pe)=>{if(oe||!Pe)return nt(oe);if("object"!=typeof Pe)return nt(new Error(`Input data given to '${et.source}' is not a valid GeoJSON object.`));{Et(Pe,!0);try{if(et.filter){const ae=vt.e(et.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===ae.result)throw new Error(ae.value.map(Ze=>`${Ze.key}: ${Ze.message}`).join(", "));Pe={type:"FeatureCollection",features:Pe.features.filter(Ze=>ae.value.evaluate({zoom:0},Ze))}}this._geoJSONIndex=et.cluster?new Wt(function({superclusterOptions:ae,clusterProperties:Xe}){if(!Xe||!ae)return ae;const Ze={},Ie={},gn={accumulated:null,zoom:0},ur={properties:null},yn=Object.keys(Xe);for(const Fr of yn){const[Xr,Sn]=Xe[Fr],Vi=vt.e(Sn),Ur=vt.e("string"==typeof Xr?[Xr,["accumulated"],["get",Fr]]:Xr);Ze[Fr]=Vi.value,Ie[Fr]=Ur.value}return ae.map=Fr=>{ur.properties=Fr;const Xr={};for(const Sn of yn)Xr[Sn]=Ze[Sn].evaluate(gn,ur);return Xr},ae.reduce=(Fr,Xr)=>{ur.properties=Xr;for(const Sn of yn)gn.accumulated=Fr[Sn],Fr[Sn]=Ie[Sn].evaluate(gn,ur)},ae}(et)).load(Pe.features):qr(Pe,et.geojsonVtOptions)}catch(ae){return nt(ae)}this.loaded={};const Ge={};if(Qt){const ae=vt.f(gt);ae&&(Ge.resourceTiming={},Ge.resourceTiming[et.source]=JSON.parse(JSON.stringify(ae)))}nt(null,Ge)}})}reloadTile(et,nt){const gt=this.loaded;return gt&&gt[et.uid]?super.reloadTile(et,nt):this.loadTile(et,nt)}loadGeoJSON(et,nt){if(et.request)vt.h(et.request,nt);else{if("string"!=typeof et.data)return nt(new Error(`Input data given to '${et.source}' is not a valid GeoJSON object.`));try{return nt(null,JSON.parse(et.data))}catch{return nt(new Error(`Input data given to '${et.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(et,nt){try{nt(null,this._geoJSONIndex.getClusterExpansionZoom(et.clusterId))}catch(gt){nt(gt)}}getClusterChildren(et,nt){try{nt(null,this._geoJSONIndex.getChildren(et.clusterId))}catch(gt){nt(gt)}}getClusterLeaves(et,nt){try{nt(null,this._geoJSONIndex.getLeaves(et.clusterId,et.limit,et.offset))}catch(gt){nt(gt)}}}class Tn{constructor(et,nt){this.tileID=new vt.O(et.tileID.overscaledZ,et.tileID.wrap,et.tileID.canonical.z,et.tileID.canonical.x,et.tileID.canonical.y),this.tileZoom=et.tileZoom,this.uid=et.uid,this.zoom=et.zoom,this.canonical=et.tileID.canonical,this.pixelRatio=et.pixelRatio,this.tileSize=et.tileSize,this.source=et.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=et.projection,this.brightness=nt}parse(et,nt,gt,Qt){this.status="parsing";const oe=new vt.O(gt.tileID.overscaledZ,gt.tileID.wrap,gt.tileID.canonical.z,gt.tileID.canonical.x,gt.tileID.canonical.y),Pe={},Ge=nt.familiesBySource[gt.source],ae=new vt.F(oe,gt.promoteId);return ae.bucketLayerIDs=[],vt.l(et).then(Xe=>{if(!Xe)return Qt(new Error("Could not parse tile"));const Ze=vt.j(Xe,1/vt.t(gt.tileID.canonical)),Ie=Xe.json.extensionsUsed&&Xe.json.extensionsUsed.includes("MAPBOX_mesh_features"),gn=new vt.k(this.zoom,{brightness:this.brightness});for(const ur in Ge)for(const yn of Ge[ur]){const Fr=yn[0],Xr=Xe.json.extensionsUsed;Fr.recalculate(gn,[]);const Sn=new vt.T(Ze,oe,Xr&&Xr.includes("MAPBOX_mesh_features"),this.brightness);Ie||(Sn.needsUpload=!0),Pe[Fr.fqid]=Sn,Sn.evaluate(Fr)}this.status="done",Qt(null,{buckets:Pe,featureIndex:ae})}).catch(Xe=>Qt(new Error(Xe.message)))}}class pn{constructor(et,nt,gt,Qt,oe,Pe){this.actor=et,this.layerIndex=nt,this.brightness=Pe,this.loading={},this.loaded={}}loadTile(et,nt){const gt=et.uid,Qt=this.loading[gt]=new Tn(et,this.brightness);vt.i(et.request,(oe,Pe)=>{const Ge=!this.loading[gt];return delete this.loading[gt],Ge||oe?(Qt.status="done",Ge||(this.loaded[gt]=Qt),nt(oe)):Pe&&0!==Pe.byteLength?void Qt.parse(Pe,this.layerIndex,et,(ae,Xe)=>{Qt.status="done",this.loaded=this.loaded||{},this.loaded[gt]=Qt,ae||!Xe?nt(ae):nt(null,Xe)}):(Qt.status="done",this.loaded[gt]=Qt,nt())})}reloadTile(et,nt){const gt=this.loaded,Qt=et.uid;if(gt&&gt[Qt]){const oe=gt[Qt];oe.projection=et.projection,oe.brightness=et.brightness;const Pe=(Ge,ae)=>{oe.reloadCallback&&(delete oe.reloadCallback,this.loadTile(et,nt)),nt(Ge,ae)};"parsing"===oe.status?oe.reloadCallback=Pe:"done"===oe.status&&this.loadTile(et,nt)}}abortTile(et,nt){const gt=et.uid;this.loading[gt]&&delete this.loading[gt],nt()}removeTile(et,nt){const gt=this.loaded,Qt=et.uid;gt&&gt[Qt]&&delete gt[Qt],nt()}}class hi{constructor(et){this.self=et,this.actor=new vt.A(et,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=vt.m({name:"mercator"}),this.workerSourceTypes={vector:vt.d,geojson:tr,"batched-model":pn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(nt,gt)=>{if(this.workerSourceTypes[nt])throw new Error(`Worker source with name "${nt}" already registered.`);this.workerSourceTypes[nt]=gt},this.self.registerRTLTextPlugin=nt=>{if(vt.n.isParsed())throw new Error("RTL text plugin already registered.");vt.n.applyArabicShaping=nt.applyArabicShaping,vt.n.processBidirectionalText=nt.processBidirectionalText,vt.n.processStyledBidirectionalText=nt.processStyledBidirectionalText}}clearCaches(et,nt,gt){delete this.layerIndexes[et],delete this.availableImages[et],delete this.workerSources[et],delete this.demWorkerSources[et],gt()}checkIfReady(et,nt,gt){gt()}setReferrer(et,nt){this.referrer=nt}spriteLoaded(et,{scope:nt,isLoaded:gt}){if(this.isSpriteLoaded[et]||(this.isSpriteLoaded[et]={}),this.isSpriteLoaded[et][nt]=gt,this.workerSources[et]&&this.workerSources[et][nt])for(const Qt in this.workerSources[et][nt]){const oe=this.workerSources[et][nt][Qt];for(const Pe in oe)oe[Pe]instanceof vt.d&&(oe[Pe].isSpriteLoaded=gt,oe[Pe].fire(new vt.o("isSpriteLoaded")))}}setImages(et,{scope:nt,images:gt},Qt){if(this.availableImages[et]||(this.availableImages[et]={}),this.availableImages[et][nt]=gt,this.workerSources[et]&&this.workerSources[et][nt]){for(const oe in this.workerSources[et][nt]){const Pe=this.workerSources[et][nt][oe];for(const Ge in Pe)Pe[Ge].availableImages=gt}Qt()}else Qt()}setProjection(et,nt){this.projections[et]=vt.m(nt)}setBrightness(et,nt,gt){this.brightness=nt,gt()}setLayers(et,nt,gt){this.getLayerIndex(et,nt.scope).replace(nt.layers,nt.options),gt()}updateLayers(et,nt,gt){this.getLayerIndex(et,nt.scope).update(nt.layers,nt.removedIds,nt.options),gt()}loadTile(et,nt,gt){nt.projection=this.projections[et]||this.defaultProjection,this.getWorkerSource(et,nt.type,nt.source,nt.scope).loadTile(nt,gt)}loadDEMTile(et,nt,gt){this.getDEMWorkerSource(et,nt.source,nt.scope).loadTile(nt,gt)}reloadTile(et,nt,gt){nt.projection=this.projections[et]||this.defaultProjection,this.getWorkerSource(et,nt.type,nt.source,nt.scope).reloadTile(nt,gt)}abortTile(et,nt,gt){this.getWorkerSource(et,nt.type,nt.source,nt.scope).abortTile(nt,gt)}removeTile(et,nt,gt){this.getWorkerSource(et,nt.type,nt.source,nt.scope).removeTile(nt,gt)}removeSource(et,nt,gt){if(!(this.workerSources[et]&&this.workerSources[et][nt.scope]&&this.workerSources[et][nt.scope][nt.type]&&this.workerSources[et][nt.scope][nt.type][nt.source]))return;const Qt=this.workerSources[et][nt.scope][nt.type][nt.source];delete this.workerSources[et][nt.scope][nt.type][nt.source],void 0!==Qt.removeSource?Qt.removeSource(nt,gt):gt()}loadWorkerSource(et,nt,gt){try{this.self.importScripts(nt.url),gt()}catch(Qt){gt(Qt.toString())}}syncRTLPluginState(et,nt,gt){try{vt.n.setState(nt);const Qt=vt.n.getPluginURL();if(vt.n.isLoaded()&&!vt.n.isParsed()&&null!=Qt){this.self.importScripts(Qt);const oe=vt.n.isParsed();gt(oe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Qt}`),oe)}}catch(Qt){gt(Qt.toString())}}setDracoUrl(et,nt){this.dracoUrl=nt}getAvailableImages(et,nt){this.availableImages[et]||(this.availableImages[et]={});let gt=this.availableImages[et][nt];return gt||(gt=[]),gt}getLayerIndex(et,nt){this.layerIndexes[et]||(this.layerIndexes[et]={});let gt=this.layerIndexes[et][nt];return gt||(gt=this.layerIndexes[et][nt]=new ke,gt.scope=nt),gt}getWorkerSource(et,nt,gt,Qt){return this.workerSources[et]||(this.workerSources[et]={}),this.workerSources[et][Qt]||(this.workerSources[et][Qt]={}),this.workerSources[et][Qt][nt]||(this.workerSources[et][Qt][nt]={}),this.isSpriteLoaded[et]||(this.isSpriteLoaded[et]={}),this.workerSources[et][Qt][nt][gt]||(this.workerSources[et][Qt][nt][gt]=new this.workerSourceTypes[nt]({send:(Pe,Ge,ae,Xe,Ze,Ie)=>{this.actor.send(Pe,Ge,ae,et,Ze,Ie)},scheduler:this.actor.scheduler},this.getLayerIndex(et,Qt),this.getAvailableImages(et,Qt),this.isSpriteLoaded[et][Qt],void 0,this.brightness)),this.workerSources[et][Qt][nt][gt]}getDEMWorkerSource(et,nt,gt){return this.demWorkerSources[et]||(this.demWorkerSources[et]={}),this.demWorkerSources[et][gt]||(this.demWorkerSources[et][gt]={}),this.demWorkerSources[et][gt][nt]||(this.demWorkerSources[et][gt][nt]=new ue),this.demWorkerSources[et][gt][nt]}enforceCacheSizeLimit(et,nt){vt.q(nt)}getWorkerPerformanceMetrics(et,nt,gt){gt(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new hi(self)),hi}),mt(0,function(vt){return vt.s}),M}()},5619:(Hn,we,ft)=>{"use strict";ft.d(we,{X:()=>mt});var M=ft(8645);class mt extends M.x{constructor(vt){super(),this._value=vt}get value(){return this.getValue()}_subscribe(vt){const lt=super._subscribe(vt);return!lt.closed&&vt.next(this._value),lt}getValue(){const{hasError:vt,thrownError:lt,_value:ye}=this;if(vt)throw lt;return this._throwIfClosed(),ye}next(vt){super.next(this._value=vt)}}},5592:(Hn,we,ft)=>{"use strict";ft.d(we,{y:()=>ue});var M=ft(305),mt=ft(7394),It=ft(4850),vt=ft(8407),lt=ft(2653),ye=ft(4674),ke=ft(1441);let ue=(()=>{class Yt{constructor(re){re&&(this._subscribe=re)}lift(re){const tn=new Yt;return tn.source=this,tn.operator=re,tn}subscribe(re,tn,We){const rn=function Et(Yt){return Yt&&Yt instanceof M.Lv||function Pt(Yt){return Yt&&(0,ye.m)(Yt.next)&&(0,ye.m)(Yt.error)&&(0,ye.m)(Yt.complete)}(Yt)&&(0,mt.Nn)(Yt)}(re)?re:new M.Hp(re,tn,We);return(0,ke.x)(()=>{const{operator:Te,source:Fn}=this;rn.add(Te?Te.call(rn,Fn):Fn?this._subscribe(rn):this._trySubscribe(rn))}),rn}_trySubscribe(re){try{return this._subscribe(re)}catch(tn){re.error(tn)}}forEach(re,tn){return new(tn=be(tn))((We,rn)=>{const Te=new M.Hp({next:Fn=>{try{re(Fn)}catch(Ce){rn(Ce),Te.unsubscribe()}},error:rn,complete:We});this.subscribe(Te)})}_subscribe(re){var tn;return null===(tn=this.source)||void 0===tn?void 0:tn.subscribe(re)}[It.L](){return this}pipe(...re){return(0,vt.U)(re)(this)}toPromise(re){return new(re=be(re))((tn,We)=>{let rn;this.subscribe(Te=>rn=Te,Te=>We(Te),()=>tn(rn))})}}return Yt.create=Le=>new Yt(Le),Yt})();function be(Yt){var Le;return null!==(Le=Yt??lt.config.Promise)&&void 0!==Le?Le:Promise}},8645:(Hn,we,ft)=>{"use strict";ft.d(we,{x:()=>ke});var M=ft(5592),mt=ft(7394);const vt=(0,ft(2306).d)(be=>function(){be(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var lt=ft(9039),ye=ft(1441);let ke=(()=>{class be extends M.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Et){const Yt=new ue(this,this);return Yt.operator=Et,Yt}_throwIfClosed(){if(this.closed)throw new vt}next(Et){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Yt of this.currentObservers)Yt.next(Et)}})}error(Et){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Et;const{observers:Yt}=this;for(;Yt.length;)Yt.shift().error(Et)}})}complete(){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Et}=this;for(;Et.length;)Et.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Et;return(null===(Et=this.observers)||void 0===Et?void 0:Et.length)>0}_trySubscribe(Et){return this._throwIfClosed(),super._trySubscribe(Et)}_subscribe(Et){return this._throwIfClosed(),this._checkFinalizedStatuses(Et),this._innerSubscribe(Et)}_innerSubscribe(Et){const{hasError:Yt,isStopped:Le,observers:re}=this;return Yt||Le?mt.Lc:(this.currentObservers=null,re.push(Et),new mt.w0(()=>{this.currentObservers=null,(0,lt.P)(re,Et)}))}_checkFinalizedStatuses(Et){const{hasError:Yt,thrownError:Le,isStopped:re}=this;Yt?Et.error(Le):re&&Et.complete()}asObservable(){const Et=new M.y;return Et.source=this,Et}}return be.create=(Pt,Et)=>new ue(Pt,Et),be})();class ue extends ke{constructor(Pt,Et){super(),this.destination=Pt,this.source=Et}next(Pt){var Et,Yt;null===(Yt=null===(Et=this.destination)||void 0===Et?void 0:Et.next)||void 0===Yt||Yt.call(Et,Pt)}error(Pt){var Et,Yt;null===(Yt=null===(Et=this.destination)||void 0===Et?void 0:Et.error)||void 0===Yt||Yt.call(Et,Pt)}complete(){var Pt,Et;null===(Et=null===(Pt=this.destination)||void 0===Pt?void 0:Pt.complete)||void 0===Et||Et.call(Pt)}_subscribe(Pt){var Et,Yt;return null!==(Yt=null===(Et=this.source)||void 0===Et?void 0:Et.subscribe(Pt))&&void 0!==Yt?Yt:mt.Lc}}},305:(Hn,we,ft)=>{"use strict";ft.d(we,{Hp:()=>We,Lv:()=>Yt});var M=ft(4674),mt=ft(7394),It=ft(2653),vt=ft(3894),lt=ft(2420);const ye=be("C",void 0,void 0);function be(me,tt,Xt){return{kind:me,value:tt,error:Xt}}var Pt=ft(7599),Et=ft(1441);class Yt extends mt.w0{constructor(tt){super(),this.isStopped=!1,tt?(this.destination=tt,(0,mt.Nn)(tt)&&tt.add(this)):this.destination=Ce}static create(tt,Xt,Ve){return new We(tt,Xt,Ve)}next(tt){this.isStopped?Fn(function ue(me){return be("N",me,void 0)}(tt),this):this._next(tt)}error(tt){this.isStopped?Fn(function ke(me){return be("E",void 0,me)}(tt),this):(this.isStopped=!0,this._error(tt))}complete(){this.isStopped?Fn(ye,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(tt){this.destination.next(tt)}_error(tt){try{this.destination.error(tt)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Le=Function.prototype.bind;function re(me,tt){return Le.call(me,tt)}class tn{constructor(tt){this.partialObserver=tt}next(tt){const{partialObserver:Xt}=this;if(Xt.next)try{Xt.next(tt)}catch(Ve){rn(Ve)}}error(tt){const{partialObserver:Xt}=this;if(Xt.error)try{Xt.error(tt)}catch(Ve){rn(Ve)}else rn(tt)}complete(){const{partialObserver:tt}=this;if(tt.complete)try{tt.complete()}catch(Xt){rn(Xt)}}}class We extends Yt{constructor(tt,Xt,Ve){let Gt;if(super(),(0,M.m)(tt)||!tt)Gt={next:tt??void 0,error:Xt??void 0,complete:Ve??void 0};else{let Ct;this&&It.config.useDeprecatedNextContext?(Ct=Object.create(tt),Ct.unsubscribe=()=>this.unsubscribe(),Gt={next:tt.next&&re(tt.next,Ct),error:tt.error&&re(tt.error,Ct),complete:tt.complete&&re(tt.complete,Ct)}):Gt=tt}this.destination=new tn(Gt)}}function rn(me){It.config.useDeprecatedSynchronousErrorHandling?(0,Et.O)(me):(0,vt.h)(me)}function Fn(me,tt){const{onStoppedNotification:Xt}=It.config;Xt&&Pt.z.setTimeout(()=>Xt(me,tt))}const Ce={closed:!0,next:lt.Z,error:function Te(me){throw me},complete:lt.Z}},7394:(Hn,we,ft)=>{"use strict";ft.d(we,{Lc:()=>ye,w0:()=>lt,Nn:()=>ke});var M=ft(4674);const It=(0,ft(2306).d)(be=>function(Et){be(this),this.message=Et?`${Et.length} errors occurred during unsubscription:\n${Et.map((Yt,Le)=>`${Le+1}) ${Yt.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Et});var vt=ft(9039);class lt{constructor(Pt){this.initialTeardown=Pt,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Pt;if(!this.closed){this.closed=!0;const{_parentage:Et}=this;if(Et)if(this._parentage=null,Array.isArray(Et))for(const re of Et)re.remove(this);else Et.remove(this);const{initialTeardown:Yt}=this;if((0,M.m)(Yt))try{Yt()}catch(re){Pt=re instanceof It?re.errors:[re]}const{_finalizers:Le}=this;if(Le){this._finalizers=null;for(const re of Le)try{ue(re)}catch(tn){Pt=Pt??[],tn instanceof It?Pt=[...Pt,...tn.errors]:Pt.push(tn)}}if(Pt)throw new It(Pt)}}add(Pt){var Et;if(Pt&&Pt!==this)if(this.closed)ue(Pt);else{if(Pt instanceof lt){if(Pt.closed||Pt._hasParent(this))return;Pt._addParent(this)}(this._finalizers=null!==(Et=this._finalizers)&&void 0!==Et?Et:[]).push(Pt)}}_hasParent(Pt){const{_parentage:Et}=this;return Et===Pt||Array.isArray(Et)&&Et.includes(Pt)}_addParent(Pt){const{_parentage:Et}=this;this._parentage=Array.isArray(Et)?(Et.push(Pt),Et):Et?[Et,Pt]:Pt}_removeParent(Pt){const{_parentage:Et}=this;Et===Pt?this._parentage=null:Array.isArray(Et)&&(0,vt.P)(Et,Pt)}remove(Pt){const{_finalizers:Et}=this;Et&&(0,vt.P)(Et,Pt),Pt instanceof lt&&Pt._removeParent(this)}}lt.EMPTY=(()=>{const be=new lt;return be.closed=!0,be})();const ye=lt.EMPTY;function ke(be){return be instanceof lt||be&&"closed"in be&&(0,M.m)(be.remove)&&(0,M.m)(be.add)&&(0,M.m)(be.unsubscribe)}function ue(be){(0,M.m)(be)?be():be.unsubscribe()}},2653:(Hn,we,ft)=>{"use strict";ft.d(we,{config:()=>M});const M={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},6232:(Hn,we,ft)=>{"use strict";ft.d(we,{E:()=>mt});const mt=new(ft(5592).y)(lt=>lt.complete())},2459:(Hn,we,ft)=>{"use strict";ft.d(we,{D:()=>tt});var M=ft(4829),mt=ft(3093),It=ft(5137),ye=ft(5592),ue=ft(4971),be=ft(4674),Pt=ft(7103);function Yt(Xt,Ve){if(!Xt)throw new Error("Iterable cannot be null");return new ye.y(Gt=>{(0,Pt.f)(Gt,Ve,()=>{const Ct=Xt[Symbol.asyncIterator]();(0,Pt.f)(Gt,Ve,()=>{Ct.next().then(ge=>{ge.done?Gt.complete():Gt.next(ge.value)})},0,!0)})})}var Le=ft(8382),re=ft(4026),tn=ft(4266),We=ft(3664),rn=ft(5726),Te=ft(9853),Fn=ft(541);function tt(Xt,Ve){return Ve?function me(Xt,Ve){if(null!=Xt){if((0,Le.c)(Xt))return function vt(Xt,Ve){return(0,M.Xf)(Xt).pipe((0,It.R)(Ve),(0,mt.Q)(Ve))}(Xt,Ve);if((0,tn.z)(Xt))return function ke(Xt,Ve){return new ye.y(Gt=>{let Ct=0;return Ve.schedule(function(){Ct===Xt.length?Gt.complete():(Gt.next(Xt[Ct++]),Gt.closed||this.schedule())})})}(Xt,Ve);if((0,re.t)(Xt))return function lt(Xt,Ve){return(0,M.Xf)(Xt).pipe((0,It.R)(Ve),(0,mt.Q)(Ve))}(Xt,Ve);if((0,rn.D)(Xt))return Yt(Xt,Ve);if((0,We.T)(Xt))return function Et(Xt,Ve){return new ye.y(Gt=>{let Ct;return(0,Pt.f)(Gt,Ve,()=>{Ct=Xt[ue.h](),(0,Pt.f)(Gt,Ve,()=>{let ge,en;try{({value:ge,done:en}=Ct.next())}catch(Ui){return void Gt.error(Ui)}en?Gt.complete():Gt.next(ge)},0,!0)}),()=>(0,be.m)(Ct?.return)&&Ct.return()})}(Xt,Ve);if((0,Fn.L)(Xt))return function Ce(Xt,Ve){return Yt((0,Fn.Q)(Xt),Ve)}(Xt,Ve)}throw(0,Te.z)(Xt)}(Xt,Ve):(0,M.Xf)(Xt)}},4829:(Hn,we,ft)=>{"use strict";ft.d(we,{Xf:()=>Le});var M=ft(7582),mt=ft(4266),It=ft(4026),vt=ft(5592),lt=ft(8382),ye=ft(5726),ke=ft(9853),ue=ft(3664),be=ft(541),Pt=ft(4674),Et=ft(3894),Yt=ft(4850);function Le(me){if(me instanceof vt.y)return me;if(null!=me){if((0,lt.c)(me))return function re(me){return new vt.y(tt=>{const Xt=me[Yt.L]();if((0,Pt.m)(Xt.subscribe))return Xt.subscribe(tt);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(me);if((0,mt.z)(me))return function tn(me){return new vt.y(tt=>{for(let Xt=0;Xt<me.length&&!tt.closed;Xt++)tt.next(me[Xt]);tt.complete()})}(me);if((0,It.t)(me))return function We(me){return new vt.y(tt=>{me.then(Xt=>{tt.closed||(tt.next(Xt),tt.complete())},Xt=>tt.error(Xt)).then(null,Et.h)})}(me);if((0,ye.D)(me))return Te(me);if((0,ue.T)(me))return function rn(me){return new vt.y(tt=>{for(const Xt of me)if(tt.next(Xt),tt.closed)return;tt.complete()})}(me);if((0,be.L)(me))return function Fn(me){return Te((0,be.Q)(me))}(me)}throw(0,ke.z)(me)}function Te(me){return new vt.y(tt=>{(function Ce(me,tt){var Xt,Ve,Gt,Ct;return(0,M.mG)(this,void 0,void 0,function*(){try{for(Xt=(0,M.KL)(me);!(Ve=yield Xt.next()).done;)if(tt.next(Ve.value),tt.closed)return}catch(ge){Gt={error:ge}}finally{try{Ve&&!Ve.done&&(Ct=Xt.return)&&(yield Ct.call(Xt))}finally{if(Gt)throw Gt.error}}tt.complete()})})(me,tt).catch(Xt=>tt.error(Xt))})}},3019:(Hn,we,ft)=>{"use strict";ft.d(we,{T:()=>ye});var M=ft(7537),mt=ft(4829),It=ft(6232),vt=ft(4564),lt=ft(2459);function ye(...ke){const ue=(0,vt.yG)(ke),be=(0,vt._6)(ke,1/0),Pt=ke;return Pt.length?1===Pt.length?(0,mt.Xf)(Pt[0]):(0,M.J)(be)((0,lt.D)(Pt,ue)):It.E}},2096:(Hn,we,ft)=>{"use strict";ft.d(we,{of:()=>It});var M=ft(4564),mt=ft(2459);function It(...vt){const lt=(0,M.yG)(vt);return(0,mt.D)(vt,lt)}},8251:(Hn,we,ft)=>{"use strict";ft.d(we,{x:()=>mt});var M=ft(305);function mt(vt,lt,ye,ke,ue){return new It(vt,lt,ye,ke,ue)}class It extends M.Lv{constructor(lt,ye,ke,ue,be,Pt){super(lt),this.onFinalize=be,this.shouldUnsubscribe=Pt,this._next=ye?function(Et){try{ye(Et)}catch(Yt){lt.error(Yt)}}:super._next,this._error=ue?function(Et){try{ue(Et)}catch(Yt){lt.error(Yt)}finally{this.unsubscribe()}}:super._error,this._complete=ke?function(){try{ke()}catch(Et){lt.error(Et)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var lt;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ye}=this;super.unsubscribe(),!ye&&(null===(lt=this.onFinalize)||void 0===lt||lt.call(this))}}}},7398:(Hn,we,ft)=>{"use strict";ft.d(we,{U:()=>It});var M=ft(9360),mt=ft(8251);function It(vt,lt){return(0,M.e)((ye,ke)=>{let ue=0;ye.subscribe((0,mt.x)(ke,be=>{ke.next(vt.call(lt,be,ue++))}))})}},7537:(Hn,we,ft)=>{"use strict";ft.d(we,{J:()=>It});var M=ft(1631),mt=ft(2737);function It(vt=1/0){return(0,M.z)(mt.y,vt)}},1631:(Hn,we,ft)=>{"use strict";ft.d(we,{z:()=>ue});var M=ft(7398),mt=ft(4829),It=ft(9360),vt=ft(7103),lt=ft(8251),ke=ft(4674);function ue(be,Pt,Et=1/0){return(0,ke.m)(Pt)?ue((Yt,Le)=>(0,M.U)((re,tn)=>Pt(Yt,re,Le,tn))((0,mt.Xf)(be(Yt,Le))),Et):("number"==typeof Pt&&(Et=Pt),(0,It.e)((Yt,Le)=>function ye(be,Pt,Et,Yt,Le,re,tn,We){const rn=[];let Te=0,Fn=0,Ce=!1;const me=()=>{Ce&&!rn.length&&!Te&&Pt.complete()},tt=Ve=>Te<Yt?Xt(Ve):rn.push(Ve),Xt=Ve=>{re&&Pt.next(Ve),Te++;let Gt=!1;(0,mt.Xf)(Et(Ve,Fn++)).subscribe((0,lt.x)(Pt,Ct=>{Le?.(Ct),re?tt(Ct):Pt.next(Ct)},()=>{Gt=!0},void 0,()=>{if(Gt)try{for(Te--;rn.length&&Te<Yt;){const Ct=rn.shift();tn?(0,vt.f)(Pt,tn,()=>Xt(Ct)):Xt(Ct)}me()}catch(Ct){Pt.error(Ct)}}))};return be.subscribe((0,lt.x)(Pt,tt,()=>{Ce=!0,me()})),()=>{We?.()}}(Yt,Le,be,Et)))}},3093:(Hn,we,ft)=>{"use strict";ft.d(we,{Q:()=>vt});var M=ft(7103),mt=ft(9360),It=ft(8251);function vt(lt,ye=0){return(0,mt.e)((ke,ue)=>{ke.subscribe((0,It.x)(ue,be=>(0,M.f)(ue,lt,()=>ue.next(be),ye),()=>(0,M.f)(ue,lt,()=>ue.complete(),ye),be=>(0,M.f)(ue,lt,()=>ue.error(be),ye)))})}},3020:(Hn,we,ft)=>{"use strict";ft.d(we,{B:()=>lt});var M=ft(4829),mt=ft(8645),It=ft(305),vt=ft(9360);function lt(ke={}){const{connector:ue=(()=>new mt.x),resetOnError:be=!0,resetOnComplete:Pt=!0,resetOnRefCountZero:Et=!0}=ke;return Yt=>{let Le,re,tn,We=0,rn=!1,Te=!1;const Fn=()=>{re?.unsubscribe(),re=void 0},Ce=()=>{Fn(),Le=tn=void 0,rn=Te=!1},me=()=>{const tt=Le;Ce(),tt?.unsubscribe()};return(0,vt.e)((tt,Xt)=>{We++,!Te&&!rn&&Fn();const Ve=tn=tn??ue();Xt.add(()=>{We--,0===We&&!Te&&!rn&&(re=ye(me,Et))}),Ve.subscribe(Xt),!Le&&We>0&&(Le=new It.Hp({next:Gt=>Ve.next(Gt),error:Gt=>{Te=!0,Fn(),re=ye(Ce,be,Gt),Ve.error(Gt)},complete:()=>{rn=!0,Fn(),re=ye(Ce,Pt),Ve.complete()}}),(0,M.Xf)(tt).subscribe(Le))})(Yt)}}function ye(ke,ue,...be){if(!0===ue)return void ke();if(!1===ue)return;const Pt=new It.Hp({next:()=>{Pt.unsubscribe(),ke()}});return(0,M.Xf)(ue(...be)).subscribe(Pt)}},5137:(Hn,we,ft)=>{"use strict";ft.d(we,{R:()=>mt});var M=ft(9360);function mt(It,vt=0){return(0,M.e)((lt,ye)=>{ye.add(It.schedule(()=>lt.subscribe(ye),vt))})}},4664:(Hn,we,ft)=>{"use strict";ft.d(we,{w:()=>vt});var M=ft(4829),mt=ft(9360),It=ft(8251);function vt(lt,ye){return(0,mt.e)((ke,ue)=>{let be=null,Pt=0,Et=!1;const Yt=()=>Et&&!be&&ue.complete();ke.subscribe((0,It.x)(ue,Le=>{be?.unsubscribe();let re=0;const tn=Pt++;(0,M.Xf)(lt(Le,tn)).subscribe(be=(0,It.x)(ue,We=>ue.next(ye?ye(Le,We,tn,re++):We),()=>{be=null,Yt()}))},()=>{Et=!0,Yt()}))})}},9397:(Hn,we,ft)=>{"use strict";ft.d(we,{b:()=>lt});var M=ft(4674),mt=ft(9360),It=ft(8251),vt=ft(2737);function lt(ye,ke,ue){const be=(0,M.m)(ye)||ke||ue?{next:ye,error:ke,complete:ue}:ye;return be?(0,mt.e)((Pt,Et)=>{var Yt;null===(Yt=be.subscribe)||void 0===Yt||Yt.call(be);let Le=!0;Pt.subscribe((0,It.x)(Et,re=>{var tn;null===(tn=be.next)||void 0===tn||tn.call(be,re),Et.next(re)},()=>{var re;Le=!1,null===(re=be.complete)||void 0===re||re.call(be),Et.complete()},re=>{var tn;Le=!1,null===(tn=be.error)||void 0===tn||tn.call(be,re),Et.error(re)},()=>{var re,tn;Le&&(null===(re=be.unsubscribe)||void 0===re||re.call(be)),null===(tn=be.finalize)||void 0===tn||tn.call(be)}))}):vt.y}},4552:(Hn,we,ft)=>{"use strict";ft.d(we,{l:()=>M});const M={now:()=>(M.delegate||Date).now(),delegate:void 0}},7599:(Hn,we,ft)=>{"use strict";ft.d(we,{z:()=>M});const M={setTimeout(mt,It,...vt){const{delegate:lt}=M;return lt?.setTimeout?lt.setTimeout(mt,It,...vt):setTimeout(mt,It,...vt)},clearTimeout(mt){const{delegate:It}=M;return(It?.clearTimeout||clearTimeout)(mt)},delegate:void 0}},4971:(Hn,we,ft)=>{"use strict";ft.d(we,{h:()=>mt});const mt=function M(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(Hn,we,ft)=>{"use strict";ft.d(we,{L:()=>M});const M="function"==typeof Symbol&&Symbol.observable||"@@observable"},4564:(Hn,we,ft)=>{"use strict";ft.d(we,{_6:()=>ye,jO:()=>vt,yG:()=>lt});var M=ft(4674);function It(ke){return ke[ke.length-1]}function vt(ke){return(0,M.m)(It(ke))?ke.pop():void 0}function lt(ke){return function mt(ke){return ke&&(0,M.m)(ke.schedule)}(It(ke))?ke.pop():void 0}function ye(ke,ue){return"number"==typeof It(ke)?ke.pop():ue}},9039:(Hn,we,ft)=>{"use strict";function M(mt,It){if(mt){const vt=mt.indexOf(It);0<=vt&&mt.splice(vt,1)}}ft.d(we,{P:()=>M})},2306:(Hn,we,ft)=>{"use strict";function M(mt){const vt=mt(lt=>{Error.call(lt),lt.stack=(new Error).stack});return vt.prototype=Object.create(Error.prototype),vt.prototype.constructor=vt,vt}ft.d(we,{d:()=>M})},1441:(Hn,we,ft)=>{"use strict";ft.d(we,{O:()=>vt,x:()=>It});var M=ft(2653);let mt=null;function It(lt){if(M.config.useDeprecatedSynchronousErrorHandling){const ye=!mt;if(ye&&(mt={errorThrown:!1,error:null}),lt(),ye){const{errorThrown:ke,error:ue}=mt;if(mt=null,ke)throw ue}}else lt()}function vt(lt){M.config.useDeprecatedSynchronousErrorHandling&&mt&&(mt.errorThrown=!0,mt.error=lt)}},7103:(Hn,we,ft)=>{"use strict";function M(mt,It,vt,lt=0,ye=!1){const ke=It.schedule(function(){vt(),ye?mt.add(this.schedule(null,lt)):this.unsubscribe()},lt);if(mt.add(ke),!ye)return ke}ft.d(we,{f:()=>M})},2737:(Hn,we,ft)=>{"use strict";function M(mt){return mt}ft.d(we,{y:()=>M})},4266:(Hn,we,ft)=>{"use strict";ft.d(we,{z:()=>M});const M=mt=>mt&&"number"==typeof mt.length&&"function"!=typeof mt},5726:(Hn,we,ft)=>{"use strict";ft.d(we,{D:()=>mt});var M=ft(4674);function mt(It){return Symbol.asyncIterator&&(0,M.m)(It?.[Symbol.asyncIterator])}},4674:(Hn,we,ft)=>{"use strict";function M(mt){return"function"==typeof mt}ft.d(we,{m:()=>M})},8382:(Hn,we,ft)=>{"use strict";ft.d(we,{c:()=>It});var M=ft(4850),mt=ft(4674);function It(vt){return(0,mt.m)(vt[M.L])}},3664:(Hn,we,ft)=>{"use strict";ft.d(we,{T:()=>It});var M=ft(4971),mt=ft(4674);function It(vt){return(0,mt.m)(vt?.[M.h])}},4026:(Hn,we,ft)=>{"use strict";ft.d(we,{t:()=>mt});var M=ft(4674);function mt(It){return(0,M.m)(It?.then)}},541:(Hn,we,ft)=>{"use strict";ft.d(we,{L:()=>vt,Q:()=>It});var M=ft(7582),mt=ft(4674);function It(lt){return(0,M.FC)(this,arguments,function*(){const ke=lt.getReader();try{for(;;){const{value:ue,done:be}=yield(0,M.qq)(ke.read());if(be)return yield(0,M.qq)(void 0);yield yield(0,M.qq)(ue)}}finally{ke.releaseLock()}})}function vt(lt){return(0,mt.m)(lt?.getReader)}},9360:(Hn,we,ft)=>{"use strict";ft.d(we,{A:()=>mt,e:()=>It});var M=ft(4674);function mt(vt){return(0,M.m)(vt?.lift)}function It(vt){return lt=>{if(mt(lt))return lt.lift(function(ye){try{return vt(ye,this)}catch(ke){this.error(ke)}});throw new TypeError("Unable to lift unknown Observable type")}}},2420:(Hn,we,ft)=>{"use strict";function M(){}ft.d(we,{Z:()=>M})},8407:(Hn,we,ft)=>{"use strict";ft.d(we,{U:()=>It,z:()=>mt});var M=ft(2737);function mt(...vt){return It(vt)}function It(vt){return 0===vt.length?M.y:1===vt.length?vt[0]:function(ye){return vt.reduce((ke,ue)=>ue(ke),ye)}}},3894:(Hn,we,ft)=>{"use strict";ft.d(we,{h:()=>It});var M=ft(2653),mt=ft(7599);function It(vt){mt.z.setTimeout(()=>{const{onUnhandledError:lt}=M.config;if(!lt)throw vt;lt(vt)})}},9853:(Hn,we,ft)=>{"use strict";function M(mt){return new TypeError(`You provided ${null!==mt&&"object"==typeof mt?"an invalid object":`'${mt}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}ft.d(we,{z:()=>M})},8926:(Hn,we,ft)=>{"use strict";ft.d(we,{QbO:()=>TP,tb:()=>yM,AFp:()=>ef,ip1:()=>cM,hGG:()=>SM,z2F:()=>id,Ojb:()=>ex,sBO:()=>Nf,Sil:()=>Sm,EJc:()=>zS,Xts:()=>Qh,SBq:()=>Lg,lqb:()=>Ii,qLn:()=>Vu,vpe:()=>Ei,XFs:()=>yn,OlP:()=>er,zs3:()=>ac,ZZ4:()=>DO,aQg:()=>kO,soG:()=>uM,YKP:()=>Eb,h0i:()=>Kp,PXZ:()=>VS,R0b:()=>Wo,FiY:()=>ns,Lbi:()=>Ir,g9A:()=>hv,Qsj:()=>Rw,FYo:()=>yv,JOm:()=>yw,tp0:()=>jh,Rgc:()=>bm,dDg:()=>kf,eoX:()=>_M,q4F:()=>vv,GfV:()=>Ep,s_b:()=>hh,ifc:()=>Hi,VuI:()=>t,MMx:()=>_1,Lck:()=>ZT,eFA:()=>Kb,Gpc:()=>Fn,f3M:()=>or,X6Q:()=>Xb,$WT:()=>ho,MR2:()=>cv,_c5:()=>MI,qFp:()=>I,rg0:()=>gg,c2e:()=>mO,zSh:()=>Jh,HDt:()=>Oy,wAp:()=>Yc,vHH:()=>Gt,lri:()=>wO,rWj:()=>qb,cg1:()=>td,kL8:()=>ay,dqk:()=>Ar,Z0I:()=>Pe,eJc:()=>Em,QGY:()=>qv,F4k:()=>rm,RDi:()=>Mw,AaK:()=>We,qOj:()=>gf,Xq5:()=>co,TTD:()=>Oc,_Bn:()=>m1,jDz:()=>y1,xp6:()=>Rn,uIk:()=>mf,ekj:()=>fC,Suo:()=>F1,Xpm:()=>fd,lG2:()=>wc,Yz7:()=>nt,cJS:()=>Qt,oAB:()=>ki,Yjl:()=>Zs,Y36:()=>oi,_UZ:()=>Up,qZA:()=>fc,TgZ:()=>bf,EpF:()=>oE,n5z:()=>Uh,LFG:()=>ir,$8M:()=>Jl,$Z:()=>$P,NdJ:()=>Dl,CRH:()=>z1,oxw:()=>Vx,Q6J:()=>La,VKq:()=>Xp,iGM:()=>N1,MAs:()=>nm,KtG:()=>Od,Jf7:()=>zP,CHM:()=>_g,P3R:()=>Zn,YNc:()=>rC,W1O:()=>QC,_uU:()=>$p,Oqu:()=>am,hij:()=>Gn,AsE:()=>lm,Gf:()=>iO});var M=ft(8645),mt=ft(7394),It=ft(5592),vt=ft(3019),lt=ft(5619),ye=ft(2096),ke=ft(3020),ue=ft(4664),be=ft(2737),Pt=ft(9360),Et=ft(8251);function Le(l,u){return l===u}function re(l){for(let u in l)if(l[u]===re)return u;throw Error("Could not find renamed property on target object.")}function tn(l,u){for(const p in u)u.hasOwnProperty(p)&&!l.hasOwnProperty(p)&&(l[p]=u[p])}function We(l){if("string"==typeof l)return l;if(Array.isArray(l))return"["+l.map(We).join(", ")+"]";if(null==l)return""+l;if(l.overriddenName)return`${l.overriddenName}`;if(l.name)return`${l.name}`;const u=l.toString();if(null==u)return""+u;const p=u.indexOf("\n");return-1===p?u:u.substring(0,p)}function rn(l,u){return null==l||""===l?null===u?"":u:null==u||""===u?l:l+" "+u}const Te=re({__forward_ref__:re});function Fn(l){return l.__forward_ref__=Fn,l.toString=function(){return We(this())},l}function Ce(l){return me(l)?l():l}function me(l){return"function"==typeof l&&l.hasOwnProperty(Te)&&l.__forward_ref__===Fn}function tt(l){return l&&!!l.\u0275providers}const Ve="https://g.co/ng/security#xss";class Gt extends Error{constructor(u,p){super(function Ct(l,u){return`NG0${Math.abs(l)}${u?": "+u:""}`}(u,p)),this.code=u}}function ge(l){return"string"==typeof l?l:null==l?"":String(l)}function us(l,u){throw new Gt(-201,!1)}function Tn(l,u){null==l&&function pn(l,u,p,m){throw new Error(`ASSERTION ERROR: ${l}`+(null==m?"":` [Expected=> ${p} ${m} ${u} <=Actual]`))}(u,l,null,"!=")}function nt(l){return{token:l.token,providedIn:l.providedIn||null,factory:l.factory,value:void 0}}function Qt(l){return{providers:l.providers||[],imports:l.imports||[]}}function oe(l){return Ge(l,Ze)||Ge(l,gn)}function Pe(l){return null!==oe(l)}function Ge(l,u){return l.hasOwnProperty(u)?l[u]:null}function Xe(l){return l&&(l.hasOwnProperty(Ie)||l.hasOwnProperty(ur))?l[Ie]:null}const Ze=re({\u0275prov:re}),Ie=re({\u0275inj:re}),gn=re({ngInjectableDef:re}),ur=re({ngInjectorDef:re});var yn=function(l){return l[l.Default=0]="Default",l[l.Host=1]="Host",l[l.Self=2]="Self",l[l.SkipSelf=4]="SkipSelf",l[l.Optional=8]="Optional",l}(yn||{});let Fr;function Sn(l){const u=Fr;return Fr=l,u}function Vi(l,u,p){const m=oe(l);return m&&"root"==m.providedIn?void 0===m.value?m.value=m.factory():m.value:p&yn.Optional?null:void 0!==u?u:void us(We(l))}const Ar=globalThis;class er{constructor(u,p){this._desc=u,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof p?this.__NG_ELEMENT_ID__=p:void 0!==p&&(this.\u0275prov=nt({token:this,providedIn:p.providedIn||"root",factory:p.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const at={},ht="__NG_DI_FLAG__",Bt="ngTempTokenPath",ee=/\n/gm,Nn="__source";let yr;function Qr(l){const u=yr;return yr=l,u}function Pr(l,u=yn.Default){if(void 0===yr)throw new Gt(-203,!1);return null===yr?Vi(l,void 0,u):yr.get(l,u&yn.Optional?null:void 0,u)}function ir(l,u=yn.Default){return(function Xr(){return Fr}()||Pr)(Ce(l),u)}function or(l,u=yn.Default){return ir(l,qs(u))}function qs(l){return typeof l>"u"||"number"==typeof l?l:0|(l.optional&&8)|(l.host&&1)|(l.self&&2)|(l.skipSelf&&4)}function ne(l){const u=[];for(let p=0;p<l.length;p++){const m=Ce(l[p]);if(Array.isArray(m)){if(0===m.length)throw new Gt(900,!1);let v,C=yn.Default;for(let E=0;E<m.length;E++){const T=m[E],k=Re(T);"number"==typeof k?-1===k?v=T.token:C|=k:v=T}u.push(ir(v,C))}else u.push(ir(m))}return u}function Vt(l,u){return l[ht]=u,l.prototype[ht]=u,l}function Re(l){return l[ht]}function sr(l){return{toString:l}.toString()}var ai=function(l){return l[l.OnPush=0]="OnPush",l[l.Default=1]="Default",l}(ai||{}),Hi=function(l){return l[l.Emulated=0]="Emulated",l[l.None=2]="None",l[l.ShadowDom=3]="ShadowDom",l}(Hi||{});const Ti={},zr=[],pl=re({\u0275cmp:re}),gl=re({\u0275dir:re}),mh=re({\u0275pipe:re}),cd=re({\u0275mod:re}),bs=re({\u0275fac:re}),Ba=re({__NG_ELEMENT_ID__:re}),ag=re({__NG_ENV_ID__:re});function ml(l,u,p){let m=l.length;for(;;){const v=l.indexOf(u,p);if(-1===v)return v;if(0===v||l.charCodeAt(v-1)<=32){const C=u.length;if(v+C===m||l.charCodeAt(v+C)<=32)return v}p=v+1}}function qi(l,u,p){let m=0;for(;m<p.length;){const v=p[m];if("number"==typeof v){if(0!==v)break;m++;const C=p[m++],E=p[m++],T=p[m++];l.setAttribute(u,E,T,C)}else{const C=v,E=p[++m];Ua(C)?l.setProperty(u,C,E):l.setAttribute(u,C,E),m++}}return m}function lg(l){return 3===l||4===l||6===l}function Ua(l){return 64===l.charCodeAt(0)}function ud(l,u){if(null!==u&&0!==u.length)if(null===l||0===l.length)l=u.slice();else{let p=-1;for(let m=0;m<u.length;m++){const v=u[m];"number"==typeof v?p=v:0===p||dd(l,p,v,null,-1===p||2===p?u[++m]:null)}}return l}function dd(l,u,p,m,v){let C=0,E=l.length;if(-1===u)E=-1;else for(;C<l.length;){const T=l[C++];if("number"==typeof T){if(T===u){E=-1;break}if(T>u){E=C-1;break}}}for(;C<l.length;){const T=l[C];if("number"==typeof T)break;if(T===p){if(null===m)return void(null!==v&&(l[C+1]=v));if(m===l[C+1])return void(l[C+2]=v)}C++,null!==m&&C++,null!==v&&C++}-1!==E&&(l.splice(E,0,u),C=E+1),l.splice(C++,0,p),null!==m&&l.splice(C++,0,m),null!==v&&l.splice(C++,0,v)}const Va="ng-template";function hd(l,u,p){let m=0,v=!0;for(;m<l.length;){let C=l[m++];if("string"==typeof C&&v){const E=l[m++];if(p&&"class"===C&&-1!==ml(E.toLowerCase(),u,0))return!0}else{if(1===C){for(;m<l.length&&"string"==typeof(C=l[m++]);)if(C.toLowerCase()===u)return!0;return!1}"number"==typeof C&&(v=!1)}}return!1}function Mn(l){return 4===l.type&&l.value!==Va}function ei(l,u,p){return u===(4!==l.type||p?l.value:Va)}function ia(l,u,p){let m=4;const v=l.attrs||[],C=function Hy(l){for(let u=0;u<l.length;u++)if(lg(l[u]))return u;return l.length}(v);let E=!1;for(let T=0;T<u.length;T++){const k=u[T];if("number"!=typeof k){if(!E)if(4&m){if(m=2|1&m,""!==k&&!ei(l,k,p)||""===k&&1===u.length){if(Ho(m))return!1;E=!0}}else{const N=8&m?k:u[++T];if(8&m&&null!==l.attrs){if(!hd(l.attrs,N,p)){if(Ho(m))return!1;E=!0}continue}const $=su(8&m?"class":k,v,Mn(l),p);if(-1===$){if(Ho(m))return!1;E=!0;continue}if(""!==N){let q;q=$>C?"":v[$+1].toLowerCase();const Z=8&m?q:null;if(Z&&-1!==ml(Z,N,0)||2&m&&N!==q){if(Ho(m))return!1;E=!0}}}}else{if(!E&&!Ho(m)&&!Ho(k))return!1;if(E&&Ho(k))continue;E=!1,m=k|1&m}}return Ho(m)||E}function Ho(l){return 0==(1&l)}function su(l,u,p,m){if(null===u)return-1;let v=0;if(m||!p){let C=!1;for(;v<u.length;){const E=u[v];if(E===l)return v;if(3===E||6===E)C=!0;else{if(1===E||2===E){let T=u[++v];for(;"string"==typeof T;)T=u[++v];continue}if(4===E)break;if(0===E){v+=4;continue}}v+=C?1:2}return-1}return function xs(l,u){let p=l.indexOf(4);if(p>-1)for(p++;p<l.length;){const m=l[p];if("number"==typeof m)return-1;if(m===u)return p;p++}return-1}(u,l)}function au(l,u,p=!1){for(let m=0;m<u.length;m++)if(ia(l,u[m],p))return!0;return!1}function vo(l,u){return l?":not("+u.trim()+")":u}function lu(l){let u=l[0],p=1,m=2,v="",C=!1;for(;p<l.length;){let E=l[p];if("string"==typeof E)if(2&m){const T=l[++p];v+="["+E+(T.length>0?'="'+T+'"':"")+"]"}else 8&m?v+="."+E:4&m&&(v+=" "+E);else""!==v&&!Ho(E)&&(u+=vo(C,v),v=""),m=E,C=C||!Ho(m);p++}return""!==v&&(u+=vo(C,v)),u}function fd(l){return sr(()=>{const u=Vm(l),p={...u,decls:l.decls,vars:l.vars,template:l.template,consts:l.consts||null,ngContentSelectors:l.ngContentSelectors,onPush:l.changeDetection===ai.OnPush,directiveDefs:null,pipeDefs:null,dependencies:u.standalone&&l.dependencies||null,getStandaloneInjector:null,signals:l.signals??!1,data:l.data||{},encapsulation:l.encapsulation||Hi.Emulated,styles:l.styles||zr,_:null,schemas:l.schemas||null,tView:null,id:""};ws(p);const m=l.dependencies;return p.directiveDefs=Ae(m,!1),p.pipeDefs=Ae(m,!0),p.id=function Tr(l){let u=0;const p=[l.selectors,l.ngContentSelectors,l.hostVars,l.hostAttrs,l.consts,l.vars,l.decls,l.encapsulation,l.standalone,l.signals,l.exportAs,JSON.stringify(l.inputs),JSON.stringify(l.outputs),Object.getOwnPropertyNames(l.type.prototype),!!l.contentQueries,!!l.viewQuery].join("|");for(const v of p)u=Math.imul(31,u)+v.charCodeAt(0)<<0;return u+=2147483648,"c"+u}(p),p})}function de(l){return Wn(l)||$i(l)}function Cn(l){return null!==l}function ki(l){return sr(()=>({type:l.type,bootstrap:l.bootstrap||zr,declarations:l.declarations||zr,imports:l.imports||zr,exports:l.exports||zr,transitiveCompileScopes:null,schemas:l.schemas||null,id:l.id||null}))}function Fe(l,u){if(null==l)return Ti;const p={};for(const m in l)if(l.hasOwnProperty(m)){let v=l[m],C=v;Array.isArray(v)&&(C=v[1],v=v[0]),p[v]=m,u&&(u[v]=C)}return p}function wc(l){return sr(()=>{const u=Vm(l);return ws(u),u})}function Zs(l){return{type:l.type,name:l.name,factory:null,pure:!1!==l.pure,standalone:!0===l.standalone,onDestroy:l.type.prototype.ngOnDestroy||null}}function Wn(l){return l[pl]||null}function $i(l){return l[gl]||null}function Yo(l){return l[mh]||null}function ho(l){const u=Wn(l)||$i(l)||Yo(l);return null!==u&&u.standalone}function Do(l,u){const p=l[cd]||null;if(!p&&!0===u)throw new Error(`Type ${We(l)} does not have '\u0275mod' property.`);return p}function Vm(l){const u={};return{type:l.type,providersResolver:null,factory:null,hostBindings:l.hostBindings||null,hostVars:l.hostVars||0,hostAttrs:l.hostAttrs||null,contentQueries:l.contentQueries||null,declaredInputs:u,inputTransforms:null,inputConfig:l.inputs||Ti,exportAs:l.exportAs||null,standalone:!0===l.standalone,signals:!0===l.signals,selectors:l.selectors||zr,viewQuery:l.viewQuery||null,features:l.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Fe(l.inputs,u),outputs:Fe(l.outputs)}}function ws(l){l.features?.forEach(u=>u(l))}function Ae(l,u){if(!l)return null;const p=u?Yo:de;return()=>("function"==typeof l?l():l).map(m=>p(m)).filter(Cn)}const Jr=0,dn=1,Ye=2,Ai=3,Cs=4,ja=5,Zr=6,ni=7,ko=8,Xo=9,pd=10,ar=11,Ws=12,Cc=13,ba=14,Zi=15,cu=16,$a=17,fo=18,bn=19,Hf=20,oa=21,po=22,Ro=23,sa=24,Yn=25,zl=1,gd=2,Ms=7,Bl=9,Fi=11;function bo(l){return Array.isArray(l)&&"object"==typeof l[zl]}function Un(l){return Array.isArray(l)&&!0===l[zl]}function du(l){return 0!=(4&l.flags)}function _l(l){return l.componentOffset>-1}function Ga(l){return 1==(1&l.flags)}function la(l){return!!l.template}function hu(l){return 0!=(512&l[Ye])}function Ul(l,u){return l.hasOwnProperty(bs)?l[bs]:null}let qo=null,_d=!1;function Qo(l){const u=qo;return qo=l,u}const Ch={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function Lo(l){if(!Gl(l)||l.dirty){if(!l.producerMustRecompute(l)&&!Pc(l))return void(l.dirty=!1);l.producerRecomputeValue(l),l.dirty=!1}}function Gm(l){l.dirty=!0,function hg(l){if(void 0===l.liveConsumerNode)return;const u=_d;_d=!0;try{for(const p of l.liveConsumerNode)p.dirty||Gm(p)}finally{_d=u}}(l),l.consumerMarkedDirty?.(l)}function Vl(l){return l&&(l.nextProducerIndex=0),Qo(l)}function qa(l,u){if(Qo(u),l&&void 0!==l.producerNode&&void 0!==l.producerIndexOfThis&&void 0!==l.producerLastReadVersion){if(Gl(l))for(let p=l.nextProducerIndex;p<l.producerNode.length;p++)Za(l.producerNode[p],l.producerIndexOfThis[p]);for(;l.producerNode.length>l.nextProducerIndex;)l.producerNode.pop(),l.producerLastReadVersion.pop(),l.producerIndexOfThis.pop()}}function Pc(l){Mh(l);for(let u=0;u<l.producerNode.length;u++){const p=l.producerNode[u],m=l.producerLastReadVersion[u];if(m!==p.version||(Lo(p),m!==p.version))return!0}return!1}function jl(l){if(Mh(l),Gl(l))for(let u=0;u<l.producerNode.length;u++)Za(l.producerNode[u],l.producerIndexOfThis[u]);l.producerNode.length=l.producerLastReadVersion.length=l.producerIndexOfThis.length=0,l.liveConsumerNode&&(l.liveConsumerNode.length=l.liveConsumerIndexOfThis.length=0)}function Za(l,u){if(function Wf(l){l.liveConsumerNode??=[],l.liveConsumerIndexOfThis??=[]}(l),Mh(l),1===l.liveConsumerNode.length)for(let m=0;m<l.producerNode.length;m++)Za(l.producerNode[m],l.producerIndexOfThis[m]);const p=l.liveConsumerNode.length-1;if(l.liveConsumerNode[u]=l.liveConsumerNode[p],l.liveConsumerIndexOfThis[u]=l.liveConsumerIndexOfThis[p],l.liveConsumerNode.length--,l.liveConsumerIndexOfThis.length--,u<l.liveConsumerNode.length){const m=l.liveConsumerIndexOfThis[u],v=l.liveConsumerNode[u];Mh(v),v.producerIndexOfThis[m]=u}}function Gl(l){return l.consumerIsAlwaysLive||(l?.liveConsumerNode?.length??0)>0}function Mh(l){l.producerNode??=[],l.producerIndexOfThis??=[],l.producerLastReadVersion??=[]}let Eh=null;function gg(l){const u=Qo(null);try{return l()}finally{Qo(u)}}const mu=()=>{},Ih=(()=>({...Ch,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:l=>{l.schedule(l.ref)},hasRun:!1,cleanupFn:mu}))();class wd{constructor(u,p,m){this.previousValue=u,this.currentValue=p,this.firstChange=m}isFirstChange(){return this.firstChange}}function Oc(){return Cd}function Cd(l){return l.type.prototype.ngOnChanges&&(l.setInput=Ym),Sh}function Sh(){const l=mg(this),u=l?.current;if(u){const p=l.previous;if(p===Ti)l.previous=u;else for(let m in u)p[m]=u[m];l.current=null,this.ngOnChanges(u)}}function Ym(l,u,p,m){const v=this.declaredInputs[p],C=mg(l)||function Md(l,u){return l[vn]=u}(l,{previous:Ti,current:null}),E=C.current||(C.current={}),T=C.previous,k=T[v];E[v]=new wd(k&&k.currentValue,u,T===Ti),l[m]=u}Oc.ngInherit=!0;const vn="__ngSimpleChanges__";function mg(l){return l[vn]||null}const hs=function(l,u,p){};function zi(l){for(;Array.isArray(l);)l=l[Jr];return l}function _u(l,u){return zi(u[l])}function Jo(l,u){return zi(u[l.index])}function yu(l,u){return l.data[u]}function ua(l,u){const p=u[l];return bo(p)?p:p[Jr]}function Es(l,u){return null==u?null:l[u]}function Jf(l){l[$a]=0}function tp(l){1024&l[Ye]||(l[Ye]|=1024,Wa(l,1))}function Pd(l){1024&l[Ye]&&(l[Ye]&=-1025,Wa(l,-1))}function Wa(l,u){let p=l[Ai];if(null===p)return;p[ja]+=u;let m=p;for(p=p[Ai];null!==p&&(1===u&&1===m[ja]||-1===u&&0===m[ja]);)p[ja]+=u,m=p,p=p[Ai]}const lr={lFrame:xl(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Ed(){return lr.bindingsEnabled}function Me(){return lr.lFrame.lView}function ri(){return lr.lFrame.tView}function _g(l){return lr.lFrame.contextLView=l,l[ko]}function Od(l){return lr.lFrame.contextLView=null,l}function fs(){let l=t_();for(;null!==l&&64===l.type;)l=l.parent;return l}function t_(){return lr.lFrame.currentTNode}function Ka(l,u){const p=lr.lFrame;p.currentTNode=l,p.isParent=u}function kh(){return lr.lFrame.isParent}function Id(){return lr.lFrame.bindingIndex++}function Ca(l){const u=lr.lFrame,p=u.bindingIndex;return u.bindingIndex=u.bindingIndex+l,p}function Ky(l,u){const p=lr.lFrame;p.bindingIndex=p.bindingRootIndex=l,Dc(u)}function Dc(l){lr.lFrame.currentDirectiveIndex=l}function Wr(){return lr.lFrame.currentQueryIndex}function da(l){lr.lFrame.currentQueryIndex=l}function Ns(l){const u=l[dn];return 2===u.type?u.declTNode:1===u.type?l[Zr]:null}function Cu(l,u,p){if(p&yn.SkipSelf){let v=u,C=l;for(;!(v=v.parent,null!==v||p&yn.Host||(v=Ns(C),null===v||(C=C[ba],10&v.type))););if(null===v)return!1;u=v,l=C}const m=lr.lFrame=Rc();return m.currentTNode=u,m.lView=l,!0}function kc(l){const u=Rc(),p=l[dn];lr.lFrame=u,u.currentTNode=p.firstChild,u.lView=l,u.tView=p,u.contextLView=l,u.bindingIndex=p.bindingStartIndex,u.inI18n=!1}function Rc(){const l=lr.lFrame,u=null===l?null:l.child;return null===u?xl(l):u}function xl(l){const u={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:l,child:null,inI18n:!1};return null!==l&&(l.child=u),u}function n_(){const l=lr.lFrame;return lr.lFrame=l.parent,l.currentTNode=null,l.lView=null,l}const Mu=n_;function Pu(){const l=n_();l.isParent=!0,l.tView=null,l.selectedIndex=-1,l.contextLView=null,l.elementDepthCount=0,l.currentDirectiveIndex=-1,l.currentNamespace=null,l.bindingRootIndex=-1,l.bindingIndex=-1,l.currentQueryIndex=0}function ro(){return lr.lFrame.selectedIndex}function Eu(l){lr.lFrame.selectedIndex=l}function Yi(){const l=lr.lFrame;return yu(l.tView,l.selectedIndex)}let ts=!0;function Pa(){return ts}function $r(l){ts=l}function Yl(l,u){for(let p=u.directiveStart,m=u.directiveEnd;p<m;p++){const C=l.data[p].type.prototype,{ngAfterContentInit:E,ngAfterContentChecked:T,ngAfterViewInit:k,ngAfterViewChecked:N,ngOnDestroy:F}=C;E&&(l.contentHooks??=[]).push(-p,E),T&&((l.contentHooks??=[]).push(p,T),(l.contentCheckHooks??=[]).push(p,T)),k&&(l.viewHooks??=[]).push(-p,k),N&&((l.viewHooks??=[]).push(p,N),(l.viewCheckHooks??=[]).push(p,N)),null!=F&&(l.destroyHooks??=[]).push(p,F)}}function Sd(l,u,p){sp(l,u,3,p)}function Ts(l,u,p,m){(3&l[Ye])===p&&sp(l,u,p,m)}function io(l,u){let p=l[Ye];(3&p)===u&&(p&=8191,p+=1,l[Ye]=p)}function sp(l,u,p,m){const C=m??-1,E=u.length-1;let T=0;for(let k=void 0!==m?65535&l[$a]:0;k<E;k++)if("number"==typeof u[k+1]){if(T=u[k],null!=m&&T>=m)break}else u[k]<0&&(l[$a]+=65536),(T<C||-1==C)&&(Ou(l,p,u,k),l[$a]=(4294901760&l[$a])+k+2),k++}function Ya(l,u){hs(4,l,u);const p=Qo(null);try{u.call(l)}finally{Qo(p),hs(5,l,u)}}function Ou(l,u,p,m){const v=p[m]<0,C=p[m+1],T=l[v?-p[m]:p[m]];v?l[Ye]>>13<l[$a]>>16&&(3&l[Ye])===u&&(l[Ye]+=8192,Ya(T,C)):Ya(T,C)}const Lc=-1;class Lh{constructor(u,p,m){this.factory=u,this.resolving=!1,this.canSeeViewProviders=p,this.injectImpl=m}}function ha(l){return l!==Lc}function Xl(l){return 32767&l}function Xa(l,u){let p=function Dd(l){return l>>16}(l),m=u;for(;p>0;)m=m[ba],p--;return m}let kd=!0;function Qa(l){const u=kd;return kd=l,u}const wl=255,cp=5;let Cg=0;const Ys={};function Cl(l,u){const p=up(l,u);if(-1!==p)return p;const m=u[dn];m.firstCreatePass&&(l.injectorIndex=u.length,Rd(m.data,l),Rd(u,null),Rd(m.blueprint,null));const v=Tu(l,u),C=l.injectorIndex;if(ha(v)){const E=Xl(v),T=Xa(v,u),k=T[dn].data;for(let N=0;N<8;N++)u[C+N]=T[E+N]|k[E+N]}return u[C+8]=v,C}function Rd(l,u){l.push(0,0,0,0,0,0,0,0,u)}function up(l,u){return-1===l.injectorIndex||l.parent&&l.parent.injectorIndex===l.injectorIndex||null===u[l.injectorIndex+8]?-1:l.injectorIndex}function Tu(l,u){if(l.parent&&-1!==l.parent.injectorIndex)return l.parent.injectorIndex;let p=0,m=null,v=u;for(;null!==v;){if(m=Fo(v),null===m)return Lc;if(p++,v=v[ba],-1!==m.injectorIndex)return m.injectorIndex|p<<16}return Lc}function Ld(l,u,p){!function Mg(l,u,p){let m;"string"==typeof p?m=p.charCodeAt(0)||0:p.hasOwnProperty(Ba)&&(m=p[Ba]),null==m&&(m=p[Ba]=Cg++);const v=m&wl;u.data[l+(v>>cp)]|=1<<v}(l,u,p)}function zh(l,u,p){if(p&yn.Optional||void 0!==l)return l;us()}function Iu(l,u,p,m){if(p&yn.Optional&&void 0===m&&(m=null),!(p&(yn.Self|yn.Host))){const v=l[Xo],C=Sn(void 0);try{return v?v.get(u,m,p&yn.Optional):Vi(u,m,p&yn.Optional)}finally{Sn(C)}}return zh(m,0,p)}function Ea(l,u,p,m=yn.Default,v){if(null!==l){if(2048&u[Ye]&&!(m&yn.Self)){const E=function Ml(l,u,p,m,v){let C=l,E=u;for(;null!==C&&null!==E&&2048&E[Ye]&&!(512&E[Ye]);){const T=Nd(C,E,p,m|yn.Self,Ys);if(T!==Ys)return T;let k=C.parent;if(!k){const N=E[Hf];if(N){const F=N.get(p,Ys,m);if(F!==Ys)return F}k=Fo(E),E=E[ba]}C=k}return v}(l,u,p,m,Ys);if(E!==Ys)return E}const C=Nd(l,u,p,m,Ys);if(C!==Ys)return C}return Iu(u,p,m,v)}function Nd(l,u,p,m,v){const C=function Bh(l){if("string"==typeof l)return l.charCodeAt(0)||0;const u=l.hasOwnProperty(Ba)?l[Ba]:void 0;return"number"==typeof u?u>=0?u&wl:fa:u}(p);if("function"==typeof C){if(!Cu(u,l,m))return m&yn.Host?zh(v,0,m):Iu(u,p,m,v);try{let E;if(E=C(m),null!=E||m&yn.Optional)return E;us()}finally{Mu()}}else if("number"==typeof C){let E=null,T=up(l,u),k=Lc,N=m&yn.Host?u[Zi][Zr]:null;for((-1===T||m&yn.SkipSelf)&&(k=-1===T?Tu(l,u):u[T+8],k!==Lc&&hp(m,!1)?(E=u[dn],T=Xl(k),u=Xa(k,u)):T=-1);-1!==T;){const F=u[dn];if(Pg(C,T,F.data)){const $=dp(T,u,p,E,m,N);if($!==Ys)return $}k=u[T+8],k!==Lc&&hp(m,u[dn].data[T+8]===N)&&Pg(C,T,u)?(E=F,T=Xl(k),u=Xa(k,u)):T=-1}}return v}function dp(l,u,p,m,v,C){const E=u[dn],T=E.data[l+8],F=Ja(T,E,p,null==m?_l(T)&&kd:m!=E&&0!=(3&T.type),v&yn.Host&&C===T);return null!==F?Fd(u,E,F,T):Ys}function Ja(l,u,p,m,v){const C=l.providerIndexes,E=u.data,T=1048575&C,k=l.directiveStart,F=C>>20,q=v?T+F:l.directiveEnd;for(let Z=m?T:T+F;Z<q;Z++){const X=E[Z];if(Z<k&&p===X||Z>=k&&X.type===p)return Z}if(v){const Z=E[k];if(Z&&la(Z)&&Z.type===p)return k}return null}function Fd(l,u,p,m){let v=l[p];const C=u.data;if(function Ad(l){return l instanceof Lh}(v)){const E=v;E.resolving&&function Ui(l,u){const p=u?`. Dependency path: ${u.join(" > ")} > ${l}`:"";throw new Gt(-200,`Circular dependency in DI detected for ${l}${p}`)}(function en(l){return"function"==typeof l?l.name||l.toString():"object"==typeof l&&null!=l&&"function"==typeof l.type?l.type.name||l.type.toString():ge(l)}(C[p]));const T=Qa(E.canSeeViewProviders);E.resolving=!0;const N=E.injectImpl?Sn(E.injectImpl):null;Cu(l,m,yn.Default);try{v=l[p]=E.factory(void 0,C,l,m),u.firstCreatePass&&p>=m.directiveStart&&function Kl(l,u,p){const{ngOnChanges:m,ngOnInit:v,ngDoCheck:C}=u.type.prototype;if(m){const E=Cd(u);(p.preOrderHooks??=[]).push(l,E),(p.preOrderCheckHooks??=[]).push(l,E)}v&&(p.preOrderHooks??=[]).push(0-l,v),C&&((p.preOrderHooks??=[]).push(l,C),(p.preOrderCheckHooks??=[]).push(l,C))}(p,C[p],u)}finally{null!==N&&Sn(N),Qa(T),E.resolving=!1,Mu()}}return v}function Pg(l,u,p){return!!(p[u+(l>>cp)]&1<<l)}function hp(l,u){return!(l&yn.Self||l&yn.Host&&u)}class es{constructor(u,p){this._tNode=u,this._lView=p}get(u,p,m){return Ea(this._tNode,this._lView,u,qs(m),p)}}function fa(){return new es(fs(),Me())}function Uh(l){return sr(()=>{const u=l.prototype.constructor,p=u[bs]||Ql(u),m=Object.prototype;let v=Object.getPrototypeOf(l.prototype).constructor;for(;v&&v!==m;){const C=v[bs]||Ql(v);if(C&&C!==p)return C;v=Object.getPrototypeOf(v)}return C=>new C})}function Ql(l){return me(l)?()=>{const u=Ql(Ce(l));return u&&u()}:Ul(l)}function Fo(l){const u=l[dn],p=u.type;return 2===p?u.declTNode:1===p?l[Zr]:null}function Jl(l){return function wo(l,u){if("class"===u)return l.classes;if("style"===u)return l.styles;const p=l.attrs;if(p){const m=p.length;let v=0;for(;v<m;){const C=p[v];if(lg(C))break;if(0===C)v+=2;else if("number"==typeof C)for(v++;v<m&&"string"==typeof p[v];)v++;else{if(C===u)return p[v+1];v+=2}}}return null}(fs(),l)}const De="__parameters__";function U(l,u,p){return sr(()=>{const m=function nc(l){return function(...p){if(l){const m=l(...p);for(const v in m)this[v]=m[v]}}}(u);function v(...C){if(this instanceof v)return m.apply(this,C),this;const E=new v(...C);return T.annotation=E,T;function T(k,N,F){const $=k.hasOwnProperty(De)?k[De]:Object.defineProperty(k,De,{value:[]})[De];for(;$.length<=F;)$.push(null);return($[F]=$[F]||[]).push(E),k}}return p&&(v.prototype=Object.create(p.prototype)),v.prototype.ngMetadataName=l,v.annotationCls=v,v})}function Zo(l,u){l.forEach(p=>Array.isArray(p)?Zo(p,u):u(p))}function Ta(l,u,p){u>=l.length?l.push(p):l.splice(u,0,p)}function Au(l,u){return u>=l.length-1?l.pop():l.splice(u,1)[0]}function Xs(l,u,p){let m=z(l,u);return m>=0?l[1|m]=p:(m=~m,function Eg(l,u,p,m){let v=l.length;if(v==u)l.push(p,m);else if(1===v)l.push(m,l[0]),l[0]=p;else{for(v--,l.push(l[v-1],l[v]);v>u;)l[v]=l[v-2],v--;l[u]=p,l[u+1]=m}}(l,m,u,p)),m}function s_(l,u){const p=z(l,u);if(p>=0)return l[1|p]}function z(l,u){return function R(l,u,p){let m=0,v=l.length>>p;for(;v!==m;){const C=m+(v-m>>1),E=l[C<<p];if(u===E)return C<<p;E>u?v=C:m=C+1}return~(v<<p)}(l,u,1)}const ns=Vt(U("Optional"),8),jh=Vt(U("SkipSelf"),4);function x0(l){return 128==(128&l.flags)}var yw=function(l){return l[l.Important=1]="Important",l[l.DashCase=2]="DashCase",l}(yw||{});const uP=new Map;let vw=0;const C0="__ngContext__";function Qs(l,u){bo(u)?(l[C0]=u[bn],function OS(l){uP.set(l[bn],l)}(u)):l[C0]=u}let pP;function M0(l,u){return pP(l,u)}function Hh(l){const u=l[Ai];return Un(u)?u[Ai]:u}function Pl(l){return Ru(l[Ws])}function pr(l){return Ru(l[Cs])}function Ru(l){for(;null!==l&&!Un(l);)l=l[Cs];return l}function ga(l,u,p,m,v){if(null!=m){let C,E=!1;Un(m)?C=m:bo(m)&&(E=!0,m=m[Jr]);const T=zi(m);0===l&&null!==p?null==v?T0(u,p,T):fi(u,p,T,v||null,!0):1===l&&null!==p?fi(u,p,T,v||null,!0):2===l?function Wh(l,u,p){const m=Ig(l,u);m&&function Tg(l,u,p,m){l.removeChild(u,p,m)}(l,m,u,p)}(u,T,E):3===l&&u.destroyNode(T),null!=C&&function A0(l,u,p,m,v){const C=p[Ms];C!==zi(p)&&ga(u,l,m,C,v);for(let T=Fi;T<p.length;T++){const k=p[T];m_(k[dn],k,l,u,m,C)}}(u,l,C,p,v)}}function O0(l,u,p){return l.createElement(u,p)}function xw(l,u){const p=l[Bl],m=p.indexOf(u);Pd(u),p.splice(m,1)}function f_(l,u){if(l.length<=Fi)return;const p=Fi+u,m=l[p];if(m){const v=m[cu];null!==v&&v!==l&&xw(v,m),u>0&&(l[p-1][Cs]=m[Cs]);const C=Au(l,Fi+u);!function mP(l,u){m_(l,u,u[ar],2,null,null),u[Jr]=null,u[Zr]=null}(m[dn],m);const E=C[fo];null!==E&&E.detachView(C[dn]),m[Ai]=null,m[Cs]=null,m[Ye]&=-129}return m}function Di(l,u){if(!(256&u[Ye])){const p=u[ar];u[Ro]&&jl(u[Ro]),u[sa]&&jl(u[sa]),p.destroyNode&&m_(l,u,p,3,null,null),function ci(l){let u=l[Ws];if(!u)return Is(l[dn],l);for(;u;){let p=null;if(bo(u))p=u[Ws];else{const m=u[Fi];m&&(p=m)}if(!p){for(;u&&!u[Cs]&&u!==l;)bo(u)&&Is(u[dn],u),u=u[Ai];null===u&&(u=l),bo(u)&&Is(u[dn],u),p=u&&u[Cs]}u=p}}(u)}}function Is(l,u){if(!(256&u[Ye])){u[Ye]&=-129,u[Ye]|=256,function p_(l,u){let p;if(null!=l&&null!=(p=l.destroyHooks))for(let m=0;m<p.length;m+=2){const v=u[p[m]];if(!(v instanceof Lh)){const C=p[m+1];if(Array.isArray(C))for(let E=0;E<C.length;E+=2){const T=v[C[E]],k=C[E+1];hs(4,T,k);try{k.call(T)}finally{hs(5,T,k)}}else{hs(4,v,C);try{C.call(v)}finally{hs(5,v,C)}}}}}(l,u),function pp(l,u){const p=l.cleanup,m=u[ni];if(null!==p)for(let C=0;C<p.length-1;C+=2)if("string"==typeof p[C]){const E=p[C+3];E>=0?m[E]():m[-E].unsubscribe(),C+=2}else p[C].call(m[p[C+1]]);null!==m&&(u[ni]=null);const v=u[oa];if(null!==v){u[oa]=null;for(let C=0;C<v.length;C++)(0,v[C])()}}(l,u),1===u[dn].type&&u[ar].destroy();const p=u[cu];if(null!==p&&Un(u[Ai])){p!==u[Ai]&&xw(p,u);const m=u[fo];null!==m&&m.detachView(l)}!function bT(l){uP.delete(l[bn])}(u)}}function Og(l,u,p){return function zc(l,u,p){let m=u;for(;null!==m&&40&m.type;)m=(u=m).parent;if(null===m)return p[Jr];{const{componentOffset:v}=m;if(v>-1){const{encapsulation:C}=l.data[m.directiveStart+v];if(C===Hi.None||C===Hi.Emulated)return null}return Jo(m,p)}}(l,u.parent,p)}function fi(l,u,p,m,v){l.insertBefore(u,p,m,v)}function T0(l,u,p){l.appendChild(u,p)}function Lu(l,u,p,m,v){null!==m?fi(l,u,p,m,v):T0(l,u,p)}function Ig(l,u){return l.parentNode(u)}let g_,R0,El,ev=function rl(l,u,p){return 40&l.type?Jo(l,p):null};function Bn(l,u,p,m){const v=Og(l,m,u),C=u[ar],T=function I0(l,u,p){return ev(l,u,p)}(m.parent||u[Zr],m,u);if(null!=v)if(Array.isArray(p))for(let k=0;k<p.length;k++)Lu(C,v,p[k],T,!1);else Lu(C,v,p,T,!1);void 0!==g_&&g_(C,m,u,p,v)}function Zh(l,u){if(null!==u){const p=u.type;if(3&p)return Jo(u,l);if(4&p)return S0(-1,l[u.index]);if(8&p){const m=u.child;if(null!==m)return Zh(l,m);{const v=l[u.index];return Un(v)?S0(-1,v):zi(v)}}if(32&p)return M0(u,l)()||zi(l[u.index]);{const m=Qi(l,u);return null!==m?Array.isArray(m)?m[0]:Zh(Hh(l[Zi]),m):Zh(l,u.next)}}return null}function Qi(l,u){return null!==u?l[Zi][Zr].projection[u.projection]:null}function S0(l,u){const p=Fi+l+1;if(p<u.length){const m=u[p],v=m[dn].firstChild;if(null!==v)return Zh(m,v)}return u[Ms]}function gp(l,u,p,m,v,C,E){for(;null!=p;){const T=m[p.index],k=p.type;if(E&&0===u&&(T&&Qs(zi(T),m),p.flags|=2),32!=(32&p.flags))if(8&k)gp(l,u,p.child,m,v,C,!1),ga(u,l,v,T,C);else if(32&k){const N=M0(p,m);let F;for(;F=N();)ga(u,l,v,F,C);ga(u,l,v,T,C)}else 16&k?__(l,u,m,p,v,C):ga(u,l,v,T,C);p=E?p.projectionNext:p.next}}function m_(l,u,p,m,v,C){gp(p,m,l.firstChild,u,v,C,!1)}function __(l,u,p,m,v,C){const E=p[Zi],k=E[Zr].projection[m.projection];if(Array.isArray(k))for(let N=0;N<k.length;N++)ga(u,l,v,k[N],C);else{let N=k;const F=E[Ai];x0(m)&&(N.flags|=128),gp(l,u,N,F,v,C,!0)}}function rv(l,u,p){""===p?l.removeAttribute(u,"class"):l.setAttribute(u,"class",p)}function Nu(l,u,p){const{mergedAttrs:m,classes:v,styles:C}=p;null!==m&&qi(l,u,m),null!==v&&rv(l,u,v),null!==C&&function qn(l,u,p){l.setAttribute(u,"style",p)}(l,u,C)}function Mw(l){R0=l}function il(l){return function L0(){if(void 0===El&&(El=null,Ar.trustedTypes))try{El=Ar.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:l=>l,createScript:l=>l,createScriptURL:l=>l})}catch{}return El}()?.createScriptURL(l)||l}class iv{constructor(u){this.changingThisBreaksApplicationSecurity=u}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Ve})`}}function Yh(l){return l instanceof iv?l.changingThisBreaksApplicationSecurity:l}function b_(l,u){const p=function Pw(l){return l instanceof iv&&l.getTypeName()||null}(l);if(null!=p&&p!==u){if("ResourceURL"===p&&"URL"===u)return!0;throw new Error(`Required a safe ${u}, got a ${p} (see ${Ve})`)}return p===u}const B0=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var vp=function(l){return l[l.NONE=0]="NONE",l[l.HTML=1]="HTML",l[l.STYLE=2]="STYLE",l[l.SCRIPT=3]="SCRIPT",l[l.URL=4]="URL",l[l.RESOURCE_URL=5]="RESOURCE_URL",l}(vp||{});function Z0(l){const u=bp();return u?u.sanitize(vp.URL,l)||"":b_(l,"URL")?Yh(l):function C_(l){return(l=String(l)).match(B0)?l:"unsafe:"+l}(ge(l))}function Sg(l){const u=bp();if(u)return il(u.sanitize(vp.RESOURCE_URL,l)||"");if(b_(l,"ResourceURL"))return il(Yh(l));throw new Gt(904,!1)}function Zn(l,u,p){return function Ag(l,u){return"src"===u&&("embed"===l||"frame"===l||"iframe"===l||"media"===l||"script"===l)||"href"===u&&("base"===l||"link"===l)?Sg:Z0}(u,p)(l)}function bp(){const l=Me();return l&&l[pd].sanitizer}const Qh=new er("ENVIRONMENT_INITIALIZER"),av=new er("INJECTOR",-1),X0=new er("INJECTOR_DEF_TYPES");class lv{get(u,p=at){if(p===at){const m=new Error(`NullInjectorError: No provider for ${We(u)}!`);throw m.name="NullInjectorError",m}return p}}function cv(l){return{\u0275providers:l}}function PP(...l){return{\u0275providers:Dg(0,l),\u0275fromNgModule:!0}}function Dg(l,...u){const p=[],m=new Set;let v;const C=E=>{p.push(E)};return Zo(u,E=>{const T=E;kg(T,C,[],m)&&(v||=[],v.push(T))}),void 0!==v&&Q0(v,C),p}function Q0(l,u){for(let p=0;p<l.length;p++){const{ngModule:m,providers:v}=l[p];kr(v,C=>{u(C,m)})}}function kg(l,u,p,m){if(!(l=Ce(l)))return!1;let v=null,C=Xe(l);const E=!C&&Wn(l);if(C||E){if(E&&!E.standalone)return!1;v=l}else{const k=l.ngModule;if(C=Xe(k),!C)return!1;v=k}const T=m.has(v);if(E){if(T)return!1;if(m.add(v),E.dependencies){const k="function"==typeof E.dependencies?E.dependencies():E.dependencies;for(const N of k)kg(N,u,p,m)}}else{if(!C)return!1;{if(null!=C.imports&&!T){let N;m.add(v);try{Zo(C.imports,F=>{kg(F,u,p,m)&&(N||=[],N.push(F))})}finally{}void 0!==N&&Q0(N,u)}if(!T){const N=Ul(v)||(()=>new v);u({provide:v,useFactory:N,deps:zr},v),u({provide:X0,useValue:v,multi:!0},v),u({provide:Qh,useValue:()=>ir(v),multi:!0},v)}const k=C.providers;if(null!=k&&!T){const N=l;kr(k,F=>{u(F,N)})}}}return v!==l&&void 0!==l.providers}function kr(l,u){for(let p of l)tt(p)&&(p=p.\u0275providers),Array.isArray(p)?kr(p,u):u(p)}const Iw=re({provide:String,useValue:re});function Sw(l){return null!==l&&"object"==typeof l&&Iw in l}function xp(l){return"function"==typeof l}const Jh=new er("Set Injector scope."),bt={},J0={};let Bo;function uv(){return void 0===Bo&&(Bo=new lv),Bo}class Ii{}class tf extends Ii{get destroyed(){return this._destroyed}constructor(u,p,m,v){super(),this.parent=p,this.source=m,this.scopes=v,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Cp(u,E=>this.processProvider(E)),this.records.set(av,T_(void 0,this)),v.has("environment")&&this.records.set(Ii,T_(void 0,this));const C=this.records.get(Jh);null!=C&&"string"==typeof C.value&&this.scopes.add(C.value),this.injectorDefTypes=new Set(this.get(X0.multi,zr,yn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const p of this._ngOnDestroyHooks)p.ngOnDestroy();const u=this._onDestroyHooks;this._onDestroyHooks=[];for(const p of u)p()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(u){return this.assertNotDestroyed(),this._onDestroyHooks.push(u),()=>this.removeOnDestroy(u)}runInContext(u){this.assertNotDestroyed();const p=Qr(this),m=Sn(void 0);try{return u()}finally{Qr(p),Sn(m)}}get(u,p=at,m=yn.Default){if(this.assertNotDestroyed(),u.hasOwnProperty(ag))return u[ag](this);m=qs(m);const C=Qr(this),E=Sn(void 0);try{if(!(m&yn.SkipSelf)){let k=this.records.get(u);if(void 0===k){const N=function wp(l){return"function"==typeof l||"object"==typeof l&&l instanceof er}(u)&&oe(u);k=N&&this.injectableDefInScope(N)?T_(dt(u),bt):null,this.records.set(u,k)}if(null!=k)return this.hydrate(u,k)}return(m&yn.Self?uv():this.parent).get(u,p=m&yn.Optional&&p===at?null:p)}catch(T){if("NullInjectorError"===T.name){if((T[Bt]=T[Bt]||[]).unshift(We(u)),C)throw T;return function zn(l,u,p,m){const v=l[Bt];throw u[Nn]&&v.unshift(u[Nn]),l.message=function vr(l,u,p,m=null){l=l&&"\n"===l.charAt(0)&&"\u0275"==l.charAt(1)?l.slice(2):l;let v=We(u);if(Array.isArray(u))v=u.map(We).join(" -> ");else if("object"==typeof u){let C=[];for(let E in u)if(u.hasOwnProperty(E)){let T=u[E];C.push(E+":"+("string"==typeof T?JSON.stringify(T):We(T)))}v=`{${C.join(", ")}}`}return`${p}${m?"("+m+")":""}[${v}]: ${l.replace(ee,"\n  ")}`}("\n"+l.message,v,p,m),l.ngTokenPath=v,l[Bt]=null,l}(T,u,"R3InjectorError",this.source)}throw T}finally{Sn(E),Qr(C)}}resolveInjectorInitializers(){const u=Qr(this),p=Sn(void 0);try{const v=this.get(Qh.multi,zr,yn.Self);for(const C of v)C()}finally{Qr(u),Sn(p)}}toString(){const u=[],p=this.records;for(const m of p.keys())u.push(We(m));return`R3Injector[${u.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Gt(205,!1)}processProvider(u){let p=xp(u=Ce(u))?u:Ce(u&&u.provide);const m=function EP(l){return Sw(l)?T_(void 0,l.useValue):T_(Vc(l),bt)}(u);if(xp(u)||!0!==u.multi)this.records.get(p);else{let v=this.records.get(p);v||(v=T_(void 0,bt,!0),v.factory=()=>ne(v.multi),this.records.set(p,v)),p=u,v.multi.push(u)}this.records.set(p,m)}hydrate(u,p){return p.value===bt&&(p.value=J0,p.value=p.factory()),"object"==typeof p.value&&p.value&&function OP(l){return null!==l&&"object"==typeof l&&"function"==typeof l.ngOnDestroy}(p.value)&&this._ngOnDestroyHooks.add(p.value),p.value}injectableDefInScope(u){if(!u.providedIn)return!1;const p=Ce(u.providedIn);return"string"==typeof p?"any"===p||this.scopes.has(p):this.injectorDefTypes.has(p)}removeOnDestroy(u){const p=this._onDestroyHooks.indexOf(u);-1!==p&&this._onDestroyHooks.splice(p,1)}}function dt(l){const u=oe(l),p=null!==u?u.factory:Ul(l);if(null!==p)return p;if(l instanceof er)throw new Gt(204,!1);if(l instanceof Function)return function dv(l){const u=l.length;if(u>0)throw function Vh(l,u){const p=[];for(let m=0;m<l;m++)p.push(u);return p}(u,"?"),new Gt(204,!1);const p=function ae(l){return l&&(l[Ze]||l[gn])||null}(l);return null!==p?()=>p.factory(l):()=>new l}(l);throw new Gt(204,!1)}function Vc(l,u,p){let m;if(xp(l)){const v=Ce(l);return Ul(v)||dt(v)}if(Sw(l))m=()=>Ce(l.useValue);else if(function Aw(l){return!(!l||!l.useFactory)}(l))m=()=>l.useFactory(...ne(l.deps||[]));else if(function Rg(l){return!(!l||!l.useExisting)}(l))m=()=>ir(Ce(l.useExisting));else{const v=Ce(l&&(l.useClass||l.provide));if(!function tx(l){return!!l.deps}(l))return Ul(v)||dt(v);m=()=>new v(...ne(l.deps))}return m}function T_(l,u,p=!1){return{factory:l,value:u,multi:p?[]:void 0}}function Cp(l,u){for(const p of l)Array.isArray(p)?Cp(p,u):p&&tt(p)?Cp(p.\u0275providers,u):u(p)}const ef=new er("AppId",{providedIn:"root",factory:()=>oc}),oc="ng",hv=new er("Platform Initializer"),Ir=new er("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),TP=new er("AnimationModuleType"),ex=new er("CSP nonce",{providedIn:"root",factory:()=>function _p(){if(void 0!==R0)return R0;if(typeof document<"u")return document;throw new Gt(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Mi=(l,u,p)=>null;function sx(l,u,p=!1){return Mi(l,u,p)}class k_{}class cx{}class gv{resolveComponentFactory(u){throw function ux(l){const u=Error(`No component factory found for ${We(l)}.`);return u.ngComponent=l,u}(u)}}let mv=(()=>{class l{static#t=this.NULL=new gv}return l})();function DP(){return Uu(fs(),Me())}function Uu(l,u){return new Lg(Jo(l,u))}let Lg=(()=>{class l{constructor(p){this.nativeElement=p}static#t=this.__NG_ELEMENT_ID__=DP}return l})();function _v(l){return l instanceof Lg?l.nativeElement:l}class yv{}let Rw=(()=>{class l{constructor(){this.destroyNode=null}static#t=this.__NG_ELEMENT_ID__=()=>function kP(){const l=Me(),p=ua(fs().index,l);return(bo(p)?p:l)[ar]}()}return l})(),dx=(()=>{class l{static#t=this.\u0275prov=nt({token:l,providedIn:"root",factory:()=>null})}return l})();class Ep{constructor(u){this.full=u,this.major=u.split(".")[0],this.minor=u.split(".")[1],this.patch=u.split(".").slice(2).join(".")}}const vv=new Ep("16.2.12"),Aa={};function xv(l,u=null,p=null,m){const v=pi(l,u,p,m);return v.resolveInjectorInitializers(),v}function pi(l,u=null,p=null,m,v=new Set){const C=[p||zr,PP(l)];return m=m||("object"==typeof l?void 0:We(l)),new tf(C,u||uv(),m||null,v)}let ac=(()=>{class l{static#t=this.THROW_IF_NOT_FOUND=at;static#e=this.NULL=new lv;static create(p,m){if(Array.isArray(p))return xv({name:""},m,p,"");{const v=p.name??"";return xv({name:v},p.parent,p.providers,v)}}static#n=this.\u0275prov=nt({token:l,providedIn:"any",factory:()=>ir(av)});static#r=this.__NG_ELEMENT_ID__=-1}return l})();function R_(l){return l.ngOriginalError}class Vu{constructor(){this._console=console}handleError(u){const p=this._findOriginalError(u);this._console.error("ERROR",u),p&&this._console.error("ORIGINAL ERROR",p)}_findOriginalError(u){let p=u&&R_(u);for(;p&&R_(p);)p=R_(p);return p||null}}function Ol(l){return u=>{setTimeout(l,void 0,u)}}const Ei=class jd extends M.x{constructor(u=!1){super(),this.__isAsync=u}emit(u){super.next(u)}subscribe(u,p,m){let v=u,C=p||(()=>null),E=m;if(u&&"object"==typeof u){const k=u;v=k.next?.bind(k),C=k.error?.bind(k),E=k.complete?.bind(k)}this.__isAsync&&(C=Ol(C),v&&(v=Ol(v)),E&&(E=Ol(E)));const T=super.subscribe({next:v,error:C,complete:E});return u instanceof mt.w0&&u.add(T),T}};function jc(...l){}class Wo{constructor({enableLongStackTrace:u=!1,shouldCoalesceEventChangeDetection:p=!1,shouldCoalesceRunChangeDetection:m=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ei(!1),this.onMicrotaskEmpty=new Ei(!1),this.onStable=new Ei(!1),this.onError=new Ei(!1),typeof Zone>"u")throw new Gt(908,!1);Zone.assertZonePatched();const v=this;v._nesting=0,v._outer=v._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(v._inner=v._inner.fork(new Zone.TaskTrackingZoneSpec)),u&&Zone.longStackTraceZoneSpec&&(v._inner=v._inner.fork(Zone.longStackTraceZoneSpec)),v.shouldCoalesceEventChangeDetection=!m&&p,v.shouldCoalesceRunChangeDetection=m,v.lastRequestAnimationFrameId=-1,v.nativeRequestAnimationFrame=function Ng(){const l="function"==typeof Ar.requestAnimationFrame;let u=Ar[l?"requestAnimationFrame":"setTimeout"],p=Ar[l?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&u&&p){const m=u[Zone.__symbol__("OriginalDelegate")];m&&(u=m);const v=p[Zone.__symbol__("OriginalDelegate")];v&&(p=v)}return{nativeRequestAnimationFrame:u,nativeCancelAnimationFrame:p}}().nativeRequestAnimationFrame,function MT(l){const u=()=>{!function LP(l){l.isCheckStableRunning||-1!==l.lastRequestAnimationFrameId||(l.lastRequestAnimationFrameId=l.nativeRequestAnimationFrame.call(Ar,()=>{l.fakeTopEventTask||(l.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{l.lastRequestAnimationFrameId=-1,zg(l),l.isCheckStableRunning=!0,Tp(l),l.isCheckStableRunning=!1},void 0,()=>{},()=>{})),l.fakeTopEventTask.invoke()}),zg(l))}(l)};l._inner=l._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(p,m,v,C,E,T)=>{if(function FP(l){return!(!Array.isArray(l)||1!==l.length)&&!0===l[0].data?.__ignore_ng_zone__}(T))return p.invokeTask(v,C,E,T);try{return NP(l),p.invokeTask(v,C,E,T)}finally{(l.shouldCoalesceEventChangeDetection&&"eventTask"===C.type||l.shouldCoalesceRunChangeDetection)&&u(),fx(l)}},onInvoke:(p,m,v,C,E,T,k)=>{try{return NP(l),p.invoke(v,C,E,T,k)}finally{l.shouldCoalesceRunChangeDetection&&u(),fx(l)}},onHasTask:(p,m,v,C)=>{p.hasTask(v,C),m===v&&("microTask"==C.change?(l._hasPendingMicrotasks=C.microTask,zg(l),Tp(l)):"macroTask"==C.change&&(l.hasPendingMacrotasks=C.macroTask))},onHandleError:(p,m,v,C)=>(p.handleError(v,C),l.runOutsideAngular(()=>l.onError.emit(C)),!1)})}(v)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Wo.isInAngularZone())throw new Gt(909,!1)}static assertNotInAngularZone(){if(Wo.isInAngularZone())throw new Gt(909,!1)}run(u,p,m){return this._inner.run(u,p,m)}runTask(u,p,m,v){const C=this._inner,E=C.scheduleEventTask("NgZoneEvent: "+v,u,zw,jc,jc);try{return C.runTask(E,p,m)}finally{C.cancelTask(E)}}runGuarded(u,p,m){return this._inner.runGuarded(u,p,m)}runOutsideAngular(u){return this._outer.run(u)}}const zw={};function Tp(l){if(0==l._nesting&&!l.hasPendingMicrotasks&&!l.isStable)try{l._nesting++,l.onMicrotaskEmpty.emit(null)}finally{if(l._nesting--,!l.hasPendingMicrotasks)try{l.runOutsideAngular(()=>l.onStable.emit(null))}finally{l.isStable=!0}}}function zg(l){l.hasPendingMicrotasks=!!(l._hasPendingMicrotasks||(l.shouldCoalesceEventChangeDetection||l.shouldCoalesceRunChangeDetection)&&-1!==l.lastRequestAnimationFrameId)}function NP(l){l._nesting++,l.isStable&&(l.isStable=!1,l.onUnstable.emit(null))}function fx(l){l._nesting--,Tp(l)}class Bw{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ei,this.onMicrotaskEmpty=new Ei,this.onStable=new Ei,this.onError=new Ei}run(u,p,m){return u.apply(p,m)}runGuarded(u,p,m){return u.apply(p,m)}runOutsideAngular(u){return u()}runTask(u,p,m,v){return u.apply(p,m)}}const Uw=new er("",{providedIn:"root",factory:$c});function $c(){const l=or(Wo);let u=!0;const p=new It.y(v=>{u=l.isStable&&!l.hasPendingMacrotasks&&!l.hasPendingMicrotasks,l.runOutsideAngular(()=>{v.next(u),v.complete()})}),m=new It.y(v=>{let C;l.runOutsideAngular(()=>{C=l.onStable.subscribe(()=>{Wo.assertNotInAngularZone(),queueMicrotask(()=>{!u&&!l.hasPendingMacrotasks&&!l.hasPendingMicrotasks&&(u=!0,v.next(!0))})})});const E=l.onUnstable.subscribe(()=>{Wo.assertInAngularZone(),u&&(u=!1,l.runOutsideAngular(()=>{v.next(!1)}))});return()=>{C.unsubscribe(),E.unsubscribe()}});return(0,vt.T)(p,m.pipe((0,ke.B)()))}function zP(l){return l.ownerDocument.defaultView}function _a(l){return l instanceof Function?l():l}let lc=(()=>{class l{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#t=this.\u0275prov=nt({token:l,providedIn:"root",factory:()=>new l})}return l})();function Ip(l){for(;l;){l[Ye]|=64;const u=Hh(l);if(hu(l)&&!u)return l;l=u}return null}const BP=new er("",{providedIn:"root",factory:()=>!1});let $w=null;function jP(l,u){return l[u]??L_()}function Gw(l,u){const p=L_();p.producerNode?.length&&(l[u]=$w,p.lView=l,$w=uf())}const Br={...Ch,consumerIsAlwaysLive:!0,consumerMarkedDirty:l=>{Ip(l.lView)},lView:null};function uf(){return Object.create(Br)}function L_(){return $w??=uf(),$w}const An={};function Rn(l){$d(ri(),Me(),ro()+l,!1)}function $d(l,u,p,m){if(!m)if(3==(3&u[Ye])){const C=l.preOrderCheckHooks;null!==C&&Sd(u,C,p)}else{const C=l.preOrderHooks;null!==C&&Ts(u,C,0,p)}Eu(p)}function oi(l,u=yn.Default){const p=Me();return null===p?ir(l,u):Ea(fs(),p,Ce(l),u)}function $P(){throw new Error("invalid")}function hn(l,u,p,m,v,C,E,T,k,N,F){const $=u.blueprint.slice();return $[Jr]=v,$[Ye]=140|m,(null!==N||l&&2048&l[Ye])&&($[Ye]|=2048),Jf($),$[Ai]=$[ba]=l,$[ko]=p,$[pd]=E||l&&l[pd],$[ar]=T||l&&l[ar],$[Xo]=k||l&&l[Xo]||null,$[Zr]=C,$[bn]=function vT(){return vw++}(),$[po]=F,$[Hf]=N,$[Zi]=2==u.type?l[Zi]:$,$}function df(l,u,p,m,v){let C=l.data[u];if(null===C)C=function Cv(l,u,p,m,v){const C=t_(),E=kh(),k=l.data[u]=function B_(l,u,p,m,v,C){let E=u?u.injectorIndex:-1,T=0;return function wu(){return null!==lr.skipHydrationRootTNode}()&&(T|=128),{type:p,index:m,insertBeforeIndex:null,injectorIndex:E,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:T,providerIndexes:0,value:v,attrs:C,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:u,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,E?C:C&&C.parent,p,u,m,v);return null===l.firstChild&&(l.firstChild=k),null!==C&&(E?null==C.child&&null!==k.parent&&(C.child=k):null===C.next&&(C.next=k,k.prev=C)),k}(l,u,p,m,v),function e_(){return lr.lFrame.inI18n}()&&(C.flags|=32);else if(64&C.type){C.type=p,C.value=m,C.attrs=v;const E=function rp(){const l=lr.lFrame,u=l.currentTNode;return l.isParent?u:u.parent}();C.injectorIndex=null===E?-1:E.injectorIndex}return Ka(C,!0),C}function $u(l,u,p,m){if(0===p)return-1;const v=u.length;for(let C=0;C<p;C++)u.push(m),l.blueprint.push(m),l.data.push(null);return v}function mx(l,u,p,m,v){const C=jP(u,Ro),E=ro(),T=2&m;try{Eu(-1),T&&u.length>Yn&&$d(l,u,Yn,!1),hs(T?2:0,v);const N=T?C:null,F=Vl(N);try{null!==N&&(N.dirty=!1),p(m,v)}finally{qa(N,F)}}finally{T&&null===u[Ro]&&Gw(u,Ro),Eu(E),hs(T?3:1,v)}}function N_(l,u,p){if(du(u)){const m=Qo(null);try{const C=u.directiveEnd;for(let E=u.directiveStart;E<C;E++){const T=l.data[E];T.contentQueries&&T.contentQueries(1,p[E],E)}}finally{Qo(m)}}}function Sp(l,u,p){Ed()&&(function Tv(l,u,p,m){const v=p.directiveStart,C=p.directiveEnd;_l(p)&&function ET(l,u,p){const m=Jo(u,l),v=Eo(p);let E=16;p.signals?E=4096:p.onPush&&(E=64);const T=$g(l,hn(l,v,null,E,m,u,null,l[pd].rendererFactory.createRenderer(m,p),null,null,null));l[u.index]=T}(u,p,l.data[v+p.componentOffset]),l.firstCreatePass||Cl(p,u),Qs(m,u);const E=p.initialInputs;for(let T=v;T<C;T++){const k=l.data[T],N=Fd(u,l,T,p);Qs(N,u),null!==E&&OT(0,T-v,N,k,0,E),la(k)&&(ua(p.index,u)[ko]=Fd(u,l,T,p))}}(l,u,p,Jo(p,u)),64==(64&p.flags)&&qw(l,u,p))}function Bg(l,u,p=Jo){const m=u.localNames;if(null!==m){let v=u.index+1;for(let C=0;C<m.length;C+=2){const E=m[C+1],T=-1===E?p(u,l):l[E];l[v++]=T}}}function Eo(l){const u=l.tView;return null===u||u.incompleteFirstPass?l.tView=Ug(1,null,l.template,l.decls,l.vars,l.directiveDefs,l.pipeDefs,l.viewQuery,l.schemas,l.consts,l.id):u}function Ug(l,u,p,m,v,C,E,T,k,N,F){const $=Yn+m,q=$+v,Z=function Il(l,u){const p=[];for(let m=0;m<u;m++)p.push(m<l?null:An);return p}($,q),X="function"==typeof N?N():N;return Z[dn]={type:l,blueprint:Z,template:p,queries:null,viewQuery:T,declTNode:u,data:Z.slice().fill(null,$),bindingStartIndex:$,expandoStartIndex:q,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof C?C():C,pipeRegistry:"function"==typeof E?E():E,firstChild:null,schemas:k,consts:X,incompleteFirstPass:!1,ssrId:F}}let z_=l=>null;function Sl(l,u,p,m){for(let v in l)if(l.hasOwnProperty(v)){p=null===p?{}:p;const C=l[v];null===m?Pv(p,u,v,C):m.hasOwnProperty(v)&&Pv(p,u,m[v],C)}return p}function Pv(l,u,p,m){l.hasOwnProperty(p)?l[p].push(u,m):l[p]=[u,m]}function Hw(l,u,p,m){if(Ed()){const v=null===m?null:{"":-1},C=function yx(l,u){const p=l.directiveRegistry;let m=null,v=null;if(p)for(let C=0;C<p.length;C++){const E=p[C];if(au(u,E.selectors,!1))if(m||(m=[]),la(E))if(null!==E.findHostDirectiveDefs){const T=[];v=v||new Map,E.findHostDirectiveDefs(E,T,v),m.unshift(...T,E),vx(l,u,T.length)}else m.unshift(E),vx(l,u,0);else v=v||new Map,E.findHostDirectiveDefs?.(E,m,v),m.push(E)}return null===m?null:[m,v]}(l,p);let E,T;null===C?E=T=null:[E,T]=C,null!==E&&HP(l,u,p,E,v,T),v&&function Gu(l,u,p){if(u){const m=l.localNames=[];for(let v=0;v<u.length;v+=2){const C=p[u[v+1]];if(null==C)throw new Gt(-301,!1);m.push(u[v],C)}}}(p,m,v)}p.mergedAttrs=ud(p.mergedAttrs,p.attrs)}function HP(l,u,p,m,v,C){for(let N=0;N<m.length;N++)Ld(Cl(p,u),l,m[N].type);!function bx(l,u,p){l.flags|=1,l.directiveStart=u,l.directiveEnd=u+p,l.providerIndexes=u}(p,l.data.length,m.length);for(let N=0;N<m.length;N++){const F=m[N];F.providersResolver&&F.providersResolver(F)}let E=!1,T=!1,k=$u(l,u,m.length,null);for(let N=0;N<m.length;N++){const F=m[N];p.mergedAttrs=ud(p.mergedAttrs,F.hostAttrs),qP(l,p,u,k,F),jg(k,F,v),null!==F.contentQueries&&(p.flags|=4),(null!==F.hostBindings||null!==F.hostAttrs||0!==F.hostVars)&&(p.flags|=64);const $=F.type.prototype;!E&&($.ngOnChanges||$.ngOnInit||$.ngDoCheck)&&((l.preOrderHooks??=[]).push(p.index),E=!0),!T&&($.ngOnChanges||$.ngDoCheck)&&((l.preOrderCheckHooks??=[]).push(p.index),T=!0),k++}!function Vg(l,u,p){const v=u.directiveEnd,C=l.data,E=u.attrs,T=[];let k=null,N=null;for(let F=u.directiveStart;F<v;F++){const $=C[F],q=p?p.get($):null,X=q?q.outputs:null;k=Sl($.inputs,F,k,q?q.inputs:null),N=Sl($.outputs,F,N,X);const K=null===k||null===E||Mn(u)?null:TT(k,F,E);T.push(K)}null!==k&&(k.hasOwnProperty("class")&&(u.flags|=8),k.hasOwnProperty("style")&&(u.flags|=16)),u.initialInputs=T,u.inputs=k,u.outputs=N}(l,p,C)}function qw(l,u,p){const m=p.directiveStart,v=p.directiveEnd,C=p.index,E=function Ac(){return lr.lFrame.currentDirectiveIndex}();try{Eu(C);for(let T=m;T<v;T++){const k=l.data[T],N=u[T];Dc(T),(null!==k.hostBindings||0!==k.hostVars||null!==k.hostAttrs)&&ka(k,N)}}finally{Eu(-1),Dc(E)}}function ka(l,u){null!==l.hostBindings&&l.hostBindings(1,u)}function vx(l,u,p){u.componentOffset=p,(l.components??=[]).push(u.index)}function jg(l,u,p){if(p){if(u.exportAs)for(let m=0;m<u.exportAs.length;m++)p[u.exportAs[m]]=l;la(u)&&(p[""]=l)}}function qP(l,u,p,m,v){l.data[m]=v;const C=v.factory||(v.factory=Ul(v.type)),E=new Lh(C,la(v),oi);l.blueprint[m]=E,p[m]=E,function cc(l,u,p,m,v){const C=v.hostBindings;if(C){let E=l.hostBindingOpCodes;null===E&&(E=l.hostBindingOpCodes=[]);const T=~u.index;(function Ov(l){let u=l.length;for(;u>0;){const p=l[--u];if("number"==typeof p&&p<0)return p}return 0})(E)!=T&&E.push(T),E.push(p,m,C)}}(l,u,m,$u(l,p,v.hostVars,An),v)}function Hu(l,u,p,m,v,C){const E=Jo(l,u);!function xx(l,u,p,m,v,C,E){if(null==C)l.removeAttribute(u,v,p);else{const T=null==E?ge(C):E(C,m||"",v);l.setAttribute(u,v,T,p)}}(u[ar],E,C,l.value,p,m,v)}function OT(l,u,p,m,v,C){const E=C[u];if(null!==E)for(let T=0;T<E.length;)ZP(m,p,E[T++],E[T++],E[T++])}function ZP(l,u,p,m,v){const C=Qo(null);try{const E=l.inputTransforms;null!==E&&E.hasOwnProperty(m)&&(v=E[m].call(u,v)),null!==l.setInput?l.setInput(u,v,p,m):u[m]=v}finally{Qo(C)}}function TT(l,u,p){let m=null,v=0;for(;v<p.length;){const C=p[v];if(0!==C)if(5!==C){if("number"==typeof C)break;if(l.hasOwnProperty(C)){null===m&&(m=[]);const E=l[C];for(let T=0;T<E.length;T+=2)if(E[T]===u){m.push(C,E[T+1],p[v+1]);break}}v+=2}else v+=2;else v+=4}return m}function wx(l,u,p,m){return[l,!0,!1,u,null,0,m,p,null,null,null]}function Iv(l,u){const p=l.contentQueries;if(null!==p)for(let m=0;m<p.length;m+=2){const C=p[m+1];if(-1!==C){const E=l.data[C];da(p[m]),E.contentQueries(2,u[C],C)}}}function $g(l,u){return l[Ws]?l[Cc][Cs]=u:l[Ws]=u,l[Cc]=u,u}function Cx(l,u,p){da(0);const m=Qo(null);try{u(l,p)}finally{Qo(m)}}function Zw(l){return l[ni]||(l[ni]=[])}function Sv(l){return l.cleanup||(l.cleanup=[])}function Mx(l,u){const p=l[Xo],m=p?p.get(Vu,null):null;m&&m.handleError(u)}function Av(l,u,p,m,v){for(let C=0;C<p.length;){const E=p[C++],T=p[C++];ZP(l.data[E],u[E],m,T,v)}}function Gd(l,u,p){const m=_u(u,l);!function E0(l,u,p){l.setValue(u,p)}(l[ar],m,p)}function Hd(l,u){const p=ua(u,l),m=p[dn];!function Gg(l,u){for(let p=u.length;p<l.blueprint.length;p++)u.push(l.blueprint[p])}(m,p);const v=p[Jr];null!==v&&null===p[po]&&(p[po]=sx(v,p[Xo])),Px(m,p,p[ko])}function Px(l,u,p){kc(u);try{const m=l.viewQuery;null!==m&&Cx(1,m,p);const v=l.template;null!==v&&mx(l,u,v,1,p),l.firstCreatePass&&(l.firstCreatePass=!1),l.staticContentQueries&&Iv(l,u),l.staticViewQueries&&Cx(2,l.viewQuery,p);const C=l.components;null!==C&&function Ww(l,u){for(let p=0;p<u.length;p++)Hd(l,u[p])}(u,C)}catch(m){throw l.firstCreatePass&&(l.incompleteFirstPass=!0,l.firstCreatePass=!1),m}finally{u[Ye]&=-5,Pu()}}let zs=(()=>{class l{constructor(){this.all=new Set,this.queue=new Map}create(p,m,v){const C=typeof Zone>"u"?null:Zone.current,E=function gu(l,u,p){const m=Object.create(Ih);p&&(m.consumerAllowSignalWrites=!0),m.fn=l,m.schedule=u;const v=E=>{m.cleanupFn=E};return m.ref={notify:()=>Gm(m),run:()=>{if(m.dirty=!1,m.hasRun&&!Pc(m))return;m.hasRun=!0;const E=Vl(m);try{m.cleanupFn(),m.cleanupFn=mu,m.fn(v)}finally{qa(m,E)}},cleanup:()=>m.cleanupFn()},m.ref}(p,N=>{this.all.has(N)&&this.queue.set(N,C)},v);let T;this.all.add(E),E.notify();const k=()=>{E.cleanup(),T?.(),this.all.delete(E),this.queue.delete(E)};return T=m?.onDestroy(k),{destroy:k}}flush(){if(0!==this.queue.size)for(const[p,m]of this.queue)this.queue.delete(p),m?m.run(()=>p.run()):p.run()}get isQueueEmpty(){return 0===this.queue.size}static#t=this.\u0275prov=nt({token:l,providedIn:"root",factory:()=>new l})}return l})();function qu(l,u,p){let m=p?l.styles:null,v=p?l.classes:null,C=0;if(null!==u)for(let E=0;E<u.length;E++){const T=u[E];"number"==typeof T?C=T:1==C?v=rn(v,T):2==C&&(m=rn(m,T+": "+u[++E]+";"))}p?l.styles=m:l.stylesWithoutHost=m,p?l.classes=v:l.classesWithoutHost=v}function U_(l,u,p,m,v=!1){for(;null!==p;){const C=u[p.index];null!==C&&m.push(zi(C)),Un(C)&&lo(C,m);const E=p.type;if(8&E)U_(l,u,p.child,m);else if(32&E){const T=M0(p,u);let k;for(;k=T();)m.push(k)}else if(16&E){const T=Qi(u,p);if(Array.isArray(T))m.push(...T);else{const k=Hh(u[Zi]);U_(k[dn],k,T,m,!0)}}p=v?p.projectionNext:p.next}return m}function lo(l,u){for(let p=Fi;p<l.length;p++){const m=l[p],v=m[dn].firstChild;null!==v&&U_(m[dn],m,v,u)}l[Ms]!==l[Jr]&&u.push(l[Ms])}function Hg(l,u,p,m=!0){const v=u[pd],C=v.rendererFactory,E=v.afterRenderEventManager;C.begin?.(),E?.begin();try{V_(l,u,l.template,p)}catch(k){throw m&&Mx(u,k),k}finally{C.end?.(),v.effectManager?.flush(),E?.end()}}function V_(l,u,p,m){const v=u[Ye];if(256!=(256&v)){u[pd].effectManager?.flush(),kc(u);try{Jf(u),function Td(l){return lr.lFrame.bindingIndex=l}(l.bindingStartIndex),null!==p&&mx(l,u,p,2,m);const E=3==(3&v);if(E){const N=l.preOrderCheckHooks;null!==N&&Sd(u,N,null)}else{const N=l.preOrderHooks;null!==N&&Ts(u,N,0,null),io(u,0)}if(function cl(l){for(let u=Pl(l);null!==u;u=pr(u)){if(!u[gd])continue;const p=u[Bl];for(let m=0;m<p.length;m++){tp(p[m])}}}(u),Gc(u,2),null!==l.contentQueries&&Iv(l,u),E){const N=l.contentCheckHooks;null!==N&&Sd(u,N)}else{const N=l.contentHooks;null!==N&&Ts(u,N,1),io(u,1)}!function _s(l,u){const p=l.hostBindingOpCodes;if(null===p)return;const m=jP(u,sa);try{for(let v=0;v<p.length;v++){const C=p[v];if(C<0)Eu(~C);else{const E=C,T=p[++v],k=p[++v];Ky(T,E),m.dirty=!1;const N=Vl(m);try{k(2,u[E])}finally{qa(m,N)}}}}finally{null===u[sa]&&Gw(u,sa),Eu(-1)}}(l,u);const T=l.components;null!==T&&ys(u,T,0);const k=l.viewQuery;if(null!==k&&Cx(2,k,m),E){const N=l.viewCheckHooks;null!==N&&Sd(u,N)}else{const N=l.viewHooks;null!==N&&Ts(u,N,2),io(u,2)}!0===l.firstUpdatePass&&(l.firstUpdatePass=!1),u[Ye]&=-73,Pd(u)}finally{Pu()}}}function Gc(l,u){for(let p=Pl(l);null!==p;p=pr(p))for(let m=Fi;m<p.length;m++)IT(p[m],u)}function Dv(l,u,p){IT(ua(u,l),p)}function IT(l,u){if(!function gw(l){return 128==(128&l[Ye])}(l))return;const p=l[dn],m=l[Ye];if(80&m&&0===u||1024&m||2===u)V_(p,l,p.template,l[ko]);else if(l[ja]>0){Gc(l,1);const v=p.components;null!==v&&ys(l,v,1)}}function ys(l,u,p){for(let m=0;m<u.length;m++)Dv(l,u[m],p)}class kv{get rootNodes(){const u=this._lView,p=u[dn];return U_(p,u,p.firstChild,[])}constructor(u,p){this._lView=u,this._cdRefInjectingView=p,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[ko]}set context(u){this._lView[ko]=u}get destroyed(){return 256==(256&this._lView[Ye])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const u=this._lView[Ai];if(Un(u)){const p=u[8],m=p?p.indexOf(this):-1;m>-1&&(f_(u,m),Au(p,m))}this._attachedToViewContainer=!1}Di(this._lView[dn],this._lView)}onDestroy(u){!function bu(l,u){if(256==(256&l[Ye]))throw new Gt(911,!1);null===l[oa]&&(l[oa]=[]),l[oa].push(u)}(this._lView,u)}markForCheck(){Ip(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ye]&=-129}reattach(){this._lView[Ye]|=128}detectChanges(){Hg(this._lView[dn],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Gt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function zo(l,u){m_(l,u,u[ar],2,null,null)}(this._lView[dn],this._lView)}attachToAppRef(u){if(this._attachedToViewContainer)throw new Gt(902,!1);this._appRef=u}}class pf extends kv{constructor(u){super(u),this._view=u}detectChanges(){const u=this._view;Hg(u[dn],u,u[ko],!1)}checkNoChanges(){}get context(){return null}}class Vo extends mv{constructor(u){super(),this.ngModule=u}resolveComponentFactory(u){const p=Wn(u);return new qd(p,this.ngModule)}}function Zu(l){const u=[];for(let p in l)l.hasOwnProperty(p)&&u.push({propName:l[p],templateName:p});return u}class Lv{constructor(u,p){this.injector=u,this.parentInjector=p}get(u,p,m){m=qs(m);const v=this.injector.get(u,Aa,m);return v!==Aa||p===Aa?v:this.parentInjector.get(u,p,m)}}class qd extends cx{get inputs(){const u=this.componentDef,p=u.inputTransforms,m=Zu(u.inputs);if(null!==p)for(const v of m)p.hasOwnProperty(v.propName)&&(v.transform=p[v.propName]);return m}get outputs(){return Zu(this.componentDef.outputs)}constructor(u,p){super(),this.componentDef=u,this.ngModule=p,this.componentType=u.type,this.selector=function Gf(l){return l.map(lu).join(",")}(u.selectors),this.ngContentSelectors=u.ngContentSelectors?u.ngContentSelectors:[],this.isBoundToModule=!!p}create(u,p,m,v){let C=(v=v||this.ngModule)instanceof Ii?v:v?.injector;C&&null!==this.componentDef.getStandaloneInjector&&(C=this.componentDef.getStandaloneInjector(C)||C);const E=C?new Lv(u,C):u,T=E.get(yv,null);if(null===T)throw new Gt(407,!1);const $={rendererFactory:T,sanitizer:E.get(dx,null),effectManager:E.get(zs,null),afterRenderEventManager:E.get(lc,null)},q=T.createRenderer(null,this.componentDef),Z=this.componentDef.selectors[0][0]||"div",X=m?function F_(l,u,p,m){const C=m.get(BP,!1)||p===Hi.ShadowDom,E=l.selectRootElement(u,C);return function Mv(l){z_(l)}(E),E}(q,m,this.componentDef.encapsulation,E):O0(q,Z,function Rv(l){const u=l.toLowerCase();return"svg"===u?"svg":"math"===u?"math":null}(Z)),st=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let ot=null;null!==X&&(ot=sx(X,E,!0));const rt=Ug(0,null,null,1,0,null,null,null,null,null,null),ct=hn(null,rt,null,st,null,null,$,q,E,null,ot);let yt,Ot;kc(ct);try{const Tt=this.componentDef;let zt,Nt=null;Tt.findHostDirectiveDefs?(zt=[],Nt=new Map,Tt.findHostDirectiveDefs(Tt,zt,Nt),zt.push(Tt)):zt=[Tt];const $t=function Al(l,u){const p=l[dn],m=Yn;return l[m]=u,df(p,m,2,"#host",null)}(ct,X),Rt=function Dp(l,u,p,m,v,C,E){const T=v[dn];!function Ex(l,u,p,m){for(const v of l)u.mergedAttrs=ud(u.mergedAttrs,v.hostAttrs);null!==u.mergedAttrs&&(qu(u,u.mergedAttrs,!0),null!==p&&Nu(m,p,u))}(m,l,u,E);let k=null;null!==u&&(k=sx(u,v[Xo]));const N=C.rendererFactory.createRenderer(u,p);let F=16;p.signals?F=4096:p.onPush&&(F=64);const $=hn(v,Eo(p),null,F,v[l.index],l,C,N,null,null,k);return T.firstCreatePass&&vx(T,l,m.length-1),$g(v,$),v[l.index]=$}($t,X,Tt,zt,ct,$,q);Ot=yu(rt,Yn),X&&function uc(l,u,p,m){if(m)qi(l,p,["ng-version",vv.full]);else{const{attrs:v,classes:C}=function Um(l){const u=[],p=[];let m=1,v=2;for(;m<l.length;){let C=l[m];if("string"==typeof C)2===v?""!==C&&u.push(C,l[++m]):8===v&&p.push(C);else{if(!Ho(v))break;v=C}m++}return{attrs:u,classes:p}}(u.selectors[0]);v&&qi(l,p,v),C&&C.length>0&&rv(l,p,C.join(" "))}}(q,Tt,X,m),void 0!==p&&function Nv(l,u,p){const m=l.projection=[];for(let v=0;v<u.length;v++){const C=p[v];m.push(null!=C?Array.from(C):null)}}(Ot,this.ngContentSelectors,p),yt=function kp(l,u,p,m,v,C){const E=fs(),T=v[dn],k=Jo(E,v);HP(T,v,E,p,null,m);for(let F=0;F<p.length;F++)Qs(Fd(v,T,E.directiveStart+F,E),v);qw(T,v,E),k&&Qs(k,v);const N=Fd(v,T,E.directiveStart+E.componentOffset,E);if(l[ko]=v[ko]=N,null!==C)for(const F of C)F(N,u);return N_(T,E,l),N}(Rt,Tt,zt,Nt,ct,[dc]),Px(rt,ct,null)}finally{Pu()}return new KP(this.componentType,yt,Uu(Ot,ct),ct,Ot)}}class KP extends k_{constructor(u,p,m,v,C){super(),this.location=m,this._rootLView=v,this._tNode=C,this.previousInputValues=null,this.instance=p,this.hostView=this.changeDetectorRef=new pf(v),this.componentType=u}setInput(u,p){const m=this._tNode.inputs;let v;if(null!==m&&(v=m[u])){if(this.previousInputValues??=new Map,this.previousInputValues.has(u)&&Object.is(this.previousInputValues.get(u),p))return;const C=this._rootLView;Av(C[dn],C,v,u,p),this.previousInputValues.set(u,p),Ip(ua(this._tNode.index,C))}}get injector(){return new es(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(u){this.hostView.onDestroy(u)}}function dc(){const l=fs();Yl(Me()[dn],l)}function gf(l){let u=function Fv(l){return Object.getPrototypeOf(l.prototype).constructor}(l.type),p=!0;const m=[l];for(;u;){let v;if(la(l))v=u.\u0275cmp||u.\u0275dir;else{if(u.\u0275cmp)throw new Gt(903,!1);v=u.\u0275dir}if(v){if(p){m.push(v);const E=l;E.inputs=qg(l.inputs),E.inputTransforms=qg(l.inputTransforms),E.declaredInputs=qg(l.declaredInputs),E.outputs=qg(l.outputs);const T=v.hostBindings;T&&zv(l,T);const k=v.viewQuery,N=v.contentQueries;if(k&&Zg(l,k),N&&Yw(l,N),tn(l.inputs,v.inputs),tn(l.declaredInputs,v.declaredInputs),tn(l.outputs,v.outputs),null!==v.inputTransforms&&(null===E.inputTransforms&&(E.inputTransforms={}),tn(E.inputTransforms,v.inputTransforms)),la(v)&&v.data.animation){const F=l.data;F.animation=(F.animation||[]).concat(v.data.animation)}}const C=v.features;if(C)for(let E=0;E<C.length;E++){const T=C[E];T&&T.ngInherit&&T(l),T===gf&&(p=!1)}}u=Object.getPrototypeOf(u)}!function Kw(l){let u=0,p=null;for(let m=l.length-1;m>=0;m--){const v=l[m];v.hostVars=u+=v.hostVars,v.hostAttrs=ud(v.hostAttrs,p=ud(p,v.hostAttrs))}}(m)}function qg(l){return l===Ti?{}:l===zr?[]:l}function Zg(l,u){const p=l.viewQuery;l.viewQuery=p?(m,v)=>{u(m,v),p(m,v)}:u}function Yw(l,u){const p=l.contentQueries;l.contentQueries=p?(m,v,C)=>{u(m,v,C),p(m,v,C)}:u}function zv(l,u){const p=l.hostBindings;l.hostBindings=p?(m,v)=>{u(m,v),p(m,v)}:u}function co(l){const u=l.inputConfig,p={};for(const m in u)if(u.hasOwnProperty(m)){const v=u[m];Array.isArray(v)&&v[2]&&(p[m]=v[2])}l.inputTransforms=p}function ao(l){return!!Tx(l)&&(Array.isArray(l)||!(l instanceof Map)&&Symbol.iterator in l)}function Tx(l){return null!==l&&("function"==typeof l||"object"==typeof l)}function xr(l,u,p){return!Object.is(l[u],p)&&(l[u]=p,!0)}function mf(l,u,p,m){const v=Me();return xr(v,Id(),u)&&(ri(),Hu(Yi(),v,l,u,p,m)),mf}function Kd(l,u,p,m,v,C){const T=function vi(l,u,p,m){const v=xr(l,u,p);return xr(l,u+1,m)||v}(l,function bl(){return lr.lFrame.bindingIndex}(),p,v);return Ca(2),T?u+ge(p)+m+ge(v)+C:An}function rC(l,u,p,m,v,C,E,T){const k=Me(),N=ri(),F=l+Yn,$=N.firstCreatePass?function Rx(l,u,p,m,v,C,E,T,k){const N=u.consts,F=df(u,l,4,E||null,Es(N,T));Hw(u,p,F,Es(N,k)),Yl(u,F);const $=F.tView=Ug(2,F,m,v,C,u.directiveRegistry,u.pipeRegistry,null,u.schemas,N,null);return null!==u.queries&&(u.queries.template(u,F),$.queries=u.queries.embeddedTView(F)),F}(F,N,k,u,p,m,v,C,E):N.data[F];Ka($,!1);const q=Lx(N,k,$,l);Pa()&&Bn(N,k,q,$),Qs(q,k),$g(k,k[F]=wx(q,k,q,$)),Ga($)&&Sp(N,k,$),null!=E&&Bg(k,$,T)}let Lx=function Ku(l,u,p,m){return $r(!0),u[ar].createComment("")};function nm(l){return function vu(l,u){return l[u]}(function yg(){return lr.lFrame.contextLView}(),Yn+l)}function La(l,u,p){const m=Me();return xr(m,Id(),u)&&function ll(l,u,p,m,v,C,E,T){const k=Jo(u,p);let F,N=u.inputs;!T&&null!=N&&(F=N[m])?(Av(l,p,F,m,v),_l(u)&&function ff(l,u){const p=ua(u,l);16&p[Ye]||(p[Ye]|=64)}(p,u.index)):3&u.type&&(m=function Ap(l){return"class"===l?"className":"for"===l?"htmlFor":"formaction"===l?"formAction":"innerHtml"===l?"innerHTML":"readonly"===l?"readOnly":"tabindex"===l?"tabIndex":l}(m),v=null!=E?E(v,u.value||"",m):v,C.setProperty(k,m,v))}(ri(),Yi(),m,l,u,m[ar],p,!1),La}function Nx(l,u,p,m,v){const E=v?"class":"style";Av(l,p,u.inputs[E],E,m)}function bf(l,u,p,m){const v=Me(),C=ri(),E=Yn+l,T=v[ar],k=C.firstCreatePass?function Yu(l,u,p,m,v,C){const E=u.consts,k=df(u,l,2,m,Es(E,v));return Hw(u,p,k,Es(E,C)),null!==k.attrs&&qu(k,k.attrs,!1),null!==k.mergedAttrs&&qu(k,k.mergedAttrs,!0),null!==u.queries&&u.queries.elementStart(u,k),k}(E,C,v,u,p,m):C.data[E],N=Y_(C,v,k,T,u,l);v[E]=N;const F=Ga(k);return Ka(k,!0),Nu(T,N,k),32!=(32&k.flags)&&Pa()&&Bn(C,v,N,k),0===function xu(){return lr.lFrame.elementDepthCount}()&&Qs(N,v),function Dh(){lr.lFrame.elementDepthCount++}(),F&&(Sp(C,v,k),N_(C,k,v)),null!==m&&Bg(v,k),bf}function fc(){let l=fs();kh()?function ip(){lr.lFrame.isParent=!1}():(l=l.parent,Ka(l,!1));const u=l;(function Sc(l){return lr.skipHydrationRootTNode===l})(u)&&function np(){lr.skipHydrationRootTNode=null}(),function Wy(){lr.lFrame.elementDepthCount--}();const p=ri();return p.firstCreatePass&&(Yl(p,l),du(l)&&p.queries.elementEnd(l)),null!=u.classesWithoutHost&&function Nh(l){return 0!=(8&l.flags)}(u)&&Nx(p,u,Me(),u.classesWithoutHost,!0),null!=u.stylesWithoutHost&&function Fh(l){return 0!=(16&l.flags)}(u)&&Nx(p,u,Me(),u.stylesWithoutHost,!1),fc}function Up(l,u,p,m){return bf(l,u,p,m),fc(),Up}let Y_=(l,u,p,m,v,C)=>($r(!0),O0(m,v,function Je(){return lr.lFrame.currentNamespace}()));function oE(){return Me()}function qv(l){return!!l&&"function"==typeof l.then}function rm(l){return!!l&&"function"==typeof l.subscribe}function Dl(l,u,p,m){const v=Me(),C=ri(),E=fs();return function Bx(l,u,p,m,v,C,E){const T=Ga(m),N=l.firstCreatePass&&Sv(l),F=u[ko],$=Zw(u);let q=!0;if(3&m.type||E){const K=Jo(m,u),J=E?E(K):K,st=$.length,ot=E?ct=>E(zi(ct[m.index])):m.index;let rt=null;if(!E&&T&&(rt=function zx(l,u,p,m){const v=l.cleanup;if(null!=v)for(let C=0;C<v.length-1;C+=2){const E=v[C];if(E===p&&v[C+1]===m){const T=u[ni],k=v[C+2];return T.length>k?T[k]:null}"string"==typeof E&&(C+=2)}return null}(l,u,v,m.index)),null!==rt)(rt.__ngLastListenerFn__||rt).__ngNextListenerFn__=C,rt.__ngLastListenerFn__=C,q=!1;else{C=Ux(m,u,F,C,!1);const ct=p.listen(J,v,C);$.push(C,ct),N&&N.push(v,ot,st,st+1)}}else C=Ux(m,u,F,C,!1);const Z=m.outputs;let X;if(q&&null!==Z&&(X=Z[v])){const K=X.length;if(K)for(let J=0;J<K;J+=2){const yt=u[X[J]][X[J+1]].subscribe(C),Ot=$.length;$.push(C,yt),N&&N.push(v,m.index,Ot,-(Ot+1))}}}(C,v,v[ar],E,l,u,m),Dl}function Jd(l,u,p,m){try{return hs(6,u,p),!1!==p(m)}catch(v){return Mx(l,v),!1}finally{hs(7,u,p)}}function Ux(l,u,p,m,v){return function C(E){if(E===Function)return m;Ip(l.componentOffset>-1?ua(l.index,u):u);let k=Jd(u,p,m,E),N=C.__ngNextListenerFn__;for(;N;)k=Jd(u,p,N,E)&&k,N=N.__ngNextListenerFn__;return v&&!1===k&&E.preventDefault(),k}}function Vx(l=1){return function ql(l){return(lr.lFrame.contextLView=function bg(l,u){for(;l>0;)u=u[ba],l--;return u}(l,lr.lFrame.contextLView))[ko]}(l)}function Yv(l,u){return l<<17|u<<2}function th(l){return l>>17&32767}function bi(l){return 2|l}function pc(l){return(131068&l)>>2}function hl(l,u){return-131069&l|u<<2}function Qu(l){return 1|l}function $x(l,u,p,m,v){const C=l[p+1],E=null===u;let T=m?th(C):pc(C),k=!1;for(;0!==T&&(!1===k||E);){const F=l[T+1];lE(l[T],u)&&(k=!0,l[T+1]=m?Qu(F):bi(F)),T=m?th(F):pc(F)}k&&(l[p+1]=m?bi(C):Qu(C))}function lE(l,u){return null===l||null==u||(Array.isArray(l)?l[1]:l)===u||!(!Array.isArray(l)||"string"!=typeof u)&&z(l,u)>=0}function fC(l,u){return function Wc(l,u,p,m){const v=Me(),C=ri(),E=Ca(2);C.firstUpdatePass&&function dE(l,u,p,m){const v=l.data;if(null===v[p+1]){const C=v[ro()],E=function gC(l,u){return u>=l.expandoStartIndex}(l,p);(function Mf(l,u){return 0!=(l.flags&(u?8:16))})(C,m)&&null===u&&!E&&(u=!1),u=function hE(l,u,p,m){const v=function Ma(l){const u=lr.lFrame.currentDirectiveIndex;return-1===u?null:l[u]}(l);let C=m?u.residualClasses:u.residualStyles;if(null===v)0===(m?u.classBindings:u.styleBindings)&&(p=sh(p=oh(null,l,u,p,m),u.attrs,m),C=null);else{const E=u.directiveStylingLast;if(-1===E||l[E]!==v)if(p=oh(v,l,u,p,m),null===C){let k=function RT(l,u,p){const m=p?u.classBindings:u.styleBindings;if(0!==pc(m))return l[th(m)]}(l,u,m);void 0!==k&&Array.isArray(k)&&(k=oh(null,l,u,k[1],m),k=sh(k,u.attrs,m),function LT(l,u,p,m){l[th(p?u.classBindings:u.styleBindings)]=m}(l,u,m,k))}else C=function NT(l,u,p){let m;const v=u.directiveEnd;for(let C=1+u.directiveStylingLast;C<v;C++)m=sh(m,l[C].hostAttrs,p);return sh(m,u.attrs,p)}(l,u,m)}return void 0!==C&&(m?u.residualClasses=C:u.residualStyles=C),p}(v,C,u,m),function Qv(l,u,p,m,v,C){let E=C?u.classBindings:u.styleBindings,T=th(E),k=pc(E);l[m]=p;let F,N=!1;if(Array.isArray(p)?(F=p[1],(null===F||z(p,F)>0)&&(N=!0)):F=p,v)if(0!==k){const q=th(l[T+1]);l[m+1]=Yv(q,T),0!==q&&(l[q+1]=hl(l[q+1],m)),l[T+1]=function Vp(l,u){return 131071&l|u<<17}(l[T+1],m)}else l[m+1]=Yv(T,0),0!==T&&(l[T+1]=hl(l[T+1],m)),T=m;else l[m+1]=Yv(k,0),0===T?T=m:l[k+1]=hl(l[k+1],m),k=m;N&&(l[m+1]=bi(l[m+1])),$x(l,F,m,!0),$x(l,F,m,!1),function aE(l,u,p,m,v){const C=v?l.residualClasses:l.residualStyles;null!=C&&"string"==typeof u&&z(C,u)>=0&&(p[m+1]=Qu(p[m+1]))}(u,F,l,m,C),E=Yv(T,k),C?u.classBindings=E:u.styleBindings=E}(v,C,u,p,E,m)}}(C,l,E,m),u!==An&&xr(v,E,u)&&function mC(l,u,p,m,v,C,E,T){if(!(3&u.type))return;const k=l.data,N=k[T+1],F=function Xu(l){return 1==(1&l)}(N)?mE(k,u,p,v,pc(N),E):void 0;sm(F)||(sm(C)||function Xv(l){return 2==(2&l)}(N)&&(C=mE(k,null,p,v,T,E)),function jn(l,u,p,m,v){if(u)v?l.addClass(p,m):l.removeClass(p,m);else{let C=-1===m.indexOf("-")?void 0:yw.DashCase;null==v?l.removeStyle(p,m,C):("string"==typeof v&&v.endsWith("!important")&&(v=v.slice(0,-10),C|=yw.Important),l.setStyle(p,m,v,C))}}(m,E,_u(ro(),p),v,C))}(C,C.data[ro()],v,v[ar],l,v[E+1]=function qx(l,u){return null==l||""===l||("string"==typeof u?l+=u:"object"==typeof l&&(l=We(Yh(l)))),l}(u,p),m,E)}(l,u,null,!0),fC}function oh(l,u,p,m,v){let C=null;const E=p.directiveEnd;let T=p.directiveStylingLast;for(-1===T?T=p.directiveStart:T++;T<E&&(C=u[T],m=sh(m,C.hostAttrs,v),C!==l);)T++;return null!==l&&(p.directiveStylingLast=T),m}function sh(l,u,p){const m=p?1:2;let v=-1;if(null!==u)for(let C=0;C<u.length;C++){const E=u[C];"number"==typeof E?v=E:v===m&&(Array.isArray(l)||(l=void 0===l?[]:["",l]),Xs(l,E,!!p||u[++C]))}return void 0===l?null:l}function mE(l,u,p,m,v,C){const E=null===u;let T;for(;v>0;){const k=l[v],N=Array.isArray(k),F=N?k[1]:k,$=null===F;let q=p[v+1];q===An&&(q=$?zr:void 0);let Z=$?s_(q,m):F===m?q:void 0;if(N&&!sm(Z)&&(Z=s_(k,m)),sm(Z)&&(T=Z,E))return T;const X=l[v+1];v=E?th(X):pc(X)}if(null!==u){let k=C?u.residualClasses:u.residualStyles;null!=k&&(T=s_(k,m))}return T}function sm(l){return void 0!==l}function $p(l,u=""){const p=Me(),m=ri(),v=l+Yn,C=m.firstCreatePass?df(m,v,1,u,null):m.data[v],E=Gp(m,p,C,u,l);p[v]=E,Pa()&&Bn(m,p,E,C),Ka(C,!1)}let Gp=(l,u,p,m,v)=>($r(!0),function P0(l,u){return l.createText(u)}(u[ar],m));function am(l){return Gn("",l,""),am}function Gn(l,u,p){const m=Me(),v=function Wd(l,u,p,m){return xr(l,Id(),p)?u+ge(p)+m:An}(m,l,u,p);return v!==An&&Gd(m,ro(),v),Gn}function lm(l,u,p,m,v){const C=Me(),E=Kd(C,l,u,p,m,v);return E!==An&&Gd(C,ro(),E),lm}const os=void 0;var ab=["en",[["a","p"],["AM","PM"],os],[["AM","PM"],os,os],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],os,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],os,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",os,"{1} 'at' {0}",os],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function yE(l){const p=Math.floor(Math.abs(l)),m=l.toString().replace(/^[^.]*\.?/,"").length;return 1===p&&0===m?1:5}];let ah={};function td(l){const u=function CC(l){return l.toLowerCase().replace(/_/g,"-")}(l);let p=_c(u);if(p)return p;const m=u.split("-")[0];if(p=_c(m),p)return p;if("en"===m)return ab;throw new Gt(701,!1)}function ay(l){return td(l)[Yc.PluralCase]}function _c(l){return l in ah||(ah[l]=Ar.ng&&Ar.ng.common&&Ar.ng.common.locales&&Ar.ng.common.locales[l]),ah[l]}var Yc=function(l){return l[l.LocaleId=0]="LocaleId",l[l.DayPeriodsFormat=1]="DayPeriodsFormat",l[l.DayPeriodsStandalone=2]="DayPeriodsStandalone",l[l.DaysFormat=3]="DaysFormat",l[l.DaysStandalone=4]="DaysStandalone",l[l.MonthsFormat=5]="MonthsFormat",l[l.MonthsStandalone=6]="MonthsStandalone",l[l.Eras=7]="Eras",l[l.FirstDayOfWeek=8]="FirstDayOfWeek",l[l.WeekendRange=9]="WeekendRange",l[l.DateFormat=10]="DateFormat",l[l.TimeFormat=11]="TimeFormat",l[l.DateTimeFormat=12]="DateTimeFormat",l[l.NumberSymbols=13]="NumberSymbols",l[l.NumberFormats=14]="NumberFormats",l[l.CurrencyCode=15]="CurrencyCode",l[l.CurrencySymbol=16]="CurrencySymbol",l[l.CurrencyName=17]="CurrencyName",l[l.Currencies=18]="Currencies",l[l.Directionality=19]="Directionality",l[l.PluralCase=20]="PluralCase",l[l.ExtraData=21]="ExtraData",l}(Yc||{});const Of="en-US";let bE=Of;function Mb(l,u,p,m,v){if(l=Ce(l),Array.isArray(l))for(let C=0;C<l.length;C++)Mb(l[C],u,p,m,v);else{const C=ri(),E=Me(),T=fs();let k=xp(l)?l:Ce(l.provide);const N=Vc(l),F=1048575&T.providerIndexes,$=T.directiveStart,q=T.providerIndexes>>20;if(xp(l)||!l.multi){const Z=new Lh(N,v,oi),X=Pb(k,u,v?F:F+q,$);-1===X?(Ld(Cl(T,E),C,k),mm(C,l,u.length),u.push(k),T.directiveStart++,T.directiveEnd++,v&&(T.providerIndexes+=1048576),p.push(Z),E.push(Z)):(p[X]=Z,E[X]=Z)}else{const Z=Pb(k,u,F+q,$),X=Pb(k,u,F,F+q),J=X>=0&&p[X];if(v&&!J||!v&&!(Z>=0&&p[Z])){Ld(Cl(T,E),C,k);const st=function rd(l,u,p,m,v){const C=new Lh(l,p,oi);return C.multi=[],C.index=u,C.componentProviders=0,gy(C,v,m&&!p),C}(v?g1:LC,p.length,v,m,N);!v&&J&&(p[X].providerFactory=st),mm(C,l,u.length,0),u.push(k),T.directiveStart++,T.directiveEnd++,v&&(T.providerIndexes+=1048576),p.push(st),E.push(st)}else mm(C,l,Z>-1?Z:X,gy(p[v?X:Z],N,!v&&m));!v&&m&&J&&p[X].componentProviders++}}}function mm(l,u,p,m){const v=xp(u),C=function sl(l){return!!l.useClass}(u);if(v||C){const k=(C?Ce(u.useClass):u).prototype.ngOnDestroy;if(k){const N=l.destroyHooks||(l.destroyHooks=[]);if(!v&&u.multi){const F=N.indexOf(p);-1===F?N.push(p,[m,k]):N[F+1].push(m,k)}else N.push(p,k)}}}function gy(l,u,p){return p&&l.componentProviders++,l.multi.push(u)-1}function Pb(l,u,p,m){for(let v=p;v<m;v++)if(u[v]===l)return v;return-1}function LC(l,u,p,m){return nd(this.multi,[])}function g1(l,u,p,m){const v=this.multi;let C;if(this.providerFactory){const E=this.providerFactory.componentProviders,T=Fd(p,p[dn],this.providerFactory.index,m);C=T.slice(0,E),nd(v,C);for(let k=E;k<T.length;k++)C.push(T[k])}else C=[],nd(v,C);return C}function nd(l,u){for(let p=0;p<l.length;p++)u.push((0,l[p])());return u}function m1(l,u=[]){return p=>{p.providersResolver=(m,v)=>function py(l,u,p){const m=ri();if(m.firstCreatePass){const v=la(l);Mb(p,m.data,m.blueprint,v,!0),Mb(u,m.data,m.blueprint,v,!1)}}(m,v?v(l):l,u)}}class Kp{}class Eb{}function ZT(l,u){return new NC(l,u??null,[])}class NC extends Kp{constructor(u,p,m){super(),this._parent=p,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Vo(this);const v=Do(u);this._bootstrapComponents=_a(v.bootstrap),this._r3Injector=pi(u,p,[{provide:Kp,useValue:this},{provide:mv,useValue:this.componentFactoryResolver},...m],We(u),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(u)}get injector(){return this._r3Injector}destroy(){const u=this._r3Injector;!u.destroyed&&u.destroy(),this.destroyCbs.forEach(p=>p()),this.destroyCbs=null}onDestroy(u){this.destroyCbs.push(u)}}class Ob extends Eb{constructor(u){super(),this.moduleType=u}create(u){return new NC(this.moduleType,u,[])}}class _m extends Kp{constructor(u){super(),this.componentFactoryResolver=new Vo(this),this.instance=null;const p=new tf([...u.providers,{provide:Kp,useValue:this},{provide:mv,useValue:this.componentFactoryResolver}],u.parent||uv(),u.debugName,new Set(["environment"]));this.injector=p,u.runEnvironmentInitializers&&p.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(u){this.injector.onDestroy(u)}}function _1(l,u,p=null){return new _m({providers:l,parent:u,debugName:p,runEnvironmentInitializers:!0}).injector}let my=(()=>{class l{constructor(p){this._injector=p,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(p){if(!p.standalone)return null;if(!this.cachedInjectors.has(p)){const m=Dg(0,p.type),v=m.length>0?_1([m],this._injector,`Standalone[${p.type.name}]`):null;this.cachedInjectors.set(p,v)}return this.cachedInjectors.get(p)}ngOnDestroy(){try{for(const p of this.cachedInjectors.values())null!==p&&p.destroy()}finally{this.cachedInjectors.clear()}}static#t=this.\u0275prov=nt({token:l,providedIn:"environment",factory:()=>new l(ir(Ii))})}return l})();function y1(l){l.getStandaloneInjector=u=>u.get(my).getOrCreateStandaloneInjector(l)}function Xp(l,u,p,m){return function O1(l,u,p,m,v,C){const E=u+p;return xr(l,E,v)?function Zd(l,u,p){return l[u]=p}(l,E+1,C?m.call(C,v):m(v)):function Af(l,u){const p=l[u];return p===An?void 0:p}(l,E+1)}(Me(),function Ls(){const l=lr.lFrame;let u=l.bindingRootIndex;return-1===u&&(u=l.bindingRootIndex=l.tView.bindingStartIndex),u}(),l,u,p,m)}function vm(){return this._results[Symbol.iterator]()}class kb{static#t=Symbol.iterator;get changes(){return this._changes||(this._changes=new Ei)}constructor(u=!1){this._emitDistinctChangesOnly=u,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const p=kb.prototype;p[Symbol.iterator]||(p[Symbol.iterator]=vm)}get(u){return this._results[u]}map(u){return this._results.map(u)}filter(u){return this._results.filter(u)}find(u){return this._results.find(u)}reduce(u,p){return this._results.reduce(u,p)}forEach(u){this._results.forEach(u)}some(u){return this._results.some(u)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(u,p){const m=this;m.dirty=!1;const v=function _o(l){return l.flat(Number.POSITIVE_INFINITY)}(u);(this._changesDetected=!function Oa(l,u,p){if(l.length!==u.length)return!1;for(let m=0;m<l.length;m++){let v=l[m],C=u[m];if(p&&(v=p(v),C=p(C)),C!==v)return!1}return!0}(m._results,v,p))&&(m._results=v,m.length=v.length,m.last=v[this.length-1],m.first=v[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function YT(l,u,p,m=!0){const v=u[dn];if(function qh(l,u,p,m){const v=Fi+m,C=p.length;m>0&&(p[v-1][Cs]=u),m<C-Fi?(u[Cs]=p[v],Ta(p,Fi+m,u)):(p.push(u),u[Cs]=null),u[Ai]=p;const E=u[cu];null!==E&&p!==E&&function _P(l,u){const p=l[Bl];u[Zi]!==u[Ai][Ai][Zi]&&(l[gd]=!0),null===p?l[Bl]=[u]:p.push(u)}(E,u);const T=u[fo];null!==T&&T.insertView(l),u[Ye]|=128}(v,u,l,p),m){const C=S0(p,l),E=u[ar],T=Ig(E,l[Ms]);null!==T&&function Xi(l,u,p,m,v,C){m[Jr]=v,m[Zr]=u,m_(l,m,p,1,v,C)}(v,l[Zr],E,u,T,C)}}let bm=(()=>{class l{static#t=this.__NG_ELEMENT_ID__=Rb}return l})();const GC=bm,KE=class extends GC{constructor(u,p,m){super(),this._declarationLView=u,this._declarationTContainer=p,this.elementRef=m}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(u,p){return this.createEmbeddedViewImpl(u,p)}createEmbeddedViewImpl(u,p,m){const v=function S1(l,u,p,m){const v=u.tView,T=hn(l,v,p,4096&l[Ye]?4096:16,null,u,null,null,null,m?.injector??null,m?.hydrationInfo??null);T[cu]=l[u.index];const N=l[fo];return null!==N&&(T[fo]=N.createEmbeddedView(v)),Px(v,T,p),T}(this._declarationLView,this._declarationTContainer,u,{injector:p,hydrationInfo:m});return new kv(v)}};function Rb(){return xm(fs(),Me())}function xm(l,u){return 4&l.type?new KE(u,l,Uu(l,u)):null}let hh=(()=>{class l{static#t=this.__NG_ELEMENT_ID__=JE}return l})();function JE(){return k1(fs(),Me())}const qC=hh,Nb=class extends qC{constructor(u,p,m){super(),this._lContainer=u,this._hostTNode=p,this._hostLView=m}get element(){return Uu(this._hostTNode,this._hostLView)}get injector(){return new es(this._hostTNode,this._hostLView)}get parentInjector(){const u=Tu(this._hostTNode,this._hostLView);if(ha(u)){const p=Xa(u,this._hostLView),m=Xl(u);return new es(p[dn].data[m+8],p)}return new es(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(u){const p=Cm(this._lContainer);return null!==p&&p[u]||null}get length(){return this._lContainer.length-Fi}createEmbeddedView(u,p,m){let v,C;"number"==typeof m?v=m:null!=m&&(v=m.index,C=m.injector);const T=u.createEmbeddedViewImpl(p||{},C,null);return this.insertImpl(T,v,false),T}createComponent(u,p,m,v,C){const E=u&&!function oo(l){return"function"==typeof l}(u);let T;if(E)T=p;else{const K=p||{};T=K.index,m=K.injector,v=K.projectableNodes,C=K.environmentInjector||K.ngModuleRef}const k=E?u:new qd(Wn(u)),N=m||this.parentInjector;if(!C&&null==k.ngModule){const J=(E?N:this.parentInjector).get(Ii,null);J&&(C=J)}Wn(k.componentType??{});const Z=k.create(N,v,null,C);return this.insertImpl(Z.hostView,T,false),Z}insert(u,p){return this.insertImpl(u,p,!1)}insertImpl(u,p,m){const v=u._lView;if(function mo(l){return Un(l[Ai])}(v)){const k=this.indexOf(u);if(-1!==k)this.detach(k);else{const N=v[Ai],F=new Nb(N,N[Zr],N[Ai]);F.detach(F.indexOf(u))}}const E=this._adjustIndex(p),T=this._lContainer;return YT(T,v,E,!m),u.attachToViewContainerRef(),Ta(kl(T),E,u),u}move(u,p){return this.insert(u,p)}indexOf(u){const p=Cm(this._lContainer);return null!==p?p.indexOf(u):-1}remove(u){const p=this._adjustIndex(u,-1),m=f_(this._lContainer,p);m&&(Au(kl(this._lContainer),p),Di(m[dn],m))}detach(u){const p=this._adjustIndex(u,-1),m=f_(this._lContainer,p);return m&&null!=Au(kl(this._lContainer),p)?new kv(m):null}_adjustIndex(u,p=0){return u??this.length+p}};function Cm(l){return l[8]}function kl(l){return l[8]||(l[8]=[])}function k1(l,u){let p;const m=u[l.index];return Un(m)?p=m:(p=wx(m,u,null,l),u[l.index]=p,$g(u,p)),vc(p,u,l,m),new Nb(p,l,u)}let vc=function eO(l,u,p,m){if(l[Ms])return;let v;v=8&p.type?zi(m):function tO(l,u){const p=l[ar],m=p.createComment(""),v=Jo(u,l);return fi(p,Ig(p,v),m,function ui(l,u){return l.nextSibling(u)}(p,v),!1),m}(u,p),l[Ms]=v};class Fb{constructor(u){this.queryList=u,this.matches=null}clone(){return new Fb(this.queryList)}setDirty(){this.queryList.setDirty()}}class vy{constructor(u=[]){this.queries=u}createEmbeddedView(u){const p=u.queries;if(null!==p){const m=null!==u.contentQueries?u.contentQueries[0]:p.length,v=[];for(let C=0;C<m;C++){const E=p.getByIndex(C);v.push(this.queries[E.indexInDeclarationView].clone())}return new vy(v)}return null}insertView(u){this.dirtyQueriesWithMatches(u)}detachView(u){this.dirtyQueriesWithMatches(u)}dirtyQueriesWithMatches(u){for(let p=0;p<this.queries.length;p++)null!==wy(u,p).matches&&this.queries[p].setDirty()}}class by{constructor(u,p,m=null){this.predicate=u,this.flags=p,this.read=m}}class Mm{constructor(u=[]){this.queries=u}elementStart(u,p){for(let m=0;m<this.queries.length;m++)this.queries[m].elementStart(u,p)}elementEnd(u){for(let p=0;p<this.queries.length;p++)this.queries[p].elementEnd(u)}embeddedTView(u){let p=null;for(let m=0;m<this.length;m++){const v=null!==p?p.length:0,C=this.getByIndex(m).embeddedTView(u,v);C&&(C.indexInDeclarationView=m,null!==p?p.push(C):p=[C])}return null!==p?new Mm(p):null}template(u,p){for(let m=0;m<this.queries.length;m++)this.queries[m].template(u,p)}getByIndex(u){return this.queries[u]}get length(){return this.queries.length}track(u){this.queries.push(u)}}class KC{constructor(u,p=-1){this.metadata=u,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=p}elementStart(u,p){this.isApplyingToNode(p)&&this.matchTNode(u,p)}elementEnd(u){this._declarationNodeIndex===u.index&&(this._appliesToNextNode=!1)}template(u,p){this.elementStart(u,p)}embeddedTView(u,p){return this.isApplyingToNode(u)?(this.crossesNgTemplate=!0,this.addMatch(-u.index,p),new KC(this.metadata)):null}isApplyingToNode(u){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const p=this._declarationNodeIndex;let m=u.parent;for(;null!==m&&8&m.type&&m.index!==p;)m=m.parent;return p===(null!==m?m.index:-1)}return this._appliesToNextNode}matchTNode(u,p){const m=this.metadata.predicate;if(Array.isArray(m))for(let v=0;v<m.length;v++){const C=m[v];this.matchTNodeWithReadOption(u,p,YC(p,C)),this.matchTNodeWithReadOption(u,p,Ja(p,u,C,!1,!1))}else m===bm?4&p.type&&this.matchTNodeWithReadOption(u,p,-1):this.matchTNodeWithReadOption(u,p,Ja(p,u,m,!1,!1))}matchTNodeWithReadOption(u,p,m){if(null!==m){const v=this.metadata.read;if(null!==v)if(v===Lg||v===hh||v===bm&&4&p.type)this.addMatch(p.index,-2);else{const C=Ja(p,u,v,!1,!1);null!==C&&this.addMatch(p.index,C)}else this.addMatch(p.index,m)}}addMatch(u,p){null===this.matches?this.matches=[u,p]:this.matches.push(u,p)}}function YC(l,u){const p=l.localNames;if(null!==p)for(let m=0;m<p.length;m+=2)if(p[m]===u)return p[m+1];return null}function R1(l,u,p,m){return-1===p?function nO(l,u){return 11&l.type?Uu(l,u):4&l.type?xm(l,u):null}(u,l):-2===p?function L1(l,u,p){return p===Lg?Uu(u,l):p===bm?xm(u,l):p===hh?k1(u,l):void 0}(l,u,m):Fd(l,l[dn],p,u)}function rO(l,u,p,m){const v=u[fo].queries[m];if(null===v.matches){const C=l.data,E=p.matches,T=[];for(let k=0;k<E.length;k+=2){const N=E[k];T.push(N<0?null:R1(u,C[N],E[k+1],p.metadata.read))}v.matches=T}return v.matches}function xy(l,u,p,m){const v=l.queries.getByIndex(p),C=v.matches;if(null!==C){const E=rO(l,u,v,p);for(let T=0;T<C.length;T+=2){const k=C[T];if(k>0)m.push(E[T/2]);else{const N=C[T+1],F=u[-k];for(let $=Fi;$<F.length;$++){const q=F[$];q[cu]===q[Ai]&&xy(q[dn],q,N,m)}if(null!==F[Bl]){const $=F[Bl];for(let q=0;q<$.length;q++){const Z=$[q];xy(Z[dn],Z,N,m)}}}}}return m}function N1(l){const u=Me(),p=ri(),m=Wr();da(m+1);const v=wy(p,m);if(l.dirty&&function Ic(l){return 4==(4&l[Ye])}(u)===(2==(2&v.metadata.flags))){if(null===v.matches)l.reset([]);else{const C=v.crossesNgTemplate?xy(p,u,m,[]):rO(p,u,v,m);l.reset(C,_v),l.notifyOnChanges()}return!0}return!1}function iO(l,u,p){const m=ri();m.firstCreatePass&&(zb(m,new by(l,u,p),-1),2==(2&u)&&(m.staticViewQueries=!0)),oO(m,Me(),u)}function F1(l,u,p,m){const v=ri();if(v.firstCreatePass){const C=fs();zb(v,new by(u,p,m),C.index),function sO(l,u){const p=l.contentQueries||(l.contentQueries=[]);u!==(p.length?p[p.length-1]:-1)&&p.push(l.queries.length-1,u)}(v,l),2==(2&p)&&(v.staticContentQueries=!0)}oO(v,Me(),p)}function z1(){return function XC(l,u){return l[fo].queries[u].queryList}(Me(),Wr())}function oO(l,u,p){const m=new kb(4==(4&p));(function qt(l,u,p,m){const v=Zw(u);v.push(p),l.firstCreatePass&&Sv(l).push(m,v.length-1)})(l,u,m,m.destroy),null===u[fo]&&(u[fo]=new vy),u[fo].queries.push(new Fb(m))}function zb(l,u,p){null===l.queries&&(l.queries=new Mm),l.queries.track(new KC(u,p))}function wy(l,u){return l.queries.getByIndex(u)}function QC(l,u){return xm(l,u)}function Em(l){return!!Do(l)}const cM=new er("Application Initializer");let gO=(()=>{class l{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((p,m)=>{this.resolve=p,this.reject=m}),this.appInits=or(cM,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const p=[];for(const v of this.appInits){const C=v();if(qv(C))p.push(C);else if(rm(C)){const E=new Promise((T,k)=>{C.subscribe({complete:T,error:k})});p.push(E)}}const m=()=>{this.done=!0,this.resolve()};Promise.all(p).then(()=>{m()}).catch(v=>{this.reject(v)}),0===p.length&&m(),this.initialized=!0}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})(),mO=(()=>{class l{log(p){console.log(p)}warn(p){console.warn(p)}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"platform"})}return l})();const uM=new er("LocaleId",{providedIn:"root",factory:()=>or(uM,yn.Optional|yn.SkipSelf)||function FS(){return typeof $localize<"u"&&$localize.locale||Of}()}),zS=new er("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let Oy=(()=>{class l{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new lt.X(!1)}add(){this.hasPendingTasks.next(!0);const p=this.taskId++;return this.pendingTasks.add(p),p}remove(p){this.pendingTasks.delete(p),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();class aI{constructor(u,p){this.ngModuleFactory=u,this.componentFactories=p}}let Sm=(()=>{class l{compileModuleSync(p){return new Ob(p)}compileModuleAsync(p){return Promise.resolve(this.compileModuleSync(p))}compileModuleAndAllComponentsSync(p){const m=this.compileModuleSync(p),C=_a(Do(p).declarations).reduce((E,T)=>{const k=Wn(T);return k&&E.push(new qd(k)),E},[]);return new aI(m,C)}compileModuleAndAllComponentsAsync(p){return Promise.resolve(this.compileModuleAndAllComponentsSync(p))}clearCache(){}clearCacheFor(p){}getModuleId(p){}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();const wO=new er(""),qb=new er("");let CO,kf=(()=>{class l{constructor(p,m,v){this._ngZone=p,this.registry=m,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,CO||(function Zb(l){CO=l}(v),v.addToWindow(m)),this._watchAngularEvents(),p.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Wo.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let p=this._callbacks.pop();clearTimeout(p.timeoutId),p.doneCb(this._didWork)}this._didWork=!1});else{let p=this.getPendingTasks();this._callbacks=this._callbacks.filter(m=>!m.updateCb||!m.updateCb(p)||(clearTimeout(m.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(p=>({source:p.source,creationLocation:p.creationLocation,data:p.data})):[]}addCallback(p,m,v){let C=-1;m&&m>0&&(C=setTimeout(()=>{this._callbacks=this._callbacks.filter(E=>E.timeoutId!==C),p(this._didWork,this.getPendingTasks())},m)),this._callbacks.push({doneCb:p,timeoutId:C,updateCb:v})}whenStable(p,m,v){if(v&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(p,m,v),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(p){this.registry.registerApplication(p,this)}unregisterApplication(p){this.registry.unregisterApplication(p)}findProviders(p,m,v){return[]}static#t=this.\u0275fac=function(m){return new(m||l)(ir(Wo),ir(_M),ir(qb))};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac})}return l})(),_M=(()=>{class l{constructor(){this._applications=new Map}registerApplication(p,m){this._applications.set(p,m)}unregisterApplication(p){this._applications.delete(p)}unregisterAllApplications(){this._applications.clear()}getTestability(p){return this._applications.get(p)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(p,m=!0){return CO?.findTestabilityInTree(this,p,m)??null}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"platform"})}return l})(),eu=null;const fI=new er("AllowMultipleToken"),tg=new er("PlatformDestroyListeners"),yM=new er("appBootstrapListener");class VS{constructor(u,p){this.name=u,this.token=p}}function Kb(l,u,p=[]){const m=`Platform: ${u}`,v=new er(m);return(C=[])=>{let E=Yb();if(!E||E.injector.get(fI,!1)){const T=[...p,...C,{provide:v,useValue:!0}];l?l(T):function Rf(l){if(eu&&!eu.get(fI,!1))throw new Gt(400,!1);(function PO(){!function Oh(l){Eh=l}(()=>{throw new Gt(600,!1)})})(),eu=l;const u=l.get(vM);(function EO(l){l.get(hv,null)?.forEach(p=>p())})(l)}(function pI(l=[],u){return ac.create({name:u,providers:[{provide:Jh,useValue:"platform"},{provide:tg,useValue:new Set([()=>eu=null])},...l]})}(T,m))}return function jS(l){const u=Yb();if(!u)throw new Gt(401,!1);return u}()}}function Yb(){return eu?.get(vM)??null}let vM=(()=>{class l{constructor(p){this._injector=p,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(p,m){const v=function TO(l="zone.js",u){return"noop"===l?new Bw:"zone.js"===l?new Wo(u):l}(m?.ngZone,function Lf(l){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:l?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:l?.runCoalescing??!1}}({eventCoalescing:m?.ngZoneEventCoalescing,runCoalescing:m?.ngZoneRunCoalescing}));return v.run(()=>{const C=function Tb(l,u,p){return new NC(l,u,p)}(p.moduleType,this.injector,function eg(l){return[{provide:Wo,useFactory:l},{provide:Qh,multi:!0,useFactory:()=>{const u=or(Q1,{optional:!0});return()=>u.initialize()}},{provide:gI,useFactory:mI},{provide:Uw,useFactory:$c}]}(()=>v)),E=C.injector.get(Vu,null);return v.runOutsideAngular(()=>{const T=v.onError.subscribe({next:k=>{E.handleError(k)}});C.onDestroy(()=>{X1(this._modules,C),T.unsubscribe()})}),function bM(l,u,p){try{const m=p();return qv(m)?m.catch(v=>{throw u.runOutsideAngular(()=>l.handleError(v)),v}):m}catch(m){throw u.runOutsideAngular(()=>l.handleError(m)),m}}(E,v,()=>{const T=C.injector.get(gO);return T.runInitializers(),T.donePromise.then(()=>(function Jx(l){Tn(l,"Expected localeId to be defined"),"string"==typeof l&&(bE=l.toLowerCase().replace(/_/g,"-"))}(C.injector.get(uM,Of)||Of),this._moduleDoBootstrap(C),C))})})}bootstrapModule(p,m=[]){const v=IO({},m);return function MO(l,u,p){const m=new Ob(p);return Promise.resolve(m)}(0,0,p).then(C=>this.bootstrapModuleFactory(C,v))}_moduleDoBootstrap(p){const m=p.injector.get(id);if(p._bootstrapComponents.length>0)p._bootstrapComponents.forEach(v=>m.bootstrap(v));else{if(!p.instance.ngDoBootstrap)throw new Gt(-403,!1);p.instance.ngDoBootstrap(m)}this._modules.push(p)}onDestroy(p){this._destroyListeners.push(p)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Gt(404,!1);this._modules.slice().forEach(m=>m.destroy()),this._destroyListeners.forEach(m=>m());const p=this._injector.get(tg,null);p&&(p.forEach(m=>m()),p.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#t=this.\u0275fac=function(m){return new(m||l)(ir(ac))};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"platform"})}return l})();function IO(l,u){return Array.isArray(u)?u.reduce(IO,l):{...l,...u}}let id=(()=>{class l{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=or(gI),this.zoneIsStable=or(Uw),this.componentTypes=[],this.components=[],this.isStable=or(Oy).hasPendingTasks.pipe((0,ue.w)(p=>p?(0,ye.of)(!1):this.zoneIsStable),function Yt(l,u=be.y){return l=l??Le,(0,Pt.e)((p,m)=>{let v,C=!0;p.subscribe((0,Et.x)(m,E=>{const T=u(E);(C||!l(v,T))&&(C=!1,v=T,m.next(E))}))})}(),(0,ke.B)()),this._injector=or(Ii)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(p,m){const v=p instanceof cx;if(!this._injector.get(gO).done)throw!v&&ho(p),new Gt(405,!1);let E;E=v?p:this._injector.get(mv).resolveComponentFactory(p),this.componentTypes.push(E.componentType);const T=function ky(l){return l.isBoundToModule}(E)?void 0:this._injector.get(Kp),N=E.create(ac.NULL,[],m||E.selector,T),F=N.location.nativeElement,$=N.injector.get(wO,null);return $?.registerApplication(F),N.onDestroy(()=>{this.detachView(N.hostView),X1(this.components,N),$?.unregisterApplication(F)}),this._loadComponent(N),N}tick(){if(this._runningTick)throw new Gt(101,!1);try{this._runningTick=!0;for(let p of this._views)p.detectChanges()}catch(p){this.internalErrorHandler(p)}finally{this._runningTick=!1}}attachView(p){const m=p;this._views.push(m),m.attachToAppRef(this)}detachView(p){const m=p;X1(this._views,m),m.detachFromAppRef()}_loadComponent(p){this.attachView(p.hostView),this.tick(),this.components.push(p);const m=this._injector.get(yM,[]);m.push(...this._bootstrapListeners),m.forEach(v=>v(p))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(p=>p()),this._views.slice().forEach(p=>p.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(p){return this._destroyListeners.push(p),()=>X1(this._destroyListeners,p)}destroy(){if(this._destroyed)throw new Gt(406,!1);const p=this._injector;p.destroy&&!p.destroyed&&p.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();function X1(l,u){const p=l.indexOf(u);p>-1&&l.splice(p,1)}const gI=new er("",{providedIn:"root",factory:()=>or(Vu).handleError.bind(void 0)});function mI(){const l=or(Wo),u=or(Vu);return p=>l.runOutsideAngular(()=>u.handleError(p))}let Q1=(()=>{class l{constructor(){this.zone=or(Wo),this.applicationRef=or(id)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();function Xb(){return!1}let Nf=(()=>{class l{static#t=this.__NG_ELEMENT_ID__=wM}return l})();function wM(l){return function GS(l,u,p){if(_l(l)&&!p){const m=ua(l.index,u);return new kv(m,m)}return 47&l.type?new kv(u[Zi],u):null}(fs(),Me(),16==(16&l))}class AO{constructor(){}supports(u){return ao(u)}create(u){return new ew(u)}}const OM=(l,u)=>u;class ew{constructor(u){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=u||OM}forEachItem(u){let p;for(p=this._itHead;null!==p;p=p._next)u(p)}forEachOperation(u){let p=this._itHead,m=this._removalsHead,v=0,C=null;for(;p||m;){const E=!m||p&&p.currentIndex<e0(m,v,C)?p:m,T=e0(E,v,C),k=E.currentIndex;if(E===m)v--,m=m._nextRemoved;else if(p=p._next,null==E.previousIndex)v++;else{C||(C=[]);const N=T-v,F=k-v;if(N!=F){for(let q=0;q<N;q++){const Z=q<C.length?C[q]:C[q]=0,X=Z+q;F<=X&&X<N&&(C[q]=Z+1)}C[E.previousIndex]=F-N}}T!==k&&u(E,T,k)}}forEachPreviousItem(u){let p;for(p=this._previousItHead;null!==p;p=p._nextPrevious)u(p)}forEachAddedItem(u){let p;for(p=this._additionsHead;null!==p;p=p._nextAdded)u(p)}forEachMovedItem(u){let p;for(p=this._movesHead;null!==p;p=p._nextMoved)u(p)}forEachRemovedItem(u){let p;for(p=this._removalsHead;null!==p;p=p._nextRemoved)u(p)}forEachIdentityChange(u){let p;for(p=this._identityChangesHead;null!==p;p=p._nextIdentityChange)u(p)}diff(u){if(null==u&&(u=[]),!ao(u))throw new Gt(900,!1);return this.check(u)?this:null}onDestroy(){}check(u){this._reset();let v,C,E,p=this._itHead,m=!1;if(Array.isArray(u)){this.length=u.length;for(let T=0;T<this.length;T++)C=u[T],E=this._trackByFn(T,C),null!==p&&Object.is(p.trackById,E)?(m&&(p=this._verifyReinsertion(p,C,E,T)),Object.is(p.item,C)||this._addIdentityChange(p,C)):(p=this._mismatch(p,C,E,T),m=!0),p=p._next}else v=0,function QP(l,u){if(Array.isArray(l))for(let p=0;p<l.length;p++)u(l[p]);else{const p=l[Symbol.iterator]();let m;for(;!(m=p.next()).done;)u(m.value)}}(u,T=>{E=this._trackByFn(v,T),null!==p&&Object.is(p.trackById,E)?(m&&(p=this._verifyReinsertion(p,T,E,v)),Object.is(p.item,T)||this._addIdentityChange(p,T)):(p=this._mismatch(p,T,E,v),m=!0),p=p._next,v++}),this.length=v;return this._truncate(p),this.collection=u,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let u;for(u=this._previousItHead=this._itHead;null!==u;u=u._next)u._nextPrevious=u._next;for(u=this._additionsHead;null!==u;u=u._nextAdded)u.previousIndex=u.currentIndex;for(this._additionsHead=this._additionsTail=null,u=this._movesHead;null!==u;u=u._nextMoved)u.previousIndex=u.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(u,p,m,v){let C;return null===u?C=this._itTail:(C=u._prev,this._remove(u)),null!==(u=null===this._unlinkedRecords?null:this._unlinkedRecords.get(m,null))?(Object.is(u.item,p)||this._addIdentityChange(u,p),this._reinsertAfter(u,C,v)):null!==(u=null===this._linkedRecords?null:this._linkedRecords.get(m,v))?(Object.is(u.item,p)||this._addIdentityChange(u,p),this._moveAfter(u,C,v)):u=this._addAfter(new vI(p,m),C,v),u}_verifyReinsertion(u,p,m,v){let C=null===this._unlinkedRecords?null:this._unlinkedRecords.get(m,null);return null!==C?u=this._reinsertAfter(C,u._prev,v):u.currentIndex!=v&&(u.currentIndex=v,this._addToMoves(u,v)),u}_truncate(u){for(;null!==u;){const p=u._next;this._addToRemovals(this._unlink(u)),u=p}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(u,p,m){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(u);const v=u._prevRemoved,C=u._nextRemoved;return null===v?this._removalsHead=C:v._nextRemoved=C,null===C?this._removalsTail=v:C._prevRemoved=v,this._insertAfter(u,p,m),this._addToMoves(u,m),u}_moveAfter(u,p,m){return this._unlink(u),this._insertAfter(u,p,m),this._addToMoves(u,m),u}_addAfter(u,p,m){return this._insertAfter(u,p,m),this._additionsTail=null===this._additionsTail?this._additionsHead=u:this._additionsTail._nextAdded=u,u}_insertAfter(u,p,m){const v=null===p?this._itHead:p._next;return u._next=v,u._prev=p,null===v?this._itTail=u:v._prev=u,null===p?this._itHead=u:p._next=u,null===this._linkedRecords&&(this._linkedRecords=new TM),this._linkedRecords.put(u),u.currentIndex=m,u}_remove(u){return this._addToRemovals(this._unlink(u))}_unlink(u){null!==this._linkedRecords&&this._linkedRecords.remove(u);const p=u._prev,m=u._next;return null===p?this._itHead=m:p._next=m,null===m?this._itTail=p:m._prev=p,u}_addToMoves(u,p){return u.previousIndex===p||(this._movesTail=null===this._movesTail?this._movesHead=u:this._movesTail._nextMoved=u),u}_addToRemovals(u){return null===this._unlinkedRecords&&(this._unlinkedRecords=new TM),this._unlinkedRecords.put(u),u.currentIndex=null,u._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=u,u._prevRemoved=null):(u._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=u),u}_addIdentityChange(u,p){return u.item=p,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=u:this._identityChangesTail._nextIdentityChange=u,u}}class vI{constructor(u,p){this.item=u,this.trackById=p,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class bI{constructor(){this._head=null,this._tail=null}add(u){null===this._head?(this._head=this._tail=u,u._nextDup=null,u._prevDup=null):(this._tail._nextDup=u,u._prevDup=this._tail,u._nextDup=null,this._tail=u)}get(u,p){let m;for(m=this._head;null!==m;m=m._nextDup)if((null===p||p<=m.currentIndex)&&Object.is(m.trackById,u))return m;return null}remove(u){const p=u._prevDup,m=u._nextDup;return null===p?this._head=m:p._nextDup=m,null===m?this._tail=p:m._prevDup=p,null===this._head}}class TM{constructor(){this.map=new Map}put(u){const p=u.trackById;let m=this.map.get(p);m||(m=new bI,this.map.set(p,m)),m.add(u)}get(u,p){const v=this.map.get(u);return v?v.get(u,p):null}remove(u){const p=u.trackById;return this.map.get(p).remove(u)&&this.map.delete(p),u}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function e0(l,u,p){const m=l.previousIndex;if(null===m)return m;let v=0;return p&&m<p.length&&(v=p[m]),m+u+v}class nw{constructor(){}supports(u){return u instanceof Map||Tx(u)}create(){return new WS}}class WS{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(u){let p;for(p=this._mapHead;null!==p;p=p._next)u(p)}forEachPreviousItem(u){let p;for(p=this._previousMapHead;null!==p;p=p._nextPrevious)u(p)}forEachChangedItem(u){let p;for(p=this._changesHead;null!==p;p=p._nextChanged)u(p)}forEachAddedItem(u){let p;for(p=this._additionsHead;null!==p;p=p._nextAdded)u(p)}forEachRemovedItem(u){let p;for(p=this._removalsHead;null!==p;p=p._nextRemoved)u(p)}diff(u){if(u){if(!(u instanceof Map||Tx(u)))throw new Gt(900,!1)}else u=new Map;return this.check(u)?this:null}onDestroy(){}check(u){this._reset();let p=this._mapHead;if(this._appendAfter=null,this._forEach(u,(m,v)=>{if(p&&p.key===v)this._maybeAddToChanges(p,m),this._appendAfter=p,p=p._next;else{const C=this._getOrCreateRecordForKey(v,m);p=this._insertBeforeOrAppend(p,C)}}),p){p._prev&&(p._prev._next=null),this._removalsHead=p;for(let m=p;null!==m;m=m._nextRemoved)m===this._mapHead&&(this._mapHead=null),this._records.delete(m.key),m._nextRemoved=m._next,m.previousValue=m.currentValue,m.currentValue=null,m._prev=null,m._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(u,p){if(u){const m=u._prev;return p._next=u,p._prev=m,u._prev=p,m&&(m._next=p),u===this._mapHead&&(this._mapHead=p),this._appendAfter=u,u}return this._appendAfter?(this._appendAfter._next=p,p._prev=this._appendAfter):this._mapHead=p,this._appendAfter=p,null}_getOrCreateRecordForKey(u,p){if(this._records.has(u)){const v=this._records.get(u);this._maybeAddToChanges(v,p);const C=v._prev,E=v._next;return C&&(C._next=E),E&&(E._prev=C),v._next=null,v._prev=null,v}const m=new KS(u);return this._records.set(u,m),m.currentValue=p,this._addToAdditions(m),m}_reset(){if(this.isDirty){let u;for(this._previousMapHead=this._mapHead,u=this._previousMapHead;null!==u;u=u._next)u._nextPrevious=u._next;for(u=this._changesHead;null!==u;u=u._nextChanged)u.previousValue=u.currentValue;for(u=this._additionsHead;null!=u;u=u._nextAdded)u.previousValue=u.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(u,p){Object.is(p,u.currentValue)||(u.previousValue=u.currentValue,u.currentValue=p,this._addToChanges(u))}_addToAdditions(u){null===this._additionsHead?this._additionsHead=this._additionsTail=u:(this._additionsTail._nextAdded=u,this._additionsTail=u)}_addToChanges(u){null===this._changesHead?this._changesHead=this._changesTail=u:(this._changesTail._nextChanged=u,this._changesTail=u)}_forEach(u,p){u instanceof Map?u.forEach(p):Object.keys(u).forEach(m=>p(u[m],m))}}class KS{constructor(u){this.key=u,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function xI(){return new DO([new AO])}let DO=(()=>{class l{static#t=this.\u0275prov=nt({token:l,providedIn:"root",factory:xI});constructor(p){this.factories=p}static create(p,m){if(null!=m){const v=m.factories.slice();p=p.concat(v)}return new l(p)}static extend(p){return{provide:l,useFactory:m=>l.create(p,m||xI()),deps:[[l,new jh,new ns]]}}find(p){const m=this.factories.find(v=>v.supports(p));if(null!=m)return m;throw new Gt(901,!1)}}return l})();function wI(){return new kO([new nw])}let kO=(()=>{class l{static#t=this.\u0275prov=nt({token:l,providedIn:"root",factory:wI});constructor(p){this.factories=p}static create(p,m){if(m){const v=m.factories.slice();p=p.concat(v)}return new l(p)}static extend(p){return{provide:l,useFactory:m=>l.create(p,m||wI()),deps:[[l,new jh,new ns]]}}find(p){const m=this.factories.find(v=>v.supports(p));if(m)return m;throw new Gt(901,!1)}}return l})();const MI=Kb(null,"core",[]);let SM=(()=>{class l{constructor(p){}static#t=this.\u0275fac=function(m){return new(m||l)(ir(id))};static#e=this.\u0275mod=ki({type:l});static#n=this.\u0275inj=Qt({})}return l})();function t(l){return"boolean"==typeof l?l:null!=l&&"false"!==l}function I(l){const u=Wn(l);if(!u)return null;const p=new qd(u);return{get selector(){return p.selector},get type(){return p.componentType},get inputs(){return p.inputs},get outputs(){return p.outputs},get ngContentSelectors(){return p.ngContentSelectors},get isStandalone(){return u.standalone},get isSignal(){return u.signals}}}},3399:(Hn,we,ft)=>{"use strict";ft.d(we,{Z:()=>tn});var M=ft(229),mt=ft(6820),It=ft(1571),vt=ft(7879);class lt{constructor(rn,Te){this._delegate=rn,this.firebase=Te,(0,It._addComponent)(rn,new mt.wA("app-compat",()=>this,"PUBLIC")),this.container=rn.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(rn){this._delegate.automaticDataCollectionEnabled=rn}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(rn=>{this._delegate.checkDestroyed(),rn()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,It.deleteApp)(this._delegate)))}_getService(rn,Te=It._DEFAULT_ENTRY_NAME){var Fn;this._delegate.checkDestroyed();const Ce=this._delegate.container.getProvider(rn);return!Ce.isInitialized()&&"EXPLICIT"===(null===(Fn=Ce.getComponent())||void 0===Fn?void 0:Fn.instantiationMode)&&Ce.initialize(),Ce.getImmediate({identifier:Te})}_removeServiceInstance(rn,Te=It._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(rn).clearInstance(Te)}_addComponent(rn){(0,It._addComponent)(this._delegate,rn)}_addOrOverwriteComponent(rn){(0,It._addOrOverwriteComponent)(this._delegate,rn)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const ke=new M.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),Pt=function be(){const We=function ue(We){const rn={},Te={__esModule:!0,initializeApp:function me(Gt,Ct={}){const ge=It.initializeApp(Gt,Ct);if((0,M.r3)(rn,ge.name))return rn[ge.name];const en=new We(ge,Te);return rn[ge.name]=en,en},app:Ce,registerVersion:It.registerVersion,setLogLevel:It.setLogLevel,onLog:It.onLog,apps:null,SDK_VERSION:It.SDK_VERSION,INTERNAL:{registerComponent:function Xt(Gt){const Ct=Gt.name,ge=Ct.replace("-compat","");if(It._registerComponent(Gt)&&"PUBLIC"===Gt.type){const en=(Ui=Ce())=>{if("function"!=typeof Ui[ge])throw ke.create("invalid-app-argument",{appName:Ct});return Ui[ge]()};void 0!==Gt.serviceProps&&(0,M.ZB)(en,Gt.serviceProps),Te[ge]=en,We.prototype[ge]=function(...Ui){return this._getService.bind(this,Ct).apply(this,Gt.multipleInstances?Ui:[])}}return"PUBLIC"===Gt.type?Te[ge]:null},removeApp:function Fn(Gt){delete rn[Gt]},useAsService:function Ve(Gt,Ct){return"serverAuth"===Ct?null:Ct},modularAPIs:It}};function Ce(Gt){if(!(0,M.r3)(rn,Gt=Gt||It._DEFAULT_ENTRY_NAME))throw ke.create("no-app",{appName:Gt});return rn[Gt]}return Te.default=Te,Object.defineProperty(Te,"apps",{get:function tt(){return Object.keys(rn).map(Gt=>rn[Gt])}}),Ce.App=We,Te}(lt);return We.INTERNAL=Object.assign(Object.assign({},We.INTERNAL),{createFirebaseNamespace:be,extendNamespace:function rn(Te){(0,M.ZB)(We,Te)},createSubscribe:M.ne,ErrorFactory:M.LL,deepExtend:M.ZB}),We}(),Et=new vt.Yd("@firebase/app-compat");if((0,M.jU)()&&void 0!==self.firebase){Et.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const We=self.firebase.SDK_VERSION;We&&We.indexOf("LITE")>=0&&Et.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const tn=Pt;!function re(We){(0,It.registerVersion)("@firebase/app-compat","0.2.13",We)}()},1571:(Hn,we,ft)=>{"use strict";ft.r(we),ft.d(we,{FirebaseError:()=>vt.ZR,SDK_VERSION:()=>er,_DEFAULT_ENTRY_NAME:()=>Ze,_addComponent:()=>yn,_addOrOverwriteComponent:()=>Fr,_apps:()=>gn,_clearComponents:()=>Ur,_components:()=>ur,_getProvider:()=>Sn,_registerComponent:()=>Xr,_removeServiceInstance:()=>Vi,deleteApp:()=>Ft,getApp:()=>no,getApps:()=>ds,initializeApp:()=>Rs,onLog:()=>le,registerVersion:()=>te,setLogLevel:()=>_e});var M=ft(5861),mt=ft(6820),It=ft(7879),vt=ft(229);const lt=(ne,Vt)=>Vt.some(Re=>ne instanceof Re);let ye,ke;const Pt=new WeakMap,Et=new WeakMap,Yt=new WeakMap,Le=new WeakMap,re=new WeakMap;let rn={get(ne,Vt,Re){if(ne instanceof IDBTransaction){if("done"===Vt)return Et.get(ne);if("objectStoreNames"===Vt)return ne.objectStoreNames||Yt.get(ne);if("store"===Vt)return Re.objectStoreNames[1]?void 0:Re.objectStore(Re.objectStoreNames[0])}return me(ne[Vt])},set:(ne,Vt,Re)=>(ne[Vt]=Re,!0),has:(ne,Vt)=>ne instanceof IDBTransaction&&("done"===Vt||"store"===Vt)||Vt in ne};function Ce(ne){return"function"==typeof ne?function Fn(ne){return ne!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function be(){return ke||(ke=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(ne)?function(...Vt){return ne.apply(tt(this),Vt),me(Pt.get(this))}:function(...Vt){return me(ne.apply(tt(this),Vt))}:function(Vt,...Re){const zn=ne.call(tt(this),Vt,...Re);return Yt.set(zn,Vt.sort?Vt.sort():[Vt]),me(zn)}}(ne):(ne instanceof IDBTransaction&&function We(ne){if(Et.has(ne))return;const Vt=new Promise((Re,zn)=>{const vr=()=>{ne.removeEventListener("complete",sr),ne.removeEventListener("error",ai),ne.removeEventListener("abort",ai)},sr=()=>{Re(),vr()},ai=()=>{zn(ne.error||new DOMException("AbortError","AbortError")),vr()};ne.addEventListener("complete",sr),ne.addEventListener("error",ai),ne.addEventListener("abort",ai)});Et.set(ne,Vt)}(ne),lt(ne,function ue(){return ye||(ye=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(ne,rn):ne)}function me(ne){if(ne instanceof IDBRequest)return function tn(ne){const Vt=new Promise((Re,zn)=>{const vr=()=>{ne.removeEventListener("success",sr),ne.removeEventListener("error",ai)},sr=()=>{Re(me(ne.result)),vr()},ai=()=>{zn(ne.error),vr()};ne.addEventListener("success",sr),ne.addEventListener("error",ai)});return Vt.then(Re=>{Re instanceof IDBCursor&&Pt.set(Re,ne)}).catch(()=>{}),re.set(Vt,ne),Vt}(ne);if(Le.has(ne))return Le.get(ne);const Vt=Ce(ne);return Vt!==ne&&(Le.set(ne,Vt),re.set(Vt,ne)),Vt}const tt=ne=>re.get(ne),Gt=["get","getKey","getAll","getAllKeys","count"],Ct=["put","add","delete","clear"],ge=new Map;function en(ne,Vt){if(!(ne instanceof IDBDatabase)||Vt in ne||"string"!=typeof Vt)return;if(ge.get(Vt))return ge.get(Vt);const Re=Vt.replace(/FromIndex$/,""),zn=Vt!==Re,vr=Ct.includes(Re);if(!(Re in(zn?IDBIndex:IDBObjectStore).prototype)||!vr&&!Gt.includes(Re))return;const sr=function(){var ai=(0,M.Z)(function*(Hi,...Ti){const zr=this.transaction(Hi,vr?"readwrite":"readonly");let pl=zr.store;return zn&&(pl=pl.index(Ti.shift())),(yield Promise.all([pl[Re](...Ti),vr&&zr.done]))[0]});return function(Ti){return ai.apply(this,arguments)}}();return ge.set(Vt,sr),sr}!function Te(ne){rn=ne(rn)}(ne=>({...ne,get:(Vt,Re,zn)=>en(Vt,Re)||ne.get(Vt,Re,zn),has:(Vt,Re)=>!!en(Vt,Re)||ne.has(Vt,Re)}));class Ui{constructor(Vt){this.container=Vt}getPlatformInfoString(){return this.container.getProviders().map(Re=>{if(function cs(ne){const Vt=ne.getComponent();return"VERSION"===Vt?.type}(Re)){const zn=Re.getImmediate();return`${zn.library}/${zn.version}`}return null}).filter(Re=>Re).join(" ")}}const Go="@firebase/app",Yr=new It.Yd("@firebase/app"),Ze="[DEFAULT]",Ie={[Go]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},gn=new Map,ur=new Map;function yn(ne,Vt){try{ne.container.addComponent(Vt)}catch(Re){Yr.debug(`Component ${Vt.name} failed to register with FirebaseApp ${ne.name}`,Re)}}function Fr(ne,Vt){ne.container.addOrOverwriteComponent(Vt)}function Xr(ne){const Vt=ne.name;if(ur.has(Vt))return Yr.debug(`There were multiple attempts to register component ${Vt}.`),!1;ur.set(Vt,ne);for(const Re of gn.values())yn(Re,ne);return!0}function Sn(ne,Vt){const Re=ne.container.getProvider("heartbeat").getImmediate({optional:!0});return Re&&Re.triggerHeartbeat(),ne.container.getProvider(Vt)}function Vi(ne,Vt,Re=Ze){Sn(ne,Vt).clearInstance(Re)}function Ur(){ur.clear()}const dr=new vt.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Fl{constructor(Vt,Re,zn){this._isDeleted=!1,this._options=Object.assign({},Vt),this._config=Object.assign({},Re),this._name=Re.name,this._automaticDataCollectionEnabled=Re.automaticDataCollectionEnabled,this._container=zn,this.container.addComponent(new mt.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Vt){this.checkDestroyed(),this._automaticDataCollectionEnabled=Vt}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Vt){this._isDeleted=Vt}checkDestroyed(){if(this.isDeleted)throw dr.create("app-deleted",{appName:this._name})}}const er="9.23.0";function Rs(ne,Vt={}){let Re=ne;"object"!=typeof Vt&&(Vt={name:Vt});const zn=Object.assign({name:Ze,automaticDataCollectionEnabled:!1},Vt),vr=zn.name;if("string"!=typeof vr||!vr)throw dr.create("bad-app-name",{appName:String(vr)});if(Re||(Re=(0,vt.aH)()),!Re)throw dr.create("no-options");const sr=gn.get(vr);if(sr){if((0,vt.vZ)(Re,sr.options)&&(0,vt.vZ)(zn,sr.config))return sr;throw dr.create("duplicate-app",{appName:vr})}const ai=new mt.H0(vr);for(const Ti of ur.values())ai.addComponent(Ti);const Hi=new Fl(Re,zn,ai);return gn.set(vr,Hi),Hi}function no(ne=Ze){const Vt=gn.get(ne);if(!Vt&&ne===Ze&&(0,vt.aH)())return Rs();if(!Vt)throw dr.create("no-app",{appName:ne});return Vt}function ds(){return Array.from(gn.values())}function Ft(ne){return Ht.apply(this,arguments)}function Ht(){return(Ht=(0,M.Z)(function*(ne){const Vt=ne.name;gn.has(Vt)&&(gn.delete(Vt),yield Promise.all(ne.container.getProviders().map(Re=>Re.delete())),ne.isDeleted=!0)})).apply(this,arguments)}function te(ne,Vt,Re){var zn;let vr=null!==(zn=Ie[ne])&&void 0!==zn?zn:ne;Re&&(vr+=`-${Re}`);const sr=vr.match(/\s|\//),ai=Vt.match(/\s|\//);if(sr||ai){const Hi=[`Unable to register library "${vr}" with version "${Vt}":`];return sr&&Hi.push(`library name "${vr}" contains illegal characters (whitespace or "/")`),sr&&ai&&Hi.push("and"),ai&&Hi.push(`version name "${Vt}" contains illegal characters (whitespace or "/")`),void Yr.warn(Hi.join(" "))}Xr(new mt.wA(`${vr}-version`,()=>({library:vr,version:Vt}),"VERSION"))}function le(ne,Vt){if(null!==ne&&"function"!=typeof ne)throw dr.create("invalid-log-argument");(0,It.Am)(ne,Vt)}function _e(ne){(0,It.Ub)(ne)}const ve="firebase-heartbeat-database",xe=1,it="firebase-heartbeat-store";let at=null;function ht(){return at||(at=function Xt(ne,Vt,{blocked:Re,upgrade:zn,blocking:vr,terminated:sr}={}){const ai=indexedDB.open(ne,Vt),Hi=me(ai);return zn&&ai.addEventListener("upgradeneeded",Ti=>{zn(me(ai.result),Ti.oldVersion,Ti.newVersion,me(ai.transaction),Ti)}),Re&&ai.addEventListener("blocked",Ti=>Re(Ti.oldVersion,Ti.newVersion,Ti)),Hi.then(Ti=>{sr&&Ti.addEventListener("close",()=>sr()),vr&&Ti.addEventListener("versionchange",zr=>vr(zr.oldVersion,zr.newVersion,zr))}).catch(()=>{}),Hi}(ve,xe,{upgrade:(ne,Vt)=>{0===Vt&&ne.createObjectStore(it)}}).catch(ne=>{throw dr.create("idb-open",{originalErrorMessage:ne.message})})),at}function kt(){return(kt=(0,M.Z)(function*(ne){try{return yield(yield ht()).transaction(it).objectStore(it).get(Nn(ne))}catch(Vt){if(Vt instanceof vt.ZR)Yr.warn(Vt.message);else{const Re=dr.create("idb-get",{originalErrorMessage:Vt?.message});Yr.warn(Re.message)}}})).apply(this,arguments)}function ee(ne,Vt){return Ke.apply(this,arguments)}function Ke(){return(Ke=(0,M.Z)(function*(ne,Vt){try{const zn=(yield ht()).transaction(it,"readwrite");yield zn.objectStore(it).put(Vt,Nn(ne)),yield zn.done}catch(Re){if(Re instanceof vt.ZR)Yr.warn(Re.message);else{const zn=dr.create("idb-set",{originalErrorMessage:Re?.message});Yr.warn(zn.message)}}})).apply(this,arguments)}function Nn(ne){return`${ne.name}!${ne.options.appId}`}class Qr{constructor(Vt){this.container=Vt,this._heartbeatsCache=null;const Re=this.container.getProvider("app").getImmediate();this._storage=new ji(Re),this._heartbeatsCachePromise=this._storage.read().then(zn=>(this._heartbeatsCache=zn,zn))}triggerHeartbeat(){var Vt=this;return(0,M.Z)(function*(){const zn=Vt.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),vr=Pr();if(null===Vt._heartbeatsCache&&(Vt._heartbeatsCache=yield Vt._heartbeatsCachePromise),Vt._heartbeatsCache.lastSentHeartbeatDate!==vr&&!Vt._heartbeatsCache.heartbeats.some(sr=>sr.date===vr))return Vt._heartbeatsCache.heartbeats.push({date:vr,agent:zn}),Vt._heartbeatsCache.heartbeats=Vt._heartbeatsCache.heartbeats.filter(sr=>{const ai=new Date(sr.date).valueOf();return Date.now()-ai<=2592e6}),Vt._storage.overwrite(Vt._heartbeatsCache)})()}getHeartbeatsHeader(){var Vt=this;return(0,M.Z)(function*(){if(null===Vt._heartbeatsCache&&(yield Vt._heartbeatsCachePromise),null===Vt._heartbeatsCache||0===Vt._heartbeatsCache.heartbeats.length)return"";const Re=Pr(),{heartbeatsToSend:zn,unsentEntries:vr}=function ir(ne,Vt=1024){const Re=[];let zn=ne.slice();for(const vr of ne){const sr=Re.find(ai=>ai.agent===vr.agent);if(sr){if(sr.dates.push(vr.date),or(Re)>Vt){sr.dates.pop();break}}else if(Re.push({agent:vr.agent,dates:[vr.date]}),or(Re)>Vt){Re.pop();break}zn=zn.slice(1)}return{heartbeatsToSend:Re,unsentEntries:zn}}(Vt._heartbeatsCache.heartbeats),sr=(0,vt.L)(JSON.stringify({version:2,heartbeats:zn}));return Vt._heartbeatsCache.lastSentHeartbeatDate=Re,vr.length>0?(Vt._heartbeatsCache.heartbeats=vr,yield Vt._storage.overwrite(Vt._heartbeatsCache)):(Vt._heartbeatsCache.heartbeats=[],Vt._storage.overwrite(Vt._heartbeatsCache)),sr})()}}function Pr(){return(new Date).toISOString().substring(0,10)}class ji{constructor(Vt){this.app=Vt,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,M.Z)(function*(){return!!(0,vt.hl)()&&(0,vt.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Vt=this;return(0,M.Z)(function*(){return(yield Vt._canUseIndexedDBPromise)&&(yield function Bt(ne){return kt.apply(this,arguments)}(Vt.app))||{heartbeats:[]}})()}overwrite(Vt){var Re=this;return(0,M.Z)(function*(){var zn;if(yield Re._canUseIndexedDBPromise){const sr=yield Re.read();return ee(Re.app,{lastSentHeartbeatDate:null!==(zn=Vt.lastSentHeartbeatDate)&&void 0!==zn?zn:sr.lastSentHeartbeatDate,heartbeats:Vt.heartbeats})}})()}add(Vt){var Re=this;return(0,M.Z)(function*(){var zn;if(yield Re._canUseIndexedDBPromise){const sr=yield Re.read();return ee(Re.app,{lastSentHeartbeatDate:null!==(zn=Vt.lastSentHeartbeatDate)&&void 0!==zn?zn:sr.lastSentHeartbeatDate,heartbeats:[...sr.heartbeats,...Vt.heartbeats]})}})()}}function or(ne){return(0,vt.L)(JSON.stringify({version:2,heartbeats:ne})).length}!function qs(ne){Xr(new mt.wA("platform-logger",Vt=>new Ui(Vt),"PRIVATE")),Xr(new mt.wA("heartbeat",Vt=>new Qr(Vt),"PRIVATE")),te(Go,"0.9.13",ne),te(Go,"0.9.13","esm2017"),te("fire-js","")}("")},6820:(Hn,we,ft)=>{"use strict";ft.d(we,{H0:()=>ue,wA:()=>It});var M=ft(5861),mt=ft(229);class It{constructor(Pt,Et,Yt){this.name=Pt,this.instanceFactory=Et,this.type=Yt,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(Pt){return this.instantiationMode=Pt,this}setMultipleInstances(Pt){return this.multipleInstances=Pt,this}setServiceProps(Pt){return this.serviceProps=Pt,this}setInstanceCreatedCallback(Pt){return this.onInstanceCreated=Pt,this}}const vt="[DEFAULT]";class lt{constructor(Pt,Et){this.name=Pt,this.container=Et,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(Pt){const Et=this.normalizeInstanceIdentifier(Pt);if(!this.instancesDeferred.has(Et)){const Yt=new mt.BH;if(this.instancesDeferred.set(Et,Yt),this.isInitialized(Et)||this.shouldAutoInitialize())try{const Le=this.getOrInitializeService({instanceIdentifier:Et});Le&&Yt.resolve(Le)}catch{}}return this.instancesDeferred.get(Et).promise}getImmediate(Pt){var Et;const Yt=this.normalizeInstanceIdentifier(Pt?.identifier),Le=null!==(Et=Pt?.optional)&&void 0!==Et&&Et;if(!this.isInitialized(Yt)&&!this.shouldAutoInitialize()){if(Le)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Yt})}catch(re){if(Le)return null;throw re}}getComponent(){return this.component}setComponent(Pt){if(Pt.name!==this.name)throw Error(`Mismatching Component ${Pt.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=Pt,this.shouldAutoInitialize()){if(function ke(be){return"EAGER"===be.instantiationMode}(Pt))try{this.getOrInitializeService({instanceIdentifier:vt})}catch{}for(const[Et,Yt]of this.instancesDeferred.entries()){const Le=this.normalizeInstanceIdentifier(Et);try{const re=this.getOrInitializeService({instanceIdentifier:Le});Yt.resolve(re)}catch{}}}}clearInstance(Pt=vt){this.instancesDeferred.delete(Pt),this.instancesOptions.delete(Pt),this.instances.delete(Pt)}delete(){var Pt=this;return(0,M.Z)(function*(){const Et=Array.from(Pt.instances.values());yield Promise.all([...Et.filter(Yt=>"INTERNAL"in Yt).map(Yt=>Yt.INTERNAL.delete()),...Et.filter(Yt=>"_delete"in Yt).map(Yt=>Yt._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(Pt=vt){return this.instances.has(Pt)}getOptions(Pt=vt){return this.instancesOptions.get(Pt)||{}}initialize(Pt={}){const{options:Et={}}=Pt,Yt=this.normalizeInstanceIdentifier(Pt.instanceIdentifier);if(this.isInitialized(Yt))throw Error(`${this.name}(${Yt}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Le=this.getOrInitializeService({instanceIdentifier:Yt,options:Et});for(const[re,tn]of this.instancesDeferred.entries())Yt===this.normalizeInstanceIdentifier(re)&&tn.resolve(Le);return Le}onInit(Pt,Et){var Yt;const Le=this.normalizeInstanceIdentifier(Et),re=null!==(Yt=this.onInitCallbacks.get(Le))&&void 0!==Yt?Yt:new Set;re.add(Pt),this.onInitCallbacks.set(Le,re);const tn=this.instances.get(Le);return tn&&Pt(tn,Le),()=>{re.delete(Pt)}}invokeOnInitCallbacks(Pt,Et){const Yt=this.onInitCallbacks.get(Et);if(Yt)for(const Le of Yt)try{Le(Pt,Et)}catch{}}getOrInitializeService({instanceIdentifier:Pt,options:Et={}}){let Yt=this.instances.get(Pt);if(!Yt&&this.component&&(Yt=this.component.instanceFactory(this.container,{instanceIdentifier:(be=Pt,be===vt?void 0:be),options:Et}),this.instances.set(Pt,Yt),this.instancesOptions.set(Pt,Et),this.invokeOnInitCallbacks(Yt,Pt),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,Pt,Yt)}catch{}var be;return Yt||null}normalizeInstanceIdentifier(Pt=vt){return this.component?this.component.multipleInstances?Pt:vt:Pt}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ue{constructor(Pt){this.name=Pt,this.providers=new Map}addComponent(Pt){const Et=this.getProvider(Pt.name);if(Et.isComponentSet())throw new Error(`Component ${Pt.name} has already been registered with ${this.name}`);Et.setComponent(Pt)}addOrOverwriteComponent(Pt){this.getProvider(Pt.name).isComponentSet()&&this.providers.delete(Pt.name),this.addComponent(Pt)}getProvider(Pt){if(this.providers.has(Pt))return this.providers.get(Pt);const Et=new lt(Pt,this);return this.providers.set(Pt,Et),Et}getProviders(){return Array.from(this.providers.values())}}},4097:(Hn,we,ft)=>{"use strict";ft.d(we,{C6:()=>M.getApps,KN:()=>M.registerVersion,Mq:()=>M.getApp,ZF:()=>M.initializeApp});var M=ft(1571);(0,M.registerVersion)("firebase","9.23.0","app")},120:(Hn,we,ft)=>{"use strict";ft.d(we,{Z:()=>M.Z});var M=ft(3399);M.Z.registerVersion("firebase","9.23.0","app-compat")},7879:(Hn,we,ft)=>{"use strict";ft.d(we,{Am:()=>be,Ub:()=>ue,Yd:()=>ke,in:()=>mt});const M=[];var mt=function(Pt){return Pt[Pt.DEBUG=0]="DEBUG",Pt[Pt.VERBOSE=1]="VERBOSE",Pt[Pt.INFO=2]="INFO",Pt[Pt.WARN=3]="WARN",Pt[Pt.ERROR=4]="ERROR",Pt[Pt.SILENT=5]="SILENT",Pt}(mt||{});const It={debug:mt.DEBUG,verbose:mt.VERBOSE,info:mt.INFO,warn:mt.WARN,error:mt.ERROR,silent:mt.SILENT},vt=mt.INFO,lt={[mt.DEBUG]:"log",[mt.VERBOSE]:"log",[mt.INFO]:"info",[mt.WARN]:"warn",[mt.ERROR]:"error"},ye=(Pt,Et,...Yt)=>{if(Et<Pt.logLevel)return;const Le=(new Date).toISOString(),re=lt[Et];if(!re)throw new Error(`Attempted to log a message with an invalid logType (value: ${Et})`);console[re](`[${Le}]  ${Pt.name}:`,...Yt)};class ke{constructor(Et){this.name=Et,this._logLevel=vt,this._logHandler=ye,this._userLogHandler=null,M.push(this)}get logLevel(){return this._logLevel}set logLevel(Et){if(!(Et in mt))throw new TypeError(`Invalid value "${Et}" assigned to \`logLevel\``);this._logLevel=Et}setLogLevel(Et){this._logLevel="string"==typeof Et?It[Et]:Et}get logHandler(){return this._logHandler}set logHandler(Et){if("function"!=typeof Et)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=Et}get userLogHandler(){return this._userLogHandler}set userLogHandler(Et){this._userLogHandler=Et}debug(...Et){this._userLogHandler&&this._userLogHandler(this,mt.DEBUG,...Et),this._logHandler(this,mt.DEBUG,...Et)}log(...Et){this._userLogHandler&&this._userLogHandler(this,mt.VERBOSE,...Et),this._logHandler(this,mt.VERBOSE,...Et)}info(...Et){this._userLogHandler&&this._userLogHandler(this,mt.INFO,...Et),this._logHandler(this,mt.INFO,...Et)}warn(...Et){this._userLogHandler&&this._userLogHandler(this,mt.WARN,...Et),this._logHandler(this,mt.WARN,...Et)}error(...Et){this._userLogHandler&&this._userLogHandler(this,mt.ERROR,...Et),this._logHandler(this,mt.ERROR,...Et)}}function ue(Pt){M.forEach(Et=>{Et.setLogLevel(Pt)})}function be(Pt,Et){for(const Yt of M){let Le=null;Et&&Et.level&&(Le=It[Et.level]),Yt.userLogHandler=null===Pt?null:(re,tn,...We)=>{const rn=We.map(Te=>{if(null==Te)return null;if("string"==typeof Te)return Te;if("number"==typeof Te||"boolean"==typeof Te)return Te.toString();if(Te instanceof Error)return Te.message;try{return JSON.stringify(Te)}catch{return null}}).filter(Te=>Te).join(" ");tn>=(Le??re.logLevel)&&Pt({level:mt[tn].toLowerCase(),message:rn,args:We,type:re.name})}}}},5861:(Hn,we,ft)=>{"use strict";function M(It,vt,lt,ye,ke,ue,be){try{var Pt=It[ue](be),Et=Pt.value}catch(Yt){return void lt(Yt)}Pt.done?vt(Et):Promise.resolve(Et).then(ye,ke)}function mt(It){return function(){var vt=this,lt=arguments;return new Promise(function(ye,ke){var ue=It.apply(vt,lt);function be(Et){M(ue,ye,ke,be,Pt,"next",Et)}function Pt(Et){M(ue,ye,ke,be,Pt,"throw",Et)}be(void 0)})}}ft.d(we,{Z:()=>mt})},7582:(Hn,we,ft)=>{"use strict";function vt(Wt,Kt){var pe={};for(var _t in Wt)Object.prototype.hasOwnProperty.call(Wt,_t)&&Kt.indexOf(_t)<0&&(pe[_t]=Wt[_t]);if(null!=Wt&&"function"==typeof Object.getOwnPropertySymbols){var he=0;for(_t=Object.getOwnPropertySymbols(Wt);he<_t.length;he++)Kt.indexOf(_t[he])<0&&Object.prototype.propertyIsEnumerable.call(Wt,_t[he])&&(pe[_t[he]]=Wt[_t[he]])}return pe}function Yt(Wt,Kt,pe,_t){return new(pe||(pe=Promise))(function(Ue,In){function qr(Tn){try{tr(_t.next(Tn))}catch(pn){In(pn)}}function wi(Tn){try{tr(_t.throw(Tn))}catch(pn){In(pn)}}function tr(Tn){Tn.done?Ue(Tn.value):function he(Ue){return Ue instanceof pe?Ue:new pe(function(In){In(Ue)})}(Tn.value).then(qr,wi)}tr((_t=_t.apply(Wt,Kt||[])).next())})}function me(Wt){return this instanceof me?(this.v=Wt,this):new me(Wt)}function tt(Wt,Kt,pe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var he,_t=pe.apply(Wt,Kt||[]),Ue=[];return he={},In("next"),In("throw"),In("return"),he[Symbol.asyncIterator]=function(){return this},he;function In(hi){_t[hi]&&(he[hi]=function(ce){return new Promise(function(et,nt){Ue.push([hi,ce,et,nt])>1||qr(hi,ce)})})}function qr(hi,ce){try{!function wi(hi){hi.value instanceof me?Promise.resolve(hi.value.v).then(tr,Tn):pn(Ue[0][2],hi)}(_t[hi](ce))}catch(et){pn(Ue[0][3],et)}}function tr(hi){qr("next",hi)}function Tn(hi){qr("throw",hi)}function pn(hi,ce){hi(ce),Ue.shift(),Ue.length&&qr(Ue[0][0],Ue[0][1])}}function Ve(Wt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var pe,Kt=Wt[Symbol.asyncIterator];return Kt?Kt.call(Wt):(Wt=function We(Wt){var Kt="function"==typeof Symbol&&Symbol.iterator,pe=Kt&&Wt[Kt],_t=0;if(pe)return pe.call(Wt);if(Wt&&"number"==typeof Wt.length)return{next:function(){return Wt&&_t>=Wt.length&&(Wt=void 0),{value:Wt&&Wt[_t++],done:!Wt}}};throw new TypeError(Kt?"Object is not iterable.":"Symbol.iterator is not defined.")}(Wt),pe={},_t("next"),_t("throw"),_t("return"),pe[Symbol.asyncIterator]=function(){return this},pe);function _t(Ue){pe[Ue]=Wt[Ue]&&function(In){return new Promise(function(qr,wi){!function he(Ue,In,qr,wi){Promise.resolve(wi).then(function(tr){Ue({value:tr,done:qr})},In)}(qr,wi,(In=Wt[Ue](In)).done,In.value)})}}}ft.d(we,{FC:()=>tt,KL:()=>Ve,_T:()=>vt,mG:()=>Yt,qq:()=>me}),"function"==typeof SuppressedError&&SuppressedError}},Hn=>{Hn(Hn.s=1505)}]);