(self.webpackChunkfireauth_angular_test=self.webpackChunkfireauth_angular_test||[]).push([[179],{6304:(Hn,we,ft)=>{"use strict";ft.d(we,{Dh:()=>ue,GT:()=>ye,cc:()=>re,hO:()=>Le,on:()=>Pt,pX:()=>lt,xv:()=>be});var x=ft(8926),mt=ft(120),It=ft(9015);Hn=ft.hmd(Hn);const vt=["ngOnDestroy"],lt=(Te,Fn,Ce,me={})=>new Proxy(Te,{get:(tt,Xt)=>Ce.runOutsideAngular(()=>{var Ve;if(Te[Xt])return!(null===(Ve=me?.spy)||void 0===Ve)&&Ve.get&&me.spy.get(Xt,Te[Xt]),Te[Xt];if(vt.indexOf(Xt)>-1)return()=>{};const Gt=Fn.toPromise().then(Ct=>{const ge=Ct&&Ct[Xt];return"function"==typeof ge?ge.bind(Ct):ge&&ge.then?ge.then(en=>Ce.run(()=>en)):Ce.run(()=>ge)});return new Proxy(()=>{},{get:(Ct,ge)=>Gt[ge],apply:(Ct,ge,en)=>Gt.then(Vo=>{var cs;const Gi=Vo&&Vo(...en);return!(null===(cs=me?.spy)||void 0===cs)&&cs.apply&&me.spy.apply(Xt,en,Gi),Gi})})})}),ye=(Te,Fn)=>{Fn.forEach(Ce=>{Object.getOwnPropertyNames(Ce.prototype||Ce).forEach(me=>{Object.defineProperty(Te.prototype,me,Object.getOwnPropertyDescriptor(Ce.prototype||Ce,me))})})};class ke{constructor(Fn){return Fn}}const ue=new x.OlP("angularfire2.app.options"),be=new x.OlP("angularfire2.app.name");function Pt(Te,Fn,Ce){const tt="object"==typeof Ce&&Ce||{};tt.name=tt.name||"string"==typeof Ce&&Ce||"[DEFAULT]";const Ve=mt.Z.apps.filter(Gt=>Gt&&Gt.name===tt.name)[0]||Fn.runOutsideAngular(()=>mt.Z.initializeApp(Te,tt));try{JSON.stringify(Te)!==JSON.stringify(Ve.options)&&Ot("error",`${Ve.name} Firebase App already initialized with different options${Hn.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new ke(Ve)}const Ot=(Te,...Fn)=>{(0,x.X6Q)()&&typeof console<"u"&&console[Te](...Fn)},Yt={provide:ke,useFactory:Pt,deps:[ue,x.R0b,[new x.FiY,be]]};let Le=(()=>{class Te{constructor(Ce){mt.Z.registerVersion("angularfire",It.q4.full,"core"),mt.Z.registerVersion("angularfire",It.q4.full,"app-compat"),mt.Z.registerVersion("angular",x.q4F.full,Ce.toString())}static initializeApp(Ce,me){return{ngModule:Te,providers:[{provide:ue,useValue:Ce},{provide:be,useValue:me}]}}}return Te.\u0275fac=function(Ce){return new(Ce||Te)(x.LFG(x.Lbi))},Te.\u0275mod=x.oAB({type:Te}),Te.\u0275inj=x.cJS({providers:[Yt]}),Te})();function re(Te,Fn,Ce,me,tt){const[,Xt,Ve]=globalThis.\u0275AngularfireInstanceCache.find(Gt=>Gt[0]===Te)||[];if(Xt)return function tn(Te,Fn){try{return Te.toString()===Fn.toString()}catch{return Te===Fn}}(tt,Ve)||(rn("error",`${Fn} was already initialized on the ${Ce} Firebase App with different settings.${We?" You may need to reload as Firebase is not HMR aware.":""}`),rn("warn",{is:tt,was:Ve})),Xt;{const Gt=me();return globalThis.\u0275AngularfireInstanceCache.push([Te,Gt,tt]),Gt}}const We=!!Hn.hot,rn=(Te,...Fn)=>{(0,x.X6Q)()&&typeof console<"u"&&console[Te](...Fn)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},9015:(Hn,we,ft)=>{"use strict";ft.d(we,{q4:()=>Ld,iC:()=>De,HU:()=>Uh,vb:()=>Au,JM:()=>fp,u3:()=>nc});var x=ft(8926),mt=ft(4097),It=ft(5861),vt=ft(1571),lt=ft(229),ye=ft(6820),ke=ft(7879);const ue=(U,V)=>V.some(W=>U instanceof W);let be,Pt;const Le=new WeakMap,re=new WeakMap,tn=new WeakMap,We=new WeakMap,rn=new WeakMap;let Ce={get(U,V,W){if(U instanceof IDBTransaction){if("done"===V)return re.get(U);if("objectStoreNames"===V)return U.objectStoreNames||tn.get(U);if("store"===V)return W.objectStoreNames[1]?void 0:W.objectStore(W.objectStoreNames[0])}return Ve(U[V])},set:(U,V,W)=>(U[V]=W,!0),has:(U,V)=>U instanceof IDBTransaction&&("done"===V||"store"===V)||V in U};function Xt(U){return"function"==typeof U?function tt(U){return U!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Yt(){return Pt||(Pt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(U)?function(...V){return U.apply(Gt(this),V),Ve(Le.get(this))}:function(...V){return Ve(U.apply(Gt(this),V))}:function(V,...W){const ut=U.call(Gt(this),V,...W);return tn.set(ut,V.sort?V.sort():[V]),Ve(ut)}}(U):(U instanceof IDBTransaction&&function Fn(U){if(re.has(U))return;const V=new Promise((W,ut)=>{const Mt=()=>{U.removeEventListener("complete",Lt),U.removeEventListener("error",se),U.removeEventListener("abort",se)},Lt=()=>{W(),Mt()},se=()=>{ut(U.error||new DOMException("AbortError","AbortError")),Mt()};U.addEventListener("complete",Lt),U.addEventListener("error",se),U.addEventListener("abort",se)});re.set(U,V)}(U),ue(U,function Ot(){return be||(be=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(U,Ce):U)}function Ve(U){if(U instanceof IDBRequest)return function Te(U){const V=new Promise((W,ut)=>{const Mt=()=>{U.removeEventListener("success",Lt),U.removeEventListener("error",se)},Lt=()=>{W(Ve(U.result)),Mt()},se=()=>{ut(U.error),Mt()};U.addEventListener("success",Lt),U.addEventListener("error",se)});return V.then(W=>{W instanceof IDBCursor&&Le.set(W,U)}).catch(()=>{}),rn.set(V,U),V}(U);if(We.has(U))return We.get(U);const V=Xt(U);return V!==U&&(We.set(U,V),rn.set(V,U)),V}const Gt=U=>rn.get(U),en=["get","getKey","getAll","getAllKeys","count"],Vo=["put","add","delete","clear"],cs=new Map;function Gi(U,V){if(!(U instanceof IDBDatabase)||V in U||"string"!=typeof V)return;if(cs.get(V))return cs.get(V);const W=V.replace(/FromIndex$/,""),ut=V!==W,Mt=Vo.includes(W);if(!(W in(ut?IDBIndex:IDBObjectStore).prototype)||!Mt&&!en.includes(W))return;const Lt=function(){var se=(0,It.Z)(function*(on,...nn){const xn=this.transaction(on,Mt?"readwrite":"readonly");let mr=xn.store;return ut&&(mr=mr.index(nn.shift())),(yield Promise.all([mr[W](...nn),Mt&&xn.done]))[0]});return function(nn){return se.apply(this,arguments)}}();return cs.set(V,Lt),Lt}!function me(U){Ce=U(Ce)}(U=>({...U,get:(V,W,ut)=>Gi(V,W)||U.get(V,W,ut),has:(V,W)=>!!Gi(V,W)||U.has(V,W)}));const us="@firebase/installations",Yr="0.6.4",Ne=1e4,vs=`w:${Yr}`,Wt="FIS_v2",Kt="https://firebaseinstallations.googleapis.com/v1",pe=36e5,In=new lt.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function qr(U){return U instanceof lt.ZR&&U.code.includes("request-failed")}function Co({projectId:U}){return`${Kt}/projects/${U}/installations`}function tr(U){return{token:U.token,requestStatus:2,expiresIn:gt(U.expiresIn),creationTime:Date.now()}}function Tn(U,V){return pn.apply(this,arguments)}function pn(){return(pn=(0,It.Z)(function*(U,V){const ut=(yield V.json()).error;return In.create("request-failed",{requestName:U,serverCode:ut.code,serverMessage:ut.message,serverStatus:ut.status})})).apply(this,arguments)}function fo({apiKey:U}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":U})}function et(U){return nt.apply(this,arguments)}function nt(){return(nt=(0,It.Z)(function*(U){const V=yield U();return V.status>=500&&V.status<600?U():V})).apply(this,arguments)}function gt(U){return Number(U.replace("s","000"))}function Pe(){return(Pe=(0,It.Z)(function*({appConfig:U,heartbeatServiceProvider:V},{fid:W}){const ut=Co(U),Mt=fo(U),Lt=V.getImmediate({optional:!0});if(Lt){const xn=yield Lt.getHeartbeatsHeader();xn&&Mt.append("x-firebase-client",xn)}const on={method:"POST",headers:Mt,body:JSON.stringify({fid:W,authVersion:Wt,appId:U.appId,sdkVersion:vs})},nn=yield et(()=>fetch(ut,on));if(nn.ok){const xn=yield nn.json();return{fid:xn.fid||W,registrationStatus:2,refreshToken:xn.refreshToken,authToken:tr(xn.authToken)}}throw yield Tn("Create Installation",nn)})).apply(this,arguments)}function Ge(U){return new Promise(V=>{setTimeout(V,U)})}const Xe=/^[cdef][\w-]{21}$/,Ze="";function Ie(){try{const U=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(U),U[0]=112+U[0]%16;const W=function gn(U){return function ae(U){return btoa(String.fromCharCode(...U)).replace(/\+/g,"-").replace(/\//g,"_")}(U).substr(0,22)}(U);return Xe.test(W)?W:Ze}catch{return Ze}}function ur(U){return`${U.appName}!${U.appId}`}const yn=new Map;function Fr(U,V){const W=ur(U);jo(W,V),function Ur(U,V){const W=function dr(){return!Ar&&"BroadcastChannel"in self&&(Ar=new BroadcastChannel("[Firebase] FID Change"),Ar.onmessage=U=>{jo(U.data.key,U.data.fid)}),Ar}();W&&W.postMessage({key:U,fid:V}),function zl(){0===yn.size&&Ar&&(Ar.close(),Ar=null)}()}(W,V)}function jo(U,V){const W=yn.get(U);if(W)for(const ut of W)ut(V)}let Ar=null;const er="firebase-installations-database",Rs=1,ri="firebase-installations-store";let ds=null;function Ft(){return ds||(ds=function Ct(U,V,{blocked:W,upgrade:ut,blocking:Mt,terminated:Lt}={}){const se=indexedDB.open(U,V),on=Ve(se);return ut&&se.addEventListener("upgradeneeded",nn=>{ut(Ve(se.result),nn.oldVersion,nn.newVersion,Ve(se.transaction))}),W&&se.addEventListener("blocked",()=>W()),on.then(nn=>{Lt&&nn.addEventListener("close",()=>Lt()),Mt&&nn.addEventListener("versionchange",()=>Mt())}).catch(()=>{}),on}(er,Rs,{upgrade:(U,V)=>{0===V&&U.createObjectStore(ri)}})),ds}function Ht(U,V){return te.apply(this,arguments)}function te(){return(te=(0,It.Z)(function*(U,V){const W=ur(U),Mt=(yield Ft()).transaction(ri,"readwrite"),Lt=Mt.objectStore(ri),se=yield Lt.get(W);return yield Lt.put(V,W),yield Mt.done,(!se||se.fid!==V.fid)&&Fr(U,V.fid),V})).apply(this,arguments)}function le(U){return _e.apply(this,arguments)}function _e(){return(_e=(0,It.Z)(function*(U){const V=ur(U),ut=(yield Ft()).transaction(ri,"readwrite");yield ut.objectStore(ri).delete(V),yield ut.done})).apply(this,arguments)}function ve(U,V){return xe.apply(this,arguments)}function xe(){return(xe=(0,It.Z)(function*(U,V){const W=ur(U),Mt=(yield Ft()).transaction(ri,"readwrite"),Lt=Mt.objectStore(ri),se=yield Lt.get(W),on=V(se);return void 0===on?yield Lt.delete(W):yield Lt.put(on,W),yield Mt.done,on&&(!se||se.fid!==on.fid)&&Fr(U,on.fid),on})).apply(this,arguments)}function ot(U){return at.apply(this,arguments)}function at(){return at=(0,It.Z)(function*(U){let V;const W=yield ve(U.appConfig,ut=>{const Mt=function ht(U){return Er(U||{fid:Ie(),registrationStatus:0})}(ut),Lt=function Bt(U,V){if(0===V.registrationStatus){if(!navigator.onLine)return{installationEntry:V,registrationPromise:Promise.reject(In.create("app-offline"))};const W={fid:V.fid,registrationStatus:1,registrationTime:Date.now()},ut=function kt(U,V){return ee.apply(this,arguments)}(U,W);return{installationEntry:W,registrationPromise:ut}}return 1===V.registrationStatus?{installationEntry:V,registrationPromise:Ke(U)}:{installationEntry:V}}(U,Mt);return V=Lt.registrationPromise,Lt.installationEntry});return W.fid===Ze?{installationEntry:yield V}:{installationEntry:W,registrationPromise:V}}),at.apply(this,arguments)}function ee(){return ee=(0,It.Z)(function*(U,V){try{const W=yield function ie(U,V){return Pe.apply(this,arguments)}(U,V);return Ht(U.appConfig,W)}catch(W){throw qr(W)&&409===W.customData.serverCode?yield le(U.appConfig):yield Ht(U.appConfig,{fid:V.fid,registrationStatus:0}),W}}),ee.apply(this,arguments)}function Ke(U){return Nn.apply(this,arguments)}function Nn(){return(Nn=(0,It.Z)(function*(U){let V=yield yr(U.appConfig);for(;1===V.registrationStatus;)yield Ge(100),V=yield yr(U.appConfig);if(0===V.registrationStatus){const{installationEntry:W,registrationPromise:ut}=yield ot(U);return ut||W}return V})).apply(this,arguments)}function yr(U){return ve(U,V=>{if(!V)throw In.create("installation-not-found");return Er(V)})}function Er(U){return function Qr(U){return 1===U.registrationStatus&&U.registrationTime+Ne<Date.now()}(U)?{fid:U.fid,registrationStatus:0}:U}function or(){return(or=(0,It.Z)(function*({appConfig:U,heartbeatServiceProvider:V},W){const ut=function $o(U,{fid:V}){return`${Co(U)}/${V}/authTokens:generate`}(U,W),Mt=function ce(U,{refreshToken:V}){const W=fo(U);return W.append("Authorization",function Qt(U){return`${Wt} ${U}`}(V)),W}(U,W),Lt=V.getImmediate({optional:!0});if(Lt){const xn=yield Lt.getHeartbeatsHeader();xn&&Mt.append("x-firebase-client",xn)}const on={method:"POST",headers:Mt,body:JSON.stringify({installation:{sdkVersion:vs,appId:U.appId}})},nn=yield et(()=>fetch(ut,on));if(nn.ok)return tr(yield nn.json());throw yield Tn("Generate Auth Token",nn)})).apply(this,arguments)}function ir(U){return qs.apply(this,arguments)}function qs(){return qs=(0,It.Z)(function*(U,V=!1){let W;const ut=yield ve(U.appConfig,Lt=>{if(!sr(Lt))throw In.create("not-registered");const se=Lt.authToken;if(!V&&function ao(U){return 2===U.requestStatus&&!function qo(U){const V=Date.now();return V<U.creationTime||U.creationTime+U.expiresIn<V+pe}(U)}(se))return Lt;if(1===se.requestStatus)return W=function ne(U,V){return Vt.apply(this,arguments)}(U,V),Lt;{if(!navigator.onLine)throw In.create("app-offline");const on=function Io(U){const V={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},U),{authToken:V})}(Lt);return W=function zn(U,V){return vr.apply(this,arguments)}(U,on),on}});return W?yield W:ut.authToken}),qs.apply(this,arguments)}function Vt(){return(Vt=(0,It.Z)(function*(U,V){let W=yield Re(U.appConfig);for(;1===W.authToken.requestStatus;)yield Ge(100),W=yield Re(U.appConfig);const ut=W.authToken;return 0===ut.requestStatus?ir(U,V):ut})).apply(this,arguments)}function Re(U){return ve(U,V=>{if(!sr(V))throw In.create("not-registered");return function zr(U){return 1===U.requestStatus&&U.requestTime+Ne<Date.now()}(V.authToken)?Object.assign(Object.assign({},V),{authToken:{requestStatus:0}}):V})}function vr(){return vr=(0,It.Z)(function*(U,V){try{const W=yield function Pr(U,V){return or.apply(this,arguments)}(U,V),ut=Object.assign(Object.assign({},V),{authToken:W});return yield Ht(U.appConfig,ut),W}catch(W){if(!qr(W)||401!==W.customData.serverCode&&404!==W.customData.serverCode){const ut=Object.assign(Object.assign({},V),{authToken:{requestStatus:0}});yield Ht(U.appConfig,ut)}else yield le(U.appConfig);throw W}}),vr.apply(this,arguments)}function sr(U){return void 0!==U&&2===U.registrationStatus}function ml(){return(ml=(0,It.Z)(function*(U){const V=U,{installationEntry:W,registrationPromise:ut}=yield ot(V);return ut?ut.catch(console.error):ir(V).catch(console.error),W.fid})).apply(this,arguments)}function su(){return su=(0,It.Z)(function*(U,V=!1){const W=U;return yield function bs(U){return Ua.apply(this,arguments)}(W),(yield ir(W,V)).token}),su.apply(this,arguments)}function Ua(){return(Ua=(0,It.Z)(function*(U){const{registrationPromise:V}=yield ot(U);V&&(yield V)})).apply(this,arguments)}function hd(U){return In.create("missing-app-config-values",{valueName:U})}const Mn="installations",oa=U=>{const V=U.getProvider("app").getImmediate(),W=function ja(U){if(!U||!U.options)throw hd("App Configuration");if(!U.name)throw hd("App Name");const V=["projectId","apiKey","appId"];for(const W of V)if(!U.options[W])throw hd(W);return{appName:U.name,projectId:U.options.projectId,apiKey:U.options.apiKey,appId:U.options.appId}}(V);return{app:V,appConfig:W,heartbeatServiceProvider:(0,vt._getProvider)(V,"heartbeat"),_delete:()=>Promise.resolve()}},Hi=U=>{const V=U.getProvider("app").getImmediate(),W=(0,vt._getProvider)(V,Mn).getImmediate();return{getId:()=>function gl(U){return ml.apply(this,arguments)}(W),getToken:Mt=>function mh(U){return su.apply(this,arguments)}(W,Mt)}};(function au(){(0,vt._registerComponent)(new ye.wA(Mn,oa,"PUBLIC")),(0,vt._registerComponent)(new ye.wA("installations-internal",Hi,"PRIVATE"))})(),(0,vt.registerVersion)(us,Yr),(0,vt.registerVersion)(us,Yr,"esm2017");const lu="@firebase/remote-config",vi=new lt.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Ae{constructor(V,W,ut,Mt){this.client=V,this.storage=W,this.storageCache=ut,this.logger=Mt}isCachedDataFresh(V,W){if(!W)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const ut=Date.now()-W,Mt=ut<=V;return this.logger.debug(`Config fetch cache check. Cache age millis: ${ut}. Cache max age millis (minimumFetchIntervalMillis setting): ${V}. Is cache hit: ${Mt}.`),Mt}fetch(V){var W=this;return(0,It.Z)(function*(){const[ut,Mt]=yield Promise.all([W.storage.getLastSuccessfulFetchTimestampMillis(),W.storage.getLastSuccessfulFetchResponse()]);if(Mt&&W.isCachedDataFresh(V.cacheMaxAgeMillis,ut))return Mt;V.eTag=Mt&&Mt.eTag;const Lt=yield W.client.fetch(V),se=[W.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===Lt.status&&se.push(W.storage.setLastSuccessfulFetchResponse(Lt)),yield Promise.all(se),Lt})()}}function br(U=navigator){return U.languages&&U.languages[0]||U.language}class Tr{constructor(V,W,ut,Mt,Lt,se){this.firebaseInstallations=V,this.sdkVersion=W,this.namespace=ut,this.projectId=Mt,this.apiKey=Lt,this.appId=se}fetch(V){var W=this;return(0,It.Z)(function*(){const[ut,Mt]=yield Promise.all([W.firebaseInstallations.getId(),W.firebaseInstallations.getToken()]),se=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${W.projectId}/namespaces/${W.namespace}:fetch?key=${W.apiKey}`,on={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":V.eTag||"*"},nn={sdk_version:W.sdkVersion,app_instance_id:ut,app_instance_id_token:Mt,app_id:W.appId,language_code:br()},xn={method:"POST",headers:on,body:JSON.stringify(nn)},mr=fetch(se,xn),hr=new Promise((Zi,Ia)=>{V.signal.addEventListener(()=>{const Du=new Error("The operation was aborted.");Du.name="AbortError",Ia(Du)})});let _o;try{yield Promise.race([mr,hr]),_o=yield mr}catch(Zi){let Ia="fetch-client-network";throw"AbortError"===Zi?.name&&(Ia="fetch-timeout"),vi.create(Ia,{originalErrorMessage:Zi?.message})}let Ci=_o.status;const si=_o.headers.get("ETag")||void 0;let Ta,_i;if(200===_o.status){let Zi;try{Zi=yield _o.json()}catch(Ia){throw vi.create("fetch-client-parse",{originalErrorMessage:Ia?.message})}Ta=Zi.entries,_i=Zi.state}if("INSTANCE_STATE_UNSPECIFIED"===_i?Ci=500:"NO_CHANGE"===_i?Ci=304:("NO_TEMPLATE"===_i||"EMPTY_CONFIG"===_i)&&(Ta={}),304!==Ci&&200!==Ci)throw vi.create("fetch-status",{httpStatus:Ci});return{status:Ci,eTag:si,config:Ta}})()}}class Ye{constructor(V,W){this.client=V,this.storage=W}fetch(V){var W=this;return(0,It.Z)(function*(){const ut=(yield W.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return W.attemptFetch(V,ut)})()}attemptFetch(V,{throttleEndTimeMillis:W,backoffCount:ut}){var Mt=this;return(0,It.Z)(function*(){yield function Jr(U,V){return new Promise((W,ut)=>{const Mt=Math.max(V-Date.now(),0),Lt=setTimeout(W,Mt);U.addEventListener(()=>{clearTimeout(Lt),ut(vi.create("fetch-throttle",{throttleEndTimeMillis:V}))})})}(V.signal,W);try{const Lt=yield Mt.client.fetch(V);return yield Mt.storage.deleteThrottleMetadata(),Lt}catch(Lt){if(!function dn(U){if(!(U instanceof lt.ZR&&U.customData))return!1;const V=Number(U.customData.httpStatus);return 429===V||500===V||503===V||504===V}(Lt))throw Lt;const se={throttleEndTimeMillis:Date.now()+(0,lt.$s)(ut),backoffCount:ut+1};return yield Mt.storage.setThrottleMetadata(se),Mt.attemptFetch(V,se)}})()}}class $a{constructor(V,W,ut,Mt,Lt){this.app=V,this._client=W,this._storageCache=ut,this._storage=Mt,this._logger=Lt,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Zr(U,V){const W=U.target.error||void 0;return vi.create(V,{originalErrorMessage:W&&W?.message})}const no="app_namespace_store";class ar{constructor(V,W,ut,Mt=function pd(){return new Promise((U,V)=>{try{const W=indexedDB.open("firebase_remote_config",1);W.onerror=ut=>{V(Zr(ut,"storage-open"))},W.onsuccess=ut=>{U(ut.target.result)},W.onupgradeneeded=ut=>{0===ut.oldVersion&&ut.target.result.createObjectStore(no,{keyPath:"compositeKey"})}}catch(W){V(vi.create("storage-open",{originalErrorMessage:W?.message}))}})}()){this.appId=V,this.appName=W,this.namespace=ut,this.openDbPromise=Mt}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(V){return this.set("last_fetch_status",V)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(V){return this.set("last_successful_fetch_timestamp_millis",V)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(V){return this.set("last_successful_fetch_response",V)}getActiveConfig(){return this.get("active_config")}setActiveConfig(V){return this.set("active_config",V)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(V){return this.set("active_config_etag",V)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(V){return this.set("throttle_metadata",V)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(V){var W=this;return(0,It.Z)(function*(){const ut=yield W.openDbPromise;return new Promise((Mt,Lt)=>{const on=ut.transaction([no],"readonly").objectStore(no),nn=W.createCompositeKey(V);try{const xn=on.get(nn);xn.onerror=mr=>{Lt(Zr(mr,"storage-get"))},xn.onsuccess=mr=>{const hr=mr.target.result;Mt(hr?hr.value:void 0)}}catch(xn){Lt(vi.create("storage-get",{originalErrorMessage:xn?.message}))}})})()}set(V,W){var ut=this;return(0,It.Z)(function*(){const Mt=yield ut.openDbPromise;return new Promise((Lt,se)=>{const nn=Mt.transaction([no],"readwrite").objectStore(no),xn=ut.createCompositeKey(V);try{const mr=nn.put({compositeKey:xn,value:W});mr.onerror=hr=>{se(Zr(hr,"storage-set"))},mr.onsuccess=()=>{Lt()}}catch(mr){se(vi.create("storage-set",{originalErrorMessage:mr?.message}))}})})()}delete(V){var W=this;return(0,It.Z)(function*(){const ut=yield W.openDbPromise;return new Promise((Mt,Lt)=>{const on=ut.transaction([no],"readwrite").objectStore(no),nn=W.createCompositeKey(V);try{const xn=on.delete(nn);xn.onerror=mr=>{Lt(Zr(mr,"storage-delete"))},xn.onsuccess=()=>{Mt()}}catch(xn){Lt(vi.create("storage-delete",{originalErrorMessage:xn?.message}))}})})()}createCompositeKey(V){return[this.appId,this.appName,this.namespace,V].join()}}class Ws{constructor(V){this.storage=V}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var V=this;return(0,It.Z)(function*(){const W=V.storage.getLastFetchStatus(),ut=V.storage.getLastSuccessfulFetchTimestampMillis(),Mt=V.storage.getActiveConfig(),Lt=yield W;Lt&&(V.lastFetchStatus=Lt);const se=yield ut;se&&(V.lastSuccessfulFetchTimestampMillis=se);const on=yield Mt;on&&(V.activeConfig=on)})()}setLastFetchStatus(V){return this.lastFetchStatus=V,this.storage.setLastFetchStatus(V)}setLastSuccessfulFetchTimestampMillis(V){return this.lastSuccessfulFetchTimestampMillis=V,this.storage.setLastSuccessfulFetchTimestampMillis(V)}setActiveConfig(V){return this.activeConfig=V,this.storage.setActiveConfig(V)}}function uu(){return Ga.apply(this,arguments)}function Ga(){return(Ga=(0,It.Z)(function*(){if(!(0,lt.hl)())return!1;try{return yield(0,lt.eu)()}catch{return!1}})).apply(this,arguments)}!function Cc(){(0,vt._registerComponent)(new ye.wA("remote-config",function U(V,{instanceIdentifier:W}){const ut=V.getProvider("app").getImmediate(),Mt=V.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw vi.create("registration-window");if(!(0,lt.hl)())throw vi.create("indexed-db-unavailable");const{projectId:Lt,apiKey:se,appId:on}=ut.options;if(!Lt)throw vi.create("registration-project-id");if(!se)throw vi.create("registration-api-key");if(!on)throw vi.create("registration-app-id");const nn=new ar(on,ut.name,W=W||"firebase"),xn=new Ws(nn),mr=new ke.Yd(lu);mr.logLevel=ke.in.ERROR;const hr=new Tr(Mt,vt.SDK_VERSION,W,Lt,se,on),_o=new Ye(hr,nn),Ci=new Ae(_o,nn,xn,mr),si=new $a(ut,Ci,xn,nn,mr);return function Fe(U){const V=(0,lt.m9)(U);V._initializePromise||(V._initializePromise=V._storageCache.loadFromStorage().then(()=>{V._isInitializationComplete=!0}))}(si),si},"PUBLIC").setMultipleInstances(!0)),(0,vt.registerVersion)(lu,"0.4.4"),(0,vt.registerVersion)(lu,"0.4.4","esm2017")}();const fi=(U,V)=>V.some(W=>U instanceof W);let bn,Hf;const Ri=new WeakMap,sa=new WeakMap,Yn=new WeakMap,gi=new WeakMap,Bl=new WeakMap;let Ko={get(U,V,W){if(U instanceof IDBTransaction){if("done"===V)return sa.get(U);if("objectStoreNames"===V)return U.objectStoreNames||Yn.get(U);if("store"===V)return W.objectStoreNames[1]?void 0:W.objectStore(W.objectStoreNames[0])}return aa(U[V])},set:(U,V,W)=>(U[V]=W,!0),has:(U,V)=>U instanceof IDBTransaction&&("done"===V||"store"===V)||V in U};function zo(U){return"function"==typeof U?function du(U){return U!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function pi(){return Hf||(Hf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(U)?function(...V){return U.apply(bi(this),V),aa(Ri.get(this))}:function(...V){return aa(U.apply(bi(this),V))}:function(V,...W){const ut=U.call(bi(this),V,...W);return Yn.set(ut,V.sort?V.sort():[V]),aa(ut)}}(U):(U instanceof IDBTransaction&&function Ms(U){if(sa.has(U))return;const V=new Promise((W,ut)=>{const Mt=()=>{U.removeEventListener("complete",Lt),U.removeEventListener("error",se),U.removeEventListener("abort",se)},Lt=()=>{W(),Mt()},se=()=>{ut(U.error||new DOMException("AbortError","AbortError")),Mt()};U.addEventListener("complete",Lt),U.addEventListener("error",se),U.addEventListener("abort",se)});sa.set(U,V)}(U),fi(U,function ia(){return bn||(bn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(U,Ko):U)}function aa(U){if(U instanceof IDBRequest)return function gd(U){const V=new Promise((W,ut)=>{const Mt=()=>{U.removeEventListener("success",Lt),U.removeEventListener("error",se)},Lt=()=>{W(aa(U.result)),Mt()},se=()=>{ut(U.error),Mt()};U.addEventListener("success",Lt),U.addEventListener("error",se)});return V.then(W=>{W instanceof IDBCursor&&Ri.set(W,U)}).catch(()=>{}),Bl.set(V,U),V}(U);if(gi.has(U))return gi.get(U);const V=zo(U);return V!==U&&(gi.set(U,V),Bl.set(V,U)),V}const bi=U=>Bl.get(U);function Un(U,V,{blocked:W,upgrade:ut,blocking:Mt,terminated:Lt}={}){const se=indexedDB.open(U,V),on=aa(se);return ut&&se.addEventListener("upgradeneeded",nn=>{ut(aa(se.result),nn.oldVersion,nn.newVersion,aa(se.transaction))}),W&&se.addEventListener("blocked",()=>W()),on.then(nn=>{Lt&&nn.addEventListener("close",()=>Lt()),Mt&&nn.addEventListener("versionchange",()=>Mt())}).catch(()=>{}),on}function hu(U,{blocked:V}={}){const W=indexedDB.deleteDatabase(U);return V&&W.addEventListener("blocked",()=>V()),aa(W).then(()=>{})}const _l=["get","getKey","getAll","getAllKeys","count"],Ha=["put","add","delete","clear"],la=new Map;function fu(U,V){if(!(U instanceof IDBDatabase)||V in U||"string"!=typeof V)return;if(la.get(V))return la.get(V);const W=V.replace(/FromIndex$/,""),ut=V!==W,Mt=Ha.includes(W);if(!(W in(ut?IDBIndex:IDBObjectStore).prototype)||!Mt&&!_l.includes(W))return;const Lt=function(){var se=(0,It.Z)(function*(on,...nn){const xn=this.transaction(on,Mt?"readwrite":"readonly");let mr=xn.store;return ut&&(mr=mr.index(nn.shift())),(yield Promise.all([mr[W](...nn),Mt&&xn.done]))[0]});return function(nn){return se.apply(this,arguments)}}();return la.set(V,Lt),Lt}!function Ul(U){Ko=U(Ko)}(U=>({...U,get:(V,W,ut)=>fu(V,W)||U.get(V,W,ut),has:(V,W)=>!!fu(V,W)||U.has(V,W)}));const yl="/firebase-messaging-sw.js",ug="/firebase-cloud-messaging-push-scope",vl="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",vh="https://fcmregistrations.googleapis.com/v1",Yo="google.c.a.c_id",qy="google.c.a.c_l",gw="google.c.a.ts";var qf=function(U){return U.PUSH_RECEIVED="push-received",U.NOTIFICATION_CLICKED="notification-clicked",U}(qf||{});function Ps(U){const V=new Uint8Array(U);return btoa(String.fromCharCode(...V)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function jm(U){const W=(U+"=".repeat((4-U.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),ut=atob(W),Mt=new Uint8Array(ut.length);for(let Lt=0;Lt<ut.length;++Lt)Mt[Lt]=ut.charCodeAt(Lt);return Mt}const pu="fcm_token_details_db",qa=5,fb="fcm_token_object_Store";function hg(){return hg=(0,It.Z)(function*(U){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(Lt=>Lt.name).includes(pu))return null;let V=null;return(yield Un(pu,qa,{upgrade:(ut=(0,It.Z)(function*(Mt,Lt,se,on){var nn;if(Lt<2||!Mt.objectStoreNames.contains(fb))return;const xn=on.objectStore(fb),mr=yield xn.index("fcmSenderId").get(U);if(yield xn.clear(),mr)if(2===Lt){const hr=mr;if(!hr.auth||!hr.p256dh||!hr.endpoint)return;V={token:hr.fcmToken,createTime:null!==(nn=hr.createTime)&&void 0!==nn?nn:Date.now(),subscriptionOptions:{auth:hr.auth,p256dh:hr.p256dh,endpoint:hr.endpoint,swScope:hr.swScope,vapidKey:"string"==typeof hr.vapidKey?hr.vapidKey:Ps(hr.vapidKey)}}}else if(3===Lt){const hr=mr;V={token:hr.fcmToken,createTime:hr.createTime,subscriptionOptions:{auth:Ps(hr.auth),p256dh:Ps(hr.p256dh),endpoint:hr.endpoint,swScope:hr.swScope,vapidKey:Ps(hr.vapidKey)}}}else if(4===Lt){const hr=mr;V={token:hr.fcmToken,createTime:hr.createTime,subscriptionOptions:{auth:Ps(hr.auth),p256dh:Ps(hr.p256dh),endpoint:hr.endpoint,swScope:hr.swScope,vapidKey:Ps(hr.vapidKey)}}}}),function(Lt,se,on,nn){return ut.apply(this,arguments)})})).close(),yield hu(pu),yield hu("fcm_vapid_details_db"),yield hu("undefined"),function xh(U){if(!U||!U.subscriptionOptions)return!1;const{subscriptionOptions:V}=U;return"number"==typeof U.createTime&&U.createTime>0&&"string"==typeof U.token&&U.token.length>0&&"string"==typeof V.auth&&V.auth.length>0&&"string"==typeof V.p256dh&&V.p256dh.length>0&&"string"==typeof V.endpoint&&V.endpoint.length>0&&"string"==typeof V.swScope&&V.swScope.length>0&&"string"==typeof V.vapidKey&&V.vapidKey.length>0}(V)?V:null;var ut}),hg.apply(this,arguments)}const $m="firebase-messaging-database",md=1,wa="firebase-messaging-store";let Zf=null;function Vl(){return Zf||(Zf=Un($m,md,{upgrade:(U,V)=>{0===V&&U.createObjectStore(wa)}})),Zf}function ca(U){return gu.apply(this,arguments)}function gu(){return gu=(0,It.Z)(function*(U){const V=Ch(U),ut=yield(yield Vl()).transaction(wa).objectStore(wa).get(V);if(ut)return ut;{const Mt=yield function Zy(U){return hg.apply(this,arguments)}(U.appConfig.senderId);if(Mt)return yield wh(U,Mt),Mt}}),gu.apply(this,arguments)}function wh(U,V){return qi.apply(this,arguments)}function qi(){return(qi=(0,It.Z)(function*(U,V){const W=Ch(U),Mt=(yield Vl()).transaction(wa,"readwrite");return yield Mt.objectStore(wa).put(V,W),yield Mt.done,V})).apply(this,arguments)}function Qi(){return(Qi=(0,It.Z)(function*(U){const V=Ch(U),ut=(yield Vl()).transaction(wa,"readwrite");yield ut.objectStore(wa).delete(V),yield ut.done})).apply(this,arguments)}function Ch({appConfig:U}){return U.appId}const Li=new lt.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function fg(U,V){return Mc.apply(this,arguments)}function Mc(){return(Mc=(0,It.Z)(function*(U,V){const W=yield Gl(U),ut=Hl(V),Mt={method:"POST",headers:W,body:JSON.stringify(ut)};let Lt;try{Lt=yield(yield fetch($l(U.appConfig),Mt)).json()}catch(se){throw Li.create("token-subscribe-failed",{errorInfo:se?.toString()})}if(Lt.error)throw Li.create("token-subscribe-failed",{errorInfo:Lt.error.message});if(!Lt.token)throw Li.create("token-subscribe-no-token");return Lt.token})).apply(this,arguments)}function jl(){return(jl=(0,It.Z)(function*(U,V){const W=yield Gl(U),ut=Hl(V.subscriptionOptions),Mt={method:"PATCH",headers:W,body:JSON.stringify(ut)};let Lt;try{Lt=yield(yield fetch(`${$l(U.appConfig)}/${V.token}`,Mt)).json()}catch(se){throw Li.create("token-update-failed",{errorInfo:se?.toString()})}if(Lt.error)throw Li.create("token-update-failed",{errorInfo:Lt.error.message});if(!Lt.token)throw Li.create("token-update-no-token");return Lt.token})).apply(this,arguments)}function Za(U,V){return Pc.apply(this,arguments)}function Pc(){return(Pc=(0,It.Z)(function*(U,V){const ut={method:"DELETE",headers:yield Gl(U)};try{const Lt=yield(yield fetch(`${$l(U.appConfig)}/${V}`,ut)).json();if(Lt.error)throw Li.create("token-unsubscribe-failed",{errorInfo:Lt.error.message})}catch(Mt){throw Li.create("token-unsubscribe-failed",{errorInfo:Mt?.toString()})}})).apply(this,arguments)}function $l({projectId:U}){return`${vh}/projects/${U}/registrations`}function Gl(U){return Wa.apply(this,arguments)}function Wa(){return(Wa=(0,It.Z)(function*({appConfig:U,installations:V}){const W=yield V.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":U.apiKey,"x-goog-firebase-installations-auth":`FIS ${W}`})})).apply(this,arguments)}function Hl({p256dh:U,auth:V,endpoint:W,vapidKey:ut}){const Mt={web:{endpoint:W,auth:V,p256dh:U}};return ut!==vl&&(Mt.web.applicationPubKey=ut),Mt}const Mh=6048e5;function Hm(){return Hm=(0,It.Z)(function*(U){const V=yield function yd(U,V){return Eh.apply(this,arguments)}(U.swRegistration,U.vapidKey),W={vapidKey:U.vapidKey,swScope:U.swRegistration.scope,endpoint:V.endpoint,auth:Ps(V.getKey("auth")),p256dh:Ps(V.getKey("p256dh"))},ut=yield ca(U.firebaseDependencies);if(ut){if(function pg(U,V){return V.vapidKey===U.vapidKey&&V.endpoint===U.endpoint&&V.auth===U.auth&&V.p256dh===U.p256dh}(ut.subscriptionOptions,W))return Date.now()>=ut.createTime+Mh?function Wm(U,V){return Km.apply(this,arguments)}(U,{token:ut.token,createTime:Date.now(),subscriptionOptions:W}):ut.token;try{yield Za(U.firebaseDependencies,ut.token)}catch(Mt){console.warn(Mt)}return Ph(U.firebaseDependencies,W)}return Ph(U.firebaseDependencies,W)}),Hm.apply(this,arguments)}function Zm(){return Zm=(0,It.Z)(function*(U){const V=yield ca(U.firebaseDependencies);V&&(yield Za(U.firebaseDependencies,V.token),yield function _d(U){return Qi.apply(this,arguments)}(U.firebaseDependencies));const W=yield U.swRegistration.pushManager.getSubscription();return!W||W.unsubscribe()}),Zm.apply(this,arguments)}function Km(){return Km=(0,It.Z)(function*(U,V){try{const W=yield function Gm(U,V){return jl.apply(this,arguments)}(U.firebaseDependencies,V),ut=Object.assign(Object.assign({},V),{token:W,createTime:Date.now()});return yield wh(U.firebaseDependencies,ut),W}catch(W){throw yield function qm(U){return Zm.apply(this,arguments)}(U),W}}),Km.apply(this,arguments)}function Ph(U,V){return Oh.apply(this,arguments)}function Oh(){return(Oh=(0,It.Z)(function*(U,V){const ut={token:yield fg(U,V),createTime:Date.now(),subscriptionOptions:V};return yield wh(U,ut),ut.token})).apply(this,arguments)}function Eh(){return(Eh=(0,It.Z)(function*(U,V){return(yield U.pushManager.getSubscription())||U.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:jm(V)})})).apply(this,arguments)}function Kf(U){const V={from:U.from,collapseKey:U.collapse_key,messageId:U.fcmMessageId};return function vd(U,V){if(!V.notification)return;U.notification={};const W=V.notification.title;W&&(U.notification.title=W);const ut=V.notification.body;ut&&(U.notification.body=ut);const Mt=V.notification.image;Mt&&(U.notification.image=Mt);const Lt=V.notification.icon;Lt&&(U.notification.icon=Lt)}(V,U),function gg(U,V){V.data&&(U.data=V.data)}(V,U),function bd(U,V){var W,ut,Mt,Lt,se;if(!(V.fcmOptions||null!==(W=V.notification)&&void 0!==W&&W.click_action))return;U.fcmOptions={};const on=null!==(Mt=null===(ut=V.fcmOptions)||void 0===ut?void 0:ut.link)&&void 0!==Mt?Mt:null===(Lt=V.notification)||void 0===Lt?void 0:Lt.click_action;on&&(U.fcmOptions.link=on);const nn=null===(se=V.fcmOptions)||void 0===se?void 0:se.analytics_label;nn&&(U.fcmOptions.analyticsLabel=nn)}(V,U),V}function Yf(U,V){const W=[];for(let ut=0;ut<U.length;ut++)W.push(U.charAt(ut)),ut<V.length&&W.push(V.charAt(ut));return W.join("")}function Oc(U){return Li.create("missing-app-config-values",{valueName:U})}Yf("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Yf("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class mg{constructor(V,W,ut){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const Mt=function Th(U){if(!U||!U.options)throw Oc("App Configuration Object");if(!U.name)throw Oc("App Name");const V=["projectId","apiKey","appId","messagingSenderId"],{options:W}=U;for(const ut of V)if(!W[ut])throw Oc(ut);return{appName:U.name,projectId:W.projectId,apiKey:W.apiKey,appId:W.appId,senderId:W.messagingSenderId}}(V);this.firebaseDependencies={app:V,appConfig:Mt,installations:W,analyticsProvider:ut}}_delete(){return Promise.resolve()}}function _u(){return(_u=(0,It.Z)(function*(U){try{U.swRegistration=yield navigator.serviceWorker.register(yl,{scope:ug}),U.swRegistration.update().catch(()=>{})}catch(V){throw Li.create("failed-service-worker-registration",{browserErrorMessage:V?.message})}})).apply(this,arguments)}function Ca(){return(Ca=(0,It.Z)(function*(U,V){if(!V&&!U.swRegistration&&(yield function mu(U){return _u.apply(this,arguments)}(U)),V||!U.swRegistration){if(!(V instanceof ServiceWorkerRegistration))throw Li.create("invalid-sw-registration");U.swRegistration=V}})).apply(this,arguments)}function Ec(){return(Ec=(0,It.Z)(function*(U,V){V?U.vapidKey=V:U.vapidKey||(U.vapidKey=vl)})).apply(this,arguments)}function Sh(){return Sh=(0,It.Z)(function*(U,V){if(!navigator)throw Li.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw Li.create("permission-blocked");return yield function wd(U,V){return Ec.apply(this,arguments)}(U,V?.vapidKey),yield function Ih(U,V){return Ca.apply(this,arguments)}(U,V?.serviceWorkerRegistration),function Wf(U){return Hm.apply(this,arguments)}(U)}),Sh.apply(this,arguments)}function vn(){return(vn=(0,It.Z)(function*(U,V,W){const ut=function _g(U){switch(U){case qf.NOTIFICATION_CLICKED:return"notification_open";case qf.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(V);(yield U.firebaseDependencies.analyticsProvider.get()).logEvent(ut,{message_id:W[Yo],message_name:W[qy],message_time:W[gw],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function ql(){return ql=(0,It.Z)(function*(U,V){const W=V.data;if(!W.isFirebaseMessaging)return;U.onMessageHandler&&W.messageType===qf.PUSH_RECEIVED&&("function"==typeof U.onMessageHandler?U.onMessageHandler(Kf(W)):U.onMessageHandler.next(Kf(W)));const ut=W.data;(function xd(U){return"object"==typeof U&&!!U&&Yo in U})(ut)&&"1"===ut["google.c.a.e"]&&(yield function Ym(U,V,W){return vn.apply(this,arguments)}(U,W.messageType,ut))}),ql.apply(this,arguments)}const Ah="@firebase/messaging",Tc=U=>{const V=new mg(U.getProvider("app").getImmediate(),U.getProvider("installations-internal").getImmediate(),U.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",W=>function Md(U,V){return ql.apply(this,arguments)}(V,W)),V},Xm=U=>{const V=U.getProvider("messaging").getImmediate();return{getToken:ut=>function Cd(U,V){return Sh.apply(this,arguments)}(V,ut)}};function Xf(){return yu.apply(this,arguments)}function yu(){return(yu=(0,It.Z)(function*(){try{yield(0,lt.eu)()}catch{return!1}return typeof window<"u"&&(0,lt.hl)()&&(0,lt.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function Bo(){(0,vt._registerComponent)(new ye.wA("messaging",Tc,"PUBLIC")),(0,vt._registerComponent)(new ye.wA("messaging-internal",Xm,"PRIVATE")),(0,vt.registerVersion)(Ah,"0.12.4"),(0,vt.registerVersion)(Ah,"0.12.4","esm2017")}();const Os="analytics",Jf="firebase_id",tp="origin",Pd=6e4,Ka="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",xu="https://www.googletagmanager.com/gtag/js",Ni=new ke.Yd("@firebase/analytics"),xi=new lt.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function ep(U){if(!U.startsWith(xu)){const V=xi.create("invalid-gtag-resource",{gtagURL:U});return Ni.warn(V.message),""}return U}function wu(U){return Promise.all(U.map(V=>V.catch(W=>W)))}function Sc(){return(Sc=(0,It.Z)(function*(U,V,W,ut,Mt,Lt){const se=ut[Mt];try{if(se)yield V[se];else{const nn=(yield wu(W)).find(xn=>xn.measurementId===Mt);nn&&(yield V[nn.appId])}}catch(on){Ni.error(on)}U("config",Mt,Lt)})).apply(this,arguments)}function Ks(){return(Ks=(0,It.Z)(function*(U,V,W,ut,Mt){try{let Lt=[];if(Mt&&Mt.send_to){let se=Mt.send_to;Array.isArray(se)||(se=[se]);const on=yield wu(W);for(const nn of se){const xn=on.find(hr=>hr.measurementId===nn),mr=xn&&V[xn.appId];if(!mr){Lt=[];break}Lt.push(mr)}}0===Lt.length&&(Lt=Object.values(V)),yield Promise.all(Lt),U("event",ut,Mt||{})}catch(Lt){Ni.error(Lt)}})).apply(this,arguments)}const ro=30,fs=new class Ed{constructor(V={},W=1e3){this.throttleMetadata=V,this.intervalMillis=W}getThrottleMetadata(V){return this.throttleMetadata[V]}setThrottleMetadata(V,W){this.throttleMetadata[V]=W}deleteThrottleMetadata(V){delete this.throttleMetadata[V]}};function t_(U){return new Headers({Accept:"application/json","x-goog-api-key":U})}function Ya(){return(Ya=(0,It.Z)(function*(U){var V;const{appId:W,apiKey:ut}=U,Mt={method:"GET",headers:t_(ut)},Lt=Ka.replace("{app-id}",W),se=yield fetch(Lt,Mt);if(200!==se.status&&304!==se.status){let on="";try{const nn=yield se.json();null!==(V=nn.error)&&void 0!==V&&V.message&&(on=nn.error.message)}catch{}throw xi.create("config-fetch-failed",{httpStatus:se.status,responseMessage:on})}return se.json()})).apply(this,arguments)}function op(){return(op=(0,It.Z)(function*(U,V=fs,W){const{appId:ut,apiKey:Mt,measurementId:Lt}=U.options;if(!ut)throw xi.create("no-app-id");if(!Mt){if(Lt)return{measurementId:Lt,appId:ut};throw xi.create("no-api-key")}const se=V.getThrottleMetadata(ut)||{backoffCount:0,throttleEndTimeMillis:Date.now()},on=new bl;return setTimeout((0,It.Z)(function*(){on.abort()}),void 0!==W?W:Pd),vg({appId:ut,apiKey:Mt,measurementId:Lt},se,on,V)})).apply(this,arguments)}function vg(U,V,W){return bg.apply(this,arguments)}function bg(){return bg=(0,It.Z)(function*(U,{throttleEndTimeMillis:V,backoffCount:W},ut,Mt=fs){var Lt;const{appId:se,measurementId:on}=U;try{yield function Rh(U,V){return new Promise((W,ut)=>{const Mt=Math.max(V-Date.now(),0),Lt=setTimeout(W,Mt);U.addEventListener(()=>{clearTimeout(Lt),ut(xi.create("fetch-throttle",{throttleEndTimeMillis:V}))})})}(ut,V)}catch(nn){if(on)return Ni.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${on} provided in the "measurementId" field in the local Firebase config. [${nn?.message}]`),{appId:se,measurementId:on};throw nn}try{const nn=yield function rp(U){return Ya.apply(this,arguments)}(U);return Mt.deleteThrottleMetadata(se),nn}catch(nn){const xn=nn;if(!function Ls(U){if(!(U instanceof lt.ZR&&U.customData))return!1;const V=Number(U.customData.httpStatus);return 429===V||500===V||503===V||504===V}(xn)){if(Mt.deleteThrottleMetadata(se),on)return Ni.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${on} provided in the "measurementId" field in the local Firebase config. [${xn?.message}]`),{appId:se,measurementId:on};throw nn}const mr=503===Number(null===(Lt=xn?.customData)||void 0===Lt?void 0:Lt.httpStatus)?(0,lt.$s)(W,Mt.intervalMillis,ro):(0,lt.$s)(W,Mt.intervalMillis),hr={throttleEndTimeMillis:Date.now()+mr,backoffCount:W+1};return Mt.setThrottleMetadata(se,hr),Ni.debug(`Calling attemptFetch again in ${mr} millis`),vg(U,hr,ut,Mt)}}),bg.apply(this,arguments)}class bl{constructor(){this.listeners=[]}addEventListener(V){this.listeners.push(V)}abort(){this.listeners.forEach(V=>V())}}let Td,kc;function Ma(){return(Ma=(0,It.Z)(function*(U,V,W,ut,Mt){if(Mt&&Mt.global)U("event",W,ut);else{const Lt=yield V;U("event",W,Object.assign(Object.assign({},ut),{send_to:Lt}))}})).apply(this,arguments)}function Pu(){return(Pu=(0,It.Z)(function*(){if(!(0,lt.hl)())return Ni.warn(xi.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,lt.eu)()}catch(U){return Ni.warn(xi.create("indexeddb-unavailable",{errorInfo:U?.toString()}).message),!1}return!0})).apply(this,arguments)}function Zl(){return Zl=(0,It.Z)(function*(U,V,W,ut,Mt,Lt,se){var on;const nn=function kh(U){return op.apply(this,arguments)}(U);nn.then(Ci=>{W[Ci.measurementId]=Ci.appId,U.options.measurementId&&Ci.measurementId!==U.options.measurementId&&Ni.warn(`The measurement ID in the local Firebase config (${U.options.measurementId}) does not match the measurement ID fetched from the server (${Ci.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(Ci=>Ni.error(Ci)),V.push(nn);const xn=function n_(){return Pu.apply(this,arguments)}().then(Ci=>{if(Ci)return ut.getId()}),[mr,hr]=yield Promise.all([nn,xn]);(function Me(U){const V=window.document.getElementsByTagName("script");for(const W of Object.values(V))if(W.src&&W.src.includes(xu)&&W.src.includes(U))return W;return null})(Lt)||function Wy(U,V){const W=function Dh(U,V){let W;return window.trustedTypes&&(W=window.trustedTypes.createPolicy(U,V)),W}("firebase-js-sdk-policy",{createScriptURL:ep}),ut=document.createElement("script"),Mt=`${xu}?l=${U}&id=${V}`;ut.src=W?W?.createScriptURL(Mt):Mt,ut.async=!0,document.head.appendChild(ut)}(Lt,mr.measurementId),kc&&(Mt("consent","default",kc),function Rc(U){kc=U}(void 0)),Mt("js",new Date);const _o=null!==(on=se?.config)&&void 0!==on?on:{};return _o[tp]="firebase",_o.update=!0,null!=hr&&(_o[Jf]=hr),Mt("config",mr.measurementId,_o),Td&&(Mt("set",Td),function xl(U){Td=U}(void 0)),mr.measurementId}),Zl.apply(this,arguments)}class xg{constructor(V){this.app=V}_delete(){return delete oi[this.app.options.appId],Promise.resolve()}}let oi={},Eu=[];const Xo={};let sp,Es,wl="dataLayer",Je=!1;function $r(U,V,W){!function Oa(){const U=[];if((0,lt.ru)()&&U.push("This is a browser extension environment."),(0,lt.zI)()||U.push("Cookies are not available."),U.length>0){const V=U.map((ut,Mt)=>`(${Mt+1}) ${ut}`).join(" "),W=xi.create("invalid-analytics-context",{errorInfo:V});Ni.warn(W.message)}}();const ut=U.options.appId;if(!ut)throw xi.create("no-app-id");if(!U.options.apiKey){if(!U.options.measurementId)throw xi.create("no-api-key");Ni.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${U.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=oi[ut])throw xi.create("already-exists",{id:ut});if(!Je){!function Od(U){let V=[];Array.isArray(window[U])?V=window[U]:window[U]=V}(wl);const{wrappedGtag:Lt,gtagCore:se}=function np(U,V,W,ut,Mt){let Lt=function(...se){window[ut].push(arguments)};return window[Mt]&&"function"==typeof window[Mt]&&(Lt=window[Mt]),window[Mt]=function Jm(U,V,W,ut){function Lt(){return Lt=(0,It.Z)(function*(se,...on){try{if("event"===se){const[nn,xn]=on;yield function Qm(U,V,W,ut,Mt){return Ks.apply(this,arguments)}(U,V,W,nn,xn)}else if("config"===se){const[nn,xn]=on;yield function Cu(U,V,W,ut,Mt,Lt){return Sc.apply(this,arguments)}(U,V,W,ut,nn,xn)}else if("consent"===se){const[nn]=on;U("consent","update",nn)}else if("get"===se){const[nn,xn,mr]=on;U("get",nn,xn,mr)}else if("set"===se){const[nn]=on;U("set",nn)}else U(se,...on)}catch(nn){Ni.error(nn)}}),Lt.apply(this,arguments)}return function Mt(se){return Lt.apply(this,arguments)}}(Lt,U,V,W),{gtagCore:Lt,wrappedGtag:window[Mt]}}(oi,Eu,Xo,wl,"gtag");Es=Lt,sp=se,Je=!0}return oi[ut]=function Ou(U,V,W,ut,Mt,Lt,se){return Zl.apply(this,arguments)}(U,Eu,Xo,V,sp,wl,W),new xg(U)}function Sd(){return Ts.apply(this,arguments)}function Ts(){return(Ts=(0,It.Z)(function*(){if((0,lt.ru)()||!(0,lt.zI)()||!(0,lt.hl)())return!1;try{return yield(0,lt.eu)()}catch{return!1}})).apply(this,arguments)}const o_="@firebase/analytics";!function Fh(){(0,vt._registerComponent)(new ye.wA(Os,(V,{options:W})=>$r(V.getProvider("app").getImmediate(),V.getProvider("installations-internal").getImmediate(),W),"PUBLIC")),(0,vt._registerComponent)(new ye.wA("analytics-internal",function U(V){try{const W=V.getProvider(Os).getImmediate();return{logEvent:(ut,Mt,Lt)=>function r_(U,V,W,ut){U=(0,lt.m9)(U),function Id(U,V,W,ut,Mt){return Ma.apply(this,arguments)}(Es,oi[U.app.options.appId],V,W,ut).catch(Mt=>Ni.error(Mt))}(W,ut,Mt,Lt)}}catch(W){throw xi.create("interop-component-reg-failed",{reason:W})}},"PRIVATE")),(0,vt.registerVersion)(o_,"0.10.0"),(0,vt.registerVersion)(o_,"0.10.0","esm2017")}();var ps=ft(7394);class lp extends ps.w0{constructor(V,W){super()}schedule(V,W=0){return this}}const ha={setInterval(U,V,...W){const{delegate:ut}=ha;return ut?.setInterval?ut.setInterval(U,V,...W):setInterval(U,V,...W)},clearInterval(U){const{delegate:V}=ha;return(V?.clearInterval||clearInterval)(U)},delegate:void 0};var Xl=ft(9039);class Dd extends lp{constructor(V,W){super(V,W),this.scheduler=V,this.work=W,this.pending=!1}schedule(V,W=0){var ut;if(this.closed)return this;this.state=V;const Mt=this.id,Lt=this.scheduler;return null!=Mt&&(this.id=this.recycleAsyncId(Lt,Mt,W)),this.pending=!0,this.delay=W,this.id=null!==(ut=this.id)&&void 0!==ut?ut:this.requestAsyncId(Lt,this.id,W),this}requestAsyncId(V,W,ut=0){return ha.setInterval(V.flush.bind(V,this),ut)}recycleAsyncId(V,W,ut=0){if(null!=ut&&this.delay===ut&&!1===this.pending)return W;null!=W&&ha.clearInterval(W)}execute(V,W){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ut=this._execute(V,W);if(ut)return ut;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(V,W){let Mt,ut=!1;try{this.work(V)}catch(Lt){ut=!0,Mt=Lt||new Error("Scheduled action threw falsy error")}if(ut)return this.unsubscribe(),Mt}unsubscribe(){if(!this.closed){const{id:V,scheduler:W}=this,{actions:ut}=W;this.work=this.state=this.scheduler=null,this.pending=!1,(0,Xl.P)(ut,this),null!=V&&(this.id=this.recycleAsyncId(W,V,null)),this.delay=null,super.unsubscribe()}}}var kd=ft(4552);class Ja{constructor(V,W=Ja.now){this.schedulerActionCtor=V,this.now=W}schedule(V,W=0,ut){return new this.schedulerActionCtor(this,V).schedule(ut,W)}}Ja.now=kd.l.now;class cp extends Ja{constructor(V,W=Ja.now){super(V,W),this.actions=[],this._active=!1}flush(V){const{actions:W}=this;if(this._active)return void W.push(V);let ut;this._active=!0;do{if(ut=V.execute(V.state,V.delay))break}while(V=W.shift());if(this._active=!1,ut){for(;V=W.shift();)V.unsubscribe();throw ut}}}const up=new class Cl extends cp{}(class Qa extends Dd{constructor(V,W){super(V,W),this.scheduler=V,this.work=W}schedule(V,W=0){return W>0?super.schedule(V,W):(this.delay=W,this.state=V,this.scheduler.flush(this),this)}execute(V,W){return W>0||this.closed?super.execute(V,W):this._execute(V,W)}requestAsyncId(V,W,ut=0){return null!=ut&&ut>0||null==ut&&this.delay>0?super.requestAsyncId(V,W,ut):(V.flush(this),0)}}),Ys=new cp(Dd);var Ml=ft(5592),Rd=ft(9397),dp=ft(5137),Iu=ft(3093);const Ld=new x.GfV("7.6.1"),wi="__angularfire_symbol__analyticsIsSupportedValue",zh="__angularfire_symbol__analyticsIsSupported",Su="__angularfire_symbol__remoteConfigIsSupportedValue",Ea="__angularfire_symbol__remoteConfigIsSupported",Nd="__angularfire_symbol__messagingIsSupportedValue",hp="__angularfire_symbol__messagingIsSupported";function fp(U,V,W){if(V){if(1===V.length)return V[0];const Lt=V.filter(se=>se.app===W);if(1===Lt.length)return Lt[0]}return W.container.getProvider(U).getImmediate({optional:!0})}globalThis[zh]||(globalThis[zh]=Sd().then(U=>globalThis[wi]=U).catch(()=>globalThis[wi]=!1)),globalThis[hp]||(globalThis[hp]=Xf().then(U=>globalThis[Nd]=U).catch(()=>globalThis[Nd]=!1)),globalThis[Ea]||(globalThis[Ea]=uu().then(U=>globalThis[Su]=U).catch(()=>globalThis[Su]=!1));const Au=(U,V)=>{const W=V?[V]:(0,mt.C6)(),ut=[];return W.forEach(Mt=>{Mt.container.getProvider(U).instances.forEach(se=>{ut.includes(se)||ut.push(se)})}),ut};function Nc(){}class es{constructor(V,W=up){this.zone=V,this.delegate=W}now(){return this.delegate.now()}schedule(V,W,ut){const Mt=this.zone;return this.delegate.schedule(function(se){Mt.runGuarded(()=>{V.apply(this,[se])})},W,ut)}}class fa{constructor(V){this.zone=V,this.task=null}call(V,W){const ut=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Nc,{},Nc,Nc)),W.pipe((0,Rd.b)({next:ut,complete:ut,error:ut})).subscribe(V).add(ut)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let Uh=(()=>{class U{constructor(W){this.ngZone=W,this.outsideAngular=W.runOutsideAngular(()=>new es(Zone.current)),this.insideAngular=W.run(()=>new es(Zone.current,Ys)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return U.\u0275fac=function(W){return new(W||U)(x.LFG(x.R0b))},U.\u0275prov=x.Yz7({token:U,factory:U.\u0275fac,providedIn:"root"}),U})();function Ql(){const U=globalThis.\u0275AngularFireScheduler;if(!U)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return U}function Fi(U){return Ql().ngZone.run(()=>U())}function De(U){return Ql(),function ec(U){return function(W){return(W=W.lift(new fa(U.ngZone))).pipe((0,dp.R)(U.outsideAngular),(0,Iu.Q)(U.insideAngular))}}(Ql())(U)}const zd=(U,V)=>function(){const ut=arguments;return V&&setTimeout(()=>{"scheduled"===V.state&&V.invoke()},10),Fi(()=>U.apply(void 0,ut))},nc=(U,V)=>function(){let W;const ut=arguments;for(let Lt=0;Lt<arguments.length;Lt++)"function"==typeof ut[Lt]&&(V&&(W||(W=Fi(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Nc,{},Nc,Nc)))),ut[Lt]=zd(ut[Lt],W));const Mt=function Pl(U){return Ql().ngZone.runOutsideAngular(()=>U())}(()=>U.apply(this,ut));if(!V){if(Mt instanceof Ml.y){const Lt=Ql();return Mt.pipe((0,dp.R)(Lt.outsideAngular),(0,Iu.Q)(Lt.insideAngular))}return Fi(()=>Mt)}return Mt instanceof Ml.y?Mt.pipe(De):Mt instanceof Promise?Fi(()=>new Promise((Lt,se)=>Mt.then(on=>Fi(()=>Lt(on)),on=>Fi(()=>se(on))))):"function"==typeof Mt&&W?function(){return setTimeout(()=>{W&&"scheduled"===W.state&&W.invoke()},10),Mt.apply(this,arguments)}:Fi(()=>Mt)}},6710:(Hn,we,ft)=>{"use strict";ft.d(we,{$:()=>yl,A:()=>Ot,D:()=>re,I:()=>dd,J:()=>oa,L:()=>ws,N:()=>ve,P:()=>Ou,Q:()=>ar,R:()=>Ky,U:()=>Wo,V:()=>uu,W:()=>Ga,X:()=>xa,Y:()=>ia,Z:()=>pi,_:()=>Bl,a:()=>vu,a0:()=>vl,a1:()=>Yo,a2:()=>dg,a3:()=>fb,a4:()=>hg,a5:()=>$m,a6:()=>wa,a7:()=>Vl,a8:()=>gu,a9:()=>qi,aA:()=>Ct,aB:()=>Mg,aC:()=>le,aD:()=>xe,aE:()=>cp,aF:()=>Ad,aG:()=>Lh,aH:()=>Zo,aL:()=>Ic,aO:()=>bn,aa:()=>_d,ab:()=>Ch,ac:()=>Dt,ad:()=>Gm,ae:()=>Za,af:()=>$l,ai:()=>Mh,aj:()=>Hm,ak:()=>qm,an:()=>du,ao:()=>vd,aq:()=>Ec,ar:()=>Ah,as:()=>en,at:()=>Er,au:()=>Ke,av:()=>me,aw:()=>Mt,ax:()=>Iu,ay:()=>Qr,az:()=>tt,b:()=>Ji,c:()=>Es,d:()=>$r,e:()=>ts,f:()=>o_,g:()=>Xl,h:()=>ps,i:()=>yg,j:()=>kd,k:()=>xn,l:()=>da,m:()=>_o,o:()=>s_,p:()=>ue,r:()=>Mu,s:()=>Pa,u:()=>n_});var x=ft(5861),mt=ft(229),It=ft(1571),vt=ft(7582),lt=ft(7879),ye=ft(6820);const ue={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Ot={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const re=function Yt(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},tn=function Le(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},We=new mt.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Te=new lt.Yd("@firebase/auth");function Ce(z,...D){Te.logLevel<=lt.in.ERROR&&Te.error(`Auth (${It.SDK_VERSION}): ${z}`,...D)}function me(z,...D){throw Gt(z,...D)}function tt(z,...D){return Gt(z,...D)}function Xt(z,D,R){const j=Object.assign(Object.assign({},tn()),{[D]:R});return new mt.LL("auth","Firebase",j).create(D,{appName:z.name})}function Ve(z,D,R){if(!(D instanceof R))throw R.name!==D.constructor.name&&me(z,"argument-error"),Xt(z,"argument-error",`Type of ${D.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Gt(z,...D){if("string"!=typeof z){const R=D[0],j=[...D.slice(1)];return j[0]&&(j[0].appName=z.name),z._errorFactory.create(R,...j)}return We.create(z,...D)}function Ct(z,D,...R){if(!z)throw Gt(D,...R)}function ge(z){const D="INTERNAL ASSERTION FAILED: "+z;throw Ce(D),new Error(D)}function en(z,D){z||ge(D)}function Vo(){var z;return typeof self<"u"&&(null===(z=self.location)||void 0===z?void 0:z.href)||""}function cs(){return"http:"===Gi()||"https:"===Gi()}function Gi(){var z;return typeof self<"u"&&(null===(z=self.location)||void 0===z?void 0:z.protocol)||null}class Ne{constructor(D,R){this.shortDelay=D,this.longDelay=R,en(R>D,"Short delay should be less than long delay!"),this.isMobile=(0,mt.uI)()||(0,mt.b$)()}get(){return function us(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(cs()||(0,mt.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function vs(z,D){en(z.emulator,"Emulator should always be set here");const{url:R}=z.emulator;return D?`${R}${D.startsWith("/")?D.slice(1):D}`:R}class Wt{static initialize(D,R,j){this.fetchImpl=D,R&&(this.headersImpl=R),j&&(this.responseImpl=j)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void ge("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void ge("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void ge("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Kt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},pe=new Ne(3e4,6e4);function _t(z,D){return z.tenantId&&!D.tenantId?Object.assign(Object.assign({},D),{tenantId:z.tenantId}):D}function he(z,D,R,j){return Ue.apply(this,arguments)}function Ue(){return(Ue=(0,x.Z)(function*(z,D,R,j,G={}){return In(z,G,(0,x.Z)(function*(){let Q={},St={};j&&("GET"===D?St=j:Q={body:JSON.stringify(j)});const jt=(0,mt.xO)(Object.assign({key:z.config.apiKey},St)).slice(1),He=yield z._getAdditionalHeaders();return He["Content-Type"]="application/json",z.languageCode&&(He["X-Firebase-Locale"]=z.languageCode),Wt.fetch()(Tn(z,z.config.apiHost,R,jt),Object.assign({method:D,headers:He,referrerPolicy:"no-referrer"},Q))}))})).apply(this,arguments)}function In(z,D,R){return qr.apply(this,arguments)}function qr(){return(qr=(0,x.Z)(function*(z,D,R){z._canInitEmulator=!1;const j=Object.assign(Object.assign({},Kt),D);try{const G=new pn(z),Q=yield Promise.race([R(),G.promise]);G.clearNetworkTimeout();const St=yield Q.json();if("needConfirmation"in St)throw fo(z,"account-exists-with-different-credential",St);if(Q.ok&&!("errorMessage"in St))return St;{const jt=Q.ok?St.errorMessage:St.error.message,[He,un]=jt.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===He)throw fo(z,"credential-already-in-use",St);if("EMAIL_EXISTS"===He)throw fo(z,"email-already-in-use",St);if("USER_DISABLED"===He)throw fo(z,"user-disabled",St);const sn=j[He]||He.toLowerCase().replace(/[_\s]+/g,"-");if(un)throw Xt(z,sn,un);me(z,sn)}}catch(G){if(G instanceof mt.ZR)throw G;me(z,"network-request-failed",{message:String(G)})}})).apply(this,arguments)}function Co(z,D,R,j){return tr.apply(this,arguments)}function tr(){return(tr=(0,x.Z)(function*(z,D,R,j,G={}){const Q=yield he(z,D,R,j,G);return"mfaPendingCredential"in Q&&me(z,"multi-factor-auth-required",{_serverResponse:Q}),Q})).apply(this,arguments)}function Tn(z,D,R,j){const G=`${D}${R}?${j}`;return z.config.emulator?vs(z.config,G):`${z.config.apiScheme}://${G}`}class pn{constructor(D){this.auth=D,this.timer=null,this.promise=new Promise((R,j)=>{this.timer=setTimeout(()=>j(tt(this.auth,"network-request-failed")),pe.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function fo(z,D,R){const j={appName:z.name};R.email&&(j.email=R.email),R.phoneNumber&&(j.phoneNumber=R.phoneNumber);const G=tt(z,D,j);return G.customData._tokenResponse=R,G}function et(){return(et=(0,x.Z)(function*(z,D){return he(z,"POST","/v1/accounts:delete",D)})).apply(this,arguments)}function gt(){return(gt=(0,x.Z)(function*(z,D){return he(z,"POST","/v1/accounts:update",D)})).apply(this,arguments)}function ie(){return(ie=(0,x.Z)(function*(z,D){return he(z,"POST","/v1/accounts:lookup",D)})).apply(this,arguments)}function Pe(z){if(z)try{const D=new Date(Number(z));if(!isNaN(D.getTime()))return D.toUTCString()}catch{}}function Xe(){return(Xe=(0,x.Z)(function*(z,D=!1){const R=(0,mt.m9)(z),j=yield R.getIdToken(D),G=Ie(j);Ct(G&&G.exp&&G.auth_time&&G.iat,R.auth,"internal-error");const Q="object"==typeof G.firebase?G.firebase:void 0,St=Q?.sign_in_provider;return{claims:G,token:j,authTime:Pe(Ze(G.auth_time)),issuedAtTime:Pe(Ze(G.iat)),expirationTime:Pe(Ze(G.exp)),signInProvider:St||null,signInSecondFactor:Q?.sign_in_second_factor||null}})).apply(this,arguments)}function Ze(z){return 1e3*Number(z)}function Ie(z){const[D,R,j]=z.split(".");if(void 0===D||void 0===R||void 0===j)return Ce("JWT malformed, contained fewer than 3 sections"),null;try{const G=(0,mt.tV)(R);return G?JSON.parse(G):(Ce("Failed to decode base64 JWT payload"),null)}catch(G){return Ce("Caught error parsing JWT payload as JSON",G?.toString()),null}}function ur(z,D){return yn.apply(this,arguments)}function yn(){return(yn=(0,x.Z)(function*(z,D,R=!1){if(R)return D;try{return yield D}catch(j){throw j instanceof mt.ZR&&function Fr({code:z}){return"auth/user-disabled"===z||"auth/user-token-expired"===z}(j)&&z.auth.currentUser===z&&(yield z.auth.signOut()),j}})).apply(this,arguments)}class Xr{constructor(D){this.user=D,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(D){var R;if(D){const j=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),j}{this.errorBackoff=3e4;const G=(null!==(R=this.user.stsTokenManager.expirationTime)&&void 0!==R?R:0)-Date.now()-3e5;return Math.max(0,G)}}schedule(D=!1){var R=this;if(!this.isRunning)return;const j=this.getInterval(D);this.timerId=setTimeout((0,x.Z)(function*(){yield R.iteration()}),j)}iteration(){var D=this;return(0,x.Z)(function*(){try{yield D.user.getIdToken(!0)}catch(R){return void("auth/network-request-failed"===R?.code&&D.schedule(!0))}D.schedule()})()}}class Sn{constructor(D,R){this.createdAt=D,this.lastLoginAt=R,this._initializeTime()}_initializeTime(){this.lastSignInTime=Pe(this.lastLoginAt),this.creationTime=Pe(this.createdAt)}_copy(D){this.createdAt=D.createdAt,this.lastLoginAt=D.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function jo(z){return Ur.apply(this,arguments)}function Ur(){return Ur=(0,x.Z)(function*(z){var D;const R=z.auth,j=yield z.getIdToken(),G=yield ur(z,function Qt(z,D){return ie.apply(this,arguments)}(R,{idToken:j}));Ct(G?.users.length,R,"internal-error");const Q=G.users[0];z._notifyReloadListener(Q);const St=null!==(D=Q.providerUserInfo)&&void 0!==D&&D.length?function er(z){return z.map(D=>{var{providerId:R}=D,j=(0,vt._T)(D,["providerId"]);return{providerId:R,uid:j.rawId||"",displayName:j.displayName||null,email:j.email||null,phoneNumber:j.phoneNumber||null,photoURL:j.photoUrl||null}})}(Q.providerUserInfo):[],jt=function zl(z,D){return[...z.filter(j=>!D.some(G=>G.providerId===j.providerId)),...D]}(z.providerData,St),sn=!!z.isAnonymous&&!(z.email&&Q.passwordHash||jt?.length),to={uid:Q.localId,displayName:Q.displayName||null,photoURL:Q.photoUrl||null,email:Q.email||null,emailVerified:Q.emailVerified||!1,phoneNumber:Q.phoneNumber||null,tenantId:Q.tenantId||null,providerData:jt,metadata:new Sn(Q.createdAt,Q.lastLoginAt),isAnonymous:sn};Object.assign(z,to)}),Ur.apply(this,arguments)}function dr(){return(dr=(0,x.Z)(function*(z){const D=(0,mt.m9)(z);yield jo(D),yield D.auth._persistUserIfCurrent(D),D.auth._notifyListenersIfCurrent(D)})).apply(this,arguments)}function ri(){return(ri=(0,x.Z)(function*(z,D){const R=yield In(z,{},(0,x.Z)(function*(){const j=(0,mt.xO)({grant_type:"refresh_token",refresh_token:D}).slice(1),{tokenApiHost:G,apiKey:Q}=z.config,St=Tn(z,G,"/v1/token",`key=${Q}`),jt=yield z._getAdditionalHeaders();return jt["Content-Type"]="application/x-www-form-urlencoded",Wt.fetch()(St,{method:"POST",headers:jt,body:j})}));return{accessToken:R.access_token,expiresIn:R.expires_in,refreshToken:R.refresh_token}})).apply(this,arguments)}class ds{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(D){Ct(D.idToken,"internal-error"),Ct(typeof D.idToken<"u","internal-error"),Ct(typeof D.refreshToken<"u","internal-error");const R="expiresIn"in D&&typeof D.expiresIn<"u"?Number(D.expiresIn):function gn(z){const D=Ie(z);return Ct(D,"internal-error"),Ct(typeof D.exp<"u","internal-error"),Ct(typeof D.iat<"u","internal-error"),Number(D.exp)-Number(D.iat)}(D.idToken);this.updateTokensAndExpiration(D.idToken,D.refreshToken,R)}getToken(D,R=!1){var j=this;return(0,x.Z)(function*(){return Ct(!j.accessToken||j.refreshToken,D,"user-token-expired"),R||!j.accessToken||j.isExpired?j.refreshToken?(yield j.refresh(D,j.refreshToken),j.accessToken):null:j.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(D,R){var j=this;return(0,x.Z)(function*(){const{accessToken:G,refreshToken:Q,expiresIn:St}=yield function Rs(z,D){return ri.apply(this,arguments)}(D,R);j.updateTokensAndExpiration(G,Q,Number(St))})()}updateTokensAndExpiration(D,R,j){this.refreshToken=R||null,this.accessToken=D||null,this.expirationTime=Date.now()+1e3*j}static fromJSON(D,R){const{refreshToken:j,accessToken:G,expirationTime:Q}=R,St=new ds;return j&&(Ct("string"==typeof j,"internal-error",{appName:D}),St.refreshToken=j),G&&(Ct("string"==typeof G,"internal-error",{appName:D}),St.accessToken=G),Q&&(Ct("number"==typeof Q,"internal-error",{appName:D}),St.expirationTime=Q),St}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(D){this.accessToken=D.accessToken,this.refreshToken=D.refreshToken,this.expirationTime=D.expirationTime}_clone(){return Object.assign(new ds,this.toJSON())}_performRefresh(){return ge("not implemented")}}function Ft(z,D){Ct("string"==typeof z||typeof z>"u","internal-error",{appName:D})}class Ht{constructor(D){var{uid:R,auth:j,stsTokenManager:G}=D,Q=(0,vt._T)(D,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Xr(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=R,this.auth=j,this.stsTokenManager=G,this.accessToken=G.accessToken,this.displayName=Q.displayName||null,this.email=Q.email||null,this.emailVerified=Q.emailVerified||!1,this.phoneNumber=Q.phoneNumber||null,this.photoURL=Q.photoURL||null,this.isAnonymous=Q.isAnonymous||!1,this.tenantId=Q.tenantId||null,this.providerData=Q.providerData?[...Q.providerData]:[],this.metadata=new Sn(Q.createdAt||void 0,Q.lastLoginAt||void 0)}getIdToken(D){var R=this;return(0,x.Z)(function*(){const j=yield ur(R,R.stsTokenManager.getToken(R.auth,D));return Ct(j,R.auth,"internal-error"),R.accessToken!==j&&(R.accessToken=j,yield R.auth._persistUserIfCurrent(R),R.auth._notifyListenersIfCurrent(R)),j})()}getIdTokenResult(D){return function ae(z){return Xe.apply(this,arguments)}(this,D)}reload(){return function Ar(z){return dr.apply(this,arguments)}(this)}_assign(D){this!==D&&(Ct(this.uid===D.uid,this.auth,"internal-error"),this.displayName=D.displayName,this.photoURL=D.photoURL,this.email=D.email,this.emailVerified=D.emailVerified,this.phoneNumber=D.phoneNumber,this.isAnonymous=D.isAnonymous,this.tenantId=D.tenantId,this.providerData=D.providerData.map(R=>Object.assign({},R)),this.metadata._copy(D.metadata),this.stsTokenManager._assign(D.stsTokenManager))}_clone(D){const R=new Ht(Object.assign(Object.assign({},this),{auth:D,stsTokenManager:this.stsTokenManager._clone()}));return R.metadata._copy(this.metadata),R}_onReload(D){Ct(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=D,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(D){this.reloadListener?this.reloadListener(D):this.reloadUserInfo=D}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(D,R=!1){var j=this;return(0,x.Z)(function*(){let G=!1;D.idToken&&D.idToken!==j.stsTokenManager.accessToken&&(j.stsTokenManager.updateFromServerResponse(D),G=!0),R&&(yield jo(j)),yield j.auth._persistUserIfCurrent(j),G&&j.auth._notifyListenersIfCurrent(j)})()}delete(){var D=this;return(0,x.Z)(function*(){const R=yield D.getIdToken();return yield ur(D,function ce(z,D){return et.apply(this,arguments)}(D.auth,{idToken:R})),D.stsTokenManager.clearRefreshToken(),D.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(D=>Object.assign({},D)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(D,R){var j,G,Q,St,jt,He,un,sn;const to=null!==(j=R.displayName)&&void 0!==j?j:void 0,ns=null!==(G=R.email)&&void 0!==G?G:void 0,gs=null!==(Q=R.phoneNumber)&&void 0!==Q?Q:void 0,jh=null!==(St=R.photoURL)&&void 0!==St?St:void 0,_w=null!==(jt=R.tenantId)&&void 0!==jt?jt:void 0,$h=null!==(He=R._redirectEventId)&&void 0!==He?He:void 0,Mo=null!==(un=R.createdAt)&&void 0!==un?un:void 0,Dr=null!==(sn=R.lastLoginAt)&&void 0!==sn?sn:void 0,{uid:a_,emailVerified:pa,isAnonymous:l_,providerData:nl,stsTokenManager:Gh}=R;Ct(a_&&Gh,D,"internal-error");const pb=ds.fromJSON(this.name,Gh);Ct("string"==typeof a_,D,"internal-error"),Ft(to,D.name),Ft(ns,D.name),Ct("boolean"==typeof pa,D,"internal-error"),Ct("boolean"==typeof l_,D,"internal-error"),Ft(gs,D.name),Ft(jh,D.name),Ft(_w,D.name),Ft($h,D.name),Ft(Mo,D.name),Ft(Dr,D.name);const ku=new Ht({uid:a_,auth:D,email:ns,emailVerified:pa,displayName:to,isAnonymous:l_,photoURL:jh,phoneNumber:gs,tenantId:_w,stsTokenManager:pb,createdAt:Mo,lastLoginAt:Dr});return nl&&Array.isArray(nl)&&(ku.providerData=nl.map(rc=>Object.assign({},rc))),$h&&(ku._redirectEventId=$h),ku}static _fromIdTokenResponse(D,R,j=!1){return(0,x.Z)(function*(){const G=new ds;G.updateFromServerResponse(R);const Q=new Ht({uid:R.localId,auth:D,stsTokenManager:G,isAnonymous:j});return yield jo(Q),Q})()}}const te=new Map;function le(z){en(z instanceof Function,"Expected a class definition");let D=te.get(z);return D?(en(D instanceof z,"Instance stored in cache mismatched with class"),D):(D=new z,te.set(z,D),D)}const ve=(()=>{class z{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,x.Z)(function*(){return!0})()}_set(R,j){var G=this;return(0,x.Z)(function*(){G.storage[R]=j})()}_get(R){var j=this;return(0,x.Z)(function*(){const G=j.storage[R];return void 0===G?null:G})()}_remove(R){var j=this;return(0,x.Z)(function*(){delete j.storage[R]})()}_addListener(R,j){}_removeListener(R,j){}}return z.type="NONE",z})();function xe(z,D,R){return`firebase:${z}:${D}:${R}`}class ot{constructor(D,R,j){this.persistence=D,this.auth=R,this.userKey=j;const{config:G,name:Q}=this.auth;this.fullUserKey=xe(this.userKey,G.apiKey,Q),this.fullPersistenceKey=xe("persistence",G.apiKey,Q),this.boundEventHandler=R._onStorageEvent.bind(R),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(D){return this.persistence._set(this.fullUserKey,D.toJSON())}getCurrentUser(){var D=this;return(0,x.Z)(function*(){const R=yield D.persistence._get(D.fullUserKey);return R?Ht._fromJSON(D.auth,R):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(D){var R=this;return(0,x.Z)(function*(){if(R.persistence===D)return;const j=yield R.getCurrentUser();return yield R.removeCurrentUser(),R.persistence=D,j?R.setCurrentUser(j):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(D,R,j="authUser"){return(0,x.Z)(function*(){if(!R.length)return new ot(le(ve),D,j);const G=(yield Promise.all(R.map(function(){var un=(0,x.Z)(function*(sn){if(yield sn._isAvailable())return sn});return function(sn){return un.apply(this,arguments)}}()))).filter(un=>un);let Q=G[0]||le(ve);const St=xe(j,D.config.apiKey,D.name);let jt=null;for(const un of R)try{const sn=yield un._get(St);if(sn){const to=Ht._fromJSON(D,sn);un!==Q&&(jt=to),Q=un;break}}catch{}const He=G.filter(un=>un._shouldAllowMigration);return Q._shouldAllowMigration&&He.length?(Q=He[0],jt&&(yield Q._set(St,jt.toJSON())),yield Promise.all(R.map(function(){var un=(0,x.Z)(function*(sn){if(sn!==Q)try{yield sn._remove(St)}catch{}});return function(sn){return un.apply(this,arguments)}}())),new ot(Q,D,j)):new ot(Q,D,j)})()}}function at(z){const D=z.toLowerCase();if(D.includes("opera/")||D.includes("opr/")||D.includes("opios/"))return"Opera";if(ee(D))return"IEMobile";if(D.includes("msie")||D.includes("trident/"))return"IE";if(D.includes("edge/"))return"Edge";if(ht(D))return"Firefox";if(D.includes("silk/"))return"Silk";if(Nn(D))return"Blackberry";if(yr(D))return"Webos";if(Bt(D))return"Safari";if((D.includes("chrome/")||kt(D))&&!D.includes("edge/"))return"Chrome";if(Ke(D))return"Android";{const j=z.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===j?.length)return j[1]}return"Other"}function ht(z=(0,mt.z$)()){return/firefox\//i.test(z)}function Bt(z=(0,mt.z$)()){const D=z.toLowerCase();return D.includes("safari/")&&!D.includes("chrome/")&&!D.includes("crios/")&&!D.includes("android")}function kt(z=(0,mt.z$)()){return/crios\//i.test(z)}function ee(z=(0,mt.z$)()){return/iemobile/i.test(z)}function Ke(z=(0,mt.z$)()){return/android/i.test(z)}function Nn(z=(0,mt.z$)()){return/blackberry/i.test(z)}function yr(z=(0,mt.z$)()){return/webos/i.test(z)}function Er(z=(0,mt.z$)()){return/iphone|ipad|ipod/i.test(z)||/macintosh/i.test(z)&&/mobile/i.test(z)}function Qr(z=(0,mt.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(z)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(z)}function $o(z=(0,mt.z$)()){return Er(z)||Ke(z)||yr(z)||Nn(z)||/windows phone/i.test(z)||ee(z)}function qs(z,D=[]){let R;switch(z){case"Browser":R=at((0,mt.z$)());break;case"Worker":R=`${at((0,mt.z$)())}-${z}`;break;default:R=z}const j=D.length?D.join(","):"FirebaseCore-web";return`${R}/JsCore/${It.SDK_VERSION}/${j}`}function Vt(){return(Vt=(0,x.Z)(function*(z){return(yield he(z,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Re(z,D){return zn.apply(this,arguments)}function zn(){return(zn=(0,x.Z)(function*(z,D){return he(z,"GET","/v2/recaptchaConfig",_t(z,D))})).apply(this,arguments)}function vr(z){return void 0!==z&&void 0!==z.getResponse}function sr(z){return void 0!==z&&void 0!==z.enterprise}class ao{constructor(D){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===D.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=D.recaptchaKey.split("/")[3],this.emailPasswordEnabled=D.recaptchaEnforcementState.some(R=>"EMAIL_PASSWORD_PROVIDER"===R.provider&&"OFF"!==R.enforcementState)}}function Io(z){return new Promise((D,R)=>{const j=document.createElement("script");j.setAttribute("src",z),j.onload=D,j.onerror=G=>{const Q=tt("internal-error");Q.customData=G,R(Q)},j.type="text/javascript",j.charset="UTF-8",function qo(){var z,D;return null!==(D=null===(z=document.getElementsByTagName("head"))||void 0===z?void 0:z[0])&&void 0!==D?D:document}().appendChild(j)})}function zr(z){return`__${z}${Math.floor(1e6*Math.random())}`}class su{constructor(D){this.type="recaptcha-enterprise",this.auth=Zo(D)}verify(D="verify",R=!1){var j=this;return(0,x.Z)(function*(){function Q(){return Q=(0,x.Z)(function*(jt){if(!R){if(null==jt.tenantId&&null!=jt._agentRecaptchaConfig)return jt._agentRecaptchaConfig.siteKey;if(null!=jt.tenantId&&void 0!==jt._tenantRecaptchaConfigs[jt.tenantId])return jt._tenantRecaptchaConfigs[jt.tenantId].siteKey}return new Promise(function(){var He=(0,x.Z)(function*(un,sn){Re(jt,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(to=>{if(void 0!==to.recaptchaKey){const ns=new ao(to);return null==jt.tenantId?jt._agentRecaptchaConfig=ns:jt._tenantRecaptchaConfigs[jt.tenantId]=ns,un(ns.siteKey)}sn(new Error("recaptcha Enterprise site key undefined"))}).catch(to=>{sn(to)})});return function(un,sn){return He.apply(this,arguments)}}())}),Q.apply(this,arguments)}function St(jt,He,un){const sn=window.grecaptcha;sr(sn)?sn.enterprise.ready(()=>{sn.enterprise.execute(jt,{action:D}).then(to=>{He(to)}).catch(()=>{He("NO_RECAPTCHA")})}):un(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((jt,He)=>{(function G(jt){return Q.apply(this,arguments)})(j.auth).then(un=>{if(!R&&sr(window.grecaptcha))St(un,jt,He);else{if(typeof window>"u")return void He(new Error("RecaptchaVerifier is only supported in browser"));Io("https://www.google.com/recaptcha/enterprise.js?render="+un).then(()=>{St(un,jt,He)}).catch(sn=>{He(sn)})}}).catch(un=>{He(un)})})})()}}function bs(z,D,R){return Ua.apply(this,arguments)}function Ua(){return(Ua=(0,x.Z)(function*(z,D,R,j=!1){const G=new su(z);let Q;try{Q=yield G.verify(R)}catch{Q=yield G.verify(R,!0)}const St=Object.assign({},D);return Object.assign(St,j?{captchaResp:Q}:{captchaResponse:Q}),Object.assign(St,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(St,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),St})).apply(this,arguments)}class lg{constructor(D){this.auth=D,this.queue=[]}pushCallback(D,R){const j=Q=>new Promise((St,jt)=>{try{St(D(Q))}catch(He){jt(He)}});j.onAbort=R,this.queue.push(j);const G=this.queue.length-1;return()=>{this.queue[G]=()=>Promise.resolve()}}runMiddleware(D){var R=this;return(0,x.Z)(function*(){if(R.auth.currentUser===D)return;const j=[];try{for(const G of R.queue)yield G(D),G.onAbort&&j.push(G.onAbort)}catch(G){j.reverse();for(const Q of j)try{Q()}catch{}throw R.auth._errorFactory.create("login-blocked",{originalMessage:G?.message})}})()}}class Va{constructor(D,R,j,G){this.app=D,this.heartbeatServiceProvider=R,this.appCheckServiceProvider=j,this.config=G,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cg(this),this.idTokenSubscription=new cg(this),this.beforeStateQueue=new lg(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=We,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=D.name,this.clientVersion=G.sdkClientVersion}_initializeWithPersistence(D,R){var j=this;return R&&(this._popupRedirectResolver=le(R)),this._initializationPromise=this.queue((0,x.Z)(function*(){var G,Q;if(!j._deleted&&(j.persistenceManager=yield ot.create(j,D),!j._deleted)){if(null!==(G=j._popupRedirectResolver)&&void 0!==G&&G._shouldInitProactively)try{yield j._popupRedirectResolver._initialize(j)}catch{}yield j.initializeCurrentUser(R),j.lastNotifiedUid=(null===(Q=j.currentUser)||void 0===Q?void 0:Q.uid)||null,!j._deleted&&(j._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var D=this;return(0,x.Z)(function*(){if(D._deleted)return;const R=yield D.assertedPersistence.getCurrentUser();if(D.currentUser||R){if(D.currentUser&&R&&D.currentUser.uid===R.uid)return D._currentUser._assign(R),void(yield D.currentUser.getIdToken());yield D._updateCurrentUser(R,!0)}})()}initializeCurrentUser(D){var R=this;return(0,x.Z)(function*(){var j;const G=yield R.assertedPersistence.getCurrentUser();let Q=G,St=!1;if(D&&R.config.authDomain){yield R.getOrInitRedirectPersistenceManager();const jt=null===(j=R.redirectUser)||void 0===j?void 0:j._redirectEventId,He=Q?._redirectEventId,un=yield R.tryRedirectSignIn(D);(!jt||jt===He)&&un?.user&&(Q=un.user,St=!0)}if(!Q)return R.directlySetCurrentUser(null);if(!Q._redirectEventId){if(St)try{yield R.beforeStateQueue.runMiddleware(Q)}catch(jt){Q=G,R._popupRedirectResolver._overrideRedirectResult(R,()=>Promise.reject(jt))}return Q?R.reloadAndSetCurrentUserOrClear(Q):R.directlySetCurrentUser(null)}return Ct(R._popupRedirectResolver,R,"argument-error"),yield R.getOrInitRedirectPersistenceManager(),R.redirectUser&&R.redirectUser._redirectEventId===Q._redirectEventId?R.directlySetCurrentUser(Q):R.reloadAndSetCurrentUserOrClear(Q)})()}tryRedirectSignIn(D){var R=this;return(0,x.Z)(function*(){let j=null;try{j=yield R._popupRedirectResolver._completeRedirectFn(R,D,!0)}catch{yield R._setRedirectUser(null)}return j})()}reloadAndSetCurrentUserOrClear(D){var R=this;return(0,x.Z)(function*(){try{yield jo(D)}catch(j){if("auth/network-request-failed"!==j?.code)return R.directlySetCurrentUser(null)}return R.directlySetCurrentUser(D)})()}useDeviceLanguage(){this.languageCode=function Yr(){if(typeof navigator>"u")return null;const z=navigator;return z.languages&&z.languages[0]||z.language||null}()}_delete(){var D=this;return(0,x.Z)(function*(){D._deleted=!0})()}updateCurrentUser(D){var R=this;return(0,x.Z)(function*(){const j=D?(0,mt.m9)(D):null;return j&&Ct(j.auth.config.apiKey===R.config.apiKey,R,"invalid-user-token"),R._updateCurrentUser(j&&j._clone(R))})()}_updateCurrentUser(D,R=!1){var j=this;return(0,x.Z)(function*(){if(!j._deleted)return D&&Ct(j.tenantId===D.tenantId,j,"tenant-id-mismatch"),R||(yield j.beforeStateQueue.runMiddleware(D)),j.queue((0,x.Z)(function*(){yield j.directlySetCurrentUser(D),j.notifyAuthListeners()}))})()}signOut(){var D=this;return(0,x.Z)(function*(){return yield D.beforeStateQueue.runMiddleware(null),(D.redirectPersistenceManager||D._popupRedirectResolver)&&(yield D._setRedirectUser(null)),D._updateCurrentUser(null,!0)})()}setPersistence(D){var R=this;return this.queue((0,x.Z)(function*(){yield R.assertedPersistence.setPersistence(le(D))}))}initializeRecaptchaConfig(){var D=this;return(0,x.Z)(function*(){const R=yield Re(D,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),j=new ao(R);null==D.tenantId?D._agentRecaptchaConfig=j:D._tenantRecaptchaConfigs[D.tenantId]=j,j.emailPasswordEnabled&&new su(D).verify()})()}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(D){this._errorFactory=new mt.LL("auth","Firebase",D())}onAuthStateChanged(D,R,j){return this.registerStateListener(this.authStateSubscription,D,R,j)}beforeAuthStateChanged(D,R){return this.beforeStateQueue.pushCallback(D,R)}onIdTokenChanged(D,R,j){return this.registerStateListener(this.idTokenSubscription,D,R,j)}toJSON(){var D;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(D=this._currentUser)||void 0===D?void 0:D.toJSON()}}_setRedirectUser(D,R){var j=this;return(0,x.Z)(function*(){const G=yield j.getOrInitRedirectPersistenceManager(R);return null===D?G.removeCurrentUser():G.setCurrentUser(D)})()}getOrInitRedirectPersistenceManager(D){var R=this;return(0,x.Z)(function*(){if(!R.redirectPersistenceManager){const j=D&&le(D)||R._popupRedirectResolver;Ct(j,R,"argument-error"),R.redirectPersistenceManager=yield ot.create(R,[le(j._redirectPersistence)],"redirectUser"),R.redirectUser=yield R.redirectPersistenceManager.getCurrentUser()}return R.redirectPersistenceManager})()}_redirectUserForId(D){var R=this;return(0,x.Z)(function*(){var j,G;return R._isInitialized&&(yield R.queue((0,x.Z)(function*(){}))),(null===(j=R._currentUser)||void 0===j?void 0:j._redirectEventId)===D?R._currentUser:(null===(G=R.redirectUser)||void 0===G?void 0:G._redirectEventId)===D?R.redirectUser:null})()}_persistUserIfCurrent(D){var R=this;return(0,x.Z)(function*(){if(D===R.currentUser)return R.queue((0,x.Z)(function*(){return R.directlySetCurrentUser(D)}))})()}_notifyListenersIfCurrent(D){D===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var D,R;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const j=null!==(R=null===(D=this.currentUser)||void 0===D?void 0:D.uid)&&void 0!==R?R:null;this.lastNotifiedUid!==j&&(this.lastNotifiedUid=j,this.authStateSubscription.next(this.currentUser))}registerStateListener(D,R,j,G){if(this._deleted)return()=>{};const Q="function"==typeof R?R:R.next.bind(R),St=this._isInitialized?Promise.resolve():this._initializationPromise;return Ct(St,this,"internal-error"),St.then(()=>Q(this.currentUser)),"function"==typeof R?D.addObserver(R,j,G):D.addObserver(R)}directlySetCurrentUser(D){var R=this;return(0,x.Z)(function*(){R.currentUser&&R.currentUser!==D&&R._currentUser._stopProactiveRefresh(),D&&R.isProactiveRefreshEnabled&&D._startProactiveRefresh(),R.currentUser=D,D?yield R.assertedPersistence.setCurrentUser(D):yield R.assertedPersistence.removeCurrentUser()})()}queue(D){return this.operations=this.operations.then(D,D),this.operations}get assertedPersistence(){return Ct(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(D){!D||this.frameworks.includes(D)||(this.frameworks.push(D),this.frameworks.sort(),this.clientVersion=qs(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var D=this;return(0,x.Z)(function*(){var R;const j={"X-Client-Version":D.clientVersion};D.app.options.appId&&(j["X-Firebase-gmpid"]=D.app.options.appId);const G=yield null===(R=D.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===R?void 0:R.getHeartbeatsHeader();G&&(j["X-Firebase-Client"]=G);const Q=yield D._getAppCheckToken();return Q&&(j["X-Firebase-AppCheck"]=Q),j})()}_getAppCheckToken(){var D=this;return(0,x.Z)(function*(){var R;const j=yield null===(R=D.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===R?void 0:R.getToken();return j?.error&&function Fn(z,...D){Te.logLevel<=lt.in.WARN&&Te.warn(`Auth (${It.SDK_VERSION}): ${z}`,...D)}(`Error while retrieving App Check token: ${j.error}`),j?.token})()}}function Zo(z){return(0,mt.m9)(z)}class cg{constructor(D){this.auth=D,this.observer=null,this.addObserver=(0,mt.ne)(R=>this.observer=R)}get next(){return Ct(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function dd(z,D,R){const j=Zo(z);Ct(j._canInitEmulator,j,"emulator-config-failed"),Ct(/^https?:\/\//.test(D),j,"invalid-emulator-scheme");const G=!!R?.disableWarnings,Q=ja(D),{host:St,port:jt}=function hd(z){const D=ja(z),R=/(\/\/)?([^?#/]+)/.exec(z.substr(D.length));if(!R)return{host:"",port:null};const j=R[2].split("@").pop()||"",G=/^(\[[^\]]+\])(:|$)/.exec(j);if(G){const Q=G[1];return{host:Q,port:Mn(j.substr(Q.length+1))}}{const[Q,St]=j.split(":");return{host:Q,port:Mn(St)}}}(D);j.config.emulator={url:`${Q}//${St}${null===jt?"":`:${jt}`}/`},j.settings.appVerificationDisabledForTesting=!0,j.emulatorConfig=Object.freeze({host:St,port:jt,protocol:Q.replace(":",""),options:Object.freeze({disableWarnings:G})}),G||function eo(){function z(){const D=document.createElement("p"),R=D.style;D.innerText="Running in emulator mode. Do not use with production credentials.",R.position="fixed",R.width="100%",R.backgroundColor="#ffffff",R.border=".1em solid #000000",R.color="#b50000",R.bottom="0px",R.left="0px",R.margin="0px",R.zIndex="10000",R.textAlign="center",D.classList.add("firebase-emulator-warning"),document.body.appendChild(D)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",z):z())}()}function ja(z){const D=z.indexOf(":");return D<0?"":z.substr(0,D+1)}function Mn(z){if(!z)return null;const D=Number(z);return isNaN(D)?null:D}class oa{constructor(D,R){this.providerId=D,this.signInMethod=R}toJSON(){return ge("not implemented")}_getIdTokenResponse(D){return ge("not implemented")}_linkToIdToken(D,R){return ge("not implemented")}_getReauthenticationResolver(D){return ge("not implemented")}}function Hi(z,D){return au.apply(this,arguments)}function au(){return(au=(0,x.Z)(function*(z,D){return he(z,"POST","/v1/accounts:resetPassword",_t(z,D))})).apply(this,arguments)}function lu(z,D){return $f.apply(this,arguments)}function $f(){return($f=(0,x.Z)(function*(z,D){return he(z,"POST","/v1/accounts:update",D)})).apply(this,arguments)}function xs(){return(xs=(0,x.Z)(function*(z,D){return he(z,"POST","/v1/accounts:update",_t(z,D))})).apply(this,arguments)}function _h(z,D){return vi.apply(this,arguments)}function vi(){return(vi=(0,x.Z)(function*(z,D){return Co(z,"POST","/v1/accounts:signInWithPassword",_t(z,D))})).apply(this,arguments)}function cu(z,D){return Gf.apply(this,arguments)}function Gf(){return(Gf=(0,x.Z)(function*(z,D){return he(z,"POST","/v1/accounts:sendOobCode",_t(z,D))})).apply(this,arguments)}function fd(){return(fd=(0,x.Z)(function*(z,D){return cu(z,D)})).apply(this,arguments)}function yh(z,D){return de.apply(this,arguments)}function de(){return(de=(0,x.Z)(function*(z,D){return cu(z,D)})).apply(this,arguments)}function Cn(z,D){return Ro.apply(this,arguments)}function Ro(){return(Ro=(0,x.Z)(function*(z,D){return cu(z,D)})).apply(this,arguments)}function Fe(){return(Fe=(0,x.Z)(function*(z,D){return cu(z,D)})).apply(this,arguments)}function Zs(){return(Zs=(0,x.Z)(function*(z,D){return Co(z,"POST","/v1/accounts:signInWithEmailLink",_t(z,D))})).apply(this,arguments)}function Go(){return(Go=(0,x.Z)(function*(z,D){return Co(z,"POST","/v1/accounts:signInWithEmailLink",_t(z,D))})).apply(this,arguments)}class Yi extends oa{constructor(D,R,j,G=null){super("password",j),this._email=D,this._password=R,this._tenantId=G}static _fromEmailAndPassword(D,R){return new Yi(D,R,"password")}static _fromEmailAndCode(D,R,j=null){return new Yi(D,R,"emailLink",j)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(D){const R="string"==typeof D?JSON.parse(D):D;if(R?.email&&R?.password){if("password"===R.signInMethod)return this._fromEmailAndPassword(R.email,R.password);if("emailLink"===R.signInMethod)return this._fromEmailAndCode(R.email,R.password,R.tenantId)}return null}_getIdTokenResponse(D){var R=this;return(0,x.Z)(function*(){var j;switch(R.signInMethod){case"password":const G={returnSecureToken:!0,email:R._email,password:R._password,clientType:"CLIENT_TYPE_WEB"};if(null!==(j=D._getRecaptchaConfig())&&void 0!==j&&j.emailPasswordEnabled){const Q=yield bs(D,G,"signInWithPassword");return _h(D,Q)}return _h(D,G).catch(function(){var Q=(0,x.Z)(function*(St){if("auth/missing-recaptcha-token"===St.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const jt=yield bs(D,G,"signInWithPassword");return _h(D,jt)}return Promise.reject(St)});return function(St){return Q.apply(this,arguments)}}());case"emailLink":return function wc(z,D){return Zs.apply(this,arguments)}(D,{email:R._email,oobCode:R._password});default:me(D,"internal-error")}})()}_linkToIdToken(D,R){var j=this;return(0,x.Z)(function*(){switch(j.signInMethod){case"password":return lu(D,{idToken:R,returnSecureToken:!0,email:j._email,password:j._password});case"emailLink":return function Wn(z,D){return Go.apply(this,arguments)}(D,{idToken:R,email:j._email,oobCode:j._password});default:me(D,"internal-error")}})()}_getReauthenticationResolver(D){return this._getIdTokenResponse(D)}}function hi(z,D){return Di.apply(this,arguments)}function Di(){return(Di=(0,x.Z)(function*(z,D){return Co(z,"POST","/v1/accounts:signInWithIdp",_t(z,D))})).apply(this,arguments)}class ws extends oa{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(D){const R=new ws(D.providerId,D.signInMethod);return D.idToken||D.accessToken?(D.idToken&&(R.idToken=D.idToken),D.accessToken&&(R.accessToken=D.accessToken),D.nonce&&!D.pendingToken&&(R.nonce=D.nonce),D.pendingToken&&(R.pendingToken=D.pendingToken)):D.oauthToken&&D.oauthTokenSecret?(R.accessToken=D.oauthToken,R.secret=D.oauthTokenSecret):me("argument-error"),R}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(D){const R="string"==typeof D?JSON.parse(D):D,{providerId:j,signInMethod:G}=R,Q=(0,vt._T)(R,["providerId","signInMethod"]);if(!j||!G)return null;const St=new ws(j,G);return St.idToken=Q.idToken||void 0,St.accessToken=Q.accessToken||void 0,St.secret=Q.secret,St.nonce=Q.nonce,St.pendingToken=Q.pendingToken||null,St}_getIdTokenResponse(D){return hi(D,this.buildRequest())}_linkToIdToken(D,R){const j=this.buildRequest();return j.idToken=R,hi(D,j)}_getReauthenticationResolver(D){const R=this.buildRequest();return R.autoCreate=!1,hi(D,R)}buildRequest(){const D={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)D.pendingToken=this.pendingToken;else{const R={};this.idToken&&(R.id_token=this.idToken),this.accessToken&&(R.access_token=this.accessToken),this.secret&&(R.oauth_token_secret=this.secret),R.providerId=this.providerId,this.nonce&&!this.pendingToken&&(R.nonce=this.nonce),D.postBody=(0,mt.xO)(R)}return D}}function br(){return(br=(0,x.Z)(function*(z,D){return he(z,"POST","/v1/accounts:sendVerificationCode",_t(z,D))})).apply(this,arguments)}function Jr(){return(Jr=(0,x.Z)(function*(z,D){return Co(z,"POST","/v1/accounts:signInWithPhoneNumber",_t(z,D))})).apply(this,arguments)}function Ye(){return(Ye=(0,x.Z)(function*(z,D){const R=yield Co(z,"POST","/v1/accounts:signInWithPhoneNumber",_t(z,D));if(R.temporaryProof)throw fo(z,"account-exists-with-different-credential",R);return R})).apply(this,arguments)}const Do={USER_NOT_FOUND:"user-not-found"};function $a(){return($a=(0,x.Z)(function*(z,D){return Co(z,"POST","/v1/accounts:signInWithPhoneNumber",_t(z,Object.assign(Object.assign({},D),{operation:"REAUTH"})),Do)})).apply(this,arguments)}class Zr extends oa{constructor(D){super("phone","phone"),this.params=D}static _fromVerification(D,R){return new Zr({verificationId:D,verificationCode:R})}static _fromTokenResponse(D,R){return new Zr({phoneNumber:D,temporaryProof:R})}_getIdTokenResponse(D){return function Tr(z,D){return Jr.apply(this,arguments)}(D,this._makeVerificationRequest())}_linkToIdToken(D,R){return function dn(z,D){return Ye.apply(this,arguments)}(D,Object.assign({idToken:R},this._makeVerificationRequest()))}_getReauthenticationResolver(D){return function Cs(z,D){return $a.apply(this,arguments)}(D,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:D,phoneNumber:R,verificationId:j,verificationCode:G}=this.params;return D&&R?{temporaryProof:D,phoneNumber:R}:{sessionInfo:j,code:G}}toJSON(){const D={providerId:this.providerId};return this.params.phoneNumber&&(D.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(D.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(D.verificationCode=this.params.verificationCode),this.params.verificationId&&(D.verificationId=this.params.verificationId),D}static fromJSON(D){"string"==typeof D&&(D=JSON.parse(D));const{verificationId:R,verificationCode:j,phoneNumber:G,temporaryProof:Q}=D;return j||R||G||Q?new Zr({verificationId:R,verificationCode:j,phoneNumber:G,temporaryProof:Q}):null}}class Xi{constructor(D){var R,j,G,Q,St,jt;const He=(0,mt.zd)((0,mt.pd)(D)),un=null!==(R=He.apiKey)&&void 0!==R?R:null,sn=null!==(j=He.oobCode)&&void 0!==j?j:null,to=function no(z){switch(z){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(G=He.mode)&&void 0!==G?G:null);Ct(un&&sn&&to,"argument-error"),this.apiKey=un,this.operation=to,this.code=sn,this.continueUrl=null!==(Q=He.continueUrl)&&void 0!==Q?Q:null,this.languageCode=null!==(St=He.languageCode)&&void 0!==St?St:null,this.tenantId=null!==(jt=He.tenantId)&&void 0!==jt?jt:null}static parseLink(D){const R=function ki(z){const D=(0,mt.zd)((0,mt.pd)(z)).link,R=D?(0,mt.zd)((0,mt.pd)(D)).deep_link_id:null,j=(0,mt.zd)((0,mt.pd)(z)).deep_link_id;return(j?(0,mt.zd)((0,mt.pd)(j)).link:null)||j||R||D||z}(D);try{return new Xi(R)}catch{return null}}}let ar=(()=>{class z{constructor(){this.providerId=z.PROVIDER_ID}static credential(R,j){return Yi._fromEmailAndPassword(R,j)}static credentialWithLink(R,j){const G=Xi.parseLink(j);return Ct(G,"argument-error"),Yi._fromEmailAndCode(R,G.code,G.tenantId)}}return z.PROVIDER_ID="password",z.EMAIL_PASSWORD_SIGN_IN_METHOD="password",z.EMAIL_LINK_SIGN_IN_METHOD="emailLink",z})();class Ws{constructor(D){this.providerId=D,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(D){this.defaultLanguageCode=D}setCustomParameters(D){return this.customParameters=D,this}getCustomParameters(){return this.customParameters}}class Cc extends Ws{constructor(){super(...arguments),this.scopes=[]}addScope(D){return this.scopes.includes(D)||this.scopes.push(D),this}getScopes(){return[...this.scopes]}}class xa extends Cc{static credentialFromJSON(D){const R="string"==typeof D?JSON.parse(D):D;return Ct("providerId"in R&&"signInMethod"in R,"argument-error"),ws._fromParams(R)}credential(D){return this._credential(Object.assign(Object.assign({},D),{nonce:D.rawNonce}))}_credential(D){return Ct(D.idToken||D.accessToken,"argument-error"),ws._fromParams(Object.assign(Object.assign({},D),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(D){return xa.oauthCredentialFromTaggedObject(D)}static credentialFromError(D){return xa.oauthCredentialFromTaggedObject(D.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:D}){if(!D)return null;const{oauthIdToken:R,oauthAccessToken:j,oauthTokenSecret:G,pendingToken:Q,nonce:St,providerId:jt}=D;if(!j&&!G&&!R&&!Q||!jt)return null;try{return new xa(jt)._credential({idToken:R,accessToken:j,nonce:St,pendingToken:Q})}catch{return null}}}let Wo=(()=>{class z extends Cc{constructor(){super("facebook.com")}static credential(R){return ws._fromParams({providerId:z.PROVIDER_ID,signInMethod:z.FACEBOOK_SIGN_IN_METHOD,accessToken:R})}static credentialFromResult(R){return z.credentialFromTaggedObject(R)}static credentialFromError(R){return z.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R||!("oauthAccessToken"in R)||!R.oauthAccessToken)return null;try{return z.credential(R.oauthAccessToken)}catch{return null}}}return z.FACEBOOK_SIGN_IN_METHOD="facebook.com",z.PROVIDER_ID="facebook.com",z})(),uu=(()=>{class z extends Cc{constructor(){super("google.com"),this.addScope("profile")}static credential(R,j){return ws._fromParams({providerId:z.PROVIDER_ID,signInMethod:z.GOOGLE_SIGN_IN_METHOD,idToken:R,accessToken:j})}static credentialFromResult(R){return z.credentialFromTaggedObject(R)}static credentialFromError(R){return z.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R)return null;const{oauthIdToken:j,oauthAccessToken:G}=R;if(!j&&!G)return null;try{return z.credential(j,G)}catch{return null}}}return z.GOOGLE_SIGN_IN_METHOD="google.com",z.PROVIDER_ID="google.com",z})(),Ga=(()=>{class z extends Cc{constructor(){super("github.com")}static credential(R){return ws._fromParams({providerId:z.PROVIDER_ID,signInMethod:z.GITHUB_SIGN_IN_METHOD,accessToken:R})}static credentialFromResult(R){return z.credentialFromTaggedObject(R)}static credentialFromError(R){return z.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R||!("oauthAccessToken"in R)||!R.oauthAccessToken)return null;try{return z.credential(R.oauthAccessToken)}catch{return null}}}return z.GITHUB_SIGN_IN_METHOD="github.com",z.PROVIDER_ID="github.com",z})();class bn extends oa{constructor(D,R){super(D,D),this.pendingToken=R}_getIdTokenResponse(D){return hi(D,this.buildRequest())}_linkToIdToken(D,R){const j=this.buildRequest();return j.idToken=R,hi(D,j)}_getReauthenticationResolver(D){const R=this.buildRequest();return R.autoCreate=!1,hi(D,R)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(D){const R="string"==typeof D?JSON.parse(D):D,{providerId:j,signInMethod:G,pendingToken:Q}=R;return j&&G&&Q&&j===G?new bn(j,Q):null}static _create(D,R){return new bn(D,R)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class ia extends Ws{constructor(D){Ct(D.startsWith("saml."),"argument-error"),super(D)}static credentialFromResult(D){return ia.samlCredentialFromTaggedObject(D)}static credentialFromError(D){return ia.samlCredentialFromTaggedObject(D.customData||{})}static credentialFromJSON(D){const R=bn.fromJSON(D);return Ct(R,"argument-error"),R}static samlCredentialFromTaggedObject({_tokenResponse:D}){if(!D)return null;const{pendingToken:R,providerId:j}=D;if(!R||!j)return null;try{return bn._create(j,R)}catch{return null}}}let pi=(()=>{class z extends Cc{constructor(){super("twitter.com")}static credential(R,j){return ws._fromParams({providerId:z.PROVIDER_ID,signInMethod:z.TWITTER_SIGN_IN_METHOD,oauthToken:R,oauthTokenSecret:j})}static credentialFromResult(R){return z.credentialFromTaggedObject(R)}static credentialFromError(R){return z.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R)return null;const{oauthAccessToken:j,oauthTokenSecret:G}=R;if(!j||!G)return null;try{return z.credential(j,G)}catch{return null}}}return z.TWITTER_SIGN_IN_METHOD="twitter.com",z.PROVIDER_ID="twitter.com",z})();function Ri(z,D){return sa.apply(this,arguments)}function sa(){return(sa=(0,x.Z)(function*(z,D){return Co(z,"POST","/v1/accounts:signUp",_t(z,D))})).apply(this,arguments)}class Yn{constructor(D){this.user=D.user,this.providerId=D.providerId,this._tokenResponse=D._tokenResponse,this.operationType=D.operationType}static _fromIdTokenResponse(D,R,j,G=!1){return(0,x.Z)(function*(){const Q=yield Ht._fromIdTokenResponse(D,j,G),St=gi(j);return new Yn({user:Q,providerId:St,_tokenResponse:j,operationType:R})})()}static _forOperation(D,R,j){return(0,x.Z)(function*(){yield D._updateTokensIfNecessary(j,!0);const G=gi(j);return new Yn({user:D,providerId:G,_tokenResponse:j,operationType:R})})()}}function gi(z){return z.providerId?z.providerId:"phoneNumber"in z?"phone":null}function Bl(z){return gd.apply(this,arguments)}function gd(){return(gd=(0,x.Z)(function*(z){var D;const R=Zo(z);if(yield R._initializationPromise,null!==(D=R.currentUser)&&void 0!==D&&D.isAnonymous)return new Yn({user:R.currentUser,providerId:null,operationType:"signIn"});const j=yield Ri(R,{returnSecureToken:!0}),G=yield Yn._fromIdTokenResponse(R,"signIn",j,!0);return yield R._updateCurrentUser(G.user),G})).apply(this,arguments)}class Ms extends mt.ZR{constructor(D,R,j,G){var Q;super(R.code,R.message),this.operationType=j,this.user=G,Object.setPrototypeOf(this,Ms.prototype),this.customData={appName:D.name,tenantId:null!==(Q=D.tenantId)&&void 0!==Q?Q:void 0,_serverResponse:R.customData._serverResponse,operationType:j}}static _fromErrorAndOperation(D,R,j,G){return new Ms(D,R,j,G)}}function Ko(z,D,R,j){return("reauthenticate"===D?R._getReauthenticationResolver(z):R._getIdTokenResponse(z)).catch(Q=>{throw"auth/multi-factor-auth-required"===Q.code?Ms._fromErrorAndOperation(z,Q,D,j):Q})}function Ul(z){return new Set(z.map(({providerId:D})=>D).filter(D=>!!D))}function du(z,D){return zo.apply(this,arguments)}function zo(){return zo=(0,x.Z)(function*(z,D){const R=(0,mt.m9)(z);yield Un(!0,R,D);const{providerUserInfo:j}=yield function nt(z,D){return gt.apply(this,arguments)}(R.auth,{idToken:yield R.getIdToken(),deleteProvider:[D]}),G=Ul(j||[]);return R.providerData=R.providerData.filter(Q=>G.has(Q.providerId)),G.has("phone")||(R.phoneNumber=null),yield R.auth._persistUserIfCurrent(R),R}),zo.apply(this,arguments)}function aa(z,D){return bi.apply(this,arguments)}function bi(){return(bi=(0,x.Z)(function*(z,D,R=!1){const j=yield ur(z,D._linkToIdToken(z.auth,yield z.getIdToken()),R);return Yn._forOperation(z,"link",j)})).apply(this,arguments)}function Un(z,D,R){return hu.apply(this,arguments)}function hu(){return(hu=(0,x.Z)(function*(z,D,R){yield jo(D);const G=!1===z?"provider-already-linked":"no-such-provider";Ct(Ul(D.providerData).has(R)===z,D.auth,G)})).apply(this,arguments)}function _l(z,D){return Ha.apply(this,arguments)}function Ha(){return(Ha=(0,x.Z)(function*(z,D,R=!1){const{auth:j}=z,G="reauthenticate";try{const Q=yield ur(z,Ko(j,G,D,z),R);Ct(Q.idToken,j,"internal-error");const St=Ie(Q.idToken);Ct(St,j,"internal-error");const{sub:jt}=St;return Ct(z.uid===jt,j,"user-mismatch"),Yn._forOperation(z,G,Q)}catch(Q){throw"auth/user-not-found"===Q?.code&&me(j,"user-mismatch"),Q}})).apply(this,arguments)}function la(z,D){return fu.apply(this,arguments)}function fu(){return(fu=(0,x.Z)(function*(z,D,R=!1){const j="signIn",G=yield Ko(z,j,D),Q=yield Yn._fromIdTokenResponse(z,j,G);return R||(yield z._updateCurrentUser(Q.user)),Q})).apply(this,arguments)}function yl(z,D){return ug.apply(this,arguments)}function ug(){return(ug=(0,x.Z)(function*(z,D){return la(Zo(z),D)})).apply(this,arguments)}function vl(z,D){return vh.apply(this,arguments)}function vh(){return(vh=(0,x.Z)(function*(z,D){const R=(0,mt.m9)(z);return yield Un(!1,R,D.providerId),aa(R,D)})).apply(this,arguments)}function Yo(z,D){return qy.apply(this,arguments)}function qy(){return(qy=(0,x.Z)(function*(z,D){return _l((0,mt.m9)(z),D)})).apply(this,arguments)}function bh(){return(bh=(0,x.Z)(function*(z,D){return Co(z,"POST","/v1/accounts:signInWithCustomToken",_t(z,D))})).apply(this,arguments)}function dg(z,D){return qf.apply(this,arguments)}function qf(){return qf=(0,x.Z)(function*(z,D){const R=Zo(z),j=yield function gw(z,D){return bh.apply(this,arguments)}(R,{token:D,returnSecureToken:!0}),G=yield Yn._fromIdTokenResponse(R,"signIn",j);return yield R._updateCurrentUser(G.user),G}),qf.apply(this,arguments)}class Ps{constructor(D,R){this.factorId=D,this.uid=R.mfaEnrollmentId,this.enrollmentTime=new Date(R.enrolledAt).toUTCString(),this.displayName=R.displayName}static _fromServerResponse(D,R){return"phoneInfo"in R?jm._fromServerResponse(D,R):"totpInfo"in R?pu._fromServerResponse(D,R):me(D,"internal-error")}}class jm extends Ps{constructor(D){super("phone",D),this.phoneNumber=D.phoneInfo}static _fromServerResponse(D,R){return new jm(R)}}class pu extends Ps{constructor(D){super("totp",D)}static _fromServerResponse(D,R){return new pu(R)}}function qa(z,D,R){var j;Ct((null===(j=R.url)||void 0===j?void 0:j.length)>0,z,"invalid-continue-uri"),Ct(typeof R.dynamicLinkDomain>"u"||R.dynamicLinkDomain.length>0,z,"invalid-dynamic-link-domain"),D.continueUrl=R.url,D.dynamicLinkDomain=R.dynamicLinkDomain,D.canHandleCodeInApp=R.handleCodeInApp,R.iOS&&(Ct(R.iOS.bundleId.length>0,z,"missing-ios-bundle-id"),D.iOSBundleId=R.iOS.bundleId),R.android&&(Ct(R.android.packageName.length>0,z,"missing-android-pkg-name"),D.androidInstallApp=R.android.installApp,D.androidMinimumVersionCode=R.android.minimumVersion,D.androidPackageName=R.android.packageName)}function fb(z,D,R){return Zy.apply(this,arguments)}function Zy(){return Zy=(0,x.Z)(function*(z,D,R){var j;const G=Zo(z),Q={requestType:"PASSWORD_RESET",email:D,clientType:"CLIENT_TYPE_WEB"};if(null!==(j=G._getRecaptchaConfig())&&void 0!==j&&j.emailPasswordEnabled){const St=yield bs(G,Q,"getOobCode",!0);R&&qa(G,St,R),yield yh(G,St)}else R&&qa(G,Q,R),yield yh(G,Q).catch(function(){var St=(0,x.Z)(function*(jt){if("auth/missing-recaptcha-token"!==jt.code)return Promise.reject(jt);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const He=yield bs(G,Q,"getOobCode",!0);R&&qa(G,He,R),yield yh(G,He)}});return function(jt){return St.apply(this,arguments)}}())}),Zy.apply(this,arguments)}function hg(z,D,R){return xh.apply(this,arguments)}function xh(){return(xh=(0,x.Z)(function*(z,D,R){yield Hi((0,mt.m9)(z),{oobCode:D,newPassword:R})})).apply(this,arguments)}function $m(z,D){return md.apply(this,arguments)}function md(){return md=(0,x.Z)(function*(z,D){yield function Hy(z,D){return xs.apply(this,arguments)}((0,mt.m9)(z),{oobCode:D})}),md.apply(this,arguments)}function wa(z,D){return Zf.apply(this,arguments)}function Zf(){return(Zf=(0,x.Z)(function*(z,D){const R=(0,mt.m9)(z),j=yield Hi(R,{oobCode:D}),G=j.requestType;switch(Ct(G,R,"internal-error"),G){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Ct(j.newEmail,R,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Ct(j.mfaInfo,R,"internal-error");default:Ct(j.email,R,"internal-error")}let Q=null;return j.mfaInfo&&(Q=Ps._fromServerResponse(Zo(R),j.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===j.requestType?j.newEmail:j.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===j.requestType?j.email:j.newEmail)||null,multiFactorInfo:Q},operation:G}})).apply(this,arguments)}function Vl(z,D){return ca.apply(this,arguments)}function ca(){return(ca=(0,x.Z)(function*(z,D){const{data:R}=yield wa((0,mt.m9)(z),D);return R.email})).apply(this,arguments)}function gu(z,D,R){return wh.apply(this,arguments)}function wh(){return wh=(0,x.Z)(function*(z,D,R){var j;const G=Zo(z),Q={returnSecureToken:!0,email:D,password:R,clientType:"CLIENT_TYPE_WEB"};let St;if(null!==(j=G._getRecaptchaConfig())&&void 0!==j&&j.emailPasswordEnabled){const un=yield bs(G,Q,"signUpPassword");St=Ri(G,un)}else St=Ri(G,Q).catch(function(){var un=(0,x.Z)(function*(sn){if("auth/missing-recaptcha-token"===sn.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const to=yield bs(G,Q,"signUpPassword");return Ri(G,to)}return Promise.reject(sn)});return function(sn){return un.apply(this,arguments)}}());const jt=yield St.catch(un=>Promise.reject(un)),He=yield Yn._fromIdTokenResponse(G,"signIn",jt);return yield G._updateCurrentUser(He.user),He}),wh.apply(this,arguments)}function qi(z,D,R){return yl((0,mt.m9)(z),ar.credential(D,R))}function _d(z,D,R){return Qi.apply(this,arguments)}function Qi(){return Qi=(0,x.Z)(function*(z,D,R){var j;const G=Zo(z),Q={requestType:"EMAIL_SIGNIN",email:D,clientType:"CLIENT_TYPE_WEB"};function St(jt,He){Ct(He.handleCodeInApp,G,"argument-error"),He&&qa(G,jt,He)}if(null!==(j=G._getRecaptchaConfig())&&void 0!==j&&j.emailPasswordEnabled){const jt=yield bs(G,Q,"getOobCode",!0);St(jt,R),yield Cn(G,jt)}else St(Q,R),yield Cn(G,Q).catch(function(){var jt=(0,x.Z)(function*(He){if("auth/missing-recaptcha-token"!==He.code)return Promise.reject(He);{console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const un=yield bs(G,Q,"getOobCode",!0);St(un,R),yield Cn(G,un)}});return function(He){return jt.apply(this,arguments)}}())}),Qi.apply(this,arguments)}function Ch(z,D){const R=Xi.parseLink(D);return"EMAIL_SIGNIN"===R?.operation}function Dt(z,D,R){return Li.apply(this,arguments)}function Li(){return(Li=(0,x.Z)(function*(z,D,R){const j=(0,mt.m9)(z),G=ar.credentialWithLink(D,R||Vo());return Ct(G._tenantId===(j.tenantId||null),j,"tenant-id-mismatch"),yl(j,G)})).apply(this,arguments)}function Mc(){return(Mc=(0,x.Z)(function*(z,D){return he(z,"POST","/v1/accounts:createAuthUri",_t(z,D))})).apply(this,arguments)}function Gm(z,D){return jl.apply(this,arguments)}function jl(){return jl=(0,x.Z)(function*(z,D){const j={identifier:D,continueUri:cs()?Vo():"http://localhost"},{signinMethods:G}=yield function fg(z,D){return Mc.apply(this,arguments)}((0,mt.m9)(z),j);return G||[]}),jl.apply(this,arguments)}function Za(z,D){return Pc.apply(this,arguments)}function Pc(){return Pc=(0,x.Z)(function*(z,D){const R=(0,mt.m9)(z),G={requestType:"VERIFY_EMAIL",idToken:yield z.getIdToken()};D&&qa(R.auth,G,D);const{email:Q}=yield function Um(z,D){return fd.apply(this,arguments)}(R.auth,G);Q!==z.email&&(yield z.reload())}),Pc.apply(this,arguments)}function $l(z,D,R){return Gl.apply(this,arguments)}function Gl(){return Gl=(0,x.Z)(function*(z,D,R){const j=(0,mt.m9)(z),Q={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield z.getIdToken(),newEmail:D};R&&qa(j.auth,Q,R);const{email:St}=yield function wt(z,D){return Fe.apply(this,arguments)}(j.auth,Q);St!==z.email&&(yield z.reload())}),Gl.apply(this,arguments)}function Hl(){return(Hl=(0,x.Z)(function*(z,D){return he(z,"POST","/v1/accounts:update",D)})).apply(this,arguments)}function Mh(z,D){return Wf.apply(this,arguments)}function Wf(){return Wf=(0,x.Z)(function*(z,{displayName:D,photoURL:R}){if(void 0===D&&void 0===R)return;const j=(0,mt.m9)(z),Q={idToken:yield j.getIdToken(),displayName:D,photoUrl:R,returnSecureToken:!0},St=yield ur(j,function Wa(z,D){return Hl.apply(this,arguments)}(j.auth,Q));j.displayName=St.displayName||null,j.photoURL=St.photoUrl||null;const jt=j.providerData.find(({providerId:He})=>"password"===He);jt&&(jt.displayName=j.displayName,jt.photoURL=j.photoURL),yield j._updateTokensIfNecessary(St)}),Wf.apply(this,arguments)}function Hm(z,D){return Zm((0,mt.m9)(z),D,null)}function qm(z,D){return Zm((0,mt.m9)(z),null,D)}function Zm(z,D,R){return Wm.apply(this,arguments)}function Wm(){return(Wm=(0,x.Z)(function*(z,D,R){const{auth:j}=z,Q={idToken:yield z.getIdToken(),returnSecureToken:!0};D&&(Q.email=D),R&&(Q.password=R);const St=yield ur(z,lu(j,Q));yield z._updateTokensIfNecessary(St,!0)})).apply(this,arguments)}class Ph{constructor(D,R,j={}){this.isNewUser=D,this.providerId=R,this.profile=j}}class Oh extends Ph{constructor(D,R,j,G){super(D,R,j),this.username=G}}class yd extends Ph{constructor(D,R){super(D,"facebook.com",R)}}class Eh extends Oh{constructor(D,R){super(D,"github.com",R,"string"==typeof R?.login?R?.login:null)}}class pg extends Ph{constructor(D,R){super(D,"google.com",R)}}class Kf extends Oh{constructor(D,R,j){super(D,"twitter.com",R,j)}}function vd(z){const{user:D,_tokenResponse:R}=z;return D.isAnonymous&&!R?{providerId:null,isNewUser:!1,profile:null}:function Km(z){var D,R;if(!z)return null;const{providerId:j}=z,G=z.rawUserInfo?JSON.parse(z.rawUserInfo):{},Q=z.isNewUser||"identitytoolkit#SignupNewUserResponse"===z.kind;if(!j&&z?.idToken){const St=null===(R=null===(D=Ie(z.idToken))||void 0===D?void 0:D.firebase)||void 0===R?void 0:R.sign_in_provider;if(St)return new Ph(Q,"anonymous"!==St&&"custom"!==St?St:null)}if(!j)return null;switch(j){case"facebook.com":return new yd(Q,G);case"github.com":return new Eh(Q,G);case"google.com":return new pg(Q,G);case"twitter.com":return new Kf(Q,G,z.screenName||null);case"custom":case"anonymous":return new Ph(Q,null);default:return new Ph(Q,j,G)}}(R)}class Ca{constructor(D,R,j){this.type=D,this.credential=R,this.auth=j}static _fromIdtoken(D,R){return new Ca("enroll",D,R)}static _fromMfaPendingCredential(D){return new Ca("signin",D)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(D){var R,j;if(D?.multiFactorSession){if(null!==(R=D.multiFactorSession)&&void 0!==R&&R.pendingCredential)return Ca._fromMfaPendingCredential(D.multiFactorSession.pendingCredential);if(null!==(j=D.multiFactorSession)&&void 0!==j&&j.idToken)return Ca._fromIdtoken(D.multiFactorSession.idToken)}return null}}class wd{constructor(D,R,j){this.session=D,this.hints=R,this.signInResolver=j}static _fromError(D,R){const j=Zo(D),G=R.customData._serverResponse,Q=(G.mfaInfo||[]).map(jt=>Ps._fromServerResponse(j,jt));Ct(G.mfaPendingCredential,j,"internal-error");const St=Ca._fromMfaPendingCredential(G.mfaPendingCredential);return new wd(St,Q,function(){var jt=(0,x.Z)(function*(He){const un=yield He._process(j,St);delete G.mfaInfo,delete G.mfaPendingCredential;const sn=Object.assign(Object.assign({},G),{idToken:un.idToken,refreshToken:un.refreshToken});switch(R.operationType){case"signIn":const to=yield Yn._fromIdTokenResponse(j,R.operationType,sn);return yield j._updateCurrentUser(to.user),to;case"reauthenticate":return Ct(R.user,j,"internal-error"),Yn._forOperation(R.user,R.operationType,sn);default:me(j,"internal-error")}});return function(He){return jt.apply(this,arguments)}}())}resolveSignIn(D){var R=this;return(0,x.Z)(function*(){return R.signInResolver(D)})()}}function Ec(z,D){var R;const j=(0,mt.m9)(z),G=D;return Ct(D.customData.operationType,j,"argument-error"),Ct(null===(R=G.customData._serverResponse)||void 0===R?void 0:R.mfaPendingCredential,j,"argument-error"),wd._fromError(j,G)}class Md{constructor(D){this.user=D,this.enrolledFactors=[],D._onReload(R=>{R.mfaInfo&&(this.enrolledFactors=R.mfaInfo.map(j=>Ps._fromServerResponse(D.auth,j)))})}static _fromUser(D){return new Md(D)}getSession(){var D=this;return(0,x.Z)(function*(){return Ca._fromIdtoken(yield D.user.getIdToken(),D.user.auth)})()}enroll(D,R){var j=this;return(0,x.Z)(function*(){const G=D,Q=yield j.getSession(),St=yield ur(j.user,G._process(j.user.auth,Q,R));return yield j.user._updateTokensIfNecessary(St),j.user.reload()})()}unenroll(D){var R=this;return(0,x.Z)(function*(){const j="string"==typeof D?D:D.uid,G=yield R.user.getIdToken();try{const Q=yield ur(R.user,function _g(z,D){return he(z,"POST","/v2/accounts/mfaEnrollment:withdraw",_t(z,D))}(R.user.auth,{idToken:G,mfaEnrollmentId:j}));R.enrolledFactors=R.enrolledFactors.filter(({uid:St})=>St!==j),yield R.user._updateTokensIfNecessary(Q),yield R.user.reload()}catch(Q){throw Q}})()}}const ql=new WeakMap;function Ah(z){const D=(0,mt.m9)(z);return ql.has(D)||ql.set(D,Md._fromUser(D)),ql.get(D)}const hs="__sak";class Tc{constructor(D,R){this.storageRetriever=D,this.type=R}_isAvailable(){try{return this.storage?(this.storage.setItem(hs,"1"),this.storage.removeItem(hs),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(D,R){return this.storage.setItem(D,JSON.stringify(R)),Promise.resolve()}_get(D){const R=this.storage.getItem(D);return Promise.resolve(R?JSON.parse(R):null)}_remove(D){return this.storage.removeItem(D),Promise.resolve()}get storage(){return this.storageRetriever()}}const Ji=(()=>{class z extends Tc{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(R,j)=>this.onStorageEvent(R,j),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function Xm(){const z=(0,mt.z$)();return Bt(z)||Er(z)}()&&function ir(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=$o(),this._shouldAllowMigration=!0}forAllChangedKeys(R){for(const j of Object.keys(this.listeners)){const G=this.storage.getItem(j),Q=this.localCache[j];G!==Q&&R(j,Q,G)}}onStorageEvent(R,j=!1){if(!R.key)return void this.forAllChangedKeys((jt,He,un)=>{this.notifyListeners(jt,un)});const G=R.key;if(j?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const jt=this.storage.getItem(G);if(R.newValue!==jt)null!==R.newValue?this.storage.setItem(G,R.newValue):this.storage.removeItem(G);else if(this.localCache[G]===R.newValue&&!j)return}const Q=()=>{const jt=this.storage.getItem(G);!j&&this.localCache[G]===jt||this.notifyListeners(G,jt)},St=this.storage.getItem(G);!function or(){return(0,mt.w1)()&&10===document.documentMode}()||St===R.newValue||R.newValue===R.oldValue?Q():setTimeout(Q,10)}notifyListeners(R,j){this.localCache[R]=j;const G=this.listeners[R];if(G)for(const Q of Array.from(G))Q(j&&JSON.parse(j))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((R,j,G)=>{this.onStorageEvent(new StorageEvent("storage",{key:R,oldValue:j,newValue:G}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(R,j){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[R]||(this.listeners[R]=new Set,this.localCache[R]=this.storage.getItem(R)),this.listeners[R].add(j)}_removeListener(R,j){this.listeners[R]&&(this.listeners[R].delete(j),0===this.listeners[R].size&&delete this.listeners[R]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(R,j){var G=()=>super._set,Q=this;return(0,x.Z)(function*(){yield G().call(Q,R,j),Q.localCache[R]=JSON.stringify(j)})()}_get(R){var j=()=>super._get,G=this;return(0,x.Z)(function*(){const Q=yield j().call(G,R);return G.localCache[R]=JSON.stringify(Q),Q})()}_remove(R){var j=()=>super._remove,G=this;return(0,x.Z)(function*(){yield j().call(G,R),delete G.localCache[R]})()}}return z.type="LOCAL",z})(),vu=(()=>{class z extends Tc{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(R,j){}_removeListener(R,j){}}return z.type="SESSION",z})();let ua=(()=>{class z{constructor(R){this.eventTarget=R,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(R){const j=this.receivers.find(Q=>Q.isListeningto(R));if(j)return j;const G=new z(R);return this.receivers.push(G),G}isListeningto(R){return this.eventTarget===R}handleEvent(R){var j=this;return(0,x.Z)(function*(){const G=R,{eventId:Q,eventType:St,data:jt}=G.data,He=j.handlersMap[St];if(!He?.size)return;G.ports[0].postMessage({status:"ack",eventId:Q,eventType:St});const un=Array.from(He).map(function(){var to=(0,x.Z)(function*(ns){return ns(G.origin,jt)});return function(ns){return to.apply(this,arguments)}}()),sn=yield function bu(z){return Promise.all(z.map(function(){var D=(0,x.Z)(function*(R){try{return{fulfilled:!0,value:yield R}}catch(j){return{fulfilled:!1,reason:j}}});return function(R){return D.apply(this,arguments)}}()))}(un);G.ports[0].postMessage({status:"done",eventId:Q,eventType:St,response:sn})})()}_subscribe(R,j){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[R]||(this.handlersMap[R]=new Set),this.handlersMap[R].add(j)}_unsubscribe(R,j){this.handlersMap[R]&&j&&this.handlersMap[R].delete(j),(!j||0===this.handlersMap[R].size)&&delete this.handlersMap[R],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return z.receivers=[],z})();function Ic(z="",D=10){let R="";for(let j=0;j<D;j++)R+=Math.floor(10*Math.random());return z+R}class mw{constructor(D){this.target=D,this.handlers=new Set}removeMessageHandler(D){D.messageChannel&&(D.messageChannel.port1.removeEventListener("message",D.onMessage),D.messageChannel.port1.close()),this.handlers.delete(D)}_send(D,R,j=50){var G=this;return(0,x.Z)(function*(){const Q=typeof MessageChannel<"u"?new MessageChannel:null;if(!Q)throw new Error("connection_unavailable");let St,jt;return new Promise((He,un)=>{const sn=Ic("",20);Q.port1.start();const to=setTimeout(()=>{un(new Error("unsupported_event"))},j);jt={messageChannel:Q,onMessage(ns){const gs=ns;if(gs.data.eventId===sn)switch(gs.data.status){case"ack":clearTimeout(to),St=setTimeout(()=>{un(new Error("timeout"))},3e3);break;case"done":clearTimeout(St),He(gs.data.response);break;default:clearTimeout(to),clearTimeout(St),un(new Error("invalid_response"))}}},G.handlers.add(jt),Q.port1.addEventListener("message",jt.onMessage),G.target.postMessage({eventType:D,eventId:sn,data:R},[Q.port2])}).finally(()=>{jt&&G.removeMessageHandler(jt)})})()}}function mi(){return window}function Jf(){return typeof mi().WorkerGlobalScope<"u"&&"function"==typeof mi().importScripts}function Pd(){return(Pd=(0,x.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Ni="firebaseLocalStorageDb",xi="firebaseLocalStorage",ep="fbase_key";class wu{constructor(D){this.request=D}toPromise(){return new Promise((D,R)=>{this.request.addEventListener("success",()=>{D(this.request.result)}),this.request.addEventListener("error",()=>{R(this.request.error)})})}}function Dh(z,D){return z.transaction([xi],D?"readwrite":"readonly").objectStore(xi)}function Od(){const z=indexedDB.open(Ni,1);return new Promise((D,R)=>{z.addEventListener("error",()=>{R(z.error)}),z.addEventListener("upgradeneeded",()=>{const j=z.result;try{j.createObjectStore(xi,{keyPath:ep})}catch(G){R(G)}}),z.addEventListener("success",(0,x.Z)(function*(){const j=z.result;j.objectStoreNames.contains(xi)?D(j):(j.close(),yield function Wy(){const z=indexedDB.deleteDatabase(Ni);return new wu(z).toPromise()}(),D(yield Od()))}))})}function Cu(z,D,R){return Sc.apply(this,arguments)}function Sc(){return(Sc=(0,x.Z)(function*(z,D,R){const j=Dh(z,!0).put({[ep]:D,value:R});return new wu(j).toPromise()})).apply(this,arguments)}function Ks(){return(Ks=(0,x.Z)(function*(z,D){const R=Dh(z,!1).get(D),j=yield new wu(R).toPromise();return void 0===j?null:j.value})).apply(this,arguments)}function Jm(z,D){const R=Dh(z,!0).delete(D);return new wu(R).toPromise()}const yg=(()=>{class z{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var R=this;return(0,x.Z)(function*(){return R.db||(R.db=yield Od()),R.db})()}_withRetries(R){var j=this;return(0,x.Z)(function*(){let G=0;for(;;)try{const Q=yield j._openDb();return yield R(Q)}catch(Q){if(G++>3)throw Q;j.db&&(j.db.close(),j.db=void 0)}})()}initializeServiceWorkerMessaging(){var R=this;return(0,x.Z)(function*(){return Jf()?R.initializeReceiver():R.initializeSender()})()}initializeReceiver(){var R=this;return(0,x.Z)(function*(){R.receiver=ua._getInstance(function xu(){return Jf()?self:null}()),R.receiver._subscribe("keyChanged",function(){var j=(0,x.Z)(function*(G,Q){return{keyProcessed:(yield R._poll()).includes(Q.key)}});return function(G,Q){return j.apply(this,arguments)}}()),R.receiver._subscribe("ping",function(){var j=(0,x.Z)(function*(G,Q){return["keyChanged"]});return function(G,Q){return j.apply(this,arguments)}}())})()}initializeSender(){var R=this;return(0,x.Z)(function*(){var j,G;if(R.activeServiceWorker=yield function tp(){return Pd.apply(this,arguments)}(),!R.activeServiceWorker)return;R.sender=new mw(R.activeServiceWorker);const Q=yield R.sender._send("ping",{},800);Q&&null!==(j=Q[0])&&void 0!==j&&j.fulfilled&&null!==(G=Q[0])&&void 0!==G&&G.value.includes("keyChanged")&&(R.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(R){var j=this;return(0,x.Z)(function*(){if(j.sender&&j.activeServiceWorker&&function Ka(){var z;return(null===(z=navigator?.serviceWorker)||void 0===z?void 0:z.controller)||null}()===j.activeServiceWorker)try{yield j.sender._send("keyChanged",{key:R},j.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,x.Z)(function*(){try{if(!indexedDB)return!1;const R=yield Od();return yield Cu(R,hs,"1"),yield Jm(R,hs),!0}catch{}return!1})()}_withPendingWrite(R){var j=this;return(0,x.Z)(function*(){j.pendingWrites++;try{yield R()}finally{j.pendingWrites--}})()}_set(R,j){var G=this;return(0,x.Z)(function*(){return G._withPendingWrite((0,x.Z)(function*(){return yield G._withRetries(Q=>Cu(Q,R,j)),G.localCache[R]=j,G.notifyServiceWorker(R)}))})()}_get(R){var j=this;return(0,x.Z)(function*(){const G=yield j._withRetries(Q=>function Qm(z,D){return Ks.apply(this,arguments)}(Q,R));return j.localCache[R]=G,G})()}_remove(R){var j=this;return(0,x.Z)(function*(){return j._withPendingWrite((0,x.Z)(function*(){return yield j._withRetries(G=>Jm(G,R)),delete j.localCache[R],j.notifyServiceWorker(R)}))})()}_poll(){var R=this;return(0,x.Z)(function*(){const j=yield R._withRetries(St=>{const jt=Dh(St,!1).getAll();return new wu(jt).toPromise()});if(!j)return[];if(0!==R.pendingWrites)return[];const G=[],Q=new Set;for(const{fbase_key:St,value:jt}of j)Q.add(St),JSON.stringify(R.localCache[St])!==JSON.stringify(jt)&&(R.notifyListeners(St,jt),G.push(St));for(const St of Object.keys(R.localCache))R.localCache[St]&&!Q.has(St)&&(R.notifyListeners(St,null),G.push(St));return G})()}notifyListeners(R,j){this.localCache[R]=j;const G=this.listeners[R];if(G)for(const Q of Array.from(G))Q(j)}startPolling(){var R=this;this.stopPolling(),this.pollTimer=setInterval((0,x.Z)(function*(){return R._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(R,j){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[R]||(this.listeners[R]=new Set,this._get(R)),this.listeners[R].add(j)}_removeListener(R,j){this.listeners[R]&&(this.listeners[R].delete(j),0===this.listeners[R].size&&delete this.listeners[R]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return z.type="LOCAL",z})(),kh=1e12;class op{constructor(D){this.auth=D,this.counter=kh,this._widgets=new Map}render(D,R){const j=this.counter;return this._widgets.set(j,new vg(D,this.auth.name,R||{})),this.counter++,j}reset(D){var R;const j=D||kh;null===(R=this._widgets.get(j))||void 0===R||R.delete(),this._widgets.delete(j)}getResponse(D){var R;return(null===(R=this._widgets.get(D||kh))||void 0===R?void 0:R.getResponse())||""}execute(D){var R=this;return(0,x.Z)(function*(){var j;return null===(j=R._widgets.get(D||kh))||void 0===j||j.execute(),""})()}}class vg{constructor(D,R,j){this.params=j,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const G="string"==typeof D?document.getElementById(D):D;Ct(G,"argument-error",{appName:R}),this.container=G,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function bg(z){const D=[],R="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let j=0;j<z;j++)D.push(R.charAt(Math.floor(62*Math.random())));return D.join("")}(50);const{callback:D,"expired-callback":R}=this.params;if(D)try{D(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,R)try{R()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Rh=zr("rcb"),Ls=new Ne(3e4,6e4);class Td{constructor(){var D;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(D=mi().grecaptcha)||void 0===D||!D.render)}load(D,R=""){return Ct(function Id(z){return z.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(z)}(R),D,"argument-error"),this.shouldResolveImmediately(R)&&vr(mi().grecaptcha)?Promise.resolve(mi().grecaptcha):new Promise((j,G)=>{const Q=mi().setTimeout(()=>{G(tt(D,"network-request-failed"))},Ls.get());mi()[Rh]=()=>{mi().clearTimeout(Q),delete mi()[Rh];const jt=mi().grecaptcha;if(!jt||!vr(jt))return void G(tt(D,"internal-error"));const He=jt.render;jt.render=(un,sn)=>{const to=He(un,sn);return this.counter++,to},this.hostLanguage=R,j(jt)},Io(`https://www.google.com/recaptcha/api.js??${(0,mt.xO)({onload:Rh,render:"explicit",hl:R})}`).catch(()=>{clearTimeout(Q),G(tt(D,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(D){var R;return!(null===(R=mi().grecaptcha)||void 0===R||!R.render)&&(D===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Ma{load(D){return(0,x.Z)(function*(){return new op(D)})()}clearedOneInstance(){}}const e_="recaptcha",ip={theme:"light",type:"image"};class Ky{constructor(D,R=Object.assign({},ip),j){this.parameters=R,this.type=e_,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Zo(j),this.isInvisible="invisible"===this.parameters.size,Ct(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const G="string"==typeof D?document.getElementById(D):D;Ct(G,this.auth,"argument-error"),this.container=G,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Ma:new Td,this.validateStartingState()}verify(){var D=this;return(0,x.Z)(function*(){D.assertNotDestroyed();const R=yield D.render(),j=D.getAssertedRecaptcha();return j.getResponse(R)||new Promise(Q=>{const St=jt=>{jt&&(D.tokenChangeListeners.delete(St),Q(jt))};D.tokenChangeListeners.add(St),D.isInvisible&&j.execute(R)})})()}render(){try{this.assertNotDestroyed()}catch(D){return Promise.reject(D)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(D=>{throw this.renderPromise=null,D})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(D=>{this.container.removeChild(D)})}validateStartingState(){Ct(!this.parameters.sitekey,this.auth,"argument-error"),Ct(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Ct(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(D){return R=>{if(this.tokenChangeListeners.forEach(j=>j(R)),"function"==typeof D)D(R);else if("string"==typeof D){const j=mi()[D];"function"==typeof j&&j(R)}}}assertNotDestroyed(){Ct(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var D=this;return(0,x.Z)(function*(){if(yield D.init(),!D.widgetId){let R=D.container;if(!D.isInvisible){const j=document.createElement("div");R.appendChild(j),R=j}D.widgetId=D.getAssertedRecaptcha().render(R,D.parameters)}return D.widgetId})()}init(){var D=this;return(0,x.Z)(function*(){Ct(cs()&&!Jf(),D.auth,"internal-error"),yield function Ac(){let z=null;return new Promise(D=>{"complete"!==document.readyState?(z=()=>D(),window.addEventListener("load",z)):D()}).catch(D=>{throw z&&window.removeEventListener("load",z),D})}(),D.recaptcha=yield D._recaptchaLoader.load(D.auth,D.auth.languageCode||void 0);const R=yield function ne(z){return Vt.apply(this,arguments)}(D.auth);Ct(R,D.auth,"internal-error"),D.parameters.sitekey=R})()}getAssertedRecaptcha(){return Ct(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Dc{constructor(D,R){this.verificationId=D,this.onConfirmation=R}confirm(D){const R=Zr._fromVerification(this.verificationId,D);return this.onConfirmation(R)}}function Pa(z,D,R){return Wr.apply(this,arguments)}function Wr(){return(Wr=(0,x.Z)(function*(z,D,R){const j=Zo(z),G=yield Rc(j,D,(0,mt.m9)(R));return new Dc(G,Q=>yl(j,Q))})).apply(this,arguments)}function da(z,D,R){return Ns.apply(this,arguments)}function Ns(){return(Ns=(0,x.Z)(function*(z,D,R){const j=(0,mt.m9)(z);yield Un(!1,j,"phone");const G=yield Rc(j.auth,D,(0,mt.m9)(R));return new Dc(G,Q=>vl(j,Q))})).apply(this,arguments)}function Mu(z,D,R){return kc.apply(this,arguments)}function kc(){return(kc=(0,x.Z)(function*(z,D,R){const j=(0,mt.m9)(z),G=yield Rc(j.auth,D,(0,mt.m9)(R));return new Dc(G,Q=>Yo(j,Q))})).apply(this,arguments)}function Rc(z,D,R){return xl.apply(this,arguments)}function xl(){return xl=(0,x.Z)(function*(z,D,R){var j;const G=yield R.verify();try{let Q;if(Ct("string"==typeof G,z,"argument-error"),Ct(R.type===e_,z,"argument-error"),Q="string"==typeof D?{phoneNumber:D}:D,"session"in Q){const St=Q.session;if("phoneNumber"in Q)return Ct("enroll"===St.type,z,"internal-error"),(yield function Cd(z,D){return he(z,"POST","/v2/accounts/mfaEnrollment:start",_t(z,D))}(z,{idToken:St.credential,phoneEnrollmentInfo:{phoneNumber:Q.phoneNumber,recaptchaToken:G}})).phoneSessionInfo.sessionInfo;{Ct("signin"===St.type,z,"internal-error");const jt=(null===(j=Q.multiFactorHint)||void 0===j?void 0:j.uid)||Q.multiFactorUid;return Ct(jt,z,"missing-multi-factor-info"),(yield function Ed(z,D){return he(z,"POST","/v2/accounts/mfaSignIn:start",_t(z,D))}(z,{mfaPendingCredential:St.credential,mfaEnrollmentId:jt,phoneSignInInfo:{recaptchaToken:G}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:St}=yield function Ae(z,D){return br.apply(this,arguments)}(z,{phoneNumber:Q.phoneNumber,recaptchaToken:G});return St}}finally{R._reset()}}),xl.apply(this,arguments)}function n_(z,D){return Pu.apply(this,arguments)}function Pu(){return(Pu=(0,x.Z)(function*(z,D){yield aa((0,mt.m9)(z),D)})).apply(this,arguments)}let Ou=(()=>{class z{constructor(R){this.providerId=z.PROVIDER_ID,this.auth=Zo(R)}verifyPhoneNumber(R,j){return Rc(this.auth,R,(0,mt.m9)(j))}static credential(R,j){return Zr._fromVerification(R,j)}static credentialFromResult(R){return z.credentialFromTaggedObject(R)}static credentialFromError(R){return z.credentialFromTaggedObject(R.customData||{})}static credentialFromTaggedObject({_tokenResponse:R}){if(!R)return null;const{phoneNumber:j,temporaryProof:G}=R;return j&&G?Zr._fromTokenResponse(j,G):null}}return z.PROVIDER_ID="phone",z.PHONE_SIGN_IN_METHOD="phone",z})();function Zl(z,D){return D?le(D):(Ct(z._popupRedirectResolver,z,"argument-error"),z._popupRedirectResolver)}class xg extends oa{constructor(D){super("custom","custom"),this.params=D}_getIdTokenResponse(D){return hi(D,this._buildIdpRequest())}_linkToIdToken(D,R){return hi(D,this._buildIdpRequest(R))}_getReauthenticationResolver(D){return hi(D,this._buildIdpRequest())}_buildIdpRequest(D){const R={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return D&&(R.idToken=D),R}}function oi(z){return la(z.auth,new xg(z),z.bypassAuthState)}function Eu(z){const{auth:D,user:R}=z;return Ct(R,D,"internal-error"),_l(R,new xg(z),z.bypassAuthState)}function Xo(z){return wl.apply(this,arguments)}function wl(){return(wl=(0,x.Z)(function*(z){const{auth:D,user:R}=z;return Ct(R,D,"internal-error"),aa(R,new xg(z),z.bypassAuthState)})).apply(this,arguments)}class Wl{constructor(D,R,j,G,Q=!1){this.auth=D,this.resolver=j,this.user=G,this.bypassAuthState=Q,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(R)?R:[R]}execute(){var D=this;return new Promise(function(){var R=(0,x.Z)(function*(j,G){D.pendingPromise={resolve:j,reject:G};try{D.eventManager=yield D.resolver._initialize(D.auth),yield D.onExecution(),D.eventManager.registerConsumer(D)}catch(Q){D.reject(Q)}});return function(j,G){return R.apply(this,arguments)}}())}onAuthEvent(D){var R=this;return(0,x.Z)(function*(){const{urlResponse:j,sessionId:G,postBody:Q,tenantId:St,error:jt,type:He}=D;if(jt)return void R.reject(jt);const un={auth:R.auth,requestUri:j,sessionId:G,tenantId:St||void 0,postBody:Q||void 0,user:R.user,bypassAuthState:R.bypassAuthState};try{R.resolve(yield R.getIdpTask(He)(un))}catch(sn){R.reject(sn)}})()}onError(D){this.reject(D)}getIdpTask(D){switch(D){case"signInViaPopup":case"signInViaRedirect":return oi;case"linkViaPopup":case"linkViaRedirect":return Xo;case"reauthViaPopup":case"reauthViaRedirect":return Eu;default:me(this.auth,"internal-error")}}resolve(D){en(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(D),this.unregisterAndCleanUp()}reject(D){en(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(D),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const sp=new Ne(2e3,1e4);function Es(z,D,R){return Je.apply(this,arguments)}function Je(){return(Je=(0,x.Z)(function*(z,D,R){const j=Zo(z);Ve(z,D,Ws);const G=Zl(j,R);return new Yl(j,"signInViaPopup",D,G).executeNotNull()})).apply(this,arguments)}function ts(z,D,R){return Oa.apply(this,arguments)}function Oa(){return(Oa=(0,x.Z)(function*(z,D,R){const j=(0,mt.m9)(z);Ve(j.auth,D,Ws);const G=Zl(j.auth,R);return new Yl(j.auth,"reauthViaPopup",D,G,j).executeNotNull()})).apply(this,arguments)}function $r(z,D,R){return Kl.apply(this,arguments)}function Kl(){return(Kl=(0,x.Z)(function*(z,D,R){const j=(0,mt.m9)(z);Ve(j.auth,D,Ws);const G=Zl(j.auth,R);return new Yl(j.auth,"linkViaPopup",D,G,j).executeNotNull()})).apply(this,arguments)}let Yl=(()=>{class z extends Wl{constructor(R,j,G,Q,St){super(R,j,Q,St),this.provider=G,this.authWindow=null,this.pollId=null,z.currentPopupAction&&z.currentPopupAction.cancel(),z.currentPopupAction=this}executeNotNull(){var R=this;return(0,x.Z)(function*(){const j=yield R.execute();return Ct(j,R.auth,"internal-error"),j})()}onExecution(){var R=this;return(0,x.Z)(function*(){en(1===R.filter.length,"Popup operations only handle one event");const j=Ic();R.authWindow=yield R.resolver._openPopup(R.auth,R.provider,R.filter[0],j),R.authWindow.associatedEvent=j,R.resolver._originValidation(R.auth).catch(G=>{R.reject(G)}),R.resolver._isIframeWebStorageSupported(R.auth,G=>{G||R.reject(tt(R.auth,"web-storage-unsupported"))}),R.pollUserCancellation()})()}get eventId(){var R;return(null===(R=this.authWindow)||void 0===R?void 0:R.associatedEvent)||null}cancel(){this.reject(tt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,z.currentPopupAction=null}pollUserCancellation(){const R=()=>{var j,G;this.pollId=null!==(G=null===(j=this.authWindow)||void 0===j?void 0:j.window)&&void 0!==G&&G.closed?window.setTimeout(()=>{this.pollId=null,this.reject(tt(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(R,sp.get())};R()}}return z.currentPopupAction=null,z})();const Sd="pendingRedirect",Ts=new Map;class ii extends Wl{constructor(D,R,j=!1){super(D,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],R,void 0,j),this.eventId=null}execute(){var D=()=>super.execute,R=this;return(0,x.Z)(function*(){let j=Ts.get(R.auth._key());if(!j){try{const Q=(yield function ap(z,D){return Xa.apply(this,arguments)}(R.resolver,R.auth))?yield D().call(R):null;j=()=>Promise.resolve(Q)}catch(G){j=()=>Promise.reject(G)}Ts.set(R.auth._key(),j)}return R.bypassAuthState||Ts.set(R.auth._key(),()=>Promise.resolve(null)),j()})()}onAuthEvent(D){var R=()=>super.onAuthEvent,j=this;return(0,x.Z)(function*(){if("signInViaRedirect"===D.type)return R().call(j,D);if("unknown"!==D.type){if(D.eventId){const G=yield j.auth._redirectUserForId(D.eventId);if(G)return j.user=G,R().call(j,D);j.resolve(null)}}else j.resolve(null)})()}onExecution(){return(0,x.Z)(function*(){})()}cleanUp(){}}function Xa(){return(Xa=(0,x.Z)(function*(z,D){const R=wg(D),j=r_(z);if(!(yield j._isAvailable()))return!1;const G="true"===(yield j._get(R));return yield j._remove(R),G})).apply(this,arguments)}function Tu(z,D){return Lc.apply(this,arguments)}function Lc(){return(Lc=(0,x.Z)(function*(z,D){return r_(z)._set(wg(D),"true")})).apply(this,arguments)}function Lh(){Ts.clear()}function Ad(z,D){Ts.set(z._key(),D)}function r_(z){return le(z._redirectPersistence)}function wg(z){return xe(Sd,z.config.apiKey,z.name)}function o_(z,D,R){return function Nh(z,D,R){return Fh.apply(this,arguments)}(z,D,R)}function Fh(){return(Fh=(0,x.Z)(function*(z,D,R){const j=Zo(z);Ve(z,D,Ws),yield j._initializationPromise;const G=Zl(j,R);return yield Tu(G,j),G._openRedirect(j,D,"signInViaRedirect")})).apply(this,arguments)}function ps(z,D,R){return function lp(z,D,R){return ha.apply(this,arguments)}(z,D,R)}function ha(){return(ha=(0,x.Z)(function*(z,D,R){const j=(0,mt.m9)(z);Ve(j.auth,D,Ws),yield j.auth._initializationPromise;const G=Zl(j.auth,R);yield Tu(G,j.auth);const Q=yield up(j);return G._openRedirect(j.auth,D,"reauthViaRedirect",Q)})).apply(this,arguments)}function Xl(z,D,R){return function Dd(z,D,R){return Qa.apply(this,arguments)}(z,D,R)}function Qa(){return(Qa=(0,x.Z)(function*(z,D,R){const j=(0,mt.m9)(z);Ve(j.auth,D,Ws),yield j.auth._initializationPromise;const G=Zl(j.auth,R);yield Un(!1,j,D.providerId),yield Tu(G,j.auth);const Q=yield up(j);return G._openRedirect(j.auth,D,"linkViaRedirect",Q)})).apply(this,arguments)}function kd(z,D){return Ja.apply(this,arguments)}function Ja(){return(Ja=(0,x.Z)(function*(z,D){return yield Zo(z)._initializationPromise,cp(z,D,!1)})).apply(this,arguments)}function cp(z,D){return Cl.apply(this,arguments)}function Cl(){return(Cl=(0,x.Z)(function*(z,D,R=!1){const j=Zo(z),G=Zl(j,D),St=yield new ii(j,G,R).execute();return St&&!R&&(delete St.user._redirectEventId,yield j._persistUserIfCurrent(St.user),yield j._setRedirectUser(null,D)),St})).apply(this,arguments)}function up(z){return Cg.apply(this,arguments)}function Cg(){return(Cg=(0,x.Z)(function*(z){const D=Ic(`${z.uid}:::`);return z._redirectEventId=D,yield z.auth._setRedirectUser(z),yield z.auth._persistUserIfCurrent(z),D})).apply(this,arguments)}class Mg{constructor(D){this.auth=D,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(D){this.consumers.add(D),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,D)&&(this.sendToConsumer(this.queuedRedirectEvent,D),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(D){this.consumers.delete(D)}onEvent(D){if(this.hasEventBeenHandled(D))return!1;let R=!1;return this.consumers.forEach(j=>{this.isEventForConsumer(D,j)&&(R=!0,this.sendToConsumer(D,j),this.saveEventToCache(D))}),this.hasHandledPotentialRedirect||!function dp(z){switch(z.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Rd(z);default:return!1}}(D)||(this.hasHandledPotentialRedirect=!0,R||(this.queuedRedirectEvent=D,R=!0)),R}sendToConsumer(D,R){var j;if(D.error&&!Rd(D)){const G=(null===(j=D.error.code)||void 0===j?void 0:j.split("auth/")[1])||"internal-error";R.onError(tt(this.auth,G))}else R.onAuthEvent(D)}isEventForConsumer(D,R){const j=null===R.eventId||!!D.eventId&&D.eventId===R.eventId;return R.filter.includes(D.type)&&j}hasEventBeenHandled(D){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ml(D))}saveEventToCache(D){this.cachedEventUids.add(Ml(D)),this.lastProcessedEventTime=Date.now()}}function Ml(z){return[z.type,z.eventId,z.sessionId,z.tenantId].filter(D=>D).join("-")}function Rd({type:z,error:D}){return"unknown"===z&&"auth/no-auth-event"===D?.code}function Iu(z){return Ld.apply(this,arguments)}function Ld(){return(Ld=(0,x.Z)(function*(z,D={}){return he(z,"GET","/v1/projects",D)})).apply(this,arguments)}const wi=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zh=/^https?/;function Ea(){return(Ea=(0,x.Z)(function*(z){if(z.config.emulator)return;const{authorizedDomains:D}=yield Iu(z);for(const R of D)try{if(Nd(R))return}catch{}me(z,"unauthorized-domain")})).apply(this,arguments)}function Nd(z){const D=Vo(),{protocol:R,hostname:j}=new URL(D);if(z.startsWith("chrome-extension://")){const St=new URL(z);return""===St.hostname&&""===j?"chrome-extension:"===R&&z.replace("chrome-extension://","")===D.replace("chrome-extension://",""):"chrome-extension:"===R&&St.hostname===j}if(!zh.test(R))return!1;if(wi.test(z))return j===z;const G=z.replace(/\./g,"\\.");return new RegExp("^(.+\\."+G+"|"+G+")$","i").test(j)}const hp=new Ne(3e4,6e4);function tl(){const z=mi().___jsl;if(z?.H)for(const D of Object.keys(z.H))if(z.H[D].r=z.H[D].r||[],z.H[D].L=z.H[D].L||[],z.H[D].r=[...z.H[D].L],z.CP)for(let R=0;R<z.CP.length;R++)z.CP[R]=null}let Bh=null;const fp=new Ne(5e3,15e3),Au="__/auth/iframe",Nc="emulator/auth/iframe",es={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fa=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Uh(z){const D=z.config;Ct(D.authDomain,z,"auth-domain-config-required");const R=D.emulator?vs(D,Nc):`https://${z.config.authDomain}/${Au}`,j={apiKey:D.apiKey,appName:z.name,v:It.SDK_VERSION},G=fa.get(z.config.apiHost);G&&(j.eid=G);const Q=z._getFrameworks();return Q.length&&(j.fw=Q.join(",")),`${R}?${(0,mt.xO)(j).slice(1)}`}function Pl(){return Pl=(0,x.Z)(function*(z){const D=yield function Pg(z){return Bh=Bh||function Fd(z){return new Promise((D,R)=>{var j,G,Q;function St(){tl(),gapi.load("gapi.iframes",{callback:()=>{D(gapi.iframes.getContext())},ontimeout:()=>{tl(),R(tt(z,"network-request-failed"))},timeout:hp.get()})}if(null!==(G=null===(j=mi().gapi)||void 0===j?void 0:j.iframes)&&void 0!==G&&G.Iframe)D(gapi.iframes.getContext());else{if(null===(Q=mi().gapi)||void 0===Q||!Q.load){const jt=zr("iframefcb");return mi()[jt]=()=>{gapi.load?St():R(tt(z,"network-request-failed"))},Io(`https://apis.google.com/js/api.js?onload=${jt}`).catch(He=>R(He))}St()}}).catch(D=>{throw Bh=null,D})}(z),Bh}(z),R=mi().gapi;return Ct(R,z,"internal-error"),D.open({where:document.body,url:Uh(z),messageHandlersFilter:R.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:es,dontclear:!0},j=>new Promise(function(){var G=(0,x.Z)(function*(Q,St){yield j.restyle({setHideOnLeave:!1});const jt=tt(z,"network-request-failed"),He=mi().setTimeout(()=>{St(jt)},fp.get());function un(){mi().clearTimeout(He),Q(j)}j.ping(un).then(un,()=>{St(jt)})});return function(Q,St){return G.apply(this,arguments)}}()))}),Pl.apply(this,arguments)}const Fi={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class zd{constructor(D){this.window=D,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const V="__/auth/handler",W="emulator/auth/handler",ut=encodeURIComponent("fac");function Mt(z,D,R,j,G,Q){return Lt.apply(this,arguments)}function Lt(){return(Lt=(0,x.Z)(function*(z,D,R,j,G,Q){Ct(z.config.authDomain,z,"auth-domain-config-required"),Ct(z.config.apiKey,z,"invalid-api-key");const St={apiKey:z.config.apiKey,appName:z.name,authType:R,redirectUrl:j,v:It.SDK_VERSION,eventId:G};if(D instanceof Ws){D.setDefaultLanguage(z.languageCode),St.providerId=D.providerId||"",(0,mt.xb)(D.getCustomParameters())||(St.customParameters=JSON.stringify(D.getCustomParameters()));for(const[sn,to]of Object.entries(Q||{}))St[sn]=to}if(D instanceof Cc){const sn=D.getScopes().filter(to=>""!==to);sn.length>0&&(St.scopes=sn.join(","))}z.tenantId&&(St.tid=z.tenantId);const jt=St;for(const sn of Object.keys(jt))void 0===jt[sn]&&delete jt[sn];const He=yield z._getAppCheckToken(),un=He?`#${ut}=${encodeURIComponent(He)}`:"";return`${function se({config:z}){return z.emulator?vs(z,W):`https://${z.authDomain}/${V}`}(z)}?${(0,mt.xO)(jt).slice(1)}${un}`})).apply(this,arguments)}const on="webStorageSupport",xn=class nn{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vu,this._completeRedirectFn=cp,this._overrideRedirectResult=Ad}_openPopup(D,R,j,G){var Q=this;return(0,x.Z)(function*(){var St;en(null===(St=Q.eventManagers[D._key()])||void 0===St?void 0:St.manager,"_initialize() not called before _openPopup()");const jt=yield Mt(D,R,j,Vo(),G);return function nc(z,D,R,j=500,G=600){const Q=Math.max((window.screen.availHeight-G)/2,0).toString(),St=Math.max((window.screen.availWidth-j)/2,0).toString();let jt="";const He=Object.assign(Object.assign({},Fi),{width:j.toString(),height:G.toString(),top:Q,left:St}),un=(0,mt.z$)().toLowerCase();R&&(jt=kt(un)?"_blank":R),ht(un)&&(D=D||"http://localhost",He.scrollbars="yes");const sn=Object.entries(He).reduce((ns,[gs,jh])=>`${ns}${gs}=${jh},`,"");if(function Pr(z=(0,mt.z$)()){var D;return Er(z)&&!(null===(D=window.navigator)||void 0===D||!D.standalone)}(un)&&"_self"!==jt)return function U(z,D){const R=document.createElement("a");R.href=z,R.target=D;const j=document.createEvent("MouseEvent");j.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),R.dispatchEvent(j)}(D||"",jt),new zd(null);const to=window.open(D||"",jt,sn);Ct(to,z,"popup-blocked");try{to.focus()}catch{}return new zd(to)}(D,jt,Ic())})()}_openRedirect(D,R,j,G){var Q=this;return(0,x.Z)(function*(){return yield Q._originValidation(D),function Os(z){mi().location.href=z}(yield Mt(D,R,j,Vo(),G)),new Promise(()=>{})})()}_initialize(D){const R=D._key();if(this.eventManagers[R]){const{manager:G,promise:Q}=this.eventManagers[R];return G?Promise.resolve(G):(en(Q,"If manager is not set, promise should be"),Q)}const j=this.initAndGetManager(D);return this.eventManagers[R]={promise:j},j.catch(()=>{delete this.eventManagers[R]}),j}initAndGetManager(D){var R=this;return(0,x.Z)(function*(){const j=yield function Ql(z){return Pl.apply(this,arguments)}(D),G=new Mg(D);return j.register("authEvent",Q=>(Ct(Q?.authEvent,D,"invalid-auth-event"),{status:G.onEvent(Q.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),R.eventManagers[D._key()]={manager:G},R.iframes[D._key()]=j,G})()}_isIframeWebStorageSupported(D,R){this.iframes[D._key()].send(on,{type:on},G=>{var Q;const St=null===(Q=G?.[0])||void 0===Q?void 0:Q[on];void 0!==St&&R(!!St),me(D,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(D){const R=D._key();return this.originValidationPromises[R]||(this.originValidationPromises[R]=function Su(z){return Ea.apply(this,arguments)}(D)),this.originValidationPromises[R]}get _shouldInitProactively(){return $o()||Bt()||Er()}};class mr{constructor(D){this.factorId=D}_process(D,R,j){switch(R.type){case"enroll":return this._finalizeEnroll(D,R.credential,j);case"signin":return this._finalizeSignIn(D,R.credential);default:return ge("unexpected MultiFactorSessionType")}}}class hr extends mr{constructor(D){super("phone"),this.credential=D}static _fromCredential(D){return new hr(D)}_finalizeEnroll(D,R,j){return function Sh(z,D){return he(z,"POST","/v2/accounts/mfaEnrollment:finalize",_t(z,D))}(D,{idToken:R,displayName:j,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(D,R){return function fs(z,D){return he(z,"POST","/v2/accounts/mfaSignIn:finalize",_t(z,D))}(D,{mfaPendingCredential:R,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let _o=(()=>{class z{constructor(){}static assertion(R){return hr._fromCredential(R)}}return z.FACTOR_ID="phone",z})();var Zi="@firebase/auth";class Du{constructor(D){this.auth=D,this.internalListeners=new Map}getUid(){var D;return this.assertAuthConfigured(),(null===(D=this.auth.currentUser)||void 0===D?void 0:D.uid)||null}getToken(D){var R=this;return(0,x.Z)(function*(){return R.assertAuthConfigured(),yield R.auth._initializationPromise,R.auth.currentUser?{accessToken:yield R.auth.currentUser.getIdToken(D)}:null})()}addAuthTokenListener(D){if(this.assertAuthConfigured(),this.internalListeners.has(D))return;const R=this.auth.onIdTokenChanged(j=>{D(j?.stsTokenManager.accessToken||null)});this.internalListeners.set(D,R),this.updateProactiveRefresh()}removeAuthTokenListener(D){this.assertAuthConfigured();const R=this.internalListeners.get(D);R&&(this.internalListeners.delete(D),R(),this.updateProactiveRefresh())}assertAuthConfigured(){Ct(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Og=(0,mt.Pz)("authIdTokenMaxAge")||300;let i_=null;const Xs=z=>function(){var D=(0,x.Z)(function*(R){const j=R&&(yield R.getIdTokenResult()),G=j&&((new Date).getTime()-Date.parse(j.issuedAtTime))/1e3;if(G&&G>Og)return;const Q=j?.token;i_!==Q&&(i_=Q,yield fetch(z,{method:Q?"POST":"DELETE",headers:Q?{Authorization:`Bearer ${Q}`}:{}}))});return function(R){return D.apply(this,arguments)}}();function s_(z=(0,It.getApp)()){const D=(0,It._getProvider)(z,"auth");if(D.isInitialized())return D.getImmediate();const R=function ba(z,D){const R=(0,It._getProvider)(z,"auth");if(R.isInitialized()){const G=R.getImmediate(),Q=R.getOptions();if((0,mt.vZ)(Q,D??{}))return G;me(G,"already-initialized")}return R.initialize({options:D})}(z,{popupRedirectResolver:xn,persistence:[yg,Ji,vu]}),j=(0,mt.Pz)("authTokenSyncURL");if(j){const Q=Xs(j);(function Yf(z,D,R){(0,mt.m9)(z).beforeAuthStateChanged(D,R)})(R,Q,()=>Q(R.currentUser)),function xd(z,D,R,j){(0,mt.m9)(z).onIdTokenChanged(D,R,j)}(R,St=>Q(St))}const G=(0,mt.q4)("auth");return G&&dd(R,`http://${G}`),R}!function el(z){(0,It._registerComponent)(new ye.wA("auth",(D,{options:R})=>{const j=D.getProvider("app").getImmediate(),G=D.getProvider("heartbeat"),Q=D.getProvider("app-check-internal"),{apiKey:St,authDomain:jt}=j.options;Ct(St&&!St.includes(":"),"invalid-api-key",{appName:j.name});const He={apiKey:St,authDomain:jt,clientPlatform:z,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qs(z)},un=new Va(j,G,Q,He);return function ud(z,D){const R=D?.persistence||[],j=(Array.isArray(R)?R:[R]).map(le);D?.errorMap&&z._updateErrorMap(D.errorMap),z._initializeWithPersistence(j,D?.popupRedirectResolver)}(un,R),un},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((D,R,j)=>{D.getProvider("auth-internal").initialize()})),(0,It._registerComponent)(new ye.wA("auth-internal",D=>{const R=Zo(D.getProvider("auth").getImmediate());return new Du(R)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,It.registerVersion)(Zi,"0.23.2",function Vh(z){switch(z){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(z)),(0,It.registerVersion)(Zi,"0.23.2","esm2017")}("Browser")},229:(Hn,we,ft)=>{"use strict";ft.d(we,{$s:()=>le,BH:()=>Xt,L:()=>be,LL:()=>Ue,P0:()=>Ce,Pz:()=>tt,Sg:()=>Ve,UG:()=>ge,US:()=>ye,ZB:()=>Yt,ZR:()=>he,aH:()=>me,b$:()=>cs,eu:()=>Kt,hl:()=>Wt,jU:()=>en,m9:()=>xe,ne:()=>ur,pd:()=>Ie,q4:()=>Fn,r3:()=>nt,ru:()=>Vo,tV:()=>Pt,uI:()=>Ct,vZ:()=>Pe,w1:()=>us,xO:()=>Xe,xb:()=>Qt,z$:()=>Gt,zI:()=>pe,zd:()=>Ze});const vt=function(ot){const at=[];let ht=0;for(let Bt=0;Bt<ot.length;Bt++){let kt=ot.charCodeAt(Bt);kt<128?at[ht++]=kt:kt<2048?(at[ht++]=kt>>6|192,at[ht++]=63&kt|128):55296==(64512&kt)&&Bt+1<ot.length&&56320==(64512&ot.charCodeAt(Bt+1))?(kt=65536+((1023&kt)<<10)+(1023&ot.charCodeAt(++Bt)),at[ht++]=kt>>18|240,at[ht++]=kt>>12&63|128,at[ht++]=kt>>6&63|128,at[ht++]=63&kt|128):(at[ht++]=kt>>12|224,at[ht++]=kt>>6&63|128,at[ht++]=63&kt|128)}return at},ye={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(ot,at){if(!Array.isArray(ot))throw Error("encodeByteArray takes an array as a parameter");this.init_();const ht=at?this.byteToCharMapWebSafe_:this.byteToCharMap_,Bt=[];for(let kt=0;kt<ot.length;kt+=3){const ee=ot[kt],Ke=kt+1<ot.length,Nn=Ke?ot[kt+1]:0,yr=kt+2<ot.length,Er=yr?ot[kt+2]:0;let or=(15&Nn)<<2|Er>>6,$o=63&Er;yr||($o=64,Ke||(or=64)),Bt.push(ht[ee>>2],ht[(3&ee)<<4|Nn>>4],ht[or],ht[$o])}return Bt.join("")},encodeString(ot,at){return this.HAS_NATIVE_SUPPORT&&!at?btoa(ot):this.encodeByteArray(vt(ot),at)},decodeString(ot,at){return this.HAS_NATIVE_SUPPORT&&!at?atob(ot):function(ot){const at=[];let ht=0,Bt=0;for(;ht<ot.length;){const kt=ot[ht++];if(kt<128)at[Bt++]=String.fromCharCode(kt);else if(kt>191&&kt<224){const ee=ot[ht++];at[Bt++]=String.fromCharCode((31&kt)<<6|63&ee)}else if(kt>239&&kt<365){const yr=((7&kt)<<18|(63&ot[ht++])<<12|(63&ot[ht++])<<6|63&ot[ht++])-65536;at[Bt++]=String.fromCharCode(55296+(yr>>10)),at[Bt++]=String.fromCharCode(56320+(1023&yr))}else{const ee=ot[ht++],Ke=ot[ht++];at[Bt++]=String.fromCharCode((15&kt)<<12|(63&ee)<<6|63&Ke)}}return at.join("")}(this.decodeStringToByteArray(ot,at))},decodeStringToByteArray(ot,at){this.init_();const ht=at?this.charToByteMapWebSafe_:this.charToByteMap_,Bt=[];for(let kt=0;kt<ot.length;){const ee=ht[ot.charAt(kt++)],Nn=kt<ot.length?ht[ot.charAt(kt)]:0;++kt;const Er=kt<ot.length?ht[ot.charAt(kt)]:64;++kt;const Pr=kt<ot.length?ht[ot.charAt(kt)]:64;if(++kt,null==ee||null==Nn||null==Er||null==Pr)throw new ke;Bt.push(ee<<2|Nn>>4),64!==Er&&(Bt.push(Nn<<4&240|Er>>2),64!==Pr&&Bt.push(Er<<6&192|Pr))}return Bt},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let ot=0;ot<this.ENCODED_VALS.length;ot++)this.byteToCharMap_[ot]=this.ENCODED_VALS.charAt(ot),this.charToByteMap_[this.byteToCharMap_[ot]]=ot,this.byteToCharMapWebSafe_[ot]=this.ENCODED_VALS_WEBSAFE.charAt(ot),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[ot]]=ot,ot>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(ot)]=ot,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(ot)]=ot)}}};class ke extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const be=function(ot){return function(ot){const at=vt(ot);return ye.encodeByteArray(at,!0)}(ot).replace(/\./g,"")},Pt=function(ot){try{return ye.decodeString(ot,!0)}catch(at){console.error("base64Decode failed: ",at)}return null};function Yt(ot,at){if(!(at instanceof Object))return at;switch(at.constructor){case Date:return new Date(at.getTime());case Object:void 0===ot&&(ot={});break;case Array:ot=[];break;default:return at}for(const ht in at)!at.hasOwnProperty(ht)||!Le(ht)||(ot[ht]=Yt(ot[ht],at[ht]));return ot}function Le(ot){return"__proto__"!==ot}const Te=()=>{try{return function re(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const ot=process.env.__FIREBASE_DEFAULTS__;return ot?JSON.parse(ot):void 0})()||(()=>{if(typeof document>"u")return;let ot;try{ot=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const at=ot&&Pt(ot[1]);return at&&JSON.parse(at)})()}catch(ot){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${ot}`)}},Fn=ot=>{var at,ht;return null===(ht=null===(at=Te())||void 0===at?void 0:at.emulatorHosts)||void 0===ht?void 0:ht[ot]},Ce=ot=>{const at=Fn(ot);if(!at)return;const ht=at.lastIndexOf(":");if(ht<=0||ht+1===at.length)throw new Error(`Invalid host ${at} with no separate hostname and port!`);const Bt=parseInt(at.substring(ht+1),10);return"["===at[0]?[at.substring(1,ht-1),Bt]:[at.substring(0,ht),Bt]},me=()=>{var ot;return null===(ot=Te())||void 0===ot?void 0:ot.config},tt=ot=>{var at;return null===(at=Te())||void 0===at?void 0:at[`_${ot}`]};class Xt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((at,ht)=>{this.resolve=at,this.reject=ht})}wrapCallback(at){return(ht,Bt)=>{ht?this.reject(ht):this.resolve(Bt),"function"==typeof at&&(this.promise.catch(()=>{}),1===at.length?at(ht):at(ht,Bt))}}}function Ve(ot,at){if(ot.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const Bt=at||"demo-project",kt=ot.iat||0,ee=ot.sub||ot.user_id;if(!ee)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const Ke=Object.assign({iss:`https://securetoken.google.com/${Bt}`,aud:Bt,iat:kt,exp:kt+3600,auth_time:kt,sub:ee,user_id:ee,firebase:{sign_in_provider:"custom",identities:{}}},ot);return[be(JSON.stringify({alg:"none",type:"JWT"})),be(JSON.stringify(Ke)),""].join(".")}function Gt(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ct(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Gt())}function ge(){var ot;const at=null===(ot=Te())||void 0===ot?void 0:ot.forceEnvironment;if("node"===at)return!0;if("browser"===at)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function en(){return"object"==typeof self&&self.self===self}function Vo(){const ot="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof ot&&void 0!==ot.id}function cs(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function us(){const ot=Gt();return ot.indexOf("MSIE ")>=0||ot.indexOf("Trident/")>=0}function Wt(){try{return"object"==typeof indexedDB}catch{return!1}}function Kt(){return new Promise((ot,at)=>{try{let ht=!0;const Bt="validate-browser-context-for-indexeddb-analytics-module",kt=self.indexedDB.open(Bt);kt.onsuccess=()=>{kt.result.close(),ht||self.indexedDB.deleteDatabase(Bt),ot(!0)},kt.onupgradeneeded=()=>{ht=!1},kt.onerror=()=>{var ee;at((null===(ee=kt.error)||void 0===ee?void 0:ee.message)||"")}}catch(ht){at(ht)}})}function pe(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}class he extends Error{constructor(at,ht,Bt){super(ht),this.code=at,this.customData=Bt,this.name="FirebaseError",Object.setPrototypeOf(this,he.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ue.prototype.create)}}class Ue{constructor(at,ht,Bt){this.service=at,this.serviceName=ht,this.errors=Bt}create(at,...ht){const Bt=ht[0]||{},kt=`${this.service}/${at}`,ee=this.errors[at],Ke=ee?function In(ot,at){return ot.replace(qr,(ht,Bt)=>{const kt=at[Bt];return null!=kt?String(kt):`<${Bt}?>`})}(ee,Bt):"Error";return new he(kt,`${this.serviceName}: ${Ke} (${kt}).`,Bt)}}const qr=/\{\$([^}]+)}/g;function nt(ot,at){return Object.prototype.hasOwnProperty.call(ot,at)}function Qt(ot){for(const at in ot)if(Object.prototype.hasOwnProperty.call(ot,at))return!1;return!0}function Pe(ot,at){if(ot===at)return!0;const ht=Object.keys(ot),Bt=Object.keys(at);for(const kt of ht){if(!Bt.includes(kt))return!1;const ee=ot[kt],Ke=at[kt];if(Ge(ee)&&Ge(Ke)){if(!Pe(ee,Ke))return!1}else if(ee!==Ke)return!1}for(const kt of Bt)if(!ht.includes(kt))return!1;return!0}function Ge(ot){return null!==ot&&"object"==typeof ot}function Xe(ot){const at=[];for(const[ht,Bt]of Object.entries(ot))Array.isArray(Bt)?Bt.forEach(kt=>{at.push(encodeURIComponent(ht)+"="+encodeURIComponent(kt))}):at.push(encodeURIComponent(ht)+"="+encodeURIComponent(Bt));return at.length?"&"+at.join("&"):""}function Ze(ot){const at={};return ot.replace(/^\?/,"").split("&").forEach(Bt=>{if(Bt){const[kt,ee]=Bt.split("=");at[decodeURIComponent(kt)]=decodeURIComponent(ee)}}),at}function Ie(ot){const at=ot.indexOf("?");if(!at)return"";const ht=ot.indexOf("#",at);return ot.substring(at,ht>0?ht:void 0)}function ur(ot,at){const ht=new yn(ot,at);return ht.subscribe.bind(ht)}class yn{constructor(at,ht){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=ht,this.task.then(()=>{at(this)}).catch(Bt=>{this.error(Bt)})}next(at){this.forEachObserver(ht=>{ht.next(at)})}error(at){this.forEachObserver(ht=>{ht.error(at)}),this.close(at)}complete(){this.forEachObserver(at=>{at.complete()}),this.close()}subscribe(at,ht,Bt){let kt;if(void 0===at&&void 0===ht&&void 0===Bt)throw new Error("Missing Observer.");kt=function Xr(ot,at){if("object"!=typeof ot||null===ot)return!1;for(const ht of at)if(ht in ot&&"function"==typeof ot[ht])return!0;return!1}(at,["next","error","complete"])?at:{next:at,error:ht,complete:Bt},void 0===kt.next&&(kt.next=Sn),void 0===kt.error&&(kt.error=Sn),void 0===kt.complete&&(kt.complete=Sn);const ee=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?kt.error(this.finalError):kt.complete()}catch{}}),this.observers.push(kt),ee}unsubscribeOne(at){void 0===this.observers||void 0===this.observers[at]||(delete this.observers[at],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(at){if(!this.finalized)for(let ht=0;ht<this.observers.length;ht++)this.sendOne(ht,at)}sendOne(at,ht){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[at])try{ht(this.observers[at])}catch(Bt){typeof console<"u"&&console.error&&console.error(Bt)}})}close(at){this.finalized||(this.finalized=!0,void 0!==at&&(this.finalError=at),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Sn(){}const ds=1e3,Ft=2,Ht=144e5,te=.5;function le(ot,at=ds,ht=Ft){const Bt=at*Math.pow(ht,ot),kt=Math.round(te*Bt*(Math.random()-.5)*2);return Math.min(Ht,Bt+kt)}function xe(ot){return ot&&ot._delegate?ot._delegate:ot}},2310:(Hn,we,ft)=>{"use strict";var x=ft(8926);let mt=null;function It(){return mt}class lt{}const ye=new x.OlP("DocumentToken");let ke=(()=>{class i{historyGo(o){throw new Error("Not implemented")}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:function(){return(0,x.f3M)(be)},providedIn:"platform"})}return i})();const ue=new x.OlP("Location Initialized");let be=(()=>{class i extends ke{constructor(){super(),this._doc=(0,x.f3M)(ye),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return It().getBaseHref(this._doc)}onPopState(o){const a=It().getGlobalEventTarget(this._doc,"window");return a.addEventListener("popstate",o,!1),()=>a.removeEventListener("popstate",o)}onHashChange(o){const a=It().getGlobalEventTarget(this._doc,"window");return a.addEventListener("hashchange",o,!1),()=>a.removeEventListener("hashchange",o)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(o){this._location.pathname=o}pushState(o,a,h){this._history.pushState(o,a,h)}replaceState(o,a,h){this._history.replaceState(o,a,h)}forward(){this._history.forward()}back(){this._history.back()}historyGo(o=0){this._history.go(o)}getState(){return this._history.state}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:function(){return new i},providedIn:"platform"})}return i})();function Pt(i,n){if(0==i.length)return n;if(0==n.length)return i;let o=0;return i.endsWith("/")&&o++,n.startsWith("/")&&o++,2==o?i+n.substring(1):1==o?i+n:i+"/"+n}function Ot(i){const n=i.match(/#|\?|$/),o=n&&n.index||i.length;return i.slice(0,o-("/"===i[o-1]?1:0))+i.slice(o)}function Yt(i){return i&&"?"!==i[0]?"?"+i:i}let Le=(()=>{class i{historyGo(o){throw new Error("Not implemented")}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:function(){return(0,x.f3M)(tn)},providedIn:"root"})}return i})();const re=new x.OlP("appBaseHref");let tn=(()=>{class i extends Le{constructor(o,a){super(),this._platformLocation=o,this._removeListenerFns=[],this._baseHref=a??this._platformLocation.getBaseHrefFromDOM()??(0,x.f3M)(ye).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(o){this._removeListenerFns.push(this._platformLocation.onPopState(o),this._platformLocation.onHashChange(o))}getBaseHref(){return this._baseHref}prepareExternalUrl(o){return Pt(this._baseHref,o)}path(o=!1){const a=this._platformLocation.pathname+Yt(this._platformLocation.search),h=this._platformLocation.hash;return h&&o?`${a}${h}`:a}pushState(o,a,h,_){const w=this.prepareExternalUrl(h+Yt(_));this._platformLocation.pushState(o,a,w)}replaceState(o,a,h,_){const w=this.prepareExternalUrl(h+Yt(_));this._platformLocation.replaceState(o,a,w)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(o=0){this._platformLocation.historyGo?.(o)}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(ke),x.LFG(re,8))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),We=(()=>{class i extends Le{constructor(o,a){super(),this._platformLocation=o,this._baseHref="",this._removeListenerFns=[],null!=a&&(this._baseHref=a)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(o){this._removeListenerFns.push(this._platformLocation.onPopState(o),this._platformLocation.onHashChange(o))}getBaseHref(){return this._baseHref}path(o=!1){let a=this._platformLocation.hash;return null==a&&(a="#"),a.length>0?a.substring(1):a}prepareExternalUrl(o){const a=Pt(this._baseHref,o);return a.length>0?"#"+a:a}pushState(o,a,h,_){let w=this.prepareExternalUrl(h+Yt(_));0==w.length&&(w=this._platformLocation.pathname),this._platformLocation.pushState(o,a,w)}replaceState(o,a,h,_){let w=this.prepareExternalUrl(h+Yt(_));0==w.length&&(w=this._platformLocation.pathname),this._platformLocation.replaceState(o,a,w)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(o=0){this._platformLocation.historyGo?.(o)}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(ke),x.LFG(re,8))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})(),rn=(()=>{class i{constructor(o){this._subject=new x.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=o;const a=this._locationStrategy.getBaseHref();this._basePath=function me(i){if(new RegExp("^(https?:)?//").test(i)){const[,o]=i.split(/\/\/[^\/]+/);return o}return i}(Ot(Ce(a))),this._locationStrategy.onPopState(h=>{this._subject.emit({url:this.path(!0),pop:!0,state:h.state,type:h.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(o=!1){return this.normalize(this._locationStrategy.path(o))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(o,a=""){return this.path()==this.normalize(o+Yt(a))}normalize(o){return i.stripTrailingSlash(function Fn(i,n){if(!i||!n.startsWith(i))return n;const o=n.substring(i.length);return""===o||["/",";","?","#"].includes(o[0])?o:n}(this._basePath,Ce(o)))}prepareExternalUrl(o){return o&&"/"!==o[0]&&(o="/"+o),this._locationStrategy.prepareExternalUrl(o)}go(o,a="",h=null){this._locationStrategy.pushState(h,"",o,a),this._notifyUrlChangeListeners(this.prepareExternalUrl(o+Yt(a)),h)}replaceState(o,a="",h=null){this._locationStrategy.replaceState(h,"",o,a),this._notifyUrlChangeListeners(this.prepareExternalUrl(o+Yt(a)),h)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(o=0){this._locationStrategy.historyGo?.(o)}onUrlChange(o){return this._urlChangeListeners.push(o),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(a=>{this._notifyUrlChangeListeners(a.url,a.state)})),()=>{const a=this._urlChangeListeners.indexOf(o);this._urlChangeListeners.splice(a,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(o="",a){this._urlChangeListeners.forEach(h=>h(o,a))}subscribe(o,a,h){return this._subject.subscribe({next:o,error:a,complete:h})}static#t=this.normalizeQueryParams=Yt;static#e=this.joinWithSlash=Pt;static#n=this.stripTrailingSlash=Ot;static#r=this.\u0275fac=function(a){return new(a||i)(x.LFG(Le))};static#o=this.\u0275prov=x.Yz7({token:i,factory:function(){return function Te(){return new rn((0,x.LFG)(Le))}()},providedIn:"root"})}return i})();function Ce(i){return i.replace(/\/index.html$/,"")}function gl(i,n){n=encodeURIComponent(n);for(const o of i.split(";")){const a=o.indexOf("="),[h,_]=-1==a?[o,""]:[o.slice(0,a),o.slice(a+1)];if(h.trim()===n)return decodeURIComponent(_)}return null}const ml=/\s+/,mh=[];let su=(()=>{class i{constructor(o,a,h,_){this._iterableDiffers=o,this._keyValueDiffers=a,this._ngEl=h,this._renderer=_,this.initialClasses=mh,this.stateMap=new Map}set klass(o){this.initialClasses=null!=o?o.trim().split(ml):mh}set ngClass(o){this.rawClass="string"==typeof o?o.trim().split(ml):o}ngDoCheck(){for(const a of this.initialClasses)this._updateState(a,!0);const o=this.rawClass;if(Array.isArray(o)||o instanceof Set)for(const a of o)this._updateState(a,!0);else if(null!=o)for(const a of Object.keys(o))this._updateState(a,!!o[a]);this._applyStateDiff()}_updateState(o,a){const h=this.stateMap.get(o);void 0!==h?(h.enabled!==a&&(h.changed=!0,h.enabled=a),h.touched=!0):this.stateMap.set(o,{enabled:a,changed:!0,touched:!0})}_applyStateDiff(){for(const o of this.stateMap){const a=o[0],h=o[1];h.changed?(this._toggleClass(a,h.enabled),h.changed=!1):h.touched||(h.enabled&&this._toggleClass(a,!1),this.stateMap.delete(a)),h.touched=!1}}_toggleClass(o,a){(o=o.trim()).length>0&&o.split(ml).forEach(h=>{a?this._renderer.addClass(this._ngEl.nativeElement,h):this._renderer.removeClass(this._ngEl.nativeElement,h)})}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(x.ZZ4),x.Y36(x.aQg),x.Y36(x.SBq),x.Y36(x.Qsj))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0})}return i})();class lg{constructor(n,o,a,h){this.$implicit=n,this.ngForOf=o,this.index=a,this.count=h}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Va=(()=>{class i{set ngForOf(o){this._ngForOf=o,this._ngForOfDirty=!0}set ngForTrackBy(o){this._trackByFn=o}get ngForTrackBy(){return this._trackByFn}constructor(o,a,h){this._viewContainer=o,this._template=a,this._differs=h,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(o){o&&(this._template=o)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const o=this._ngForOf;!this._differ&&o&&(this._differ=this._differs.find(o).create(this.ngForTrackBy))}if(this._differ){const o=this._differ.diff(this._ngForOf);o&&this._applyChanges(o)}}_applyChanges(o){const a=this._viewContainer;o.forEachOperation((h,_,w)=>{if(null==h.previousIndex)a.createEmbeddedView(this._template,new lg(h.item,this._ngForOf,-1,-1),null===w?void 0:w);else if(null==w)a.remove(null===_?void 0:_);else if(null!==_){const S=a.get(_);a.move(S,w),Zo(S,h)}});for(let h=0,_=a.length;h<_;h++){const S=a.get(h).context;S.index=h,S.count=_,S.ngForOf=this._ngForOf}o.forEachIdentityChange(h=>{Zo(a.get(h.currentIndex),h)})}static ngTemplateContextGuard(o,a){return!0}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(x.s_b),x.Y36(x.Rgc),x.Y36(x.ZZ4))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return i})();function Zo(i,n){i.context.$implicit=n.item}let ba=(()=>{class i{constructor(o,a){this._viewContainer=o,this._context=new ud,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=a}set ngIf(o){this._context.$implicit=this._context.ngIf=o,this._updateView()}set ngIfThen(o){dd("ngIfThen",o),this._thenTemplateRef=o,this._thenViewRef=null,this._updateView()}set ngIfElse(o){dd("ngIfElse",o),this._elseTemplateRef=o,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(o,a){return!0}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(x.s_b),x.Y36(x.Rgc))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return i})();class ud{constructor(){this.$implicit=null,this.ngIf=null}}function dd(i,n){if(n&&!n.createEmbeddedView)throw new Error(`${i} must be a TemplateRef, but received '${(0,x.AaK)(n)}'.`)}let lu=(()=>{class i{constructor(o,a,h){this._ngEl=o,this._differs=a,this._renderer=h,this._ngStyle=null,this._differ=null}set ngStyle(o){this._ngStyle=o,!this._differ&&o&&(this._differ=this._differs.find(o).create())}ngDoCheck(){if(this._differ){const o=this._differ.diff(this._ngStyle);o&&this._applyChanges(o)}}_setStyle(o,a){const[h,_]=o.split("."),w=-1===h.indexOf("-")?void 0:x.JOm.DashCase;null!=a?this._renderer.setStyle(this._ngEl.nativeElement,h,_?`${a}${_}`:a,w):this._renderer.removeStyle(this._ngEl.nativeElement,h,w)}_applyChanges(o){o.forEachRemovedItem(a=>this._setStyle(a.key,null)),o.forEachAddedItem(a=>this._setStyle(a.key,a.currentValue)),o.forEachChangedItem(a=>this._setStyle(a.key,a.currentValue))}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(x.SBq),x.Y36(x.aQg),x.Y36(x.Qsj))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return i})(),Do=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=x.oAB({type:i});static#n=this.\u0275inj=x.cJS({})}return i})();function Xi(i){return"server"===i}let Cc=(()=>{class i{static#t=this.\u0275prov=(0,x.Yz7)({token:i,providedIn:"root",factory:()=>new xa((0,x.LFG)(ye),window)})}return i})();class xa{constructor(n,o){this.document=n,this.window=o,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const o=function Wo(i,n){const o=i.getElementById(n)||i.getElementsByName(n)[0];if(o)return o;if("function"==typeof i.createTreeWalker&&i.body&&"function"==typeof i.body.attachShadow){const a=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let h=a.currentNode;for(;h;){const _=h.shadowRoot;if(_){const w=_.getElementById(n)||_.querySelector(`[name="${n}"]`);if(w)return w}h=a.nextNode()}}return null}(this.document,n);o&&(this.scrollToElement(o),o.focus())}setHistoryScrollRestoration(n){this.supportsScrolling()&&(this.window.history.scrollRestoration=n)}scrollToElement(n){const o=n.getBoundingClientRect(),a=o.left+this.window.pageXOffset,h=o.top+this.window.pageYOffset,_=this.offset();this.window.scrollTo(a-_[0],h-_[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class Ga{}class pg extends lt{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Kf extends pg{static makeCurrent(){!function vt(i){mt||(mt=i)}(new Kf)}onAndCancel(n,o,a){return n.addEventListener(o,a),()=>{n.removeEventListener(o,a)}}dispatchEvent(n,o){n.dispatchEvent(o)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,o){return(o=o||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,o){return"window"===o?window:"document"===o?n:"body"===o?n.body:null}getBaseHref(n){const o=function gg(){return vd=vd||document.querySelector("base"),vd?vd.getAttribute("href"):null}();return null==o?null:function xd(i){bd=bd||document.createElement("a"),bd.setAttribute("href",i);const n=bd.pathname;return"/"===n.charAt(0)?n:`/${n}`}(o)}resetBaseElement(){vd=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return gl(document.cookie,n)}}let bd,vd=null,Th=(()=>{class i{build(){return new XMLHttpRequest}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();const Oc=new x.OlP("EventManagerPlugins");let mg=(()=>{class i{constructor(o,a){this._zone=a,this._eventNameToPlugin=new Map,o.forEach(h=>{h.manager=this}),this._plugins=o.slice().reverse()}addEventListener(o,a,h){return this._findPluginFor(a).addEventListener(o,a,h)}getZone(){return this._zone}_findPluginFor(o){let a=this._eventNameToPlugin.get(o);if(a)return a;if(a=this._plugins.find(_=>_.supports(o)),!a)throw new x.vHH(5101,!1);return this._eventNameToPlugin.set(o,a),a}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(Oc),x.LFG(x.R0b))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();class mu{constructor(n){this._doc=n}}const _u="ng-app-id";let Ih=(()=>{class i{constructor(o,a,h,_={}){this.doc=o,this.appId=a,this.nonce=h,this.platformId=_,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Xi(_),this.resetHostNodes()}addStyles(o){for(const a of o)1===this.changeUsageCount(a,1)&&this.onStyleAdded(a)}removeStyles(o){for(const a of o)this.changeUsageCount(a,-1)<=0&&this.onStyleRemoved(a)}ngOnDestroy(){const o=this.styleNodesInDOM;o&&(o.forEach(a=>a.remove()),o.clear());for(const a of this.getAllStyles())this.onStyleRemoved(a);this.resetHostNodes()}addHost(o){this.hostNodes.add(o);for(const a of this.getAllStyles())this.addStyleToHost(o,a)}removeHost(o){this.hostNodes.delete(o)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(o){for(const a of this.hostNodes)this.addStyleToHost(a,o)}onStyleRemoved(o){const a=this.styleRef;a.get(o)?.elements?.forEach(h=>h.remove()),a.delete(o)}collectServerRenderedStyles(){const o=this.doc.head?.querySelectorAll(`style[${_u}="${this.appId}"]`);if(o?.length){const a=new Map;return o.forEach(h=>{null!=h.textContent&&a.set(h.textContent,h)}),a}return null}changeUsageCount(o,a){const h=this.styleRef;if(h.has(o)){const _=h.get(o);return _.usage+=a,_.usage}return h.set(o,{usage:a,elements:[]}),a}getStyleElement(o,a){const h=this.styleNodesInDOM,_=h?.get(a);if(_?.parentNode===o)return h.delete(a),_.removeAttribute(_u),_;{const w=this.doc.createElement("style");return this.nonce&&w.setAttribute("nonce",this.nonce),w.textContent=a,this.platformIsServer&&w.setAttribute(_u,this.appId),w}}addStyleToHost(o,a){const h=this.getStyleElement(o,a);o.appendChild(h);const _=this.styleRef,w=_.get(a)?.elements;w?w.push(h):_.set(a,{elements:[h],usage:1})}resetHostNodes(){const o=this.hostNodes;o.clear(),o.add(this.doc.head)}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(ye),x.LFG(x.AFp),x.LFG(x.Ojb,8),x.LFG(x.Lbi))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();const Ca={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},wd=/%COMP%/g,vn=new x.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function ql(i,n){return n.map(o=>o.replace(wd,i))}let Ah=(()=>{class i{constructor(o,a,h,_,w,S,L,B=null){this.eventManager=o,this.sharedStylesHost=a,this.appId=h,this.removeStylesOnCompDestroy=_,this.doc=w,this.platformId=S,this.ngZone=L,this.nonce=B,this.rendererByCompId=new Map,this.platformIsServer=Xi(S),this.defaultRenderer=new hs(o,w,L,this.platformIsServer)}createRenderer(o,a){if(!o||!a)return this.defaultRenderer;this.platformIsServer&&a.encapsulation===x.ifc.ShadowDom&&(a={...a,encapsulation:x.ifc.Emulated});const h=this.getOrCreateRenderer(o,a);return h instanceof Ji?h.applyToHost(o):h instanceof yu&&h.applyStyles(),h}getOrCreateRenderer(o,a){const h=this.rendererByCompId;let _=h.get(a.id);if(!_){const w=this.doc,S=this.ngZone,L=this.eventManager,B=this.sharedStylesHost,H=this.removeStylesOnCompDestroy,Y=this.platformIsServer;switch(a.encapsulation){case x.ifc.Emulated:_=new Ji(L,B,a,this.appId,H,w,S,Y);break;case x.ifc.ShadowDom:return new Xf(L,B,o,a,w,S,this.nonce,Y);default:_=new yu(L,B,a,H,w,S,Y)}h.set(a.id,_)}return _}ngOnDestroy(){this.rendererByCompId.clear()}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(mg),x.LFG(Ih),x.LFG(x.AFp),x.LFG(vn),x.LFG(ye),x.LFG(x.Lbi),x.LFG(x.R0b),x.LFG(x.Ojb))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();class hs{constructor(n,o,a,h){this.eventManager=n,this.doc=o,this.ngZone=a,this.platformIsServer=h,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,o){return o?this.doc.createElementNS(Ca[o]||o,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,o){(Bo(n)?n.content:n).appendChild(o)}insertBefore(n,o,a){n&&(Bo(n)?n.content:n).insertBefore(o,a)}removeChild(n,o){n&&n.removeChild(o)}selectRootElement(n,o){let a="string"==typeof n?this.doc.querySelector(n):n;if(!a)throw new x.vHH(-5104,!1);return o||(a.textContent=""),a}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,o,a,h){if(h){o=h+":"+o;const _=Ca[h];_?n.setAttributeNS(_,o,a):n.setAttribute(o,a)}else n.setAttribute(o,a)}removeAttribute(n,o,a){if(a){const h=Ca[a];h?n.removeAttributeNS(h,o):n.removeAttribute(`${a}:${o}`)}else n.removeAttribute(o)}addClass(n,o){n.classList.add(o)}removeClass(n,o){n.classList.remove(o)}setStyle(n,o,a,h){h&(x.JOm.DashCase|x.JOm.Important)?n.style.setProperty(o,a,h&x.JOm.Important?"important":""):n.style[o]=a}removeStyle(n,o,a){a&x.JOm.DashCase?n.style.removeProperty(o):n.style[o]=""}setProperty(n,o,a){n[o]=a}setValue(n,o){n.nodeValue=o}listen(n,o,a){if("string"==typeof n&&!(n=It().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${o}`);return this.eventManager.addEventListener(n,o,this.decoratePreventDefault(a))}decoratePreventDefault(n){return o=>{if("__ngUnwrap__"===o)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(o)):n(o))&&o.preventDefault()}}}function Bo(i){return"TEMPLATE"===i.tagName&&void 0!==i.content}class Xf extends hs{constructor(n,o,a,h,_,w,S,L){super(n,_,w,L),this.sharedStylesHost=o,this.hostEl=a,this.shadowRoot=a.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const B=ql(h.id,h.styles);for(const H of B){const Y=document.createElement("style");S&&Y.setAttribute("nonce",S),Y.textContent=H,this.shadowRoot.appendChild(Y)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,o){return super.appendChild(this.nodeOrShadowRoot(n),o)}insertBefore(n,o,a){return super.insertBefore(this.nodeOrShadowRoot(n),o,a)}removeChild(n,o){return super.removeChild(this.nodeOrShadowRoot(n),o)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class yu extends hs{constructor(n,o,a,h,_,w,S,L){super(n,_,w,S),this.sharedStylesHost=o,this.removeStylesOnCompDestroy=h,this.styles=L?ql(L,a.styles):a.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class Ji extends yu{constructor(n,o,a,h,_,w,S,L){const B=h+"-"+a.id;super(n,o,a,_,w,S,L,B),this.contentAttr=function _g(i){return"_ngcontent-%COMP%".replace(wd,i)}(B),this.hostAttr=function Md(i){return"_nghost-%COMP%".replace(wd,i)}(B)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,o){const a=super.createElement(n,o);return super.setAttribute(a,this.contentAttr,""),a}}let Qf=(()=>{class i extends mu{constructor(o){super(o)}supports(o){return!0}addEventListener(o,a,h){return o.addEventListener(a,h,!1),()=>this.removeEventListener(o,a,h)}removeEventListener(o,a,h){return o.removeEventListener(a,h)}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(ye))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();const vu=["alt","control","meta","shift"],bu={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ua={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let Ic=(()=>{class i extends mu{constructor(o){super(o)}supports(o){return null!=i.parseEventName(o)}addEventListener(o,a,h){const _=i.parseEventName(a),w=i.eventCallback(_.fullKey,h,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>It().onAndCancel(o,_.domEventName,w))}static parseEventName(o){const a=o.toLowerCase().split("."),h=a.shift();if(0===a.length||"keydown"!==h&&"keyup"!==h)return null;const _=i._normalizeKey(a.pop());let w="",S=a.indexOf("code");if(S>-1&&(a.splice(S,1),w="code."),vu.forEach(B=>{const H=a.indexOf(B);H>-1&&(a.splice(H,1),w+=B+".")}),w+=_,0!=a.length||0===_.length)return null;const L={};return L.domEventName=h,L.fullKey=w,L}static matchEventFullKeyCode(o,a){let h=bu[o.key]||o.key,_="";return a.indexOf("code.")>-1&&(h=o.code,_="code."),!(null==h||!h)&&(h=h.toLowerCase()," "===h?h="space":"."===h&&(h="dot"),vu.forEach(w=>{w!==h&&(0,ua[w])(o)&&(_+=w+".")}),_+=h,_===a)}static eventCallback(o,a,h){return _=>{i.matchEventFullKeyCode(_,o)&&h.runGuarded(()=>a(_))}}static _normalizeKey(o){return"esc"===o?"escape":o}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(ye))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();const Ni=(0,x.eFA)(x._c5,"browser",[{provide:x.Lbi,useValue:"browser"},{provide:x.g9A,useValue:function tp(){Kf.makeCurrent()},multi:!0},{provide:ye,useFactory:function Ka(){return(0,x.RDi)(document),document},deps:[]}]),lr=new x.OlP(""),xi=[{provide:x.rWj,useClass:class Yf{addToWindow(n){x.dqk.getAngularTestability=(a,h=!0)=>{const _=n.findTestabilityInTree(a,h);if(null==_)throw new x.vHH(5103,!1);return _},x.dqk.getAllAngularTestabilities=()=>n.getAllTestabilities(),x.dqk.getAllAngularRootElements=()=>n.getAllRootElements(),x.dqk.frameworkStabilizers||(x.dqk.frameworkStabilizers=[]),x.dqk.frameworkStabilizers.push(a=>{const h=x.dqk.getAllAngularTestabilities();let _=h.length,w=!1;const S=function(L){w=w||L,_--,0==_&&a(w)};h.forEach(L=>{L.whenStable(S)})})}findTestabilityInTree(n,o,a){return null==o?null:n.getTestability(o)??(a?It().isShadowRoot(o)?this.findTestabilityInTree(n,o.host,!0):this.findTestabilityInTree(n,o.parentElement,!0):null)}},deps:[]},{provide:x.lri,useClass:x.dDg,deps:[x.R0b,x.eoX,x.rWj]},{provide:x.dDg,useClass:x.dDg,deps:[x.R0b,x.eoX,x.rWj]}],ep=[{provide:x.zSh,useValue:"root"},{provide:x.qLn,useFactory:function Pd(){return new x.qLn},deps:[]},{provide:Oc,useClass:Qf,multi:!0,deps:[ye,x.R0b,x.Lbi]},{provide:Oc,useClass:Ic,multi:!0,deps:[ye]},Ah,Ih,mg,{provide:x.FYo,useExisting:Ah},{provide:Ga,useClass:Th,deps:[]},[]];let wu=(()=>{class i{constructor(o){}static withServerTransition(o){return{ngModule:i,providers:[{provide:x.AFp,useValue:o.appId}]}}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(lr,12))};static#e=this.\u0275mod=x.oAB({type:i});static#n=this.\u0275inj=x.cJS({providers:[...ep,...xi],imports:[Do,x.hGG]})}return i})(),Sc=(()=>{class i{constructor(o){this._doc=o}getTitle(){return this._doc.title}setTitle(o){this._doc.title=o||""}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(ye))};static#e=this.\u0275prov=x.Yz7({token:i,factory:function(a){let h=null;return h=a?new a:function Cu(){return new Sc((0,x.LFG)(ye))}(),h},providedIn:"root"})}return i})();typeof window<"u"&&window;var Pa=ft(6304),Wr=ft(9015),da=ft(4097);class Ns{constructor(n){return n}}class Mu{constructor(){return(0,da.C6)()}}const xl=new x.OlP("angularfire2._apps"),n_={provide:Ns,useFactory:function Rc(i){return i&&1===i.length?i[0]:new Ns((0,da.Mq)())},deps:[[new x.FiY,xl]]},Pu={provide:Mu,deps:[[new x.FiY,xl]]};function Ou(i){return(n,o)=>{const a=n.runOutsideAngular(()=>i(o));return new Ns(a)}}let Zl=(()=>{class i{constructor(o){(0,da.KN)("angularfire",Wr.q4.full,"core"),(0,da.KN)("angularfire",Wr.q4.full,"app"),(0,da.KN)("angular",x.q4F.full,o.toString())}}return i.\u0275fac=function(o){return new(o||i)(x.LFG(x.Lbi))},i.\u0275mod=x.oAB({type:i}),i.\u0275inj=x.cJS({providers:[n_,Pu]}),i})();function xg(i,...n){return{ngModule:Zl,providers:[{provide:xl,useFactory:Ou(i),multi:!0,deps:[x.R0b,x.zs3,Wr.HU,...n]}]}}const wl=(0,Wr.u3)(da.ZF,!0);var Je=ft(5861),ts=ft(1571),Oa=ft(6820),$r=ft(229),Kl=ft(7879);const Yl=new Map,Sd={activated:!1,tokenObservers:[]},Ts={initialized:!1,enabled:!1};function ii(i){return Yl.get(i)||Object.assign({},Sd)}function Xa(){return Ts}const Tu="https://content-firebaseappcheck.googleapis.com/v1",Ad="exchangeDebugToken",r_={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class o_{constructor(n,o,a,h,_){if(this.operation=n,this.retryPolicy=o,this.getWaitDuration=a,this.lowerBound=h,this.upperBound=_,this.pending=null,this.nextErrorWaitInterval=h,h>_)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(n){var o=this;return(0,Je.Z)(function*(){o.stop();try{o.pending=new $r.BH,yield function Nh(i){return new Promise(n=>{setTimeout(n,i)})}(o.getNextRun(n)),o.pending.resolve(),yield o.pending.promise,o.pending=new $r.BH,yield o.operation(),o.pending.resolve(),yield o.pending.promise,o.process(!0).catch(()=>{})}catch(a){o.retryPolicy(a)?o.process(!1).catch(()=>{}):o.stop()}})()}getNextRun(n){if(n)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const o=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),o}}}const ps=new $r.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function ha(i){if(!ii(i).activated)throw ps.create("use-before-activation",{appName:i.name})}function Qa(i,n){return kd.apply(this,arguments)}function kd(){return(kd=(0,Je.Z)(function*({url:i,body:n},o){const a={"Content-Type":"application/json"},h=o.getImmediate({optional:!0});if(h){const Y=yield h.getHeartbeatsHeader();Y&&(a["X-Firebase-Client"]=Y)}const _={method:"POST",body:JSON.stringify(n),headers:a};let w,S;try{w=yield fetch(i,_)}catch(Y){throw ps.create("fetch-network-error",{originalErrorMessage:Y?.message})}if(200!==w.status)throw ps.create("fetch-status-error",{httpStatus:w.status});try{S=yield w.json()}catch(Y){throw ps.create("fetch-parse-error",{originalErrorMessage:Y?.message})}const L=S.ttl.match(/^([\d.]+)(s)$/);if(!L||!L[2]||isNaN(Number(L[1])))throw ps.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${S.ttl}`});const B=1e3*Number(L[1]),H=Date.now();return{token:S.token,expireTimeMillis:H+B,issuedAtTimeMillis:H}})).apply(this,arguments)}function Cl(i,n){const{projectId:o,appId:a,apiKey:h}=i.options;return{url:`${Tu}/projects/${o}/apps/${a}:${Ad}?key=${h}`,body:{debug_token:n}}}const up="firebase-app-check-database",Cg=1,Ys="firebase-app-check-store";let Ml=null;function Su(){return(Su=(0,Je.Z)(function*(i,n){const a=(yield function Rd(){return Ml||(Ml=new Promise((i,n)=>{try{const o=indexedDB.open(up,Cg);o.onsuccess=a=>{i(a.target.result)},o.onerror=a=>{var h;n(ps.create("storage-open",{originalErrorMessage:null===(h=a.target.error)||void 0===h?void 0:h.message}))},o.onupgradeneeded=a=>{0===a.oldVersion&&a.target.result.createObjectStore(Ys,{keyPath:"compositeKey"})}}catch(o){n(ps.create("storage-open",{originalErrorMessage:o?.message}))}}),Ml)}()).transaction(Ys,"readwrite"),_=a.objectStore(Ys).put({compositeKey:i,value:n});return new Promise((w,S)=>{_.onsuccess=L=>{w()},a.onerror=L=>{var B;S(ps.create("storage-set",{originalErrorMessage:null===(B=L.target.error)||void 0===B?void 0:B.message}))}})})).apply(this,arguments)}const tl=new Kl.Yd("@firebase/app-check");function Pg(i,n){return(0,$r.hl)()?function Iu(i,n){return function zh(i,n){return Su.apply(this,arguments)}(function hp(i){return`${i.options.appId}-${i.name}`}(i),n)}(i,n).catch(o=>{tl.warn(`Failed to write token to IndexedDB. Error: ${o}`)}):Promise.resolve()}function Nc(){return Xa().enabled}function es(){return fa.apply(this,arguments)}function fa(){return(fa=(0,Je.Z)(function*(){const i=Xa();if(i.enabled&&i.token)return i.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const Ql={error:"UNKNOWN_ERROR"};function Pl(i){return $r.US.encodeString(JSON.stringify(i),!1)}function Fi(i){return Jl.apply(this,arguments)}function Jl(){return(Jl=(0,Je.Z)(function*(i,n=!1){const o=i.app;ha(o);const a=ii(o);let _,h=a.token;if(h&&!W(h)&&(a.token=void 0,h=void 0),!h){const L=yield a.cachedTokenPromise;L&&(W(L)?h=L:yield Pg(o,void 0))}if(!n&&h&&W(h))return{token:h.token};let S,w=!1;if(Nc()){a.exchangeTokenPromise||(a.exchangeTokenPromise=Qa(Cl(o,yield es()),i.heartbeatServiceProvider).finally(()=>{a.exchangeTokenPromise=void 0}),w=!0);const L=yield a.exchangeTokenPromise;return yield Pg(o,L),a.token=L,{token:L.token}}try{a.exchangeTokenPromise||(a.exchangeTokenPromise=a.provider.getToken().finally(()=>{a.exchangeTokenPromise=void 0}),w=!0),h=yield ii(o).exchangeTokenPromise}catch(L){"appCheck/throttled"===L.code?tl.warn(L.message):tl.error(L),_=L}return h?_?S=W(h)?{token:h.token,internalError:_}:ut(_):(S={token:h.token},a.token=h,yield Pg(o,h)):S=ut(_),w&&function V(i,n){const o=ii(i).tokenObservers;for(const a of o)try{"EXTERNAL"===a.type&&null!=n.error?a.error(n.error):a.next(n)}catch{}}(o,S),S})).apply(this,arguments)}function tc(i){return De.apply(this,arguments)}function De(){return(De=(0,Je.Z)(function*(i){const n=i.app;ha(n);const{provider:o}=ii(n);if(Nc()){const a=yield es(),{token:h}=yield Qa(Cl(n,a),i.heartbeatServiceProvider);return{token:h}}{const{token:a}=yield o.getToken();return{token:a}}})).apply(this,arguments)}function zd(i,n){const o=ii(i),a=o.tokenObservers.filter(h=>h.next!==n);0===a.length&&o.tokenRefresher&&o.tokenRefresher.isRunning()&&o.tokenRefresher.stop(),o.tokenObservers=a}function nc(i){const{app:n}=i,o=ii(n);let a=o.tokenRefresher;a||(a=function U(i){const{app:n}=i;return new o_((0,Je.Z)(function*(){let a;if(a=ii(n).token?yield Fi(i,!0):yield Fi(i),a.error)throw a.error;if(a.internalError)throw a.internalError}),()=>!0,()=>{const o=ii(n);if(o.token){let a=o.token.issuedAtTimeMillis+.5*(o.token.expireTimeMillis-o.token.issuedAtTimeMillis)+3e5;return a=Math.min(a,o.token.expireTimeMillis-3e5),Math.max(0,a-Date.now())}return 0},r_.RETRIAL_MIN_WAIT,r_.RETRIAL_MAX_WAIT)}(i),o.tokenRefresher=a),!a.isRunning()&&o.isTokenAutoRefreshEnabled&&a.start()}function W(i){return i.expireTimeMillis-Date.now()>0}function ut(i){return{token:Pl(Ql),error:i}}class Mt{constructor(n,o){this.app=n,this.heartbeatServiceProvider=o}_delete(){const{tokenObservers:n}=ii(this.app);for(const o of n)zd(this.app,o.next);return Promise.resolve()}}const St="app-check-internal";!function jt(){(0,ts._registerComponent)(new Oa.wA("app-check",i=>function Lt(i,n){return new Mt(i,n)}(i.getProvider("app").getImmediate(),i.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((i,n,o)=>{i.getProvider(St).initialize()})),(0,ts._registerComponent)(new Oa.wA(St,i=>function se(i){return{getToken:n=>Fi(i,n),getLimitedUseToken:()=>tc(i),addTokenListener:n=>function ec(i,n,o,a){const{app:h}=i,_=ii(h);if(_.tokenObservers=[..._.tokenObservers,{next:o,error:a,type:n}],_.token&&W(_.token)){const S=_.token;Promise.resolve().then(()=>{o({token:S.token}),nc(i)}).catch(()=>{})}_.cachedTokenPromise.then(()=>nc(i))}(i,"INTERNAL",n),removeTokenListener:n=>zd(i.app,n)}}(i.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,ts.registerVersion)("@firebase/app-check","0.8.0")}();class sn{constructor(){return(0,Wr.vb)("app-check")}}typeof window<"u"&&window;var rc=ft(6710);class Xy{constructor(n){return n}}class gb{constructor(){return(0,Wr.vb)("auth")}}const Qy=new x.OlP("angularfire2.auth-instances");function mb(i){return(n,o)=>{const a=n.runOutsideAngular(()=>i(o));return new Xy(a)}}const _b={provide:gb,deps:[[new x.FiY,Qy]]},yb={provide:Xy,useFactory:function Ru(i,n){const o=(0,Wr.JM)("auth",i,n);return o&&new Xy(o)},deps:[[new x.FiY,Qy],Ns]};let nP=(()=>{class i{constructor(){(0,da.KN)("angularfire",Wr.q4.full,"auth")}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=x.oAB({type:i}),i.\u0275inj=x.cJS({providers:[yb,_b]}),i})();function Mi(i,...n){return{ngModule:nP,providers:[{provide:Qy,useFactory:mb(i),multi:!0,deps:[x.R0b,x.zs3,Wr.HU,Mu,[new x.FiY,sn],...n]}]}}const iP=(0,Wr.u3)(rc.o,!0);var an,Hh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Sa={},Ol=Ol||{},pr=Hh||self;function Lu(i){var n=typeof i;return"array"==(n="object"!=n?n:i?Array.isArray(i)?"array":n:"null")||"object"==n&&"number"==typeof i.length}function ga(i){var n=typeof i;return"object"==n&&null!=i||"function"==n}var Ob="closure_uid_"+(1e9*Math.random()>>>0),xw=0;function Eb(i,n,o){return i.call.apply(i.bind,arguments)}function _P(i,n,o){if(!i)throw Error();if(2<arguments.length){var a=Array.prototype.slice.call(arguments,2);return function(){var h=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(h,a),i.apply(n,h)}}return function(){return i.apply(n,arguments)}}function Qo(i,n,o){return(Qo=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Eb:_P).apply(null,arguments)}function zi(i,n){var o=Array.prototype.slice.call(arguments,1);return function(){var a=o.slice();return a.push.apply(a,arguments),i.apply(this,a)}}function co(i,n){function o(){}o.prototype=n.prototype,i.$=n.prototype,i.prototype=new o,i.prototype.constructor=i,i.ac=function(a,h,_){for(var w=Array(arguments.length-2),S=2;S<arguments.length;S++)w[S-2]=arguments[S];return n.prototype[h].apply(a,w)}}function qh(){this.s=this.s,this.o=this.o}qh.prototype.s=!1,qh.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function Pb(i){Object.prototype.hasOwnProperty.call(i,Ob)&&i[Ob]||(i[Ob]=++xw)}(this)},qh.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const ww=Array.prototype.indexOf?function(i,n){return Array.prototype.indexOf.call(i,n,void 0)}:function(i,n){if("string"==typeof i)return"string"!=typeof n||1!=n.length?-1:i.indexOf(n,0);for(let o=0;o<i.length;o++)if(o in i&&i[o]===n)return o;return-1};function f_(i){const n=i.length;if(0<n){const o=Array(n);for(let a=0;a<n;a++)o[a]=i[a];return o}return[]}function ko(i,n){for(let o=1;o<arguments.length;o++){const a=arguments[o];if(Lu(a)){const h=i.length||0,_=a.length||0;i.length=h+_;for(let w=0;w<_;w++)i[h+w]=a[w]}else i.push(a)}}function Is(i,n){this.type=i,this.g=this.target=n,this.defaultPrevented=!1}Is.prototype.h=function(){this.defaultPrevented=!0};var gp=function(){if(!pr.addEventListener||!Object.defineProperty)return!1;var i=!1,n=Object.defineProperty({},"passive",{get:function(){i=!0}});try{pr.addEventListener("test",()=>{},n),pr.removeEventListener("test",()=>{},n)}catch{}return i}();function p_(i){return/^[\s\xa0]*$/.test(i)}function Eg(){var i=pr.navigator;return i&&(i=i.userAgent)?i:""}function zc(i){return-1!=Eg().indexOf(i)}function po(i){return po[" "](i),i}po[" "]=function(){};var e0,i,Nu=zc("Opera"),Tg=zc("Trident")||zc("MSIE"),vP=zc("Edge"),Ig=vP||Tg,uo=zc("Gecko")&&!(-1!=Eg().toLowerCase().indexOf("webkit")&&!zc("Edge"))&&!(zc("Trident")||zc("MSIE"))&&!zc("Edge"),Ib=-1!=Eg().toLowerCase().indexOf("webkit")&&!zc("Edge");function ol(){var i=pr.document;return i?i.documentMode:void 0}t:{var g_="",n0=(i=Eg(),uo?/rv:([^\);]+)(\)|;)/.exec(i):vP?/Edge\/([\d\.]+)/.exec(i):Tg?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(i):Ib?/WebKit\/(\S+)/.exec(i):Nu?/(?:Version)[ \/]?(\S+)/.exec(i):void 0);if(n0&&(g_=n0?n0[1]:""),Tg){var Bn=ol();if(null!=Bn&&Bn>parseFloat(g_)){e0=String(Bn);break t}}e0=g_}var Sb=pr.document&&Tg&&(ol()||parseInt(e0,10))||void 0;function Wh(i,n){if(Is.call(this,i?i.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,i){var o=this.type=i.type,a=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;if(this.target=i.target||i.srcElement,this.g=n,n=i.relatedTarget){if(uo){t:{try{po(n.nodeName);var h=!0;break t}catch{}h=!1}h||(n=null)}}else"mouseover"==o?n=i.fromElement:"mouseout"==o&&(n=i.toElement);this.relatedTarget=n,a?(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType="string"==typeof i.pointerType?i.pointerType:Cw[i.pointerType]||"",this.state=i.state,this.i=i,i.defaultPrevented&&Wh.$.h.call(this)}}co(Wh,Is);var Cw={2:"touch",3:"pen",4:"mouse"};Wh.prototype.h=function(){Wh.$.h.call(this);var i=this.i;i.preventDefault?i.preventDefault():i.returnValue=!1};var mp="closure_listenable_"+(1e6*Math.random()|0),m_=0;function bP(i,n,o,a,h){this.listener=i,this.proxy=null,this.src=n,this.type=o,this.capture=!!a,this.la=h,this.key=++m_,this.fa=this.ia=!1}function __(i){i.fa=!0,i.listener=null,i.proxy=null,i.src=null,i.la=null}function Ab(i,n,o){for(const a in i)n.call(o,i[a],a,i)}function qn(i){const n={};for(const o in i)n[o]=i[o];return n}const r0="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Fu(i,n){let o,a;for(let h=1;h<arguments.length;h++){for(o in a=arguments[h],a)i[o]=a[o];for(let _=0;_<r0.length;_++)o=r0[_],Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=a[o])}}function _p(i){this.src=i,this.g={},this.h=0}function y_(i,n){var o=n.type;if(o in i.g){var _,a=i.g[o],h=ww(a,n);(_=0<=h)&&Array.prototype.splice.call(a,h,1),_&&(__(n),0==i.g[o].length&&(delete i.g[o],i.h--))}}function Kh(i,n,o,a){for(var h=0;h<i.length;++h){var _=i[h];if(!_.fa&&_.listener==n&&_.capture==!!o&&_.la==a)return h}return-1}_p.prototype.add=function(i,n,o,a,h){var _=i.toString();(i=this.g[_])||(i=this.g[_]=[],this.h++);var w=Kh(i,n,a,h);return-1<w?(n=i[w],o||(n.ia=!1)):((n=new bP(n,this.src,_,!!a,h)).ia=o,i.push(n)),n};var Db="closure_lm_"+(1e6*Math.random()|0),kb={};function xP(i,n,o,a,h){if(a&&a.once)return Pw(i,n,o,a,h);if(Array.isArray(n)){for(var _=0;_<n.length;_++)xP(i,n[_],o,a,h);return null}return o=o0(o),i&&i[mp]?i.O(n,o,ga(a)?!!a.capture:!!a,h):Mw(i,n,o,!1,a,h)}function Mw(i,n,o,a,h,_){if(!n)throw Error("Invalid event type");var w=ga(h)?!!h.capture:!!h,S=v_(i);if(S||(i[Db]=S=new _p(i)),(o=S.add(n,o,a,w,_)).proxy)return o;if(a=function Rb(){const n=gr;return function i(o){return n.call(i.src,i.listener,o)}}(),o.proxy=a,a.src=i,a.listener=o,i.addEventListener)gp||(h=w),void 0===h&&(h=!1),i.addEventListener(n.toString(),a,h);else if(i.attachEvent)i.attachEvent(Lb(n.toString()),a);else{if(!i.addListener||!i.removeListener)throw Error("addEventListener and attachEvent are unavailable.");i.addListener(a)}return o}function Pw(i,n,o,a,h){if(Array.isArray(n)){for(var _=0;_<n.length;_++)Pw(i,n[_],o,a,h);return null}return o=o0(o),i&&i[mp]?i.P(n,o,ga(a)?!!a.capture:!!a,h):Mw(i,n,o,!0,a,h)}function yp(i,n,o,a,h){if(Array.isArray(n))for(var _=0;_<n.length;_++)yp(i,n[_],o,a,h);else a=ga(a)?!!a.capture:!!a,o=o0(o),i&&i[mp]?(i=i.i,(n=String(n).toString())in i.g&&-1<(o=Kh(_=i.g[n],o,a,h))&&(__(_[o]),Array.prototype.splice.call(_,o,1),0==_.length&&(delete i.g[n],i.h--))):i&&(i=v_(i))&&(n=i.g[n.toString()],i=-1,n&&(i=Kh(n,o,a,h)),(o=-1<i?n[i]:null)&&El(o))}function El(i){if("number"!=typeof i&&i&&!i.fa){var n=i.src;if(n&&n[mp])y_(n.i,i);else{var o=i.type,a=i.proxy;n.removeEventListener?n.removeEventListener(o,a,i.capture):n.detachEvent?n.detachEvent(Lb(o),a):n.addListener&&n.removeListener&&n.removeListener(a),(o=v_(n))?(y_(o,i),0==o.h&&(o.src=null,n[Db]=null)):__(i)}}}function Lb(i){return i in kb?kb[i]:kb[i]="on"+i}function gr(i,n){if(i.fa)i=!0;else{n=new Wh(n,this);var o=i.listener,a=i.la||i.src;i.ia&&El(i),i=o.call(a,n)}return i}function v_(i){return(i=i[Db])instanceof _p?i:null}var il="__closure_events_fn_"+(1e9*Math.random()>>>0);function o0(i){return"function"==typeof i?i:(i[il]||(i[il]=function(n){return i.handleEvent(n)}),i[il])}function Fs(){qh.call(this),this.i=new _p(this),this.S=this,this.J=null}function Js(i,n){var o,a=i.J;if(a)for(o=[];a;a=a.J)o.push(a);if(i=i.S,a=n.type||n,"string"==typeof n)n=new Is(n,i);else if(n instanceof Is)n.target=n.target||i;else{var h=n;Fu(n=new Is(a,i),h)}if(h=!0,o)for(var _=o.length-1;0<=_;_--){var w=n.g=o[_];h=s0(w,a,!0,n)&&h}if(h=s0(w=n.g=i,a,!0,n)&&h,h=s0(w,a,!1,n)&&h,o)for(_=0;_<o.length;_++)h=s0(w=n.g=o[_],a,!1,n)&&h}function s0(i,n,o,a){if(!(n=i.i.g[String(n)]))return!0;n=n.concat();for(var h=!0,_=0;_<n.length;++_){var w=n[_];if(w&&!w.fa&&w.capture==o){var S=w.listener,L=w.la||w.src;w.ia&&y_(i.i,w),h=!1!==S.call(L,a)&&h}}return h&&!a.defaultPrevented}co(Fs,qh),Fs.prototype[mp]=!0,Fs.prototype.removeEventListener=function(i,n,o,a){yp(this,i,n,o,a)},Fs.prototype.N=function(){if(Fs.$.N.call(this),this.i){var n,i=this.i;for(n in i.g){for(var o=i.g[n],a=0;a<o.length;a++)__(o[a]);delete i.g[n],i.h--}}this.J=null},Fs.prototype.O=function(i,n,o,a){return this.i.add(String(i),n,!1,o,a)},Fs.prototype.P=function(i,n,o,a){return this.i.add(String(i),n,!0,o,a)};var Nb=pr.JSON.stringify;function Yh(){var i=Aa;let n=null;return i.g&&(n=i.g,i.g=i.g.next,i.g||(i.h=null),n.next=null),n}var Ow=new class wP{constructor(n,o){this.i=n,this.j=o,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new NI,i=>i.reset());class NI{constructor(){this.next=this.g=this.h=null}set(n,o){this.h=n,this.g=o,this.next=null}reset(){this.next=this.g=this.h=null}}function CP(i){var n=1;i=i.split(":");const o=[];for(;0<n&&i.length;)o.push(i.shift()),n--;return i.length&&o.push(i.join(":")),o}function x_(i){pr.setTimeout(()=>{throw i},0)}let Fb,Bc=!1,Aa=new class b_{constructor(){this.h=this.g=null}add(n,o){const a=Ow.get();a.set(n,o),this.h?this.h.next=a:this.g=a,this.h=a}},Ew=()=>{const i=pr.Promise.resolve(void 0);Fb=()=>{i.then(zb)}};var zb=()=>{for(var i;i=Yh();){try{i.h.call(i.g)}catch(o){x_(o)}var n=Ow;n.j(i),100>n.h&&(n.h++,i.next=n.g,n.g=i)}Bc=!1};function w_(i,n){Fs.call(this),this.h=i||1,this.g=n||pr,this.j=Qo(this.qb,this),this.l=Date.now()}function Bb(i){i.ga=!1,i.T&&(i.g.clearTimeout(i.T),i.T=null)}function C_(i,n,o){if("function"==typeof i)o&&(i=Qo(i,o));else{if(!i||"function"!=typeof i.handleEvent)throw Error("Invalid listener argument");i=Qo(i.handleEvent,i)}return 2147483647<Number(n)?-1:pr.setTimeout(i,n||0)}function zu(i){i.g=C_(()=>{i.g=null,i.i&&(i.i=!1,zu(i))},i.j);const n=i.h;i.h=null,i.m.apply(null,n)}co(w_,Fs),(an=w_.prototype).ga=!1,an.T=null,an.qb=function(){if(this.ga){var i=Date.now()-this.l;0<i&&i<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-i):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Js(this,"tick"),this.ga&&(Bb(this),this.start()))}},an.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},an.N=function(){w_.$.N.call(this),Bb(this),delete this.g};class M_ extends qh{constructor(n,o){super(),this.m=n,this.j=o,this.h=null,this.i=!1,this.g=null}l(n){this.h=arguments,this.g?this.i=!0:zu(this)}N(){super.N(),this.g&&(pr.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Xh(i){qh.call(this),this.h=i,this.g={}}co(Xh,qh);var Ub=[];function Vb(i,n,o,a){Array.isArray(o)||(o&&(Ub[0]=o.toString()),o=Ub);for(var h=0;h<o.length;h++){var _=xP(n,o[h],a||i.handleEvent,!1,i.h||i);if(!_)break;i.g[_.key]=_}}function MP(i){Ab(i.g,function(n,o){this.g.hasOwnProperty(o)&&El(n)},i),i.g={}}function jb(){this.g=!0}function ta(i,n,o,a){i.info(function(){return"XMLHTTP TEXT ("+n+"): "+function OT(i,n){if(!i.g)return n;if(!n)return null;try{var o=JSON.parse(n);if(o)for(i=0;i<o.length;i++)if(Array.isArray(o[i])){var a=o[i];if(!(2>a.length)){var h=a[1];if(Array.isArray(h)&&!(1>h.length)){var _=h[0];if("noop"!=_&&"stop"!=_&&"close"!=_)for(var w=1;w<h.length;w++)h[w]=""}}}return Nb(o)}catch{return n}}(i,o)+(a?" "+a:"")})}Xh.prototype.N=function(){Xh.$.N.call(this),MP(this)},Xh.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},jb.prototype.Ea=function(){this.g=!1},jb.prototype.info=function(){};var vp={},$b=null;function P_(){return $b=$b||new Fs}function PP(i){Is.call(this,vp.Ta,i)}function sl(i){const n=P_();Js(n,new PP(n))}function Tw(i,n){Is.call(this,vp.STAT_EVENT,i),this.stat=n}function Dn(i){const n=P_();Js(n,new Tw(n,i))}function Gb(i,n){Is.call(this,vp.Ua,i),this.size=n}function ms(i,n){if("function"!=typeof i)throw Error("Fn must not be null and must be a function");return pr.setTimeout(function(){i()},n)}vp.Ta="serverreachability",co(PP,Is),vp.STAT_EVENT="statevent",co(Tw,Is),vp.Ua="timingevent",co(Gb,Is);var Uc={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},bp={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Hb(){}function Zb(){}Hb.prototype.h=null;var Yb,Sg={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Wb(){Is.call(this,"d")}function Kb(){Is.call(this,"c")}function Ag(){}function Zn(i,n,o,a){this.l=i,this.j=n,this.m=o,this.W=a||1,this.U=new Xh(this),this.P=O_,this.V=new w_(i=Ig?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Iw}function Iw(){this.i=null,this.g="",this.h=!1}co(Wb,Is),co(Kb,Is),co(Ag,Hb),Ag.prototype.g=function(){return new XMLHttpRequest},Ag.prototype.i=function(){return{}},Yb=new Ag;var O_=45e3,xp={},Qh={};function l0(i,n,o){i.L=1,i.v=tf(bt(n)),i.s=o,i.S=!0,Xb(i,null)}function Xb(i,n){i.G=Date.now(),Dg(i),i.A=bt(i.v);var o=i.A,a=i.W;Array.isArray(a)||(a=[String(a)]),Ir(o.i,"t",a),i.C=0,o=i.l.J,i.h=new Iw,i.g=Nw(i.l,o?n:null,!i.s),0<i.O&&(i.M=new M_(Qo(i.Pa,i,i.g),i.O)),Vb(i.U,i.g,"readystatechange",i.nb),n=i.I?qn(i.I):{},i.s?(i.u||(i.u="POST"),n["Content-Type"]="application/x-www-form-urlencoded",i.g.ha(i.A,i.u,i.s,n)):(i.u="GET",i.g.ha(i.A,i.u,null,n)),sl(),function MT(i,n,o,a,h,_){i.info(function(){if(i.g)if(_)for(var w="",S=_.split("&"),L=0;L<S.length;L++){var B=S[L].split("=");if(1<B.length){var H=B[0];B=B[1];var Y=H.split("_");w=2<=Y.length&&"type"==Y[1]?w+(H+"=")+B+"&":w+(H+"=redacted&")}}else w=null;else w=_;return"XMLHTTP REQ ("+a+") [attempt "+h+"]: "+n+"\n"+o+"\n"+w})}(i.j,i.u,i.A,i.m,i.W,i.s)}function c0(i){return!!i.g&&"GET"==i.u&&2!=i.L&&i.l.Ha}function u0(i,n,o){let h,a=!0;for(;!i.J&&i.C<o.length;){if(h=OP(i,o),h==Qh){4==n&&(i.o=4,Dn(14),a=!1),ta(i.j,i.m,null,"[Incomplete Response]");break}if(h==xp){i.o=4,Dn(15),ta(i.j,i.m,o,"[Invalid Chunk]"),a=!1;break}ta(i.j,i.m,h,null),Sw(i,h)}c0(i)&&h!=Qh&&h!=xp&&(i.h.g="",i.C=0),4!=n||0!=o.length||i.h.h||(i.o=1,Dn(16),a=!1),i.i=i.i&&a,a?0<o.length&&!i.ba&&(i.ba=!0,(n=i.l).g==i&&n.ca&&!n.M&&(n.l.info("Great, no buffering proxy detected. Bytes received: "+o.length),Lw(n),n.M=!0,Dn(11))):(ta(i.j,i.m,o,"[Invalid Chunked Response]"),kr(i),E_(i))}function OP(i,n){var o=i.C,a=n.indexOf("\n",o);return-1==a?Qh:(o=Number(n.substring(o,a)),isNaN(o)?xp:(a+=1)+o>n.length?Qh:(n=n.slice(a,a+o),i.C=a+o,n))}function Dg(i){i.Y=Date.now()+i.P,Qb(i,i.P)}function Qb(i,n){if(null!=i.B)throw Error("WatchDog timer not null");i.B=ms(Qo(i.lb,i),n)}function kg(i){i.B&&(pr.clearTimeout(i.B),i.B=null)}function E_(i){0==i.l.H||i.J||Ep(i.l,i)}function kr(i){kg(i);var n=i.M;n&&"function"==typeof n.sa&&n.sa(),i.M=null,Bb(i.V),MP(i.U),i.g&&(n=i.g,i.g=null,n.abort(),n.sa())}function Sw(i,n){try{var o=i.l;if(0!=o.H&&(o.g==i||o1(o.i,i)))if(!i.K&&o1(o.i,i)&&3==o.H){try{var a=o.Ja.g.parse(n)}catch{a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!o.u){if(o.g){if(!(o.g.G+3e3<i.G))break t;d1(o),Pi(o)}v0(o),Dn(18)}}else o.Fa=h[1],0<o.Fa-o.V&&37500>h[2]&&o.G&&0==o.A&&!o.v&&(o.v=ms(Qo(o.ib,o),6e3));if(1>=I_(o.i)&&o.oa){try{o.oa()}catch{}o.oa=void 0}}else Da(o,11)}else if((i.K||o.g==i)&&d1(o),!p_(n))for(h=o.Ja.g.parse(n),n=0;n<h.length;n++){let B=h[n];if(o.V=B[0],B=B[1],2==o.H)if("c"==B[0]){o.K=B[1],o.pa=B[2];const H=B[3];null!=H&&(o.ra=H,o.l.info("VER="+o.ra));const Y=B[4];null!=Y&&(o.Ga=Y,o.l.info("SVER="+o.Ga));const pt=B[5];null!=pt&&"number"==typeof pt&&0<pt&&(o.L=a=1.5*pt,o.l.info("backChannelRequestTimeoutMs_="+a)),a=o;const xt=i.g;if(xt){const At=xt.g?xt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(At){var _=a.i;_.g||-1==At.indexOf("spdy")&&-1==At.indexOf("quic")&&-1==At.indexOf("h2")||(_.j=_.l,_.g=new Set,_.h&&(sc(_,_.h),_.h=null))}if(a.F){const Ut=xt.g?xt.g.getResponseHeader("X-HTTP-Session-Id"):null;Ut&&(a.Da=Ut,So(a.I,a.F,Ut))}}o.H=3,o.h&&o.h.Ba(),o.ca&&(o.S=Date.now()-i.G,o.l.info("Handshake RTT: "+o.S+"ms"));var w=i;if((a=o).wa=h1(a,a.J?a.pa:null,a.Y),w.K){yo(a.i,w);var S=w,L=a.L;L&&S.setTimeout(L),S.B&&(kg(S),Dg(S)),a.g=w}else y0(a);0<o.j.length&&m0(o)}else"stop"!=B[0]&&"close"!=B[0]||Da(o,7);else 3==o.H&&("stop"==B[0]||"close"==B[0]?"stop"==B[0]?Da(o,7):u1(o):"noop"!=B[0]&&o.h&&o.h.Aa(B),o.A=0)}sl()}catch{}}function Dw(i,n){if(i.forEach&&"function"==typeof i.forEach)i.forEach(n,void 0);else if(Lu(i)||"string"==typeof i)Array.prototype.forEach.call(i,n,void 0);else for(var o=function Rg(i){if(i.ta&&"function"==typeof i.ta)return i.ta();if(!i.Z||"function"!=typeof i.Z){if(typeof Map<"u"&&i instanceof Map)return Array.from(i.keys());if(!(typeof Set<"u"&&i instanceof Set)){if(Lu(i)||"string"==typeof i){var n=[];i=i.length;for(var o=0;o<i;o++)n.push(o);return n}n=[],o=0;for(const a in i)n[o++]=a;return n}}}(i),a=function Aw(i){if(i.Z&&"function"==typeof i.Z)return i.Z();if(typeof Map<"u"&&i instanceof Map||typeof Set<"u"&&i instanceof Set)return Array.from(i.values());if("string"==typeof i)return i.split("");if(Lu(i)){for(var n=[],o=i.length,a=0;a<o;a++)n.push(i[a]);return n}for(a in n=[],o=0,i)n[o++]=i[a];return n}(i),h=a.length,_=0;_<h;_++)n.call(void 0,a[_],o&&o[_],i)}(an=Zn.prototype).setTimeout=function(i){this.P=i},an.nb=function(i){i=i.target;const n=this.M;n&&3==ll(i)?n.l():this.Pa(i)},an.Pa=function(i){try{if(i==this.g)t:{const H=ll(this.g);var n=this.g.Ia();if(this.g.da(),!(3>H)&&(3!=H||Ig||this.g&&(this.h.h||this.g.ja()||Rw(this.g)))){this.J||4!=H||7==n||sl(),kg(this);var o=this.g.da();this.ca=o;e:if(c0(this)){var a=Rw(this.g);i="";var h=a.length,_=4==ll(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){kr(this),E_(this);var w="";break e}this.h.i=new pr.TextDecoder}for(n=0;n<h;n++)this.h.h=!0,i+=this.h.i.decode(a[n],{stream:_&&n==h-1});a.splice(0,h),this.h.g+=i,this.C=0,w=this.h.g}else w=this.g.ja();if(this.i=200==o,function a0(i,n,o,a,h,_,w){i.info(function(){return"XMLHTTP RESP ("+a+") [ attempt "+h+"]: "+n+"\n"+o+"\n"+_+" "+w})}(this.j,this.u,this.A,this.m,this.W,H,o),this.i){if(this.aa&&!this.K){e:{if(this.g){var S,L=this.g;if((S=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p_(S)){var B=S;break e}}B=null}if(!(o=B)){this.i=!1,this.o=3,Dn(12),kr(this),E_(this);break t}ta(this.j,this.m,o,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Sw(this,o)}this.S?(u0(this,H,w),Ig&&this.i&&3==H&&(Vb(this.U,this.V,"tick",this.mb),this.V.start())):(ta(this.j,this.m,w,null),Sw(this,w)),4==H&&kr(this),this.i&&!this.J&&(4==H?Ep(this.l,this):(this.i=!1,Dg(this)))}else(function lf(i){const n={};i=(i.g&&2<=ll(i)&&i.g.getAllResponseHeaders()||"").split("\r\n");for(let a=0;a<i.length;a++){if(p_(i[a]))continue;var o=CP(i[a]);const h=o[0];if("string"!=typeof(o=o[1]))continue;o=o.trim();const _=n[h]||[];n[h]=_,_.push(o)}!function jn(i,n){for(const o in i)n.call(void 0,i[o],o,i)}(n,function(a){return a.join(", ")})})(this.g),400==o&&0<w.indexOf("Unknown SID")?(this.o=3,Dn(12)):(this.o=0,Dn(13)),kr(this),E_(this)}}}catch{}},an.mb=function(){if(this.g){var i=ll(this.g),n=this.g.ja();this.C<n.length&&(kg(this),u0(this,i,n),this.i&&4!=i&&Dg(this))}},an.cancel=function(){this.J=!0,kr(this)},an.lb=function(){this.B=null;const i=Date.now();0<=i-this.Y?(function PT(i,n){i.info(function(){return"TIMEOUT: "+n})}(this.j,this.A),2!=this.L&&(sl(),Dn(17)),kr(this),this.o=2,E_(this)):Qb(this,this.Y-i)};var wp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Jh(i){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,i instanceof Jh){this.h=i.h,Jb(this,i.j),this.s=i.s,this.g=i.g,Bi(this,i.m),this.l=i.l;var n=i.i,o=new Mp;o.i=n.i,n.g&&(o.g=new Map(n.g),o.h=n.h),d0(this,o),this.o=i.o}else i&&(n=String(i).match(wp))?(this.h=!1,Jb(this,n[1]||"",!0),this.s=dt(n[2]||""),this.g=dt(n[3]||"",!0),Bi(this,n[4]),this.l=dt(n[5]||"",!0),d0(this,n[6]||"",!0),this.o=dt(n[7]||"")):(this.h=!1,this.i=new Mp(null,this.h))}function bt(i){return new Jh(i)}function Jb(i,n,o){i.j=o?dt(n,!0):n,i.j&&(i.j=i.j.replace(/:$/,""))}function Bi(i,n){if(n){if(n=Number(n),isNaN(n)||0>n)throw Error("Bad port number "+n);i.m=n}else i.m=null}function d0(i,n,o){n instanceof Mp?(i.i=n,function IP(i,n){n&&!i.j&&(ef(i),i.i=null,i.g.forEach(function(o,a){var h=a.toLowerCase();a!=h&&(ic(this,a),Ir(this,h,o))},i)),i.j=n}(i.i,i.h)):(o||(n=h0(n,TP)),i.i=new Mp(n,i.h))}function So(i,n,o){i.i.set(n,o)}function tf(i){return So(i,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),i}function dt(i,n){return i?n?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function h0(i,n,o){return"string"==typeof i?(i=encodeURI(i).replace(n,EP),o&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function EP(i){return"%"+((i=i.charCodeAt(0))>>4&15).toString(16)+(15&i).toString(16)}Jh.prototype.toString=function(){var i=[],n=this.j;n&&i.push(h0(n,Vc,!0),":");var o=this.g;return(o||"file"==n)&&(i.push("//"),(n=this.s)&&i.push(h0(n,Vc,!0),"@"),i.push(encodeURIComponent(String(o)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(o=this.m)&&i.push(":",String(o))),(o=this.l)&&(this.g&&"/"!=o.charAt(0)&&i.push("/"),i.push(h0(o,"/"==o.charAt(0)?t1:T_,!0))),(o=this.i.toString())&&i.push("?",o),(o=this.o)&&i.push("#",h0(o,Cp)),i.join("")};var Vc=/[#\/\?@]/g,T_=/[#\?:]/g,t1=/[#\?]/g,TP=/[#\?@]/g,Cp=/#/g;function Mp(i,n){this.h=this.g=null,this.i=i||null,this.j=!!n}function ef(i){i.g||(i.g=new Map,i.h=0,i.i&&function al(i,n){if(i){i=i.split("&");for(var o=0;o<i.length;o++){var a=i[o].indexOf("="),h=null;if(0<=a){var _=i[o].substring(0,a);h=i[o].substring(a+1)}else _=i[o];n(_,h?decodeURIComponent(h.replace(/\+/g," ")):"")}}}(i.i,function(n,o){i.add(decodeURIComponent(n.replace(/\+/g," ")),o)}))}function ic(i,n){ef(i),n=nf(i,n),i.g.has(n)&&(i.i=null,i.h-=i.g.get(n).length,i.g.delete(n))}function f0(i,n){return ef(i),n=nf(i,n),i.g.has(n)}function Ir(i,n,o){ic(i,n),0<o.length&&(i.i=null,i.g.set(nf(i,n),f_(o)),i.h+=o.length)}function nf(i,n){return n=String(n),i.j&&(n=n.toLowerCase()),n}function n1(i){this.l=i||r1,i=pr.PerformanceNavigationTiming?0<(i=pr.performance.getEntriesByType("navigation")).length&&("hq"==i[0].nextHopProtocol||"h2"==i[0].nextHopProtocol):!!(pr.g&&pr.g.Ka&&pr.g.Ka()&&pr.g.Ka().ec),this.j=i?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(an=Mp.prototype).add=function(i,n){ef(this),this.i=null,i=nf(this,i);var o=this.g.get(i);return o||this.g.set(i,o=[]),o.push(n),this.h+=1,this},an.forEach=function(i,n){ef(this),this.g.forEach(function(o,a){o.forEach(function(h){i.call(n,h,a,this)},this)},this)},an.ta=function(){ef(this);const i=Array.from(this.g.values()),n=Array.from(this.g.keys()),o=[];for(let a=0;a<n.length;a++){const h=i[a];for(let _=0;_<h.length;_++)o.push(n[a])}return o},an.Z=function(i){ef(this);let n=[];if("string"==typeof i)f0(this,i)&&(n=n.concat(this.g.get(nf(this,i))));else{i=Array.from(this.g.values());for(let o=0;o<i.length;o++)n=n.concat(i[o])}return n},an.set=function(i,n){return ef(this),this.i=null,f0(this,i=nf(this,i))&&(this.h-=this.g.get(i).length),this.g.set(i,[n]),this.h+=1,this},an.get=function(i,n){return i&&0<(i=this.Z(i)).length?String(i[0]):n},an.toString=function(){if(this.i)return this.i;if(!this.g)return"";const i=[],n=Array.from(this.g.keys());for(var o=0;o<n.length;o++){var a=n[o];const _=encodeURIComponent(String(a)),w=this.Z(a);for(a=0;a<w.length;a++){var h=_;""!==w[a]&&(h+="="+encodeURIComponent(String(w[a]))),i.push(h)}}return this.i=i.join("&")};var r1=10;function SP(i){return!!i.h||!!i.g&&i.g.size>=i.j}function I_(i){return i.h?1:i.g?i.g.size:0}function o1(i,n){return i.h?i.h==n:!!i.g&&i.g.has(n)}function sc(i,n){i.g?i.g.add(n):i.h=n}function yo(i,n){i.h&&i.h==n?i.h=null:i.g&&i.g.has(n)&&i.g.delete(n)}function Bu(i){if(null!=i.h)return i.i.concat(i.h.F);if(null!=i.g&&0!==i.g.size){let n=i.i;for(const o of i.g.values())n=n.concat(o.F);return n}return f_(i.i)}n1.prototype.cancel=function(){if(this.i=Bu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const i of this.g.values())i.cancel();this.g.clear()}};var Bd=class{stringify(i){return pr.JSON.stringify(i,void 0)}parse(i){return pr.JSON.parse(i,void 0)}};function ea(){this.g=new Bd}function p0(i,n,o){const a=o||"";try{Dw(i,function(h,_){let w=h;ga(h)&&(w=Nb(h)),n.push(a+_+"="+encodeURIComponent(w))})}catch(h){throw n.push(a+"type="+encodeURIComponent("_badmap")),h}}function Uu(i,n,o,a,h){try{n.onload=null,n.onerror=null,n.onabort=null,n.ontimeout=null,h(a)}catch{}}function na(i){this.l=i.fc||null,this.j=i.ob||!1}function ma(i,n){Fs.call(this),this.F=i,this.u=n,this.m=void 0,this.readyState=S_,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}co(na,Hb),na.prototype.g=function(){return new ma(this.l,this.j)},na.prototype.i=function(i){return function(){return i}}({}),co(ma,Fs);var S_=0;function i1(i){i.j.read().then(i.Xa.bind(i)).catch(i.ka.bind(i))}function Pp(i){i.readyState=4,i.l=null,i.j=null,i.A=null,sf(i)}function sf(i){i.onreadystatechange&&i.onreadystatechange.call(i)}(an=ma.prototype).open=function(i,n){if(this.readyState!=S_)throw this.abort(),Error("Error reopening a connection");this.C=i,this.B=n,this.readyState=1,sf(this)},an.send=function(i){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const n={headers:this.v,method:this.C,credentials:this.m,cache:void 0};i&&(n.body=i),(this.F||pr).fetch(new Request(this.B,n)).then(this.$a.bind(this),this.ka.bind(this))},an.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Pp(this)),this.readyState=S_},an.$a=function(i){if(this.g&&(this.l=i,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=i.headers,this.readyState=2,sf(this)),this.g&&(this.readyState=3,sf(this),this.g)))if("arraybuffer"===this.responseType)i.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof pr.ReadableStream<"u"&&"body"in i){if(this.j=i.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;i1(this)}else i.text().then(this.Za.bind(this),this.ka.bind(this))},an.Xa=function(i){if(this.g){if(this.u&&i.value)this.response.push(i.value);else if(!this.u){var n=i.value?i.value:new Uint8Array(0);(n=this.A.decode(n,{stream:!i.done}))&&(this.response=this.responseText+=n)}i.done?Pp(this):sf(this),3==this.readyState&&i1(this)}},an.Za=function(i){this.g&&(this.response=this.responseText=i,Pp(this))},an.Ya=function(i){this.g&&(this.response=i,Pp(this))},an.ka=function(){this.g&&Pp(this)},an.setRequestHeader=function(i,n){this.v.append(i,n)},an.getResponseHeader=function(i){return this.h&&this.h.get(i.toLowerCase())||""},an.getAllResponseHeaders=function(){if(!this.h)return"";const i=[],n=this.h.entries();for(var o=n.next();!o.done;)i.push((o=o.value)[0]+": "+o[1]),o=n.next();return i.join("\r\n")},Object.defineProperty(ma.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(i){this.m=i?"include":"same-origin"}});var kw=pr.JSON.parse;function Po(i){Fs.call(this),this.headers=new Map,this.u=i||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Ud,this.L=this.M=!1}co(Po,Fs);var Ud="",AP=/^https?$/i,s1=["POST","PUT"];function g0(i,n){i.h=!1,i.g&&(i.l=!0,i.g.abort(),i.l=!1),i.j=n,i.m=5,l1(i),ra(i)}function l1(i){i.F||(i.F=!0,Js(i,"complete"),Js(i,"error"))}function A_(i){if(i.h&&typeof Ol<"u"&&(!i.C[1]||4!=ll(i)||2!=i.da()))if(i.v&&4==ll(i))C_(i.La,0,i);else if(Js(i,"readystatechange"),4==ll(i)){i.h=!1;try{const w=i.da();t:switch(w){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break t;default:n=!1}var o;if(!(o=n)){var a;if(a=0===w){var h=String(i.I).match(wp)[1]||null;!h&&pr.self&&pr.self.location&&(h=pr.self.location.protocol.slice(0,-1)),a=!AP.test(h?h.toLowerCase():"")}o=a}if(o)Js(i,"complete"),Js(i,"success");else{i.m=6;try{var _=2<ll(i)?i.g.statusText:""}catch{_=""}i.j=_+" ["+i.da()+"]",l1(i)}}finally{ra(i)}}}function ra(i,n){if(i.g){af(i);const o=i.g,a=i.C[0]?()=>{}:null;i.g=null,i.C=null,n||Js(i,"ready");try{o.onreadystatechange=a}catch{}}}function af(i){i.g&&i.L&&(i.g.ontimeout=null),i.A&&(pr.clearTimeout(i.A),i.A=null)}function ll(i){return i.g?i.g.readyState:0}function Rw(i){try{if(!i.g)return null;if("response"in i.g)return i.g.response;switch(i.K){case Ud:case"text":return i.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in i.g)return i.g.mozResponseArrayBuffer}return null}catch{return null}}function D_(i){let n="";return Ab(i,function(o,a){n+=a,n+=":",n+=o,n+="\r\n"}),n}function Op(i,n,o){t:{for(a in o){var a=!1;break t}a=!0}a||(o=D_(o),"string"==typeof i?null!=o&&encodeURIComponent(String(o)):So(i,n,o))}function k_(i,n,o){return o&&o.internalChannelParams&&o.internalChannelParams[i]||n}function c1(i){this.Ga=0,this.j=[],this.l=new jb,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=k_("failFast",!1,i),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=k_("baseRetryDelayMs",5e3,i),this.hb=k_("retryDelaySeedMs",1e4,i),this.eb=k_("forwardChannelMaxRetries",2,i),this.xa=k_("forwardChannelRequestTimeoutMs",2e4,i),this.va=i&&i.xmlHttpFactory||void 0,this.Ha=i&&i.dc||!1,this.L=void 0,this.J=i&&i.supportsCrossDomainXhr||!1,this.K="",this.i=new n1(i&&i.concurrentRequestLimit),this.Ja=new ea,this.P=i&&i.fastHandshake||!1,this.O=i&&i.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=i&&i.bc||!1,i&&i.Ea&&this.l.Ea(),i&&i.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&i&&i.detectBufferingProxy||!1,this.qa=void 0,i&&i.longPollingTimeout&&0<i.longPollingTimeout&&(this.qa=i.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function u1(i){if(DP(i),3==i.H){var n=i.W++,o=bt(i.I);if(So(o,"SID",i.K),So(o,"RID",n),So(o,"TYPE","terminate"),Vu(i,o),(n=new Zn(i,i.l,n)).L=2,n.v=tf(bt(o)),o=!1,pr.navigator&&pr.navigator.sendBeacon)try{o=pr.navigator.sendBeacon(n.v.toString(),"")}catch{}!o&&pr.Image&&((new Image).src=n.v,o=!0),o||(n.g=Nw(n.l,null),n.g.ha(n.v)),n.G=Date.now(),Dg(n)}kn(i)}function Pi(i){i.g&&(Lw(i),i.g.cancel(),i.g=null)}function DP(i){Pi(i),i.u&&(pr.clearTimeout(i.u),i.u=null),d1(i),i.i.cancel(),i.m&&("number"==typeof i.m&&pr.clearTimeout(i.m),i.m=null)}function m0(i){if(!SP(i.i)&&!i.m){i.m=!0;var n=i.Na;Fb||Ew(),Bc||(Fb(),Bc=!0),Aa.add(n,i),i.C=0}}function kP(i,n){var o;o=n?n.m:i.W++;const a=bt(i.I);So(a,"SID",i.K),So(a,"RID",o),So(a,"AID",i.V),Vu(i,a),i.o&&i.s&&Op(a,i.o,i.s),o=new Zn(i,i.l,o,i.C+1),null===i.o&&(o.I=i.s),n&&(i.j=n.F.concat(i.j)),n=Lg(i,o,1e3),o.setTimeout(Math.round(.5*i.xa)+Math.round(.5*i.xa*Math.random())),sc(i.i,o),l0(o,a,n)}function Vu(i,n){i.na&&Ab(i.na,function(o,a){So(n,a,o)}),i.h&&Dw({},function(o,a){So(n,a,o)})}function Lg(i,n,o){o=Math.min(i.j.length,o);var a=i.h?Qo(i.h.Va,i.h,i):null;t:{var h=i.j;let _=-1;for(;;){const w=["count="+o];-1==_?0<o?(_=h[0].g,w.push("ofs="+_)):_=0:w.push("ofs="+_);let S=!0;for(let L=0;L<o;L++){let B=h[L].g;const H=h[L].map;if(B-=_,0>B)_=Math.max(0,h[L].g-100),S=!1;else try{p0(H,w,"req"+B+"_")}catch{a&&a(H)}}if(S){a=w.join("&");break t}}}return i=i.j.splice(0,o),n.F=i,a}function y0(i){if(!i.g&&!i.u){i.ba=1;var n=i.Ma;Fb||Ew(),Bc||(Fb(),Bc=!0),Aa.add(n,i),i.A=0}}function v0(i){return!(i.g||i.u||3<=i.A||(i.ba++,i.u=ms(Qo(i.Ma,i),b0(i,i.A)),i.A++,0))}function Lw(i){null!=i.B&&(pr.clearTimeout(i.B),i.B=null)}function RP(i){i.g=new Zn(i,i.l,"rpc",i.ba),null===i.o&&(i.g.I=i.s),i.g.O=0;var n=bt(i.wa);So(n,"RID","rpc"),So(n,"SID",i.K),So(n,"AID",i.V),So(n,"CI",i.G?"0":"1"),!i.G&&i.qa&&So(n,"TO",i.qa),So(n,"TYPE","xmlhttp"),Vu(i,n),i.o&&i.s&&Op(n,i.o,i.s),i.L&&i.g.setTimeout(i.L);var o=i.g;i=i.pa,o.L=1,o.v=tf(bt(n)),o.s=null,o.S=!0,Xb(o,i)}function d1(i){null!=i.v&&(pr.clearTimeout(i.v),i.v=null)}function Ep(i,n){var o=null;if(i.g==n){d1(i),Lw(i),i.g=null;var a=2}else{if(!o1(i.i,n))return;o=n.F,yo(i.i,n),a=1}if(0!=i.H)if(n.i)if(1==a){o=n.s?n.s.length:0,n=Date.now()-n.G;var h=i.C;Js(a=P_(),new Gb(a,o)),m0(i)}else y0(i);else if(3==(h=n.o)||0==h&&0<n.ca||!(1==a&&function _0(i,n){return!(I_(i.i)>=i.i.j-(i.m?1:0)||(i.m?(i.j=n.F.concat(i.j),0):1==i.H||2==i.H||i.C>=(i.cb?0:i.eb)||(i.m=ms(Qo(i.Na,i,n),b0(i,i.C)),i.C++,0)))}(i,n)||2==a&&v0(i)))switch(o&&0<o.length&&(n=i.i,n.i=n.i.concat(o)),h){case 1:Da(i,5);break;case 4:Da(i,10);break;case 3:Da(i,6);break;default:Da(i,2)}}function b0(i,n){let o=i.ab+Math.floor(Math.random()*i.hb);return i.isActive()||(o*=2),o*n}function Da(i,n){if(i.l.info("Error code "+n),2==n){var o=null;i.h&&(o=null);var a=Qo(i.pb,i);o||(o=new Jh("//www.google.com/images/cleardot.gif"),pr.location&&"http"==pr.location.protocol||Jb(o,"https"),tf(o)),function rf(i,n){const o=new jb;if(pr.Image){const a=new Image;a.onload=zi(Uu,o,a,"TestLoadImage: loaded",!0,n),a.onerror=zi(Uu,o,a,"TestLoadImage: error",!1,n),a.onabort=zi(Uu,o,a,"TestLoadImage: abort",!1,n),a.ontimeout=zi(Uu,o,a,"TestLoadImage: timeout",!1,n),pr.setTimeout(function(){a.ontimeout&&a.ontimeout()},1e4),a.src=i}else n(!1)}(o.toString(),a)}else Dn(2);i.H=0,i.h&&i.h.za(n),kn(i),DP(i)}function kn(i){if(i.H=0,i.ma=[],i.h){const n=Bu(i.i);(0!=n.length||0!=i.j.length)&&(ko(i.ma,n),ko(i.ma,i.j),i.i.i.length=0,f_(i.j),i.j.length=0),i.h.ya()}}function h1(i,n,o){var a=o instanceof Jh?bt(o):new Jh(o);if(""!=a.g)n&&(a.g=n+"."+a.g),Bi(a,a.m);else{var h=pr.location;a=h.protocol,n=n?n+"."+h.hostname:h.hostname,h=+h.port;var _=new Jh(null);a&&Jb(_,a),n&&(_.g=n),h&&Bi(_,h),o&&(_.l=o),a=_}return n=i.Da,(o=i.F)&&n&&So(a,o,n),So(a,"VER",i.ra),Vu(i,a),a}function Nw(i,n,o){if(n&&!i.J)throw Error("Can't create secondary domain capable XhrIo object.");return(n=new Po(o&&i.Ha&&!i.va?new na({ob:!0}):i.va)).Oa(i.J),n}function x0(){}function yi(){if(Tg&&!(10<=Number(Sb)))throw Error("Environmental error: no available transport.")}function Oo(i,n){Fs.call(this),this.g=new c1(n),this.l=i,this.h=n&&n.messageUrlParams||null,i=n&&n.messageHeaders||null,n&&n.clientProtocolHeaderRequired&&(i?i["X-Client-Protocol"]="webchannel":i={"X-Client-Protocol":"webchannel"}),this.g.s=i,i=n&&n.initMessageHeaders||null,n&&n.messageContentType&&(i?i["X-WebChannel-Content-Type"]=n.messageContentType:i={"X-WebChannel-Content-Type":n.messageContentType}),n&&n.Ca&&(i?i["X-WebChannel-Client-Profile"]=n.Ca:i={"X-WebChannel-Client-Profile":n.Ca}),this.g.U=i,(i=n&&n.cc)&&!p_(i)&&(this.g.o=i),this.A=n&&n.supportsCrossDomainXhr||!1,this.v=n&&n.sendRawJson||!1,(n=n&&n.httpSessionIdParam)&&!p_(n)&&(this.g.F=n,null!==(i=this.h)&&n in i&&n in(i=this.h)&&delete i[n]),this.j=new ti(this)}function oo(i){Wb.call(this),i.__headers__&&(this.headers=i.__headers__,this.statusCode=i.__status__,delete i.__headers__,delete i.__status__);var n=i.__sm__;if(n){t:{for(const o in n){i=o;break t}i=void 0}(this.i=i)&&(i=this.i,n=null!==n&&i in n?n[i]:void 0),this.data=n}else this.data=i}function ka(){Kb.call(this),this.status=1}function ti(i){this.g=i}function vo(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function w0(i,n,o){o||(o=0);var a=Array(16);if("string"==typeof n)for(var h=0;16>h;++h)a[h]=n.charCodeAt(o++)|n.charCodeAt(o++)<<8|n.charCodeAt(o++)<<16|n.charCodeAt(o++)<<24;else for(h=0;16>h;++h)a[h]=n[o++]|n[o++]<<8|n[o++]<<16|n[o++]<<24;var _=i.g[3],w=(n=i.g[0])+(_^(o=i.g[1])&((h=i.g[2])^_))+a[0]+3614090360&4294967295;w=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=(o=(h=(_=(n=o+(w<<7&4294967295|w>>>25))+((w=_+(h^n&(o^h))+a[1]+3905402710&4294967295)<<12&4294967295|w>>>20))+((w=h+(o^_&(n^o))+a[2]+606105819&4294967295)<<17&4294967295|w>>>15))+((w=o+(n^h&(_^n))+a[3]+3250441966&4294967295)<<22&4294967295|w>>>10))+((w=n+(_^o&(h^_))+a[4]+4118548399&4294967295)<<7&4294967295|w>>>25))+((w=_+(h^n&(o^h))+a[5]+1200080426&4294967295)<<12&4294967295|w>>>20))+((w=h+(o^_&(n^o))+a[6]+2821735955&4294967295)<<17&4294967295|w>>>15))+((w=o+(n^h&(_^n))+a[7]+4249261313&4294967295)<<22&4294967295|w>>>10))+((w=n+(_^o&(h^_))+a[8]+1770035416&4294967295)<<7&4294967295|w>>>25))+((w=_+(h^n&(o^h))+a[9]+2336552879&4294967295)<<12&4294967295|w>>>20))+((w=h+(o^_&(n^o))+a[10]+4294925233&4294967295)<<17&4294967295|w>>>15))+((w=o+(n^h&(_^n))+a[11]+2304563134&4294967295)<<22&4294967295|w>>>10))+((w=n+(_^o&(h^_))+a[12]+1804603682&4294967295)<<7&4294967295|w>>>25))+((w=_+(h^n&(o^h))+a[13]+4254626195&4294967295)<<12&4294967295|w>>>20))+((w=h+(o^_&(n^o))+a[14]+2792965006&4294967295)<<17&4294967295|w>>>15))+((w=o+(n^h&(_^n))+a[15]+1236535329&4294967295)<<22&4294967295|w>>>10))+((w=n+(h^_&(o^h))+a[1]+4129170786&4294967295)<<5&4294967295|w>>>27))+((w=_+(o^h&(n^o))+a[6]+3225465664&4294967295)<<9&4294967295|w>>>23))+((w=h+(n^o&(_^n))+a[11]+643717713&4294967295)<<14&4294967295|w>>>18))+((w=o+(_^n&(h^_))+a[0]+3921069994&4294967295)<<20&4294967295|w>>>12))+((w=n+(h^_&(o^h))+a[5]+3593408605&4294967295)<<5&4294967295|w>>>27))+((w=_+(o^h&(n^o))+a[10]+38016083&4294967295)<<9&4294967295|w>>>23))+((w=h+(n^o&(_^n))+a[15]+3634488961&4294967295)<<14&4294967295|w>>>18))+((w=o+(_^n&(h^_))+a[4]+3889429448&4294967295)<<20&4294967295|w>>>12))+((w=n+(h^_&(o^h))+a[9]+568446438&4294967295)<<5&4294967295|w>>>27))+((w=_+(o^h&(n^o))+a[14]+3275163606&4294967295)<<9&4294967295|w>>>23))+((w=h+(n^o&(_^n))+a[3]+4107603335&4294967295)<<14&4294967295|w>>>18))+((w=o+(_^n&(h^_))+a[8]+1163531501&4294967295)<<20&4294967295|w>>>12))+((w=n+(h^_&(o^h))+a[13]+2850285829&4294967295)<<5&4294967295|w>>>27))+((w=_+(o^h&(n^o))+a[2]+4243563512&4294967295)<<9&4294967295|w>>>23))+((w=h+(n^o&(_^n))+a[7]+1735328473&4294967295)<<14&4294967295|w>>>18))+((w=o+(_^n&(h^_))+a[12]+2368359562&4294967295)<<20&4294967295|w>>>12))+((w=n+(o^h^_)+a[5]+4294588738&4294967295)<<4&4294967295|w>>>28))+((w=_+(n^o^h)+a[8]+2272392833&4294967295)<<11&4294967295|w>>>21))+((w=h+(_^n^o)+a[11]+1839030562&4294967295)<<16&4294967295|w>>>16))+((w=o+(h^_^n)+a[14]+4259657740&4294967295)<<23&4294967295|w>>>9))+((w=n+(o^h^_)+a[1]+2763975236&4294967295)<<4&4294967295|w>>>28))+((w=_+(n^o^h)+a[4]+1272893353&4294967295)<<11&4294967295|w>>>21))+((w=h+(_^n^o)+a[7]+4139469664&4294967295)<<16&4294967295|w>>>16))+((w=o+(h^_^n)+a[10]+3200236656&4294967295)<<23&4294967295|w>>>9))+((w=n+(o^h^_)+a[13]+681279174&4294967295)<<4&4294967295|w>>>28))+((w=_+(n^o^h)+a[0]+3936430074&4294967295)<<11&4294967295|w>>>21))+((w=h+(_^n^o)+a[3]+3572445317&4294967295)<<16&4294967295|w>>>16))+((w=o+(h^_^n)+a[6]+76029189&4294967295)<<23&4294967295|w>>>9))+((w=n+(o^h^_)+a[9]+3654602809&4294967295)<<4&4294967295|w>>>28))+((w=_+(n^o^h)+a[12]+3873151461&4294967295)<<11&4294967295|w>>>21))+((w=h+(_^n^o)+a[15]+530742520&4294967295)<<16&4294967295|w>>>16))+((w=o+(h^_^n)+a[2]+3299628645&4294967295)<<23&4294967295|w>>>9))+((w=n+(h^(o|~_))+a[0]+4096336452&4294967295)<<6&4294967295|w>>>26))+((w=_+(o^(n|~h))+a[7]+1126891415&4294967295)<<10&4294967295|w>>>22))+((w=h+(n^(_|~o))+a[14]+2878612391&4294967295)<<15&4294967295|w>>>17))+((w=o+(_^(h|~n))+a[5]+4237533241&4294967295)<<21&4294967295|w>>>11))+((w=n+(h^(o|~_))+a[12]+1700485571&4294967295)<<6&4294967295|w>>>26))+((w=_+(o^(n|~h))+a[3]+2399980690&4294967295)<<10&4294967295|w>>>22))+((w=h+(n^(_|~o))+a[10]+4293915773&4294967295)<<15&4294967295|w>>>17))+((w=o+(_^(h|~n))+a[1]+2240044497&4294967295)<<21&4294967295|w>>>11))+((w=n+(h^(o|~_))+a[8]+1873313359&4294967295)<<6&4294967295|w>>>26))+((w=_+(o^(n|~h))+a[15]+4264355552&4294967295)<<10&4294967295|w>>>22))+((w=h+(n^(_|~o))+a[6]+2734768916&4294967295)<<15&4294967295|w>>>17))+((w=o+(_^(h|~n))+a[13]+1309151649&4294967295)<<21&4294967295|w>>>11))+((_=(n=o+((w=n+(h^(o|~_))+a[4]+4149444226&4294967295)<<6&4294967295|w>>>26))+((w=_+(o^(n|~h))+a[11]+3174756917&4294967295)<<10&4294967295|w>>>22))^((h=_+((w=h+(n^(_|~o))+a[2]+718787259&4294967295)<<15&4294967295|w>>>17))|~n))+a[9]+3951481745&4294967295,i.g[0]=i.g[0]+n&4294967295,i.g[1]=i.g[1]+(h+(w<<21&4294967295|w>>>11))&4294967295,i.g[2]=i.g[2]+h&4294967295,i.g[3]=i.g[3]+_&4294967295}function go(i,n){this.h=n;for(var o=[],a=!0,h=i.length-1;0<=h;h--){var _=0|i[h];a&&_==n||(o[h]=_,a=!1)}this.g=o}(an=Po.prototype).Oa=function(i){this.M=i},an.ha=function(i,n,o,a){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+i);n=n?n.toUpperCase():"GET",this.I=i,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Yb.g(),this.C=function qb(i){return i.h||(i.h=i.i())}(this.u?this.u:Yb),this.g.onreadystatechange=Qo(this.La,this);try{this.G=!0,this.g.open(n,String(i),!0),this.G=!1}catch(_){return void g0(this,_)}if(i=o||"",o=new Map(this.headers),a)if(Object.getPrototypeOf(a)===Object.prototype)for(var h in a)o.set(h,a[h]);else{if("function"!=typeof a.keys||"function"!=typeof a.get)throw Error("Unknown input type for opt_headers: "+String(a));for(const _ of a.keys())o.set(_,a.get(_))}a=Array.from(o.keys()).find(_=>"content-type"==_.toLowerCase()),h=pr.FormData&&i instanceof pr.FormData,!(0<=ww(s1,n))||a||h||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_,w]of o)this.g.setRequestHeader(_,w);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{af(this),0<this.B&&((this.L=function a1(i){return Tg&&"number"==typeof i.timeout&&void 0!==i.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Qo(this.ua,this)):this.A=C_(this.ua,this.B,this)),this.v=!0,this.g.send(i),this.v=!1}catch(_){g0(this,_)}},an.ua=function(){typeof Ol<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Js(this,"timeout"),this.abort(8))},an.abort=function(i){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=i||7,Js(this,"complete"),Js(this,"abort"),ra(this))},an.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ra(this,!0)),Po.$.N.call(this)},an.La=function(){this.s||(this.G||this.v||this.l?A_(this):this.kb())},an.kb=function(){A_(this)},an.isActive=function(){return!!this.g},an.da=function(){try{return 2<ll(this)?this.g.status:-1}catch{return-1}},an.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}},an.Wa=function(i){if(this.g){var n=this.g.responseText;return i&&0==n.indexOf(i)&&(n=n.substring(i.length)),kw(n)}},an.Ia=function(){return this.m},an.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(an=c1.prototype).ra=8,an.H=1,an.Na=function(i){if(this.m)if(this.m=null,1==this.H){if(!i){this.W=Math.floor(1e5*Math.random()),i=this.W++;const h=new Zn(this,this.l,i);let _=this.s;if(this.U&&(_?(_=qn(_),Fu(_,this.U)):_=this.U),null!==this.o||this.O||(h.I=_,_=null),this.P)t:{for(var n=0,o=0;o<this.j.length;o++){var a=this.j[o];if(void 0===(a="__data__"in a.map&&"string"==typeof(a=a.map.__data__)?a.length:void 0))break;if(4096<(n+=a)){n=o;break t}if(4096===n||o===this.j.length-1){n=o+1;break t}}n=1e3}else n=1e3;n=Lg(this,h,n),So(o=bt(this.I),"RID",i),So(o,"CVER",22),this.F&&So(o,"X-HTTP-Session-Id",this.F),Vu(this,o),_&&(this.O?n="headers="+encodeURIComponent(String(D_(_)))+"&"+n:this.o&&Op(o,this.o,_)),sc(this.i,h),this.bb&&So(o,"TYPE","init"),this.P?(So(o,"$req",n),So(o,"SID","null"),h.aa=!0,l0(h,o,null)):l0(h,o,n),this.H=2}}else 3==this.H&&(i?kP(this,i):0==this.j.length||SP(this.i)||kP(this))},an.Ma=function(){if(this.u=null,RP(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var i=2*this.S;this.l.info("BP detection timer enabled: "+i),this.B=ms(Qo(this.jb,this),i)}},an.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Dn(10),Pi(this),RP(this))},an.ib=function(){null!=this.v&&(this.v=null,Pi(this),v0(this),Dn(19))},an.pb=function(i){i?(this.l.info("Successfully pinged google.com"),Dn(2)):(this.l.info("Failed to ping google.com"),Dn(1))},an.isActive=function(){return!!this.h&&this.h.isActive(this)},(an=x0.prototype).Ba=function(){},an.Aa=function(){},an.za=function(){},an.ya=function(){},an.isActive=function(){return!0},an.Va=function(){},yi.prototype.g=function(i,n){return new Oo(i,n)},co(Oo,Fs),Oo.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var i=this.g,n=this.l,o=this.h||void 0;Dn(0),i.Y=n,i.na=o||{},i.G=i.aa,i.I=h1(i,null,i.Y),m0(i)},Oo.prototype.close=function(){u1(this.g)},Oo.prototype.u=function(i){var n=this.g;if("string"==typeof i){var o={};o.__data__=i,i=o}else this.v&&((o={}).__data__=Nb(i),i=o);n.j.push(new class{constructor(i,n){this.g=i,this.map=n}}(n.fb++,i)),3==n.H&&m0(n)},Oo.prototype.N=function(){this.g.h=null,delete this.j,u1(this.g),delete this.g,Oo.$.N.call(this)},co(oo,Wb),co(ka,Kb),co(ti,x0),ti.prototype.Ba=function(){Js(this.g,"a")},ti.prototype.Aa=function(i){Js(this.g,new oo(i))},ti.prototype.za=function(i){Js(this.g,new ka)},ti.prototype.ya=function(){Js(this.g,"b")},co(vo,function LP(){this.blockSize=-1}),vo.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},vo.prototype.j=function(i,n){void 0===n&&(n=i.length);for(var o=n-this.blockSize,a=this.m,h=this.h,_=0;_<n;){if(0==h)for(;_<=o;)w0(this,i,_),_+=this.blockSize;if("string"==typeof i){for(;_<n;)if(a[h++]=i.charCodeAt(_++),h==this.blockSize){w0(this,a),h=0;break}}else for(;_<n;)if(a[h++]=i[_++],h==this.blockSize){w0(this,a),h=0;break}}this.h=h,this.i+=n},vo.prototype.l=function(){var i=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);i[0]=128;for(var n=1;n<i.length-8;++n)i[n]=0;var o=8*this.i;for(n=i.length-8;n<i.length;++n)i[n]=255&o,o/=256;for(this.j(i),i=Array(16),n=o=0;4>n;++n)for(var a=0;32>a;a+=8)i[o++]=this.g[n]>>>a&255;return i};var ac={};function Tp(i){return-128<=i&&128>i?function Tb(i,n){var o=ac;return Object.prototype.hasOwnProperty.call(o,i)?o[i]:o[i]=n(i)}(i,function(n){return new go([0|n],0>n?-1:0)}):new go([0|i],0>i?-1:0)}function Xn(i){if(isNaN(i)||!isFinite(i))return Vd;if(0>i)return Eo(Xn(-i));for(var n=[],o=1,a=0;i>=o;a++)n[a]=i/o|0,o*=ju;return new go(n,0)}var ju=4294967296,Vd=Tp(0),Fw=Tp(1),zw=Tp(16777216);function jd(i){if(0!=i.h)return!1;for(var n=0;n<i.g.length;n++)if(0!=i.g[n])return!1;return!0}function Tl(i){return-1==i.h}function Eo(i){for(var n=i.g.length,o=[],a=0;a<n;a++)o[a]=~i.g[a];return new go(o,~i.h).add(Fw)}function jc(i,n){return i.add(Eo(n))}function Ng(i,n){for(;(65535&i[n])!=i[n];)i[n+1]+=i[n]>>>16,i[n]&=65535,n++}function Fg(i,n){this.g=i,this.h=n}function Wi(i,n){if(jd(n))throw Error("division by zero");if(jd(i))return new Fg(Vd,Vd);if(Tl(i))return n=Wi(Eo(i),n),new Fg(Eo(n.g),Eo(n.h));if(Tl(n))return n=Wi(i,Eo(n)),new Fg(Eo(n.g),n.h);if(30<i.g.length){if(Tl(i)||Tl(n))throw Error("slowDivide_ only works with positive integers.");for(var o=Fw,a=n;0>=a.X(i);)o=Bw(o),a=Bw(a);var h=Ip(o,1),_=Ip(a,1);for(a=Ip(a,2),o=Ip(o,2);!jd(a);){var w=_.add(a);0>=w.X(i)&&(h=h.add(o),_=w),a=Ip(a,1),o=Ip(o,1)}return n=jc(i,h.R(n)),new Fg(h,n)}for(h=Vd;0<=i.X(n);){for(o=Math.max(1,Math.floor(i.ea()/n.ea())),a=48>=(a=Math.ceil(Math.log(o)/Math.LN2))?1:Math.pow(2,a-48),w=(_=Xn(o)).R(n);Tl(w)||0<w.X(i);)w=(_=Xn(o-=a)).R(n);jd(_)&&(_=Fw),h=h.add(_),i=jc(i,w)}return new Fg(h,i)}function Bw(i){for(var n=i.g.length+1,o=[],a=0;a<n;a++)o[a]=i.D(a)<<1|i.D(a-1)>>>31;return new go(o,i.h)}function Ip(i,n){var o=n>>5;n%=32;for(var a=i.g.length-o,h=[],_=0;_<a;_++)h[_]=0<n?i.D(_+o)>>>n|i.D(_+o+1)<<32-n:i.D(_+o);return new go(h,i.h)}(an=go.prototype).ea=function(){if(Tl(this))return-Eo(this).ea();for(var i=0,n=1,o=0;o<this.g.length;o++){var a=this.D(o);i+=(0<=a?a:ju+a)*n,n*=ju}return i},an.toString=function(i){if(2>(i=i||10)||36<i)throw Error("radix out of range: "+i);if(jd(this))return"0";if(Tl(this))return"-"+Eo(this).toString(i);for(var n=Xn(Math.pow(i,6)),o=this,a="";;){var h=Wi(o,n).g,_=((0<(o=jc(o,h.R(n))).g.length?o.g[0]:o.h)>>>0).toString(i);if(jd(o=h))return _+a;for(;6>_.length;)_="0"+_;a=_+a}},an.D=function(i){return 0>i?0:i<this.g.length?this.g[i]:this.h},an.X=function(i){return Tl(i=jc(this,i))?-1:jd(i)?0:1},an.abs=function(){return Tl(this)?Eo(this):this},an.add=function(i){for(var n=Math.max(this.g.length,i.g.length),o=[],a=0,h=0;h<=n;h++){var _=a+(65535&this.D(h))+(65535&i.D(h)),w=(_>>>16)+(this.D(h)>>>16)+(i.D(h)>>>16);a=w>>>16,o[h]=(w&=65535)<<16|(_&=65535)}return new go(o,-2147483648&o[o.length-1]?-1:0)},an.R=function(i){if(jd(this)||jd(i))return Vd;if(Tl(this))return Tl(i)?Eo(this).R(Eo(i)):Eo(Eo(this).R(i));if(Tl(i))return Eo(this.R(Eo(i)));if(0>this.X(zw)&&0>i.X(zw))return Xn(this.ea()*i.ea());for(var n=this.g.length+i.g.length,o=[],a=0;a<2*n;a++)o[a]=0;for(a=0;a<this.g.length;a++)for(var h=0;h<i.g.length;h++){var _=this.D(a)>>>16,w=65535&this.D(a),S=i.D(h)>>>16,L=65535&i.D(h);o[2*a+2*h]+=w*L,Ng(o,2*a+2*h),o[2*a+2*h+1]+=_*L,Ng(o,2*a+2*h+1),o[2*a+2*h+1]+=w*S,Ng(o,2*a+2*h+1),o[2*a+2*h+2]+=_*S,Ng(o,2*a+2*h+2)}for(a=0;a<n;a++)o[a]=o[2*a+1]<<16|o[2*a];for(a=n;a<2*n;a++)o[a]=0;return new go(o,0)},an.gb=function(i){return Wi(this,i).h},an.and=function(i){for(var n=Math.max(this.g.length,i.g.length),o=[],a=0;a<n;a++)o[a]=this.D(a)&i.D(a);return new go(o,this.h&i.h)},an.or=function(i){for(var n=Math.max(this.g.length,i.g.length),o=[],a=0;a<n;a++)o[a]=this.D(a)|i.D(a);return new go(o,this.h|i.h)},an.xor=function(i){for(var n=Math.max(this.g.length,i.g.length),o=[],a=0;a<n;a++)o[a]=this.D(a)^i.D(a);return new go(o,this.h^i.h)},yi.prototype.createWebChannel=yi.prototype.g,Oo.prototype.send=Oo.prototype.u,Oo.prototype.open=Oo.prototype.m,Oo.prototype.close=Oo.prototype.close,Uc.NO_ERROR=0,Uc.TIMEOUT=8,Uc.HTTP_ERROR=6,bp.COMPLETE="complete",Zb.EventType=Sg,Sg.OPEN="a",Sg.CLOSE="b",Sg.ERROR="c",Sg.MESSAGE="d",Fs.prototype.listen=Fs.prototype.O,Po.prototype.listenOnce=Po.prototype.P,Po.prototype.getLastError=Po.prototype.Sa,Po.prototype.getLastErrorCode=Po.prototype.Ia,Po.prototype.getStatus=Po.prototype.da,Po.prototype.getResponseJson=Po.prototype.Wa,Po.prototype.getResponseText=Po.prototype.ja,Po.prototype.send=Po.prototype.ha,Po.prototype.setWithCredentials=Po.prototype.Oa,vo.prototype.digest=vo.prototype.l,vo.prototype.reset=vo.prototype.reset,vo.prototype.update=vo.prototype.j,go.prototype.add=go.prototype.add,go.prototype.multiply=go.prototype.R,go.prototype.modulo=go.prototype.gb,go.prototype.compare=go.prototype.X,go.prototype.toNumber=go.prototype.ea,go.prototype.toString=go.prototype.toString,go.prototype.getBits=go.prototype.D,go.fromNumber=Xn,go.fromString=function R_(i,n){if(0==i.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==i.charAt(0))return Eo(R_(i.substring(1),n));if(0<=i.indexOf("-"))throw Error('number format error: interior "-" character');for(var o=Xn(Math.pow(n,8)),a=Vd,h=0;h<i.length;h+=8){var _=Math.min(8,i.length-h),w=parseInt(i.substring(h,h+_),n);8>_?(_=Xn(Math.pow(n,_)),a=a.R(_).add(Xn(w))):a=(a=a.R(o)).add(Xn(w))}return a};var NP=Sa.createWebChannelTransport=function(){return new yi},ET=Sa.getStatEventTarget=function(){return P_()},zg=Sa.ErrorCode=Uc,FP=Sa.EventType=bp,f1=Sa.Event=vp,Uw=Sa.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Vw=Sa.FetchXmlHttpFactory=na,$c=Sa.WebChannel=Zb,zP=Sa.XhrIo=Po,BP=Sa.Md5=vo,$u=Sa.Integer=go;const C0="@firebase/firestore";class ai{constructor(n){this.uid=n}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(n){return n.uid===this.uid}}ai.UNAUTHENTICATED=new ai(null),ai.GOOGLE_CREDENTIALS=new ai("google-credentials-uid"),ai.FIRST_PARTY=new ai("first-party-uid"),ai.MOCK_USER=new ai("mock-user");let _a="9.23.0";const Il=new Kl.Yd("@firebase/firestore");function p1(){return Il.logLevel}function ze(i,...n){if(Il.logLevel<=Kl.in.DEBUG){const o=n.map(Sp);Il.debug(`Firestore (${_a}): ${i}`,...o)}}function rs(i,...n){if(Il.logLevel<=Kl.in.ERROR){const o=n.map(Sp);Il.error(`Firestore (${_a}): ${i}`,...o)}}function lc(i,...n){if(Il.logLevel<=Kl.in.WARN){const o=n.map(Sp);Il.warn(`Firestore (${_a}): ${i}`,...o)}}function Sp(i){if("string"==typeof i)return i;try{return JSON.stringify(i)}catch{return i}}function wn(i="Unexpected state"){const n=`FIRESTORE (${_a}) INTERNAL ASSERTION FAILED: `+i;throw rs(n),new Error(n)}function $n(i,n){i||wn()}function _n(i,n){return i}const Jt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends $r.ZR{constructor(n,o){super(n,o),this.code=n,this.message=o,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ss{constructor(){this.promise=new Promise((n,o)=>{this.resolve=n,this.reject=o})}}class g1{constructor(n,o){this.user=o,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${n}`)}}class VP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(n,o){n.enqueueRetryable(()=>o(ai.UNAUTHENTICATED))}shutdown(){}}class cf{constructor(n){this.token=n,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(n,o){this.changeListener=o,n.enqueueRetryable(()=>o(this.token.user))}shutdown(){this.changeListener=null}}class Ui{constructor(n){this.t=n,this.currentUser=ai.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(n,o){var a=this;let h=this.i;const _=B=>this.i!==h?(h=this.i,o(B)):Promise.resolve();let w=new Ss;this.o=()=>{this.i++,this.currentUser=this.u(),w.resolve(),w=new Ss,n.enqueueRetryable(()=>_(this.currentUser))};const S=()=>{const B=w;n.enqueueRetryable((0,Je.Z)(function*(){yield B.promise,yield _(a.currentUser)}))},L=B=>{ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=B,this.auth.addAuthTokenListener(this.o),S()};this.t.onInit(B=>L(B)),setTimeout(()=>{if(!this.auth){const B=this.t.getImmediate({optional:!0});B?L(B):(ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),w.resolve(),w=new Ss)}},0),S()}getToken(){const n=this.i,o=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(o).then(a=>this.i!==n?(ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?($n("string"==typeof a.accessToken),new g1(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const n=this.auth&&this.auth.getUid();return $n(null===n||"string"==typeof n),new ai(n)}}class TT{constructor(n,o,a){this.h=n,this.l=o,this.m=a,this.type="FirstParty",this.user=ai.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const n=this.p();return n&&this.g.set("Authorization",n),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class jP{constructor(n,o,a){this.h=n,this.l=o,this.m=a}getToken(){return Promise.resolve(new TT(this.h,this.l,this.m))}start(n,o){n.enqueueRetryable(()=>o(ai.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class jw{constructor(n){this.value=n,this.type="AppCheck",this.headers=new Map,n&&n.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $w{constructor(n){this.I=n,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(n,o){const a=_=>{null!=_.error&&ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${_.error.message}`);const w=_.token!==this.T;return this.T=_.token,ze("FirebaseAppCheckTokenProvider",`Received ${w?"new":"existing"} token.`),w?o(_.token):Promise.resolve()};this.o=_=>{n.enqueueRetryable(()=>a(_))};const h=_=>{ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=_,this.appCheck.addTokenListener(this.o)};this.I.onInit(_=>h(_)),setTimeout(()=>{if(!this.appCheck){const _=this.I.getImmediate({optional:!0});_?h(_):ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const n=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(n).then(o=>o?($n("string"==typeof o.token),this.T=o.token,new jw(o.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function $P(i){const n=typeof self<"u"&&(self.crypto||self.msCrypto),o=new Uint8Array(i);if(n&&"function"==typeof n.getRandomValues)n.getRandomValues(o);else for(let a=0;a<i;a++)o[a]=Math.floor(256*Math.random());return o}class Hw{static A(){const o=62*Math.floor(256/62);let a="";for(;a.length<20;){const h=$P(40);for(let _=0;_<h.length;++_)a.length<20&&h[_]<o&&(a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(h[_]%62))}return a}}function Br(i,n){return i<n?-1:i>n?1:0}function uf(i,n,o){return i.length===n.length&&i.every((a,h)=>o(a,n[h]))}class An{constructor(n,o){if(this.seconds=n,this.nanoseconds=o,o<0)throw new Se(Jt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+o);if(o>=1e9)throw new Se(Jt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+o);if(n<-62135596800)throw new Se(Jt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n);if(n>=253402300800)throw new Se(Jt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n)}static now(){return An.fromMillis(Date.now())}static fromDate(n){return An.fromMillis(n.getTime())}static fromMillis(n){const o=Math.floor(n/1e3),a=Math.floor(1e6*(n-1e3*o));return new An(o,a)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(n){return this.seconds===n.seconds?Br(this.nanoseconds,n.nanoseconds):Br(this.seconds,n.seconds)}isEqual(n){return n.seconds===this.seconds&&n.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Rn{constructor(n){this.timestamp=n}static fromTimestamp(n){return new Rn(n)}static min(){return new Rn(new An(0,0))}static max(){return new Rn(new An(253402300799,999999999))}compareTo(n){return this.timestamp._compareTo(n.timestamp)}isEqual(n){return this.timestamp.isEqual(n.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class $d{constructor(n,o,a){void 0===o?o=0:o>n.length&&wn(),void 0===a?a=n.length-o:a>n.length-o&&wn(),this.segments=n,this.offset=o,this.len=a}get length(){return this.len}isEqual(n){return 0===$d.comparator(this,n)}child(n){const o=this.segments.slice(this.offset,this.limit());return n instanceof $d?n.forEach(a=>{o.push(a)}):o.push(n),this.construct(o)}limit(){return this.offset+this.length}popFirst(n){return this.construct(this.segments,this.offset+(n=void 0===n?1:n),this.length-n)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(n){return this.segments[this.offset+n]}isEmpty(){return 0===this.length}isPrefixOf(n){if(n.length<this.length)return!1;for(let o=0;o<this.length;o++)if(this.get(o)!==n.get(o))return!1;return!0}isImmediateParentOf(n){if(this.length+1!==n.length)return!1;for(let o=0;o<this.length;o++)if(this.get(o)!==n.get(o))return!1;return!0}forEach(n){for(let o=this.offset,a=this.limit();o<a;o++)n(this.segments[o])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(n,o){const a=Math.min(n.length,o.length);for(let h=0;h<a;h++){const _=n.get(h),w=o.get(h);if(_<w)return-1;if(_>w)return 1}return n.length<o.length?-1:n.length>o.length?1:0}}class io extends $d{construct(n,o,a){return new io(n,o,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...n){const o=[];for(const a of n){if(a.indexOf("//")>=0)throw new Se(Jt.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);o.push(...a.split("/").filter(h=>h.length>0))}return new io(o)}static emptyPath(){return new io([])}}const GP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class _s extends $d{construct(n,o,a){return new _s(n,o,a)}static isValidIdentifier(n){return GP.test(n)}canonicalString(){return this.toArray().map(n=>(n=n.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_s.isValidIdentifier(n)||(n="`"+n+"`"),n)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new _s(["__name__"])}static fromServerFormat(n){const o=[];let a="",h=0;const _=()=>{if(0===a.length)throw new Se(Jt.INVALID_ARGUMENT,`Invalid field path (${n}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);o.push(a),a=""};let w=!1;for(;h<n.length;){const S=n[h];if("\\"===S){if(h+1===n.length)throw new Se(Jt.INVALID_ARGUMENT,"Path has trailing escape character: "+n);const L=n[h+1];if("\\"!==L&&"."!==L&&"`"!==L)throw new Se(Jt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+n);a+=L,h+=2}else"`"===S?(w=!w,h++):"."!==S||w?(a+=S,h++):(_(),h++)}if(_(),w)throw new Se(Jt.INVALID_ARGUMENT,"Unterminated ` in path: "+n);return new _s(o)}static emptyPath(){return new _s([])}}class hn{constructor(n){this.path=n}static fromPath(n){return new hn(io.fromString(n))}static fromName(n){return new hn(io.fromString(n).popFirst(5))}static empty(){return new hn(io.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(n){return this.path.length>=2&&this.path.get(this.path.length-2)===n}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(n){return null!==n&&0===io.comparator(this.path,n.path)}toString(){return this.path.toString()}static comparator(n,o){return io.comparator(n.path,o.path)}static isDocumentKey(n){return n.length%2==0}static fromSegments(n){return new hn(new io(n.slice()))}}function Ug(i){return new Sl(i.readTime,i.key,-1)}class Sl{constructor(n,o,a){this.readTime=n,this.documentKey=o,this.largestBatchId=a}static min(){return new Sl(Rn.min(),hn.empty(),-1)}static max(){return new Sl(Rn.max(),hn.empty(),-1)}}function F_(i,n){let o=i.readTime.compareTo(n.readTime);return 0!==o?o:(o=hn.comparator(i.documentKey,n.documentKey),0!==o?o:Br(i.largestBatchId,n.largestBatchId))}const P0="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class z_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(n){this.onCommittedListeners.push(n)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(n=>n())}}function hf(i){return _1.apply(this,arguments)}function _1(){return _1=(0,Je.Z)(function*(i){if(i.code!==Jt.FAILED_PRECONDITION||i.message!==P0)throw i;ze("LocalStore","Unexpectedly lost primary lease")}),_1.apply(this,arguments)}class qt{constructor(n){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,n(o=>{this.isDone=!0,this.result=o,this.nextCallback&&this.nextCallback(o)},o=>{this.isDone=!0,this.error=o,this.catchCallback&&this.catchCallback(o)})}catch(n){return this.next(void 0,n)}next(n,o){return this.callbackAttached&&wn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(o,this.error):this.wrapSuccess(n,this.result):new qt((a,h)=>{this.nextCallback=_=>{this.wrapSuccess(n,_).next(a,h)},this.catchCallback=_=>{this.wrapFailure(o,_).next(a,h)}})}toPromise(){return new Promise((n,o)=>{this.next(n,o)})}wrapUserFunction(n){try{const o=n();return o instanceof qt?o:qt.resolve(o)}catch(o){return qt.reject(o)}}wrapSuccess(n,o){return n?this.wrapUserFunction(()=>n(o)):qt.resolve(o)}wrapFailure(n,o){return n?this.wrapUserFunction(()=>n(o)):qt.reject(o)}static resolve(n){return new qt((o,a)=>{o(n)})}static reject(n){return new qt((o,a)=>{a(n)})}static waitFor(n){return new qt((o,a)=>{let h=0,_=0,w=!1;n.forEach(S=>{++h,S.next(()=>{++_,w&&_===h&&o()},L=>a(L))}),w=!0,_===h&&o()})}static or(n){let o=qt.resolve(!1);for(const a of n)o=o.next(h=>h?qt.resolve(h):a());return o}static forEach(n,o){const a=[];return n.forEach((h,_)=>{a.push(o.call(this,h,_))}),this.waitFor(a)}static mapArray(n,o){return new qt((a,h)=>{const _=n.length,w=new Array(_);let S=0;for(let L=0;L<_;L++){const B=L;o(n[B]).next(H=>{w[B]=H,++S,S===_&&a(w)},H=>h(H))}})}static doWhile(n,o){return new qt((a,h)=>{const _=()=>{!0===n()?o().next(()=>{_()},h):a()};_()})}}function Dp(i){return"IndexedDbTransactionError"===i.name}let cc=(()=>{class i{constructor(o,a){this.previousValue=o,a&&(a.sequenceNumberHandler=h=>this.ot(h),this.ut=h=>a.writeSequenceNumber(h))}ot(o){return this.previousValue=Math.max(o,this.previousValue),this.previousValue}next(){const o=++this.previousValue;return this.ut&&this.ut(o),o}}return i.ct=-1,i})();function T0(i){return null==i}function I0(i){return 0===i&&1/i==-1/0}function KP(i){let n=0;for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&n++;return n}function Zu(i,n){for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&n(o,i[o])}function U_(i){for(const n in i)if(Object.prototype.hasOwnProperty.call(i,n))return!1;return!0}class ci{constructor(n,o){this.comparator=n,this.root=o||La.EMPTY}insert(n,o){return new ci(this.comparator,this.root.insert(n,o,this.comparator).copy(null,null,La.BLACK,null,null))}remove(n){return new ci(this.comparator,this.root.remove(n,this.comparator).copy(null,null,La.BLACK,null,null))}get(n){let o=this.root;for(;!o.isEmpty();){const a=this.comparator(n,o.key);if(0===a)return o.value;a<0?o=o.left:a>0&&(o=o.right)}return null}indexOf(n){let o=0,a=this.root;for(;!a.isEmpty();){const h=this.comparator(n,a.key);if(0===h)return o+a.left.size;h<0?a=a.left:(o+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(n){return this.root.inorderTraversal(n)}forEach(n){this.inorderTraversal((o,a)=>(n(o,a),!1))}toString(){const n=[];return this.inorderTraversal((o,a)=>(n.push(`${o}:${a}`),!1)),`{${n.join(", ")}}`}reverseTraversal(n){return this.root.reverseTraversal(n)}getIterator(){return new Hg(this.root,null,this.comparator,!1)}getIteratorFrom(n){return new Hg(this.root,n,this.comparator,!1)}getReverseIterator(){return new Hg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(n){return new Hg(this.root,n,this.comparator,!0)}}class Hg{constructor(n,o,a,h){this.isReverse=h,this.nodeStack=[];let _=1;for(;!n.isEmpty();)if(_=o?a(n.key,o):1,o&&h&&(_*=-1),_<0)n=this.isReverse?n.left:n.right;else{if(0===_){this.nodeStack.push(n);break}this.nodeStack.push(n),n=this.isReverse?n.right:n.left}}getNext(){let n=this.nodeStack.pop();const o={key:n.key,value:n.value};if(this.isReverse)for(n=n.left;!n.isEmpty();)this.nodeStack.push(n),n=n.right;else for(n=n.right;!n.isEmpty();)this.nodeStack.push(n),n=n.left;return o}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const n=this.nodeStack[this.nodeStack.length-1];return{key:n.key,value:n.value}}}class La{constructor(n,o,a,h,_){this.key=n,this.value=o,this.color=a??La.RED,this.left=h??La.EMPTY,this.right=_??La.EMPTY,this.size=this.left.size+1+this.right.size}copy(n,o,a,h,_){return new La(n??this.key,o??this.value,a??this.color,h??this.left,_??this.right)}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,o,a){let h=this;const _=a(n,h.key);return h=_<0?h.copy(null,null,null,h.left.insert(n,o,a),null):0===_?h.copy(null,o,null,null,null):h.copy(null,null,null,null,h.right.insert(n,o,a)),h.fixUp()}removeMin(){if(this.left.isEmpty())return La.EMPTY;let n=this;return n.left.isRed()||n.left.left.isRed()||(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.removeMin(),null),n.fixUp()}remove(n,o){let a,h=this;if(o(n,h.key)<0)h.left.isEmpty()||h.left.isRed()||h.left.left.isRed()||(h=h.moveRedLeft()),h=h.copy(null,null,null,h.left.remove(n,o),null);else{if(h.left.isRed()&&(h=h.rotateRight()),h.right.isEmpty()||h.right.isRed()||h.right.left.isRed()||(h=h.moveRedRight()),0===o(n,h.key)){if(h.right.isEmpty())return La.EMPTY;a=h.right.min(),h=h.copy(a.key,a.value,null,null,h.right.removeMin())}h=h.copy(null,null,null,null,h.right.remove(n,o))}return h.fixUp()}isRed(){return this.color}fixUp(){let n=this;return n.right.isRed()&&!n.left.isRed()&&(n=n.rotateLeft()),n.left.isRed()&&n.left.left.isRed()&&(n=n.rotateRight()),n.left.isRed()&&n.right.isRed()&&(n=n.colorFlip()),n}moveRedLeft(){let n=this.colorFlip();return n.right.left.isRed()&&(n=n.copy(null,null,null,null,n.right.rotateRight()),n=n.rotateLeft(),n=n.colorFlip()),n}moveRedRight(){let n=this.colorFlip();return n.left.left.isRed()&&(n=n.rotateRight(),n=n.colorFlip()),n}rotateLeft(){const n=this.copy(null,null,La.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight(){const n=this.copy(null,null,La.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip(){const n=this.left.copy(null,null,!this.left.color,null,null),o=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,o)}checkMaxDepth(){const n=this.check();return Math.pow(2,n)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw wn();const n=this.left.check();if(n!==this.right.check())throw wn();return n+(this.isRed()?0:1)}}La.EMPTY=null,La.RED=!0,La.BLACK=!1,La.EMPTY=new class{constructor(){this.size=0}get key(){throw wn()}get value(){throw wn()}get color(){throw wn()}get left(){throw wn()}get right(){throw wn()}copy(i,n,o,a,h){return this}insert(i,n,o){return new La(i,n)}remove(i,n){return this}isEmpty(){return!0}inorderTraversal(i){return!1}reverseTraversal(i){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ei{constructor(n){this.comparator=n,this.data=new ci(this.comparator)}has(n){return null!==this.data.get(n)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(n){return this.data.indexOf(n)}forEach(n){this.data.inorderTraversal((o,a)=>(n(o),!1))}forEachInRange(n,o){const a=this.data.getIteratorFrom(n[0]);for(;a.hasNext();){const h=a.getNext();if(this.comparator(h.key,n[1])>=0)return;o(h.key)}}forEachWhile(n,o){let a;for(a=void 0!==o?this.data.getIteratorFrom(o):this.data.getIterator();a.hasNext();)if(!n(a.getNext().key))return}firstAfterOrEqual(n){const o=this.data.getIteratorFrom(n);return o.hasNext()?o.getNext().key:null}getIterator(){return new V_(this.data.getIterator())}getIteratorFrom(n){return new V_(this.data.getIteratorFrom(n))}add(n){return this.copy(this.data.remove(n).insert(n,!0))}delete(n){return this.has(n)?this.copy(this.data.remove(n)):this}isEmpty(){return this.data.isEmpty()}unionWith(n){let o=this;return o.size<n.size&&(o=n,n=this),n.forEach(a=>{o=o.add(a)}),o}isEqual(n){if(!(n instanceof Ei)||this.size!==n.size)return!1;const o=this.data.getIterator(),a=n.data.getIterator();for(;o.hasNext();){const h=o.getNext().key,_=a.getNext().key;if(0!==this.comparator(h,_))return!1}return!0}toArray(){const n=[];return this.forEach(o=>{n.push(o)}),n}toString(){const n=[];return this.forEach(o=>n.push(o)),"SortedSet("+n.toString()+")"}copy(n){const o=new Ei(this.comparator);return o.data=n,o}}class V_{constructor(n){this.iter=n}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ul{constructor(n){this.fields=n,n.sort(_s.comparator)}static empty(){return new ul([])}unionWith(n){let o=new Ei(_s.comparator);for(const a of this.fields)o=o.add(a);for(const a of n)o=o.add(a);return new ul(o.toArray())}covers(n){for(const o of this.fields)if(o.isPrefixOf(n))return!0;return!1}isEqual(n){return uf(this.fields,n.fields,(o,a)=>o.isEqual(a))}}class k0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ys{constructor(n){this.binaryString=n}static fromBase64String(n){const o=function(a){try{return atob(a)}catch(h){throw typeof DOMException<"u"&&h instanceof DOMException?new k0("Invalid base64 string: "+h):h}}(n);return new ys(o)}static fromUint8Array(n){const o=function(a){let h="";for(let _=0;_<a.length;++_)h+=String.fromCharCode(a[_]);return h}(n);return new ys(o)}[Symbol.iterator](){let n=0;return{next:()=>n<this.binaryString.length?{value:this.binaryString.charCodeAt(n++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(n){const o=new Uint8Array(n.length);for(let a=0;a<n.length;a++)o[a]=n.charCodeAt(a);return o}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(n){return Br(this.binaryString,n.binaryString)}isEqual(n){return this.binaryString===n.binaryString}}ys.EMPTY_BYTE_STRING=new ys("");const R0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pf(i){if($n(!!i),"string"==typeof i){let n=0;const o=R0.exec(i);if($n(!!o),o[1]){let h=o[1];h=(h+"000000000").substr(0,9),n=Number(h)}const a=new Date(i);return{seconds:Math.floor(a.getTime()/1e3),nanos:n}}return{seconds:Vi(i.seconds),nanos:Vi(i.nanos)}}function Vi(i){return"number"==typeof i?i:"string"==typeof i?Number(i):0}function Wu(i){return"string"==typeof i?ys.fromBase64String(i):ys.fromUint8Array(i)}function L0(i){var n,o;return"server_timestamp"===(null===(o=((null===(n=i?.mapValue)||void 0===n?void 0:n.fields)||{}).__type__)||void 0===o?void 0:o.stringValue)}function N0(i){const n=i.mapValue.fields.__previous_value__;return L0(n)?N0(n):n}function qd(i){const n=pf(i.mapValue.fields.__local_write_time__.timestampValue);return new An(n.seconds,n.nanos)}class YP{constructor(n,o,a,h,_,w,S,L,B){this.databaseId=n,this.appId=o,this.persistenceKey=a,this.host=h,this.ssl=_,this.forceLongPolling=w,this.autoDetectLongPolling=S,this.longPollingOptions=L,this.useFetchStreams=B}}class Dl{constructor(n,o){this.projectId=n,this.database=o||"(default)"}static empty(){return new Dl("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(n){return n instanceof Dl&&n.projectId===this.projectId&&n.database===this.database}}const kp={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Rp(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?L0(i)?4:Qw(i)?9007199254740991:10:wn()}function uc(i,n){if(i===n)return!0;const o=Rp(i);if(o!==Rp(n))return!1;switch(o){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===n.booleanValue;case 4:return qd(i).isEqual(qd(n));case 3:return function(a,h){if("string"==typeof a.timestampValue&&"string"==typeof h.timestampValue&&a.timestampValue.length===h.timestampValue.length)return a.timestampValue===h.timestampValue;const _=pf(a.timestampValue),w=pf(h.timestampValue);return _.seconds===w.seconds&&_.nanos===w.nanos}(i,n);case 5:return i.stringValue===n.stringValue;case 6:return h=n,Wu(i.bytesValue).isEqual(Wu(h.bytesValue));case 7:return i.referenceValue===n.referenceValue;case 8:return function(a,h){return Vi(a.geoPointValue.latitude)===Vi(h.geoPointValue.latitude)&&Vi(a.geoPointValue.longitude)===Vi(h.geoPointValue.longitude)}(i,n);case 2:return function(a,h){if("integerValue"in a&&"integerValue"in h)return Vi(a.integerValue)===Vi(h.integerValue);if("doubleValue"in a&&"doubleValue"in h){const _=Vi(a.doubleValue),w=Vi(h.doubleValue);return _===w?I0(_)===I0(w):isNaN(_)&&isNaN(w)}return!1}(i,n);case 9:return uf(i.arrayValue.values||[],n.arrayValue.values||[],uc);case 10:return function(a,h){const _=a.mapValue.fields||{},w=h.mapValue.fields||{};if(KP(_)!==KP(w))return!1;for(const S in _)if(_.hasOwnProperty(S)&&(void 0===w[S]||!uc(_[S],w[S])))return!1;return!0}(i,n);default:return wn()}var h}function F0(i,n){return void 0!==(i.values||[]).find(o=>uc(o,n))}function dc(i,n){if(i===n)return 0;const o=Rp(i),a=Rp(n);if(o!==a)return Br(o,a);switch(o){case 0:case 9007199254740991:return 0;case 1:return Br(i.booleanValue,n.booleanValue);case 2:return function(h,_){const w=Vi(h.integerValue||h.doubleValue),S=Vi(_.integerValue||_.doubleValue);return w<S?-1:w>S?1:w===S?0:isNaN(w)?isNaN(S)?0:-1:1}(i,n);case 3:return z0(i.timestampValue,n.timestampValue);case 4:return z0(qd(i),qd(n));case 5:return Br(i.stringValue,n.stringValue);case 6:return function(h,_){const w=Wu(h),S=Wu(_);return w.compareTo(S)}(i.bytesValue,n.bytesValue);case 7:return function(h,_){const w=h.split("/"),S=_.split("/");for(let L=0;L<w.length&&L<S.length;L++){const B=Br(w[L],S[L]);if(0!==B)return B}return Br(w.length,S.length)}(i.referenceValue,n.referenceValue);case 8:return function(h,_){const w=Br(Vi(h.latitude),Vi(_.latitude));return 0!==w?w:Br(Vi(h.longitude),Vi(_.longitude))}(i.geoPointValue,n.geoPointValue);case 9:return function(h,_){const w=h.values||[],S=_.values||[];for(let L=0;L<w.length&&L<S.length;++L){const B=dc(w[L],S[L]);if(B)return B}return Br(w.length,S.length)}(i.arrayValue,n.arrayValue);case 10:return function(h,_){if(h===kp.mapValue&&_===kp.mapValue)return 0;if(h===kp.mapValue)return 1;if(_===kp.mapValue)return-1;const w=h.fields||{},S=Object.keys(w),L=_.fields||{},B=Object.keys(L);S.sort(),B.sort();for(let H=0;H<S.length&&H<B.length;++H){const Y=Br(S[H],B[H]);if(0!==Y)return Y;const pt=dc(w[S[H]],L[B[H]]);if(0!==pt)return pt}return Br(S.length,B.length)}(i.mapValue,n.mapValue);default:throw wn()}}function z0(i,n){if("string"==typeof i&&"string"==typeof n&&i.length===n.length)return Br(i,n);const o=pf(i),a=pf(n),h=Br(o.seconds,a.seconds);return 0!==h?h:Br(o.nanos,a.nanos)}function gf(i){return Yw(i)}function Yw(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(a){const h=pf(a);return`time(${h.seconds},${h.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?Wu(i.bytesValue).toBase64():"referenceValue"in i?hn.fromName(i.referenceValue).toString():"geoPointValue"in i?`geo(${(n=i.geoPointValue).latitude},${n.longitude})`:"arrayValue"in i?function(a){let h="[",_=!0;for(const w of a.values||[])_?_=!1:h+=",",h+=Yw(w);return h+"]"}(i.arrayValue):"mapValue"in i?function(a){const h=Object.keys(a.fields||{}).sort();let _="{",w=!0;for(const S of h)w?w=!1:_+=",",_+=`${S}:${Yw(a.fields[S])}`;return _+"}"}(i.mapValue):wn();var n}function Xw(i){return!!i&&"integerValue"in i}function B0(i){return!!i&&"arrayValue"in i}function XP(i){return!!i&&"nullValue"in i}function QP(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function E1(i){return!!i&&"mapValue"in i}function j_(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&"object"==typeof i.timestampValue)return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){const n={mapValue:{fields:{}}};return Zu(i.mapValue.fields,(o,a)=>n.mapValue.fields[o]=j_(a)),n}if(i.arrayValue){const n={arrayValue:{values:[]}};for(let o=0;o<(i.arrayValue.values||[]).length;++o)n.arrayValue.values[o]=j_(i.arrayValue.values[o]);return n}return Object.assign({},i)}function Qw(i){return"__max__"===(((i.mapValue||{}).fields||{}).__type__||{}).stringValue}class ui{constructor(n){this.value=n}static empty(){return new ui({mapValue:{}})}field(n){if(n.isEmpty())return this.value;{let o=this.value;for(let a=0;a<n.length-1;++a)if(o=(o.mapValue.fields||{})[n.get(a)],!E1(o))return null;return o=(o.mapValue.fields||{})[n.lastSegment()],o||null}}set(n,o){this.getFieldsMap(n.popLast())[n.lastSegment()]=j_(o)}setAll(n){let o=_s.emptyPath(),a={},h=[];n.forEach((w,S)=>{if(!o.isImmediateParentOf(S)){const L=this.getFieldsMap(o);this.applyChanges(L,a,h),a={},h=[],o=S.popLast()}w?a[S.lastSegment()]=j_(w):h.push(S.lastSegment())});const _=this.getFieldsMap(o);this.applyChanges(_,a,h)}delete(n){const o=this.field(n.popLast());E1(o)&&o.mapValue.fields&&delete o.mapValue.fields[n.lastSegment()]}isEqual(n){return uc(this.value,n.value)}getFieldsMap(n){let o=this.value;o.mapValue.fields||(o.mapValue={fields:{}});for(let a=0;a<n.length;++a){let h=o.mapValue.fields[n.get(a)];E1(h)&&h.mapValue.fields||(h={mapValue:{fields:{}}},o.mapValue.fields[n.get(a)]=h),o=h}return o.mapValue.fields}applyChanges(n,o,a){Zu(o,(h,_)=>n[h]=_);for(const h of a)delete n[h]}clone(){return new ui(j_(this.value))}}function kT(i){const n=[];return Zu(i.fields,(o,a)=>{const h=new _s([o]);if(E1(a)){const _=kT(a.mapValue).fields;if(0===_.length)n.push(h);else for(const w of _)n.push(h.child(w))}else n.push(h)}),new ul(n)}class li{constructor(n,o,a,h,_,w,S){this.key=n,this.documentType=o,this.version=a,this.readTime=h,this.createTime=_,this.data=w,this.documentState=S}static newInvalidDocument(n){return new li(n,0,Rn.min(),Rn.min(),Rn.min(),ui.empty(),0)}static newFoundDocument(n,o,a,h){return new li(n,1,o,Rn.min(),a,h,0)}static newNoDocument(n,o){return new li(n,2,o,Rn.min(),Rn.min(),ui.empty(),0)}static newUnknownDocument(n,o){return new li(n,3,o,Rn.min(),Rn.min(),ui.empty(),2)}convertToFoundDocument(n,o){return!this.createTime.isEqual(Rn.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=n),this.version=n,this.documentType=1,this.data=o,this.documentState=0,this}convertToNoDocument(n){return this.version=n,this.documentType=2,this.data=ui.empty(),this.documentState=0,this}convertToUnknownDocument(n){return this.version=n,this.documentType=3,this.data=ui.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Rn.min(),this}setReadTime(n){return this.readTime=n,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(n){return n instanceof li&&this.key.isEqual(n.key)&&this.version.isEqual(n.version)&&this.documentType===n.documentType&&this.documentState===n.documentState&&this.data.isEqual(n.data)}mutableCopy(){return new li(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Hc{constructor(n,o){this.position=n,this.inclusive=o}}function JP(i,n,o){let a=0;for(let h=0;h<i.position.length;h++){const _=n[h],w=i.position[h];if(a=_.field.isKeyField()?hn.comparator(hn.fromName(w.referenceValue),o.key):dc(w,o.data.field(_.field)),"desc"===_.dir&&(a*=-1),0!==a)break}return a}function T1(i,n){if(null===i)return null===n;if(null===n||i.inclusive!==n.inclusive||i.position.length!==n.position.length)return!1;for(let o=0;o<i.position.length;o++)if(!uc(i.position[o],n.position[o]))return!1;return!0}class Lp{constructor(n,o="asc"){this.field=n,this.dir=o}}function Zd(i,n){return i.dir===n.dir&&i.field.isEqual(n.field)}class $_{}class xr extends $_{constructor(n,o,a){super(),this.field=n,this.op=o,this.value=a}static create(n,o,a){return n.isKeyField()?"in"===o||"not-in"===o?this.createKeyFieldInFilter(n,o,a):new Yg(n,o,a):"array-contains"===o?new U0(n,a):"in"===o?new I1(n,a):"not-in"===o?new tO(n,a):"array-contains-any"===o?new tC(n,a):new xr(n,o,a)}static createKeyFieldInFilter(n,o,a){return"in"===o?new G_(n,a):new Xg(n,a)}matches(n){const o=n.data.field(this.field);return"!="===this.op?null!==o&&this.matchesComparison(dc(o,this.value)):null!==o&&Rp(this.value)===Rp(o)&&this.matchesComparison(dc(o,this.value))}matchesComparison(n){switch(this.op){case"<":return n<0;case"<=":return n<=0;case"==":return 0===n;case"!=":return 0!==n;case">":return n>0;case">=":return n>=0;default:return wn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class bo extends $_{constructor(n,o){super(),this.filters=n,this.op=o,this.lt=null}static create(n,o){return new bo(n,o)}matches(n){return so(this)?void 0===this.filters.find(o=>!o.matches(n)):void 0!==this.filters.find(o=>o.matches(n))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((n,o)=>n.concat(o.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const n=this.ft(o=>o.isInequality());return null!==n?n.field:null}ft(n){for(const o of this.getFlattenedFilters())if(n(o))return o;return null}}function so(i){return"and"===i.op}function mf(i){return function qc(i){for(const n of i.filters)if(n instanceof bo)return!1;return!0}(i)&&so(i)}function Wd(i){if(i instanceof xr)return i.field.canonicalString()+i.op.toString()+gf(i.value);if(mf(i))return i.filters.map(n=>Wd(n)).join(",");{const n=i.filters.map(o=>Wd(o)).join(",");return`${i.op}(${n})`}}function Kd(i,n){return i instanceof xr?(o=i,(a=n)instanceof xr&&o.op===a.op&&o.field.isEqual(a.field)&&uc(o.value,a.value)):i instanceof bo?function(o,a){return a instanceof bo&&o.op===a.op&&o.filters.length===a.filters.length&&o.filters.reduce((h,_,w)=>h&&Kd(_,a.filters[w]),!0)}(i,n):void wn();var o,a}function Np(i){return i instanceof xr?`${(n=i).field.canonicalString()} ${n.op} ${gf(n.value)}`:i instanceof bo?function(n){return n.op.toString()+" {"+n.getFilters().map(Np).join(" ,")+"}"}(i):"Filter";var n}class Yg extends xr{constructor(n,o,a){super(n,o,a),this.key=hn.fromName(a.referenceValue)}matches(n){const o=hn.comparator(n.key,this.key);return this.matchesComparison(o)}}class G_ extends xr{constructor(n,o){super(n,"in",o),this.keys=Fp(0,o)}matches(n){return this.keys.some(o=>o.isEqual(n.key))}}class Xg extends xr{constructor(n,o){super(n,"not-in",o),this.keys=Fp(0,o)}matches(n){return!this.keys.some(o=>o.isEqual(n.key))}}function Fp(i,n){var o;return((null===(o=n.arrayValue)||void 0===o?void 0:o.values)||[]).map(a=>hn.fromName(a.referenceValue))}class U0 extends xr{constructor(n,o){super(n,"array-contains",o)}matches(n){const o=n.data.field(this.field);return B0(o)&&F0(o.arrayValue,this.value)}}class I1 extends xr{constructor(n,o){super(n,"in",o)}matches(n){const o=n.data.field(this.field);return null!==o&&F0(this.value.arrayValue,o)}}class tO extends xr{constructor(n,o){super(n,"not-in",o)}matches(n){if(F0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const o=n.data.field(this.field);return null!==o&&!F0(this.value.arrayValue,o)}}class tC extends xr{constructor(n,o){super(n,"array-contains-any",o)}matches(n){const o=n.data.field(this.field);return!(!B0(o)||!o.arrayValue.values)&&o.arrayValue.values.some(a=>F0(this.value.arrayValue,a))}}class Yd{constructor(n,o=null,a=[],h=[],_=null,w=null,S=null){this.path=n,this.collectionGroup=o,this.orderBy=a,this.filters=h,this.limit=_,this.startAt=w,this.endAt=S,this.dt=null}}function V0(i,n=null,o=[],a=[],h=null,_=null,w=null){return new Yd(i,n,o,a,h,_,w)}function _f(i){const n=_n(i);if(null===n.dt){let o=n.path.canonicalString();null!==n.collectionGroup&&(o+="|cg:"+n.collectionGroup),o+="|f:",o+=n.filters.map(a=>Wd(a)).join(","),o+="|ob:",o+=n.orderBy.map(a=>{return(h=a).field.canonicalString()+h.dir;var h}).join(","),T0(n.limit)||(o+="|l:",o+=n.limit),n.startAt&&(o+="|lb:",o+=n.startAt.inclusive?"b:":"a:",o+=n.startAt.position.map(a=>gf(a)).join(",")),n.endAt&&(o+="|ub:",o+=n.endAt.inclusive?"a:":"b:",o+=n.endAt.position.map(a=>gf(a)).join(",")),n.dt=o}return n.dt}function Qg(i,n){if(i.limit!==n.limit||i.orderBy.length!==n.orderBy.length)return!1;for(let o=0;o<i.orderBy.length;o++)if(!Zd(i.orderBy[o],n.orderBy[o]))return!1;if(i.filters.length!==n.filters.length)return!1;for(let o=0;o<i.filters.length;o++)if(!Kd(i.filters[o],n.filters[o]))return!1;return i.collectionGroup===n.collectionGroup&&!!i.path.isEqual(n.path)&&!!T1(i.startAt,n.startAt)&&T1(i.endAt,n.endAt)}function H_(i){return hn.isDocumentKey(i.path)&&null===i.collectionGroup&&0===i.filters.length}class yf{constructor(n,o=null,a=[],h=[],_=null,w="F",S=null,L=null){this.path=n,this.collectionGroup=o,this.explicitOrderBy=a,this.filters=h,this.limit=_,this.limitType=w,this.startAt=S,this.endAt=L,this.wt=null,this._t=null}}function Bs(i){return new yf(i)}function eC(i){return 0===i.filters.length&&null===i.limit&&null==i.startAt&&null==i.endAt&&(0===i.explicitOrderBy.length||1===i.explicitOrderBy.length&&i.explicitOrderBy[0].field.isKeyField())}function zp(i){const n=_n(i);if(null===n.wt){n.wt=[];const o=function Jg(i){for(const n of i.filters){const o=n.getFirstInequalityField();if(null!==o)return o}return null}(n),a=function A1(i){return i.explicitOrderBy.length>0?i.explicitOrderBy[0].field:null}(n);if(null!==o&&null===a)o.isKeyField()||n.wt.push(new Lp(o)),n.wt.push(new Lp(_s.keyField(),"asc"));else{let h=!1;for(const _ of n.explicitOrderBy)n.wt.push(_),_.field.isKeyField()&&(h=!0);if(!h){const _=n.explicitOrderBy.length>0?n.explicitOrderBy[n.explicitOrderBy.length-1].dir:"asc";n.wt.push(new Lp(_s.keyField(),_))}}}return n.wt}function Ti(i){const n=_n(i);if(!n._t)if("F"===n.limitType)n._t=V0(n.path,n.collectionGroup,zp(n),n.filters,n.limit,n.startAt,n.endAt);else{const o=[];for(const _ of zp(n))o.push(new Lp(_.field,"desc"===_.dir?"asc":"desc"));const a=n.endAt?new Hc(n.endAt.position,n.endAt.inclusive):null,h=n.startAt?new Hc(n.startAt.position,n.startAt.inclusive):null;n._t=V0(n.path,n.collectionGroup,o,n.filters,n.limit,a,h)}return n._t}function hl(i,n,o){return new yf(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),n,o,i.startAt,i.endAt)}function Bp(i,n){return Qg(Ti(i),Ti(n))&&i.limitType===n.limitType}function Up(i){return`${_f(Ti(i))}|lt:${i.limitType}`}function j0(i){return`Query(target=${function(n){let o=n.path.canonicalString();return null!==n.collectionGroup&&(o+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(o+=`, filters: [${n.filters.map(a=>Np(a)).join(", ")}]`),T0(n.limit)||(o+=", limit: "+n.limit),n.orderBy.length>0&&(o+=`, orderBy: [${n.orderBy.map(a=>{return`${(h=a).field.canonicalString()} (${h.dir})`;var h}).join(", ")}]`),n.startAt&&(o+=", startAt: ",o+=n.startAt.inclusive?"b:":"a:",o+=n.startAt.position.map(a=>gf(a)).join(",")),n.endAt&&(o+=", endAt: ",o+=n.endAt.inclusive?"a:":"b:",o+=n.endAt.position.map(a=>gf(a)).join(",")),`Target(${o})`}(Ti(i))}; limitType=${i.limitType})`}function Zc(i,n){return n.isFoundDocument()&&function(o,a){const h=a.key.path;return null!==o.collectionGroup?a.key.hasCollectionId(o.collectionGroup)&&o.path.isPrefixOf(h):hn.isDocumentKey(o.path)?o.path.isEqual(h):o.path.isImmediateParentOf(h)}(i,n)&&function(o,a){for(const h of zp(o))if(!h.field.isKeyField()&&null===a.data.field(h.field))return!1;return!0}(i,n)&&function(o,a){for(const h of o.filters)if(!h.matches(a))return!1;return!0}(i,n)&&(a=n,!((o=i).startAt&&!function(h,_,w){const S=JP(h,_,w);return h.inclusive?S<=0:S<0}(o.startAt,zp(o),a)||o.endAt&&!function(h,_,w){const S=JP(h,_,w);return h.inclusive?S>=0:S>0}(o.endAt,zp(o),a)));var o,a}function rO(i){return(n,o)=>{let a=!1;for(const h of zp(i)){const _=$0(h,n,o);if(0!==_)return _;a=a||h.field.isKeyField()}return 0}}function $0(i,n,o){const a=i.field.isKeyField()?hn.comparator(n.key,o.key):function(h,_,w){const S=_.data.field(h),L=w.data.field(h);return null!==S&&null!==L?dc(S,L):wn()}(i.field,n,o);switch(i.dir){case"asc":return a;case"desc":return-1*a;default:return wn()}}class vf{constructor(n,o){this.mapKeyFn=n,this.equalsFn=o,this.inner={},this.innerSize=0}get(n){const o=this.mapKeyFn(n),a=this.inner[o];if(void 0!==a)for(const[h,_]of a)if(this.equalsFn(h,n))return _}has(n){return void 0!==this.get(n)}set(n,o){const a=this.mapKeyFn(n),h=this.inner[a];if(void 0===h)return this.inner[a]=[[n,o]],void this.innerSize++;for(let _=0;_<h.length;_++)if(this.equalsFn(h[_][0],n))return void(h[_]=[n,o]);h.push([n,o]),this.innerSize++}delete(n){const o=this.mapKeyFn(n),a=this.inner[o];if(void 0===a)return!1;for(let h=0;h<a.length;h++)if(this.equalsFn(a[h][0],n))return 1===a.length?delete this.inner[o]:a.splice(h,1),this.innerSize--,!0;return!1}forEach(n){Zu(this.inner,(o,a)=>{for(const[h,_]of a)n(h,_)})}isEmpty(){return U_(this.inner)}size(){return this.innerSize}}const W_=new ci(hn.comparator);function Us(){return W_}const k1=new ci(hn.comparator);function tm(...i){let n=k1;for(const o of i)n=n.insert(o.key,o);return n}function em(i){let n=k1;return i.forEach((o,a)=>n=n.insert(o,a.overlayedDocument)),n}function hc(){return G0()}function nC(){return G0()}function G0(){return new vf(i=>i.toString(),(i,n)=>i.isEqual(n))}const H0=new ci(hn.comparator),Qd=new Ei(hn.comparator);function Hr(...i){let n=Qd;for(const o of i)n=n.add(o);return n}const rC=new Ei(Br);function R1(i,n){if(i.useProto3Json){if(isNaN(n))return{doubleValue:"NaN"};if(n===1/0)return{doubleValue:"Infinity"};if(n===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:I0(n)?"-0":n}}function oC(i){return{integerValue:""+i}}function L1(i,n){return function Zw(i){return"number"==typeof i&&Number.isInteger(i)&&!I0(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}(n)?oC(n):R1(i,n)}class Yu{constructor(){this._=void 0}}function oO(i,n,o){return i instanceof nm?function(a,h){const _={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return h&&L0(h)&&(h=N0(h)),h&&(_.fields.__previous_value__=h),{mapValue:_}}(o,n):i instanceof Na?N1(i,n):i instanceof Xu?bf(i,n):function(a,h){const _=iC(a,h),w=Vp(_)+Vp(a.gt);return Xw(_)&&Xw(a.gt)?oC(w):R1(a.serializer,w)}(i,n)}function iO(i,n,o){return i instanceof Na?N1(i,n):i instanceof Xu?bf(i,n):o}function iC(i,n){return i instanceof fc?Xw(o=n)||(a=o)&&"doubleValue"in a?n:{integerValue:0}:null;var a,o}class nm extends Yu{}class Na extends Yu{constructor(n){super(),this.elements=n}}function N1(i,n){const o=Y_(n);for(const a of i.elements)o.some(h=>uc(h,a))||o.push(a);return{arrayValue:{values:o}}}class Xu extends Yu{constructor(n){super(),this.elements=n}}function bf(i,n){let o=Y_(n);for(const a of i.elements)o=o.filter(h=>!uc(h,a));return{arrayValue:{values:o}}}class fc extends Yu{constructor(n,o){super(),this.serializer=n,this.gt=o}}function Vp(i){return Vi(i.integerValue||i.doubleValue)}function Y_(i){return B0(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}class X_{constructor(n,o){this.version=n,this.transformResults=o}}class ei{constructor(n,o){this.updateTime=n,this.exists=o}static none(){return new ei}static exists(n){return new ei(void 0,n)}static updateTime(n){return new ei(n)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(n){return this.exists===n.exists&&(this.updateTime?!!n.updateTime&&this.updateTime.isEqual(n.updateTime):!n.updateTime)}}function Q_(i,n){return void 0!==i.updateTime?n.isFoundDocument()&&n.version.isEqual(i.updateTime):void 0===i.exists||i.exists===n.isFoundDocument()}class J_{}function F1(i,n){if(!i.hasLocalMutations||n&&0===n.fields.length)return null;if(null===n)return i.isNoDocument()?new Jd(i.key,ei.none()):new rm(i.key,i.data,ei.none());{const o=i.data,a=ui.empty();let h=new Ei(_s.comparator);for(let _ of n.fields)if(!h.has(_)){let w=o.field(_);null===w&&_.length>1&&(_=_.popLast(),w=o.field(_)),null===w?a.delete(_):a.set(_,w),h=h.add(_)}return new kl(i.key,a,new ul(h.toArray()),ei.none())}}function LT(i,n,o){i instanceof rm?function(a,h,_){const w=a.value.clone(),S=z1(a.fieldTransforms,h,_.transformResults);w.setAll(S),h.convertToFoundDocument(_.version,w).setHasCommittedMutations()}(i,n,o):i instanceof kl?function(a,h,_){if(!Q_(a.precondition,h))return void h.convertToUnknownDocument(_.version);const w=z1(a.fieldTransforms,h,_.transformResults),S=h.data;S.setAll(sC(a)),S.setAll(w),h.convertToFoundDocument(_.version,S).setHasCommittedMutations()}(i,n,o):n.convertToNoDocument(o.version).setHasCommittedMutations()}function ty(i,n,o,a){return i instanceof rm?function(h,_,w,S){if(!Q_(h.precondition,_))return w;const L=h.value.clone(),B=B1(h.fieldTransforms,S,_);return L.setAll(B),_.convertToFoundDocument(_.version,L).setHasLocalMutations(),null}(i,n,o,a):i instanceof kl?function(h,_,w,S){if(!Q_(h.precondition,_))return w;const L=B1(h.fieldTransforms,S,_),B=_.data;return B.setAll(sC(h)),B.setAll(L),_.convertToFoundDocument(_.version,B).setHasLocalMutations(),null===w?null:w.unionWith(h.fieldMask.fields).unionWith(h.fieldTransforms.map(H=>H.field))}(i,n,o,a):(w=o,Q_(i.precondition,_=n)?(_.convertToNoDocument(_.version).setHasLocalMutations(),null):w);var _,w}function sO(i,n){let o=null;for(const a of i.fieldTransforms){const h=n.data.field(a.field),_=iC(a.transform,h||null);null!=_&&(null===o&&(o=ui.empty()),o.set(a.field,_))}return o||null}function Z0(i,n){return i.type===n.type&&!!i.key.isEqual(n.key)&&!!i.precondition.isEqual(n.precondition)&&(a=n.fieldTransforms,!!(void 0===(o=i.fieldTransforms)&&void 0===a||o&&a&&uf(o,a,(h,_)=>function RT(i,n){return i.field.isEqual(n.field)&&(a=n.transform,(o=i.transform)instanceof Na&&a instanceof Na||o instanceof Xu&&a instanceof Xu?uf(o.elements,a.elements,uc):o instanceof fc&&a instanceof fc?uc(o.gt,a.gt):o instanceof nm&&a instanceof nm);var o,a}(h,_))))&&(0===i.type?i.value.isEqual(n.value):1!==i.type||i.data.isEqual(n.data)&&i.fieldMask.isEqual(n.fieldMask));var o,a}class rm extends J_{constructor(n,o,a,h=[]){super(),this.key=n,this.value=o,this.precondition=a,this.fieldTransforms=h,this.type=0}getFieldMask(){return null}}class kl extends J_{constructor(n,o,a,h,_=[]){super(),this.key=n,this.data=o,this.fieldMask=a,this.precondition=h,this.fieldTransforms=_,this.type=1}getFieldMask(){return this.fieldMask}}function sC(i){const n=new Map;return i.fieldMask.fields.forEach(o=>{if(!o.isEmpty()){const a=i.data.field(o);n.set(o,a)}}),n}function z1(i,n,o){const a=new Map;$n(i.length===o.length);for(let h=0;h<o.length;h++){const _=i[h],w=_.transform,S=n.data.field(_.field);a.set(_.field,iO(w,S,o[h]))}return a}function B1(i,n,o){const a=new Map;for(const h of i){const _=h.transform,w=o.data.field(h.field);a.set(h.field,oO(_,w,n))}return a}class Jd extends J_{constructor(n,o){super(),this.key=n,this.precondition=o,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class U1 extends J_{constructor(n,o){super(),this.key=n,this.precondition=o,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class V1{constructor(n,o,a,h){this.batchId=n,this.localWriteTime=o,this.baseMutations=a,this.mutations=h}applyToRemoteDocument(n,o){const a=o.mutationResults;for(let h=0;h<this.mutations.length;h++){const _=this.mutations[h];_.key.isEqual(n.key)&&LT(_,n,a[h])}}applyToLocalView(n,o){for(const a of this.baseMutations)a.key.isEqual(n.key)&&(o=ty(a,n,o,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(n.key)&&(o=ty(a,n,o,this.localWriteTime));return o}applyToLocalDocumentSet(n,o){const a=nC();return this.mutations.forEach(h=>{const _=n.get(h.key),w=_.overlayedDocument;let S=this.applyToLocalView(w,_.mutatedFields);S=o.has(h.key)?null:S;const L=F1(w,S);null!==L&&a.set(h.key,L),w.isValidDocument()||w.convertToNoDocument(Rn.min())}),a}keys(){return this.mutations.reduce((n,o)=>n.add(o.key),Hr())}isEqual(n){return this.batchId===n.batchId&&uf(this.mutations,n.mutations,(o,a)=>Z0(o,a))&&uf(this.baseMutations,n.baseMutations,(o,a)=>Z0(o,a))}}class ey{constructor(n,o,a,h){this.batch=n,this.commitVersion=o,this.mutationResults=a,this.docVersions=h}static from(n,o,a){$n(n.mutations.length===a.length);let h=H0;const _=n.mutations;for(let w=0;w<_.length;w++)h=h.insert(_[w].key,a[w].version);return new ey(n,o,a,h)}}class ny{constructor(n,o){this.largestBatchId=n,this.mutation=o}getKey(){return this.mutation.key}isEqual(n){return null!==n&&this.mutation===n.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class W0{constructor(n,o){this.count=n,this.unchangedNames=o}}var di,To;function Y0(i){if(void 0===i)return rs("GRPC error has no .code"),Jt.UNKNOWN;switch(i){case di.OK:return Jt.OK;case di.CANCELLED:return Jt.CANCELLED;case di.UNKNOWN:return Jt.UNKNOWN;case di.DEADLINE_EXCEEDED:return Jt.DEADLINE_EXCEEDED;case di.RESOURCE_EXHAUSTED:return Jt.RESOURCE_EXHAUSTED;case di.INTERNAL:return Jt.INTERNAL;case di.UNAVAILABLE:return Jt.UNAVAILABLE;case di.UNAUTHENTICATED:return Jt.UNAUTHENTICATED;case di.INVALID_ARGUMENT:return Jt.INVALID_ARGUMENT;case di.NOT_FOUND:return Jt.NOT_FOUND;case di.ALREADY_EXISTS:return Jt.ALREADY_EXISTS;case di.PERMISSION_DENIED:return Jt.PERMISSION_DENIED;case di.FAILED_PRECONDITION:return Jt.FAILED_PRECONDITION;case di.ABORTED:return Jt.ABORTED;case di.OUT_OF_RANGE:return Jt.OUT_OF_RANGE;case di.UNIMPLEMENTED:return Jt.UNIMPLEMENTED;case di.DATA_LOSS:return Jt.DATA_LOSS;default:return wn()}}(To=di||(di={}))[To.OK=0]="OK",To[To.CANCELLED=1]="CANCELLED",To[To.UNKNOWN=2]="UNKNOWN",To[To.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",To[To.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",To[To.NOT_FOUND=5]="NOT_FOUND",To[To.ALREADY_EXISTS=6]="ALREADY_EXISTS",To[To.PERMISSION_DENIED=7]="PERMISSION_DENIED",To[To.UNAUTHENTICATED=16]="UNAUTHENTICATED",To[To.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",To[To.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",To[To.ABORTED=10]="ABORTED",To[To.OUT_OF_RANGE=11]="OUT_OF_RANGE",To[To.UNIMPLEMENTED=12]="UNIMPLEMENTED",To[To.INTERNAL=13]="INTERNAL",To[To.UNAVAILABLE=14]="UNAVAILABLE",To[To.DATA_LOSS=15]="DATA_LOSS";class om{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return xf}static getOrCreateInstance(){return null===xf&&(xf=new om),xf}onExistenceFilterMismatch(n){const o=Symbol();return this.onExistenceFilterMismatchCallbacks.set(o,n),()=>this.onExistenceFilterMismatchCallbacks.delete(o)}notifyOnExistenceFilterMismatch(n){this.onExistenceFilterMismatchCallbacks.forEach(o=>o(n))}}let xf=null;const aO=new $u([4294967295,4294967295],0);function lC(i){const n=function aC(){return new TextEncoder}().encode(i),o=new BP;return o.update(n),new Uint8Array(o.digest())}function X0(i){const n=new DataView(i.buffer),o=n.getUint32(0,!0),a=n.getUint32(4,!0),h=n.getUint32(8,!0),_=n.getUint32(12,!0);return[new $u([o,a],0),new $u([h,_],0)]}class th{constructor(n,o,a){if(this.bitmap=n,this.padding=o,this.hashCount=a,o<0||o>=8)throw new Q0(`Invalid padding: ${o}`);if(a<0)throw new Q0(`Invalid hash count: ${a}`);if(n.length>0&&0===this.hashCount)throw new Q0(`Invalid hash count: ${a}`);if(0===n.length&&0!==o)throw new Q0(`Invalid padding when bitmap length is 0: ${o}`);this.It=8*n.length-o,this.Tt=$u.fromNumber(this.It)}Et(n,o,a){let h=n.add(o.multiply($u.fromNumber(a)));return 1===h.compare(aO)&&(h=new $u([h.getBits(0),h.getBits(1)],0)),h.modulo(this.Tt).toNumber()}At(n){return 0!=(this.bitmap[Math.floor(n/8)]&1<<n%8)}vt(n){if(0===this.It)return!1;const o=lC(n),[a,h]=X0(o);for(let _=0;_<this.hashCount;_++){const w=this.Et(a,h,_);if(!this.At(w))return!1}return!0}static create(n,o,a){const h=n%8==0?0:8-n%8,_=new Uint8Array(Math.ceil(n/8)),w=new th(_,h,o);return a.forEach(S=>w.insert(S)),w}insert(n){if(0===this.It)return;const o=lC(n),[a,h]=X0(o);for(let _=0;_<this.hashCount;_++){const w=this.Et(a,h,_);this.Rt(w)}}Rt(n){const o=Math.floor(n/8);this.bitmap[o]|=1<<n%8}}class Q0 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class jp{constructor(n,o,a,h,_){this.snapshotVersion=n,this.targetChanges=o,this.targetMismatches=a,this.documentUpdates=h,this.resolvedLimboDocuments=_}static createSynthesizedRemoteEventForCurrentChange(n,o,a){const h=new Map;return h.set(n,xo.createSynthesizedTargetChangeForCurrentChange(n,o,a)),new jp(Rn.min(),h,new ci(Br),Us(),Hr())}}class xo{constructor(n,o,a,h,_){this.resumeToken=n,this.current=o,this.addedDocuments=a,this.modifiedDocuments=h,this.removedDocuments=_}static createSynthesizedTargetChangeForCurrentChange(n,o,a){return new xo(a,o,Hr(),Hr(),Hr())}}class pc{constructor(n,o,a,h){this.Pt=n,this.removedTargetIds=o,this.key=a,this.bt=h}}class fl{constructor(n,o){this.targetId=n,this.Vt=o}}class Qu{constructor(n,o,a=ys.EMPTY_BYTE_STRING,h=null){this.state=n,this.targetIds=o,this.resumeToken=a,this.cause=h}}class Ju{constructor(){this.St=0,this.Dt=J0(),this.Ct=ys.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(n){n.approximateByteSize()>0&&(this.Nt=!0,this.Ct=n)}Ot(){let n=Hr(),o=Hr(),a=Hr();return this.Dt.forEach((h,_)=>{switch(_){case 0:n=n.add(h);break;case 2:o=o.add(h);break;case 1:a=a.add(h);break;default:wn()}}),new xo(this.Ct,this.xt,n,o,a)}Ft(){this.Nt=!1,this.Dt=J0()}Bt(n,o){this.Nt=!0,this.Dt=this.Dt.insert(n,o)}Lt(n){this.Nt=!0,this.Dt=this.Dt.remove(n)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class wf{constructor(n){this.Gt=n,this.Qt=new Map,this.jt=Us(),this.zt=$p(),this.Wt=new ci(Br)}Ht(n){for(const o of n.Pt)n.bt&&n.bt.isFoundDocument()?this.Jt(o,n.bt):this.Yt(o,n.key,n.bt);for(const o of n.removedTargetIds)this.Yt(o,n.key,n.bt)}Xt(n){this.forEachTarget(n,o=>{const a=this.Zt(o);switch(n.state){case 0:this.te(o)&&a.$t(n.resumeToken);break;case 1:a.Ut(),a.kt||a.Ft(),a.$t(n.resumeToken);break;case 2:a.Ut(),a.kt||this.removeTarget(o);break;case 3:this.te(o)&&(a.Kt(),a.$t(n.resumeToken));break;case 4:this.te(o)&&(this.ee(o),a.$t(n.resumeToken));break;default:wn()}})}forEachTarget(n,o){n.targetIds.length>0?n.targetIds.forEach(o):this.Qt.forEach((a,h)=>{this.te(h)&&o(h)})}ne(n){var o;const a=n.targetId,h=n.Vt.count,_=this.se(a);if(_){const w=_.target;if(H_(w))if(0===h){const S=new hn(w.path);this.Yt(a,S,li.newNoDocument(S,Rn.min()))}else $n(1===h);else{const S=this.ie(a);if(S!==h){const L=this.re(n,S);0!==L&&(this.ee(a),this.Wt=this.Wt.insert(a,2===L?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(o=om.instance)||void 0===o||o.notifyOnExistenceFilterMismatch(function(B,H,Y){var pt,xt,At,Ut,Zt,qe;const fn={localCacheCount:H,existenceFilterCount:Y.count},$e=Y.unchangedNames;return $e&&(fn.bloomFilter={applied:0===B,hashCount:null!==(pt=$e?.hashCount)&&void 0!==pt?pt:0,bitmapLength:null!==(Ut=null===(At=null===(xt=$e?.bits)||void 0===xt?void 0:xt.bitmap)||void 0===At?void 0:At.length)&&void 0!==Ut?Ut:0,padding:null!==(qe=null===(Zt=$e?.bits)||void 0===Zt?void 0:Zt.padding)&&void 0!==qe?qe:0}),fn}(L,S,n.Vt))}}}}re(n,o){const{unchangedNames:a,count:h}=n.Vt;if(!a||!a.bits)return 1;const{bits:{bitmap:_="",padding:w=0},hashCount:S=0}=a;let L,B;try{L=Wu(_).toUint8Array()}catch(H){if(H instanceof k0)return lc("Decoding the base64 bloom filter in existence filter failed ("+H.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw H}try{B=new th(L,w,S)}catch(H){return lc(H instanceof Q0?"BloomFilter error: ":"Applying bloom filter failed: ",H),1}return 0===B.It?1:h!==o-this.oe(n.targetId,B)?2:0}oe(n,o){const a=this.Gt.getRemoteKeysForTarget(n);let h=0;return a.forEach(_=>{const w=this.Gt.ue(),S=`projects/${w.projectId}/databases/${w.database}/documents/${_.path.canonicalString()}`;o.vt(S)||(this.Yt(n,_,null),h++)}),h}ce(n){const o=new Map;this.Qt.forEach((_,w)=>{const S=this.se(w);if(S){if(_.current&&H_(S.target)){const L=new hn(S.target.path);null!==this.jt.get(L)||this.ae(w,L)||this.Yt(w,L,li.newNoDocument(L,n))}_.Mt&&(o.set(w,_.Ot()),_.Ft())}});let a=Hr();this.zt.forEach((_,w)=>{let S=!0;w.forEachWhile(L=>{const B=this.se(L);return!B||"TargetPurposeLimboResolution"===B.purpose||(S=!1,!1)}),S&&(a=a.add(_))}),this.jt.forEach((_,w)=>w.setReadTime(n));const h=new jp(n,o,this.Wt,this.jt,a);return this.jt=Us(),this.zt=$p(),this.Wt=new ci(Br),h}Jt(n,o){if(!this.te(n))return;const a=this.ae(n,o.key)?2:0;this.Zt(n).Bt(o.key,a),this.jt=this.jt.insert(o.key,o),this.zt=this.zt.insert(o.key,this.he(o.key).add(n))}Yt(n,o,a){if(!this.te(n))return;const h=this.Zt(n);this.ae(n,o)?h.Bt(o,1):h.Lt(o),this.zt=this.zt.insert(o,this.he(o).delete(n)),a&&(this.jt=this.jt.insert(o,a))}removeTarget(n){this.Qt.delete(n)}ie(n){const o=this.Zt(n).Ot();return this.Gt.getRemoteKeysForTarget(n).size+o.addedDocuments.size-o.removedDocuments.size}qt(n){this.Zt(n).qt()}Zt(n){let o=this.Qt.get(n);return o||(o=new Ju,this.Qt.set(n,o)),o}he(n){let o=this.zt.get(n);return o||(o=new Ei(Br),this.zt=this.zt.insert(n,o)),o}te(n){const o=null!==this.se(n);return o||ze("WatchChangeAggregator","Detected inactive target",n),o}se(n){const o=this.Qt.get(n);return o&&o.kt?null:this.Gt.le(n)}ee(n){this.Qt.set(n,new Ju),this.Gt.getRemoteKeysForTarget(n).forEach(o=>{this.Yt(n,o,null)})}ae(n,o){return this.Gt.getRemoteKeysForTarget(n).has(o)}}function $p(){return new ci(hn.comparator)}function J0(){return new ci(hn.comparator)}const lO={asc:"ASCENDING",desc:"DESCENDING"},$1={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cO={and:"AND",or:"OR"};class Ki{constructor(n,o){this.databaseId=n,this.useProto3Json=o}}function G1(i,n){return i.useProto3Json||T0(n)?n:{value:n}}function im(i,n){return i.useProto3Json?`${new Date(1e3*n.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+n.nanoseconds).slice(-9)}Z`:{seconds:""+n.seconds,nanos:n.nanoseconds}}function uO(i,n){return i.useProto3Json?n.toBase64():n.toUint8Array()}function dO(i,n){return im(i,n.toTimestamp())}function _r(i){return $n(!!i),Rn.fromTimestamp(function(n){const o=pf(n);return new An(o.seconds,o.nanos)}(i))}function H1(i,n){return(o=i,new io(["projects",o.projectId,"databases",o.database])).child("documents").child(n).canonicalString();var o}function cC(i){const n=io.fromString(i);return $n(mO(n)),n}function eh(i,n){return H1(i.databaseId,n.path)}function nh(i,n){const o=cC(n);if(o.get(1)!==i.databaseId.projectId)throw new Se(Jt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+o.get(1)+" vs "+i.databaseId.projectId);if(o.get(3)!==i.databaseId.database)throw new Se(Jt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+o.get(3)+" vs "+i.databaseId.database);return new hn(hC(o))}function uC(i,n){return H1(i.databaseId,n)}function tv(i){return new io(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function hC(i){return $n(i.length>4&&"documents"===i.get(4)),i.popFirst(5)}function NT(i,n,o){return{name:eh(i,n),fields:o.value.mapValue.fields}}function Wc(i,n){return{documents:[uC(i,n.path)]}}function gc(i,n){const o={structuredQuery:{}},a=n.path;null!==n.collectionGroup?(o.parent=uC(i,a),o.structuredQuery.from=[{collectionId:n.collectionGroup,allDescendants:!0}]):(o.parent=uC(i,a.popLast()),o.structuredQuery.from=[{collectionId:a.lastSegment()}]);const h=function(L){if(0!==L.length)return pO(bo.create(L,"and"))}(n.filters);h&&(o.structuredQuery.where=h);const _=function(L){if(0!==L.length)return L.map(B=>{return{field:ih((H=B).field),direction:FT(H.dir)};var H})}(n.orderBy);_&&(o.structuredQuery.orderBy=_);const w=G1(i,n.limit);var S,L;return null!==w&&(o.structuredQuery.limit=w),n.startAt&&(o.structuredQuery.startAt={before:(S=n.startAt).inclusive,values:S.position}),n.endAt&&(o.structuredQuery.endAt={before:!(L=n.endAt).inclusive,values:L.position}),o}function mC(i){let n=function dC(i){const n=cC(i);return 4===n.length?io.emptyPath():hC(n)}(i.parent);const o=i.structuredQuery,a=o.from?o.from.length:0;let h=null;if(a>0){$n(1===a);const H=o.from[0];H.allDescendants?h=H.collectionId:n=n.child(H.collectionId)}let _=[];o.where&&(_=function(H){const Y=fO(H);return Y instanceof bo&&mf(Y)?Y.getFilters():[Y]}(o.where));let w=[];o.orderBy&&(w=o.orderBy.map(H=>{return new Lp(sh((Y=H).field),function(pt){switch(pt){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(Y.direction));var Y}));let S=null;o.limit&&(S=function(H){let Y;return Y="object"==typeof H?H.value:H,T0(Y)?null:Y}(o.limit));let L=null;var H;o.startAt&&(L=new Hc((H=o.startAt).values||[],!!H.before));let B=null;return o.endAt&&(B=function(H){return new Hc(H.values||[],!H.before)}(o.endAt)),function S1(i,n,o,a,h,_,w,S){return new yf(i,n,o,a,h,_,w,S)}(n,h,w,_,S,"F",L,B)}function fO(i){return void 0!==i.unaryFilter?function(n){switch(n.unaryFilter.op){case"IS_NAN":const o=sh(n.unaryFilter.field);return xr.create(o,"==",{doubleValue:NaN});case"IS_NULL":const a=sh(n.unaryFilter.field);return xr.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const h=sh(n.unaryFilter.field);return xr.create(h,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const _=sh(n.unaryFilter.field);return xr.create(_,"!=",{nullValue:"NULL_VALUE"});default:return wn()}}(i):void 0!==i.fieldFilter?xr.create(sh((n=i).fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return wn()}}(n.fieldFilter.op),n.fieldFilter.value):void 0!==i.compositeFilter?function(n){return bo.create(n.compositeFilter.filters.map(o=>fO(o)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return wn()}}(n.compositeFilter.op))}(i):wn();var n}function FT(i){return lO[i]}function zT(i){return $1[i]}function BT(i){return cO[i]}function ih(i){return{fieldPath:i.canonicalString()}}function sh(i){return _s.fromServerFormat(i.fieldPath)}function pO(i){return i instanceof xr?function(n){if("=="===n.op){if(QP(n.value))return{unaryFilter:{field:ih(n.field),op:"IS_NAN"}};if(XP(n.value))return{unaryFilter:{field:ih(n.field),op:"IS_NULL"}}}else if("!="===n.op){if(QP(n.value))return{unaryFilter:{field:ih(n.field),op:"IS_NOT_NAN"}};if(XP(n.value))return{unaryFilter:{field:ih(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ih(n.field),op:zT(n.op),value:n.value}}}(i):i instanceof bo?function(n){const o=n.getFilters().map(a=>pO(a));return 1===o.length?o[0]:{compositeFilter:{op:BT(n.op),filters:o}}}(i):wn()}function gO(i){const n=[];return i.fields.forEach(o=>n.push(o.canonicalString())),{fieldPaths:n}}function mO(i){return i.length>=4&&"projects"===i.get(0)&&"databases"===i.get(2)}class Cf{constructor(n,o,a,h,_=Rn.min(),w=Rn.min(),S=ys.EMPTY_BYTE_STRING,L=null){this.target=n,this.targetId=o,this.purpose=a,this.sequenceNumber=h,this.snapshotVersion=_,this.lastLimboFreeSnapshotVersion=w,this.resumeToken=S,this.expectedCount=L}withSequenceNumber(n){return new Cf(this.target,this.targetId,this.purpose,n,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(n,o){return new Cf(this.target,this.targetId,this.purpose,this.sequenceNumber,o,this.lastLimboFreeSnapshotVersion,n,null)}withExpectedCount(n){return new Cf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,n)}withLastLimboFreeSnapshotVersion(n){return new Cf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,n,this.resumeToken,this.expectedCount)}}class _C{constructor(n){this.fe=n}}function am(i){const n=mC({parent:i.parent,structuredQuery:i.structuredQuery});return"LAST"===i.limitType?hl(n,n.limit,"L"):n}class Pf{constructor(){}_e(n,o){this.me(n,o),o.ge()}me(n,o){if("nullValue"in n)this.ye(o,5);else if("booleanValue"in n)this.ye(o,10),o.pe(n.booleanValue?1:0);else if("integerValue"in n)this.ye(o,15),o.pe(Vi(n.integerValue));else if("doubleValue"in n){const a=Vi(n.doubleValue);isNaN(a)?this.ye(o,13):(this.ye(o,15),I0(a)?o.pe(0):o.pe(a))}else if("timestampValue"in n){const a=n.timestampValue;this.ye(o,20),"string"==typeof a?o.Ie(a):(o.Ie(`${a.seconds||""}`),o.pe(a.nanos||0))}else if("stringValue"in n)this.Te(n.stringValue,o),this.Ee(o);else if("bytesValue"in n)this.ye(o,30),o.Ae(Wu(n.bytesValue)),this.Ee(o);else if("referenceValue"in n)this.ve(n.referenceValue,o);else if("geoPointValue"in n){const a=n.geoPointValue;this.ye(o,45),o.pe(a.latitude||0),o.pe(a.longitude||0)}else"mapValue"in n?Qw(n)?this.ye(o,Number.MAX_SAFE_INTEGER):(this.Re(n.mapValue,o),this.Ee(o)):"arrayValue"in n?(this.Pe(n.arrayValue,o),this.Ee(o)):wn()}Te(n,o){this.ye(o,25),this.be(n,o)}be(n,o){o.Ie(n)}Re(n,o){const a=n.fields||{};this.ye(o,55);for(const h of Object.keys(a))this.Te(h,o),this.me(a[h],o)}Pe(n,o){const a=n.values||[];this.ye(o,50);for(const h of a)this.me(h,o)}ve(n,o){this.ye(o,37),hn.fromName(n).path.forEach(a=>{this.ye(o,60),this.be(a,o)})}ye(n,o){n.pe(o)}Ee(n){n.pe(2)}}Pf.Ve=new Pf;class wC{constructor(){this.rn=new av}addToCollectionParentIndex(n,o){return this.rn.add(o),qt.resolve()}getCollectionParents(n,o){return qt.resolve(this.rn.getEntries(o))}addFieldIndex(n,o){return qt.resolve()}deleteFieldIndex(n,o){return qt.resolve()}getDocumentsMatchingTarget(n,o){return qt.resolve(null)}getIndexType(n,o){return qt.resolve(0)}getFieldIndexes(n,o){return qt.resolve([])}getNextCollectionGroupToUpdate(n){return qt.resolve(null)}getMinOffset(n,o){return qt.resolve(Sl.min())}getMinOffsetFromCollectionGroup(n,o){return qt.resolve(Sl.min())}updateCollectionGroup(n,o,a){return qt.resolve()}updateIndexEntries(n,o){return qt.resolve()}}class av{constructor(){this.index={}}add(n){const o=n.lastSegment(),a=n.popLast(),h=this.index[o]||new Ei(io.comparator),_=!h.has(a);return this.index[o]=h.add(a),_}has(n){const o=n.lastSegment(),a=n.popLast(),h=this.index[o];return h&&h.has(a)}getEntries(n){return(this.index[n]||new Ei(io.comparator)).toArray()}}new Uint8Array(0);class is{constructor(n,o,a){this.cacheSizeCollectionThreshold=n,this.percentileToCollect=o,this.maximumSequenceNumbersToCollect=a}static withCacheSize(n){return new is(n,is.DEFAULT_COLLECTION_PERCENTILE,is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}is.DEFAULT_COLLECTION_PERCENTILE=10,is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,is.DEFAULT=new is(41943040,is.DEFAULT_COLLECTION_PERCENTILE,is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),is.DISABLED=new is(-1,0,0);class _c{constructor(n){this.Nn=n}next(){return this.Nn+=2,this.Nn}static kn(){return new _c(0)}static Mn(){return new _c(-1)}}class xO{constructor(){this.changes=new vf(n=>n.toString(),(n,o)=>n.isEqual(o)),this.changesApplied=!1}addEntry(n){this.assertNotApplied(),this.changes.set(n.key,n)}removeEntry(n,o){this.assertNotApplied(),this.changes.set(n,li.newInvalidDocument(n).setReadTime(o))}getEntry(n,o){this.assertNotApplied();const a=this.changes.get(o);return void 0!==a?qt.resolve(a):this.getFromCache(n,o)}getEntries(n,o){return this.getAllFromCache(n,o)}apply(n){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(n)}assertNotApplied(){}}class EC{constructor(n,o){this.overlayedDocument=n,this.mutatedFields=o}}class Xc{constructor(n,o,a,h){this.remoteDocumentCache=n,this.mutationQueue=o,this.documentOverlayCache=a,this.indexManager=h}getDocument(n,o){let a=null;return this.documentOverlayCache.getOverlay(n,o).next(h=>(a=h,this.remoteDocumentCache.getEntry(n,o))).next(h=>(null!==a&&ty(a.mutation,h,ul.empty(),An.now()),h))}getDocuments(n,o){return this.remoteDocumentCache.getEntries(n,o).next(a=>this.getLocalViewOfDocuments(n,a,Hr()).next(()=>a))}getLocalViewOfDocuments(n,o,a=Hr()){const h=hc();return this.populateOverlays(n,h,o).next(()=>this.computeViews(n,o,h,a).next(_=>{let w=tm();return _.forEach((S,L)=>{w=w.insert(S,L.overlayedDocument)}),w}))}getOverlayedDocuments(n,o){const a=hc();return this.populateOverlays(n,a,o).next(()=>this.computeViews(n,o,a,Hr()))}populateOverlays(n,o,a){const h=[];return a.forEach(_=>{o.has(_)||h.push(_)}),this.documentOverlayCache.getOverlays(n,h).next(_=>{_.forEach((w,S)=>{o.set(w,S)})})}computeViews(n,o,a,h){let _=Us();const w=G0(),S=G0();return o.forEach((L,B)=>{const H=a.get(B.key);h.has(B.key)&&(void 0===H||H.mutation instanceof kl)?_=_.insert(B.key,B):void 0!==H?(w.set(B.key,H.mutation.getFieldMask()),ty(H.mutation,B,H.mutation.getFieldMask(),An.now())):w.set(B.key,ul.empty())}),this.recalculateAndSaveOverlays(n,_).next(L=>(L.forEach((B,H)=>w.set(B,H)),o.forEach((B,H)=>{var Y;return S.set(B,new EC(H,null!==(Y=w.get(B))&&void 0!==Y?Y:null))}),S))}recalculateAndSaveOverlays(n,o){const a=G0();let h=new ci((w,S)=>w-S),_=Hr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(n,o).next(w=>{for(const S of w)S.keys().forEach(L=>{const B=o.get(L);if(null===B)return;let H=a.get(L)||ul.empty();H=S.applyToLocalView(B,H),a.set(L,H);const Y=(h.get(S.batchId)||Hr()).add(L);h=h.insert(S.batchId,Y)})}).next(()=>{const w=[],S=h.getReverseIterator();for(;S.hasNext();){const L=S.getNext(),B=L.key,H=L.value,Y=nC();H.forEach(pt=>{if(!_.has(pt)){const xt=F1(o.get(pt),a.get(pt));null!==xt&&Y.set(pt,xt),_=_.add(pt)}}),w.push(this.documentOverlayCache.saveOverlays(n,B,Y))}return qt.waitFor(w)}).next(()=>a)}recalculateAndSaveOverlaysForDocumentKeys(n,o){return this.remoteDocumentCache.getEntries(n,o).next(a=>this.recalculateAndSaveOverlays(n,a))}getDocumentsMatchingQuery(n,o,a){return hn.isDocumentKey((h=o).path)&&null===h.collectionGroup&&0===h.filters.length?this.getDocumentsMatchingDocumentQuery(n,o.path):function D1(i){return null!==i.collectionGroup}(o)?this.getDocumentsMatchingCollectionGroupQuery(n,o,a):this.getDocumentsMatchingCollectionQuery(n,o,a);var h}getNextDocuments(n,o,a,h){return this.remoteDocumentCache.getAllFromCollectionGroup(n,o,a,h).next(_=>{const w=h-_.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(n,o,a.largestBatchId,h-_.size):qt.resolve(hc());let S=-1,L=_;return w.next(B=>qt.forEach(B,(H,Y)=>(S<Y.largestBatchId&&(S=Y.largestBatchId),_.get(H)?qt.resolve():this.remoteDocumentCache.getEntry(n,H).next(pt=>{L=L.insert(H,pt)}))).next(()=>this.populateOverlays(n,B,_)).next(()=>this.computeViews(n,L,B,Hr())).next(H=>({batchId:S,changes:em(H)})))})}getDocumentsMatchingDocumentQuery(n,o){return this.getDocument(n,new hn(o)).next(a=>{let h=tm();return a.isFoundDocument()&&(h=h.insert(a.key,a)),h})}getDocumentsMatchingCollectionGroupQuery(n,o,a){const h=o.collectionGroup;let _=tm();return this.indexManager.getCollectionParents(n,h).next(w=>qt.forEach(w,S=>{const L=(B=o,H=S.child(h),new yf(H,null,B.explicitOrderBy.slice(),B.filters.slice(),B.limit,B.limitType,B.startAt,B.endAt));var B,H;return this.getDocumentsMatchingCollectionQuery(n,L,a).next(B=>{B.forEach((H,Y)=>{_=_.insert(H,Y)})})}).next(()=>_))}getDocumentsMatchingCollectionQuery(n,o,a){let h;return this.documentOverlayCache.getOverlaysForCollection(n,o.path,a.largestBatchId).next(_=>(h=_,this.remoteDocumentCache.getDocumentsMatchingQuery(n,o,a,h))).next(_=>{h.forEach((S,L)=>{const B=L.getKey();null===_.get(B)&&(_=_.insert(B,li.newInvalidDocument(B)))});let w=tm();return _.forEach((S,L)=>{const B=h.get(S);void 0!==B&&ty(B.mutation,L,ul.empty(),An.now()),Zc(o,L)&&(w=w.insert(S,L))}),w})}}class MO{constructor(n){this.serializer=n,this.cs=new Map,this.hs=new Map}getBundleMetadata(n,o){return qt.resolve(this.cs.get(o))}saveBundleMetadata(n,o){var a;return this.cs.set(o.id,{id:(a=o).id,version:a.version,createTime:_r(a.createTime)}),qt.resolve()}getNamedQuery(n,o){return qt.resolve(this.hs.get(o))}saveNamedQuery(n,o){return this.hs.set(o.name,{name:(a=o).name,query:am(a.bundledQuery),readTime:_r(a.readTime)}),qt.resolve();var a}}class PO{constructor(){this.overlays=new ci(hn.comparator),this.ls=new Map}getOverlay(n,o){return qt.resolve(this.overlays.get(o))}getOverlays(n,o){const a=hc();return qt.forEach(o,h=>this.getOverlay(n,h).next(_=>{null!==_&&a.set(h,_)})).next(()=>a)}saveOverlays(n,o,a){return a.forEach((h,_)=>{this.we(n,o,_)}),qt.resolve()}removeOverlaysForBatchId(n,o,a){const h=this.ls.get(a);return void 0!==h&&(h.forEach(_=>this.overlays=this.overlays.remove(_)),this.ls.delete(a)),qt.resolve()}getOverlaysForCollection(n,o,a){const h=hc(),_=o.length+1,w=new hn(o.child("")),S=this.overlays.getIteratorFrom(w);for(;S.hasNext();){const L=S.getNext().value,B=L.getKey();if(!o.isPrefixOf(B.path))break;B.path.length===_&&L.largestBatchId>a&&h.set(L.getKey(),L)}return qt.resolve(h)}getOverlaysForCollectionGroup(n,o,a,h){let _=new ci((B,H)=>B-H);const w=this.overlays.getIterator();for(;w.hasNext();){const B=w.getNext().value;if(B.getKey().getCollectionGroup()===o&&B.largestBatchId>a){let H=_.get(B.largestBatchId);null===H&&(H=hc(),_=_.insert(B.largestBatchId,H)),H.set(B.getKey(),B)}}const S=hc(),L=_.getIterator();for(;L.hasNext()&&(L.getNext().value.forEach((B,H)=>S.set(B,H)),!(S.size()>=h)););return qt.resolve(S)}we(n,o,a){const h=this.overlays.get(a.key);if(null!==h){const w=this.ls.get(h.largestBatchId).delete(a.key);this.ls.set(h.largestBatchId,w)}this.overlays=this.overlays.insert(a.key,new ny(o,a));let _=this.ls.get(o);void 0===_&&(_=Hr(),this.ls.set(o,_)),this.ls.set(o,_.add(a.key))}}class ex{constructor(){this.fs=new Ei(ss.ds),this.ws=new Ei(ss._s)}isEmpty(){return this.fs.isEmpty()}addReference(n,o){const a=new ss(n,o);this.fs=this.fs.add(a),this.ws=this.ws.add(a)}gs(n,o){n.forEach(a=>this.addReference(a,o))}removeReference(n,o){this.ys(new ss(n,o))}ps(n,o){n.forEach(a=>this.removeReference(a,o))}Is(n){const o=new hn(new io([])),a=new ss(o,n),h=new ss(o,n+1),_=[];return this.ws.forEachInRange([a,h],w=>{this.ys(w),_.push(w.key)}),_}Ts(){this.fs.forEach(n=>this.ys(n))}ys(n){this.fs=this.fs.delete(n),this.ws=this.ws.delete(n)}Es(n){const o=new hn(new io([])),a=new ss(o,n),h=new ss(o,n+1);let _=Hr();return this.ws.forEachInRange([a,h],w=>{_=_.add(w.key)}),_}containsKey(n){const o=new ss(n,0),a=this.fs.firstAfterOrEqual(o);return null!==a&&n.isEqual(a.key)}}class ss{constructor(n,o){this.key=n,this.As=o}static ds(n,o){return hn.comparator(n.key,o.key)||Br(n.As,o.As)}static _s(n,o){return Br(n.As,o.As)||hn.comparator(n.key,o.key)}}class ly{constructor(n,o){this.indexManager=n,this.referenceDelegate=o,this.mutationQueue=[],this.vs=1,this.Rs=new Ei(ss.ds)}checkEmpty(n){return qt.resolve(0===this.mutationQueue.length)}addMutationBatch(n,o,a,h){const _=this.vs;this.vs++;const w=new V1(_,o,a,h);this.mutationQueue.push(w);for(const S of h)this.Rs=this.Rs.add(new ss(S.key,_)),this.indexManager.addToCollectionParentIndex(n,S.key.path.popLast());return qt.resolve(w)}lookupMutationBatch(n,o){return qt.resolve(this.Ps(o))}getNextMutationBatchAfterBatchId(n,o){const h=this.bs(o+1),_=h<0?0:h;return qt.resolve(this.mutationQueue.length>_?this.mutationQueue[_]:null)}getHighestUnacknowledgedBatchId(){return qt.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(n){return qt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(n,o){const a=new ss(o,0),h=new ss(o,Number.POSITIVE_INFINITY),_=[];return this.Rs.forEachInRange([a,h],w=>{const S=this.Ps(w.As);_.push(S)}),qt.resolve(_)}getAllMutationBatchesAffectingDocumentKeys(n,o){let a=new Ei(Br);return o.forEach(h=>{const _=new ss(h,0),w=new ss(h,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([_,w],S=>{a=a.add(S.As)})}),qt.resolve(this.Vs(a))}getAllMutationBatchesAffectingQuery(n,o){const a=o.path,h=a.length+1;let _=a;hn.isDocumentKey(_)||(_=_.child(""));const w=new ss(new hn(_),0);let S=new Ei(Br);return this.Rs.forEachWhile(L=>{const B=L.key.path;return!!a.isPrefixOf(B)&&(B.length===h&&(S=S.add(L.As)),!0)},w),qt.resolve(this.Vs(S))}Vs(n){const o=[];return n.forEach(a=>{const h=this.Ps(a);null!==h&&o.push(h)}),o}removeMutationBatch(n,o){$n(0===this.Ss(o.batchId,"removed")),this.mutationQueue.shift();let a=this.Rs;return qt.forEach(o.mutations,h=>{const _=new ss(h.key,o.batchId);return a=a.delete(_),this.referenceDelegate.markPotentiallyOrphaned(n,h.key)}).next(()=>{this.Rs=a})}Cn(n){}containsKey(n,o){const a=new ss(o,0),h=this.Rs.firstAfterOrEqual(a);return qt.resolve(o.isEqual(h&&h.key))}performConsistencyCheck(n){return qt.resolve()}Ss(n,o){return this.bs(n)}bs(n){return 0===this.mutationQueue.length?0:n-this.mutationQueue[0].batchId}Ps(n){const o=this.bs(n);return o<0||o>=this.mutationQueue.length?null:this.mutationQueue[o]}}class OO{constructor(n){this.Ds=n,this.docs=new ci(hn.comparator),this.size=0}setIndexManager(n){this.indexManager=n}addEntry(n,o){const a=o.key,h=this.docs.get(a),_=h?h.size:0,w=this.Ds(o);return this.docs=this.docs.insert(a,{document:o.mutableCopy(),size:w}),this.size+=w-_,this.indexManager.addToCollectionParentIndex(n,a.path.popLast())}removeEntry(n){const o=this.docs.get(n);o&&(this.docs=this.docs.remove(n),this.size-=o.size)}getEntry(n,o){const a=this.docs.get(o);return qt.resolve(a?a.document.mutableCopy():li.newInvalidDocument(o))}getEntries(n,o){let a=Us();return o.forEach(h=>{const _=this.docs.get(h);a=a.insert(h,_?_.document.mutableCopy():li.newInvalidDocument(h))}),qt.resolve(a)}getDocumentsMatchingQuery(n,o,a,h){let _=Us();const w=o.path,S=new hn(w.child("")),L=this.docs.getIteratorFrom(S);for(;L.hasNext();){const{key:B,value:{document:H}}=L.getNext();if(!w.isPrefixOf(B.path))break;B.path.length>w.length+1||F_(Ug(H),a)<=0||(h.has(H.key)||Zc(o,H))&&(_=_.insert(H.key,H.mutableCopy()))}return qt.resolve(_)}getAllFromCollectionGroup(n,o,a,h){wn()}Cs(n,o){return qt.forEach(this.docs,a=>o(a))}newChangeBuffer(n){return new EO(this)}getSize(n){return qt.resolve(this.size)}}class EO extends xO{constructor(n){super(),this.os=n}applyChanges(n){const o=[];return this.changes.forEach((a,h)=>{h.isValidDocument()?o.push(this.os.addEntry(n,h)):this.os.removeEntry(a)}),qt.waitFor(o)}getFromCache(n,o){return this.os.getEntry(n,o)}getAllFromCache(n,o){return this.os.getEntries(n,o)}}class GT{constructor(n){this.persistence=n,this.xs=new vf(o=>_f(o),Qg),this.lastRemoteSnapshotVersion=Rn.min(),this.highestTargetId=0,this.Ns=0,this.ks=new ex,this.targetCount=0,this.Ms=_c.kn()}forEachTarget(n,o){return this.xs.forEach((a,h)=>o(h)),qt.resolve()}getLastRemoteSnapshotVersion(n){return qt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(n){return qt.resolve(this.Ns)}allocateTargetId(n){return this.highestTargetId=this.Ms.next(),qt.resolve(this.highestTargetId)}setTargetsMetadata(n,o,a){return a&&(this.lastRemoteSnapshotVersion=a),o>this.Ns&&(this.Ns=o),qt.resolve()}Fn(n){this.xs.set(n.target,n);const o=n.targetId;o>this.highestTargetId&&(this.Ms=new _c(o),this.highestTargetId=o),n.sequenceNumber>this.Ns&&(this.Ns=n.sequenceNumber)}addTargetData(n,o){return this.Fn(o),this.targetCount+=1,qt.resolve()}updateTargetData(n,o){return this.Fn(o),qt.resolve()}removeTargetData(n,o){return this.xs.delete(o.target),this.ks.Is(o.targetId),this.targetCount-=1,qt.resolve()}removeTargets(n,o,a){let h=0;const _=[];return this.xs.forEach((w,S)=>{S.sequenceNumber<=o&&null===a.get(S.targetId)&&(this.xs.delete(w),_.push(this.removeMatchingKeysForTargetId(n,S.targetId)),h++)}),qt.waitFor(_).next(()=>h)}getTargetCount(n){return qt.resolve(this.targetCount)}getTargetData(n,o){const a=this.xs.get(o)||null;return qt.resolve(a)}addMatchingKeys(n,o,a){return this.ks.gs(o,a),qt.resolve()}removeMatchingKeys(n,o,a){this.ks.ps(o,a);const h=this.persistence.referenceDelegate,_=[];return h&&o.forEach(w=>{_.push(h.markPotentiallyOrphaned(n,w))}),qt.waitFor(_)}removeMatchingKeysForTargetId(n,o){return this.ks.Is(o),qt.resolve()}getMatchingKeysForTargetId(n,o){const a=this.ks.Es(o);return qt.resolve(a)}containsKey(n,o){return qt.resolve(this.ks.containsKey(o))}}class uh{constructor(n,o){this.$s={},this.overlays={},this.Os=new cc(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=n(this),this.Bs=new GT(this),this.indexManager=new wC,this.remoteDocumentCache=new OO(a=>this.referenceDelegate.Ls(a)),this.serializer=new _C(o),this.qs=new MO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(n){return this.indexManager}getDocumentOverlayCache(n){let o=this.overlays[n.toKey()];return o||(o=new PO,this.overlays[n.toKey()]=o),o}getMutationQueue(n,o){let a=this.$s[n.toKey()];return a||(a=new ly(o,this.referenceDelegate),this.$s[n.toKey()]=a),a}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(n,o,a){ze("MemoryPersistence","Starting transaction:",n);const h=new cy(this.Os.next());return this.referenceDelegate.Us(),a(h).next(_=>this.referenceDelegate.Ks(h).next(()=>_)).toPromise().then(_=>(h.raiseOnCommittedEvent(),_))}Gs(n,o){return qt.or(Object.values(this.$s).map(a=>()=>a.containsKey(n,o)))}}class cy extends z_{constructor(n){super(),this.currentSequenceNumber=n}}class hv{constructor(n){this.persistence=n,this.Qs=new ex,this.js=null}static zs(n){return new hv(n)}get Ws(){if(this.js)return this.js;throw wn()}addReference(n,o,a){return this.Qs.addReference(a,o),this.Ws.delete(a.toString()),qt.resolve()}removeReference(n,o,a){return this.Qs.removeReference(a,o),this.Ws.add(a.toString()),qt.resolve()}markPotentiallyOrphaned(n,o){return this.Ws.add(o.toString()),qt.resolve()}removeTarget(n,o){this.Qs.Is(o.targetId).forEach(h=>this.Ws.add(h.toString()));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(n,o.targetId).next(h=>{h.forEach(_=>this.Ws.add(_.toString()))}).next(()=>a.removeTargetData(n,o))}Us(){this.js=new Set}Ks(n){const o=this.persistence.getRemoteDocumentCache().newChangeBuffer();return qt.forEach(this.Ws,a=>{const h=hn.fromPath(a);return this.Hs(n,h).next(_=>{_||o.removeEntry(h,Rn.min())})}).next(()=>(this.js=null,o.apply(n)))}updateLimboDocument(n,o){return this.Hs(n,o).next(a=>{a?this.Ws.delete(o.toString()):this.Ws.add(o.toString())})}Ls(n){return 0}Hs(n,o){return qt.or([()=>qt.resolve(this.Qs.containsKey(o)),()=>this.persistence.getTargetCache().containsKey(n,o),()=>this.persistence.Gs(n,o)])}}class IC{constructor(n,o,a,h){this.targetId=n,this.fromCache=o,this.Fi=a,this.Bi=h}static Li(n,o){let a=Hr(),h=Hr();for(const _ of o.docChanges)switch(_.type){case 0:a=a.add(_.doc.key);break;case 1:h=h.add(_.doc.key)}return new IC(n,o.fromCache,a,h)}}class TO{constructor(){this.qi=!1}initialize(n,o){this.Ui=n,this.indexManager=o,this.qi=!0}getDocumentsMatchingQuery(n,o,a,h){return this.Ki(n,o).next(_=>_||this.Gi(n,o,h,a)).next(_=>_||this.Qi(n,o))}Ki(n,o){if(eC(o))return qt.resolve(null);let a=Ti(o);return this.indexManager.getIndexType(n,a).next(h=>0===h?null:(null!==o.limit&&1===h&&(o=hl(o,null,"F"),a=Ti(o)),this.indexManager.getDocumentsMatchingTarget(n,a).next(_=>{const w=Hr(..._);return this.Ui.getDocuments(n,w).next(S=>this.indexManager.getMinOffset(n,a).next(L=>{const B=this.ji(o,S);return this.zi(o,B,w,L.readTime)?this.Ki(n,hl(o,null,"F")):this.Wi(n,B,o,L)}))})))}Gi(n,o,a,h){return eC(o)||h.isEqual(Rn.min())?this.Qi(n,o):this.Ui.getDocuments(n,a).next(_=>{const w=this.ji(o,_);return this.zi(o,w,a,h)?this.Qi(n,o):(p1()<=Kl.in.DEBUG&&ze("QueryEngine","Re-using previous result from %s to execute query: %s",h.toString(),j0(o)),this.Wi(n,w,o,function Oi(i,n){const o=i.toTimestamp().seconds,a=i.toTimestamp().nanoseconds+1,h=Rn.fromTimestamp(1e9===a?new An(o+1,0):new An(o,a));return new Sl(h,hn.empty(),n)}(h,-1)))})}ji(n,o){let a=new Ei(rO(n));return o.forEach((h,_)=>{Zc(n,_)&&(a=a.add(_))}),a}zi(n,o,a,h){if(null===n.limit)return!1;if(a.size!==o.size)return!0;const _="F"===n.limitType?o.last():o.first();return!!_&&(_.hasPendingWrites||_.version.compareTo(h)>0)}Qi(n,o){return p1()<=Kl.in.DEBUG&&ze("QueryEngine","Using full collection scan to execute query:",j0(o)),this.Ui.getDocumentsMatchingQuery(n,o,Sl.min())}Wi(n,o,a,h){return this.Ui.getDocumentsMatchingQuery(n,a,h).next(_=>(o.forEach(w=>{_=_.insert(w.key,w)}),_))}}class If{constructor(n,o,a,h){this.persistence=n,this.Hi=o,this.serializer=h,this.Ji=new ci(Br),this.Yi=new vf(_=>_f(_),Qg),this.Xi=new Map,this.Zi=n.getRemoteDocumentCache(),this.Bs=n.getTargetCache(),this.qs=n.getBundleCache(),this.tr(a)}tr(n){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(n),this.indexManager=this.persistence.getIndexManager(n),this.mutationQueue=this.persistence.getMutationQueue(n,this.indexManager),this.localDocuments=new Xc(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(n){return this.persistence.runTransaction("Collect garbage","readwrite-primary",o=>n.collect(o,this.Ji))}}function ox(i,n){return Zp.apply(this,arguments)}function Zp(){return Zp=(0,Je.Z)(function*(i,n){const o=_n(i);return yield o.persistence.runTransaction("Handle user change","readonly",a=>{let h;return o.mutationQueue.getAllMutationBatches(a).next(_=>(h=_,o.tr(n),o.mutationQueue.getAllMutationBatches(a))).next(_=>{const w=[],S=[];let L=Hr();for(const B of h){w.push(B.batchId);for(const H of B.mutations)L=L.add(H.key)}for(const B of _){S.push(B.batchId);for(const H of B.mutations)L=L.add(H.key)}return o.localDocuments.getDocuments(a,L).next(B=>({er:B,removedBatchIds:w,addedBatchIds:S}))})})}),Zp.apply(this,arguments)}function SC(i){const n=_n(i);return n.persistence.runTransaction("Get last remote snapshot version","readonly",o=>n.Bs.getLastRemoteSnapshotVersion(o))}function vv(i,n){const o=_n(i);return o.persistence.runTransaction("Get next mutation batch","readonly",a=>(void 0===n&&(n=-1),o.mutationQueue.getNextMutationBatchAfterBatchId(a,n)))}function pm(i,n,o){return gm.apply(this,arguments)}function gm(){return gm=(0,Je.Z)(function*(i,n,o){const a=_n(i),h=a.Ji.get(n),_=o?"readwrite":"readwrite-primary";try{o||(yield a.persistence.runTransaction("Release target",_,w=>a.persistence.referenceDelegate.removeTarget(w,h)))}catch(w){if(!Dp(w))throw w;ze("LocalStore",`Failed to update sequence numbers for target ${n}: ${w}`)}a.Ji=a.Ji.remove(n),a.Yi.delete(h.target)}),gm.apply(this,arguments)}function bv(i,n,o){const a=_n(i);let h=Rn.min(),_=Hr();return a.persistence.runTransaction("Execute query","readonly",w=>function(S,L,B){const H=_n(S),Y=H.Yi.get(B);return void 0!==Y?qt.resolve(H.Ji.get(Y)):H.Bs.getTargetData(L,B)}(a,w,Ti(n)).next(S=>{if(S)return h=S.lastLimboFreeSnapshotVersion,a.Bs.getMatchingKeysForTargetId(w,S.targetId).next(L=>{_=L})}).next(()=>a.Hi.getDocumentsMatchingQuery(w,n,o?h:Rn.min(),o?_:Hr())).next(S=>(function xv(i,n,o){let a=i.Xi.get(n)||Rn.min();o.forEach((h,_)=>{_.readTime.compareTo(a)>0&&(a=_.readTime)}),i.Xi.set(n,a)}(a,function Z_(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}(n),S),{documents:S,ir:_})))}class dx{constructor(){this.activeTargetIds=function K_(){return rC}()}lr(n){this.activeTargetIds=this.activeTargetIds.add(n)}dr(n){this.activeTargetIds=this.activeTargetIds.delete(n)}hr(){const n={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(n)}}class fx{constructor(){this.Hr=new dx,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(n){}updateMutationState(n,o,a){}addLocalQueryTarget(n){return this.Hr.lr(n),this.Jr[n]||"not-current"}updateQueryState(n,o,a){this.Jr[n]=o}removeLocalQueryTarget(n){this.Hr.dr(n)}isLocalQueryTarget(n){return this.Hr.activeTargetIds.has(n)}clearQueryState(n){delete this.Jr[n]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(n){return this.Hr.activeTargetIds.has(n)}start(){return this.Hr=new dx,Promise.resolve()}handleUserChange(n,o,a){}setOnlineState(n){}shutdown(){}writeSequenceNumber(n){}notifyBundleLoaded(n){}}class ZT{Yr(n){}shutdown(){}}class DO{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(n){this.so.push(n)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){ze("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const n of this.so)n(0)}no(){ze("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const n of this.so)n(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let wv=null;function fy(){return null===wv?wv=268435456+Math.round(2147483648*Math.random()):wv++,"0x"+wv.toString(16)}const kO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class DC{constructor(n){this.ro=n.ro,this.oo=n.oo}uo(n){this.co=n}ao(n){this.ho=n}onMessage(n){this.lo=n}close(){this.oo()}send(n){this.ro(n)}fo(){this.co()}wo(n){this.ho(n)}_o(n){this.lo(n)}}const ya="WebChannelConnection";class RO extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId,this.mo=(n.ssl?"https":"http")+"://"+n.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(n,o,a,h,_){const w=fy(),S=this.To(n,o);ze("RestConnection",`Sending RPC '${n}' ${w}:`,S,a);const L={};return this.Eo(L,h,_),this.Ao(n,S,L,a).then(B=>(ze("RestConnection",`Received RPC '${n}' ${w}: `,B),B),B=>{throw lc("RestConnection",`RPC '${n}' ${w} failed with error: `,B,"url: ",S,"request:",a),B})}vo(n,o,a,h,_,w){return this.Io(n,o,a,h,_)}Eo(n,o,a){n["X-Goog-Api-Client"]="gl-js/ fire/"+_a,n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),o&&o.headers.forEach((h,_)=>n[_]=h),a&&a.headers.forEach((h,_)=>n[_]=h)}To(n,o){return`${this.mo}/v1/${o}:${kO[n]}`}}{constructor(n){super(n),this.forceLongPolling=n.forceLongPolling,this.autoDetectLongPolling=n.autoDetectLongPolling,this.useFetchStreams=n.useFetchStreams,this.longPollingOptions=n.longPollingOptions}Ao(n,o,a,h){const _=fy();return new Promise((w,S)=>{const L=new zP;L.setWithCredentials(!0),L.listenOnce(FP.COMPLETE,()=>{try{switch(L.getLastErrorCode()){case zg.NO_ERROR:const H=L.getResponseJson();ze(ya,`XHR for RPC '${n}' ${_} received:`,JSON.stringify(H)),w(H);break;case zg.TIMEOUT:ze(ya,`RPC '${n}' ${_} timed out`),S(new Se(Jt.DEADLINE_EXCEEDED,"Request time out"));break;case zg.HTTP_ERROR:const Y=L.getStatus();if(ze(ya,`RPC '${n}' ${_} failed with status:`,Y,"response text:",L.getResponseText()),Y>0){let pt=L.getResponseJson();Array.isArray(pt)&&(pt=pt[0]);const xt=pt?.error;if(xt&&xt.status&&xt.message){const At=function(Ut){const Zt=Ut.toLowerCase().replace(/_/g,"-");return Object.values(Jt).indexOf(Zt)>=0?Zt:Jt.UNKNOWN}(xt.status);S(new Se(At,xt.message))}else S(new Se(Jt.UNKNOWN,"Server responded with status "+L.getStatus()))}else S(new Se(Jt.UNAVAILABLE,"Connection failed."));break;default:wn()}}finally{ze(ya,`RPC '${n}' ${_} completed.`)}});const B=JSON.stringify(h);ze(ya,`RPC '${n}' ${_} sending request:`,h),L.send(o,"POST",B,a,15)})}Ro(n,o,a){const h=fy(),_=[this.mo,"/","google.firestore.v1.Firestore","/",n,"/channel"],w=NP(),S=ET(),L={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},B=this.longPollingOptions.timeoutSeconds;void 0!==B&&(L.longPollingTimeout=Math.round(1e3*B)),this.useFetchStreams&&(L.xmlHttpFactory=new Vw({})),this.Eo(L.initMessageHeaders,o,a),L.encodeInitMessageHeaders=!0;const H=_.join("");ze(ya,`Creating RPC '${n}' stream ${h}: ${H}`,L);const Y=w.createWebChannel(H,L);let pt=!1,xt=!1;const At=new DC({ro:Zt=>{xt?ze(ya,`Not sending because RPC '${n}' stream ${h} is closed:`,Zt):(pt||(ze(ya,`Opening RPC '${n}' stream ${h} transport.`),Y.open(),pt=!0),ze(ya,`RPC '${n}' stream ${h} sending:`,Zt),Y.send(Zt))},oo:()=>Y.close()}),Ut=(Zt,qe,fn)=>{Zt.listen(qe,$e=>{try{fn($e)}catch(cn){setTimeout(()=>{throw cn},0)}})};return Ut(Y,$c.EventType.OPEN,()=>{xt||ze(ya,`RPC '${n}' stream ${h} transport opened.`)}),Ut(Y,$c.EventType.CLOSE,()=>{xt||(xt=!0,ze(ya,`RPC '${n}' stream ${h} transport closed`),At.wo())}),Ut(Y,$c.EventType.ERROR,Zt=>{xt||(xt=!0,lc(ya,`RPC '${n}' stream ${h} transport errored:`,Zt),At.wo(new Se(Jt.UNAVAILABLE,"The operation could not be completed")))}),Ut(Y,$c.EventType.MESSAGE,Zt=>{var qe;if(!xt){const fn=Zt.data[0];$n(!!fn);const cn=fn.error||(null===(qe=fn[0])||void 0===qe?void 0:qe.error);if(cn){ze(ya,`RPC '${n}' stream ${h} received error:`,cn);const Mr=cn.status;let Cr=function(ks){const ou=di[ks];if(void 0!==ou)return Y0(ou)}(Mr),Uo=cn.message;void 0===Cr&&(Cr=Jt.INTERNAL,Uo="Unknown error status: "+Mr+" with message "+cn.message),xt=!0,At.wo(new Se(Cr,Uo)),Y.close()}else ze(ya,`RPC '${n}' stream ${h} received:`,fn),At._o(fn)}}),Ut(S,f1.STAT_EVENT,Zt=>{Zt.stat===Uw.PROXY?ze(ya,`RPC '${n}' stream ${h} detected buffering proxy`):Zt.stat===Uw.NOPROXY&&ze(ya,`RPC '${n}' stream ${h} detected no buffering proxy`)}),setTimeout(()=>{At.fo()},0),At}}function px(){return typeof document<"u"?document:null}function Cv(i){return new Ki(i,!0)}class kC{constructor(n,o,a=1e3,h=1.5,_=6e4){this.ii=n,this.timerId=o,this.Po=a,this.bo=h,this.Vo=_,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(n){this.cancel();const o=Math.floor(this.So+this.ko()),a=Math.max(0,Date.now()-this.Co),h=Math.max(0,o-a);h>0&&ze("ExponentialBackoff",`Backing off for ${h} ms (base delay: ${this.So} ms, delay with jitter: ${o} ms, last attempt: ${a} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,h,()=>(this.Co=Date.now(),n())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}class RC{constructor(n,o,a,h,_,w,S,L){this.ii=n,this.$o=a,this.Oo=h,this.connection=_,this.authCredentialsProvider=w,this.appCheckCredentialsProvider=S,this.listener=L,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new kC(n,o)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}stop(){var n=this;return(0,Je.Z)(function*(){n.Uo()&&(yield n.close(0))})()}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(n){this.Ho(),this.stream.send(n)}zo(){var n=this;return(0,Je.Z)(function*(){if(n.Ko())return n.close(0)})()}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}close(n,o){var a=this;return(0,Je.Z)(function*(){a.Ho(),a.Jo(),a.qo.cancel(),a.Fo++,4!==n?a.qo.reset():o&&o.code===Jt.RESOURCE_EXHAUSTED?(rs(o.toString()),rs("Using maximum backoff delay to prevent overloading the backend."),a.qo.xo()):o&&o.code===Jt.UNAUTHENTICATED&&3!==a.state&&(a.authCredentialsProvider.invalidateToken(),a.appCheckCredentialsProvider.invalidateToken()),null!==a.stream&&(a.Yo(),a.stream.close(),a.stream=null),a.state=n,yield a.listener.ao(o)})()}Yo(){}auth(){this.state=1;const n=this.Xo(this.Fo),o=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,h])=>{this.Fo===o&&this.Zo(a,h)},a=>{n(()=>{const h=new Se(Jt.UNKNOWN,"Fetching auth token failed: "+a.message);return this.tu(h)})})}Zo(n,o){const a=this.Xo(this.Fo);this.stream=this.eu(n,o),this.stream.uo(()=>{a(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(h=>{a(()=>this.tu(h))}),this.stream.onMessage(h=>{a(()=>this.onMessage(h))})}Go(){var n=this;this.state=5,this.qo.No((0,Je.Z)(function*(){n.state=0,n.start()}))}tu(n){return ze("PersistentStream",`close with error: ${n}`),this.stream=null,this.close(4,n)}Xo(n){return o=>{this.ii.enqueueAndForget(()=>this.Fo===n?o():(ze("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Qc extends RC{constructor(n,o,a,h,_,w){super(n,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",o,a,h,w),this.serializer=_}eu(n,o){return this.connection.Ro("Listen",n,o)}onMessage(n){this.qo.reset();const o=function rh(i,n){let o;if("targetChange"in n){const a="NO_CHANGE"===(L=n.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===L?1:"REMOVE"===L?2:"CURRENT"===L?3:"RESET"===L?4:wn(),h=n.targetChange.targetIds||[],_=function(L,B){return L.useProto3Json?($n(void 0===B||"string"==typeof B),ys.fromBase64String(B||"")):($n(void 0===B||B instanceof Uint8Array),ys.fromUint8Array(B||new Uint8Array))}(i,n.targetChange.resumeToken),w=n.targetChange.cause,S=w&&function(L){const B=void 0===L.code?Jt.UNKNOWN:Y0(L.code);return new Se(B,L.message||"")}(w);o=new Qu(a,h,_,S||null)}else if("documentChange"in n){const a=n.documentChange,h=nh(i,a.document.name),_=_r(a.document.updateTime),w=a.document.createTime?_r(a.document.createTime):Rn.min(),S=new ui({mapValue:{fields:a.document.fields}}),L=li.newFoundDocument(h,_,w,S);o=new pc(a.targetIds||[],a.removedTargetIds||[],L.key,L)}else if("documentDelete"in n){const a=n.documentDelete,h=nh(i,a.document),_=a.readTime?_r(a.readTime):Rn.min(),w=li.newNoDocument(h,_);o=new pc([],a.removedTargetIds||[],w.key,w)}else if("documentRemove"in n){const a=n.documentRemove,h=nh(i,a.document);o=new pc([],a.removedTargetIds||[],h,null)}else{if(!("filter"in n))return wn();{const a=n.filter,{count:h=0,unchangedNames:_}=a,w=new W0(h,_);o=new fl(a.targetId,w)}}var L;return o}(this.serializer,n),a=function(h){if(!("targetChange"in h))return Rn.min();const _=h.targetChange;return _.targetIds&&_.targetIds.length?Rn.min():_.readTime?_r(_.readTime):Rn.min()}(n);return this.listener.nu(o,a)}su(n){const o={};o.database=tv(this.serializer),o.addTarget=function(h,_){let w;const S=_.target;if(w=H_(S)?{documents:Wc(h,S)}:{query:gc(h,S)},w.targetId=_.targetId,_.resumeToken.approximateByteSize()>0){w.resumeToken=uO(h,_.resumeToken);const L=G1(h,_.expectedCount);null!==L&&(w.expectedCount=L)}else if(_.snapshotVersion.compareTo(Rn.min())>0){w.readTime=im(h,_.snapshotVersion.toTimestamp());const L=G1(h,_.expectedCount);null!==L&&(w.expectedCount=L)}return w}(this.serializer,n);const a=function hO(i,n){const o=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return wn()}}(n.purpose);return null==o?null:{"goog-listen-tags":o}}(0,n);a&&(o.labels=a),this.Wo(o)}iu(n){const o={};o.database=tv(this.serializer),o.removeTarget=n,this.Wo(o)}}class NO extends RC{constructor(n,o,a,h,_,w){super(n,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",o,a,h,w),this.serializer=_,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(n,o){return this.connection.Ro("Write",n,o)}onMessage(n){if($n(!!n.streamToken),this.lastStreamToken=n.streamToken,this.ru){this.qo.reset();const o=function oh(i,n){return i&&i.length>0?($n(void 0!==n),i.map(o=>function(a,h){let _=_r(a.updateTime?a.updateTime:h);return _.isEqual(Rn.min())&&(_=_r(h)),new X_(_,a.transformResults||[])}(o,n))):[]}(n.writeResults,n.commitTime),a=_r(n.commitTime);return this.listener.cu(a,o)}return $n(!n.writeResults||0===n.writeResults.length),this.ru=!0,this.listener.au()}hu(){const n={};n.database=tv(this.serializer),this.Wo(n)}uu(n){const o={streamToken:this.lastStreamToken,writes:n.map(a=>function ev(i,n){let o;if(n instanceof rm)o={update:NT(i,n.key,n.value)};else if(n instanceof Jd)o={delete:eh(i,n.key)};else if(n instanceof kl)o={update:NT(i,n.key,n.data),updateMask:gO(n.fieldMask)};else{if(!(n instanceof U1))return wn();o={verify:eh(i,n.key)}}return n.fieldTransforms.length>0&&(o.updateTransforms=n.fieldTransforms.map(a=>function(h,_){const w=_.transform;if(w instanceof nm)return{fieldPath:_.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(w instanceof Na)return{fieldPath:_.field.canonicalString(),appendMissingElements:{values:w.elements}};if(w instanceof Xu)return{fieldPath:_.field.canonicalString(),removeAllFromArray:{values:w.elements}};if(w instanceof fc)return{fieldPath:_.field.canonicalString(),increment:w.gt};throw wn()}(0,a))),n.precondition.isNone||(o.currentDocument=void 0!==(h=n.precondition).updateTime?{updateTime:dO(i,h.updateTime)}:void 0!==h.exists?{exists:h.exists}:wn()),o;var h}(this.serializer,a))};this.Wo(o)}}class FO extends class{}{constructor(n,o,a,h){super(),this.authCredentials=n,this.appCheckCredentials=o,this.connection=a,this.serializer=h,this.lu=!1}fu(){if(this.lu)throw new Se(Jt.FAILED_PRECONDITION,"The client has already been terminated.")}Io(n,o,a){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([h,_])=>this.connection.Io(n,o,a,h,_)).catch(h=>{throw"FirebaseError"===h.name?(h.code===Jt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),h):new Se(Jt.UNKNOWN,h.toString())})}vo(n,o,a,h){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([_,w])=>this.connection.vo(n,o,a,_,w,h)).catch(_=>{throw"FirebaseError"===_.name?(_.code===Jt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),_):new Se(Jt.UNKNOWN,_.toString())})}terminate(){this.lu=!0}}class zO{constructor(n,o){this.asyncQueue=n,this.onlineStateHandler=o,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(n){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${n.toString()}`),this.yu("Offline")))}set(n){this.Tu(),this.wu=0,"Online"===n&&(this.mu=!1),this.yu(n)}yu(n){n!==this.state&&(this.state=n,this.onlineStateHandler(n))}pu(n){const o=`Could not reach Cloud Firestore backend. ${n}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(rs(o),this.mu=!1):ze("OnlineStateTracker",o)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}class KT{constructor(n,o,a,h,_){var w=this;this.localStore=n,this.datastore=o,this.asyncQueue=a,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=_,this.Pu.Yr(S=>{a.enqueueAndForget((0,Je.Z)(function*(){var L;od(w)&&(ze("RemoteStore","Restarting streams for network reachability change."),yield(L=(0,Je.Z)(function*(B){const H=_n(B);H.vu.add(4),yield py(H),H.bu.set("Unknown"),H.vu.delete(4),yield Kp(H)}),function(B){return L.apply(this,arguments)})(w))}))}),this.bu=new zO(a,h)}}function Kp(i){return LC.apply(this,arguments)}function LC(){return LC=(0,Je.Z)(function*(i){if(od(i))for(const n of i.Ru)yield n(!0)}),LC.apply(this,arguments)}function py(i){return Pv.apply(this,arguments)}function Pv(){return Pv=(0,Je.Z)(function*(i){for(const n of i.Ru)yield n(!1)}),Pv.apply(this,arguments)}function mm(i,n){const o=_n(i);o.Au.has(n.targetId)||(o.Au.set(n.targetId,n),rd(o)?gx(o):Xp(o).Ko()&&Ov(o,n))}function gy(i,n){const o=_n(i),a=Xp(o);o.Au.delete(n),a.Ko()&&NC(o,n),0===o.Au.size&&(a.Ko()?a.jo():od(o)&&o.bu.set("Unknown"))}function Ov(i,n){if(i.Vu.qt(n.targetId),n.resumeToken.approximateByteSize()>0||n.snapshotVersion.compareTo(Rn.min())>0){const o=i.remoteSyncer.getRemoteKeysForTarget(n.targetId).size;n=n.withExpectedCount(o)}Xp(i).su(n)}function NC(i,n){i.Vu.qt(n),Xp(i).iu(n)}function gx(i){i.Vu=new wf({getRemoteKeysForTarget:n=>i.remoteSyncer.getRemoteKeysForTarget(n),le:n=>i.Au.get(n)||null,ue:()=>i.datastore.serializer.databaseId}),Xp(i).start(),i.bu.gu()}function rd(i){return od(i)&&!Xp(i).Uo()&&i.Au.size>0}function od(i){return 0===_n(i).vu.size}function mx(i){i.Vu=void 0}function Yp(i){return Ev.apply(this,arguments)}function Ev(){return Ev=(0,Je.Z)(function*(i){i.Au.forEach((n,o)=>{Ov(i,n)})}),Ev.apply(this,arguments)}function YT(i,n){return BO.apply(this,arguments)}function BO(){return BO=(0,Je.Z)(function*(i,n){mx(i),rd(i)?(i.bu.Iu(n),gx(i)):i.bu.set("Unknown")}),BO.apply(this,arguments)}function FC(i,n,o){return Tv.apply(this,arguments)}function Tv(){return Tv=(0,Je.Z)(function*(i,n,o){if(i.bu.set("Online"),n instanceof Qu&&2===n.state&&n.cause)try{yield(a=(0,Je.Z)(function*(h,_){const w=_.cause;for(const S of _.targetIds)h.Au.has(S)&&(yield h.remoteSyncer.rejectListen(S,w),h.Au.delete(S),h.Vu.removeTarget(S))}),function(h,_){return a.apply(this,arguments)})(i,n)}catch(a){ze("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),a),yield Iv(i,a)}else if(n instanceof pc?i.Vu.Ht(n):n instanceof fl?i.Vu.ne(n):i.Vu.Xt(n),!o.isEqual(Rn.min()))try{const a=yield SC(i.localStore);o.compareTo(a)>=0&&(yield function(h,_){const w=h.Vu.ce(_);return w.targetChanges.forEach((S,L)=>{if(S.resumeToken.approximateByteSize()>0){const B=h.Au.get(L);B&&h.Au.set(L,B.withResumeToken(S.resumeToken,_))}}),w.targetMismatches.forEach((S,L)=>{const B=h.Au.get(S);if(!B)return;h.Au.set(S,B.withResumeToken(ys.EMPTY_BYTE_STRING,B.snapshotVersion)),NC(h,S);const H=new Cf(B.target,S,L,B.sequenceNumber);Ov(h,H)}),h.remoteSyncer.applyRemoteEvent(w)}(i,o))}catch(a){ze("RemoteStore","Failed to raise snapshot:",a),yield Iv(i,a)}var a}),Tv.apply(this,arguments)}function Iv(i,n,o){return _m.apply(this,arguments)}function _m(){return _m=(0,Je.Z)(function*(i,n,o){if(!Dp(n))throw n;i.vu.add(1),yield py(i),i.bu.set("Offline"),o||(o=()=>SC(i.localStore)),i.asyncQueue.enqueueRetryable((0,Je.Z)(function*(){ze("RemoteStore","Retrying IndexedDB access"),yield o(),i.vu.delete(1),yield Kp(i)}))}),_m.apply(this,arguments)}function _x(i,n){return n().catch(o=>Iv(i,o,n))}function my(i){return yx.apply(this,arguments)}function yx(){return yx=(0,Je.Z)(function*(i){const n=_n(i),o=yc(n);let a=n.Eu.length>0?n.Eu[n.Eu.length-1].batchId:-1;for(;Sv(n);)try{const h=yield vv(n.localStore,a);if(null===h){0===n.Eu.length&&o.jo();break}a=h.batchId,vx(n,h)}catch(h){yield Iv(n,h)}ym(n)&&bx(n)}),yx.apply(this,arguments)}function Sv(i){return od(i)&&i.Eu.length<10}function vx(i,n){i.Eu.push(n);const o=yc(i);o.Ko()&&o.ou&&o.uu(n.mutations)}function ym(i){return od(i)&&!yc(i).Uo()&&i.Eu.length>0}function bx(i){yc(i).start()}function xx(i){return _y.apply(this,arguments)}function _y(){return _y=(0,Je.Z)(function*(i){yc(i).hu()}),_y.apply(this,arguments)}function UO(i){return wx.apply(this,arguments)}function wx(){return wx=(0,Je.Z)(function*(i){const n=yc(i);for(const o of i.Eu)n.uu(o.mutations)}),wx.apply(this,arguments)}function VO(i,n,o){return Cx.apply(this,arguments)}function Cx(){return Cx=(0,Je.Z)(function*(i,n,o){const a=i.Eu.shift(),h=ey.from(a,n,o);yield _x(i,()=>i.remoteSyncer.applySuccessfulWrite(h)),yield my(i)}),Cx.apply(this,arguments)}function jO(i,n){return Av.apply(this,arguments)}function Av(){return Av=(0,Je.Z)(function*(i,n){var o;n&&yc(i).ou&&(yield(o=(0,Je.Z)(function*(a,h){if(function K0(i){switch(i){default:return wn();case Jt.CANCELLED:case Jt.UNKNOWN:case Jt.DEADLINE_EXCEEDED:case Jt.RESOURCE_EXHAUSTED:case Jt.INTERNAL:case Jt.UNAVAILABLE:case Jt.UNAUTHENTICATED:return!1;case Jt.INVALID_ARGUMENT:case Jt.NOT_FOUND:case Jt.ALREADY_EXISTS:case Jt.PERMISSION_DENIED:case Jt.FAILED_PRECONDITION:case Jt.ABORTED:case Jt.OUT_OF_RANGE:case Jt.UNIMPLEMENTED:case Jt.DATA_LOSS:return!0}}(_=h.code)&&_!==Jt.ABORTED){const w=a.Eu.shift();yc(a).Qo(),yield _x(a,()=>a.remoteSyncer.rejectFailedWrite(w.batchId,h)),yield my(a)}var _}),function(a,h){return o.apply(this,arguments)})(i,n)),ym(i)&&bx(i)}),Av.apply(this,arguments)}function zC(i,n){return Mx.apply(this,arguments)}function Mx(){return Mx=(0,Je.Z)(function*(i,n){const o=_n(i);o.asyncQueue.verifyOperationInProgress(),ze("RemoteStore","RemoteStore received new credentials");const a=od(o);o.vu.add(3),yield py(o),a&&o.bu.set("Unknown"),yield o.remoteSyncer.handleCredentialChange(n),o.vu.delete(3),yield Kp(o)}),Mx.apply(this,arguments)}function BC(){return BC=(0,Je.Z)(function*(i,n){const o=_n(i);n?(o.vu.delete(2),yield Kp(o)):n||(o.vu.add(2),yield py(o),o.bu.set("Unknown"))}),BC.apply(this,arguments)}function Xp(i){return i.Su||(i.Su=function(n,o,a){const h=_n(n);return h.fu(),new Qc(o,h.connection,h.authCredentials,h.appCheckCredentials,h.serializer,a)}(i.datastore,i.asyncQueue,{uo:Yp.bind(null,i),ao:YT.bind(null,i),nu:FC.bind(null,i)}),i.Ru.push(function(){var n=(0,Je.Z)(function*(o){o?(i.Su.Qo(),rd(i)?gx(i):i.bu.set("Unknown")):(yield i.Su.stop(),mx(i))});return function(o){return n.apply(this,arguments)}}())),i.Su}function yc(i){return i.Du||(i.Du=function(n,o,a){const h=_n(n);return h.fu(),new NO(o,h.connection,h.authCredentials,h.appCheckCredentials,h.serializer,a)}(i.datastore,i.asyncQueue,{uo:xx.bind(null,i),ao:jO.bind(null,i),au:UO.bind(null,i),cu:VO.bind(null,i)}),i.Ru.push(function(){var n=(0,Je.Z)(function*(o){o?(i.Du.Qo(),yield my(i)):(yield i.Du.stop(),i.Eu.length>0&&(ze("RemoteStore",`Stopping write stream with ${i.Eu.length} pending writes`),i.Eu=[]))});return function(o){return n.apply(this,arguments)}}())),i.Du}class Qp{constructor(n,o,a,h,_){this.asyncQueue=n,this.timerId=o,this.targetTimeMs=a,this.op=h,this.removalCallback=_,this.deferred=new Ss,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(w=>{})}static createAndSchedule(n,o,a,h,_){const w=Date.now()+a,S=new Qp(n,o,w,h,_);return S.start(a),S}start(n){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),n)}skipDelay(){return this.handleDelayElapsed()}cancel(n){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Se(Jt.CANCELLED,"Operation cancelled"+(n?": "+n:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(n=>this.deferred.resolve(n))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function dh(i,n){if(rs("AsyncQueue",`${n}: ${i}`),Dp(i))return new Se(Jt.UNAVAILABLE,`${n}: ${i}`);throw i}class Sf{constructor(n){this.comparator=n?(o,a)=>n(o,a)||hn.comparator(o.key,a.key):(o,a)=>hn.comparator(o.key,a.key),this.keyedMap=tm(),this.sortedSet=new ci(this.comparator)}static emptySet(n){return new Sf(n.comparator)}has(n){return null!=this.keyedMap.get(n)}get(n){return this.keyedMap.get(n)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(n){const o=this.keyedMap.get(n);return o?this.sortedSet.indexOf(o):-1}get size(){return this.sortedSet.size}forEach(n){this.sortedSet.inorderTraversal((o,a)=>(n(o),!1))}add(n){const o=this.delete(n.key);return o.copy(o.keyedMap.insert(n.key,n),o.sortedSet.insert(n,null))}delete(n){const o=this.get(n);return o?this.copy(this.keyedMap.remove(n),this.sortedSet.remove(o)):this}isEqual(n){if(!(n instanceof Sf)||this.size!==n.size)return!1;const o=this.sortedSet.getIterator(),a=n.sortedSet.getIterator();for(;o.hasNext();){const h=o.getNext().key,_=a.getNext().key;if(!h.isEqual(_))return!1}return!0}toString(){const n=[];return this.forEach(o=>{n.push(o.toString())}),0===n.length?"DocumentSet ()":"DocumentSet (\n  "+n.join("  \n")+"\n)"}copy(n,o){const a=new Sf;return a.comparator=this.comparator,a.keyedMap=n,a.sortedSet=o,a}}class Ox{constructor(){this.Cu=new ci(hn.comparator)}track(n){const o=n.doc.key,a=this.Cu.get(o);a?0!==n.type&&3===a.type?this.Cu=this.Cu.insert(o,n):3===n.type&&1!==a.type?this.Cu=this.Cu.insert(o,{type:a.type,doc:n.doc}):2===n.type&&2===a.type?this.Cu=this.Cu.insert(o,{type:2,doc:n.doc}):2===n.type&&0===a.type?this.Cu=this.Cu.insert(o,{type:0,doc:n.doc}):1===n.type&&0===a.type?this.Cu=this.Cu.remove(o):1===n.type&&2===a.type?this.Cu=this.Cu.insert(o,{type:1,doc:a.doc}):0===n.type&&1===a.type?this.Cu=this.Cu.insert(o,{type:2,doc:n.doc}):wn():this.Cu=this.Cu.insert(o,n)}xu(){const n=[];return this.Cu.inorderTraversal((o,a)=>{n.push(a)}),n}}class za{constructor(n,o,a,h,_,w,S,L,B){this.query=n,this.docs=o,this.oldDocs=a,this.docChanges=h,this.mutatedKeys=_,this.fromCache=w,this.syncStateChanged=S,this.excludesMetadataChanges=L,this.hasCachedResults=B}static fromInitialDocuments(n,o,a,h,_){const w=[];return o.forEach(S=>{w.push({type:0,doc:S})}),new za(n,o,Sf.emptySet(o),w,a,h,!0,!1,_)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(n){if(!(this.fromCache===n.fromCache&&this.hasCachedResults===n.hasCachedResults&&this.syncStateChanged===n.syncStateChanged&&this.mutatedKeys.isEqual(n.mutatedKeys)&&Bp(this.query,n.query)&&this.docs.isEqual(n.docs)&&this.oldDocs.isEqual(n.oldDocs)))return!1;const o=this.docChanges,a=n.docChanges;if(o.length!==a.length)return!1;for(let h=0;h<o.length;h++)if(o[h].type!==a[h].type||!o[h].doc.isEqual(a[h].doc))return!1;return!0}}class UC{constructor(){this.Nu=void 0,this.listeners=[]}}class $O{constructor(){this.queries=new vf(n=>Up(n),Bp),this.onlineState="Unknown",this.ku=new Set}}function kv(){return kv=(0,Je.Z)(function*(i,n){const o=_n(i),a=n.query;let h=!1,_=o.queries.get(a);if(_||(h=!0,_=new UC),h)try{_.Nu=yield o.onListen(a)}catch(w){const S=dh(w,`Initialization of query '${j0(n.query)}' failed`);return void n.onError(S)}o.queries.set(a,_),_.listeners.push(n),n.Mu(o.onlineState),_.Nu&&n.$u(_.Nu)&&yy(o)}),kv.apply(this,arguments)}function Ex(){return Ex=(0,Je.Z)(function*(i,n){const o=_n(i),a=n.query;let h=!1;const _=o.queries.get(a);if(_){const w=_.listeners.indexOf(n);w>=0&&(_.listeners.splice(w,1),h=0===_.listeners.length)}if(h)return o.queries.delete(a),o.onUnlisten(a)}),Ex.apply(this,arguments)}function Tx(i,n){const o=_n(i);let a=!1;for(const h of n){const w=o.queries.get(h.query);if(w){for(const S of w.listeners)S.$u(h)&&(a=!0);w.Nu=h}}a&&yy(o)}function VC(i,n,o){const a=_n(i),h=a.queries.get(n);if(h)for(const _ of h.listeners)_.onError(o);a.queries.delete(n)}function yy(i){i.ku.forEach(n=>{n.next()})}class Ix{constructor(n,o,a){this.query=n,this.Ou=o,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=a||{}}$u(n){if(!this.options.includeMetadataChanges){const a=[];for(const h of n.docChanges)3!==h.type&&a.push(h);n=new za(n.query,n.docs,n.oldDocs,a,n.mutatedKeys,n.fromCache,n.syncStateChanged,!0,n.hasCachedResults)}let o=!1;return this.Fu?this.Lu(n)&&(this.Ou.next(n),o=!0):this.qu(n,this.onlineState)&&(this.Uu(n),o=!0),this.Bu=n,o}onError(n){this.Ou.error(n)}Mu(n){this.onlineState=n;let o=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,n)&&(this.Uu(this.Bu),o=!0),o}qu(n,o){return!n.fromCache||(!this.options.Ku||!("Offline"!==o))&&(!n.docs.isEmpty()||n.hasCachedResults||"Offline"===o)}Lu(n){return n.docChanges.length>0||!!(n.syncStateChanged||this.Bu&&this.Bu.hasPendingWrites!==n.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Uu(n){n=za.fromInitialDocuments(n.query,n.docs,n.mutatedKeys,n.fromCache,n.hasCachedResults),this.Fu=!0,this.Ou.next(n)}}class $C{constructor(n){this.key=n}}class HO{constructor(n){this.key=n}}class GC{constructor(n,o){this.query=n,this.Yu=o,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Hr(),this.mutatedKeys=Hr(),this.tc=rO(n),this.ec=new Sf(this.tc)}get nc(){return this.Yu}sc(n,o){const a=o?o.ic:new Ox,h=o?o.ec:this.ec;let _=o?o.mutatedKeys:this.mutatedKeys,w=h,S=!1;const L="F"===this.query.limitType&&h.size===this.query.limit?h.last():null,B="L"===this.query.limitType&&h.size===this.query.limit?h.first():null;if(n.inorderTraversal((H,Y)=>{const pt=h.get(H),xt=Zc(this.query,Y)?Y:null,At=!!pt&&this.mutatedKeys.has(pt.key),Ut=!!xt&&(xt.hasLocalMutations||this.mutatedKeys.has(xt.key)&&xt.hasCommittedMutations);let Zt=!1;pt&&xt?pt.data.isEqual(xt.data)?At!==Ut&&(a.track({type:3,doc:xt}),Zt=!0):this.rc(pt,xt)||(a.track({type:2,doc:xt}),Zt=!0,(L&&this.tc(xt,L)>0||B&&this.tc(xt,B)<0)&&(S=!0)):!pt&&xt?(a.track({type:0,doc:xt}),Zt=!0):pt&&!xt&&(a.track({type:1,doc:pt}),Zt=!0,(L||B)&&(S=!0)),Zt&&(xt?(w=w.add(xt),_=Ut?_.add(H):_.delete(H)):(w=w.delete(H),_=_.delete(H)))}),null!==this.query.limit)for(;w.size>this.query.limit;){const H="F"===this.query.limitType?w.last():w.first();w=w.delete(H.key),_=_.delete(H.key),a.track({type:1,doc:H})}return{ec:w,ic:a,zi:S,mutatedKeys:_}}rc(n,o){return n.hasLocalMutations&&o.hasCommittedMutations&&!o.hasLocalMutations}applyChanges(n,o,a){const h=this.ec;this.ec=n.ec,this.mutatedKeys=n.mutatedKeys;const _=n.ic.xu();_.sort((B,H)=>function(Y,pt){const xt=At=>{switch(At){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wn()}};return xt(Y)-xt(pt)}(B.type,H.type)||this.tc(B.doc,H.doc)),this.oc(a);const w=o?this.uc():[],S=0===this.Zu.size&&this.current?1:0,L=S!==this.Xu;return this.Xu=S,0!==_.length||L?{snapshot:new za(this.query,n.ec,h,_,n.mutatedKeys,0===S,L,!1,!!a&&a.resumeToken.approximateByteSize()>0),cc:w}:{cc:w}}Mu(n){return this.current&&"Offline"===n?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Ox,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(n){return!this.Yu.has(n)&&!!this.ec.has(n)&&!this.ec.get(n).hasLocalMutations}oc(n){n&&(n.addedDocuments.forEach(o=>this.Yu=this.Yu.add(o)),n.modifiedDocuments.forEach(o=>{}),n.removedDocuments.forEach(o=>this.Yu=this.Yu.delete(o)),this.current=n.current)}uc(){if(!this.current)return[];const n=this.Zu;this.Zu=Hr(),this.ec.forEach(a=>{this.ac(a.key)&&(this.Zu=this.Zu.add(a.key))});const o=[];return n.forEach(a=>{this.Zu.has(a)||o.push(new HO(a))}),this.Zu.forEach(a=>{n.has(a)||o.push(new $C(a))}),o}hc(n){this.Yu=n.ir,this.Zu=Hr();const o=this.sc(n.documents);return this.applyChanges(o,!0)}lc(){return za.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class qO{constructor(n,o,a){this.query=n,this.targetId=o,this.view=a}}class ZO{constructor(n){this.key=n,this.fc=!1}}class Jc{constructor(n,o,a,h,_,w){this.localStore=n,this.remoteStore=o,this.eventManager=a,this.sharedClientState=h,this.currentUser=_,this.maxConcurrentLimboResolutions=w,this.dc={},this.wc=new vf(S=>Up(S),Bp),this._c=new Map,this.mc=new Set,this.gc=new ci(hn.comparator),this.yc=new Map,this.Ic=new ex,this.Tc={},this.Ec=new Map,this.Ac=_c.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}function vm(i,n){return Rv.apply(this,arguments)}function Rv(){return Rv=(0,Je.Z)(function*(i,n){const o=function zx(i){const n=_n(i);return n.remoteStore.remoteSyncer.applyRemoteEvent=YO.bind(null,n),n.remoteStore.remoteSyncer.getRemoteKeysForTarget=nE.bind(null,n),n.remoteStore.remoteSyncer.rejectListen=XO.bind(null,n),n.dc.nu=Tx.bind(null,n.eventManager),n.dc.Pc=VC.bind(null,n.eventManager),n}(i);let a,h;const _=o.wc.get(n);if(_)a=_.targetId,o.sharedClientState.addLocalQueryTarget(a),h=_.view.lc();else{const w=yield function uy(i,n){const o=_n(i);return o.persistence.runTransaction("Allocate target","readwrite",a=>{let h;return o.Bs.getTargetData(a,n).next(_=>_?(h=_,qt.resolve(h)):o.Bs.allocateTargetId(a).next(w=>(h=new Cf(n,w,"TargetPurposeListen",a.currentSequenceNumber),o.Bs.addTargetData(a,h).next(()=>h))))}).then(a=>{const h=o.Ji.get(a.targetId);return(null===h||a.snapshotVersion.compareTo(h.snapshotVersion)>0)&&(o.Ji=o.Ji.insert(a.targetId,a),o.Yi.set(n,a.targetId)),a})}(o.localStore,Ti(n)),S=o.sharedClientState.addLocalQueryTarget(w.targetId);a=w.targetId,h=yield function Sx(i,n,o,a,h){return WO.apply(this,arguments)}(o,n,a,"current"===S,w.resumeToken),o.isPrimaryClient&&mm(o.remoteStore,w)}return h}),Rv.apply(this,arguments)}function WO(){return WO=(0,Je.Z)(function*(i,n,o,a,h){i.Rc=(Y,pt,xt)=>{return(At=(0,Je.Z)(function*(Ut,Zt,qe,fn){let $e=Zt.view.sc(qe);$e.zi&&($e=yield bv(Ut.localStore,Zt.query,!1).then(({documents:Cr})=>Zt.view.sc(Cr,$e)));const cn=fn&&fn.targetChanges.get(Zt.targetId),Mr=Zt.view.applyChanges($e,Ut.isPrimaryClient,cn);return ZC(Ut,Zt.targetId,Mr.cc),Mr.snapshot}),function(Ut,Zt,qe,fn){return At.apply(this,arguments)})(i,Y,pt,xt);var At};const _=yield bv(i.localStore,n,!0),w=new GC(n,_.ir),S=w.sc(_.documents),L=xo.createSynthesizedTargetChangeForCurrentChange(o,a&&"Offline"!==i.onlineState,h),B=w.applyChanges(S,i.isPrimaryClient,L);ZC(i,o,B.cc);const H=new qO(n,o,w);return i.wc.set(n,H),i._c.has(o)?i._c.get(o).push(n):i._c.set(o,[n]),B.snapshot}),WO.apply(this,arguments)}function JT(i,n){return KO.apply(this,arguments)}function KO(){return KO=(0,Je.Z)(function*(i,n){const o=_n(i),a=o.wc.get(n),h=o._c.get(a.targetId);if(h.length>1)return o._c.set(a.targetId,h.filter(_=>!Bp(_,n))),void o.wc.delete(n);o.isPrimaryClient?(o.sharedClientState.removeLocalQueryTarget(a.targetId),o.sharedClientState.isActiveQueryTarget(a.targetId)||(yield pm(o.localStore,a.targetId,!1).then(()=>{o.sharedClientState.clearQueryState(a.targetId),gy(o.remoteStore,a.targetId),hh(o,a.targetId)}).catch(hf))):(hh(o,a.targetId),yield pm(o.localStore,a.targetId,!0))}),KO.apply(this,arguments)}function HC(){return HC=(0,Je.Z)(function*(i,n,o){const a=function QC(i){const n=_n(i);return n.remoteStore.remoteSyncer.applySuccessfulWrite=QO.bind(null,n),n.remoteStore.remoteSyncer.rejectFailedWrite=t2.bind(null,n),n}(i);try{const h=yield function(_,w){const S=_n(_),L=An.now(),B=w.reduce((pt,xt)=>pt.add(xt.key),Hr());let H,Y;return S.persistence.runTransaction("Locally write mutations","readwrite",pt=>{let xt=Us(),At=Hr();return S.Zi.getEntries(pt,B).next(Ut=>{xt=Ut,xt.forEach((Zt,qe)=>{qe.isValidDocument()||(At=At.add(Zt))})}).next(()=>S.localDocuments.getOverlayedDocuments(pt,xt)).next(Ut=>{H=Ut;const Zt=[];for(const qe of w){const fn=sO(qe,H.get(qe.key).overlayedDocument);null!=fn&&Zt.push(new kl(qe.key,fn,kT(fn.value.mapValue),ei.exists(!0)))}return S.mutationQueue.addMutationBatch(pt,L,Zt,w)}).next(Ut=>{Y=Ut;const Zt=Ut.applyToLocalDocumentSet(H,At);return S.documentOverlayCache.saveOverlays(pt,Ut.batchId,Zt)})}).then(()=>({batchId:Y.batchId,changes:em(H)}))}(a.localStore,n);a.sharedClientState.addPendingMutation(h.batchId),function(_,w,S){let L=_.Tc[_.currentUser.toKey()];L||(L=new ci(Br)),L=L.insert(w,S),_.Tc[_.currentUser.toKey()]=L}(a,h.batchId,o),yield Rl(a,h.changes),yield my(a.remoteStore)}catch(h){const _=dh(h,"Failed to persist write");o.reject(_)}}),HC.apply(this,arguments)}function YO(i,n){return Lv.apply(this,arguments)}function Lv(){return Lv=(0,Je.Z)(function*(i,n){const o=_n(i);try{const a=yield function IO(i,n){const o=_n(i),a=n.snapshotVersion;let h=o.Ji;return o.persistence.runTransaction("Apply remote event","readwrite-primary",_=>{const w=o.Zi.newChangeBuffer({trackRemovals:!0});h=o.Ji;const S=[];n.targetChanges.forEach((H,Y)=>{const pt=h.get(Y);if(!pt)return;S.push(o.Bs.removeMatchingKeys(_,H.removedDocuments,Y).next(()=>o.Bs.addMatchingKeys(_,H.addedDocuments,Y)));let xt=pt.withSequenceNumber(_.currentSequenceNumber);var At,Ut,Zt;null!==n.targetMismatches.get(Y)?xt=xt.withResumeToken(ys.EMPTY_BYTE_STRING,Rn.min()).withLastLimboFreeSnapshotVersion(Rn.min()):H.resumeToken.approximateByteSize()>0&&(xt=xt.withResumeToken(H.resumeToken,a)),h=h.insert(Y,xt),Ut=xt,Zt=H,(0===(At=pt).resumeToken.approximateByteSize()||Ut.snapshotVersion.toMicroseconds()-At.snapshotVersion.toMicroseconds()>=3e8||Zt.addedDocuments.size+Zt.modifiedDocuments.size+Zt.removedDocuments.size>0)&&S.push(o.Bs.updateTargetData(_,xt))});let L=Us(),B=Hr();if(n.documentUpdates.forEach(H=>{n.resolvedLimboDocuments.has(H)&&S.push(o.persistence.referenceDelegate.updateLimboDocument(_,H))}),S.push(function ix(i,n,o){let a=Hr(),h=Hr();return o.forEach(_=>a=a.add(_)),n.getEntries(i,a).next(_=>{let w=Us();return o.forEach((S,L)=>{const B=_.get(S);L.isFoundDocument()!==B.isFoundDocument()&&(h=h.add(S)),L.isNoDocument()&&L.version.isEqual(Rn.min())?(n.removeEntry(S,L.readTime),w=w.insert(S,L)):!B.isValidDocument()||L.version.compareTo(B.version)>0||0===L.version.compareTo(B.version)&&B.hasPendingWrites?(n.addEntry(L),w=w.insert(S,L)):ze("LocalStore","Ignoring outdated watch update for ",S,". Current version:",B.version," Watch version:",L.version)}),{nr:w,sr:h}})}(_,w,n.documentUpdates).next(H=>{L=H.nr,B=H.sr})),!a.isEqual(Rn.min())){const H=o.Bs.getLastRemoteSnapshotVersion(_).next(Y=>o.Bs.setTargetsMetadata(_,_.currentSequenceNumber,a));S.push(H)}return qt.waitFor(S).next(()=>w.apply(_)).next(()=>o.localDocuments.getLocalViewOfDocuments(_,L,B)).next(()=>L)}).then(_=>(o.Ji=h,_))}(o.localStore,n);n.targetChanges.forEach((h,_)=>{const w=o.yc.get(_);w&&($n(h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size<=1),h.addedDocuments.size>0?w.fc=!0:h.modifiedDocuments.size>0?$n(w.fc):h.removedDocuments.size>0&&($n(w.fc),w.fc=!1))}),yield Rl(o,a,n)}catch(a){yield hf(a)}}),Lv.apply(this,arguments)}function xm(i,n,o){const a=_n(i);if(a.isPrimaryClient&&0===o||!a.isPrimaryClient&&1===o){const h=[];a.wc.forEach((_,w)=>{const S=w.view.Mu(n);S.snapshot&&h.push(S.snapshot)}),function(_,w){const S=_n(_);S.onlineState=w;let L=!1;S.queries.forEach((B,H)=>{for(const Y of H.listeners)Y.Mu(w)&&(L=!0)}),L&&yy(S)}(a.eventManager,n),h.length&&a.dc.nu(h),a.onlineState=n,a.isPrimaryClient&&a.sharedClientState.setOnlineState(n)}}function XO(i,n,o){return qC.apply(this,arguments)}function qC(){return qC=(0,Je.Z)(function*(i,n,o){const a=_n(i);a.sharedClientState.updateQueryState(n,"rejected",o);const h=a.yc.get(n),_=h&&h.key;if(_){let w=new ci(hn.comparator);w=w.insert(_,li.newNoDocument(_,Rn.min()));const S=Hr().add(_),L=new jp(Rn.min(),new Map,new ci(Br),w,S);yield YO(a,L),a.gc=a.gc.remove(_),a.yc.delete(n),Cm(a)}else yield pm(a.localStore,n,!1).then(()=>hh(a,n,o)).catch(hf)}),qC.apply(this,arguments)}function QO(i,n){return wm.apply(this,arguments)}function wm(){return wm=(0,Je.Z)(function*(i,n){const o=_n(i),a=n.batch.batchId;try{const h=yield function yv(i,n){const o=_n(i);return o.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const h=n.batch.keys(),_=o.Zi.newChangeBuffer({trackRemovals:!0});return function(w,S,L,B){const H=L.batch,Y=H.keys();let pt=qt.resolve();return Y.forEach(xt=>{pt=pt.next(()=>B.getEntry(S,xt)).next(At=>{const Ut=L.docVersions.get(xt);$n(null!==Ut),At.version.compareTo(Ut)<0&&(H.applyToRemoteDocument(At,L),At.isValidDocument()&&(At.setReadTime(L.commitVersion),B.addEntry(At)))})}),pt.next(()=>w.mutationQueue.removeMutationBatch(S,H))}(o,a,n,_).next(()=>_.apply(a)).next(()=>o.mutationQueue.performConsistencyCheck(a)).next(()=>o.documentOverlayCache.removeOverlaysForBatchId(a,h,n.batch.batchId)).next(()=>o.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,function(w){let S=Hr();for(let L=0;L<w.mutationResults.length;++L)w.mutationResults[L].transformResults.length>0&&(S=S.add(w.batch.mutations[L].key));return S}(n))).next(()=>o.localDocuments.getDocuments(a,h))})}(o.localStore,n);Nv(o,a,null),Vr(o,a),o.sharedClientState.updateMutationState(a,"acknowledged"),yield Rl(o,h)}catch(h){yield hf(h)}}),wm.apply(this,arguments)}function t2(i,n,o){return Ax.apply(this,arguments)}function Ax(){return Ax=(0,Je.Z)(function*(i,n,o){const a=_n(i);try{const h=yield function(_,w){const S=_n(_);return S.persistence.runTransaction("Reject batch","readwrite-primary",L=>{let B;return S.mutationQueue.lookupMutationBatch(L,w).next(H=>($n(null!==H),B=H.keys(),S.mutationQueue.removeMutationBatch(L,H))).next(()=>S.mutationQueue.performConsistencyCheck(L)).next(()=>S.documentOverlayCache.removeOverlaysForBatchId(L,B,w)).next(()=>S.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(L,B)).next(()=>S.localDocuments.getDocuments(L,B))})}(a.localStore,n);Nv(a,n,o),Vr(a,n),a.sharedClientState.updateMutationState(n,"rejected",o),yield Rl(a,h)}catch(h){yield hf(h)}}),Ax.apply(this,arguments)}function Vr(i,n){(i.Ec.get(n)||[]).forEach(o=>{o.resolve()}),i.Ec.delete(n)}function Nv(i,n,o){const a=_n(i);let h=a.Tc[a.currentUser.toKey()];if(h){const _=h.get(n);_&&(o?_.reject(o):_.resolve(),h=h.remove(n)),a.Tc[a.currentUser.toKey()]=h}}function hh(i,n,o=null){i.sharedClientState.removeLocalQueryTarget(n);for(const a of i._c.get(n))i.wc.delete(a),o&&i.dc.Pc(a,o);i._c.delete(n),i.isPrimaryClient&&i.Ic.Is(n).forEach(a=>{i.Ic.containsKey(a)||tE(i,a)})}function tE(i,n){i.mc.delete(n.path.canonicalString());const o=i.gc.get(n);null!==o&&(gy(i.remoteStore,o),i.gc=i.gc.remove(n),i.yc.delete(o),Cm(i))}function ZC(i,n,o){for(const a of o)a instanceof $C?(i.Ic.addReference(a.key,n),Fv(i,a)):a instanceof HO?(ze("SyncEngine","Document no longer in limbo: "+a.key),i.Ic.removeReference(a.key,n),i.Ic.containsKey(a.key)||tE(i,a.key)):wn()}function Fv(i,n){const o=n.key,a=o.path.canonicalString();i.gc.get(o)||i.mc.has(a)||(ze("SyncEngine","New document in limbo: "+o),i.mc.add(a),Cm(i))}function Cm(i){for(;i.mc.size>0&&i.gc.size<i.maxConcurrentLimboResolutions;){const n=i.mc.values().next().value;i.mc.delete(n);const o=new hn(io.fromString(n)),a=i.Ac.next();i.yc.set(a,new ZO(o)),i.gc=i.gc.insert(o,a),mm(i.remoteStore,new Cf(Ti(Bs(o.path)),a,"TargetPurposeLimboResolution",cc.ct))}}function Rl(i,n,o){return kx.apply(this,arguments)}function kx(){return kx=(0,Je.Z)(function*(i,n,o){const a=_n(i),h=[],_=[],w=[];var S;a.wc.isEmpty()||(a.wc.forEach((S,L)=>{w.push(a.Rc(L,n,o).then(B=>{if((B||o)&&a.isPrimaryClient&&a.sharedClientState.updateQueryState(L.targetId,B?.fromCache?"not-current":"current"),B){h.push(B);const H=IC.Li(L.targetId,B);_.push(H)}}))}),yield Promise.all(w),a.dc.nu(h),yield(S=(0,Je.Z)(function*(L,B){const H=_n(L);try{yield H.persistence.runTransaction("notifyLocalViewChanges","readwrite",Y=>qt.forEach(B,pt=>qt.forEach(pt.Fi,xt=>H.persistence.referenceDelegate.addReference(Y,pt.targetId,xt)).next(()=>qt.forEach(pt.Bi,xt=>H.persistence.referenceDelegate.removeReference(Y,pt.targetId,xt)))))}catch(Y){if(!Dp(Y))throw Y;ze("LocalStore","Failed to update sequence numbers: "+Y)}for(const Y of B){const pt=Y.targetId;if(!Y.fromCache){const xt=H.Ji.get(pt),Ut=xt.withLastLimboFreeSnapshotVersion(xt.snapshotVersion);H.Ji=H.Ji.insert(pt,Ut)}}}),function(L,B){return S.apply(this,arguments)})(a.localStore,_))}),kx.apply(this,arguments)}function eE(i,n){return vc.apply(this,arguments)}function vc(){return vc=(0,Je.Z)(function*(i,n){const o=_n(i);if(!o.currentUser.isEqual(n)){ze("SyncEngine","User change. New user:",n.toKey());const a=yield ox(o.localStore,n);o.currentUser=n,(h=o).Ec.forEach(w=>{w.forEach(S=>{S.reject(new Se(Jt.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),h.Ec.clear(),o.sharedClientState.handleUserChange(n,a.removedBatchIds,a.addedBatchIds),yield Rl(o,a.er)}var h}),vc.apply(this,arguments)}function nE(i,n){const o=_n(i),a=o.yc.get(n);if(a&&a.fc)return Hr().add(a.key);{let h=Hr();const _=o._c.get(n);if(!_)return h;for(const w of _){const S=o.wc.get(w);h=h.unionWith(S.view.nc)}return h}}class Bv{constructor(){this.synchronizeTabs=!1}initialize(n){var o=this;return(0,Je.Z)(function*(){o.serializer=Cv(n.databaseInfo.databaseId),o.sharedClientState=o.createSharedClientState(n),o.persistence=o.createPersistence(n),yield o.persistence.start(),o.localStore=o.createLocalStore(n),o.gcScheduler=o.createGarbageCollectionScheduler(n,o.localStore),o.indexBackfillerScheduler=o.createIndexBackfillerScheduler(n,o.localStore)})()}createGarbageCollectionScheduler(n,o){return null}createIndexBackfillerScheduler(n,o){return null}createLocalStore(n){return function _v(i,n,o,a){return new If(i,n,o,a)}(this.persistence,new TO,n.initialUser,this.serializer)}createPersistence(n){return new uh(hv.zs,this.serializer)}createSharedClientState(n){return new fx}terminate(){var n=this;return(0,Je.Z)(function*(){n.gcScheduler&&n.gcScheduler.stop(),yield n.sharedClientState.shutdown(),yield n.persistence.shutdown()})()}}class As{initialize(n,o){var a=this;return(0,Je.Z)(function*(){a.localStore||(a.localStore=n.localStore,a.sharedClientState=n.sharedClientState,a.datastore=a.createDatastore(o),a.remoteStore=a.createRemoteStore(o),a.eventManager=a.createEventManager(o),a.syncEngine=a.createSyncEngine(o,!n.synchronizeTabs),a.sharedClientState.onlineStateHandler=h=>xm(a.syncEngine,h,1),a.remoteStore.remoteSyncer.handleCredentialChange=eE.bind(null,a.syncEngine),yield function Px(i,n){return BC.apply(this,arguments)}(a.remoteStore,a.syncEngine.isPrimaryClient))})()}createEventManager(n){return new $O}createDatastore(n){const o=Cv(n.databaseInfo.databaseId),a=new RO(n.databaseInfo);return new FO(n.authCredentials,n.appCheckCredentials,a,o)}createRemoteStore(n){return o=this.localStore,a=this.datastore,h=n.asyncQueue,_=S=>xm(this.syncEngine,S,0),w=DO.D()?new DO:new ZT,new KT(o,a,h,_,w);var o,a,h,_,w}createSyncEngine(n,o){return function(a,h,_,w,S,L,B){const H=new Jc(a,h,_,w,S,L);return B&&(H.vc=!0),H}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,n.initialUser,n.maxConcurrentLimboResolutions,o)}terminate(){return(n=(0,Je.Z)(function*(o){const a=_n(o);ze("RemoteStore","RemoteStore shutting down."),a.vu.add(5),yield py(a),a.Pu.shutdown(),a.bu.set("Unknown")}),function(o){return n.apply(this,arguments)})(this.remoteStore);var n}}class Pm{constructor(n){this.observer=n,this.muted=!1}next(n){this.observer.next&&this.Sc(this.observer.next,n)}error(n){this.observer.error?this.Sc(this.observer.error,n):rs("Uncaught Error in snapshot listener:",n.toString())}Dc(){this.muted=!0}Sc(n,o){this.muted||setTimeout(()=>{this.muted||n(o)},0)}}class Ux{constructor(n,o,a,h){var _=this;this.authCredentials=n,this.appCheckCredentials=o,this.asyncQueue=a,this.databaseInfo=h,this.user=ai.UNAUTHENTICATED,this.clientId=Hw.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(a,function(){var w=(0,Je.Z)(function*(S){ze("FirestoreClient","Received user=",S.uid),yield _.authCredentialListener(S),_.user=S});return function(S){return w.apply(this,arguments)}}()),this.appCheckCredentials.start(a,w=>(ze("FirestoreClient","Received new app check token=",w),this.appCheckCredentialListener(w,this.user)))}getConfiguration(){var n=this;return(0,Je.Z)(function*(){return{asyncQueue:n.asyncQueue,databaseInfo:n.databaseInfo,clientId:n.clientId,authCredentials:n.authCredentials,appCheckCredentials:n.appCheckCredentials,initialUser:n.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(n){this.authCredentialListener=n}setAppCheckTokenChangeListener(n){this.appCheckCredentialListener=n}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Se(Jt.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var n=this;this.asyncQueue.enterRestrictedMode();const o=new Ss;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Je.Z)(function*(){try{n._onlineComponents&&(yield n._onlineComponents.terminate()),n._offlineComponents&&(yield n._offlineComponents.terminate()),n.authCredentials.shutdown(),n.appCheckCredentials.shutdown(),o.resolve()}catch(a){const h=dh(a,"Failed to shutdown persistence");o.reject(h)}})),o.promise}}function Om(i,n){return Vx.apply(this,arguments)}function Vx(){return Vx=(0,Je.Z)(function*(i,n){i.asyncQueue.verifyOperationInProgress(),ze("FirestoreClient","Initializing OfflineComponentProvider");const o=yield i.getConfiguration();yield n.initialize(o);let a=o.initialUser;i.setCredentialChangeListener(function(){var h=(0,Je.Z)(function*(_){a.isEqual(_)||(yield ox(n.localStore,_),a=_)});return function(_){return h.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener(()=>i.terminate()),i._offlineComponents=n}),Vx.apply(this,arguments)}function lE(i,n){return cE.apply(this,arguments)}function cE(){return cE=(0,Je.Z)(function*(i,n){i.asyncQueue.verifyOperationInProgress();const o=yield function eM(i){return My.apply(this,arguments)}(i);ze("FirestoreClient","Initializing OnlineComponentProvider");const a=yield i.getConfiguration();yield n.initialize(o,a),i.setCredentialChangeListener(h=>zC(n.remoteStore,h)),i.setAppCheckTokenChangeListener((h,_)=>zC(n.remoteStore,_)),i._onlineComponents=n}),cE.apply(this,arguments)}function My(){return My=(0,Je.Z)(function*(i){if(!i._offlineComponents)if(i._uninitializedComponentsProvider){ze("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Om(i,i._uninitializedComponentsProvider._offline)}catch(n){const o=n;if(!function Cy(i){return"FirebaseError"===i.name?i.code===Jt.FAILED_PRECONDITION||i.code===Jt.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||22===i.code||20===i.code||11===i.code}(o))throw o;lc("Error using user provided cache. Falling back to memory cache: "+o),yield Om(i,new Bv)}}else ze("FirestoreClient","Using default OfflineComponentProvider"),yield Om(i,new Bv);return i._offlineComponents}),My.apply(this,arguments)}function Uv(i){return Vv.apply(this,arguments)}function Vv(){return Vv=(0,Je.Z)(function*(i){return i._onlineComponents||(i._uninitializedComponentsProvider?(ze("FirestoreClient","Using user provided OnlineComponentProvider"),yield lE(i,i._uninitializedComponentsProvider._online)):(ze("FirestoreClient","Using default OnlineComponentProvider"),yield lE(i,new As))),i._onlineComponents}),Vv.apply(this,arguments)}function Em(i){return Df.apply(this,arguments)}function Df(){return Df=(0,Je.Z)(function*(i){const n=yield Uv(i),o=n.eventManager;return o.onListen=vm.bind(null,n.syncEngine),o.onUnlisten=JT.bind(null,n.syncEngine),o}),Df.apply(this,arguments)}function dE(i){const n={};return void 0!==i.timeoutSeconds&&(n.timeoutSeconds=i.timeoutSeconds),n}const hE=new Map;function $x(i,n,o){if(!o)throw new Se(Jt.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${n}.`)}function Tm(i){if(!hn.isDocumentKey(i))throw new Se(Jt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function Gx(i){if(hn.isDocumentKey(i))throw new Se(Jt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function fh(i){if(void 0===i)return"undefined";if(null===i)return"null";if("string"==typeof i)return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if("number"==typeof i||"boolean"==typeof i)return""+i;if("object"==typeof i){if(i instanceof Array)return"an array";{const n=(o=i).constructor?o.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var o;return"function"==typeof i?"a function":wn()}function wo(i,n){if("_delegate"in i&&(i=i._delegate),!(i instanceof n)){if(n.name===i.constructor.name)throw new Se(Jt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const o=fh(i);throw new Se(Jt.INVALID_ARGUMENT,`Expected type '${n.name}', but it was: ${o}`)}}return i}class aM{constructor(n){var o,a;if(void 0===n.host){if(void 0!==n.ssl)throw new Se(Jt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=n.host,this.ssl=null===(o=n.ssl)||void 0===o||o;if(this.credentials=n.credentials,this.ignoreUndefinedProperties=!!n.ignoreUndefinedProperties,this.cache=n.localCache,void 0===n.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==n.cacheSizeBytes&&n.cacheSizeBytes<1048576)throw new Se(Jt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=n.cacheSizeBytes}(function fE(i,n,o,a){if(!0===n&&!0===a)throw new Se(Jt.INVALID_ARGUMENT,`${i} and ${o} cannot be used together.`)})("experimentalForceLongPolling",n.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",n.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!n.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==n.experimentalAutoDetectLongPolling&&!n.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=dE(null!==(a=n.experimentalLongPollingOptions)&&void 0!==a?a:{}),function(h){if(void 0!==h.timeoutSeconds){if(isNaN(h.timeoutSeconds))throw new Se(Jt.INVALID_ARGUMENT,`invalid long polling timeout: ${h.timeoutSeconds} (must not be NaN)`);if(h.timeoutSeconds<5)throw new Se(Jt.INVALID_ARGUMENT,`invalid long polling timeout: ${h.timeoutSeconds} (minimum allowed value is 5)`);if(h.timeoutSeconds>30)throw new Se(Jt.INVALID_ARGUMENT,`invalid long polling timeout: ${h.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!n.useFetchStreams}isEqual(n){return this.host===n.host&&this.ssl===n.ssl&&this.credentials===n.credentials&&this.cacheSizeBytes===n.cacheSizeBytes&&this.experimentalForceLongPolling===n.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===n.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===n.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===n.ignoreUndefinedProperties&&this.useFetchStreams===n.useFetchStreams}}class Im{constructor(n,o,a,h){this._authCredentials=n,this._appCheckCredentials=o,this._databaseId=a,this._app=h,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new aM({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Se(Jt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(n){if(this._settingsFrozen)throw new Se(Jt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new aM(n),void 0!==n.credentials&&(this._authCredentials=function(o){if(!o)return new VP;switch(o.type){case"firstParty":return new jP(o.sessionIndex||"0",o.iamToken||null,o.authTokenFactory||null);case"provider":return o.client;default:throw new Se(Jt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(n.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const o=hE.get(n);o&&(ze("ComponentProvider","Removing Datastore"),hE.delete(n),o.terminate())}(this),Promise.resolve()}}class as{constructor(n,o,a){this.converter=o,this._key=a,this.type="document",this.firestore=n}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tu(this.firestore,this.converter,this._key.path.popLast())}withConverter(n){return new as(this.firestore,n,this._key)}}class va{constructor(n,o,a){this.converter=o,this._query=a,this.type="query",this.firestore=n}withConverter(n){return new va(this.firestore,n,this._query)}}class tu extends va{constructor(n,o,a){super(n,o,Bs(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const n=this._path.popLast();return n.isEmpty()?null:new as(this.firestore,null,new hn(n))}withConverter(n){return new tu(this.firestore,n,this._path)}}function gE(i,n,...o){if(i=(0,$r.m9)(i),$x("collection","path",n),i instanceof Im){const a=io.fromString(n,...o);return Gx(a),new tu(i,null,a)}{if(!(i instanceof as||i instanceof tu))throw new Se(Jt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=i._path.child(io.fromString(n,...o));return Gx(a),new tu(i.firestore,null,a)}}function lM(i,n,...o){if(i=(0,$r.m9)(i),1===arguments.length&&(n=Hw.A()),$x("doc","path",n),i instanceof Im){const a=io.fromString(n,...o);return Tm(a),new as(i,null,new hn(a))}{if(!(i instanceof as||i instanceof tu))throw new Se(Jt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=i._path.child(io.fromString(n,...o));return Tm(a),new as(i.firestore,i instanceof tu?i.converter:null,new hn(a))}}class s2{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new kC(this,"async_queue_retry"),this.Xc=()=>{const o=px();o&&ze("AsyncQueue","Visibility state changed to "+o.visibilityState),this.qo.Mo()};const n=px();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(n){this.enqueue(n)}enqueueAndForgetEvenWhileRestricted(n){this.Zc(),this.ta(n)}enterRestrictedMode(n){if(!this.jc){this.jc=!0,this.Jc=n||!1;const o=px();o&&"function"==typeof o.removeEventListener&&o.removeEventListener("visibilitychange",this.Xc)}}enqueue(n){if(this.Zc(),this.jc)return new Promise(()=>{});const o=new Ss;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(n().then(o.resolve,o.reject),o.promise)).then(()=>o.promise)}enqueueRetryable(n){this.enqueueAndForget(()=>(this.Qc.push(n),this.ea()))}ea(){var n=this;return(0,Je.Z)(function*(){if(0!==n.Qc.length){try{yield n.Qc[0](),n.Qc.shift(),n.qo.reset()}catch(o){if(!Dp(o))throw o;ze("AsyncQueue","Operation failed with retryable error: "+o)}n.Qc.length>0&&n.qo.No(()=>n.ea())}})()}ta(n){const o=this.Gc.then(()=>(this.Hc=!0,n().catch(a=>{throw this.Wc=a,this.Hc=!1,rs("INTERNAL UNHANDLED ERROR: ",function(_){let w=_.message||"";return _.stack&&(w=_.stack.includes(_.message)?_.stack:_.message+"\n"+_.stack),w}(a)),a}).then(a=>(this.Hc=!1,a))));return this.Gc=o,o}enqueueAfterDelay(n,o,a){this.Zc(),this.Yc.indexOf(n)>-1&&(o=0);const h=Qp.createAndSchedule(this,n,o,a,_=>this.na(_));return this.zc.push(h),h}Zc(){this.Wc&&wn()}verifyOperationInProgress(){}sa(){var n=this;return(0,Je.Z)(function*(){let o;do{o=n.Gc,yield o}while(o!==n.Gc)})()}ia(n){for(const o of this.zc)if(o.timerId===n)return!0;return!1}ra(n){return this.sa().then(()=>{this.zc.sort((o,a)=>o.targetTimeMs-a.targetTimeMs);for(const o of this.zc)if(o.skipDelay(),"all"!==n&&o.timerId===n)break;return this.sa()})}oa(n){this.Yc.push(n)}na(n){const o=this.zc.indexOf(n);this.zc.splice(o,1)}}function qx(i){return function(n,o){if("object"!=typeof n||null===n)return!1;const a=n;for(const h of["next","error","complete"])if(h in a&&"function"==typeof a[h])return!0;return!1}(i)}class ji extends Im{constructor(n,o,a,h){super(n,o,a,h),this.type="firestore",this._queue=new s2,this._persistenceKey=h?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||c2(this),this._firestoreClient.terminate()}}function l2(i,n){const o="object"==typeof i?i:(0,ts.getApp)(),a="string"==typeof i?i:n||"(default)",h=(0,ts._getProvider)(o,"firestore").getImmediate({identifier:a});if(!h._initialized){const _=(0,$r.P0)("firestore");_&&function pE(i,n,o,a={}){var h;const _=(i=wo(i,Im))._getSettings(),w=`${n}:${o}`;if("firestore.googleapis.com"!==_.host&&_.host!==w&&lc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),i._setSettings(Object.assign(Object.assign({},_),{host:w,ssl:!1})),a.mockUserToken){let S,L;if("string"==typeof a.mockUserToken)S=a.mockUserToken,L=ai.MOCK_USER;else{S=(0,$r.Sg)(a.mockUserToken,null===(h=i._app)||void 0===h?void 0:h.options.projectId);const B=a.mockUserToken.sub||a.mockUserToken.user_id;if(!B)throw new Se(Jt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");L=new ai(B)}i._authCredentials=new cf(new g1(S,L))}}(h,..._)}return h}function Vs(i){return i._firestoreClient||c2(i),i._firestoreClient.verifyNotTerminated(),i._firestoreClient}function c2(i){var n,o,a;const h=i._freezeSettings(),_=(S=(null===(n=i._app)||void 0===n?void 0:n.options.appId)||"",new YP(i._databaseId,S,i._persistenceKey,(B=h).host,B.ssl,B.experimentalForceLongPolling,B.experimentalAutoDetectLongPolling,dE(B.experimentalLongPollingOptions),B.useFetchStreams));var S,B;i._firestoreClient=new Ux(i._authCredentials,i._appCheckCredentials,i._queue,_),null!==(o=h.cache)&&void 0!==o&&o._offlineComponentProvider&&null!==(a=h.cache)&&void 0!==a&&a._onlineComponentProvider&&(i._firestoreClient._uninitializedComponentsProvider={_offlineKind:h.cache.kind,_offline:h.cache._offlineComponentProvider,_online:h.cache._onlineComponentProvider})}class Sm{constructor(n){this._byteString=n}static fromBase64String(n){try{return new Sm(ys.fromBase64String(n))}catch(o){throw new Se(Jt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+o)}}static fromUint8Array(n){return new Sm(ys.fromUint8Array(n))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(n){return this._byteString.isEqual(n._byteString)}}class js{constructor(...n){for(let o=0;o<n.length;++o)if(0===n[o].length)throw new Se(Jt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new _s(n)}isEqual(n){return this._internalPath.isEqual(n._internalPath)}}class fM{constructor(n){this._methodName=n}}class tg{constructor(n,o){if(!isFinite(n)||n<-90||n>90)throw new Se(Jt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+n);if(!isFinite(o)||o<-180||o>180)throw new Se(Jt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+o);this._lat=n,this._long=o}get latitude(){return this._lat}get longitude(){return this._long}isEqual(n){return this._lat===n._lat&&this._long===n._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(n){return Br(this._lat,n._lat)||Br(this._long,n._long)}}const Zx=/^__.*__$/;class Wx{constructor(n,o,a){this.data=n,this.fieldMask=o,this.fieldTransforms=a}toMutation(n,o){return null!==this.fieldMask?new kl(n,this.data,this.fieldMask,o,this.fieldTransforms):new rm(n,this.data,o,this.fieldTransforms)}}function gM(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wn()}}class Kx{constructor(n,o,a,h,_,w){this.settings=n,this.databaseId=o,this.serializer=a,this.ignoreUndefinedProperties=h,void 0===_&&this.ua(),this.fieldTransforms=_||[],this.fieldMask=w||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(n){return new Kx(Object.assign(Object.assign({},this.settings),n),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(n){var o;const a=null===(o=this.path)||void 0===o?void 0:o.child(n),h=this.aa({path:a,la:!1});return h.fa(n),h}da(n){var o;const a=null===(o=this.path)||void 0===o?void 0:o.child(n),h=this.aa({path:a,la:!1});return h.ua(),h}wa(n){return this.aa({path:void 0,la:!0})}_a(n){return Dy(n,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(n){return void 0!==this.fieldMask.find(o=>n.isPrefixOf(o))||void 0!==this.fieldTransforms.find(o=>n.isPrefixOf(o.field))}ua(){if(this.path)for(let n=0;n<this.path.length;n++)this.fa(this.path.get(n))}fa(n){if(0===n.length)throw this._a("Document fields must not be empty");if(gM(this.ca)&&Zx.test(n))throw this._a('Document fields cannot begin and end with "__"')}}class h2{constructor(n,o,a){this.databaseId=n,this.ignoreUndefinedProperties=o,this.serializer=a||Cv(n)}ya(n,o,a,h=!1){return new Kx({ca:n,methodName:o,ga:a,path:_s.emptyPath(),la:!1,ma:h},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ty(i){const n=i._freezeSettings(),o=Cv(i._databaseId);return new h2(i._databaseId,!!n.ignoreUndefinedProperties,o)}function Iy(i,n,o,a,h,_={}){const w=i.ya(_.merge||_.mergeFields?2:0,n,o,h);Gv("Data must be an object, but it was:",w,a);const S=xE(a,w);let L,B;if(_.merge)L=new ul(w.fieldMask),B=w.fieldTransforms;else if(_.mergeFields){const H=[];for(const Y of _.mergeFields){const pt=Hv(n,Y,o);if(!w.contains(pt))throw new Se(Jt.INVALID_ARGUMENT,`Field '${pt}' is specified in your field mask but missing from your input data.`);wE(H,pt)||H.push(pt)}L=new ul(H),B=w.fieldTransforms.filter(Y=>L.covers(Y.field))}else L=null,B=w.fieldTransforms;return new Wx(new ui(S),L,B)}function Dm(i,n){if(_M(i=(0,$r.m9)(i)))return Gv("Unsupported field value:",n,i),xE(i,n);if(i instanceof fM)return function(o,a){if(!gM(a.ca))throw a._a(`${o._methodName}() can only be used with update() and set()`);if(!a.path)throw a._a(`${o._methodName}() is not currently supported inside arrays`);const h=o._toFieldTransform(a);h&&a.fieldTransforms.push(h)}(i,n),null;if(void 0===i&&n.ignoreUndefinedProperties)return null;if(n.path&&n.fieldMask.push(n.path),i instanceof Array){if(n.settings.la&&4!==n.ca)throw n._a("Nested arrays are not supported");return function(o,a){const h=[];let _=0;for(const w of o){let S=Dm(w,a.wa(_));null==S&&(S={nullValue:"NULL_VALUE"}),h.push(S),_++}return{arrayValue:{values:h}}}(i,n)}return function(o,a){if(null===(o=(0,$r.m9)(o)))return{nullValue:"NULL_VALUE"};if("number"==typeof o)return L1(a.serializer,o);if("boolean"==typeof o)return{booleanValue:o};if("string"==typeof o)return{stringValue:o};if(o instanceof Date){const h=An.fromDate(o);return{timestampValue:im(a.serializer,h)}}if(o instanceof An){const h=new An(o.seconds,1e3*Math.floor(o.nanoseconds/1e3));return{timestampValue:im(a.serializer,h)}}if(o instanceof tg)return{geoPointValue:{latitude:o.latitude,longitude:o.longitude}};if(o instanceof Sm)return{bytesValue:uO(a.serializer,o._byteString)};if(o instanceof as){const h=a.databaseId,_=o.firestore._databaseId;if(!_.isEqual(h))throw a._a(`Document reference is for database ${_.projectId}/${_.database} but should be for database ${h.projectId}/${h.database}`);return{referenceValue:H1(o.firestore._databaseId||a.databaseId,o._key.path)}}throw a._a(`Unsupported field value: ${fh(o)}`)}(i,n)}function xE(i,n){const o={};return U_(i)?n.path&&n.path.length>0&&n.fieldMask.push(n.path):Zu(i,(a,h)=>{const _=Dm(h,n.ha(a));null!=_&&(o[a]=_)}),{mapValue:{fields:o}}}function _M(i){return!("object"!=typeof i||null===i||i instanceof Array||i instanceof Date||i instanceof An||i instanceof tg||i instanceof Sm||i instanceof as||i instanceof fM)}function Gv(i,n,o){if(!_M(o)||"object"!=typeof(a=o)||null===a||Object.getPrototypeOf(a)!==Object.prototype&&null!==Object.getPrototypeOf(a)){const a=fh(o);throw n._a("an object"===a?i+" a custom object":i+" "+a)}var a}function Hv(i,n,o){if((n=(0,$r.m9)(n))instanceof js)return n._internalPath;if("string"==typeof n)return qv(i,n);throw Dy("Field path arguments must be of type string or ",i,!1,void 0,o)}const g2=new RegExp("[~\\*/\\[\\]]");function qv(i,n,o){if(n.search(g2)>=0)throw Dy(`Invalid field path (${n}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,o);try{return new js(...n.split("."))._internalPath}catch{throw Dy(`Invalid field path (${n}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,o)}}function Dy(i,n,o,a,h){const _=a&&!a.isEmpty(),w=void 0!==h;let S=`Function ${n}() called with invalid data`;o&&(S+=" (via `toFirestore()`)"),S+=". ";let L="";return(_||w)&&(L+=" (found",_&&(L+=` in field ${a}`),w&&(L+=` in document ${h}`),L+=")"),new Se(Jt.INVALID_ARGUMENT,S+i+L)}function wE(i,n){return i.some(o=>o.isEqual(n))}class $s{constructor(n,o,a,h,_){this._firestore=n,this._userDataWriter=o,this._key=a,this._document=h,this._converter=_}get id(){return this._key.path.lastSegment()}get ref(){return new as(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const n=new CE(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(n)}return this._userDataWriter.convertValue(this._document.data.value)}}get(n){if(this._document){const o=this._document.data.field(Zv("DocumentSnapshot.get",n));if(null!==o)return this._userDataWriter.convertValue(o)}}}class CE extends $s{data(){return super.data()}}function Zv(i,n){return"string"==typeof n?qv(i,n):n instanceof js?n._internalPath:n._delegate._internalPath}class SE{convertValue(n,o="none"){switch(Rp(n)){case 0:return null;case 1:return n.booleanValue;case 2:return Vi(n.integerValue||n.doubleValue);case 3:return this.convertTimestamp(n.timestampValue);case 4:return this.convertServerTimestamp(n,o);case 5:return n.stringValue;case 6:return this.convertBytes(Wu(n.bytesValue));case 7:return this.convertReference(n.referenceValue);case 8:return this.convertGeoPoint(n.geoPointValue);case 9:return this.convertArray(n.arrayValue,o);case 10:return this.convertObject(n.mapValue,o);default:throw wn()}}convertObject(n,o){return this.convertObjectMap(n.fields,o)}convertObjectMap(n,o="none"){const a={};return Zu(n,(h,_)=>{a[h]=this.convertValue(_,o)}),a}convertGeoPoint(n){return new tg(Vi(n.latitude),Vi(n.longitude))}convertArray(n,o){return(n.values||[]).map(a=>this.convertValue(a,o))}convertServerTimestamp(n,o){switch(o){case"previous":const a=N0(n);return null==a?null:this.convertValue(a,o);case"estimate":return this.convertTimestamp(qd(n));default:return null}}convertTimestamp(n){const o=pf(n);return new An(o.seconds,o.nanos)}convertDocumentKey(n,o){const a=io.fromString(n);$n(mO(a));const h=new Dl(a.get(1),a.get(3)),_=new hn(a.popFirst(5));return h.isEqual(o)||rs(`Document ${_} contains a document reference within a different database (${h.projectId}/${h.database}) which is not supported. It will be treated as a reference in the current database (${o.projectId}/${o.database}) instead.`),_}}class ng{constructor(n,o){this.hasPendingWrites=n,this.fromCache=o}isEqual(n){return this.hasPendingWrites===n.hasPendingWrites&&this.fromCache===n.fromCache}}class km extends $s{constructor(n,o,a,h,_,w){super(n,o,a,h,w),this._firestore=n,this._firestoreImpl=n,this.metadata=_}exists(){return super.exists()}data(n={}){if(this._document){if(this._converter){const o=new Qv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(o,n)}return this._userDataWriter.convertValue(this._document.data.value,n.serverTimestamps)}}get(n,o={}){if(this._document){const a=this._document.data.field(Zv("DocumentSnapshot.get",n));if(null!==a)return this._userDataWriter.convertValue(a,o.serverTimestamps)}}}class Qv extends km{data(n={}){return super.data(n)}}class Jv{constructor(n,o,a,h){this._firestore=n,this._userDataWriter=o,this._snapshot=h,this.metadata=new ng(h.hasPendingWrites,h.fromCache),this.query=a}get docs(){const n=[];return this.forEach(o=>n.push(o)),n}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(n,o){this._snapshot.docs.forEach(a=>{n.call(o,new Qv(this._firestore,this._userDataWriter,a.key,a,new ng(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(n={}){const o=!!n.includeMetadataChanges;if(o&&this._snapshot.excludesMetadataChanges)throw new Se(Jt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===o||(this._cachedChanges=function(a,h){if(a._snapshot.oldDocs.isEmpty()){let _=0;return a._snapshot.docChanges.map(w=>({type:"added",doc:new Qv(a._firestore,a._userDataWriter,w.doc.key,w.doc,new ng(a._snapshot.mutatedKeys.has(w.doc.key),a._snapshot.fromCache),a.query.converter),oldIndex:-1,newIndex:_++}))}{let _=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(w=>h||3!==w.type).map(w=>{const S=new Qv(a._firestore,a._userDataWriter,w.doc.key,w.doc,new ng(a._snapshot.mutatedKeys.has(w.doc.key),a._snapshot.fromCache),a.query.converter);let L=-1,B=-1;return 0!==w.type&&(L=_.indexOf(w.doc.key),_=_.delete(w.doc.key)),1!==w.type&&(_=_.add(w.doc),B=_.indexOf(w.doc.key)),{type:ph(w.type),doc:S,oldIndex:L,newIndex:B}})}}(this,o),this._cachedChangesIncludeMetadataChanges=o),this._cachedChanges}}function ph(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wn()}}class Nf extends SE{constructor(n){super(),this.firestore=n}convertBytes(n){return new Sm(n)}convertReference(n){const o=this.convertDocumentKey(n,this.firestore._databaseId);return new as(this.firestore,null,o)}}function Jx(i){return Ry(wo(i.firestore,ji),[new Jd(i._key,ei.none())])}function Ba(i,n){const o=wo(i.firestore,ji),a=lM(i),h=function id(i,n,o){let a;return a=i?o&&(o.merge||o.mergeFields)?i.toFirestore(n,o):i.toFirestore(n):n,a}(i.converter,n);return Ry(o,[Iy(Ty(i.firestore),"addDoc",a._key,h,null!==i.converter,{}).toMutation(a._key,ei.exists(!1))]).then(()=>a)}function tw(i,...n){var o,a,h;i=(0,$r.m9)(i);let _={includeMetadataChanges:!1},w=0;"object"!=typeof n[w]||qx(n[w])||(_=n[w],w++);const S={includeMetadataChanges:_.includeMetadataChanges};if(qx(n[w])){const Y=n[w];n[w]=null===(o=Y.next)||void 0===o?void 0:o.bind(Y),n[w+1]=null===(a=Y.error)||void 0===a?void 0:a.bind(Y),n[w+2]=null===(h=Y.complete)||void 0===h?void 0:h.bind(Y)}let L,B,H;if(i instanceof as)B=wo(i.firestore,ji),H=Bs(i._key.path),L={next:Y=>{n[w]&&n[w](function Ff(i,n,o){const a=o.docs.get(n._key),h=new Nf(i);return new km(i,h,n._key,a,new ng(o.hasPendingWrites,o.fromCache),n.converter)}(B,i,Y))},error:n[w+1],complete:n[w+2]};else{const Y=wo(i,va);B=wo(Y.firestore,ji),H=Y._query;const pt=new Nf(B);L={next:xt=>{n[w]&&n[w](new Jv(B,pt,Y,xt))},error:n[w+1],complete:n[w+2]},function kf(i){if("L"===i.limitType&&0===i.explicitOrderBy.length)throw new Se(Jt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(i._query)}return function(Y,pt,xt,At){const Ut=new Pm(At),Zt=new Ix(pt,Ut,xt);return Y.asyncQueue.enqueueAndForget((0,Je.Z)(function*(){return function Dv(i,n){return kv.apply(this,arguments)}(yield Em(Y),Zt)})),()=>{Ut.Dc(),Y.asyncQueue.enqueueAndForget((0,Je.Z)(function*(){return function Af(i,n){return Ex.apply(this,arguments)}(yield Em(Y),Zt)}))}}(Vs(B),H,S,L)}function Ry(i,n){return function(o,a){const h=new Ss;return o.asyncQueue.enqueueAndForget((0,Je.Z)(function*(){return function bm(i,n,o){return HC.apply(this,arguments)}(yield function Py(i){return Uv(i).then(n=>n.syncEngine)}(o),a,h)})),h.promise}(Vs(i),n)}!function(i,n=!0){_a=ts.SDK_VERSION,(0,ts._registerComponent)(new Oa.wA("firestore",(o,{instanceIdentifier:a,options:h})=>{const _=o.getProvider("app").getImmediate(),w=new ji(new Ui(o.getProvider("auth-internal")),new $w(o.getProvider("app-check-internal")),function(S,L){if(!Object.prototype.hasOwnProperty.apply(S.options,["projectId"]))throw new Se(Jt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Dl(S.options.projectId,L)}(_,a),_);return h=Object.assign({useFetchStreams:n},h),w._setSettings(h),w},"PUBLIC").setMultipleInstances(!0)),(0,ts.registerVersion)(C0,"3.13.0",i),(0,ts.registerVersion)(C0,"3.13.0","esm2017")}();class SM{constructor(n){return n}}const O2="firestore",DM=new x.OlP("angularfire2.firestore-instances");function rb(i){return(n,o)=>{const a=n.runOutsideAngular(()=>i(o));return new SM(a)}}const NE={provide:class E2{constructor(){return(0,Wr.vb)(O2)}},deps:[[new x.FiY,DM]]},FE={provide:SM,useFactory:function T2(i,n){const o=(0,Wr.JM)(O2,i,n);return o&&new SM(o)},deps:[[new x.FiY,DM],Ns]};let zE=(()=>{class i{constructor(){(0,da.KN)("angularfire",Wr.q4.full,"fst")}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=x.oAB({type:i}),i.\u0275inj=x.cJS({providers:[FE,NE]}),i})();function kM(i,...n){return{ngModule:zE,providers:[{provide:DM,useFactory:rb(i),multi:!0,deps:[x.R0b,x.zs3,Wr.HU,Mu,[new x.FiY,gb],[new x.FiY,sn],...n]}]}}const BE=(0,Wr.u3)(Ba,!0),D2=(0,Wr.u3)(gE,!0),zM=(0,Wr.u3)(Jx,!0),r=(0,Wr.u3)(lM,!0),l=(0,Wr.u3)(l2,!0),T=(0,Wr.u3)(tw,!0);var Nt=ft(2459),$t=ft(5592);const{isArray:Rt}=Array,{getPrototypeOf:oe,prototype:Oe,keys:Ee}=Object;function Be(i){if(1===i.length){const n=i[0];if(Rt(n))return{args:n,keys:null};if(function je(i){return i&&"object"==typeof i&&oe(i)===Oe}(n)){const o=Ee(n);return{args:o.map(a=>n[a]),keys:o}}}return{args:i,keys:null}}var On=ft(4829),Qe=ft(4564),nr=ft(8251),ln=ft(7398);const{isArray:Ln}=Array;function mn(i){return(0,ln.U)(n=>function En(i,n){return Ln(n)?i(...n):i(n)}(i,n))}function wr(i,n){return i.reduce((o,a,h)=>(o[a]=n[h],o),{})}let rr=(()=>{class i{constructor(o,a){this._renderer=o,this._elementRef=a,this.onChange=h=>{},this.onTouched=()=>{}}setProperty(o,a){this._renderer.setProperty(this._elementRef.nativeElement,o,a)}registerOnTouched(o){this.onTouched=o}registerOnChange(o){this.onChange=o}setDisabledState(o){this.setProperty("disabled",o)}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(x.Qsj),x.Y36(x.SBq))};static#e=this.\u0275dir=x.lG2({type:i})}return i})(),Kr=(()=>{class i extends rr{static#t=this.\u0275fac=function(){let o;return function(h){return(o||(o=x.n5z(i)))(h||i)}}();static#e=this.\u0275dir=x.lG2({type:i,features:[x.qOj]})}return i})();const Ao=new x.OlP("NgValueAccessor"),$i={provide:Ao,useExisting:(0,x.Gpc)(()=>Gr),multi:!0},Ho=new x.OlP("CompositionEventMode");let Gr=(()=>{class i extends rr{constructor(o,a,h){super(o,a),this._compositionMode=h,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Ii(){const i=It()?It().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}())}writeValue(o){this.setProperty("value",o??"")}_handleInput(o){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(o)}_compositionStart(){this._composing=!0}_compositionEnd(o){this._composing=!1,this._compositionMode&&this.onChange(o)}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(x.Qsj),x.Y36(x.SBq),x.Y36(Ho,8))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(a,h){1&a&&x.NdJ("input",function(w){return h._handleInput(w.target.value)})("blur",function(){return h.onTouched()})("compositionstart",function(){return h._compositionStart()})("compositionend",function(w){return h._compositionEnd(w.target.value)})},features:[x._Bn([$i]),x.qOj]})}return i})();function Si(i){return null==i||("string"==typeof i||Array.isArray(i))&&0===i.length}function zf(i){return null!=i&&"number"==typeof i.length}const ls=new x.OlP("NgValidators"),Ll=new x.OlP("NgAsyncValidators"),BM=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class UM{static min(n){return function VM(i){return n=>{if(Si(n.value)||Si(i))return null;const o=parseFloat(n.value);return!isNaN(o)&&o<i?{min:{min:i,actual:n.value}}:null}}(n)}static max(n){return function k2(i){return n=>{if(Si(n.value)||Si(i))return null;const o=parseFloat(n.value);return!isNaN(o)&&o>i?{max:{max:i,actual:n.value}}:null}}(n)}static required(n){return R2(n)}static requiredTrue(n){return function L2(i){return!0===i.value?null:{required:!0}}(n)}static email(n){return function N2(i){return Si(i.value)||BM.test(i.value)?null:{email:!0}}(n)}static minLength(n){return function F2(i){return n=>Si(n.value)||!zf(n.value)?null:n.value.length<i?{minlength:{requiredLength:i,actualLength:n.value.length}}:null}(n)}static maxLength(n){return function z2(i){return n=>zf(n.value)&&n.value.length>i?{maxlength:{requiredLength:i,actualLength:n.value.length}}:null}(n)}static pattern(n){return function B2(i){if(!i)return rw;let n,o;return"string"==typeof i?(o="","^"!==i.charAt(0)&&(o+="^"),o+=i,"$"!==i.charAt(i.length-1)&&(o+="$"),n=new RegExp(o)):(o=i.toString(),n=i),a=>{if(Si(a.value))return null;const h=a.value;return n.test(h)?null:{pattern:{requiredPattern:o,actualValue:h}}}}(n)}static nullValidator(n){return null}static compose(n){return jE(n)}static composeAsync(n){return $E(n)}}function R2(i){return Si(i.value)?{required:!0}:null}function rw(i){return null}function UE(i){return null!=i}function Bf(i){return(0,x.QGY)(i)?(0,Nt.D)(i):i}function U2(i){let n={};return i.forEach(o=>{n=null!=o?{...n,...o}:n}),0===Object.keys(n).length?null:n}function Ly(i,n){return n.map(o=>o(i))}function VE(i){return i.map(n=>function V2(i){return!i.validate}(n)?n:o=>n.validate(o))}function jE(i){if(!i)return null;const n=i.filter(UE);return 0==n.length?null:function(o){return U2(Ly(o,n))}}function rg(i){return null!=i?jE(VE(i)):null}function $E(i){if(!i)return null;const n=i.filter(UE);return 0==n.length?null:function(o){return function Lr(...i){const n=(0,Qe.jO)(i),{args:o,keys:a}=Be(i),h=new $t.y(_=>{const{length:w}=o;if(!w)return void _.complete();const S=new Array(w);let L=w,B=w;for(let H=0;H<w;H++){let Y=!1;(0,On.Xf)(o[H]).subscribe((0,nr.x)(_,pt=>{Y||(Y=!0,B--),S[H]=pt},()=>L--,void 0,()=>{(!L||!Y)&&(B||_.next(a?wr(a,S):S),_.complete())}))}});return n?h.pipe(mn(n)):h}(Ly(o,n).map(Bf)).pipe((0,ln.U)(U2))}}function j2(i){return null!=i?$E(VE(i)):null}function bc(i,n){return null===i?[n]:Array.isArray(i)?[...i,n]:[i,n]}function xc(i){return i._rawValidators}function ob(i){return i._rawAsyncValidators}function GE(i){return i?Array.isArray(i)?i:[i]:[]}function og(i,n){return Array.isArray(i)?i.includes(n):i===n}function JD(i,n){const o=GE(n);return GE(i).forEach(h=>{og(o,h)||o.push(h)}),o}function tk(i,n){return GE(n).filter(o=>!og(i,o))}class ek{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=rg(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=j2(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,o){return!!this.control&&this.control.hasError(n,o)}getError(n,o){return this.control?this.control.getError(n,o):null}}class sd extends ek{get formDirective(){return null}get path(){return null}}class ow extends ek{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class nk{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let HE=(()=>{class i extends nk{constructor(o){super(o)}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(ow,2))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(a,h){2&a&&x.ekj("ng-untouched",h.isUntouched)("ng-touched",h.isTouched)("ng-pristine",h.isPristine)("ng-dirty",h.isDirty)("ng-valid",h.isValid)("ng-invalid",h.isInvalid)("ng-pending",h.isPending)},features:[x.qOj]})}return i})(),$2=(()=>{class i extends nk{constructor(o){super(o)}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(sd,10))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(a,h){2&a&&x.ekj("ng-untouched",h.isUntouched)("ng-touched",h.isTouched)("ng-pristine",h.isPristine)("ng-dirty",h.isDirty)("ng-valid",h.isValid)("ng-invalid",h.isInvalid)("ng-pending",h.isPending)("ng-submitted",h.isSubmitted)},features:[x.qOj]})}return i})();const G2="VALID",cS="INVALID",qE="PENDING",H2="DISABLED";function wA(i){return(uS(i)?i.validators:i)||null}function CA(i,n){return(uS(n)?n.asyncValidators:i)||null}function uS(i){return null!=i&&!Array.isArray(i)&&"object"==typeof i}function ok(i,n,o){const a=i.controls;if(!(n?Object.keys(a):a).length)throw new x.vHH(1e3,"");if(!a[o])throw new x.vHH(1001,"")}function ik(i,n,o){i._forEachChild((a,h)=>{if(void 0===o[h])throw new x.vHH(1002,"")})}class dS{constructor(n,o){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(o)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===G2}get invalid(){return this.status===cS}get pending(){return this.status==qE}get disabled(){return this.status===H2}get enabled(){return this.status!==H2}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(JD(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(JD(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(tk(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(tk(n,this._rawAsyncValidators))}hasValidator(n){return og(this._rawValidators,n)}hasAsyncValidator(n){return og(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(o=>{o.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(o=>{o.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=qE,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const o=this._parentMarkedDirty(n.onlySelf);this.status=H2,this.errors=null,this._forEachChild(a=>{a.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:o}),this._onDisabledChange.forEach(a=>a(!0))}enable(n={}){const o=this._parentMarkedDirty(n.onlySelf);this.status=G2,this._forEachChild(a=>{a.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:o}),this._onDisabledChange.forEach(a=>a(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===G2||this.status===qE)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(o=>o._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?H2:G2}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=qE,this._hasOwnPendingAsyncValidator=!0;const o=Bf(this.asyncValidator(this));this._asyncValidationSubscription=o.subscribe(a=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(a,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,o={}){this.errors=n,this._updateControlsErrors(!1!==o.emitEvent)}get(n){let o=n;return null==o||(Array.isArray(o)||(o=o.split(".")),0===o.length)?null:o.reduce((a,h)=>a&&a._find(h),this)}getError(n,o){const a=o?this.get(o):this;return a&&a.errors?a.errors[n]:null}hasError(n,o){return!!this.getError(n,o)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new x.vpe,this.statusChanges=new x.vpe}_calculateStatus(){return this._allControlsDisabled()?H2:this.errors?cS:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(qE)?qE:this._anyControlsHaveStatus(cS)?cS:G2}_anyControlsHaveStatus(n){return this._anyControls(o=>o.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){uS(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function F5(i){return Array.isArray(i)?rg(i):i||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function z5(i){return Array.isArray(i)?j2(i):i||null}(this._rawAsyncValidators)}}class ZE extends dS{constructor(n,o,a){super(wA(o),CA(a,o)),this.controls=n,this._initObservables(),this._setUpdateStrategy(o),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,o){return this.controls[n]?this.controls[n]:(this.controls[n]=o,o.setParent(this),o._registerOnCollectionChange(this._onCollectionChange),o)}addControl(n,o,a={}){this.registerControl(n,o),this.updateValueAndValidity({emitEvent:a.emitEvent}),this._onCollectionChange()}removeControl(n,o={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:o.emitEvent}),this._onCollectionChange()}setControl(n,o,a={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],o&&this.registerControl(n,o),this.updateValueAndValidity({emitEvent:a.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,o={}){ik(this,0,n),Object.keys(n).forEach(a=>{ok(this,!0,a),this.controls[a].setValue(n[a],{onlySelf:!0,emitEvent:o.emitEvent})}),this.updateValueAndValidity(o)}patchValue(n,o={}){null!=n&&(Object.keys(n).forEach(a=>{const h=this.controls[a];h&&h.patchValue(n[a],{onlySelf:!0,emitEvent:o.emitEvent})}),this.updateValueAndValidity(o))}reset(n={},o={}){this._forEachChild((a,h)=>{a.reset(n?n[h]:null,{onlySelf:!0,emitEvent:o.emitEvent})}),this._updatePristine(o),this._updateTouched(o),this.updateValueAndValidity(o)}getRawValue(){return this._reduceChildren({},(n,o,a)=>(n[a]=o.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(o,a)=>!!a._syncPendingControls()||o);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(o=>{const a=this.controls[o];a&&n(a,o)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[o,a]of Object.entries(this.controls))if(this.contains(o)&&n(a))return!0;return!1}_reduceValue(){return this._reduceChildren({},(o,a,h)=>((a.enabled||this.disabled)&&(o[h]=a.value),o))}_reduceChildren(n,o){let a=n;return this._forEachChild((h,_)=>{a=o(a,h,_)}),a}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}class sk extends ZE{}const jM=new x.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>q2}),q2="always";function hS(i,n){return[...n.path,i]}function Z2(i,n,o=q2){MA(i,n),n.valueAccessor.writeValue(i.value),(i.disabled||"always"===o)&&n.valueAccessor.setDisabledState?.(i.disabled),function U5(i,n){n.valueAccessor.registerOnChange(o=>{i._pendingValue=o,i._pendingChange=!0,i._pendingDirty=!0,"change"===i.updateOn&&ak(i,n)})}(i,n),function j5(i,n){const o=(a,h)=>{n.valueAccessor.writeValue(a),h&&n.viewToModelUpdate(a)};i.registerOnChange(o),n._registerOnDestroy(()=>{i._unregisterOnChange(o)})}(i,n),function V5(i,n){n.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,"blur"===i.updateOn&&i._pendingChange&&ak(i,n),"submit"!==i.updateOn&&i.markAsTouched()})}(i,n),function B5(i,n){if(n.valueAccessor.setDisabledState){const o=a=>{n.valueAccessor.setDisabledState(a)};i.registerOnDisabledChange(o),n._registerOnDestroy(()=>{i._unregisterOnDisabledChange(o)})}}(i,n)}function fS(i,n,o=!0){const a=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(a),n.valueAccessor.registerOnTouched(a)),gS(i,n),i&&(n._invokeOnDestroyCallbacks(),i._registerOnCollectionChange(()=>{}))}function pS(i,n){i.forEach(o=>{o.registerOnValidatorChange&&o.registerOnValidatorChange(n)})}function MA(i,n){const o=xc(i);null!==n.validator?i.setValidators(bc(o,n.validator)):"function"==typeof o&&i.setValidators([o]);const a=ob(i);null!==n.asyncValidator?i.setAsyncValidators(bc(a,n.asyncValidator)):"function"==typeof a&&i.setAsyncValidators([a]);const h=()=>i.updateValueAndValidity();pS(n._rawValidators,h),pS(n._rawAsyncValidators,h)}function gS(i,n){let o=!1;if(null!==i){if(null!==n.validator){const h=xc(i);if(Array.isArray(h)&&h.length>0){const _=h.filter(w=>w!==n.validator);_.length!==h.length&&(o=!0,i.setValidators(_))}}if(null!==n.asyncValidator){const h=ob(i);if(Array.isArray(h)&&h.length>0){const _=h.filter(w=>w!==n.asyncValidator);_.length!==h.length&&(o=!0,i.setAsyncValidators(_))}}}const a=()=>{};return pS(n._rawValidators,a),pS(n._rawAsyncValidators,a),o}function ak(i,n){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function lk(i,n){MA(i,n)}function OA(i,n){if(!i.hasOwnProperty("model"))return!1;const o=i.model;return!!o.isFirstChange()||!Object.is(n,o.currentValue)}function ck(i,n){i._syncPendingControls(),n.forEach(o=>{const a=o.control;"submit"===a.updateOn&&a._pendingChange&&(o.viewToModelUpdate(a._pendingValue),a._pendingChange=!1)})}function EA(i,n){if(!n)return null;let o,a,h;return Array.isArray(n),n.forEach(_=>{_.constructor===Gr?o=_:function H5(i){return Object.getPrototypeOf(i.constructor)===Kr}(_)?a=_:h=_}),h||a||o||null}const Z5={provide:sd,useExisting:(0,x.Gpc)(()=>WE)},W2=(()=>Promise.resolve())();let WE=(()=>{class i extends sd{constructor(o,a,h){super(),this.callSetDisabledState=h,this.submitted=!1,this._directives=new Set,this.ngSubmit=new x.vpe,this.form=new ZE({},rg(o),j2(a))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(o){W2.then(()=>{const a=this._findContainer(o.path);o.control=a.registerControl(o.name,o.control),Z2(o.control,o,this.callSetDisabledState),o.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(o)})}getControl(o){return this.form.get(o.path)}removeControl(o){W2.then(()=>{const a=this._findContainer(o.path);a&&a.removeControl(o.name),this._directives.delete(o)})}addFormGroup(o){W2.then(()=>{const a=this._findContainer(o.path),h=new ZE({});lk(h,o),a.registerControl(o.name,h),h.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(o){W2.then(()=>{const a=this._findContainer(o.path);a&&a.removeControl(o.name)})}getFormGroup(o){return this.form.get(o.path)}updateModel(o,a){W2.then(()=>{this.form.get(o.path).setValue(a)})}setValue(o){this.control.setValue(o)}onSubmit(o){return this.submitted=!0,ck(this.form,this._directives),this.ngSubmit.emit(o),"dialog"===o?.target?.method}onReset(){this.resetForm()}resetForm(o=void 0){this.form.reset(o),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(o){return o.pop(),o.length?this.form.get(o):this.form}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(ls,10),x.Y36(Ll,10),x.Y36(jM,8))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(a,h){1&a&&x.NdJ("submit",function(w){return h.onSubmit(w)})("reset",function(){return h.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[x._Bn([Z5]),x.qOj]})}return i})();function uk(i,n){const o=i.indexOf(n);o>-1&&i.splice(o,1)}function dk(i){return"object"==typeof i&&null!==i&&2===Object.keys(i).length&&"value"in i&&"disabled"in i}const Rm=class extends dS{constructor(n=null,o,a){super(wA(o),CA(a,o)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(o),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),uS(o)&&(o.nonNullable||o.initialValueIsDefault)&&(this.defaultValue=dk(n)?n.value:n)}setValue(n,o={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==o.emitModelToViewChange&&this._onChange.forEach(a=>a(this.value,!1!==o.emitViewToModelChange)),this.updateValueAndValidity(o)}patchValue(n,o={}){this.setValue(n,o)}reset(n=this.defaultValue,o={}){this._applyFormState(n),this.markAsPristine(o),this.markAsUntouched(o),this.setValue(this.value,o),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){uk(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){uk(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){dk(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},Y5={provide:ow,useExisting:(0,x.Gpc)(()=>KE)},pk=(()=>Promise.resolve())();let KE=(()=>{class i extends ow{constructor(o,a,h,_,w,S){super(),this._changeDetectorRef=w,this.callSetDisabledState=S,this.control=new Rm,this._registered=!1,this.name="",this.update=new x.vpe,this._parent=o,this._setValidators(a),this._setAsyncValidators(h),this.valueAccessor=EA(0,_)}ngOnChanges(o){if(this._checkForErrors(),!this._registered||"name"in o){if(this._registered&&(this._checkName(),this.formDirective)){const a=o.name.previousValue;this.formDirective.removeControl({name:a,path:this._getPath(a)})}this._setUpControl()}"isDisabled"in o&&this._updateDisabled(o),OA(o,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(o){this.viewModel=o,this.update.emit(o)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Z2(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(o){pk.then(()=>{this.control.setValue(o,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(o){const a=o.isDisabled.currentValue,h=0!==a&&(0,x.VuI)(a);pk.then(()=>{h&&!this.control.disabled?this.control.disable():!h&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(o){return this._parent?hS(o,this._parent):[o]}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(sd,9),x.Y36(ls,10),x.Y36(Ll,10),x.Y36(Ao,10),x.Y36(x.sBO,8),x.Y36(jM,8))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[x._Bn([Y5]),x.qOj,x.TTD]})}return i})(),K2=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return i})(),mk=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=x.oAB({type:i});static#n=this.\u0275inj=x.cJS({})}return i})();const TA=new x.OlP("NgModelWithFormControlWarning"),nL={provide:sd,useExisting:(0,x.Gpc)(()=>mS)};let mS=(()=>{class i extends sd{constructor(o,a,h){super(),this.callSetDisabledState=h,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new x.vpe,this._setValidators(o),this._setAsyncValidators(a)}ngOnChanges(o){this._checkFormPresent(),o.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(gS(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(o){const a=this.form.get(o.path);return Z2(a,o,this.callSetDisabledState),a.updateValueAndValidity({emitEvent:!1}),this.directives.push(o),a}getControl(o){return this.form.get(o.path)}removeControl(o){fS(o.control||null,o,!1),function q5(i,n){const o=i.indexOf(n);o>-1&&i.splice(o,1)}(this.directives,o)}addFormGroup(o){this._setUpFormContainer(o)}removeFormGroup(o){this._cleanUpFormContainer(o)}getFormGroup(o){return this.form.get(o.path)}addFormArray(o){this._setUpFormContainer(o)}removeFormArray(o){this._cleanUpFormContainer(o)}getFormArray(o){return this.form.get(o.path)}updateModel(o,a){this.form.get(o.path).setValue(a)}onSubmit(o){return this.submitted=!0,ck(this.form,this.directives),this.ngSubmit.emit(o),"dialog"===o?.target?.method}onReset(){this.resetForm()}resetForm(o=void 0){this.form.reset(o),this.submitted=!1}_updateDomValue(){this.directives.forEach(o=>{const a=o.control,h=this.form.get(o.path);a!==h&&(fS(a||null,o),(i=>i instanceof Rm)(h)&&(Z2(h,o,this.callSetDisabledState),o.control=h))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(o){const a=this.form.get(o.path);lk(a,o),a.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(o){if(this.form){const a=this.form.get(o.path);a&&function $5(i,n){return gS(i,n)}(a,o)&&a.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){MA(this.form,this),this._oldForm&&gS(this._oldForm,this)}_checkFormPresent(){}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(ls,10),x.Y36(Ll,10),x.Y36(jM,8))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["","formGroup",""]],hostBindings:function(a,h){1&a&&x.NdJ("submit",function(w){return h.onSubmit(w)})("reset",function(){return h.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[x._Bn([nL]),x.qOj,x.TTD]})}return i})();const iL={provide:ow,useExisting:(0,x.Gpc)(()=>AA)};let AA=(()=>{class i extends ow{set isDisabled(o){}static#t=this._ngModelWarningSentOnce=!1;constructor(o,a,h,_,w){super(),this._ngModelWarningConfig=w,this._added=!1,this.name=null,this.update=new x.vpe,this._ngModelWarningSent=!1,this._parent=o,this._setValidators(a),this._setAsyncValidators(h),this.valueAccessor=EA(0,_)}ngOnChanges(o){this._added||this._setUpControl(),OA(o,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(o){this.viewModel=o,this.update.emit(o)}get path(){return hS(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static#e=this.\u0275fac=function(a){return new(a||i)(x.Y36(sd,13),x.Y36(ls,10),x.Y36(Ll,10),x.Y36(Ao,10),x.Y36(TA,8))};static#n=this.\u0275dir=x.lG2({type:i,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[x._Bn([iL]),x.qOj,x.TTD]})}return i})();const sL={provide:Ao,useExisting:(0,x.Gpc)(()=>_S),multi:!0};function xk(i,n){return null==i?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${i}: ${n}`.slice(0,50))}let _S=(()=>{class i extends Kr{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(o){this._compareWith=o}writeValue(o){this.value=o;const h=xk(this._getOptionId(o),o);this.setProperty("value",h)}registerOnChange(o){this.onChange=a=>{this.value=this._getOptionValue(a),o(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(o){for(const a of this._optionMap.keys())if(this._compareWith(this._optionMap.get(a),o))return a;return null}_getOptionValue(o){const a=function aL(i){return i.split(":")[0]}(o);return this._optionMap.has(a)?this._optionMap.get(a):o}static#t=this.\u0275fac=function(){let o;return function(h){return(o||(o=x.n5z(i)))(h||i)}}();static#e=this.\u0275dir=x.lG2({type:i,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(a,h){1&a&&x.NdJ("change",function(w){return h.onChange(w.target.value)})("blur",function(){return h.onTouched()})},inputs:{compareWith:"compareWith"},features:[x._Bn([sL]),x.qOj]})}return i})(),wk=(()=>{class i{constructor(o,a,h){this._element=o,this._renderer=a,this._select=h,this._select&&(this.id=this._select._registerOption())}set ngValue(o){null!=this._select&&(this._select._optionMap.set(this.id,o),this._setElementValue(xk(this.id,o)),this._select.writeValue(this._select.value))}set value(o){this._setElementValue(o),this._select&&this._select.writeValue(this._select.value)}_setElementValue(o){this._renderer.setProperty(this._element.nativeElement,"value",o)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(x.SBq),x.Y36(x.Qsj),x.Y36(_S,9))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return i})();const lL={provide:Ao,useExisting:(0,x.Gpc)(()=>DA),multi:!0};function Ck(i,n){return null==i?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${i}: ${n}`.slice(0,50))}let DA=(()=>{class i extends Kr{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(o){this._compareWith=o}writeValue(o){let a;if(this.value=o,Array.isArray(o)){const h=o.map(_=>this._getOptionId(_));a=(_,w)=>{_._setSelected(h.indexOf(w.toString())>-1)}}else a=(h,_)=>{h._setSelected(!1)};this._optionMap.forEach(a)}registerOnChange(o){this.onChange=a=>{const h=[],_=a.selectedOptions;if(void 0!==_){const w=_;for(let S=0;S<w.length;S++){const B=this._getOptionValue(w[S].value);h.push(B)}}else{const w=a.options;for(let S=0;S<w.length;S++){const L=w[S];if(L.selected){const B=this._getOptionValue(L.value);h.push(B)}}}this.value=h,o(h)}}_registerOption(o){const a=(this._idCounter++).toString();return this._optionMap.set(a,o),a}_getOptionId(o){for(const a of this._optionMap.keys())if(this._compareWith(this._optionMap.get(a)._value,o))return a;return null}_getOptionValue(o){const a=function cL(i){return i.split(":")[0]}(o);return this._optionMap.has(a)?this._optionMap.get(a)._value:o}static#t=this.\u0275fac=function(){let o;return function(h){return(o||(o=x.n5z(i)))(h||i)}}();static#e=this.\u0275dir=x.lG2({type:i,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(a,h){1&a&&x.NdJ("change",function(w){return h.onChange(w.target)})("blur",function(){return h.onTouched()})},inputs:{compareWith:"compareWith"},features:[x._Bn([lL]),x.qOj]})}return i})(),Mk=(()=>{class i{constructor(o,a,h){this._element=o,this._renderer=a,this._select=h,this._select&&(this.id=this._select._registerOption(this))}set ngValue(o){null!=this._select&&(this._value=o,this._setElementValue(Ck(this.id,o)),this._select.writeValue(this._select.value))}set value(o){this._select?(this._value=o,this._setElementValue(Ck(this.id,o)),this._select.writeValue(this._select.value)):this._setElementValue(o)}_setElementValue(o){this._renderer.setProperty(this._element.nativeElement,"value",o)}_setSelected(o){this._renderer.setProperty(this._element.nativeElement,"selected",o)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(x.SBq),x.Y36(x.Qsj),x.Y36(DA,9))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return i})(),$M=(()=>{class i{constructor(){this._validator=rw}ngOnChanges(o){if(this.inputName in o){const a=this.normalizeInput(o[this.inputName].currentValue);this._enabled=this.enabled(a),this._validator=this._enabled?this.createValidator(a):rw,this._onChange&&this._onChange()}}validate(o){return this._validator(o)}registerOnValidatorChange(o){this._onChange=o}enabled(o){return null!=o}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275dir=x.lG2({type:i,features:[x.TTD]})}return i})();const hL={provide:ls,useExisting:(0,x.Gpc)(()=>Y2),multi:!0};let Y2=(()=>{class i extends $M{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=x.VuI,this.createValidator=o=>R2}enabled(o){return o}static#t=this.\u0275fac=function(){let o;return function(h){return(o||(o=x.n5z(i)))(h||i)}}();static#e=this.\u0275dir=x.lG2({type:i,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(a,h){2&a&&x.uIk("required",h._enabled?"":null)},inputs:{required:"required"},features:[x._Bn([hL]),x.qOj]})}return i})(),Rk=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=x.oAB({type:i});static#n=this.\u0275inj=x.cJS({imports:[mk]})}return i})();class kA extends dS{constructor(n,o,a){super(wA(o),CA(a,o)),this.controls=n,this._initObservables(),this._setUpdateStrategy(o),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[this._adjustIndex(n)]}push(n,o={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:o.emitEvent}),this._onCollectionChange()}insert(n,o,a={}){this.controls.splice(n,0,o),this._registerControl(o),this.updateValueAndValidity({emitEvent:a.emitEvent})}removeAt(n,o={}){let a=this._adjustIndex(n);a<0&&(a=0),this.controls[a]&&this.controls[a]._registerOnCollectionChange(()=>{}),this.controls.splice(a,1),this.updateValueAndValidity({emitEvent:o.emitEvent})}setControl(n,o,a={}){let h=this._adjustIndex(n);h<0&&(h=0),this.controls[h]&&this.controls[h]._registerOnCollectionChange(()=>{}),this.controls.splice(h,1),o&&(this.controls.splice(h,0,o),this._registerControl(o)),this.updateValueAndValidity({emitEvent:a.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,o={}){ik(this,0,n),n.forEach((a,h)=>{ok(this,!1,h),this.at(h).setValue(a,{onlySelf:!0,emitEvent:o.emitEvent})}),this.updateValueAndValidity(o)}patchValue(n,o={}){null!=n&&(n.forEach((a,h)=>{this.at(h)&&this.at(h).patchValue(a,{onlySelf:!0,emitEvent:o.emitEvent})}),this.updateValueAndValidity(o))}reset(n=[],o={}){this._forEachChild((a,h)=>{a.reset(n[h],{onlySelf:!0,emitEvent:o.emitEvent})}),this._updatePristine(o),this._updateTouched(o),this.updateValueAndValidity(o)}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(o=>o._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((o,a)=>!!a._syncPendingControls()||o,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((o,a)=>{n(o,a)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(o=>o.enabled&&n(o))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}}function Lk(i){return!!i&&(void 0!==i.asyncValidators||void 0!==i.validators||void 0!==i.updateOn)}let yL=(()=>{class i{constructor(){this.useNonNullable=!1}get nonNullable(){const o=new i;return o.useNonNullable=!0,o}group(o,a=null){const h=this._reduceControls(o);let _={};return Lk(a)?_=a:null!==a&&(_.validators=a.validator,_.asyncValidators=a.asyncValidator),new ZE(h,_)}record(o,a=null){const h=this._reduceControls(o);return new sk(h,a)}control(o,a,h){let _={};return this.useNonNullable?(Lk(a)?_=a:(_.validators=a,_.asyncValidators=h),new Rm(o,{..._,nonNullable:!0})):new Rm(o,a,h)}array(o,a,h){const _=o.map(w=>this._createControl(w));return new kA(_,a,h)}_reduceControls(o){const a={};return Object.keys(o).forEach(h=>{a[h]=this._createControl(o[h])}),a}_createControl(o){return o instanceof Rm||o instanceof dS?o:Array.isArray(o)?this.control(o[0],o.length>1?o[1]:null,o.length>2?o[2]:null):this.control(o)}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Nk=(()=>{class i{static withConfig(o){return{ngModule:i,providers:[{provide:jM,useValue:o.callSetDisabledState??q2}]}}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=x.oAB({type:i});static#n=this.\u0275inj=x.cJS({imports:[Rk]})}return i})(),Fk=(()=>{class i{static withConfig(o){return{ngModule:i,providers:[{provide:TA,useValue:o.warnOnNgModelWithFormControl??"always"},{provide:jM,useValue:o.callSetDisabledState??q2}]}}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=x.oAB({type:i});static#n=this.\u0275inj=x.cJS({imports:[Rk]})}return i})();var Nr=ft(2096),ad=ft(1631),X2=ft(4674);function YE(i,n){return(0,X2.m)(n)?(0,ad.z)(i,n,1):(0,ad.z)(i,1)}var ig=ft(9360);function Ny(i,n){return(0,ig.e)((o,a)=>{let h=0;o.subscribe((0,nr.x)(a,_=>i.call(n,_,h++)&&a.next(_)))})}function Q2(i){return(0,ig.e)((n,o)=>{try{n.subscribe(o)}finally{o.add(i)}})}var Nl=ft(4664);class GM{}class yS{}class Fy{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(o=>{const a=o.indexOf(":");if(a>0){const h=o.slice(0,a),_=h.toLowerCase(),w=o.slice(a+1).trim();this.maybeSetNormalizedName(h,_),this.headers.has(_)?this.headers.get(_).push(w):this.headers.set(_,[w])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((o,a)=>{this.setHeaderEntries(a,o)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([o,a])=>{this.setHeaderEntries(o,a)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const o=this.headers.get(n.toLowerCase());return o&&o.length>0?o[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,o){return this.clone({name:n,value:o,op:"a"})}set(n,o){return this.clone({name:n,value:o,op:"s"})}delete(n,o){return this.clone({name:n,value:o,op:"d"})}maybeSetNormalizedName(n,o){this.normalizedNames.has(o)||this.normalizedNames.set(o,n)}init(){this.lazyInit&&(this.lazyInit instanceof Fy?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(o=>{this.headers.set(o,n.headers.get(o)),this.normalizedNames.set(o,n.normalizedNames.get(o))})}clone(n){const o=new Fy;return o.lazyInit=this.lazyInit&&this.lazyInit instanceof Fy?this.lazyInit:this,o.lazyUpdate=(this.lazyUpdate||[]).concat([n]),o}applyUpdate(n){const o=n.name.toLowerCase();switch(n.op){case"a":case"s":let a=n.value;if("string"==typeof a&&(a=[a]),0===a.length)return;this.maybeSetNormalizedName(n.name,o);const h=("a"===n.op?this.headers.get(o):void 0)||[];h.push(...a),this.headers.set(o,h);break;case"d":const _=n.value;if(_){let w=this.headers.get(o);if(!w)return;w=w.filter(S=>-1===_.indexOf(S)),0===w.length?(this.headers.delete(o),this.normalizedNames.delete(o)):this.headers.set(o,w)}else this.headers.delete(o),this.normalizedNames.delete(o)}}setHeaderEntries(n,o){const a=(Array.isArray(o)?o:[o]).map(_=>_.toString()),h=n.toLowerCase();this.headers.set(h,a),this.maybeSetNormalizedName(n,h)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(o=>n(this.normalizedNames.get(o),this.headers.get(o)))}}class vL{encodeKey(n){return zk(n)}encodeValue(n){return zk(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const xL=/%(\d[a-f0-9])/gi,wL={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function zk(i){return encodeURIComponent(i).replace(xL,(n,o)=>wL[o]??n)}function vS(i){return`${i}`}class iw{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new vL,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function bL(i,n){const o=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(h=>{const _=h.indexOf("="),[w,S]=-1==_?[n.decodeKey(h),""]:[n.decodeKey(h.slice(0,_)),n.decodeValue(h.slice(_+1))],L=o.get(w)||[];L.push(S),o.set(w,L)}),o}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(o=>{const a=n.fromObject[o],h=Array.isArray(a)?a.map(vS):[vS(a)];this.map.set(o,h)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const o=this.map.get(n);return o?o[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,o){return this.clone({param:n,value:o,op:"a"})}appendAll(n){const o=[];return Object.keys(n).forEach(a=>{const h=n[a];Array.isArray(h)?h.forEach(_=>{o.push({param:a,value:_,op:"a"})}):o.push({param:a,value:h,op:"a"})}),this.clone(o)}set(n,o){return this.clone({param:n,value:o,op:"s"})}delete(n,o){return this.clone({param:n,value:o,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const o=this.encoder.encodeKey(n);return this.map.get(n).map(a=>o+"="+this.encoder.encodeValue(a)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const o=new iw({encoder:this.encoder});return o.cloneFrom=this.cloneFrom||this,o.updates=(this.updates||[]).concat(n),o}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const o=("a"===n.op?this.map.get(n.param):void 0)||[];o.push(vS(n.value)),this.map.set(n.param,o);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let a=this.map.get(n.param)||[];const h=a.indexOf(vS(n.value));-1!==h&&a.splice(h,1),a.length>0?this.map.set(n.param,a):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class CL{constructor(){this.map=new Map}set(n,o){return this.map.set(n,o),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function Bk(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function Uk(i){return typeof Blob<"u"&&i instanceof Blob}function Vk(i){return typeof FormData<"u"&&i instanceof FormData}class J2{constructor(n,o,a,h){let _;if(this.url=o,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function ML(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||h?(this.body=void 0!==a?a:null,_=h):_=a,_&&(this.reportProgress=!!_.reportProgress,this.withCredentials=!!_.withCredentials,_.responseType&&(this.responseType=_.responseType),_.headers&&(this.headers=_.headers),_.context&&(this.context=_.context),_.params&&(this.params=_.params)),this.headers||(this.headers=new Fy),this.context||(this.context=new CL),this.params){const w=this.params.toString();if(0===w.length)this.urlWithParams=o;else{const S=o.indexOf("?");this.urlWithParams=o+(-1===S?"?":S<o.length-1?"&":"")+w}}else this.params=new iw,this.urlWithParams=o}serializeBody(){return null===this.body?null:Bk(this.body)||Uk(this.body)||Vk(this.body)||function PL(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof iw?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Vk(this.body)?null:Uk(this.body)?this.body.type||null:Bk(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof iw?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const o=n.method||this.method,a=n.url||this.url,h=n.responseType||this.responseType,_=void 0!==n.body?n.body:this.body,w=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,S=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let L=n.headers||this.headers,B=n.params||this.params;const H=n.context??this.context;return void 0!==n.setHeaders&&(L=Object.keys(n.setHeaders).reduce((Y,pt)=>Y.set(pt,n.setHeaders[pt]),L)),n.setParams&&(B=Object.keys(n.setParams).reduce((Y,pt)=>Y.set(pt,n.setParams[pt]),B)),new J2(o,a,_,{params:B,headers:L,context:H,reportProgress:S,responseType:h,withCredentials:w})}}var XE=function(i){return i[i.Sent=0]="Sent",i[i.UploadProgress=1]="UploadProgress",i[i.ResponseHeader=2]="ResponseHeader",i[i.DownloadProgress=3]="DownloadProgress",i[i.Response=4]="Response",i[i.User=5]="User",i}(XE||{});class RA{constructor(n,o=200,a="OK"){this.headers=n.headers||new Fy,this.status=void 0!==n.status?n.status:o,this.statusText=n.statusText||a,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class LA extends RA{constructor(n={}){super(n),this.type=XE.ResponseHeader}clone(n={}){return new LA({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class QE extends RA{constructor(n={}){super(n),this.type=XE.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new QE({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class jk extends RA{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function NA(i,n){return{body:n,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials}}let tI=(()=>{class i{constructor(o){this.handler=o}request(o,a,h={}){let _;if(o instanceof J2)_=o;else{let L,B;L=h.headers instanceof Fy?h.headers:new Fy(h.headers),h.params&&(B=h.params instanceof iw?h.params:new iw({fromObject:h.params})),_=new J2(o,a,void 0!==h.body?h.body:null,{headers:L,context:h.context,params:B,reportProgress:h.reportProgress,responseType:h.responseType||"json",withCredentials:h.withCredentials})}const w=(0,Nr.of)(_).pipe(YE(L=>this.handler.handle(L)));if(o instanceof J2||"events"===h.observe)return w;const S=w.pipe(Ny(L=>L instanceof QE));switch(h.observe||"body"){case"body":switch(_.responseType){case"arraybuffer":return S.pipe((0,ln.U)(L=>{if(null!==L.body&&!(L.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return L.body}));case"blob":return S.pipe((0,ln.U)(L=>{if(null!==L.body&&!(L.body instanceof Blob))throw new Error("Response is not a Blob.");return L.body}));case"text":return S.pipe((0,ln.U)(L=>{if(null!==L.body&&"string"!=typeof L.body)throw new Error("Response is not a string.");return L.body}));default:return S.pipe((0,ln.U)(L=>L.body))}case"response":return S;default:throw new Error(`Unreachable: unhandled observe type ${h.observe}}`)}}delete(o,a={}){return this.request("DELETE",o,a)}get(o,a={}){return this.request("GET",o,a)}head(o,a={}){return this.request("HEAD",o,a)}jsonp(o,a){return this.request("JSONP",o,{params:(new iw).append(a,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(o,a={}){return this.request("OPTIONS",o,a)}patch(o,a,h={}){return this.request("PATCH",o,NA(h,a))}post(o,a,h={}){return this.request("POST",o,NA(h,a))}put(o,a,h={}){return this.request("PUT",o,NA(h,a))}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(GM))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();function Hk(i,n){return n(i)}function EL(i,n){return(o,a)=>n.intercept(o,{handle:h=>i(h,a)})}const IL=new x.OlP(""),eI=new x.OlP(""),qk=new x.OlP("");function SL(){let i=null;return(n,o)=>{null===i&&(i=((0,x.f3M)(IL,{optional:!0})??[]).reduceRight(EL,Hk));const a=(0,x.f3M)(x.HDt),h=a.add();return i(n,o).pipe(Q2(()=>a.remove(h)))}}let Zk=(()=>{class i extends GM{constructor(o,a){super(),this.backend=o,this.injector=a,this.chain=null,this.pendingTasks=(0,x.f3M)(x.HDt)}handle(o){if(null===this.chain){const h=Array.from(new Set([...this.injector.get(eI),...this.injector.get(qk,[])]));this.chain=h.reduceRight((_,w)=>function TL(i,n,o){return(a,h)=>o.runInContext(()=>n(a,_=>i(_,h)))}(_,w,this.injector),Hk)}const a=this.pendingTasks.add();return this.chain(o,h=>this.backend.handle(h)).pipe(Q2(()=>this.pendingTasks.remove(a)))}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(yS),x.LFG(x.lqb))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();const RL=/^\)\]\}',?\n/;let Kk=(()=>{class i{constructor(o){this.xhrFactory=o}handle(o){if("JSONP"===o.method)throw new x.vHH(-2800,!1);const a=this.xhrFactory;return(a.\u0275loadImpl?(0,Nt.D)(a.\u0275loadImpl()):(0,Nr.of)(null)).pipe((0,Nl.w)(()=>new $t.y(_=>{const w=a.build();if(w.open(o.method,o.urlWithParams),o.withCredentials&&(w.withCredentials=!0),o.headers.forEach((Ut,Zt)=>w.setRequestHeader(Ut,Zt.join(","))),o.headers.has("Accept")||w.setRequestHeader("Accept","application/json, text/plain, */*"),!o.headers.has("Content-Type")){const Ut=o.detectContentTypeHeader();null!==Ut&&w.setRequestHeader("Content-Type",Ut)}if(o.responseType){const Ut=o.responseType.toLowerCase();w.responseType="json"!==Ut?Ut:"text"}const S=o.serializeBody();let L=null;const B=()=>{if(null!==L)return L;const Ut=w.statusText||"OK",Zt=new Fy(w.getAllResponseHeaders()),qe=function LL(i){return"responseURL"in i&&i.responseURL?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):null}(w)||o.url;return L=new LA({headers:Zt,status:w.status,statusText:Ut,url:qe}),L},H=()=>{let{headers:Ut,status:Zt,statusText:qe,url:fn}=B(),$e=null;204!==Zt&&($e=typeof w.response>"u"?w.responseText:w.response),0===Zt&&(Zt=$e?200:0);let cn=Zt>=200&&Zt<300;if("json"===o.responseType&&"string"==typeof $e){const Mr=$e;$e=$e.replace(RL,"");try{$e=""!==$e?JSON.parse($e):null}catch(Cr){$e=Mr,cn&&(cn=!1,$e={error:Cr,text:$e})}}cn?(_.next(new QE({body:$e,headers:Ut,status:Zt,statusText:qe,url:fn||void 0})),_.complete()):_.error(new jk({error:$e,headers:Ut,status:Zt,statusText:qe,url:fn||void 0}))},Y=Ut=>{const{url:Zt}=B(),qe=new jk({error:Ut,status:w.status||0,statusText:w.statusText||"Unknown Error",url:Zt||void 0});_.error(qe)};let pt=!1;const xt=Ut=>{pt||(_.next(B()),pt=!0);let Zt={type:XE.DownloadProgress,loaded:Ut.loaded};Ut.lengthComputable&&(Zt.total=Ut.total),"text"===o.responseType&&w.responseText&&(Zt.partialText=w.responseText),_.next(Zt)},At=Ut=>{let Zt={type:XE.UploadProgress,loaded:Ut.loaded};Ut.lengthComputable&&(Zt.total=Ut.total),_.next(Zt)};return w.addEventListener("load",H),w.addEventListener("error",Y),w.addEventListener("timeout",Y),w.addEventListener("abort",Y),o.reportProgress&&(w.addEventListener("progress",xt),null!==S&&w.upload&&w.upload.addEventListener("progress",At)),w.send(S),_.next({type:XE.Sent}),()=>{w.removeEventListener("error",Y),w.removeEventListener("abort",Y),w.removeEventListener("load",H),w.removeEventListener("timeout",Y),o.reportProgress&&(w.removeEventListener("progress",xt),null!==S&&w.upload&&w.upload.removeEventListener("progress",At)),w.readyState!==w.DONE&&w.abort()}})))}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(Ga))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();const FA=new x.OlP("XSRF_ENABLED"),Yk=new x.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Xk=new x.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Qk{}let zL=(()=>{class i{constructor(o,a,h){this.doc=o,this.platform=a,this.cookieName=h,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const o=this.doc.cookie||"";return o!==this.lastCookieString&&(this.parseCount++,this.lastToken=gl(o,this.cookieName),this.lastCookieString=o),this.lastToken}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(ye),x.LFG(x.Lbi),x.LFG(Yk))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();function BL(i,n){const o=i.url.toLowerCase();if(!(0,x.f3M)(FA)||"GET"===i.method||"HEAD"===i.method||o.startsWith("http://")||o.startsWith("https://"))return n(i);const a=(0,x.f3M)(Qk).getToken(),h=(0,x.f3M)(Xk);return null!=a&&!i.headers.has(h)&&(i=i.clone({headers:i.headers.set(h,a)})),n(i)}var sw=function(i){return i[i.Interceptors=0]="Interceptors",i[i.LegacyInterceptors=1]="LegacyInterceptors",i[i.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",i[i.NoXsrfProtection=3]="NoXsrfProtection",i[i.JsonpSupport=4]="JsonpSupport",i[i.RequestsMadeViaParent=5]="RequestsMadeViaParent",i[i.Fetch=6]="Fetch",i}(sw||{});function UL(...i){const n=[tI,Kk,Zk,{provide:GM,useExisting:Zk},{provide:yS,useExisting:Kk},{provide:eI,useValue:BL,multi:!0},{provide:FA,useValue:!0},{provide:Qk,useClass:zL}];for(const o of i)n.push(...o.\u0275providers);return(0,x.MR2)(n)}const Jk=new x.OlP("LEGACY_INTERCEPTOR_FN");function VL(){return function HM(i,n){return{\u0275kind:i,\u0275providers:n}}(sw.LegacyInterceptors,[{provide:Jk,useFactory:SL},{provide:eI,useExisting:Jk,multi:!0}])}let jL=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=x.oAB({type:i});static#n=this.\u0275inj=x.cJS({providers:[UL(VL())]})}return i})();var Lm=ft(5619),xS=ft(2737),KL=ft(7103);function zA(...i){const n=(0,Qe.yG)(i),o=(0,Qe.jO)(i),{args:a,keys:h}=Be(i);if(0===a.length)return(0,Nt.D)([],n);const _=new $t.y(function YL(i,n,o=xS.y){return a=>{t3(n,()=>{const{length:h}=i,_=new Array(h);let w=h,S=h;for(let L=0;L<h;L++)t3(n,()=>{const B=(0,Nt.D)(i[L],n);let H=!1;B.subscribe((0,nr.x)(a,Y=>{_[L]=Y,H||(H=!0,S--),S||a.next(o(_.slice()))},()=>{--w||a.complete()}))},a)},a)}}(a,n,h?w=>wr(h,w):xS.y));return o?_.pipe(mn(o)):_}function t3(i,n,o){i?(0,KL.f)(o,i,n):n()}const wS=(0,ft(2306).d)(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});var nI=ft(7537);function BA(...i){return function QL(){return(0,nI.J)(1)}()((0,Nt.D)(i,(0,Qe.yG)(i)))}function e3(i){return new $t.y(n=>{(0,On.Xf)(i()).subscribe(n)})}var JL=ft(8407);function rI(i,n){const o=(0,X2.m)(i)?i:()=>i,a=h=>h.error(o());return new $t.y(n?h=>n.schedule(a,0,h):a)}var aw=ft(6232),UA=ft(7394);function VA(){return(0,ig.e)((i,n)=>{let o=null;i._refCount++;const a=(0,nr.x)(n,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(o=null);const h=i._connection,_=o;o=null,h&&(!_||h===_)&&h.unsubscribe(),n.unsubscribe()});i.subscribe(a),a.closed||(o=i.connect())})}class n3 extends $t.y{constructor(n,o){super(),this.source=n,this.subjectFactory=o,this._subject=null,this._refCount=0,this._connection=null,(0,ig.A)(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new UA.w0;const o=this.getSubject();n.add(this.source.subscribe((0,nr.x)(o,void 0,()=>{this._teardown(),o.complete()},a=>{this._teardown(),o.error(a)},()=>this._teardown()))),n.closed&&(this._connection=null,n=UA.w0.EMPTY)}return n}refCount(){return VA()(this)}}var zy=ft(8645);function JE(i){return i<=0?()=>aw.E:(0,ig.e)((n,o)=>{let a=0;n.subscribe((0,nr.x)(o,h=>{++a<=i&&(o.next(h),i<=a&&o.complete())}))})}function CS(i){return(0,ig.e)((n,o)=>{let a=!1;n.subscribe((0,nr.x)(o,h=>{a=!0,o.next(h)},()=>{a||o.next(i),o.complete()}))})}function r3(i=eN){return(0,ig.e)((n,o)=>{let a=!1;n.subscribe((0,nr.x)(o,h=>{a=!0,o.next(h)},()=>a?o.complete():o.error(i())))})}function eN(){return new wS}function lw(i,n){const o=arguments.length>=2;return a=>a.pipe(i?Ny((h,_)=>i(h,_,a)):xS.y,JE(1),o?CS(n):r3(()=>new wS))}var nu=ft(9397);function qM(i){return(0,ig.e)((n,o)=>{let _,a=null,h=!1;a=n.subscribe((0,nr.x)(o,void 0,void 0,w=>{_=(0,On.Xf)(i(w,qM(i)(n))),a?(a.unsubscribe(),a=null,_.subscribe(o)):h=!0})),h&&(a.unsubscribe(),a=null,_.subscribe(o))})}function jA(i){return i<=0?()=>aw.E:(0,ig.e)((n,o)=>{let a=[];n.subscribe((0,nr.x)(o,h=>{a.push(h),i<a.length&&a.shift()},()=>{for(const h of a)o.next(h);o.complete()},void 0,()=>{a=null}))})}var sN=ft(2420);const ho="primary",oI=Symbol("RouteTitle");class lN{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const o=this.params[n];return Array.isArray(o)?o[0]:o}return null}getAll(n){if(this.has(n)){const o=this.params[n];return Array.isArray(o)?o:[o]}return[]}get keys(){return Object.keys(this.params)}}function tT(i){return new lN(i)}function cN(i,n,o){const a=o.path.split("/");if(a.length>i.length||"full"===o.pathMatch&&(n.hasChildren()||a.length<i.length))return null;const h={};for(let _=0;_<a.length;_++){const w=a[_],S=i[_];if(w.startsWith(":"))h[w.substring(1)]=S;else if(w!==S.path)return null}return{consumed:i.slice(0,a.length),posParams:h}}function By(i,n){const o=i?Object.keys(i):void 0,a=n?Object.keys(n):void 0;if(!o||!a||o.length!=a.length)return!1;let h;for(let _=0;_<o.length;_++)if(h=o[_],!o3(i[h],n[h]))return!1;return!0}function o3(i,n){if(Array.isArray(i)&&Array.isArray(n)){if(i.length!==n.length)return!1;const o=[...i].sort(),a=[...n].sort();return o.every((h,_)=>a[_]===h)}return i===n}function i3(i){return i.length>0?i[i.length-1]:null}function cw(i){return function WL(i){return!!i&&(i instanceof $t.y||(0,X2.m)(i.lift)&&(0,X2.m)(i.subscribe))}(i)?i:(0,x.QGY)(i)?(0,Nt.D)(Promise.resolve(i)):(0,Nr.of)(i)}const dN={exact:function l3(i,n,o){if(!ZM(i.segments,n.segments)||!MS(i.segments,n.segments,o)||i.numberOfChildren!==n.numberOfChildren)return!1;for(const a in n.children)if(!i.children[a]||!l3(i.children[a],n.children[a],o))return!1;return!0},subset:c3},s3={exact:function hN(i,n){return By(i,n)},subset:function fN(i,n){return Object.keys(n).length<=Object.keys(i).length&&Object.keys(n).every(o=>o3(i[o],n[o]))},ignored:()=>!0};function a3(i,n,o){return dN[o.paths](i.root,n.root,o.matrixParams)&&s3[o.queryParams](i.queryParams,n.queryParams)&&!("exact"===o.fragment&&i.fragment!==n.fragment)}function c3(i,n,o){return u3(i,n,n.segments,o)}function u3(i,n,o,a){if(i.segments.length>o.length){const h=i.segments.slice(0,o.length);return!(!ZM(h,o)||n.hasChildren()||!MS(h,o,a))}if(i.segments.length===o.length){if(!ZM(i.segments,o)||!MS(i.segments,o,a))return!1;for(const h in n.children)if(!i.children[h]||!c3(i.children[h],n.children[h],a))return!1;return!0}{const h=o.slice(0,i.segments.length),_=o.slice(i.segments.length);return!!(ZM(i.segments,h)&&MS(i.segments,h,a)&&i.children[ho])&&u3(i.children[ho],n,_,a)}}function MS(i,n,o){return n.every((a,h)=>s3[o](i[h].parameters,a.parameters))}class eT{constructor(n=new Ai([],{}),o={},a=null){this.root=n,this.queryParams=o,this.fragment=a}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=tT(this.queryParams)),this._queryParamMap}toString(){return mN.serialize(this)}}class Ai{constructor(n,o){this.segments=n,this.children=o,this.parent=null,Object.values(o).forEach(a=>a.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return PS(this)}}class iI{constructor(n,o){this.path=n,this.parameters=o}get parameterMap(){return this._parameterMap||(this._parameterMap=tT(this.parameters)),this._parameterMap}toString(){return f3(this)}}function ZM(i,n){return i.length===n.length&&i.every((o,a)=>o.path===n[a].path)}let sI=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:function(){return new $A},providedIn:"root"})}return i})();class $A{parse(n){const o=new EN(n);return new eT(o.parseRootSegment(),o.parseQueryParams(),o.parseFragment())}serialize(n){const o=`/${aI(n.root,!0)}`,a=function vN(i){const n=Object.keys(i).map(o=>{const a=i[o];return Array.isArray(a)?a.map(h=>`${OS(o)}=${OS(h)}`).join("&"):`${OS(o)}=${OS(a)}`}).filter(o=>!!o);return n.length?`?${n.join("&")}`:""}(n.queryParams),h="string"==typeof n.fragment?`#${function _N(i){return encodeURI(i)}(n.fragment)}`:"";return`${o}${a}${h}`}}const mN=new $A;function PS(i){return i.segments.map(n=>f3(n)).join("/")}function aI(i,n){if(!i.hasChildren())return PS(i);if(n){const o=i.children[ho]?aI(i.children[ho],!1):"",a=[];return Object.entries(i.children).forEach(([h,_])=>{h!==ho&&a.push(`${h}:${aI(_,!1)}`)}),a.length>0?`${o}(${a.join("//")})`:o}{const o=function gN(i,n){let o=[];return Object.entries(i.children).forEach(([a,h])=>{a===ho&&(o=o.concat(n(h,a)))}),Object.entries(i.children).forEach(([a,h])=>{a!==ho&&(o=o.concat(n(h,a)))}),o}(i,(a,h)=>h===ho?[aI(i.children[ho],!1)]:[`${h}:${aI(a,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[ho]?`${PS(i)}/${o[0]}`:`${PS(i)}/(${o.join("//")})`}}function d3(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function OS(i){return d3(i).replace(/%3B/gi,";")}function GA(i){return d3(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ES(i){return decodeURIComponent(i)}function h3(i){return ES(i.replace(/\+/g,"%20"))}function f3(i){return`${GA(i.path)}${function yN(i){return Object.keys(i).map(n=>`;${GA(n)}=${GA(i[n])}`).join("")}(i.parameters)}`}const bN=/^[^\/()?;#]+/;function HA(i){const n=i.match(bN);return n?n[0]:""}const xN=/^[^\/()?;=#]+/,CN=/^[^=?&#]+/,PN=/^[^&#]+/;class EN{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ai([],{}):new Ai([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let o={};this.peekStartsWith("/(")&&(this.capture("/"),o=this.parseParens(!0));let a={};return this.peekStartsWith("(")&&(a=this.parseParens(!1)),(n.length>0||Object.keys(o).length>0)&&(a[ho]=new Ai(n,o)),a}parseSegment(){const n=HA(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new x.vHH(4009,!1);return this.capture(n),new iI(ES(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const o=function wN(i){const n=i.match(xN);return n?n[0]:""}(this.remaining);if(!o)return;this.capture(o);let a="";if(this.consumeOptional("=")){const h=HA(this.remaining);h&&(a=h,this.capture(a))}n[ES(o)]=ES(a)}parseQueryParam(n){const o=function MN(i){const n=i.match(CN);return n?n[0]:""}(this.remaining);if(!o)return;this.capture(o);let a="";if(this.consumeOptional("=")){const w=function ON(i){const n=i.match(PN);return n?n[0]:""}(this.remaining);w&&(a=w,this.capture(a))}const h=h3(o),_=h3(a);if(n.hasOwnProperty(h)){let w=n[h];Array.isArray(w)||(w=[w],n[h]=w),w.push(_)}else n[h]=_}parseParens(n){const o={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const a=HA(this.remaining),h=this.remaining[a.length];if("/"!==h&&")"!==h&&";"!==h)throw new x.vHH(4010,!1);let _;a.indexOf(":")>-1?(_=a.slice(0,a.indexOf(":")),this.capture(_),this.capture(":")):n&&(_=ho);const w=this.parseChildren();o[_]=1===Object.keys(w).length?w[ho]:new Ai([],w),this.consumeOptional("//")}return o}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new x.vHH(4011,!1)}}function p3(i){return i.segments.length>0?new Ai([],{[ho]:i}):i}function g3(i){const n={};for(const a of Object.keys(i.children)){const _=g3(i.children[a]);if(a===ho&&0===_.segments.length&&_.hasChildren())for(const[w,S]of Object.entries(_.children))n[w]=S;else(_.segments.length>0||_.hasChildren())&&(n[a]=_)}return function TN(i){if(1===i.numberOfChildren&&i.children[ho]){const n=i.children[ho];return new Ai(i.segments.concat(n.segments),n.children)}return i}(new Ai(i.segments,n))}function WM(i){return i instanceof eT}function m3(i){let n;const h=p3(function o(_){const w={};for(const L of _.children){const B=o(L);w[L.outlet]=B}const S=new Ai(_.url,w);return _===i&&(n=S),S}(i.root));return n??h}function _3(i,n,o,a){let h=i;for(;h.parent;)h=h.parent;if(0===n.length)return qA(h,h,h,o,a);const _=function SN(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new v3(!0,0,i);let n=0,o=!1;const a=i.reduce((h,_,w)=>{if("object"==typeof _&&null!=_){if(_.outlets){const S={};return Object.entries(_.outlets).forEach(([L,B])=>{S[L]="string"==typeof B?B.split("/"):B}),[...h,{outlets:S}]}if(_.segmentPath)return[...h,_.segmentPath]}return"string"!=typeof _?[...h,_]:0===w?(_.split("/").forEach((S,L)=>{0==L&&"."===S||(0==L&&""===S?o=!0:".."===S?n++:""!=S&&h.push(S))}),h):[...h,_]},[]);return new v3(o,n,a)}(n);if(_.toRoot())return qA(h,h,new Ai([],{}),o,a);const w=function AN(i,n,o){if(i.isAbsolute)return new IS(n,!0,0);if(!o)return new IS(n,!1,NaN);if(null===o.parent)return new IS(o,!0,0);const a=TS(i.commands[0])?0:1;return function DN(i,n,o){let a=i,h=n,_=o;for(;_>h;){if(_-=h,a=a.parent,!a)throw new x.vHH(4005,!1);h=a.segments.length}return new IS(a,!1,h-_)}(o,o.segments.length-1+a,i.numberOfDoubleDots)}(_,h,i),S=w.processChildren?cI(w.segmentGroup,w.index,_.commands):b3(w.segmentGroup,w.index,_.commands);return qA(h,w.segmentGroup,S,o,a)}function TS(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function lI(i){return"object"==typeof i&&null!=i&&i.outlets}function qA(i,n,o,a,h){let w,_={};a&&Object.entries(a).forEach(([L,B])=>{_[L]=Array.isArray(B)?B.map(H=>`${H}`):`${B}`}),w=i===n?o:y3(i,n,o);const S=p3(g3(w));return new eT(S,_,h)}function y3(i,n,o){const a={};return Object.entries(i.children).forEach(([h,_])=>{a[h]=_===n?o:y3(_,n,o)}),new Ai(i.segments,a)}class v3{constructor(n,o,a){if(this.isAbsolute=n,this.numberOfDoubleDots=o,this.commands=a,n&&a.length>0&&TS(a[0]))throw new x.vHH(4003,!1);const h=a.find(lI);if(h&&h!==i3(a))throw new x.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class IS{constructor(n,o,a){this.segmentGroup=n,this.processChildren=o,this.index=a}}function b3(i,n,o){if(i||(i=new Ai([],{})),0===i.segments.length&&i.hasChildren())return cI(i,n,o);const a=function RN(i,n,o){let a=0,h=n;const _={match:!1,pathIndex:0,commandIndex:0};for(;h<i.segments.length;){if(a>=o.length)return _;const w=i.segments[h],S=o[a];if(lI(S))break;const L=`${S}`,B=a<o.length-1?o[a+1]:null;if(h>0&&void 0===L)break;if(L&&B&&"object"==typeof B&&void 0===B.outlets){if(!w3(L,B,w))return _;a+=2}else{if(!w3(L,{},w))return _;a++}h++}return{match:!0,pathIndex:h,commandIndex:a}}(i,n,o),h=o.slice(a.commandIndex);if(a.match&&a.pathIndex<i.segments.length){const _=new Ai(i.segments.slice(0,a.pathIndex),{});return _.children[ho]=new Ai(i.segments.slice(a.pathIndex),i.children),cI(_,0,h)}return a.match&&0===h.length?new Ai(i.segments,{}):a.match&&!i.hasChildren()?ZA(i,n,o):a.match?cI(i,0,h):ZA(i,n,o)}function cI(i,n,o){if(0===o.length)return new Ai(i.segments,{});{const a=function kN(i){return lI(i[0])?i[0].outlets:{[ho]:i}}(o),h={};if(Object.keys(a).some(_=>_!==ho)&&i.children[ho]&&1===i.numberOfChildren&&0===i.children[ho].segments.length){const _=cI(i.children[ho],n,o);return new Ai(i.segments,_.children)}return Object.entries(a).forEach(([_,w])=>{"string"==typeof w&&(w=[w]),null!==w&&(h[_]=b3(i.children[_],n,w))}),Object.entries(i.children).forEach(([_,w])=>{void 0===a[_]&&(h[_]=w)}),new Ai(i.segments,h)}}function ZA(i,n,o){const a=i.segments.slice(0,n);let h=0;for(;h<o.length;){const _=o[h];if(lI(_)){const L=LN(_.outlets);return new Ai(a,L)}if(0===h&&TS(o[0])){a.push(new iI(i.segments[n].path,x3(o[0]))),h++;continue}const w=lI(_)?_.outlets[ho]:`${_}`,S=h<o.length-1?o[h+1]:null;w&&S&&TS(S)?(a.push(new iI(w,x3(S))),h+=2):(a.push(new iI(w,{})),h++)}return new Ai(a,{})}function LN(i){const n={};return Object.entries(i).forEach(([o,a])=>{"string"==typeof a&&(a=[a]),null!==a&&(n[o]=ZA(new Ai([],{}),0,a))}),n}function x3(i){const n={};return Object.entries(i).forEach(([o,a])=>n[o]=`${a}`),n}function w3(i,n,o){return i==o.path&&By(n,o.parameters)}const uI="imperative";class Uy{constructor(n,o){this.id=n,this.url=o}}class SS extends Uy{constructor(n,o,a="imperative",h=null){super(n,o),this.type=0,this.navigationTrigger=a,this.restoredState=h}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class uw extends Uy{constructor(n,o,a){super(n,o),this.urlAfterRedirects=a,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class dI extends Uy{constructor(n,o,a,h){super(n,o),this.reason=a,this.code=h,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class nT extends Uy{constructor(n,o,a,h){super(n,o),this.reason=a,this.code=h,this.type=16}}class AS extends Uy{constructor(n,o,a,h){super(n,o),this.error=a,this.target=h,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class C3 extends Uy{constructor(n,o,a,h){super(n,o),this.urlAfterRedirects=a,this.state=h,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class NN extends Uy{constructor(n,o,a,h){super(n,o),this.urlAfterRedirects=a,this.state=h,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class FN extends Uy{constructor(n,o,a,h,_){super(n,o),this.urlAfterRedirects=a,this.state=h,this.shouldActivate=_,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class zN extends Uy{constructor(n,o,a,h){super(n,o),this.urlAfterRedirects=a,this.state=h,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class BN extends Uy{constructor(n,o,a,h){super(n,o),this.urlAfterRedirects=a,this.state=h,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class UN{constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class VN{constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class jN{constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $N{constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class GN{constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class HN{constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class M3{constructor(n,o,a){this.routerEvent=n,this.position=o,this.anchor=a,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class WA{}class KA{constructor(n){this.url=n}}class qN{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new hI,this.attachRef=null}}let hI=(()=>{class i{constructor(){this.contexts=new Map}onChildOutletCreated(o,a){const h=this.getOrCreateContext(o);h.outlet=a,this.contexts.set(o,h)}onChildOutletDestroyed(o){const a=this.getContext(o);a&&(a.outlet=null,a.attachRef=null)}onOutletDeactivated(){const o=this.contexts;return this.contexts=new Map,o}onOutletReAttached(o){this.contexts=o}getOrCreateContext(o){let a=this.getContext(o);return a||(a=new qN,this.contexts.set(o,a)),a}getContext(o){return this.contexts.get(o)||null}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();class P3{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const o=this.pathFromRoot(n);return o.length>1?o[o.length-2]:null}children(n){const o=YA(n,this._root);return o?o.children.map(a=>a.value):[]}firstChild(n){const o=YA(n,this._root);return o&&o.children.length>0?o.children[0].value:null}siblings(n){const o=XA(n,this._root);return o.length<2?[]:o[o.length-2].children.map(h=>h.value).filter(h=>h!==n)}pathFromRoot(n){return XA(n,this._root).map(o=>o.value)}}function YA(i,n){if(i===n.value)return n;for(const o of n.children){const a=YA(i,o);if(a)return a}return null}function XA(i,n){if(i===n.value)return[n];for(const o of n.children){const a=XA(i,o);if(a.length)return a.unshift(n),a}return[]}class ib{constructor(n,o){this.value=n,this.children=o}toString(){return`TreeNode(${this.value})`}}function rT(i){const n={};return i&&i.children.forEach(o=>n[o.value.outlet]=o),n}class O3 extends P3{constructor(n,o){super(n),this.snapshot=o,QA(this,n)}toString(){return this.snapshot.toString()}}function E3(i,n){const o=function ZN(i,n){const w=new DS([],{},{},"",{},ho,n,null,{});return new I3("",new ib(w,[]))}(0,n),a=new Lm.X([new iI("",{})]),h=new Lm.X({}),_=new Lm.X({}),w=new Lm.X({}),S=new Lm.X(""),L=new oT(a,h,w,S,_,ho,n,o.root);return L.snapshot=o.root,new O3(new ib(L,[]),o)}class oT{constructor(n,o,a,h,_,w,S,L){this.urlSubject=n,this.paramsSubject=o,this.queryParamsSubject=a,this.fragmentSubject=h,this.dataSubject=_,this.outlet=w,this.component=S,this._futureSnapshot=L,this.title=this.dataSubject?.pipe((0,ln.U)(B=>B[oI]))??(0,Nr.of)(void 0),this.url=n,this.params=o,this.queryParams=a,this.fragment=h,this.data=_}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,ln.U)(n=>tT(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,ln.U)(n=>tT(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function T3(i,n="emptyOnly"){const o=i.pathFromRoot;let a=0;if("always"!==n)for(a=o.length-1;a>=1;){const h=o[a],_=o[a-1];if(h.routeConfig&&""===h.routeConfig.path)a--;else{if(_.component)break;a--}}return function WN(i){return i.reduce((n,o)=>({params:{...n.params,...o.params},data:{...n.data,...o.data},resolve:{...o.data,...n.resolve,...o.routeConfig?.data,...o._resolvedData}}),{params:{},data:{},resolve:{}})}(o.slice(a))}class DS{get title(){return this.data?.[oI]}constructor(n,o,a,h,_,w,S,L,B){this.url=n,this.params=o,this.queryParams=a,this.fragment=h,this.data=_,this.outlet=w,this.component=S,this.routeConfig=L,this._resolve=B}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=tT(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=tT(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(a=>a.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class I3 extends P3{constructor(n,o){super(o),this.url=n,QA(this,o)}toString(){return S3(this._root)}}function QA(i,n){n.value._routerState=i,n.children.forEach(o=>QA(i,o))}function S3(i){const n=i.children.length>0?` { ${i.children.map(S3).join(", ")} } `:"";return`${i.value}${n}`}function JA(i){if(i.snapshot){const n=i.snapshot,o=i._futureSnapshot;i.snapshot=o,By(n.queryParams,o.queryParams)||i.queryParamsSubject.next(o.queryParams),n.fragment!==o.fragment&&i.fragmentSubject.next(o.fragment),By(n.params,o.params)||i.paramsSubject.next(o.params),function uN(i,n){if(i.length!==n.length)return!1;for(let o=0;o<i.length;++o)if(!By(i[o],n[o]))return!1;return!0}(n.url,o.url)||i.urlSubject.next(o.url),By(n.data,o.data)||i.dataSubject.next(o.data)}else i.snapshot=i._futureSnapshot,i.dataSubject.next(i._futureSnapshot.data)}function tD(i,n){const o=By(i.params,n.params)&&function pN(i,n){return ZM(i,n)&&i.every((o,a)=>By(o.parameters,n[a].parameters))}(i.url,n.url);return o&&!(!i.parent!=!n.parent)&&(!i.parent||tD(i.parent,n.parent))}let eD=(()=>{class i{constructor(){this.activated=null,this._activatedRoute=null,this.name=ho,this.activateEvents=new x.vpe,this.deactivateEvents=new x.vpe,this.attachEvents=new x.vpe,this.detachEvents=new x.vpe,this.parentContexts=(0,x.f3M)(hI),this.location=(0,x.f3M)(x.s_b),this.changeDetector=(0,x.f3M)(x.sBO),this.environmentInjector=(0,x.f3M)(x.lqb),this.inputBinder=(0,x.f3M)(kS,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(o){if(o.name){const{firstChange:a,previousValue:h}=o.name;if(a)return;this.isTrackedInParentContexts(h)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(h)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(o){return this.parentContexts.getContext(o)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const o=this.parentContexts.getContext(this.name);o?.route&&(o.attachRef?this.attach(o.attachRef,o.route):this.activateWith(o.route,o.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new x.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new x.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new x.vHH(4012,!1);this.location.detach();const o=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(o.instance),o}attach(o,a){this.activated=o,this._activatedRoute=a,this.location.insert(o.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(o.instance)}deactivate(){if(this.activated){const o=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(o)}}activateWith(o,a){if(this.isActivated)throw new x.vHH(4013,!1);this._activatedRoute=o;const h=this.location,w=o.snapshot.component,S=this.parentContexts.getOrCreateContext(this.name).children,L=new KN(o,S,h.injector);this.activated=h.createComponent(w,{index:h.length,injector:L,environmentInjector:a??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[x.TTD]})}return i})();class KN{constructor(n,o,a){this.route=n,this.childContexts=o,this.parent=a}get(n,o){return n===oT?this.route:n===hI?this.childContexts:this.parent.get(n,o)}}const kS=new x.OlP("");let A3=(()=>{class i{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(o){this.unsubscribeFromRouteData(o),this.subscribeToRouteData(o)}unsubscribeFromRouteData(o){this.outletDataSubscriptions.get(o)?.unsubscribe(),this.outletDataSubscriptions.delete(o)}subscribeToRouteData(o){const{activatedRoute:a}=o,h=zA([a.queryParams,a.params,a.data]).pipe((0,Nl.w)(([_,w,S],L)=>(S={..._,...w,...S},0===L?(0,Nr.of)(S):Promise.resolve(S)))).subscribe(_=>{if(!o.isActivated||!o.activatedComponentRef||o.activatedRoute!==a||null===a.component)return void this.unsubscribeFromRouteData(o);const w=(0,x.qFp)(a.component);if(w)for(const{templateName:S}of w.inputs)o.activatedComponentRef.setInput(S,_[S]);else this.unsubscribeFromRouteData(o)});this.outletDataSubscriptions.set(o,h)}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();function fI(i,n,o){if(o&&i.shouldReuseRoute(n.value,o.value.snapshot)){const a=o.value;a._futureSnapshot=n.value;const h=function XN(i,n,o){return n.children.map(a=>{for(const h of o.children)if(i.shouldReuseRoute(a.value,h.value.snapshot))return fI(i,a,h);return fI(i,a)})}(i,n,o);return new ib(a,h)}{if(i.shouldAttach(n.value)){const _=i.retrieve(n.value);if(null!==_){const w=_.route;return w.value._futureSnapshot=n.value,w.children=n.children.map(S=>fI(i,S)),w}}const a=function QN(i){return new oT(new Lm.X(i.url),new Lm.X(i.params),new Lm.X(i.queryParams),new Lm.X(i.fragment),new Lm.X(i.data),i.outlet,i.component,i)}(n.value),h=n.children.map(_=>fI(i,_));return new ib(a,h)}}const nD="ngNavigationCancelingError";function D3(i,n){const{redirectTo:o,navigationBehaviorOptions:a}=WM(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,h=k3(!1,0,n);return h.url=o,h.navigationBehaviorOptions=a,h}function k3(i,n,o){const a=new Error("NavigationCancelingError: "+(i||""));return a[nD]=!0,a.cancellationCode=n,o&&(a.url=o),a}function R3(i){return i&&i[nD]}let L3=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["ng-component"]],standalone:!0,features:[x.jDz],decls:1,vars:0,template:function(a,h){1&a&&x._UZ(0,"router-outlet")},dependencies:[eD],encapsulation:2})}return i})();function rD(i){const n=i.children&&i.children.map(rD),o=n?{...i,children:n}:{...i};return!o.component&&!o.loadComponent&&(n||o.loadChildren)&&o.outlet&&o.outlet!==ho&&(o.component=L3),o}function Nm(i){return i.outlet||ho}function pI(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let n=i.parent;n;n=n.parent){const o=n.routeConfig;if(o?._loadedInjector)return o._loadedInjector;if(o?._injector)return o._injector}return null}class sF{constructor(n,o,a,h,_){this.routeReuseStrategy=n,this.futureState=o,this.currState=a,this.forwardEvent=h,this.inputBindingEnabled=_}activate(n){const o=this.futureState._root,a=this.currState?this.currState._root:null;this.deactivateChildRoutes(o,a,n),JA(this.futureState.root),this.activateChildRoutes(o,a,n)}deactivateChildRoutes(n,o,a){const h=rT(o);n.children.forEach(_=>{const w=_.value.outlet;this.deactivateRoutes(_,h[w],a),delete h[w]}),Object.values(h).forEach(_=>{this.deactivateRouteAndItsChildren(_,a)})}deactivateRoutes(n,o,a){const h=n.value,_=o?o.value:null;if(h===_)if(h.component){const w=a.getContext(h.outlet);w&&this.deactivateChildRoutes(n,o,w.children)}else this.deactivateChildRoutes(n,o,a);else _&&this.deactivateRouteAndItsChildren(o,a)}deactivateRouteAndItsChildren(n,o){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,o):this.deactivateRouteAndOutlet(n,o)}detachAndStoreRouteSubtree(n,o){const a=o.getContext(n.value.outlet),h=a&&n.value.component?a.children:o,_=rT(n);for(const w of Object.keys(_))this.deactivateRouteAndItsChildren(_[w],h);if(a&&a.outlet){const w=a.outlet.detach(),S=a.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:w,route:n,contexts:S})}}deactivateRouteAndOutlet(n,o){const a=o.getContext(n.value.outlet),h=a&&n.value.component?a.children:o,_=rT(n);for(const w of Object.keys(_))this.deactivateRouteAndItsChildren(_[w],h);a&&(a.outlet&&(a.outlet.deactivate(),a.children.onOutletDeactivated()),a.attachRef=null,a.route=null)}activateChildRoutes(n,o,a){const h=rT(o);n.children.forEach(_=>{this.activateRoutes(_,h[_.value.outlet],a),this.forwardEvent(new HN(_.value.snapshot))}),n.children.length&&this.forwardEvent(new $N(n.value.snapshot))}activateRoutes(n,o,a){const h=n.value,_=o?o.value:null;if(JA(h),h===_)if(h.component){const w=a.getOrCreateContext(h.outlet);this.activateChildRoutes(n,o,w.children)}else this.activateChildRoutes(n,o,a);else if(h.component){const w=a.getOrCreateContext(h.outlet);if(this.routeReuseStrategy.shouldAttach(h.snapshot)){const S=this.routeReuseStrategy.retrieve(h.snapshot);this.routeReuseStrategy.store(h.snapshot,null),w.children.onOutletReAttached(S.contexts),w.attachRef=S.componentRef,w.route=S.route.value,w.outlet&&w.outlet.attach(S.componentRef,S.route.value),JA(S.route.value),this.activateChildRoutes(n,null,w.children)}else{const S=pI(h.snapshot);w.attachRef=null,w.route=h,w.injector=S,w.outlet&&w.outlet.activateWith(h,w.injector),this.activateChildRoutes(n,null,w.children)}}else this.activateChildRoutes(n,null,a)}}class N3{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class RS{constructor(n,o){this.component=n,this.route=o}}function aF(i,n,o){const a=i._root;return gI(a,n?n._root:null,o,[a.value])}function iT(i,n){const o=Symbol(),a=n.get(i,o);return a===o?"function"!=typeof i||(0,x.Z0I)(i)?n.get(i):i:a}function gI(i,n,o,a,h={canDeactivateChecks:[],canActivateChecks:[]}){const _=rT(n);return i.children.forEach(w=>{(function cF(i,n,o,a,h={canDeactivateChecks:[],canActivateChecks:[]}){const _=i.value,w=n?n.value:null,S=o?o.getContext(i.value.outlet):null;if(w&&_.routeConfig===w.routeConfig){const L=function uF(i,n,o){if("function"==typeof o)return o(i,n);switch(o){case"pathParamsChange":return!ZM(i.url,n.url);case"pathParamsOrQueryParamsChange":return!ZM(i.url,n.url)||!By(i.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!tD(i,n)||!By(i.queryParams,n.queryParams);default:return!tD(i,n)}}(w,_,_.routeConfig.runGuardsAndResolvers);L?h.canActivateChecks.push(new N3(a)):(_.data=w.data,_._resolvedData=w._resolvedData),gI(i,n,_.component?S?S.children:null:o,a,h),L&&S&&S.outlet&&S.outlet.isActivated&&h.canDeactivateChecks.push(new RS(S.outlet.component,w))}else w&&mI(n,S,h),h.canActivateChecks.push(new N3(a)),gI(i,null,_.component?S?S.children:null:o,a,h)})(w,_[w.value.outlet],o,a.concat([w.value]),h),delete _[w.value.outlet]}),Object.entries(_).forEach(([w,S])=>mI(S,o.getContext(w),h)),h}function mI(i,n,o){const a=rT(i),h=i.value;Object.entries(a).forEach(([_,w])=>{mI(w,h.component?n?n.children.getContext(_):null:n,o)}),o.canDeactivateChecks.push(new RS(h.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,h))}function _I(i){return"function"==typeof i}function F3(i){return i instanceof wS||"EmptyError"===i?.name}const LS=Symbol("INITIAL_VALUE");function sT(){return(0,Nl.w)(i=>zA(i.map(n=>n.pipe(JE(1),function tN(...i){const n=(0,Qe.yG)(i);return(0,ig.e)((o,a)=>{(n?BA(i,o,n):BA(i,o)).subscribe(a)})}(LS)))).pipe((0,ln.U)(n=>{for(const o of n)if(!0!==o){if(o===LS)return LS;if(!1===o||o instanceof eT)return o}return!0}),Ny(n=>n!==LS),JE(1)))}function z3(i){return(0,JL.z)((0,nu.b)(n=>{if(WM(n))throw D3(0,n)}),(0,ln.U)(n=>!0===n))}class NS{constructor(n){this.segmentGroup=n||null}}class B3{constructor(n){this.urlTree=n}}function aT(i){return rI(new NS(i))}function U3(i){return rI(new B3(i))}class SF{constructor(n,o){this.urlSerializer=n,this.urlTree=o}noMatchError(n){return new x.vHH(4002,!1)}lineralizeSegments(n,o){let a=[],h=o.root;for(;;){if(a=a.concat(h.segments),0===h.numberOfChildren)return(0,Nr.of)(a);if(h.numberOfChildren>1||!h.children[ho])return rI(new x.vHH(4e3,!1));h=h.children[ho]}}applyRedirectCommands(n,o,a){return this.applyRedirectCreateUrlTree(o,this.urlSerializer.parse(o),n,a)}applyRedirectCreateUrlTree(n,o,a,h){const _=this.createSegmentGroup(n,o.root,a,h);return new eT(_,this.createQueryParams(o.queryParams,this.urlTree.queryParams),o.fragment)}createQueryParams(n,o){const a={};return Object.entries(n).forEach(([h,_])=>{if("string"==typeof _&&_.startsWith(":")){const S=_.substring(1);a[h]=o[S]}else a[h]=_}),a}createSegmentGroup(n,o,a,h){const _=this.createSegments(n,o.segments,a,h);let w={};return Object.entries(o.children).forEach(([S,L])=>{w[S]=this.createSegmentGroup(n,L,a,h)}),new Ai(_,w)}createSegments(n,o,a,h){return o.map(_=>_.path.startsWith(":")?this.findPosParam(n,_,h):this.findOrReturn(_,a))}findPosParam(n,o,a){const h=a[o.path.substring(1)];if(!h)throw new x.vHH(4001,!1);return h}findOrReturn(n,o){let a=0;for(const h of o){if(h.path===n.path)return o.splice(a),h;a++}return n}}const oD={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function AF(i,n,o,a,h){const _=iD(i,n,o);return _.matched?(a=function tF(i,n){return i.providers&&!i._injector&&(i._injector=(0,x.MMx)(i.providers,n,`Route: ${i.path}`)),i._injector??n}(n,a),function EF(i,n,o,a){const h=n.canMatch;if(!h||0===h.length)return(0,Nr.of)(!0);const _=h.map(w=>{const S=iT(w,i);return cw(function mF(i){return i&&_I(i.canMatch)}(S)?S.canMatch(n,o):i.runInContext(()=>S(n,o)))});return(0,Nr.of)(_).pipe(sT(),z3())}(a,n,o).pipe((0,ln.U)(w=>!0===w?_:{...oD}))):(0,Nr.of)(_)}function iD(i,n,o){if(""===n.path)return"full"===n.pathMatch&&(i.hasChildren()||o.length>0)?{...oD}:{matched:!0,consumedSegments:[],remainingSegments:o,parameters:{},positionalParamSegments:{}};const h=(n.matcher||cN)(o,i,n);if(!h)return{...oD};const _={};Object.entries(h.posParams??{}).forEach(([S,L])=>{_[S]=L.path});const w=h.consumed.length>0?{..._,...h.consumed[h.consumed.length-1].parameters}:_;return{matched:!0,consumedSegments:h.consumed,remainingSegments:o.slice(h.consumed.length),parameters:w,positionalParamSegments:h.posParams??{}}}function V3(i,n,o,a){return o.length>0&&function RF(i,n,o){return o.some(a=>FS(i,n,a)&&Nm(a)!==ho)}(i,o,a)?{segmentGroup:new Ai(n,kF(a,new Ai(o,i.children))),slicedSegments:[]}:0===o.length&&function LF(i,n,o){return o.some(a=>FS(i,n,a))}(i,o,a)?{segmentGroup:new Ai(i.segments,DF(i,0,o,a,i.children)),slicedSegments:o}:{segmentGroup:new Ai(i.segments,i.children),slicedSegments:o}}function DF(i,n,o,a,h){const _={};for(const w of a)if(FS(i,o,w)&&!h[Nm(w)]){const S=new Ai([],{});_[Nm(w)]=S}return{...h,..._}}function kF(i,n){const o={};o[ho]=n;for(const a of i)if(""===a.path&&Nm(a)!==ho){const h=new Ai([],{});o[Nm(a)]=h}return o}function FS(i,n,o){return(!(i.hasChildren()||n.length>0)||"full"!==o.pathMatch)&&""===o.path}class BF{constructor(n,o,a,h,_,w,S){this.injector=n,this.configLoader=o,this.rootComponentType=a,this.config=h,this.urlTree=_,this.paramsInheritanceStrategy=w,this.urlSerializer=S,this.allowRedirects=!0,this.applyRedirects=new SF(this.urlSerializer,this.urlTree)}noMatchError(n){return new x.vHH(4002,!1)}recognize(){const n=V3(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,ho).pipe(qM(o=>{if(o instanceof B3)return this.allowRedirects=!1,this.urlTree=o.urlTree,this.match(o.urlTree);throw o instanceof NS?this.noMatchError(o):o}),(0,ln.U)(o=>{const a=new DS([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},ho,this.rootComponentType,null,{}),h=new ib(a,o),_=new I3("",h),w=function IN(i,n,o=null,a=null){return _3(m3(i),n,o,a)}(a,[],this.urlTree.queryParams,this.urlTree.fragment);return w.queryParams=this.urlTree.queryParams,_.url=this.urlSerializer.serialize(w),this.inheritParamsAndData(_._root),{state:_,tree:w}}))}match(n){return this.processSegmentGroup(this.injector,this.config,n.root,ho).pipe(qM(a=>{throw a instanceof NS?this.noMatchError(a):a}))}inheritParamsAndData(n){const o=n.value,a=T3(o,this.paramsInheritanceStrategy);o.params=Object.freeze(a.params),o.data=Object.freeze(a.data),n.children.forEach(h=>this.inheritParamsAndData(h))}processSegmentGroup(n,o,a,h){return 0===a.segments.length&&a.hasChildren()?this.processChildren(n,o,a):this.processSegment(n,o,a,a.segments,h,!0)}processChildren(n,o,a){const h=[];for(const _ of Object.keys(a.children))"primary"===_?h.unshift(_):h.push(_);return(0,Nt.D)(h).pipe(YE(_=>{const w=a.children[_],S=function oF(i,n){const o=i.filter(a=>Nm(a)===n);return o.push(...i.filter(a=>Nm(a)!==n)),o}(o,_);return this.processSegmentGroup(n,S,w,_)}),function rN(i,n){return(0,ig.e)(function nN(i,n,o,a,h){return(_,w)=>{let S=o,L=n,B=0;_.subscribe((0,nr.x)(w,H=>{const Y=B++;L=S?i(L,H,Y):(S=!0,H),a&&w.next(L)},h&&(()=>{S&&w.next(L),w.complete()})))}}(i,n,arguments.length>=2,!0))}((_,w)=>(_.push(...w),_)),CS(null),function oN(i,n){const o=arguments.length>=2;return a=>a.pipe(i?Ny((h,_)=>i(h,_,a)):xS.y,jA(1),o?CS(n):r3(()=>new wS))}(),(0,ad.z)(_=>{if(null===_)return aT(a);const w=j3(_);return function UF(i){i.sort((n,o)=>n.value.outlet===ho?-1:o.value.outlet===ho?1:n.value.outlet.localeCompare(o.value.outlet))}(w),(0,Nr.of)(w)}))}processSegment(n,o,a,h,_,w){return(0,Nt.D)(o).pipe(YE(S=>this.processSegmentAgainstRoute(S._injector??n,o,S,a,h,_,w).pipe(qM(L=>{if(L instanceof NS)return(0,Nr.of)(null);throw L}))),lw(S=>!!S),qM(S=>{if(F3(S))return function FF(i,n,o){return 0===n.length&&!i.children[o]}(a,h,_)?(0,Nr.of)([]):aT(a);throw S}))}processSegmentAgainstRoute(n,o,a,h,_,w,S){return function NF(i,n,o,a){return!!(Nm(i)===a||a!==ho&&FS(n,o,i))&&("**"===i.path||iD(n,i,o).matched)}(a,h,_,w)?void 0===a.redirectTo?this.matchSegmentAgainstRoute(n,h,a,_,w,S):S&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,h,o,a,_,w):aT(h):aT(h)}expandSegmentAgainstRouteUsingRedirect(n,o,a,h,_,w){return"**"===h.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,a,h,w):this.expandRegularSegmentAgainstRouteUsingRedirect(n,o,a,h,_,w)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,o,a,h){const _=this.applyRedirects.applyRedirectCommands([],a.redirectTo,{});return a.redirectTo.startsWith("/")?U3(_):this.applyRedirects.lineralizeSegments(a,_).pipe((0,ad.z)(w=>{const S=new Ai(w,{});return this.processSegment(n,o,S,w,h,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,o,a,h,_,w){const{matched:S,consumedSegments:L,remainingSegments:B,positionalParamSegments:H}=iD(o,h,_);if(!S)return aT(o);const Y=this.applyRedirects.applyRedirectCommands(L,h.redirectTo,H);return h.redirectTo.startsWith("/")?U3(Y):this.applyRedirects.lineralizeSegments(h,Y).pipe((0,ad.z)(pt=>this.processSegment(n,a,o,pt.concat(B),w,!1)))}matchSegmentAgainstRoute(n,o,a,h,_,w){let S;if("**"===a.path){const L=h.length>0?i3(h).parameters:{},B=new DS(h,L,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,$3(a),Nm(a),a.component??a._loadedComponent??null,a,G3(a));S=(0,Nr.of)({snapshot:B,consumedSegments:[],remainingSegments:[]}),o.children={}}else S=AF(o,a,h,n).pipe((0,ln.U)(({matched:L,consumedSegments:B,remainingSegments:H,parameters:Y})=>L?{snapshot:new DS(B,Y,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,$3(a),Nm(a),a.component??a._loadedComponent??null,a,G3(a)),consumedSegments:B,remainingSegments:H}:null));return S.pipe((0,Nl.w)(L=>null===L?aT(o):this.getChildConfig(n=a._injector??n,a,h).pipe((0,Nl.w)(({routes:B})=>{const H=a._loadedInjector??n,{snapshot:Y,consumedSegments:pt,remainingSegments:xt}=L,{segmentGroup:At,slicedSegments:Ut}=V3(o,pt,xt,B);if(0===Ut.length&&At.hasChildren())return this.processChildren(H,B,At).pipe((0,ln.U)(qe=>null===qe?null:[new ib(Y,qe)]));if(0===B.length&&0===Ut.length)return(0,Nr.of)([new ib(Y,[])]);const Zt=Nm(a)===_;return this.processSegment(H,B,At,Ut,Zt?ho:_,!0).pipe((0,ln.U)(qe=>[new ib(Y,qe)]))}))))}getChildConfig(n,o,a){return o.children?(0,Nr.of)({routes:o.children,injector:n}):o.loadChildren?void 0!==o._loadedRoutes?(0,Nr.of)({routes:o._loadedRoutes,injector:o._loadedInjector}):function OF(i,n,o,a){const h=n.canLoad;if(void 0===h||0===h.length)return(0,Nr.of)(!0);const _=h.map(w=>{const S=iT(w,i);return cw(function hF(i){return i&&_I(i.canLoad)}(S)?S.canLoad(n,o):i.runInContext(()=>S(n,o)))});return(0,Nr.of)(_).pipe(sT(),z3())}(n,o,a).pipe((0,ad.z)(h=>h?this.configLoader.loadChildren(n,o).pipe((0,nu.b)(_=>{o._loadedRoutes=_.routes,o._loadedInjector=_.injector})):function IF(i){return rI(k3(!1,3))}())):(0,Nr.of)({routes:[],injector:n})}}function VF(i){const n=i.value.routeConfig;return n&&""===n.path}function j3(i){const n=[],o=new Set;for(const a of i){if(!VF(a)){n.push(a);continue}const h=n.find(_=>a.value.routeConfig===_.value.routeConfig);void 0!==h?(h.children.push(...a.children),o.add(h)):n.push(a)}for(const a of o){const h=j3(a.children);n.push(new ib(a.value,h))}return n.filter(a=>!o.has(a))}function $3(i){return i.data||{}}function G3(i){return i.resolve||{}}function H3(i){return"string"==typeof i.title||null===i.title}function sD(i){return(0,Nl.w)(n=>{const o=i(n);return o?(0,Nt.D)(o).pipe((0,ln.U)(()=>n)):(0,Nr.of)(n)})}const lT=new x.OlP("ROUTES");let aD=(()=>{class i{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,x.f3M)(x.Sil)}loadComponent(o){if(this.componentLoaders.get(o))return this.componentLoaders.get(o);if(o._loadedComponent)return(0,Nr.of)(o._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(o);const a=cw(o.loadComponent()).pipe((0,ln.U)(q3),(0,nu.b)(_=>{this.onLoadEndListener&&this.onLoadEndListener(o),o._loadedComponent=_}),Q2(()=>{this.componentLoaders.delete(o)})),h=new n3(a,()=>new zy.x).pipe(VA());return this.componentLoaders.set(o,h),h}loadChildren(o,a){if(this.childrenLoaders.get(a))return this.childrenLoaders.get(a);if(a._loadedRoutes)return(0,Nr.of)({routes:a._loadedRoutes,injector:a._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(a);const _=function WF(i,n,o,a){return cw(i.loadChildren()).pipe((0,ln.U)(q3),(0,ad.z)(h=>h instanceof x.YKP||Array.isArray(h)?(0,Nr.of)(h):(0,Nt.D)(n.compileModuleAsync(h))),(0,ln.U)(h=>{a&&a(i);let _,w,S=!1;return Array.isArray(h)?(w=h,!0):(_=h.create(o).injector,w=_.get(lT,[],{optional:!0,self:!0}).flat()),{routes:w.map(rD),injector:_}}))}(a,this.compiler,o,this.onLoadEndListener).pipe(Q2(()=>{this.childrenLoaders.delete(a)})),w=new n3(_,()=>new zy.x).pipe(VA());return this.childrenLoaders.set(a,w),w}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function q3(i){return function KF(i){return i&&"object"==typeof i&&"default"in i}(i)?i.default:i}let zS=(()=>{class i{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new zy.x,this.transitionAbortSubject=new zy.x,this.configLoader=(0,x.f3M)(aD),this.environmentInjector=(0,x.f3M)(x.lqb),this.urlSerializer=(0,x.f3M)(sI),this.rootContexts=(0,x.f3M)(hI),this.inputBindingEnabled=null!==(0,x.f3M)(kS,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,Nr.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=h=>this.events.next(new VN(h)),this.configLoader.onLoadStartListener=h=>this.events.next(new UN(h))}complete(){this.transitions?.complete()}handleNavigationRequest(o){const a=++this.navigationId;this.transitions?.next({...this.transitions.value,...o,id:a})}setupNavigations(o,a,h){return this.transitions=new Lm.X({id:0,currentUrlTree:a,currentRawUrl:a,currentBrowserUrl:a,extractedUrl:o.urlHandlingStrategy.extract(a),urlAfterRedirects:o.urlHandlingStrategy.extract(a),rawUrl:a,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:uI,restoredState:null,currentSnapshot:h.snapshot,targetSnapshot:null,currentRouterState:h,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ny(_=>0!==_.id),(0,ln.U)(_=>({..._,extractedUrl:o.urlHandlingStrategy.extract(_.rawUrl)})),(0,Nl.w)(_=>{this.currentTransition=_;let w=!1,S=!1;return(0,Nr.of)(_).pipe((0,nu.b)(L=>{this.currentNavigation={id:L.id,initialUrl:L.rawUrl,extractedUrl:L.extractedUrl,trigger:L.source,extras:L.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Nl.w)(L=>{const B=L.currentBrowserUrl.toString(),H=!o.navigated||L.extractedUrl.toString()!==B||B!==L.currentUrlTree.toString();if(!H&&"reload"!==(L.extras.onSameUrlNavigation??o.onSameUrlNavigation)){const pt="";return this.events.next(new nT(L.id,this.urlSerializer.serialize(L.rawUrl),pt,0)),L.resolve(null),aw.E}if(o.urlHandlingStrategy.shouldProcessUrl(L.rawUrl))return(0,Nr.of)(L).pipe((0,Nl.w)(pt=>{const xt=this.transitions?.getValue();return this.events.next(new SS(pt.id,this.urlSerializer.serialize(pt.extractedUrl),pt.source,pt.restoredState)),xt!==this.transitions?.getValue()?aw.E:Promise.resolve(pt)}),function jF(i,n,o,a,h,_){return(0,ad.z)(w=>function zF(i,n,o,a,h,_,w="emptyOnly"){return new BF(i,n,o,a,h,w,_).recognize()}(i,n,o,a,w.extractedUrl,h,_).pipe((0,ln.U)(({state:S,tree:L})=>({...w,targetSnapshot:S,urlAfterRedirects:L}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,o.config,this.urlSerializer,o.paramsInheritanceStrategy),(0,nu.b)(pt=>{_.targetSnapshot=pt.targetSnapshot,_.urlAfterRedirects=pt.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:pt.urlAfterRedirects};const xt=new C3(pt.id,this.urlSerializer.serialize(pt.extractedUrl),this.urlSerializer.serialize(pt.urlAfterRedirects),pt.targetSnapshot);this.events.next(xt)}));if(H&&o.urlHandlingStrategy.shouldProcessUrl(L.currentRawUrl)){const{id:pt,extractedUrl:xt,source:At,restoredState:Ut,extras:Zt}=L,qe=new SS(pt,this.urlSerializer.serialize(xt),At,Ut);this.events.next(qe);const fn=E3(0,this.rootComponentType).snapshot;return this.currentTransition=_={...L,targetSnapshot:fn,urlAfterRedirects:xt,extras:{...Zt,skipLocationChange:!1,replaceUrl:!1}},(0,Nr.of)(_)}{const pt="";return this.events.next(new nT(L.id,this.urlSerializer.serialize(L.extractedUrl),pt,1)),L.resolve(null),aw.E}}),(0,nu.b)(L=>{const B=new NN(L.id,this.urlSerializer.serialize(L.extractedUrl),this.urlSerializer.serialize(L.urlAfterRedirects),L.targetSnapshot);this.events.next(B)}),(0,ln.U)(L=>(this.currentTransition=_={...L,guards:aF(L.targetSnapshot,L.currentSnapshot,this.rootContexts)},_)),function yF(i,n){return(0,ad.z)(o=>{const{targetSnapshot:a,currentSnapshot:h,guards:{canActivateChecks:_,canDeactivateChecks:w}}=o;return 0===w.length&&0===_.length?(0,Nr.of)({...o,guardsResult:!0}):function vF(i,n,o,a){return(0,Nt.D)(i).pipe((0,ad.z)(h=>function PF(i,n,o,a,h){const _=n&&n.routeConfig?n.routeConfig.canDeactivate:null;if(!_||0===_.length)return(0,Nr.of)(!0);const w=_.map(S=>{const L=pI(n)??h,B=iT(S,L);return cw(function gF(i){return i&&_I(i.canDeactivate)}(B)?B.canDeactivate(i,n,o,a):L.runInContext(()=>B(i,n,o,a))).pipe(lw())});return(0,Nr.of)(w).pipe(sT())}(h.component,h.route,o,n,a)),lw(h=>!0!==h,!0))}(w,a,h,i).pipe((0,ad.z)(S=>S&&function dF(i){return"boolean"==typeof i}(S)?function bF(i,n,o,a){return(0,Nt.D)(n).pipe(YE(h=>BA(function wF(i,n){return null!==i&&n&&n(new jN(i)),(0,Nr.of)(!0)}(h.route.parent,a),function xF(i,n){return null!==i&&n&&n(new GN(i)),(0,Nr.of)(!0)}(h.route,a),function MF(i,n,o){const a=n[n.length-1],_=n.slice(0,n.length-1).reverse().map(w=>function lF(i){const n=i.routeConfig?i.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:i,guards:n}:null}(w)).filter(w=>null!==w).map(w=>e3(()=>{const S=w.guards.map(L=>{const B=pI(w.node)??o,H=iT(L,B);return cw(function pF(i){return i&&_I(i.canActivateChild)}(H)?H.canActivateChild(a,i):B.runInContext(()=>H(a,i))).pipe(lw())});return(0,Nr.of)(S).pipe(sT())}));return(0,Nr.of)(_).pipe(sT())}(i,h.path,o),function CF(i,n,o){const a=n.routeConfig?n.routeConfig.canActivate:null;if(!a||0===a.length)return(0,Nr.of)(!0);const h=a.map(_=>e3(()=>{const w=pI(n)??o,S=iT(_,w);return cw(function fF(i){return i&&_I(i.canActivate)}(S)?S.canActivate(n,i):w.runInContext(()=>S(n,i))).pipe(lw())}));return(0,Nr.of)(h).pipe(sT())}(i,h.route,o))),lw(h=>!0!==h,!0))}(a,_,i,n):(0,Nr.of)(S)),(0,ln.U)(S=>({...o,guardsResult:S})))})}(this.environmentInjector,L=>this.events.next(L)),(0,nu.b)(L=>{if(_.guardsResult=L.guardsResult,WM(L.guardsResult))throw D3(0,L.guardsResult);const B=new FN(L.id,this.urlSerializer.serialize(L.extractedUrl),this.urlSerializer.serialize(L.urlAfterRedirects),L.targetSnapshot,!!L.guardsResult);this.events.next(B)}),Ny(L=>!!L.guardsResult||(this.cancelNavigationTransition(L,"",3),!1)),sD(L=>{if(L.guards.canActivateChecks.length)return(0,Nr.of)(L).pipe((0,nu.b)(B=>{const H=new zN(B.id,this.urlSerializer.serialize(B.extractedUrl),this.urlSerializer.serialize(B.urlAfterRedirects),B.targetSnapshot);this.events.next(H)}),(0,Nl.w)(B=>{let H=!1;return(0,Nr.of)(B).pipe(function $F(i,n){return(0,ad.z)(o=>{const{targetSnapshot:a,guards:{canActivateChecks:h}}=o;if(!h.length)return(0,Nr.of)(o);let _=0;return(0,Nt.D)(h).pipe(YE(w=>function GF(i,n,o,a){const h=i.routeConfig,_=i._resolve;return void 0!==h?.title&&!H3(h)&&(_[oI]=h.title),function HF(i,n,o,a){const h=function qF(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}(i);if(0===h.length)return(0,Nr.of)({});const _={};return(0,Nt.D)(h).pipe((0,ad.z)(w=>function ZF(i,n,o,a){const h=pI(n)??a,_=iT(i,h);return cw(_.resolve?_.resolve(n,o):h.runInContext(()=>_(n,o)))}(i[w],n,o,a).pipe(lw(),(0,nu.b)(S=>{_[w]=S}))),jA(1),function iN(i){return(0,ln.U)(()=>i)}(_),qM(w=>F3(w)?aw.E:rI(w)))}(_,i,n,a).pipe((0,ln.U)(w=>(i._resolvedData=w,i.data=T3(i,o).resolve,h&&H3(h)&&(i.data[oI]=h.title),null)))}(w.route,a,i,n)),(0,nu.b)(()=>_++),jA(1),(0,ad.z)(w=>_===h.length?(0,Nr.of)(o):aw.E))})}(o.paramsInheritanceStrategy,this.environmentInjector),(0,nu.b)({next:()=>H=!0,complete:()=>{H||this.cancelNavigationTransition(B,"",2)}}))}),(0,nu.b)(B=>{const H=new BN(B.id,this.urlSerializer.serialize(B.extractedUrl),this.urlSerializer.serialize(B.urlAfterRedirects),B.targetSnapshot);this.events.next(H)}))}),sD(L=>{const B=H=>{const Y=[];H.routeConfig?.loadComponent&&!H.routeConfig._loadedComponent&&Y.push(this.configLoader.loadComponent(H.routeConfig).pipe((0,nu.b)(pt=>{H.component=pt}),(0,ln.U)(()=>{})));for(const pt of H.children)Y.push(...B(pt));return Y};return zA(B(L.targetSnapshot.root)).pipe(CS(),JE(1))}),sD(()=>this.afterPreactivation()),(0,ln.U)(L=>{const B=function YN(i,n,o){const a=fI(i,n._root,o?o._root:void 0);return new O3(a,n)}(o.routeReuseStrategy,L.targetSnapshot,L.currentRouterState);return this.currentTransition=_={...L,targetRouterState:B},_}),(0,nu.b)(()=>{this.events.next(new WA)}),((i,n,o,a)=>(0,ln.U)(h=>(new sF(n,h.targetRouterState,h.currentRouterState,o,a).activate(i),h)))(this.rootContexts,o.routeReuseStrategy,L=>this.events.next(L),this.inputBindingEnabled),JE(1),(0,nu.b)({next:L=>{w=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new uw(L.id,this.urlSerializer.serialize(L.extractedUrl),this.urlSerializer.serialize(L.urlAfterRedirects))),o.titleStrategy?.updateTitle(L.targetRouterState.snapshot),L.resolve(!0)},complete:()=>{w=!0}}),function aN(i){return(0,ig.e)((n,o)=>{(0,On.Xf)(i).subscribe((0,nr.x)(o,()=>o.complete(),sN.Z)),!o.closed&&n.subscribe(o)})}(this.transitionAbortSubject.pipe((0,nu.b)(L=>{throw L}))),Q2(()=>{w||S||this.cancelNavigationTransition(_,"",1),this.currentNavigation?.id===_.id&&(this.currentNavigation=null)}),qM(L=>{if(S=!0,R3(L))this.events.next(new dI(_.id,this.urlSerializer.serialize(_.extractedUrl),L.message,L.cancellationCode)),function JN(i){return R3(i)&&WM(i.url)}(L)?this.events.next(new KA(L.url)):_.resolve(!1);else{this.events.next(new AS(_.id,this.urlSerializer.serialize(_.extractedUrl),L,_.targetSnapshot??void 0));try{_.resolve(o.errorHandler(L))}catch(B){_.reject(B)}}return aw.E}))}))}cancelNavigationTransition(o,a,h){const _=new dI(o.id,this.urlSerializer.serialize(o.extractedUrl),a,h);this.events.next(_),o.resolve(!1)}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Z3(i){return i!==uI}let W3=(()=>{class i{buildTitle(o){let a,h=o.root;for(;void 0!==h;)a=this.getResolvedTitleForRoute(h)??a,h=h.children.find(_=>_.outlet===ho);return a}getResolvedTitleForRoute(o){return o.data[oI]}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:function(){return(0,x.f3M)(YF)},providedIn:"root"})}return i})(),YF=(()=>{class i extends W3{constructor(o){super(),this.title=o}updateTitle(o){const a=this.buildTitle(o);void 0!==a&&this.title.setTitle(a)}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(Sc))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),XF=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:function(){return(0,x.f3M)(JF)},providedIn:"root"})}return i})();class QF{shouldDetach(n){return!1}store(n,o){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,o){return n.routeConfig===o.routeConfig}}let JF=(()=>{class i extends QF{static#t=this.\u0275fac=function(){let o;return function(h){return(o||(o=x.n5z(i)))(h||i)}}();static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();const BS=new x.OlP("",{providedIn:"root",factory:()=>({})});let t4=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:function(){return(0,x.f3M)(e4)},providedIn:"root"})}return i})(),e4=(()=>{class i{shouldProcessUrl(o){return!0}extract(o){return o}merge(o,a){return o}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var yI=function(i){return i[i.COMPLETE=0]="COMPLETE",i[i.FAILED=1]="FAILED",i[i.REDIRECTING=2]="REDIRECTING",i}(yI||{});function K3(i,n){i.events.pipe(Ny(o=>o instanceof uw||o instanceof dI||o instanceof AS||o instanceof nT),(0,ln.U)(o=>o instanceof uw||o instanceof nT?yI.COMPLETE:o instanceof dI&&(0===o.code||1===o.code)?yI.REDIRECTING:yI.FAILED),Ny(o=>o!==yI.REDIRECTING),JE(1)).subscribe(()=>{n()})}function n4(i){throw i}function r4(i,n,o){return n.parse("/")}const o4={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},i4={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ru=(()=>{class i{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,x.f3M)(x.c2e),this.isNgZoneEnabled=!1,this._events=new zy.x,this.options=(0,x.f3M)(BS,{optional:!0})||{},this.pendingTasks=(0,x.f3M)(x.HDt),this.errorHandler=this.options.errorHandler||n4,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||r4,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,x.f3M)(t4),this.routeReuseStrategy=(0,x.f3M)(XF),this.titleStrategy=(0,x.f3M)(W3),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,x.f3M)(lT,{optional:!0})?.flat()??[],this.navigationTransitions=(0,x.f3M)(zS),this.urlSerializer=(0,x.f3M)(sI),this.location=(0,x.f3M)(rn),this.componentInputBindingEnabled=!!(0,x.f3M)(kS,{optional:!0}),this.eventsSubscription=new UA.w0,this.isNgZoneEnabled=(0,x.f3M)(x.R0b)instanceof x.R0b&&x.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new eT,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=E3(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(o=>{this.lastSuccessfulId=o.id,this.currentPageId=this.browserPageId},o=>{this.console.warn(`Unhandled Navigation Error: ${o}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const o=this.navigationTransitions.events.subscribe(a=>{try{const{currentTransition:h}=this.navigationTransitions;if(null===h)return void(Y3(a)&&this._events.next(a));if(a instanceof SS)Z3(h.source)&&(this.browserUrlTree=h.extractedUrl);else if(a instanceof nT)this.rawUrlTree=h.rawUrl;else if(a instanceof C3){if("eager"===this.urlUpdateStrategy){if(!h.extras.skipLocationChange){const _=this.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl);this.setBrowserUrl(_,h)}this.browserUrlTree=h.urlAfterRedirects}}else if(a instanceof WA)this.currentUrlTree=h.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(h.urlAfterRedirects,h.rawUrl),this.routerState=h.targetRouterState,"deferred"===this.urlUpdateStrategy&&(h.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,h),this.browserUrlTree=h.urlAfterRedirects);else if(a instanceof dI)0!==a.code&&1!==a.code&&(this.navigated=!0),(3===a.code||2===a.code)&&this.restoreHistory(h);else if(a instanceof KA){const _=this.urlHandlingStrategy.merge(a.url,h.currentRawUrl),w={skipLocationChange:h.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Z3(h.source)};this.scheduleNavigation(_,uI,null,w,{resolve:h.resolve,reject:h.reject,promise:h.promise})}a instanceof AS&&this.restoreHistory(h,!0),a instanceof uw&&(this.navigated=!0),Y3(a)&&this._events.next(a)}catch(h){this.navigationTransitions.transitionAbortSubject.next(h)}});this.eventsSubscription.add(o)}resetRootComponentType(o){this.routerState.root.component=o,this.navigationTransitions.rootComponentType=o}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const o=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),uI,o)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(o=>{const a="popstate"===o.type?"popstate":"hashchange";"popstate"===a&&setTimeout(()=>{this.navigateToSyncWithBrowser(o.url,a,o.state)},0)}))}navigateToSyncWithBrowser(o,a,h){const _={replaceUrl:!0},w=h?.navigationId?h:null;if(h){const L={...h};delete L.navigationId,delete L.\u0275routerPageId,0!==Object.keys(L).length&&(_.state=L)}const S=this.parseUrl(o);this.scheduleNavigation(S,a,w,_)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(o){this.config=o.map(rD),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(o,a={}){const{relativeTo:h,queryParams:_,fragment:w,queryParamsHandling:S,preserveFragment:L}=a,B=L?this.currentUrlTree.fragment:w;let Y,H=null;switch(S){case"merge":H={...this.currentUrlTree.queryParams,..._};break;case"preserve":H=this.currentUrlTree.queryParams;break;default:H=_||null}null!==H&&(H=this.removeEmptyProps(H));try{Y=m3(h?h.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof o[0]||!o[0].startsWith("/"))&&(o=[]),Y=this.currentUrlTree.root}return _3(Y,o,H,B??null)}navigateByUrl(o,a={skipLocationChange:!1}){const h=WM(o)?o:this.parseUrl(o),_=this.urlHandlingStrategy.merge(h,this.rawUrlTree);return this.scheduleNavigation(_,uI,null,a)}navigate(o,a={skipLocationChange:!1}){return function s4(i){for(let n=0;n<i.length;n++)if(null==i[n])throw new x.vHH(4008,!1)}(o),this.navigateByUrl(this.createUrlTree(o,a),a)}serializeUrl(o){return this.urlSerializer.serialize(o)}parseUrl(o){let a;try{a=this.urlSerializer.parse(o)}catch(h){a=this.malformedUriErrorHandler(h,this.urlSerializer,o)}return a}isActive(o,a){let h;if(h=!0===a?{...o4}:!1===a?{...i4}:a,WM(o))return a3(this.currentUrlTree,o,h);const _=this.parseUrl(o);return a3(this.currentUrlTree,_,h)}removeEmptyProps(o){return Object.keys(o).reduce((a,h)=>{const _=o[h];return null!=_&&(a[h]=_),a},{})}scheduleNavigation(o,a,h,_,w){if(this.disposed)return Promise.resolve(!1);let S,L,B;w?(S=w.resolve,L=w.reject,B=w.promise):B=new Promise((Y,pt)=>{S=Y,L=pt});const H=this.pendingTasks.add();return K3(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(H))}),this.navigationTransitions.handleNavigationRequest({source:a,restoredState:h,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:o,extras:_,resolve:S,reject:L,promise:B,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),B.catch(Y=>Promise.reject(Y))}setBrowserUrl(o,a){const h=this.urlSerializer.serialize(o);if(this.location.isCurrentPathEqualTo(h)||a.extras.replaceUrl){const w={...a.extras.state,...this.generateNgRouterState(a.id,this.browserPageId)};this.location.replaceState(h,"",w)}else{const _={...a.extras.state,...this.generateNgRouterState(a.id,this.browserPageId+1)};this.location.go(h,"",_)}}restoreHistory(o,a=!1){if("computed"===this.canceledNavigationResolution){const _=this.currentPageId-this.browserPageId;0!==_?this.location.historyGo(_):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===_&&(this.resetState(o),this.browserUrlTree=o.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(a&&this.resetState(o),this.resetUrlToCurrentUrlTree())}resetState(o){this.routerState=o.currentRouterState,this.currentUrlTree=o.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,o.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(o,a){return"computed"===this.canceledNavigationResolution?{navigationId:o,\u0275routerPageId:a}:{navigationId:o}}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Y3(i){return!(i instanceof WA||i instanceof KA)}let cT=(()=>{class i{constructor(o,a,h,_,w,S){this.router=o,this.route=a,this.tabIndexAttribute=h,this.renderer=_,this.el=w,this.locationStrategy=S,this.href=null,this.commands=null,this.onChanges=new zy.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const L=w.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===L||"area"===L,this.isAnchorElement?this.subscription=o.events.subscribe(B=>{B instanceof uw&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(o){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",o)}ngOnChanges(o){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(o){null!=o?(this.commands=Array.isArray(o)?o:[o],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(o,a,h,_,w){return!!(null===this.urlTree||this.isAnchorElement&&(0!==o||a||h||_||w||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const o=null===this.href?null:(0,x.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",o)}applyAttributeValue(o,a){const h=this.renderer,_=this.el.nativeElement;null!==a?h.setAttribute(_,o,a):h.removeAttribute(_,o)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(ru),x.Y36(oT),x.$8M("tabindex"),x.Y36(x.Qsj),x.Y36(x.SBq),x.Y36(Le))};static#e=this.\u0275dir=x.lG2({type:i,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(a,h){1&a&&x.NdJ("click",function(w){return h.onClick(w.button,w.ctrlKey,w.shiftKey,w.altKey,w.metaKey)}),2&a&&x.uIk("target",h.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",x.VuI],skipLocationChange:["skipLocationChange","skipLocationChange",x.VuI],replaceUrl:["replaceUrl","replaceUrl",x.VuI],routerLink:"routerLink"},standalone:!0,features:[x.Xq5,x.TTD]})}return i})();class X3{}let c4=(()=>{class i{constructor(o,a,h,_,w){this.router=o,this.injector=h,this.preloadingStrategy=_,this.loader=w}setUpPreloading(){this.subscription=this.router.events.pipe(Ny(o=>o instanceof uw),YE(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(o,a){const h=[];for(const _ of a){_.providers&&!_._injector&&(_._injector=(0,x.MMx)(_.providers,o,`Route: ${_.path}`));const w=_._injector??o,S=_._loadedInjector??w;(_.loadChildren&&!_._loadedRoutes&&void 0===_.canLoad||_.loadComponent&&!_._loadedComponent)&&h.push(this.preloadConfig(w,_)),(_.children||_._loadedRoutes)&&h.push(this.processRoutes(S,_.children??_._loadedRoutes))}return(0,Nt.D)(h).pipe((0,nI.J)())}preloadConfig(o,a){return this.preloadingStrategy.preload(a,()=>{let h;h=a.loadChildren&&void 0===a.canLoad?this.loader.loadChildren(o,a):(0,Nr.of)(null);const _=h.pipe((0,ad.z)(w=>null===w?(0,Nr.of)(void 0):(a._loadedRoutes=w.routes,a._loadedInjector=w.injector,this.processRoutes(w.injector??o,w.routes))));if(a.loadComponent&&!a._loadedComponent){const w=this.loader.loadComponent(a);return(0,Nt.D)([_,w]).pipe((0,nI.J)())}return _})}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(ru),x.LFG(x.Sil),x.LFG(x.lqb),x.LFG(X3),x.LFG(aD))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();const lD=new x.OlP("");let Q3=(()=>{class i{constructor(o,a,h,_,w={}){this.urlSerializer=o,this.transitions=a,this.viewportScroller=h,this.zone=_,this.options=w,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},w.scrollPositionRestoration=w.scrollPositionRestoration||"disabled",w.anchorScrolling=w.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(o=>{o instanceof SS?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=o.navigationTrigger,this.restoredId=o.restoredState?o.restoredState.navigationId:0):o instanceof uw?(this.lastId=o.id,this.scheduleScrollEvent(o,this.urlSerializer.parse(o.urlAfterRedirects).fragment)):o instanceof nT&&0===o.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(o,this.urlSerializer.parse(o.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(o=>{o instanceof M3&&(o.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(o.position):o.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(o.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(o,a){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new M3(o,"popstate"===this.lastSource?this.store[this.restoredId]:null,a))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#t=this.\u0275fac=function(a){x.$Z()};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();function sb(i,n){return{\u0275kind:i,\u0275providers:n}}function tR(){const i=(0,x.f3M)(x.zs3);return n=>{const o=i.get(x.z2F);if(n!==o.components[0])return;const a=i.get(ru),h=i.get(eR);1===i.get(cD)&&a.initialNavigation(),i.get(nR,null,x.XFs.Optional)?.setUpPreloading(),i.get(lD,null,x.XFs.Optional)?.init(),a.resetRootComponentType(o.componentTypes[0]),h.closed||(h.next(),h.complete(),h.unsubscribe())}}const eR=new x.OlP("",{factory:()=>new zy.x}),cD=new x.OlP("",{providedIn:"root",factory:()=>1}),nR=new x.OlP("");function f4(i){return sb(0,[{provide:nR,useExisting:c4},{provide:X3,useExisting:i}])}const rR=new x.OlP("ROUTER_FORROOT_GUARD"),g4=[rn,{provide:sI,useClass:$A},ru,hI,{provide:oT,useFactory:function J3(i){return i.routerState.root},deps:[ru]},aD,[]];function m4(){return new x.PXZ("Router",ru)}let oR=(()=>{class i{constructor(o){}static forRoot(o,a){return{ngModule:i,providers:[g4,[],{provide:lT,multi:!0,useValue:o},{provide:rR,useFactory:b4,deps:[[ru,new x.FiY,new x.tp0]]},{provide:BS,useValue:a||{}},a?.useHash?{provide:Le,useClass:We}:{provide:Le,useClass:tn},{provide:lD,useFactory:()=>{const i=(0,x.f3M)(Cc),n=(0,x.f3M)(x.R0b),o=(0,x.f3M)(BS),a=(0,x.f3M)(zS),h=(0,x.f3M)(sI);return o.scrollOffset&&i.setOffset(o.scrollOffset),new Q3(h,a,i,n,o)}},a?.preloadingStrategy?f4(a.preloadingStrategy).\u0275providers:[],{provide:x.PXZ,multi:!0,useFactory:m4},a?.initialNavigation?x4(a):[],a?.bindToComponentInputs?sb(8,[A3,{provide:kS,useExisting:A3}]).\u0275providers:[],[{provide:iR,useFactory:tR},{provide:x.tb,multi:!0,useExisting:iR}]]}}static forChild(o){return{ngModule:i,providers:[{provide:lT,multi:!0,useValue:o}]}}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(rR,8))};static#e=this.\u0275mod=x.oAB({type:i});static#n=this.\u0275inj=x.cJS({})}return i})();function b4(i){return"guarded"}function x4(i){return["disabled"===i.initialNavigation?sb(3,[{provide:x.ip1,multi:!0,useFactory:()=>{const n=(0,x.f3M)(ru);return()=>{n.setUpLocationChangeListener()}}},{provide:cD,useValue:2}]).\u0275providers:[],"enabledBlocking"===i.initialNavigation?sb(2,[{provide:cD,useValue:0},{provide:x.ip1,multi:!0,deps:[x.zs3],useFactory:n=>{const o=n.get(ue,Promise.resolve());return()=>o.then(()=>new Promise(a=>{const h=n.get(ru),_=n.get(eR);K3(h,()=>{a(!0)}),n.get(zS).afterPreactivation=()=>(a(!0),_.closed?(0,Nr.of)(void 0):_),h.initialNavigation()}))}}]).\u0275providers:[]]}const iR=new x.OlP("");var C4=ft(3019),US=ft(3093),M4=ft(4552);class P4 extends zy.x{constructor(n=1/0,o=1/0,a=M4.l){super(),this._bufferSize=n,this._windowTime=o,this._timestampProvider=a,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=o===1/0,this._bufferSize=Math.max(1,n),this._windowTime=Math.max(1,o)}next(n){const{isStopped:o,_buffer:a,_infiniteTimeWindow:h,_timestampProvider:_,_windowTime:w}=this;o||(a.push(n),!h&&a.push(_.now()+w)),this._trimBuffer(),super.next(n)}_subscribe(n){this._throwIfClosed(),this._trimBuffer();const o=this._innerSubscribe(n),{_infiniteTimeWindow:a,_buffer:h}=this,_=h.slice();for(let w=0;w<_.length&&!n.closed;w+=a?1:2)n.next(_[w]);return this._checkFinalizedStatuses(n),o}_trimBuffer(){const{_bufferSize:n,_timestampProvider:o,_buffer:a,_infiniteTimeWindow:h}=this,_=(h?1:2)*n;if(n<1/0&&_<a.length&&a.splice(0,a.length-_),!h){const w=o.now();let S=0;for(let L=1;L<a.length&&a[L]<=w;L+=2)S=L;S&&a.splice(0,S+1)}}}var O4=ft(3020);function sR(i,n,o){let a,h=!1;return i&&"object"==typeof i?({bufferSize:a=1/0,windowTime:n=1/0,refCount:h=!1,scheduler:o}=i):a=i??1/0,(0,O4.B)({connector:()=>new P4(a,n,o),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:h})}function aR(i,n){return(0,X2.m)(n)?(0,Nl.w)(()=>i,n):(0,Nl.w)(()=>i)}var uD=ft(5137);ft(120);const T4=new x.OlP("angularfire2.auth.use-emulator"),I4=new x.OlP("angularfire2.auth.settings"),S4=new x.OlP("angularfire2.auth.tenant-id"),A4=new x.OlP("angularfire2.auth.langugage-code"),D4=new x.OlP("angularfire2.auth.use-device-language"),k4=new x.OlP("angularfire.auth.persistence");let dD=(()=>{class i{constructor(o,a,h,_,w,S,L,B,H,Y,pt,xt){const At=new zy.x,Ut=(0,Nr.of)(void 0).pipe((0,US.Q)(w.outsideAngular),(0,Nl.w)(()=>_.runOutsideAngular(()=>ft.e(661).then(ft.bind(ft,8661)))),(0,ln.U)(()=>(0,Pa.on)(o,_,a)),(0,ln.U)(Zt=>((i,n,o,a,h,_,w,S)=>(0,Pa.cc)(`${i.name}.auth`,"AngularFireAuth",i.name,()=>{const L=n.runOutsideAngular(()=>i.auth());if(o&&L.useEmulator(...o),a&&(L.tenantId=a),L.languageCode=h,_&&L.useDeviceLanguage(),w)for(const[B,H]of Object.entries(w))L.settings[B]=H;return S&&L.setPersistence(S),L},[o,a,h,_,w,S]))(Zt,_,S,B,H,Y,L,pt)),sR({bufferSize:1,refCount:!1}));if(Xi(h))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,Nr.of)(null);else{Ut.pipe(lw()).subscribe();const qe=Ut.pipe((0,Nl.w)(cn=>cn.getRedirectResult().then(Mr=>Mr,()=>null)),Wr.iC,sR({bufferSize:1,refCount:!1})),fn=Ut.pipe((0,Nl.w)(cn=>new $t.y(Mr=>({unsubscribe:_.runOutsideAngular(()=>cn.onAuthStateChanged(Cr=>Mr.next(Cr),Cr=>Mr.error(Cr),()=>Mr.complete()))})))),$e=Ut.pipe((0,Nl.w)(cn=>new $t.y(Mr=>({unsubscribe:_.runOutsideAngular(()=>cn.onIdTokenChanged(Cr=>Mr.next(Cr),Cr=>Mr.error(Cr),()=>Mr.complete()))}))));this.authState=qe.pipe(aR(fn),(0,uD.R)(w.outsideAngular),(0,US.Q)(w.insideAngular)),this.user=qe.pipe(aR($e),(0,uD.R)(w.outsideAngular),(0,US.Q)(w.insideAngular)),this.idToken=this.user.pipe((0,Nl.w)(cn=>cn?(0,Nt.D)(cn.getIdToken()):(0,Nr.of)(null))),this.idTokenResult=this.user.pipe((0,Nl.w)(cn=>cn?(0,Nt.D)(cn.getIdTokenResult()):(0,Nr.of)(null))),this.credential=(0,C4.T)(qe,At,this.authState.pipe(Ny(cn=>!cn))).pipe((0,ln.U)(cn=>cn?.user?cn:null),(0,uD.R)(w.outsideAngular),(0,US.Q)(w.insideAngular))}return(0,Pa.pX)(this,Ut,_,{spy:{apply:(Zt,qe,fn)=>{(Zt.startsWith("signIn")||Zt.startsWith("createUser"))&&fn.then($e=>At.next($e))}}})}}return i.\u0275fac=function(o){return new(o||i)(x.LFG(Pa.Dh),x.LFG(Pa.xv,8),x.LFG(x.Lbi),x.LFG(x.R0b),x.LFG(Wr.HU),x.LFG(T4,8),x.LFG(I4,8),x.LFG(S4,8),x.LFG(A4,8),x.LFG(D4,8),x.LFG(k4,8),x.LFG(sn,8))},i.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})(),VS=(()=>{class i{constructor(o,a,h){this.firebaseAuthenticationService=o,this.router=a,this.ngZone=h,this.firebaseAuthenticationService.authState.subscribe(_=>{_?(this.userData=_,localStorage.setItem("user",JSON.stringify(this.userData))):localStorage.setItem("user","null")})}logInWithEmailAndPassword(o,a){return this.firebaseAuthenticationService.signInWithEmailAndPassword(o,a).then(h=>{this.userData=h.user,this.observeUserState()}).catch(h=>{let _="Hubo un error al iniciar sesi\xf3n con Google.";return("auth/user-not-found"===h.code||"auth/wrong-password"===h.code)&&(_="Usuario o contrase\xf1a incorrectos. Por favor, verifica tus credenciales."),_})}logInWithGoogleProvider(){return this.firebaseAuthenticationService.signInWithPopup(new rc.V).then(()=>this.observeUserState()).catch(o=>{let a="Hubo un error al iniciar sesi\xf3n con Google.";return("auth/user-not-found"===o.code||"auth/wrong-password"===o.code)&&(a="Usuario o contrase\xf1a incorrectos. Por favor, verifica tus credenciales."),a})}signUpWithEmailAndPassword(o,a){return this.firebaseAuthenticationService.createUserWithEmailAndPassword(o,a).then(h=>{this.userData=h.user,this.observeUserState()}).catch(h=>{let _="Hubo un error al iniciar sesi\xf3n con Google.";return("auth/user-not-found"===h.code||"auth/wrong-password"===h.code)&&(_="Usuario o contrase\xf1a incorrectos. Por favor, verifica tus credenciales."),_})}signUpWithGoogle(){return this.firebaseAuthenticationService.signInWithPopup(new rc.V).then(o=>{this.userData=o.user,this.observeUserState()}).catch(o=>{let a="Hubo un error al iniciar sesi\xf3n con Google.";return("auth/user-not-found"===o.code||"auth/wrong-password"===o.code)&&(a="Usuario o contrase\xf1a incorrectos. Por favor, verifica tus credenciales."),a})}observeUserState(){this.firebaseAuthenticationService.authState.subscribe(o=>{o&&this.ngZone.run(()=>this.router.navigate(["dashboard"]))})}get isLoggedIn(){return null!==JSON.parse(localStorage.getItem("user"))}logOut(){return this.firebaseAuthenticationService.signOut().then(()=>{localStorage.removeItem("user"),this.router.navigate([""])})}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(dD),x.LFG(ru),x.LFG(x.R0b))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),L4=(()=>{class i{constructor(o,a){this.authService=o,this.router=a,this.usuario="",this.contrasenia=""}iniciarSesion(){var o=this;return(0,Je.Z)(function*(){try{yield o.authService.logInWithEmailAndPassword(o.usuario,o.contrasenia)}catch(a){o.errorMessage="auth/user-not-found"===a.code?"Usuario no encontrado. Por favor, registra una cuenta.":"auth/wrong-password"===a.code?"Contrase\xf1a incorrecta. Por favor, int\xe9ntalo nuevamente.":"Ha ocurrido un error durante el inicio de sesi\xf3n. Por favor, int\xe9ntalo nuevamente m\xe1s tarde."}})()}iniciarSesionConGoogle(){this.authService.logInWithGoogleProvider()}regresarInicio(){this.router.navigate(["/"])}onScroll(){this.toggleStickyHeader(window.scrollY>0)}toggleStickyHeader(o){const a=document.querySelector("header");a&&a.classList.toggle("sticky",o)}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(VS),x.Y36(ru))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-login"]],hostBindings:function(a,h){1&a&&x.NdJ("scroll",function(w){return h.onScroll(w)},!1,x.Jf7)},decls:46,vars:2,consts:[["rel","stylesheet","href","https://fonts.googleapis.com/icon?family=Material+Icons"],[1,"logo"],[1,"nav"],["href","/"],["href","/about"],["href","/download"],["href","/association"],["href","/singUp",1,"login"],[1,"login-wrapper"],[1,"input-box"],["for","usuario"],["type","text","name","usuario","id","usuario","required","","placeholder","example@example.com",3,"ngModel","ngModelChange"],[1,"bx","bxs-user"],["for","contrasenia"],["type","password","name","contrasenia","id","contrasenia","required","","placeholder","Enter your password",3,"ngModel","ngModelChange"],[1,"bx","bxs-lock-alt"],["type","button",1,"btn",3,"click"],["type","button",1,"google-btn",3,"click"],[1,"google-icon"],["src","https://www.svgrepo.com/show/475656/google-color.svg","alt","google logo"],[1,"google-text"],[1,"register-link"],["routerLink","/SingUp"]],template:function(a,h){1&a&&(x.TgZ(0,"head"),x._UZ(1,"link",0),x.qZA(),x.TgZ(2,"header")(3,"a",1),x._uU(4,"TripTrove"),x.qZA(),x.TgZ(5,"ul",2)(6,"li")(7,"a",3),x._uU(8,"INICIO"),x.qZA()(),x.TgZ(9,"li")(10,"a",4),x._uU(11,"ACERCA DE"),x.qZA()(),x.TgZ(12,"li")(13,"a",5),x._uU(14,"ANDROID"),x.qZA()(),x.TgZ(15,"li")(16,"a",6),x._uU(17,"ASOCIATE"),x.qZA()()(),x.TgZ(18,"a",7),x._uU(19,"REGISTRATE"),x.qZA()(),x.TgZ(20,"body")(21,"div",8)(22,"h1"),x._uU(23,"Sing In"),x.qZA(),x.TgZ(24,"div",9)(25,"label",10),x._uU(26,"Your email"),x.qZA(),x.TgZ(27,"input",11),x.NdJ("ngModelChange",function(w){return h.usuario=w}),x.qZA(),x._UZ(28,"i",12),x.qZA(),x.TgZ(29,"div",9)(30,"label",13),x._uU(31,"Password"),x.qZA(),x.TgZ(32,"input",14),x.NdJ("ngModelChange",function(w){return h.contrasenia=w}),x.qZA(),x._UZ(33,"i",15),x.qZA(),x.TgZ(34,"button",16),x.NdJ("click",function(){return h.iniciarSesion()}),x._uU(35,"Sing in"),x.qZA(),x.TgZ(36,"button",17),x.NdJ("click",function(){return h.iniciarSesionConGoogle()}),x.TgZ(37,"div",18),x._UZ(38,"img",19),x.qZA(),x.TgZ(39,"span",20),x._uU(40,"Sing in with google"),x.qZA()(),x.TgZ(41,"div",21)(42,"p"),x._uU(43,"You do not have an account? "),x.TgZ(44,"a",22),x._uU(45,"Sing up for TripTrove"),x.qZA()()()()()),2&a&&(x.xp6(27),x.Q6J("ngModel",h.usuario),x.xp6(5),x.Q6J("ngModel",h.contrasenia))},dependencies:[cT,Gr,HE,Y2,KE],styles:['@import"https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap";*[_ngcontent-%COMP%]{box-sizing:border-box;font-family:Poppins,sans-serif;color:#000;text-decoration:none}body[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100vh;margin:0;background-image:url(fondoAndroid.ed14630c41fa3198.jpg);background-attachment:fixed;background-position:center;background-size:cover}header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;transition:.9s;padding:40px 100px;z-index:100000;font-size:18px}header[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]{color:#000;transition:.6s}header.sticky[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]{color:#fff;transition:.6s}header.sticky[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(2) a{color:#fff}header.sticky[_ngcontent-%COMP%]{padding:5px 100px;background:rgb(37,150,190)}header.sticky[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:relative;font-weight:700;color:#000;text-decoration:none;font-size:2em;letter-spacing:2px;transition:.6s}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;list-style:none}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;margin:0 15px;text-decoration:none;color:#000;letter-spacing:2px;font-weight:500;transition:.5s;overflow:hidden}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;width:120%;height:3px;background-color:#000;z-index:-1;transition:transform .8s;border-radius:5px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{top:0;left:-10%;transform:scaleX(0);transform-origin:right}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{bottom:0;right:-10%;transform:scaleX(0);transform-origin:left}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{font-weight:700;font-size:120%}.login-wrapper[_ngcontent-%COMP%]{max-width:600px;min-width:425px;padding:20px;margin:20%;border:1px solid #85858577;border-radius:11px;box-shadow:0 0 10px #0000003f;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)}.back-button[_ngcontent-%COMP%]{position:absolute;top:2%;right:0;z-index:9999;display:flex;align-items:center;padding:5px,;border:none;border-radius:4px;cursor:pointer;color:#000;font-size:150%;font-weight:700}.back-button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{margin-right:5px}.login-wrapper[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{align-self:center;justify-self:center}.input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:silver}.google-text[_ngcontent-%COMP%]{margin-top:auto}.google-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.input-box[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%], .google-btn[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:700}input[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%], .google-btn[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #646464;border-radius:4px;box-sizing:border-box;cursor:pointer;text-align:center}.google-btn[_ngcontent-%COMP%]{display:flex;align-items:center}.google-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px;margin-right:10px}.back-button[_ngcontent-%COMP%]{padding:5px 10px;border:none;border-radius:4px;cursor:pointer;color:#000}.register-link[_ngcontent-%COMP%]{margin-top:10px}@media (max-width: 600px){.login-wrapper[_ngcontent-%COMP%]{max-width:100%}}.input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #757575;border-radius:4px;box-sizing:border-box;cursor:pointer;text-align:center;background-color:#ffffff80}']})}return i})(),N4=(()=>{class i{constructor(o,a){this.authService=o,this.router=a,this.email="",this.password=""}signUp(){var o=this;return(0,Je.Z)(function*(){try{yield o.authService.signUpWithEmailAndPassword(o.email,o.password)}catch(a){o.errorMessage="auth/email-already-in-use"===a.code?"Este correo electr\xf3nico ya est\xe1 en uso. Por favor, utiliza otro correo.":"auth/weak-password"===a.code?"La contrase\xf1a es d\xe9bil. Por favor, utiliza una contrase\xf1a m\xe1s segura.":"Ha ocurrido un error durante el registro. Por favor, int\xe9ntalo nuevamente m\xe1s tarde."}})()}registerWithGoogle(){this.authService.signUpWithGoogle()}goBack(){this.router.navigate(["/"])}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(VS),x.Y36(ru))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-sign-up"]],decls:44,vars:2,consts:[[1,"logo"],[1,"nav"],["href","/"],["href","/about"],["href","/download"],["href","/association"],["href","/SingIn",1,"login"],[1,"login-wrapper"],[1,"input-box"],["for","usuario"],["type","text","name","usuario","id","usuario","required","","placeholder","example@example.com",3,"ngModel","ngModelChange"],[1,"bx","bxs-user"],["for","contrasenia"],["type","password","name","contrasenia","id","contrasenia","required","","placeholder","Enter your password",3,"ngModel","ngModelChange"],[1,"bx","bxs-lock-alt"],["type","button",1,"btn",3,"click"],["type","button",1,"google-btn",3,"click"],[1,"google-icon"],["src","https://www.svgrepo.com/show/475656/google-color.svg","alt","google logo"],[1,"google-text"],[1,"register-link"],["routerLink","/SingIn"]],template:function(a,h){1&a&&(x.TgZ(0,"header")(1,"a",0),x._uU(2,"TripTrove"),x.qZA(),x.TgZ(3,"ul",1)(4,"li")(5,"a",2),x._uU(6,"INICIO"),x.qZA()(),x.TgZ(7,"li")(8,"a",3),x._uU(9,"ACERCA DE"),x.qZA()(),x.TgZ(10,"li")(11,"a",4),x._uU(12,"ANDROID"),x.qZA()(),x.TgZ(13,"li")(14,"a",5),x._uU(15,"ASOCIATE"),x.qZA()()(),x.TgZ(16,"a",6),x._uU(17,"INICIA SESION"),x.qZA()(),x.TgZ(18,"body")(19,"div",7)(20,"h1"),x._uU(21,"Sing Up"),x.qZA(),x.TgZ(22,"div",8)(23,"label",9),x._uU(24,"Your email"),x.qZA(),x.TgZ(25,"input",10),x.NdJ("ngModelChange",function(w){return h.email=w}),x.qZA(),x._UZ(26,"i",11),x.qZA(),x.TgZ(27,"div",8)(28,"label",12),x._uU(29,"Password"),x.qZA(),x.TgZ(30,"input",13),x.NdJ("ngModelChange",function(w){return h.password=w}),x.qZA(),x._UZ(31,"i",14),x.qZA(),x.TgZ(32,"button",15),x.NdJ("click",function(){return h.signUp()}),x._uU(33,"Sing in"),x.qZA(),x.TgZ(34,"button",16),x.NdJ("click",function(){return h.registerWithGoogle()}),x.TgZ(35,"div",17),x._UZ(36,"img",18),x.qZA(),x.TgZ(37,"span",19),x._uU(38,"Sing in with google"),x.qZA()(),x.TgZ(39,"div",20)(40,"p"),x._uU(41,"You have an account? "),x.TgZ(42,"a",21),x._uU(43,"Sing in for TripTrove"),x.qZA()()()()()),2&a&&(x.xp6(25),x.Q6J("ngModel",h.email),x.xp6(5),x.Q6J("ngModel",h.password))},dependencies:[cT,Gr,HE,Y2,KE],styles:['@import"https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap";*[_ngcontent-%COMP%]{box-sizing:border-box;font-family:Poppins,sans-serif;color:#000;text-decoration:none}header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;transition:.9s;padding:40px 100px;z-index:100000;font-size:18px}header.sticky[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]{color:#fff}header.sticky[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(2) a{color:#fff}header.sticky[_ngcontent-%COMP%]{padding:5px 100px;background:#000000}header.sticky[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:relative;font-weight:700;color:#000;text-decoration:none;font-size:2em;letter-spacing:2px;transition:.6s}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;list-style:none}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;margin:0 15px;text-decoration:none;color:#000;letter-spacing:2px;font-weight:500;transition:.5s;overflow:hidden}header[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]{position:relative;margin:0 15px;text-decoration:none;color:#000;letter-spacing:2px;font-weight:500;transition:.5s;overflow:hidden}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;width:120%;height:3px;background-color:#000;z-index:-1;transition:transform .8s;border-radius:5px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{top:0;left:-10%;transform:scaleX(0);transform-origin:right}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{bottom:0;right:-10%;transform:scaleX(0);transform-origin:left}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:center}body[_ngcontent-%COMP%]{background-image:url(fondoLogin.2db4eed342a65978.jpg);background-size:cover;background-position:center;background-repeat:no-repeat;font-family:Arial,sans-serif;margin:0;padding:0;display:flex;justify-content:flex-start;align-items:center;height:100vh;overflow:hidden}.login-wrapper[_ngcontent-%COMP%]{max-width:600px;min-width:425px;padding:20px;margin:20%;border:1px solid #85858577;border-radius:11px;box-shadow:0 0 10px #0000003f;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)}.back-button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{margin-right:5px}.login-wrapper[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{align-self:center;justify-self:center}.input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:silver}.google-text[_ngcontent-%COMP%]{margin-top:auto}.google-btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.input-box[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%], .google-btn[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%]{width:100%;margin-bottom:15px}label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:700}input[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%], .google-btn[_ngcontent-%COMP%], .back-button[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #646464;border-radius:4px;box-sizing:border-box;cursor:pointer;text-align:center}.google-btn[_ngcontent-%COMP%]{display:flex;align-items:center}.google-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px;height:20px;margin-right:10px}.back-button[_ngcontent-%COMP%]{padding:5px 10px;border:none;border-radius:4px;cursor:pointer;color:#000}.register-link[_ngcontent-%COMP%]{margin-top:10px}@media (max-width: 600px){.login-wrapper[_ngcontent-%COMP%]{max-width:100%}}.input-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #757575;border-radius:4px;box-sizing:border-box;cursor:pointer;text-align:center;background-color:#ffffff80}']})}return i})();const vI_apiKey="pk.eyJ1IjoibmFodW1sb3B6IiwiYSI6ImNsc3k2eGRlejBhYXIycm54YmxnaXlneTkifQ.wrnk_DcsIDYJ6a8OQSeE5Q",vI_firebase={projectId:"triptroveangular",appId:"1:424821813680:web:8e62cec178c0ffc4972675",storageBucket:"triptroveangular.appspot.com",apiKey:"AIzaSyA9r2Hn3Qoc7EaCkG0q9LVIGj_N6UluTZ4",authDomain:"triptroveangular.firebaseapp.com",messagingSenderId:"424821813680",measurementId:"G-JB2EZRFDDX"};let F4=(()=>{class i extends tI{constructor(o){super(o),this.baseUrl="https://api.mapbox.com/directions/v5/mapbox"}get(o){return super.get(o=this.baseUrl+o,{params:{alternatives:!0,geometries:"geojson",language:"es",overview:"simplified",steps:!0,access_token:vI_apiKey}})}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(GM))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),z4=(()=>{class i extends tI{constructor(o){super(o),this.baseUrl="https://api.mapbox.com/geocoding/v5/mapbox.places"}get(o,a){o=`${this.baseUrl}${o}`;const h={limit:4,language:"es",access_token:vI_apiKey,...a.params};return h.bbox="-99.3269,19.1056,-98.5636,19.7039",super.get(o,{params:h})}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(GM))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var ab=ft(2574),lR=ft.n(ab);let B4=(()=>{class i extends tI{constructor(o){super(o),this.baseUrl="https://api.mapbox.com/directions/v5/mapbox"}get(o){return super.get(o=this.baseUrl+o,{params:{contours_colors:"005a32",polygons:"true",denoise:"1",generalize:"500",access_token:vI_apiKey}})}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(GM))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),bI=(()=>{class i{get isMapReady(){return!!this.map}constructor(o,a){this.directionsApi=o,this.distanceApi=a,this.markers=[],this.stepsAsString=""}setMap(o){this.map=o}flyTo(o){if(!this.isMapReady)throw Error("El mapa  no esta inicializado");this.map?.flyTo({zoom:16,pitch:40,essential:!0,center:o})}createMarkersFromPlaces(o,a){if(!this.map)throw Error("Mapa no inicializado");this.markers.forEach(w=>w.remove());const h=[];for(const w of o){const[S,L]=w.center,B=(new ab.Popup).setHTML(`<h6>${w.text}</h6><br><span>${w.place_name}</span>`),H=(new ab.Marker).setLngLat([S,L]).setPopup(B).addTo(this.map);h.push(H)}if(this.markers=h,0==o.length)return;const _=new ab.LngLatBounds;h.forEach(w=>_.extend(w.getLngLat())),_.extend(a),this.map.fitBounds(_,{padding:200})}getRouteBetweenPoints(o,a,h){this.directionsApi.get(`/${o}/${a.join(",")};${h.join(",")}`).subscribe(_=>this.drawPolyline(_.routes[0]))}drawPolyline(o){const a=o.legs[0].steps;console.log("Instrucciones de la Ruta:");for(const S of a)console.log(S.maneuver.instruction);if(console.log({kms:o.distance/1e3,duration:o.duration/60}),!this.map)throw Error("Mapa no inicializado");const h=o.geometry.coordinates,_=new ab.LngLatBounds;h.forEach(([S,L])=>_.extend([S,L])),this.map?.fitBounds(_,{padding:200});const w={type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:h}}]}};this.map.getLayer("RouteString")&&(this.map.removeLayer("RouteString"),this.map.removeSource("RouteString")),this.map.addSource("RouteString",w),this.map.addLayer({id:"RouteString",type:"line",source:"RouteString",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"green","line-width":7}})}distancePolyline(o){if(!this.map)throw Error("Mapa no inicializado");const a=new ab.LngLatBounds;this.map?.fitBounds(a,{padding:200}),this.map.getLayer("RouteString")&&(this.map.removeLayer("RouteString"),this.map.removeSource("RouteString")),this.map.addLayer({id:"RouteString",type:"line",source:"RouteString",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"green","line-width":7}})}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(F4),x.LFG(B4))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),uT=(()=>{class i{get isUserLocationReady(){return!!this.userLocation}constructor(o,a){this.placesApi=o,this.mapService=a,this.isLoadingPlaces=!1,this.places=[],this.getUserLocation()}getUserLocation(){var o=this;return(0,Je.Z)(function*(){return new Promise((a,h)=>{navigator.geolocation.getCurrentPosition(({coords:_})=>{o.userLocation=[_.longitude,_.latitude],a(o.userLocation)},_=>{alert("No se pudo obtener la geolocalizaci\xf3n"),console.log(_),h(_)})})})()}getPlacesByQuery(o=""){if(0===o.length)return this.isLoadingPlaces=!1,void(this.places=[]);if(!this.userLocation)throw Error("No hay userLocation");this.isLoadingPlaces=!0,this.placesApi.get(`/${o}.json`,{params:{proximity:this.userLocation?.join(",")}}).subscribe(a=>{console.log(a.features[0]),this.isLoadingPlaces=!1,this.places=a.features,this.mapService.createMarkersFromPlaces(this.places,this.userLocation)})}upPlaces(){this.places=[]}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(z4),x.LFG(bI))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();const cR="firebasestorage.googleapis.com",uR="storageBucket";class Gs extends $r.ZR{constructor(n,o,a=0){super(hD(n),`Firebase Storage: ${o} (${hD(n)})`),this.status_=a,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Gs.prototype)}get status(){return this.status_}set status(n){this.status_=n}_codeEquals(n){return hD(n)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(n){this.customData.serverResponse=n,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var Ds=function(i){return i.UNKNOWN="unknown",i.OBJECT_NOT_FOUND="object-not-found",i.BUCKET_NOT_FOUND="bucket-not-found",i.PROJECT_NOT_FOUND="project-not-found",i.QUOTA_EXCEEDED="quota-exceeded",i.UNAUTHENTICATED="unauthenticated",i.UNAUTHORIZED="unauthorized",i.UNAUTHORIZED_APP="unauthorized-app",i.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",i.INVALID_CHECKSUM="invalid-checksum",i.CANCELED="canceled",i.INVALID_EVENT_NAME="invalid-event-name",i.INVALID_URL="invalid-url",i.INVALID_DEFAULT_BUCKET="invalid-default-bucket",i.NO_DEFAULT_BUCKET="no-default-bucket",i.CANNOT_SLICE_BLOB="cannot-slice-blob",i.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",i.NO_DOWNLOAD_URL="no-download-url",i.INVALID_ARGUMENT="invalid-argument",i.INVALID_ARGUMENT_COUNT="invalid-argument-count",i.APP_DELETED="app-deleted",i.INVALID_ROOT_OPERATION="invalid-root-operation",i.INVALID_FORMAT="invalid-format",i.INTERNAL_ERROR="internal-error",i.UNSUPPORTED_ENVIRONMENT="unsupported-environment",i}(Ds||{});function hD(i){return"storage/"+i}function fD(){return new Gs(Ds.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function pD(i){return new Gs(Ds.INVALID_ARGUMENT,i)}function pR(){return new Gs(Ds.APP_DELETED,"The Firebase app was deleted.")}function xI(i,n){return new Gs(Ds.INVALID_FORMAT,"String does not match format '"+i+"': "+n)}function wI(i){throw new Gs(Ds.INTERNAL_ERROR,"Internal error: "+i)}class ld{constructor(n,o){this.bucket=n,this.path_=o}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const n=encodeURIComponent;return"/b/"+n(this.bucket)+"/o/"+n(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(n,o){let a;try{a=ld.makeFromUrl(n,o)}catch{return new ld(n,"")}if(""===a.path)return a;throw function K4(i){return new Gs(Ds.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+i+"'.")}(n)}static makeFromUrl(n,o){let a=null;const h="([A-Za-z0-9.\\-_]+)",S=new RegExp("^gs://"+h+"(/(.*))?$","i");function B(cn){cn.path_=decodeURIComponent(cn.path)}const Y=o.replace(/[.]/g,"\\."),$e=[{regex:S,indices:{bucket:1,path:3},postModify:function _(cn){"/"===cn.path.charAt(cn.path.length-1)&&(cn.path_=cn.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${Y}/v[A-Za-z0-9_]+/b/${h}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:B},{regex:new RegExp(`^https?://${o===cR?"(?:storage.googleapis.com|storage.cloud.google.com)":o}/${h}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:B}];for(let cn=0;cn<$e.length;cn++){const Mr=$e[cn],Cr=Mr.regex.exec(n);if(Cr){let ks=Cr[Mr.indices.path];ks||(ks=""),a=new ld(Cr[Mr.indices.bucket],ks),Mr.postModify(a);break}}if(null==a)throw function W4(i){return new Gs(Ds.INVALID_URL,"Invalid URL '"+i+"'.")}(n);return a}}class e6{constructor(n){this.promise_=Promise.reject(n)}getPromise(){return this.promise_}cancel(n=!1){}}function jS(i){return"string"==typeof i||i instanceof String}function gR(i){return gD()&&i instanceof Blob}function gD(){return typeof Blob<"u"&&!(0,$r.UG)()}function mD(i,n,o,a){if(a<n)throw pD(`Invalid value for '${i}'. Expected ${n} or greater.`);if(a>o)throw pD(`Invalid value for '${i}'. Expected ${o} or less.`)}function lb(i,n,o){let a=n;return null==o&&(a=`https://${n}`),`${o}://${a}/v0${i}`}function mR(i){const n=encodeURIComponent;let o="?";for(const a in i)i.hasOwnProperty(a)&&(o=o+(n(a)+"=")+n(i[a])+"&");return o=o.slice(0,-1),o}var dT=function(i){return i[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT",i}(dT||{});class a6{constructor(n,o,a,h,_,w,S,L,B,H,Y,pt=!0){this.url_=n,this.method_=o,this.headers_=a,this.body_=h,this.successCodes_=_,this.additionalRetryCodes_=w,this.callback_=S,this.errorCallback_=L,this.timeout_=B,this.progressCallback_=H,this.connectionFactory_=Y,this.retry=pt,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((xt,At)=>{this.resolve_=xt,this.reject_=At,this.start_()})}start_(){const o=(a,h)=>{const _=this.resolve_,w=this.reject_,S=h.connection;if(h.wasSuccessCode)try{const L=this.callback_(S,S.getResponse());!function o6(i){return void 0!==i}(L)?_():_(L)}catch(L){w(L)}else if(null!==S){const L=fD();L.serverResponse=S.getErrorText(),w(this.errorCallback_?this.errorCallback_(S,L):L)}else w(h.canceled?this.appDelete_?pR():function hR(){return new Gs(Ds.CANCELED,"User canceled the upload/download.")}():function dR(){return new Gs(Ds.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}())};this.canceled_?o(0,new $S(!1,null,!0)):this.backoffId_=function n6(i,n,o){let a=1,h=null,_=null,w=!1,S=0;function L(){return 2===S}let B=!1;function H(...Zt){B||(B=!0,n.apply(null,Zt))}function Y(Zt){h=setTimeout(()=>{h=null,i(xt,L())},Zt)}function pt(){_&&clearTimeout(_)}function xt(Zt,...qe){if(B)return void pt();if(Zt)return pt(),void H.call(null,Zt,...qe);if(L()||w)return pt(),void H.call(null,Zt,...qe);let $e;a<64&&(a*=2),1===S?(S=2,$e=0):$e=1e3*(a+Math.random()),Y($e)}let At=!1;function Ut(Zt){At||(At=!0,pt(),!B&&(null!==h?(Zt||(S=2),clearTimeout(h),Y(0)):Zt||(S=1)))}return Y(0),_=setTimeout(()=>{w=!0,Ut(!0)},o),Ut}((a,h)=>{if(h)return void a(!1,new $S(!1,null,!0));const _=this.connectionFactory_();this.pendingConnection_=_;const w=S=>{null!==this.progressCallback_&&this.progressCallback_(S.loaded,S.lengthComputable?S.total:-1)};null!==this.progressCallback_&&_.addUploadProgressListener(w),_.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&_.removeUploadProgressListener(w),this.pendingConnection_=null;const S=_.getErrorCode()===dT.NO_ERROR,L=_.getStatus();if(!S||function _R(i,n){const o=i>=500&&i<600,h=-1!==[408,429].indexOf(i),_=-1!==n.indexOf(i);return o||h||_}(L,this.additionalRetryCodes_)&&this.retry){const H=_.getErrorCode()===dT.ABORT;return void a(!1,new $S(!1,null,H))}const B=-1!==this.successCodes_.indexOf(L);a(!0,new $S(B,_))})},o,this.timeout_)}getPromise(){return this.promise_}cancel(n){this.canceled_=!0,this.appDelete_=n||!1,null!==this.backoffId_&&function r6(i){i(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class $S{constructor(n,o,a){this.wasSuccessCode=n,this.connection=o,this.canceled=!!a}}function p6(...i){const n=function f6(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==n){const o=new n;for(let a=0;a<i.length;a++)o.append(i[a]);return o.getBlob()}if(gD())return new Blob(i);throw new Gs(Ds.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}const Fm={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class _D{constructor(n,o){this.data=n,this.contentType=o||null}}function vR(i){const n=[];for(let o=0;o<i.length;o++){let a=i.charCodeAt(o);a<=127?n.push(a):a<=2047?n.push(192|a>>6,128|63&a):55296==(64512&a)?o<i.length-1&&56320==(64512&i.charCodeAt(o+1))?(a=65536|(1023&a)<<10|1023&i.charCodeAt(++o),n.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a)):n.push(239,191,189):56320==(64512&a)?n.push(239,191,189):n.push(224|a>>12,128|a>>6&63,128|63&a)}return new Uint8Array(n)}function bR(i,n){switch(i){case Fm.BASE64:{const h=-1!==n.indexOf("-"),_=-1!==n.indexOf("_");if(h||_)throw xI(i,"Invalid character '"+(h?"-":"_")+"' found: is it base64url encoded?");break}case Fm.BASE64URL:{const h=-1!==n.indexOf("+"),_=-1!==n.indexOf("/");if(h||_)throw xI(i,"Invalid character '"+(h?"+":"/")+"' found: is it base64 encoded?");n=n.replace(/-/g,"+").replace(/_/g,"/");break}}let o;try{o=function m6(i){if(typeof atob>"u")throw function J4(i){return new Gs(Ds.UNSUPPORTED_ENVIRONMENT,`${i} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(i)}(n)}catch(h){throw h.message.includes("polyfill")?h:xI(i,"Invalid character found")}const a=new Uint8Array(o.length);for(let h=0;h<o.length;h++)a[h]=o.charCodeAt(h);return a}class xR{constructor(n){this.base64=!1,this.contentType=null;const o=n.match(/^data:([^,]+)?,/);if(null===o)throw xI(Fm.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const a=o[1]||null;null!=a&&(this.base64=function b6(i,n){return i.length>=n.length&&i.substring(i.length-n.length)===n}(a,";base64"),this.contentType=this.base64?a.substring(0,a.length-7):a),this.rest=n.substring(n.indexOf(",")+1)}}class cb{constructor(n,o){let a=0,h="";gR(n)?(this.data_=n,a=n.size,h=n.type):n instanceof ArrayBuffer?(o?this.data_=new Uint8Array(n):(this.data_=new Uint8Array(n.byteLength),this.data_.set(new Uint8Array(n))),a=this.data_.length):n instanceof Uint8Array&&(o?this.data_=n:(this.data_=new Uint8Array(n.length),this.data_.set(n)),a=n.length),this.size_=a,this.type_=h}size(){return this.size_}type(){return this.type_}slice(n,o){if(gR(this.data_)){const h=function g6(i,n,o){return i.webkitSlice?i.webkitSlice(n,o):i.mozSlice?i.mozSlice(n,o):i.slice?i.slice(n,o):null}(this.data_,n,o);return null===h?null:new cb(h)}{const a=new Uint8Array(this.data_.buffer,n,o-n);return new cb(a,!0)}}static getBlob(...n){if(gD()){const o=n.map(a=>a instanceof cb?a.data_:a);return new cb(p6.apply(null,o))}{const o=n.map(w=>jS(w)?function yR(i,n){switch(i){case Fm.RAW:return new _D(vR(n));case Fm.BASE64:case Fm.BASE64URL:return new _D(bR(i,n));case Fm.DATA_URL:return new _D(function y6(i){const n=new xR(i);return n.base64?bR(Fm.BASE64,n.rest):function _6(i){let n;try{n=decodeURIComponent(i)}catch{throw xI(Fm.DATA_URL,"Malformed data URL.")}return vR(n)}(n.rest)}(n),function v6(i){return new xR(i).contentType}(n))}throw fD()}(Fm.RAW,w).data:w.data_);let a=0;o.forEach(w=>{a+=w.byteLength});const h=new Uint8Array(a);let _=0;return o.forEach(w=>{for(let S=0;S<w.length;S++)h[_++]=w[S]}),new cb(h,!0)}}uploadData(){return this.data_}}function yD(i){let n;try{n=JSON.parse(i)}catch{return null}return function s6(i){return"object"==typeof i&&!Array.isArray(i)}(n)?n:null}function wR(i){const n=i.lastIndexOf("/",i.length-2);return-1===n?i:i.slice(n+1)}function C6(i,n){return n}class cd{constructor(n,o,a,h){this.server=n,this.local=o||n,this.writable=!!a,this.xform=h||C6}}let GS=null;function CI(){if(GS)return GS;const i=[];i.push(new cd("bucket")),i.push(new cd("generation")),i.push(new cd("metageneration")),i.push(new cd("name","fullPath",!0));const o=new cd("name");o.xform=function n(_,w){return function M6(i){return!jS(i)||i.length<2?i:wR(i)}(w)},i.push(o);const h=new cd("size");return h.xform=function a(_,w){return void 0!==w?Number(w):w},i.push(h),i.push(new cd("timeCreated")),i.push(new cd("updated")),i.push(new cd("md5Hash",null,!0)),i.push(new cd("cacheControl",null,!0)),i.push(new cd("contentDisposition",null,!0)),i.push(new cd("contentEncoding",null,!0)),i.push(new cd("contentLanguage",null,!0)),i.push(new cd("contentType",null,!0)),i.push(new cd("metadata","customMetadata",!0)),GS=i,GS}function CR(i,n,o){const a=yD(n);return null===a?null:function O6(i,n,o){const a={type:"file"},h=o.length;for(let _=0;_<h;_++){const w=o[_];a[w.local]=w.xform(a,n[w.server])}return function P6(i,n){Object.defineProperty(i,"ref",{get:function o(){const _=new ld(i.bucket,i.fullPath);return n._makeStorageReference(_)}})}(a,i),a}(i,a,o)}class Vy{constructor(n,o,a,h){this.url=n,this.method=o,this.handler=a,this.timeout=h,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function jy(i){if(!i)throw fD()}function hT(i){return function n(o,a){let h;return h=401===o.getStatus()?o.getErrorText().includes("Firebase App Check token is invalid")?function q4(){return new Gs(Ds.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}():function H4(){return new Gs(Ds.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===o.getStatus()?function G4(i){return new Gs(Ds.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(i.bucket):403===o.getStatus()?function Z4(i){return new Gs(Ds.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")}(i.path):a,h.status=o.getStatus(),h.serverResponse=a.serverResponse,h}}function IR(i,n,o,a,h){const _=n.bucketOnlyServerUrl(),w={"X-Goog-Upload-Protocol":"multipart"},L=function S(){let $e="";for(let cn=0;cn<2;cn++)$e+=Math.random().toString().slice(2);return $e}();w["Content-Type"]="multipart/related; boundary="+L;const B=function TR(i,n,o){const a=Object.assign({},o);return a.fullPath=i.path,a.size=n.size(),a.contentType||(a.contentType=function N6(i,n){return i&&i.contentType||n&&n.type()||"application/octet-stream"}(null,n)),a}(n,a,h),H=function vD(i,n){const o={},a=n.length;for(let h=0;h<a;h++){const _=n[h];_.writable&&(o[_.server]=i[_.local])}return JSON.stringify(o)}(B,o),xt=cb.getBlob("--"+L+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+H+"\r\n--"+L+"\r\nContent-Type: "+B.contentType+"\r\n\r\n",a,"\r\n--"+L+"--");if(null===xt)throw function fR(){return new Gs(Ds.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}();const At={name:B.fullPath},Ut=lb(_,i.host,i._protocol),qe=i.maxUploadRetryTime,fn=new Vy(Ut,"POST",function HS(i,n){return function o(a,h){const _=CR(i,h,n);return jy(null!==_),_}}(i,o),qe);return fn.urlParams=At,fn.headers=w,fn.body=xt.uploadData(),fn.errorHandler=hT(n),fn}let AR=null;class V6{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=dT.NO_ERROR,this.sendPromise_=new Promise(n=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=dT.ABORT,n()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=dT.NETWORK_ERROR,n()}),this.xhr_.addEventListener("load",()=>{n()})})}send(n,o,a,h){if(this.sent_)throw wI("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(o,n,!0),void 0!==h)for(const _ in h)h.hasOwnProperty(_)&&this.xhr_.setRequestHeader(_,h[_].toString());return void 0!==a?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw wI("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw wI("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw wI("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw wI("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(n){return this.xhr_.getResponseHeader(n)}addUploadProgressListener(n){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",n)}removeUploadProgressListener(n){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",n)}}class j6 extends V6{initXhr(){this.xhr_.responseType="text"}}function zm(){return AR?AR():new j6}class KM{constructor(n,o){this._service=n,this._location=o instanceof ld?o:ld.makeFromUrl(o,n.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(n,o){return new KM(n,o)}get root(){const n=new ld(this._location.bucket,"");return this._newRef(this._service,n)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return wR(this._location.path)}get storage(){return this._service}get parent(){const n=function x6(i){if(0===i.length)return null;const n=i.lastIndexOf("/");return-1===n?"":i.slice(0,n)}(this._location.path);if(null===n)return null;const o=new ld(this._location.bucket,n);return new KM(this._service,o)}_throwIfRoot(n){if(""===this._location.path)throw function t6(i){return new Gs(Ds.INVALID_ROOT_OPERATION,"The operation '"+i+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(n)}}function ez(i){i._throwIfRoot("getDownloadURL");const n=function k6(i,n,o){const h=lb(n.fullServerUrl(),i.host,i._protocol),w=i.maxOperationRetryTime,S=new Vy(h,"GET",function A6(i,n){return function o(a,h){const _=CR(i,h,n);return jy(null!==_),function E6(i,n,o,a){const h=yD(n);if(null===h||!jS(h.downloadTokens))return null;const _=h.downloadTokens;if(0===_.length)return null;const w=encodeURIComponent;return _.split(",").map(B=>{const Y=i.fullPath;return lb("/b/"+w(i.bucket)+"/o/"+w(Y),o,a)+mR({alt:"media",token:B})})[0]}(_,h,i.host,i._protocol)}}(i,o),w);return S.errorHandler=function MI(i){const n=hT(i);return function o(a,h){let _=n(a,h);return 404===a.getStatus()&&(_=function $4(i){return new Gs(Ds.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")}(i.path)),_.serverResponse=h.serverResponse,_}}(n),S}(i.storage,i._location,CI());return i.storage.makeRequestWithTokens(n,zm).then(o=>{if(null===o)throw function Q4(){return new Gs(Ds.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}();return o})}function NR(i,n){if(i instanceof CD){const o=i;if(null==o._bucket)throw function Y4(){return new Gs(Ds.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+uR+"' property when initializing the app?")}();const a=new KM(o,o._bucket);return null!=n?NR(a,n):a}return void 0!==n?function LR(i,n){const o=function w6(i,n){const o=n.split("/").filter(a=>a.length>0).join("/");return 0===i.length?o:i+"/"+o}(i._location.path,n),a=new ld(i._location.bucket,o);return new KM(i.storage,a)}(i,n):i}function FR(i,n){const o=n?.[uR];return null==o?null:ld.makeFromBucketSpec(o,i)}class CD{constructor(n,o,a,h,_){this.app=n,this._authProvider=o,this._appCheckProvider=a,this._url=h,this._firebaseVersion=_,this._bucket=null,this._host=cR,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=h?ld.makeFromBucketSpec(h,this._host):FR(this._host,this.app.options)}get host(){return this._host}set host(n){this._host=n,this._bucket=null!=this._url?ld.makeFromBucketSpec(this._url,n):FR(n,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(n){mD("time",0,Number.POSITIVE_INFINITY,n),this._maxUploadRetryTime=n}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(n){mD("time",0,Number.POSITIVE_INFINITY,n),this._maxOperationRetryTime=n}_getAuthToken(){var n=this;return(0,Je.Z)(function*(){if(n._overrideAuthToken)return n._overrideAuthToken;const o=n._authProvider.getImmediate({optional:!0});if(o){const a=yield o.getToken();if(null!==a)return a.accessToken}return null})()}_getAppCheckToken(){var n=this;return(0,Je.Z)(function*(){const o=n._appCheckProvider.getImmediate({optional:!0});return o?(yield o.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(n=>n.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(n){return new KM(this,n)}_makeRequest(n,o,a,h,_=!0){if(this._deleted)return new e6(pR());{const w=function h6(i,n,o,a,h,_,w=!0){const S=mR(i.urlParams),L=i.url+S,B=Object.assign({},i.headers);return function u6(i,n){n&&(i["X-Firebase-GMPID"]=n)}(B,n),function l6(i,n){null!==n&&n.length>0&&(i.Authorization="Firebase "+n)}(B,o),function c6(i,n){i["X-Firebase-Storage-Version"]="webjs/"+(n??"AppManager")}(B,_),function d6(i,n){null!==n&&(i["X-Firebase-AppCheck"]=n)}(B,a),new a6(L,i.method,B,i.body,i.successCodes,i.additionalRetryCodes,i.handler,i.errorHandler,i.timeout,i.progressCallback,h,w)}(n,this._appId,a,h,o,this._firebaseVersion,_);return this._requests.add(w),w.getPromise().then(()=>this._requests.delete(w),()=>this._requests.delete(w)),w}}makeRequestWithTokens(n,o){var a=this;return(0,Je.Z)(function*(){const[h,_]=yield Promise.all([a._getAuthToken(),a._getAppCheckToken()]);return a._makeRequest(n,o,h,_).getPromise()})()}}const zR="@firebase/storage",UR="storage";function az(i,n,o){return function DR(i,n,o){i._throwIfRoot("uploadBytes");const a=IR(i.storage,i._location,CI(),new cb(n,!0),o);return i.storage.makeRequestWithTokens(a,zm).then(h=>({metadata:h,ref:i}))}(i=(0,$r.m9)(i),n,o)}function lz(i){return ez(i=(0,$r.m9)(i))}function cz(i,n){return function iz(i,n){if(n&&function rz(i){return/^[A-Za-z]+:\/\//.test(i)}(n)){if(i instanceof CD)return function oz(i,n){return new KM(i,n)}(i,n);throw pD("To use ref(service, url), the first argument must be a Storage instance.")}return NR(i,n)}(i=(0,$r.m9)(i),n)}function uz(i=(0,ts.getApp)(),n){i=(0,$r.m9)(i);const a=(0,ts._getProvider)(i,UR).getImmediate({identifier:n}),h=(0,$r.P0)("storage");return h&&function dz(i,n,o,a={}){!function sz(i,n,o,a={}){i.host=`${n}:${o}`,i._protocol="http";const{mockUserToken:h}=a;h&&(i._overrideAuthToken="string"==typeof h?h:(0,$r.Sg)(h,i.app.options.projectId))}(i,n,o,a)}(a,...h),a}function hz(i,{instanceIdentifier:n}){const o=i.getProvider("app").getImmediate(),a=i.getProvider("auth-internal"),h=i.getProvider("app-check-internal");return new CD(o,a,h,n,ts.SDK_VERSION)}!function fz(){(0,ts._registerComponent)(new Oa.wA(UR,hz,"PUBLIC").setMultipleInstances(!0)),(0,ts.registerVersion)(zR,"0.11.2",""),(0,ts.registerVersion)(zR,"0.11.2","esm2017")}();const yz=(0,Wr.u3)(lz,!0),vz=(0,Wr.u3)(uz,!0),bz=(0,Wr.u3)(cz,!0),xz=(0,Wr.u3)(az,!0);let OD=(()=>{class i{constructor(o){this.firestore=o,this.placesSubject=new zy.x,this.places$=this.placesSubject.asObservable(),this.subscribeToPlacesChanges()}addPlace(o){const a=D2(this.firestore,"places");return BE(a,{...o,image:null})}subscribeToPlacesChanges(){const o=D2(this.firestore,"places");T(o,a=>{const h=[];a.forEach(_=>{const w=_.data(),S={id:_.id,...w};h.push(S)}),this.placesSubject.next(h)})}deletePlace(o){const a=r(this.firestore,`places/${o.id}`);return zM(a)}uploadImage(o){return(0,Je.Z)(function*(){const a=vz(),h=bz(a,`images/${o.name}`);return yield xz(h,o),yield yz(h)})()}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(SM))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function wz(i,n){if(1&i&&(x.TgZ(0,"div")(1,"p"),x._uU(2),x.qZA()()),2&i){const o=x.oxw().$implicit;x.xp6(2),x.hij("Categor\xedas: ",o.categories.join(", "),"")}}function Cz(i,n){1&i&&(x.TgZ(0,"div")(1,"p"),x._uU(2,"Sin categor\xedas"),x.qZA()())}const jR=function(i){return{backgroundImage:i}};function Mz(i,n){if(1&i){const o=x.EpF();x.TgZ(0,"div",4),x.NdJ("click",function(){const _=x.CHM(o).$implicit,w=x.oxw(2);return x.KtG(w.showModal(_))}),x._UZ(1,"div",5),x.TgZ(2,"div",6)(3,"h4"),x._uU(4),x.qZA(),x.TgZ(5,"p"),x._uU(6),x.qZA(),x.YNc(7,wz,3,1,"div",7),x.YNc(8,Cz,3,0,"div",7),x.qZA()()}if(2&i){const o=n.$implicit;x.xp6(1),x.Q6J("ngStyle",x.VKq(5,jR,"url("+o.imageURL+")")),x.xp6(3),x.Oqu(o.name),x.xp6(2),x.Oqu(o.description),x.xp6(1),x.Q6J("ngIf",o.categories&&o.categories.length>0),x.xp6(1),x.Q6J("ngIf",!o.categories||0===o.categories.length)}}function Pz(i,n){if(1&i&&(x.TgZ(0,"div")(1,"h2"),x._uU(2),x.qZA(),x.TgZ(3,"div",2),x.YNc(4,Mz,9,7,"div",3),x.qZA()()),2&i){const o=n.$implicit;x.xp6(2),x.Oqu(o.category),x.xp6(2),x.Q6J("ngForOf",o.places)}}function Oz(i,n){if(1&i){const o=x.EpF();x.TgZ(0,"div",8),x.NdJ("click",function(){x.CHM(o);const h=x.oxw();return x.KtG(h.closeModal())}),x.TgZ(1,"div",9),x.NdJ("click",function(h){x.CHM(o);const _=x.oxw();return x.KtG(_.stopPropagation(h))}),x._UZ(2,"div",10),x.TgZ(3,"h2"),x._uU(4),x.qZA(),x.TgZ(5,"p"),x._uU(6),x.qZA(),x.TgZ(7,"button",11),x.NdJ("click",function(){x.CHM(o);const h=x.oxw();return x.KtG(h.closeModal())}),x._uU(8,"Cerrar"),x.qZA()()()}if(2&i){const o=x.oxw();x.xp6(2),x.Q6J("ngStyle",x.VKq(3,jR,"url("+o.selectedPlace.imageURL+")")),x.xp6(2),x.Oqu(o.selectedPlace.name),x.xp6(2),x.Oqu(o.selectedPlace.description)}}let Ez=(()=>{class i{constructor(o){this.placesService=o,this.isModalOpen=!1,this.categorizedPlaces=[]}ngOnInit(){this.placesService.places$.subscribe(o=>{const a=new Map;o.forEach(h=>{h.categories&&h.categories.forEach(_=>{a.has(_)||a.set(_,[]),a.get(_)?.push(h)})}),this.categorizedPlaces=Array.from(a.entries()).map(([h,_])=>({category:h,places:_.slice(0,5)}))})}showModal(o){this.selectedPlace=o,this.isModalOpen=!0,document.body.style.overflow="hidden"}closeModal(){this.selectedPlace=null,this.isModalOpen=!1,document.body.style.overflow="auto"}stopPropagation(o){o.stopPropagation()}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(OD))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-place-list-user"]],decls:2,vars:2,consts:[[4,"ngFor","ngForOf"],["class","modal",3,"click",4,"ngIf"],[1,"places"],["class","place",3,"click",4,"ngFor","ngForOf"],[1,"place",3,"click"],[1,"image",3,"ngStyle"],[1,"info"],[4,"ngIf"],[1,"modal",3,"click"],[1,"modal-content",3,"click"],[1,"modal-image",3,"ngStyle"],[3,"click"]],template:function(a,h){1&a&&(x.YNc(0,Pz,5,2,"div",0),x.YNc(1,Oz,9,5,"div",1)),2&a&&(x.Q6J("ngForOf",h.categorizedPlaces),x.xp6(1),x.Q6J("ngIf",h.isModalOpen))},dependencies:[Va,ba,lu],styles:[".places[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.place[_ngcontent-%COMP%]{border:1px solid black;border-radius:20px;overflow:hidden;margin-bottom:20px}.place[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{padding:10px 20px}.place[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{background-size:100% auto;background-position:center;width:100%;height:200px}.modal[_ngcontent-%COMP%]{display:flex;position:fixed;top:0;left:15%;width:70%;height:100%;background-color:rgba(0,0,0,);justify-content:center;align-items:center}.modal-content[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:5px;text-align:center}.modal-image[_ngcontent-%COMP%]{width:100%;height:300px;background-size:cover;background-position:center}"]})}return i})(),Tz=(()=>{class i{constructor(o,a){this.authService=o,this.placeService=a,this.searchTerm="",this.places=[]}ngOnInit(){this.getAllPlaces()}ngOnDestroy(){this.placesSubscription&&this.placesSubscription.unsubscribe(),window.removeEventListener("scroll",this.handleScroll)}getAllPlaces(){this.placeService.getPlacesByQuery(),this.placesSubscription=this.placeService.placesChanged.subscribe(o=>{this.places=o})}search(){this.placeService.getPlacesByQuery(this.searchTerm)}logOut(){this.authService.logOut()}ngAfterViewInit(){window.addEventListener("scroll",this.handleScroll)}handleScroll(){const o=document.querySelector("header");window.scrollY>0?o?.classList.add("sticky"):o?.classList.remove("sticky")}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(VS),x.Y36(uT))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-dashboard"]],decls:107,vars:1,consts:[[1,"logoTripTrove"],["href","#",1,"logo","tripTrove"],[1,"user-avatar"],["src","../../../assets/images/usuario.jpg","alt","Usuario"],[1,"search-container"],["type","text","placeholder","Buscar lugares...",3,"ngModel","ngModelChange"],["type","submit",3,"click"],["src","../../../assets/images/searchimagen.png","alt","Buscar"],[1,"sidebar"],["href","#",1,"btn"],["href","/maps",1,"btn"],[1,"sidebar-bottom"],["href","#",1,"btn",3,"click"],["id","divider",1,"header-divider"],[1,"titulito"],[1,"cajita"],["id","myCarousel","data-ride","carousel",1,"carousel","slide"],[1,"carousel-indicators"],["data-target","#myCarousel","data-slide-to","0",1,"active"],["data-target","#myCarousel","data-slide-to","1"],["data-target","#myCarousel","data-slide-to","2"],["data-target","#myCarousel","data-slide-to","3"],[1,"carousel-inner"],[1,"carousel-item","active"],["src","../../../assets/images/principal bosque de chapultepc.jpg","alt","Bosque de Chapultepec"],[1,"textito"],[1,"rating"],[1,"fas","fa-star"],[1,"fas","fa-star-half-alt"],[1,"carousel-item"],["src","../../../assets/images/principal parque la mexicana.jpg","alt","Parque La Mexicana"],["src","../../../assets/images/principal museo soumaya.jpg","alt","Museo Soumaya"],["src","../../../assets/images/principal parque bicentenario.jpg","alt","Parque Bicentenario"],[1,"far","fa-star"],["href","#myCarousel","role","button","data-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"sr-only"],["href","#myCarousel","role","button","data-slide","next",1,"carousel-control-next"],["ariahidden","true",1,"carousel-control-next-icon"],[1,"icon-description"],[1,"bx","bxs-star"]],template:function(a,h){1&a&&(x.TgZ(0,"header")(1,"div",0)(2,"a",1),x._uU(3,"TripTrove"),x.qZA()(),x.TgZ(4,"div",2),x._UZ(5,"img",3),x.qZA(),x.TgZ(6,"div",4)(7,"input",5),x.NdJ("ngModelChange",function(w){return h.searchTerm=w}),x.qZA(),x.TgZ(8,"button",6),x.NdJ("click",function(){return h.search()}),x._UZ(9,"img",7),x.qZA()(),x._UZ(10,"ul"),x.qZA(),x.TgZ(11,"div",8)(12,"ul"),x._UZ(13,"li"),x.TgZ(14,"li")(15,"a",9),x._uU(16,"Inicio"),x.qZA()(),x.TgZ(17,"li")(18,"a",9),x._uU(19,"Viajes"),x.qZA()(),x.TgZ(20,"li")(21,"a",10),x._uU(22,"Mapa"),x.qZA()()(),x.TgZ(23,"div",11)(24,"a",12),x.NdJ("click",function(){return h.logOut()}),x._uU(25,"Cerrar sesion"),x.qZA(),x.TgZ(26,"a",9),x._uU(27,"Configuraci\xf3n de usuario"),x.qZA()()(),x.TgZ(28,"main"),x._UZ(29,"hr",13)(30,"br")(31,"br"),x.TgZ(32,"h2",14),x._uU(33,"Lugares Populares para ti,"),x.qZA(),x.TgZ(34,"div",15)(35,"div",16)(36,"ol",17),x._UZ(37,"li",18)(38,"li",19)(39,"li",20)(40,"li",21),x.qZA(),x.TgZ(41,"div",22)(42,"div",23),x._UZ(43,"img",24),x.TgZ(44,"div",25)(45,"h2"),x._uU(46," BOSQUE DE CHAPULTEPEC"),x.qZA(),x.TgZ(47,"p"),x._uU(48," El bosque de Chapultepec es uno de los lugares m\xe1s emblem\xe1ticos de la Ciudad de M\xe9xico. Es un gran parque urbano con una superficie de m\xe1s de 686 hect\xe1reas, que alberga una gran variedad de flora y fauna. "),x.qZA(),x.TgZ(49,"div",26),x._UZ(50,"i",27)(51,"i",27)(52,"i",27)(53,"i",27)(54,"i",28),x.qZA()()(),x.TgZ(55,"div",29),x._UZ(56,"img",30),x.TgZ(57,"div",25)(58,"h2"),x._uU(59," PARQUE LA MEXICANA"),x.qZA(),x.TgZ(60,"p"),x._uU(61," El parque La Mexicana es un parque urbano ubicado en la delegaci\xf3n Miguel Hidalgo. Es un espacio de recreaci\xf3n y convivencia para los habitantes de la Ciudad de M\xe9xico. "),x.qZA(),x.TgZ(62,"div",26),x._UZ(63,"i",27)(64,"i",27)(65,"i",27)(66,"i",27)(67,"i",27),x.qZA()()(),x.TgZ(68,"div",29),x._UZ(69,"img",31),x.TgZ(70,"div",25)(71,"h2"),x._uU(72," MUSEO SOUMAYA"),x.qZA(),x.TgZ(73,"p"),x._uU(74," El museo Soumaya es un museo de arte ubicado en la Ciudad de M\xe9xico. Alberga una colecci\xf3n de arte mexicano e internacional, que incluye obras de artistas como Miguel \xc1ngel, Leonardo da Vinci, Picasso y Diego Rivera. "),x.qZA(),x.TgZ(75,"div",26),x._UZ(76,"i",27)(77,"i",27)(78,"i",27)(79,"i",27)(80,"i",28),x.qZA()()(),x.TgZ(81,"div",29),x._UZ(82,"img",32),x.TgZ(83,"div",25)(84,"h2"),x._uU(85," PARQUE BICENTENARIO"),x.qZA(),x.TgZ(86,"p"),x._uU(87," El parque Bicentenario es un parque urbano ubicado en la delegaci\xf3n Iztacalco. Fue construido con motivo del bicentenario de la Independencia de M\xe9xico y es un espacio de recreaci\xf3n y cultura para los habitantes de la Ciudad de M\xe9xico. "),x.qZA(),x.TgZ(88,"div",26),x._UZ(89,"i",27)(90,"i",27)(91,"i",28)(92,"i",33)(93,"i",33),x.qZA()()()(),x.TgZ(94,"a",34),x._UZ(95,"span",35),x.TgZ(96,"span",36),x._uU(97,"Anterior"),x.qZA()(),x.TgZ(98,"a",37),x._UZ(99,"span",38),x.TgZ(100,"span",36),x._uU(101,"Siguiente"),x.qZA()()()(),x.TgZ(102,"div",39),x._UZ(103,"i",40),x.TgZ(104,"h2",14),x._uU(105,"Recomendados"),x.qZA(),x._UZ(106,"app-place-list-user"),x.qZA()()),2&a&&(x.xp6(7),x.Q6J("ngModel",h.searchTerm))},dependencies:[Gr,HE,KE,Ez],styles:['*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}#contenedorPopup[_ngcontent-%COMP%]{overflow-y:auto;max-height:400px}.tripTrove[_ngcontent-%COMP%]{color:#000;transition:color .9s}header.sticky[_ngcontent-%COMP%]   .tripTrove[_ngcontent-%COMP%]{color:#fff;text-align:center}.botoncillo[_ngcontent-%COMP%]{border:1px solid #ddd;margin:10px;padding:15px;border-radius:8px;background-color:#f9f9f9;flex:0 1 calc(33.33% - 20px);box-sizing:border-box;cursor:pointer;transition:background-color .3s,filter .3s;text-align:left;height:500px}.botoncillo[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.botoncillo[_ngcontent-%COMP%]:active{background-color:#e0e0e0;filter:brightness(1.2) hue-rotate(30deg)}.botoncillo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;height:auto;border-radius:8px;display:block;margin:0 auto}header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;color:#000;transition:.9s;padding:10px 100px;z-index:100000;font-size:18px}.search-container[_ngcontent-%COMP%]{display:flex;align-items:center;margin-left:auto}.search-container[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{padding:8px;font-size:16px;border:none;background-color:#f9f9f9;border-radius:5px;flex-grow:1;color:#000}.search-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px;background-color:#f9f9f9;border:none;border-radius:5px;cursor:pointer}.search-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:20px}.user-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px;margin-left:450%;border-radius:50%}.header-divider[_ngcontent-%COMP%]{border:none;border-top:1px solid #000000;margin-top:4%;box-shadow:0 2px 4px #0000001a}header.sticky[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:flex;position:center;margin-right:85%;font-weight:700;color:#000;text-decoration:none;font-size:2em;letter-spacing:2px;transition:.6s}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:relative;display:flex;color:#fff;justify-content:flex-end;align-items:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;list-style:none;margin-left:15px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;text-decoration:none;color:#000;letter-spacing:2px;font-weight:500;transition:.5s;overflow:hidden}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;width:120%;height:3px;background-color:#000;z-index:-1;transition:transform .8s;border-radius:5px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{top:0;left:-10%;transform:scaleX(0);transform-origin:right}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{bottom:0;right:-10%;transform:scaleX(0);transform-origin:left}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:center}.logo[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px}.titulito[_ngcontent-%COMP%]{text-align:center;font-size:45px;padding:20px;font-family:Poppins,sans-serif}.cajita[_ngcontent-%COMP%]{width:1200px;height:570px;margin:27px auto 0}.cajita[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;padding:0;width:400%;animation:_ngcontent-%COMP%_slide 20s infinite alternate ease-in-out}.cajita[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{width:100%;list-style:none;position:relative}.textito[_ngcontent-%COMP%]{font-weight:700;position:absolute;text-align:center;align-items:center;padding:0 250px;top:250px;color:#fff;font-family:Poppins,sans-serif}.textito[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700;font-size:30px;margin-bottom:40px;font-family:Poppins,sans-serif}h1[_ngcontent-%COMP%]{padding:31px;font-weight:700;font-size:30px;font-family:Poppins,sans-serif;text-align:center;align-items:center}.cajita[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:1200px;height:570px}@keyframes _ngcontent-%COMP%_slide{0%{margin-left:0}20%{margin-left:0}25%{margin-left:-100%}45%{margin-left:-100%}50%{margin-left:-200%}70%{margin-left:-200%}75%{margin-left:-300%}to{margin-left:-300%}}@media (max-width:991px){body[_ngcontent-%COMP%]{padding:30px}.cajita[_ngcontent-%COMP%]{width:100%}.textito[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif;top:50px;padding:0}.textito[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif;font-size:35px;margin-bottom:15px}.textito[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Arial,Helvetica,sans-serif;font-size:15px}}.scroll[_ngcontent-%COMP%]{position:relative;display:flex;width:700px;overflow:hidden;-webkit-mask-image:linear-gradient(90deg,transparent,#000000 20%,#000000 80%,transparent)}header.sticky[_ngcontent-%COMP%]{background:#000000}header.sticky[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}.scroll[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{white-space:nowrap;animation:_ngcontent-%COMP%_animate var(--t) linear infinite;animation-delay:calc(var(--t) * -1)}.scroll[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:nth-child(2){animation:_ngcontent-%COMP%_animate2 var(--t) linear infinite;animation-delay:calc(var(--t) / -2)}@keyframes _ngcontent-%COMP%_animate{0%{transform:translate(100%)}to{transform:translate(-100%)}}@keyframes _ngcontent-%COMP%_animate2{0%{transform:translate(0)}to{transform:translate(-200%)}}.scroll[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;letter-spacing:.2cm;text-transform:uppercase;margin:10px;background:#222;color:#000;padding:5px 10px;border-radius:5px;transition:.5s}.scroll[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{background:rgb(105,1,224);cursor:pointer}.imgbx[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{scale:.8;filter:grayscale(1);max-height:200px;min-height:200px;max-width:200px;min-width:200px}.imgbx[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{filter:grayscale(0)}.desliza[_ngcontent-%COMP%]{display:flex;min-height:50vh;align-items:center;justify-content:center}#ubicacionesList[_ngcontent-%COMP%]{list-style:none;padding:0;display:flex;flex-wrap:wrap;justify-content:space-around}button[_ngcontent-%COMP%]{border:1px solid #ddd;margin:10px;padding:15px;border-radius:8px;background-color:#f9f9f9;flex:0 1 calc(30% - 20px);box-sizing:border-box;cursor:pointer;transition:background-color .3s;text-align:left}button[_ngcontent-%COMP%]:hover{background-color:#000}button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:300px;max-height:300px;height:auto;border-radius:8px;display:block;margin:0 auto}.icon-description[_ngcontent-%COMP%]{margin:40px 40px 100px;text-align:center}.icon-description[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:50px;color:#000;transition:.7s}.icon-description[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#0059ff;text-shadow:0 0 120px #1900ff}.botoncillo[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;padding:10px 20px;border:none;cursor:pointer;border-radius:5px;margin-bottom:10px}.app-place-list-user[_ngcontent-%COMP%]{display:block;margin:10px auto;padding:15px;border-radius:5px;text-align:center}header[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]{position:fixed;top:0}header[_ngcontent-%COMP%]{width:100%;background-color:#fff;padding:10px 100px;z-index:100000;box-shadow:0 2px 4px #0000001a}.sidebar[_ngcontent-%COMP%]{left:0;width:200px;height:100%;margin-top:80px;background-color:#f9f9f9;border-right:2px solid #000000;padding:20px;margin-right:20px;overflow-y:auto}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;text-decoration:none;color:#000;font-weight:700;font-size:16px;padding:10px 0;border-radius:5px;transition:background-color .3s}.sidebar[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#ddd}.sidebar-bottom[_ngcontent-%COMP%]{position:absolute;bottom:20px;left:20px;width:160px}.main-content[_ngcontent-%COMP%]{margin-left:220px;padding:20px;overflow-y:auto;max-width:calc(100% - 220px);width:calc(100% - 240px)}@media (max-width: 1200px){.main-content[_ngcontent-%COMP%]{margin-left:0}}']})}return i})();function ED(){return ED=Object.assign?Object.assign.bind():function(i){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(i[a]=o[a])}return i},ED.apply(this,arguments)}var Iz={strings:["These are the default values...","You know what you should do?","Use your own!","Have a great day!"],stringsElement:null,typeSpeed:0,startDelay:0,backSpeed:0,smartBackspace:!0,shuffle:!1,backDelay:700,fadeOut:!1,fadeOutClass:"typed-fade-out",fadeOutDelay:500,loop:!1,loopCount:1/0,showCursor:!0,cursorChar:"|",autoInsertCss:!0,attr:null,bindInputFocusEvents:!1,contentType:"html",onBegin:function(i){},onComplete:function(i){},preStringTyped:function(i,n){},onStringTyped:function(i,n){},onLastStringBackspaced:function(i){},onTypingPaused:function(i,n){},onTypingResumed:function(i,n){},onReset:function(i){},onStop:function(i,n){},onStart:function(i,n){},onDestroy:function(i){}},Sz=new(function(){function i(){}var n=i.prototype;return n.load=function(o,a,h){if(o.el="string"==typeof h?document.querySelector(h):h,o.options=ED({},Iz,a),o.isInput="input"===o.el.tagName.toLowerCase(),o.attr=o.options.attr,o.bindInputFocusEvents=o.options.bindInputFocusEvents,o.showCursor=!o.isInput&&o.options.showCursor,o.cursorChar=o.options.cursorChar,o.cursorBlinking=!0,o.elContent=o.attr?o.el.getAttribute(o.attr):o.el.textContent,o.contentType=o.options.contentType,o.typeSpeed=o.options.typeSpeed,o.startDelay=o.options.startDelay,o.backSpeed=o.options.backSpeed,o.smartBackspace=o.options.smartBackspace,o.backDelay=o.options.backDelay,o.fadeOut=o.options.fadeOut,o.fadeOutClass=o.options.fadeOutClass,o.fadeOutDelay=o.options.fadeOutDelay,o.isPaused=!1,o.strings=o.options.strings.map(function(B){return B.trim()}),o.stringsElement="string"==typeof o.options.stringsElement?document.querySelector(o.options.stringsElement):o.options.stringsElement,o.stringsElement){o.strings=[],o.stringsElement.style.cssText="clip: rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;";var _=Array.prototype.slice.apply(o.stringsElement.children),w=_.length;if(w)for(var S=0;S<w;S+=1)o.strings.push(_[S].innerHTML.trim())}for(var L in o.strPos=0,o.currentElContent=this.getCurrentElContent(o),o.currentElContent&&o.currentElContent.length>0&&(o.strPos=o.currentElContent.length-1,o.strings.unshift(o.currentElContent)),o.sequence=[],o.strings)o.sequence[L]=L;o.arrayPos=0,o.stopNum=0,o.loop=o.options.loop,o.loopCount=o.options.loopCount,o.curLoop=0,o.shuffle=o.options.shuffle,o.pause={status:!1,typewrite:!0,curString:"",curStrPos:0},o.typingComplete=!1,o.autoInsertCss=o.options.autoInsertCss,o.autoInsertCss&&(this.appendCursorAnimationCss(o),this.appendFadeOutAnimationCss(o))},n.getCurrentElContent=function(o){return o.attr?o.el.getAttribute(o.attr):o.isInput?o.el.value:"html"===o.contentType?o.el.innerHTML:o.el.textContent},n.appendCursorAnimationCss=function(o){var a="data-typed-js-cursor-css";if(o.showCursor&&!document.querySelector("["+a+"]")){var h=document.createElement("style");h.setAttribute(a,"true"),h.innerHTML="\n        .typed-cursor{\n          opacity: 1;\n        }\n        .typed-cursor.typed-cursor--blink{\n          animation: typedjsBlink 0.7s infinite;\n          -webkit-animation: typedjsBlink 0.7s infinite;\n                  animation: typedjsBlink 0.7s infinite;\n        }\n        @keyframes typedjsBlink{\n          50% { opacity: 0.0; }\n        }\n        @-webkit-keyframes typedjsBlink{\n          0% { opacity: 1; }\n          50% { opacity: 0.0; }\n          100% { opacity: 1; }\n        }\n      ",document.body.appendChild(h)}},n.appendFadeOutAnimationCss=function(o){var a="data-typed-fadeout-js-css";if(o.fadeOut&&!document.querySelector("["+a+"]")){var h=document.createElement("style");h.setAttribute(a,"true"),h.innerHTML="\n        .typed-fade-out{\n          opacity: 0;\n          transition: opacity .25s;\n        }\n        .typed-cursor.typed-cursor--blink.typed-fade-out{\n          -webkit-animation: 0;\n          animation: 0;\n        }\n      ",document.body.appendChild(h)}},i}()),$R=new(function(){function i(){}var n=i.prototype;return n.typeHtmlChars=function(o,a,h){if("html"!==h.contentType)return a;var _=o.substring(a).charAt(0);if("<"===_||"&"===_){var w;for(w="<"===_?">":";";o.substring(a+1).charAt(0)!==w&&!(1+ ++a>o.length););a++}return a},n.backSpaceHtmlChars=function(o,a,h){if("html"!==h.contentType)return a;var _=o.substring(a).charAt(0);if(">"===_||";"===_){var w;for(w=">"===_?"<":"&";o.substring(a-1).charAt(0)!==w&&!(--a<0););a--}return a},i}()),GR=function(){function i(o,a){Sz.load(this,a,o),this.begin()}var n=i.prototype;return n.toggle=function(){this.pause.status?this.start():this.stop()},n.stop=function(){this.typingComplete||this.pause.status||(this.toggleBlinking(!0),this.pause.status=!0,this.options.onStop(this.arrayPos,this))},n.start=function(){this.typingComplete||this.pause.status&&(this.pause.status=!1,this.pause.typewrite?this.typewrite(this.pause.curString,this.pause.curStrPos):this.backspace(this.pause.curString,this.pause.curStrPos),this.options.onStart(this.arrayPos,this))},n.destroy=function(){this.reset(!1),this.options.onDestroy(this)},n.reset=function(o){void 0===o&&(o=!0),clearInterval(this.timeout),this.replaceText(""),this.cursor&&this.cursor.parentNode&&(this.cursor.parentNode.removeChild(this.cursor),this.cursor=null),this.strPos=0,this.arrayPos=0,this.curLoop=0,o&&(this.insertCursor(),this.options.onReset(this),this.begin())},n.begin=function(){var o=this;this.options.onBegin(this),this.typingComplete=!1,this.shuffleStringsIfNeeded(this),this.insertCursor(),this.bindInputFocusEvents&&this.bindFocusEvents(),this.timeout=setTimeout(function(){0===o.strPos?o.typewrite(o.strings[o.sequence[o.arrayPos]],o.strPos):o.backspace(o.strings[o.sequence[o.arrayPos]],o.strPos)},this.startDelay)},n.typewrite=function(o,a){var h=this;this.fadeOut&&this.el.classList.contains(this.fadeOutClass)&&(this.el.classList.remove(this.fadeOutClass),this.cursor&&this.cursor.classList.remove(this.fadeOutClass));var _=this.humanizer(this.typeSpeed),w=1;!0!==this.pause.status?this.timeout=setTimeout(function(){a=$R.typeHtmlChars(o,a,h);var S=0,L=o.substring(a);if("^"===L.charAt(0)&&/^\^\d+/.test(L)){var B=1;B+=(L=/\d+/.exec(L)[0]).length,S=parseInt(L),h.temporaryPause=!0,h.options.onTypingPaused(h.arrayPos,h),o=o.substring(0,a)+o.substring(a+B),h.toggleBlinking(!0)}if("`"===L.charAt(0)){for(;"`"!==o.substring(a+w).charAt(0)&&(w++,!(a+w>o.length)););var H=o.substring(0,a),Y=o.substring(H.length+1,a+w),pt=o.substring(a+w+1);o=H+Y+pt,w--}h.timeout=setTimeout(function(){h.toggleBlinking(!1),a>=o.length?h.doneTyping(o,a):h.keepTyping(o,a,w),h.temporaryPause&&(h.temporaryPause=!1,h.options.onTypingResumed(h.arrayPos,h))},S)},_):this.setPauseStatus(o,a,!0)},n.keepTyping=function(o,a,h){0===a&&(this.toggleBlinking(!1),this.options.preStringTyped(this.arrayPos,this));var _=o.substring(0,a+=h);this.replaceText(_),this.typewrite(o,a)},n.doneTyping=function(o,a){var h=this;this.options.onStringTyped(this.arrayPos,this),this.toggleBlinking(!0),this.arrayPos===this.strings.length-1&&(this.complete(),!1===this.loop||this.curLoop===this.loopCount)||(this.timeout=setTimeout(function(){h.backspace(o,a)},this.backDelay))},n.backspace=function(o,a){var h=this;if(!0!==this.pause.status){if(this.fadeOut)return this.initFadeOut();this.toggleBlinking(!1);var _=this.humanizer(this.backSpeed);this.timeout=setTimeout(function(){a=$R.backSpaceHtmlChars(o,a,h);var w=o.substring(0,a);if(h.replaceText(w),h.smartBackspace){var S=h.strings[h.arrayPos+1];h.stopNum=S&&w===S.substring(0,a)?a:0}a>h.stopNum?(a--,h.backspace(o,a)):a<=h.stopNum&&(h.arrayPos++,h.arrayPos===h.strings.length?(h.arrayPos=0,h.options.onLastStringBackspaced(),h.shuffleStringsIfNeeded(),h.begin()):h.typewrite(h.strings[h.sequence[h.arrayPos]],a))},_)}else this.setPauseStatus(o,a,!1)},n.complete=function(){this.options.onComplete(this),this.loop?this.curLoop++:this.typingComplete=!0},n.setPauseStatus=function(o,a,h){this.pause.typewrite=h,this.pause.curString=o,this.pause.curStrPos=a},n.toggleBlinking=function(o){this.cursor&&(this.pause.status||this.cursorBlinking!==o&&(this.cursorBlinking=o,o?this.cursor.classList.add("typed-cursor--blink"):this.cursor.classList.remove("typed-cursor--blink")))},n.humanizer=function(o){return Math.round(Math.random()*o/2)+o},n.shuffleStringsIfNeeded=function(){this.shuffle&&(this.sequence=this.sequence.sort(function(){return Math.random()-.5}))},n.initFadeOut=function(){var o=this;return this.el.className+=" "+this.fadeOutClass,this.cursor&&(this.cursor.className+=" "+this.fadeOutClass),setTimeout(function(){o.arrayPos++,o.replaceText(""),o.strings.length>o.arrayPos?o.typewrite(o.strings[o.sequence[o.arrayPos]],0):(o.typewrite(o.strings[0],0),o.arrayPos=0)},this.fadeOutDelay)},n.replaceText=function(o){this.attr?this.el.setAttribute(this.attr,o):this.isInput?this.el.value=o:"html"===this.contentType?this.el.innerHTML=o:this.el.textContent=o},n.bindFocusEvents=function(){var o=this;this.isInput&&(this.el.addEventListener("focus",function(a){o.stop()}),this.el.addEventListener("blur",function(a){o.el.value&&0!==o.el.value.length||o.start()}))},n.insertCursor=function(){this.showCursor&&(this.cursor||(this.cursor=document.createElement("span"),this.cursor.className="typed-cursor",this.cursor.setAttribute("aria-hidden",!0),this.cursor.innerHTML=this.cursorChar,this.el.parentNode&&this.el.parentNode.insertBefore(this.cursor,this.el.nextSibling)))},i}();let Az=(()=>{class i{ngOnInit(){this.initTypingEffect()}initTypingEffect(){new GR(".multiText",{strings:["EXPERIENCIAS...  ","LUGARES...  ","CULTURA...  ","M\xc9XICO..."],loop:!0,typeSpeed:190,backSpeed:190,backDelay:3e3})}onScroll(){this.toggleStickyHeader(window.scrollY>0)}toggleStickyHeader(o){const a=document.querySelector("header");a&&a.classList.toggle("sticky",o)}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-home"]],hostBindings:function(a,h){1&a&&x.NdJ("scroll",function(w){return h.onScroll(w)},!1,x.Jf7)},decls:59,vars:0,consts:[[1,"logo"],[1,"nav"],["href","/",1,"active"],["href","/about"],["href","/android"],["href","/associate"],["href","/signIn",1,"login"],[1,"parallax","section2"],[1,"content","audi"],[1,"multiText"],[1,"text-center",2,"background-color","#29a1c6","color","white"],[2,"margin-bottom","-2px","color","white"],[1,"footer-icons","d-flex","justify-content-center"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M11.9694 2C6.46483 2 2 6.58933 2 12.2474C2 16.7739 4.87462 20.6088 8.78899 21.9919C9.27829 22.0547 9.46177 21.7404 9.46177 21.4889C9.46177 21.2375 9.46177 20.6088 9.46177 19.7286C6.70948 20.3573 6.09786 18.3456 6.09786 18.3456C5.66972 17.1511 4.99694 16.8367 4.99694 16.8367C4.07951 16.2081 5.0581 16.2081 5.0581 16.2081C6.0367 16.2709 6.58716 17.2768 6.58716 17.2768C7.50459 18.8485 8.91131 18.4084 9.46177 18.1569C9.52294 17.4654 9.82875 17.0253 10.0734 16.7739C7.87156 16.5224 5.5474 15.6422 5.5474 11.6816C5.5474 10.55 5.91437 9.66984 6.58716 8.91543C6.52599 8.72682 6.15902 7.65808 6.70948 6.27499C6.70948 6.27499 7.56575 6.02352 9.46177 7.34374C10.2569 7.09227 11.1131 7.0294 11.9694 7.0294C12.8257 7.0294 13.682 7.15514 14.4771 7.34374C16.3731 6.02352 17.2294 6.27499 17.2294 6.27499C17.7798 7.65808 17.4128 8.72682 17.3517 8.97829C17.9633 9.66984 18.3914 10.6128 18.3914 11.7445C18.3914 15.7051 16.0673 16.5224 13.8654 16.7739C14.2324 17.0882 14.5382 17.7169 14.5382 18.6599C14.5382 20.043 14.5382 21.1117 14.5382 21.4889C14.5382 21.7404 14.7217 22.0547 15.211 21.9919C19.1865 20.6088 22 16.7739 22 12.2474C21.9388 6.58933 17.474 2 11.9694 2Z","fill","white"],["width","21","height","16","viewBox","0 0 21 16","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M17.789 1.34C16.4296 0.714 14.9761 0.259052 13.4565 0C13.2699 0.332095 13.0519 0.77877 12.9016 1.1341C11.2862 0.894993 9.68567 0.894993 8.10001 1.1341C7.94972 0.77877 7.72674 0.332095 7.53844 0C6.01721 0.259052 4.56204 0.715671 3.20267 1.34331C0.460812 5.42136 -0.28246 9.39811 0.0891771 13.3184C1.90772 14.655 3.67011 15.467 5.40275 15.9984C5.83055 15.4189 6.21209 14.8028 6.54078 14.1536C5.91478 13.9195 5.31521 13.6306 4.74869 13.2952C4.89898 13.1856 5.046 13.071 5.18803 12.9531C8.64342 14.5438 12.3978 14.5438 15.8119 12.9531C15.9556 13.071 16.1026 13.1856 16.2512 13.2952C15.683 13.6322 15.0818 13.9211 14.4558 14.1553C14.7845 14.8028 15.1644 15.4205 15.5939 16C17.3282 15.4687 19.0922 14.6567 20.9107 13.3184C21.3468 8.77378 20.1658 4.83355 17.789 1.34ZM7.01153 10.9075C5.97426 10.9075 5.12361 9.95435 5.12361 8.7937C5.12361 7.63305 5.95609 6.67831 7.01153 6.67831C8.06699 6.67831 8.91761 7.63138 8.89945 8.7937C8.90109 9.95435 8.06699 10.9075 7.01153 10.9075ZM13.9884 10.9075C12.9511 10.9075 12.1005 9.95435 12.1005 8.7937C12.1005 7.63305 12.9329 6.67831 13.9884 6.67831C15.0438 6.67831 15.8945 7.63138 15.8763 8.7937C15.8763 9.95435 15.0438 10.9075 13.9884 10.9075Z","fill","white"],["d","M3.49423 3.75H2.99508L3.29403 4.14973L9.76944 12.8079L3.26917 19.8302L2.88055 20.25H3.45264H4.94748H5.05674L5.13095 20.1698L10.742 14.1081L15.2604 20.1497L15.3354 20.25H15.4606H20.5475H21.0466L20.7477 19.8503L13.9009 10.6956L19.9415 4.16983L20.3301 3.75H19.7581H18.2632H18.154L18.0797 3.83018L12.9286 9.39535L8.78148 3.85027L8.70649 3.75H8.58127H3.49423ZM16.1372 18.6487L6.19179 5.3511H7.90428L17.8497 18.6487H16.1372Z","fill","white","stroke","#566171","stroke-width","0.5"],["width","20px","height","20px","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["clip-path","url(#clip0)"],["d","M13.8576 23.9999V13.0511H17.5296L18.0816 8.78391H13.8576V6.06231C13.8576 4.82871 14.1984 3.98391 15.9744 3.98391H18.24V0.143913C17.1442 0.0366489 16.0434 -0.011421 14.9424 -8.69234e-05C11.6832 -8.69234e-05 9.45121 1.98711 9.45121 5.63991V8.78391H5.76001V13.0511H9.44641V23.9999H13.8576Z","fill","white"],["id","clip0"],["width","24","height","24","fill","white"],["d","M16.1113 4.27729C15.9763 4.20752 15.8449 4.13104 15.7176 4.04813C15.3473 3.80333 15.0078 3.51489 14.7064 3.18901C13.9523 2.32613 13.6706 1.45076 13.5669 0.837875H13.571C13.4844 0.32915 13.5202 0 13.5256 0H10.0908V13.2818C10.0908 13.4602 10.0908 13.6364 10.0833 13.8106C10.0833 13.8322 10.0812 13.8522 10.08 13.8756C10.08 13.8851 10.08 13.8951 10.0779 13.9051C10.0779 13.9076 10.0779 13.9101 10.0779 13.9126C10.0417 14.3892 9.88891 14.8495 9.63303 15.2532C9.37715 15.6568 9.026 15.9914 8.61046 16.2275C8.17737 16.4739 7.68754 16.6032 7.18928 16.6025C5.58894 16.6025 4.29192 15.2976 4.29192 13.686C4.29192 12.0744 5.58894 10.7695 7.18928 10.7695C7.49221 10.7692 7.79328 10.8169 8.08132 10.9107L8.08548 7.41338C7.21109 7.30043 6.32279 7.36992 5.4766 7.61747C4.63041 7.86502 3.84471 8.28524 3.16906 8.85164C2.57703 9.36603 2.07931 9.97979 1.6983 10.6653C1.55331 10.9153 1.00625 11.9198 0.940004 13.5502C0.898339 14.4755 1.17624 15.4342 1.30874 15.8305V15.8388C1.39206 16.0721 1.71497 16.8683 2.24119 17.5395C2.66552 18.078 3.16685 18.5509 3.72903 18.9432V18.9349L3.73736 18.9432C5.4002 20.0732 7.24386 19.999 7.24386 19.999C7.56301 19.9861 8.63212 19.999 9.84623 19.4236C11.1928 18.7857 11.9595 17.8354 11.9595 17.8354C12.4492 17.2675 12.8387 16.6204 13.1111 15.9217C13.4219 15.1047 13.5256 14.1247 13.5256 13.7331V6.68675C13.5673 6.71175 14.1223 7.07881 14.1223 7.07881C14.1223 7.07881 14.9218 7.59129 16.1692 7.92502C17.0642 8.16251 18.27 8.21251 18.27 8.21251V4.80268C17.8475 4.84851 16.9896 4.71518 16.1113 4.27729Z","fill","white"],["d","M11.9968 7.9983C9.79333 7.9983 7.99515 9.79651 7.99515 12C7.99515 14.2035 9.79333 16.0017 11.9968 16.0017C14.2002 16.0017 15.9984 14.2035 15.9984 12C15.9984 9.79651 14.2002 7.9983 11.9968 7.9983ZM23.9987 12C23.9987 10.3429 24.0137 8.70077 23.9206 7.04665C23.8275 5.12536 23.3893 3.4202 21.9843 2.01525C20.5764 0.607302 18.8743 0.172008 16.953 0.0789456C15.2959 -0.0141173 13.6539 0.000892936 11.9998 0.000892936C10.3427 0.000892936 8.70061 -0.0141173 7.04652 0.0789456C5.12526 0.172008 3.42014 0.610305 2.01522 2.01525C0.607291 3.42321 0.172005 5.12536 0.0789442 7.04665C-0.014117 8.70377 0.000892919 10.3459 0.000892919 12C0.000892919 13.6541 -0.014117 15.2992 0.0789442 16.9533C0.172005 18.8746 0.610293 20.5798 2.01522 21.9847C3.42314 23.3927 5.12526 23.828 7.04652 23.9211C8.70361 24.0141 10.3457 23.9991 11.9998 23.9991C13.6569 23.9991 15.2989 24.0141 16.953 23.9211C18.8743 23.828 20.5794 23.3897 21.9843 21.9847C23.3923 20.5768 23.8275 18.8746 23.9206 16.9533C24.0167 15.2992 23.9987 13.6571 23.9987 12ZM11.9968 18.1572C8.58954 18.1572 5.83973 15.4073 5.83973 12C5.83973 8.5927 8.58954 5.84284 11.9968 5.84284C15.404 5.84284 18.1538 8.5927 18.1538 12C18.1538 15.4073 15.404 18.1572 11.9968 18.1572ZM18.406 7.02864C17.6105 7.02864 16.968 6.38621 16.968 5.59067C16.968 4.79513 17.6105 4.1527 18.406 4.1527C19.2015 4.1527 19.8439 4.79513 19.8439 5.59067C19.8442 5.77957 19.8071 5.96667 19.735 6.14124C19.6628 6.31581 19.5569 6.47442 19.4233 6.608C19.2897 6.74157 19.1311 6.84748 18.9565 6.91967C18.782 6.99185 18.5949 7.02888 18.406 7.02864Z","fill","white"],["href","#",2,"color","white"]],template:function(a,h){1&a&&(x.TgZ(0,"header")(1,"a",0),x._uU(2,"TripTrove"),x.qZA(),x.TgZ(3,"ul",1)(4,"li")(5,"a",2),x._uU(6,"INICIO"),x.qZA()(),x.TgZ(7,"li")(8,"a",3),x._uU(9,"ACERCA DE"),x.qZA()(),x.TgZ(10,"li")(11,"a",4),x._uU(12,"ANDROID"),x.qZA()(),x.TgZ(13,"li")(14,"a",5),x._uU(15,"ASOCIATE"),x.qZA()()(),x.TgZ(16,"a",6),x._uU(17,"INGRESAR"),x.qZA()(),x.TgZ(18,"body")(19,"div",7)(20,"h1"),x._uU(21,"TU GU\xcdA VIAJERO"),x.qZA(),x.TgZ(22,"div",8)(23,"h2"),x._uU(24,"DESCUBRE "),x._UZ(25,"br")(26,"span",9),x.qZA()()()(),x.TgZ(27,"footer",10)(28,"p",11),x._uU(29,"All Rights Reserved \xa9 TripTrove"),x.qZA(),x.TgZ(30,"div",12)(31,"div"),x.O4$(),x.TgZ(32,"svg",13),x._UZ(33,"path",14),x.qZA()(),x.kcU(),x.TgZ(34,"div"),x.O4$(),x.TgZ(35,"svg",15),x._UZ(36,"path",16),x.qZA()(),x.kcU(),x.TgZ(37,"div"),x.O4$(),x.TgZ(38,"svg",13),x._UZ(39,"path",17),x.qZA()(),x.TgZ(40,"svg",18)(41,"g",19),x._UZ(42,"path",20),x.qZA(),x.TgZ(43,"defs")(44,"clipPath",21),x._UZ(45,"rect",22),x.qZA()()(),x.kcU(),x.TgZ(46,"div"),x.O4$(),x.TgZ(47,"svg",18),x._UZ(48,"path",23),x.qZA()(),x.kcU(),x.TgZ(49,"div"),x.O4$(),x.TgZ(50,"svg",18),x._UZ(51,"path",24),x.qZA()()(),x.kcU(),x.TgZ(52,"div")(53,"a",25),x._uU(54,"Terms"),x.qZA(),x.TgZ(55,"a",25),x._uU(56,"Privacy"),x.qZA(),x.TgZ(57,"a",25),x._uU(58,"Security"),x.qZA()()())},styles:['@import"https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap";*[_ngcontent-%COMP%]{box-sizing:border-box;font-family:Poppins,sans-serif;color:#000;text-decoration:none}header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;transition:.9s;padding:40px 100px;z-index:100000;font-size:18px}header.sticky[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]{color:#fff}header.sticky[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(2) a{color:#fff}header.sticky[_ngcontent-%COMP%]{padding:5px 100px;background:#29a1c6}header.sticky[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:relative;font-weight:700;color:#000;text-decoration:none;font-size:2em;letter-spacing:2px;transition:.6s}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;list-style:none}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;margin:0 15px;text-decoration:none;color:#000;letter-spacing:2px;font-weight:500;transition:.5s;overflow:hidden}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;width:120%;height:3px;background-color:#000;z-index:-1;transition:transform .8s;border-radius:5px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{top:0;left:-10%;transform:scaleX(0);transform-origin:right}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{bottom:0;right:-10%;transform:scaleX(0);transform-origin:left}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{font-weight:700;font-size:120%}.parallax[_ngcontent-%COMP%]{background-attachment:fixed;background-position:center;background-size:cover;width:100%;height:100vh}.parallax.section2[_ngcontent-%COMP%]{background-image:url(principal\\ 1.8aeacd85a0e89648.jpg);align-content:center;text-align:left;background-attachment:fixed;background-position:center;background-size:cover;width:100%;height:100vh;display:flex;align-items:center;justify-content:center;text-align:center}.parallax.section2[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:100px;color:#000}.audi[_ngcontent-%COMP%]{text-align:left;justify-content:center}.content.audi[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#000;font-size:35px}.multiText[_ngcontent-%COMP%]{font-size:35px}footer[_ngcontent-%COMP%]{background-color:#29a1c6;color:#fff;text-align:center;padding:20px 0;margin-top:0;width:100%;display:flex;justify-content:space-evenly;align-items:center;box-sizing:border-box}footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin:0 10px}footer[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;margin-right:5px}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 20px 0 0}']})}return i})();const ZS=(i,n)=>{const o=(0,x.f3M)(VS),a=(0,x.f3M)(ru);return o.isLoggedIn||a.navigate(["login"]),!0};let Dz=(()=>{class i{ngOnInit(){this.initTypingEffect()}initTypingEffect(){new GR(".multiText",{strings:["EXPERIENCIAS...  ","LUGARES...  ","CULTURA...  ","M\xc9XICO..."],loop:!0,typeSpeed:190,backSpeed:190,backDelay:3e3})}onScroll(){this.toggleStickyHeader(window.scrollY>0)}toggleStickyHeader(o){const a=document.querySelector("header");a&&a.classList.toggle("sticky",o)}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-about"]],hostBindings:function(a,h){1&a&&x.NdJ("scroll",function(w){return h.onScroll(w)},!1,x.Jf7)},decls:85,vars:0,consts:[["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],["href","https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css","rel","stylesheet"],[1,"logo"],[1,"nav"],["href","/"],["href","/about",1,"active"],["href","/android"],["href","/associate"],["href","/signIn",1,"login"],[1,"parallax","section1"],[1,"parallax-overlay"],[1,"black-section"],[1,"image-block1"],["src","../../assets/images/acercade bloque.jpg","alt","no leer !!!!",1,"image"],[1,"text-block1"],[1,"black-section2"],[1,"text-block2"],[1,"image-block2"],["src","../../assets/images/barquitos.jpg","alt","me gusta lula",1,"image"],[1,"black-section3"],[1,"image-block3"],["src","../../assets/images/acercade ciudad.jpg","alt","apoco chi",1,"image"],[1,"text-block3"],[1,"text-center",2,"background-color","#29a1c6","color","white"],[2,"margin-bottom","-2px","color","white"],[1,"footer-icons","d-flex","justify-content-center"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M11.9694 2C6.46483 2 2 6.58933 2 12.2474C2 16.7739 4.87462 20.6088 8.78899 21.9919C9.27829 22.0547 9.46177 21.7404 9.46177 21.4889C9.46177 21.2375 9.46177 20.6088 9.46177 19.7286C6.70948 20.3573 6.09786 18.3456 6.09786 18.3456C5.66972 17.1511 4.99694 16.8367 4.99694 16.8367C4.07951 16.2081 5.0581 16.2081 5.0581 16.2081C6.0367 16.2709 6.58716 17.2768 6.58716 17.2768C7.50459 18.8485 8.91131 18.4084 9.46177 18.1569C9.52294 17.4654 9.82875 17.0253 10.0734 16.7739C7.87156 16.5224 5.5474 15.6422 5.5474 11.6816C5.5474 10.55 5.91437 9.66984 6.58716 8.91543C6.52599 8.72682 6.15902 7.65808 6.70948 6.27499C6.70948 6.27499 7.56575 6.02352 9.46177 7.34374C10.2569 7.09227 11.1131 7.0294 11.9694 7.0294C12.8257 7.0294 13.682 7.15514 14.4771 7.34374C16.3731 6.02352 17.2294 6.27499 17.2294 6.27499C17.7798 7.65808 17.4128 8.72682 17.3517 8.97829C17.9633 9.66984 18.3914 10.6128 18.3914 11.7445C18.3914 15.7051 16.0673 16.5224 13.8654 16.7739C14.2324 17.0882 14.5382 17.7169 14.5382 18.6599C14.5382 20.043 14.5382 21.1117 14.5382 21.4889C14.5382 21.7404 14.7217 22.0547 15.211 21.9919C19.1865 20.6088 22 16.7739 22 12.2474C21.9388 6.58933 17.474 2 11.9694 2Z","fill","white"],["width","21","height","16","viewBox","0 0 21 16","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M17.789 1.34C16.4296 0.714 14.9761 0.259052 13.4565 0C13.2699 0.332095 13.0519 0.77877 12.9016 1.1341C11.2862 0.894993 9.68567 0.894993 8.10001 1.1341C7.94972 0.77877 7.72674 0.332095 7.53844 0C6.01721 0.259052 4.56204 0.715671 3.20267 1.34331C0.460812 5.42136 -0.28246 9.39811 0.0891771 13.3184C1.90772 14.655 3.67011 15.467 5.40275 15.9984C5.83055 15.4189 6.21209 14.8028 6.54078 14.1536C5.91478 13.9195 5.31521 13.6306 4.74869 13.2952C4.89898 13.1856 5.046 13.071 5.18803 12.9531C8.64342 14.5438 12.3978 14.5438 15.8119 12.9531C15.9556 13.071 16.1026 13.1856 16.2512 13.2952C15.683 13.6322 15.0818 13.9211 14.4558 14.1553C14.7845 14.8028 15.1644 15.4205 15.5939 16C17.3282 15.4687 19.0922 14.6567 20.9107 13.3184C21.3468 8.77378 20.1658 4.83355 17.789 1.34ZM7.01153 10.9075C5.97426 10.9075 5.12361 9.95435 5.12361 8.7937C5.12361 7.63305 5.95609 6.67831 7.01153 6.67831C8.06699 6.67831 8.91761 7.63138 8.89945 8.7937C8.90109 9.95435 8.06699 10.9075 7.01153 10.9075ZM13.9884 10.9075C12.9511 10.9075 12.1005 9.95435 12.1005 8.7937C12.1005 7.63305 12.9329 6.67831 13.9884 6.67831C15.0438 6.67831 15.8945 7.63138 15.8763 8.7937C15.8763 9.95435 15.0438 10.9075 13.9884 10.9075Z","fill","white"],["d","M3.49423 3.75H2.99508L3.29403 4.14973L9.76944 12.8079L3.26917 19.8302L2.88055 20.25H3.45264H4.94748H5.05674L5.13095 20.1698L10.742 14.1081L15.2604 20.1497L15.3354 20.25H15.4606H20.5475H21.0466L20.7477 19.8503L13.9009 10.6956L19.9415 4.16983L20.3301 3.75H19.7581H18.2632H18.154L18.0797 3.83018L12.9286 9.39535L8.78148 3.85027L8.70649 3.75H8.58127H3.49423ZM16.1372 18.6487L6.19179 5.3511H7.90428L17.8497 18.6487H16.1372Z","fill","white","stroke","#566171","stroke-width","0.5"],["width","20px","height","20px","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["clip-path","url(#clip0)"],["d","M13.8576 23.9999V13.0511H17.5296L18.0816 8.78391H13.8576V6.06231C13.8576 4.82871 14.1984 3.98391 15.9744 3.98391H18.24V0.143913C17.1442 0.0366489 16.0434 -0.011421 14.9424 -8.69234e-05C11.6832 -8.69234e-05 9.45121 1.98711 9.45121 5.63991V8.78391H5.76001V13.0511H9.44641V23.9999H13.8576Z","fill","white"],["id","clip0"],["width","24","height","24","fill","white"],["d","M16.1113 4.27729C15.9763 4.20752 15.8449 4.13104 15.7176 4.04813C15.3473 3.80333 15.0078 3.51489 14.7064 3.18901C13.9523 2.32613 13.6706 1.45076 13.5669 0.837875H13.571C13.4844 0.32915 13.5202 0 13.5256 0H10.0908V13.2818C10.0908 13.4602 10.0908 13.6364 10.0833 13.8106C10.0833 13.8322 10.0812 13.8522 10.08 13.8756C10.08 13.8851 10.08 13.8951 10.0779 13.9051C10.0779 13.9076 10.0779 13.9101 10.0779 13.9126C10.0417 14.3892 9.88891 14.8495 9.63303 15.2532C9.37715 15.6568 9.026 15.9914 8.61046 16.2275C8.17737 16.4739 7.68754 16.6032 7.18928 16.6025C5.58894 16.6025 4.29192 15.2976 4.29192 13.686C4.29192 12.0744 5.58894 10.7695 7.18928 10.7695C7.49221 10.7692 7.79328 10.8169 8.08132 10.9107L8.08548 7.41338C7.21109 7.30043 6.32279 7.36992 5.4766 7.61747C4.63041 7.86502 3.84471 8.28524 3.16906 8.85164C2.57703 9.36603 2.07931 9.97979 1.6983 10.6653C1.55331 10.9153 1.00625 11.9198 0.940004 13.5502C0.898339 14.4755 1.17624 15.4342 1.30874 15.8305V15.8388C1.39206 16.0721 1.71497 16.8683 2.24119 17.5395C2.66552 18.078 3.16685 18.5509 3.72903 18.9432V18.9349L3.73736 18.9432C5.4002 20.0732 7.24386 19.999 7.24386 19.999C7.56301 19.9861 8.63212 19.999 9.84623 19.4236C11.1928 18.7857 11.9595 17.8354 11.9595 17.8354C12.4492 17.2675 12.8387 16.6204 13.1111 15.9217C13.4219 15.1047 13.5256 14.1247 13.5256 13.7331V6.68675C13.5673 6.71175 14.1223 7.07881 14.1223 7.07881C14.1223 7.07881 14.9218 7.59129 16.1692 7.92502C17.0642 8.16251 18.27 8.21251 18.27 8.21251V4.80268C17.8475 4.84851 16.9896 4.71518 16.1113 4.27729Z","fill","white"],["d","M11.9968 7.9983C9.79333 7.9983 7.99515 9.79651 7.99515 12C7.99515 14.2035 9.79333 16.0017 11.9968 16.0017C14.2002 16.0017 15.9984 14.2035 15.9984 12C15.9984 9.79651 14.2002 7.9983 11.9968 7.9983ZM23.9987 12C23.9987 10.3429 24.0137 8.70077 23.9206 7.04665C23.8275 5.12536 23.3893 3.4202 21.9843 2.01525C20.5764 0.607302 18.8743 0.172008 16.953 0.0789456C15.2959 -0.0141173 13.6539 0.000892936 11.9998 0.000892936C10.3427 0.000892936 8.70061 -0.0141173 7.04652 0.0789456C5.12526 0.172008 3.42014 0.610305 2.01522 2.01525C0.607291 3.42321 0.172005 5.12536 0.0789442 7.04665C-0.014117 8.70377 0.000892919 10.3459 0.000892919 12C0.000892919 13.6541 -0.014117 15.2992 0.0789442 16.9533C0.172005 18.8746 0.610293 20.5798 2.01522 21.9847C3.42314 23.3927 5.12526 23.828 7.04652 23.9211C8.70361 24.0141 10.3457 23.9991 11.9998 23.9991C13.6569 23.9991 15.2989 24.0141 16.953 23.9211C18.8743 23.828 20.5794 23.3897 21.9843 21.9847C23.3923 20.5768 23.8275 18.8746 23.9206 16.9533C24.0167 15.2992 23.9987 13.6571 23.9987 12ZM11.9968 18.1572C8.58954 18.1572 5.83973 15.4073 5.83973 12C5.83973 8.5927 8.58954 5.84284 11.9968 5.84284C15.404 5.84284 18.1538 8.5927 18.1538 12C18.1538 15.4073 15.404 18.1572 11.9968 18.1572ZM18.406 7.02864C17.6105 7.02864 16.968 6.38621 16.968 5.59067C16.968 4.79513 17.6105 4.1527 18.406 4.1527C19.2015 4.1527 19.8439 4.79513 19.8439 5.59067C19.8442 5.77957 19.8071 5.96667 19.735 6.14124C19.6628 6.31581 19.5569 6.47442 19.4233 6.608C19.2897 6.74157 19.1311 6.84748 18.9565 6.91967C18.782 6.99185 18.5949 7.02888 18.406 7.02864Z","fill","white"],["href","#",2,"color","white"]],template:function(a,h){1&a&&(x.TgZ(0,"head"),x._UZ(1,"meta",0)(2,"meta",1)(3,"link",2),x.qZA(),x.TgZ(4,"header")(5,"a",3),x._uU(6,"TripTrove"),x.qZA(),x.TgZ(7,"ul",4)(8,"li")(9,"a",5),x._uU(10,"INICIO"),x.qZA()(),x.TgZ(11,"li")(12,"a",6),x._uU(13,"ACERCA DE"),x.qZA()(),x.TgZ(14,"li")(15,"a",7),x._uU(16,"ANDROID"),x.qZA()(),x.TgZ(17,"li")(18,"a",8),x._uU(19,"ASOCIATE"),x.qZA()()(),x.TgZ(20,"a",9),x._uU(21,"INGRESAR"),x.qZA()(),x.TgZ(22,"body")(23,"div",10)(24,"div",11)(25,"h1"),x._uU(26,"\xa1Descubre la belleza de la Ciudad de M\xe9xico!"),x.qZA(),x.TgZ(27,"p"),x._uU(28,"Los lugares que siempre quisiste est\xe1n aqu\xed, ven y encuentra tu lugar favorito con la ayuda de nuestra aplicaci\xf3n."),x.qZA()()(),x.TgZ(29,"div",12)(30,"div",13),x._UZ(31,"img",14),x.qZA(),x.TgZ(32,"div",15)(33,"h2"),x._uU(34,"Descubre la Belleza y la Importancia del Turismo en la Ciudad de M\xe9xico"),x.qZA(),x.TgZ(35,"p"),x._uU(36,"La Ciudad de M\xe9xico, conocida como la CDMX, es un destino \xfanico con una rica historia desde la civilizaci\xf3n azteca hasta la arquitectura colonial. La ciudad es un museo al aire libre llena de maravillas art\xedsticas y culinarias, desde los murales de Diego Rivera hasta la deliciosa comida mexicana. Adem\xe1s, la CDMX ofrece belleza natural con canales y volcanes. Descubre la historia, cultura y diversidad de esta ciudad impresionante."),x.qZA()()(),x.TgZ(37,"div",16)(38,"div",17)(39,"h2"),x._uU(40,"Nuestro Aporte a el Turismo"),x.qZA(),x.TgZ(41,"p"),x._uU(42,"En Myxitech buscamos fomentar el turismo, la economia y la cultura, es por eso que apasionados por nuestro entorno, creamos Trip Trove, nuestro primer proyecto el cual busca hacer mas facil, claro y mucho mas personal un viaje para todo aquel interesado en visitar la m\xe1gica Ciudad de M\xe9xico"),x.qZA()(),x.TgZ(43,"div",18),x._UZ(44,"img",19),x.qZA()(),x.TgZ(45,"div",20)(46,"div",21),x._UZ(47,"img",22),x.qZA(),x.TgZ(48,"div",23)(49,"h2"),x._uU(50,"El viaje que siempre quisiste"),x.qZA(),x.TgZ(51,"p"),x._uU(52,"En Trip Trove contamos con todas las herramientas que buscas para organizar tu viaje so\xf1ado, consideramos todos los aspectos posibles desde el momento en el que quieres elegir el lugar, transportarte por la ciudad y llegar a tu destino"),x.qZA()()(),x.TgZ(53,"footer",24)(54,"p",25),x._uU(55,"All Rights Reserved \xa9 TripTrove"),x.qZA(),x.TgZ(56,"div",26)(57,"div"),x.O4$(),x.TgZ(58,"svg",27),x._UZ(59,"path",28),x.qZA()(),x.kcU(),x.TgZ(60,"div"),x.O4$(),x.TgZ(61,"svg",29),x._UZ(62,"path",30),x.qZA()(),x.kcU(),x.TgZ(63,"div"),x.O4$(),x.TgZ(64,"svg",27),x._UZ(65,"path",31),x.qZA()(),x.TgZ(66,"svg",32)(67,"g",33),x._UZ(68,"path",34),x.qZA(),x.TgZ(69,"defs")(70,"clipPath",35),x._UZ(71,"rect",36),x.qZA()()(),x.kcU(),x.TgZ(72,"div"),x.O4$(),x.TgZ(73,"svg",32),x._UZ(74,"path",37),x.qZA()(),x.kcU(),x.TgZ(75,"div"),x.O4$(),x.TgZ(76,"svg",32),x._UZ(77,"path",38),x.qZA()()(),x.kcU(),x.TgZ(78,"div")(79,"a",39),x._uU(80,"Terms"),x.qZA(),x.TgZ(81,"a",39),x._uU(82,"Privacy"),x.qZA(),x.TgZ(83,"a",39),x._uU(84,"Security"),x.qZA()()()())},styles:['@import"https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap";*[_ngcontent-%COMP%]{box-sizing:border-box;font-family:Poppins,sans-serif;color:#f7f7f7;text-decoration:none}header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;transition:.9s;padding:40px 100px;z-index:100000;font-size:18px}header[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]{transition:.6s;color:#000}header.sticky[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]{transition:transform .8s;color:#fff;transition:.6s}header.sticky[_ngcontent-%COMP%]{padding:5px 100px;background:#29a1c6}header.sticky[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:relative;font-weight:700;color:#000;text-decoration:none;font-size:2em;letter-spacing:2px;transition:.6s}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;list-style:none}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;margin:0 15px;text-decoration:none;color:#000;letter-spacing:2px;font-weight:500;transition:.5s;overflow:hidden}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;width:120%;height:3px;z-index:-1;transition:transform .8s;border-radius:5px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{top:0;left:-10%;transform:scaleX(0);transform-origin:right}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{bottom:0;right:-10%;transform:scaleX(0);transform-origin:left}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{font-weight:700;font-size:120%}.page-container[_ngcontent-%COMP%]{position:relative}.parallax.section1[_ngcontent-%COMP%]{position:relative;background-image:url(fondito.f1ed9f7ac83a71e1.jpg);background-attachment:fixed;background-position:center;background-size:cover;height:92vh}.parallax.section1[_ngcontent-%COMP%]   .parallax-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:40%;height:50vh;background-color:#0000003b;z-index:2;display:flex;flex-direction:column;justify-content:center;align-items:center;border-radius:20px;padding:60px;margin-top:160px;margin-left:30px;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px)}.parallax.section1[_ngcontent-%COMP%]   .parallax-overlay[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .parallax.section1[_ngcontent-%COMP%]   .parallax-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff;text-align:center}.black-section[_ngcontent-%COMP%]{display:flex;background-color:#000;color:#fff;padding:50px;align-items:center}.image-block1[_ngcontent-%COMP%]{flex:1;padding:20px;position:relative}.image-block1[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(transparent,black);mix-blend-mode:overlay}.image-block1[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:86%;border-radius:6%}.text-block1[_ngcontent-%COMP%]{flex:2;padding:20px}.text-block1[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:55px;margin-bottom:20px;text-align:justify}.text-block1[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:17.5px;text-align:justify}.black-section2[_ngcontent-%COMP%]{display:flex;background-color:#000;color:#fff;padding:50px;align-items:center}.image-block2[_ngcontent-%COMP%]{flex:1;padding:20px;position:relative}.image-block2[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(transparent,black);mix-blend-mode:overlay}.image-block2[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;border-radius:6%}.text-block2[_ngcontent-%COMP%]{flex:2;padding:20px}.text-block2[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:53px;margin-bottom:20px}.text-block2[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:17px;text-align:justify}.black-section3[_ngcontent-%COMP%]{display:flex;background-color:#000;color:#fff;padding:50px;align-items:center}.image-block3[_ngcontent-%COMP%]{flex:1;padding:20px;position:relative}.image-block3[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:100%;height:100%;background:radial-gradient(transparent,black);mix-blend-mode:overlay}.image-block3[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;border-radius:6%}.text-block3[_ngcontent-%COMP%]{flex:2;padding:20px}.text-block3[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:53px;margin-bottom:20px}.text-block3[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:17.5px;text-align:justify}.contact-section[_ngcontent-%COMP%]{background-color:#202020;color:#fff;padding:50px;text-align:center;height:30vh}.company-info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;text-align:left;flex-wrap:wrap}.company-info[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:200px;margin-right:35px;border-radius:7px;margin-bottom:10px}.text-info[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]{flex:1;max-width:60%}.team-member[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]{margin-top:5px;margin-left:65px}.team-member[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;margin-bottom:10px}.team-member[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;margin-bottom:8px}.team-member[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}footer[_ngcontent-%COMP%]{color:#fff;text-align:center;padding:20px 0;margin-top:0;width:100%;display:flex;justify-content:space-evenly;align-items:center;box-sizing:border-box}footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin:0 10px}footer[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;margin-right:5px}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 20px 0 0}']})}return i})();const kz=["mapDiv"];let Rz=(()=>{class i{constructor(o,a){this.placesService=o,this.mapService=a}ngAfterViewInit(){if(!this.placesService.userLocation)throw Error("No hat placesServices.location");const o=new(lR().Map)({container:this.mapDivElement.nativeElement,style:"mapbox://styles/nahumlopz/cltkmkcn601oz01qu0d6bh18e",center:this.placesService.userLocation,zoom:14,pitch:30,maxBounds:[[-99.3269,19.1056],[-98.5636,19.7039]]}),a=(new ab.Popup).setHTML("<h6>Aqui Estoy</h6><br><span>Estoy en este lugar del mundo</span>");new ab.Marker({color:"red"}).setLngLat(this.placesService.userLocation).setPopup(a).addTo(o),this.mapService.setMap(o),(new ab.Popup).setHTML("<h6>")}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(uT),x.Y36(bI))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-map-view"]],viewQuery:function(a,h){if(1&a&&x.Gf(kz,5),2&a){let _;x.iGM(_=x.CRH())&&(h.mapDivElement=_.first)}},decls:2,vars:0,consts:[[1,"map-container"],["mapDiv",""]],template:function(a,h){1&a&&x._UZ(0,"div",0,1)},styles:[".map-container[_ngcontent-%COMP%]{position:fixed;top:0;right:0;width:100%;height:100%;background-color:#fff}"]})}return i})(),Lz=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-loading"]],decls:6,vars:0,consts:[[1,"loading-map","d-flex","justify-content-center","align-items-center"],[1,"text-center"]],template:function(a,h){1&a&&(x.TgZ(0,"div",0)(1,"div",1)(2,"h3"),x._uU(3," Espere por favor "),x.qZA(),x.TgZ(4,"span"),x._uU(5,"Localizando..."),x.qZA()()())},styles:[".loading-map[_ngcontent-%COMP%]{background-color:#000c;color:#fff;height:100vh;position:fixed;right:0;top:0;width:100vw}"]})}return i})(),Nz=(()=>{class i{constructor(o,a){this.mapService=o,this.placesServices=a}goToMyLocation(){if(!this.placesServices.isUserLocationReady)throw Error("No hay ubicacion de usuario");if(!this.mapService.isMapReady)throw Error("No hay mapa disponible");this.mapService.flyTo(this.placesServices.userLocation)}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(bI),x.Y36(uT))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-btn-my-location"]],decls:2,vars:0,consts:[[1,"btn","btn-primary",3,"click"]],template:function(a,h){1&a&&(x.TgZ(0,"button",0),x.NdJ("click",function(){return h.goToMyLocation()}),x._uU(1," Mi ubicacion\n"),x.qZA())},styles:["button[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;z-index:inherit;padding:10px 15px;font-size:16px;border:2px solid #4CAF50;border-radius:5px;background-color:#4caf50;color:#fff;cursor:pointer;outline:none}button[_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:focus{background-color:#45a049}"]})}return i})();function Fz(i,n){if(1&i){const o=x.EpF();x.TgZ(0,"li",10),x.NdJ("click",function(){const _=x.CHM(o).$implicit,w=x.oxw(2);return x.KtG(w.flyto(_))}),x.TgZ(1,"h6"),x._uU(2),x.qZA(),x.TgZ(3,"p"),x._uU(4),x.qZA(),x.TgZ(5,"button",11),x.NdJ("click",function(){const _=x.CHM(o).$implicit,w=x.oxw(2);return x.KtG(w.getDirections(w.transport,_))}),x._uU(6," Direcciones "),x.qZA()()}if(2&i){const o=n.$implicit,a=x.oxw(2);x.ekj("active",o.id===a.selectedId),x.xp6(2),x.Oqu(o.text_es),x.xp6(2),x.Oqu(o.place_name),x.xp6(1),x.Q6J("ngClass",o.id===a.selectedId?"btn-outline-light":"btn-outline-primary")}}function zz(i,n){if(1&i&&(x.TgZ(0,"ul",8),x.YNc(1,Fz,7,5,"li",9),x.qZA()),2&i){const o=x.oxw();x.xp6(1),x.Q6J("ngForOf",o.places)}}let Bz=(()=>{class i{constructor(o,a){this.placesServices=o,this.mapService=a,this.transport="walking",this.selectedId=""}get isLodingPlaces(){return this.placesServices.isLoadingPlaces}get places(){return this.placesServices.places}getDirections(o,a){if(!this.placesServices.userLocation)throw Error("No hay userLocation");this.placesServices.upPlaces(),this.mapService.getRouteBetweenPoints(o,this.placesServices.userLocation,a.center)}flyto(o){this.selectedId=o.id;const[a,h]=o.center;this.mapService.flyTo({lng:a,lat:h})}updateTransport(o){this.transport=o}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(uT),x.Y36(bI))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-search-results"]],decls:13,vars:4,consts:[["class","list-group mt-2",4,"ngIf"],[1,"form-check"],["type","checkbox","id","driving-traffic",1,"form-check-input",3,"checked","change"],["for","driving-traffic",1,"form-check-label"],["type","checkbox","id","walking",1,"form-check-input",3,"checked","change"],["for","walking",1,"form-check-label"],["type","checkbox","id","cycling",1,"form-check-input",3,"checked","change"],["for","cycling",1,"form-check-label"],[1,"list-group","mt-2"],["class","list-group-item list-group-item pointer active",3,"active","click",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item","pointer","active",3,"click"],[1,"btn","btn-sm",3,"ngClass","click"]],template:function(a,h){1&a&&(x.YNc(0,zz,2,1,"ul",0),x.TgZ(1,"div",1)(2,"input",2),x.NdJ("change",function(){return h.updateTransport("driving-traffic")}),x.qZA(),x.TgZ(3,"label",3),x._uU(4,"Driving"),x.qZA()(),x.TgZ(5,"div",1)(6,"input",4),x.NdJ("change",function(){return h.updateTransport("walking")}),x.qZA(),x.TgZ(7,"label",5),x._uU(8,"Walking"),x.qZA()(),x.TgZ(9,"div",1)(10,"input",6),x.NdJ("change",function(){return h.updateTransport("cycling")}),x.qZA(),x.TgZ(11,"label",7),x._uU(12,"Cycling"),x.qZA()()),2&a&&(x.Q6J("ngIf",h.places.length>0),x.xp6(2),x.Q6J("checked","driving-traffic"===h.transport),x.xp6(4),x.Q6J("checked","walking"===h.transport),x.xp6(4),x.Q6J("checked","cycling"===h.transport))},dependencies:[su,Va,ba],styles:[".pointer[_ngcontent-%COMP%]{cursor:pointer}p[_ngcontent-%COMP%]{font-size:12px}"]})}return i})(),Uz=(()=>{class i{constructor(o){this.placesService=o,this.searchTabOpen=!0}onQueryChanged(o=""){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.placesService.getPlacesByQuery(o)},350)}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(uT))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-search-bar"]],decls:4,vars:0,consts:[[1,"search-container"],["type","text","placeholder","Buscar lugar...",1,"form-control",3,"keyup"],["txtQuery",""]],template:function(a,h){if(1&a){const _=x.EpF();x.TgZ(0,"div",0)(1,"input",1,2),x.NdJ("keyup",function(){x.CHM(_);const S=x.MAs(2);return x.KtG(h.onQueryChanged(S.value))}),x.qZA(),x._UZ(3,"app-search-results"),x.qZA()}},dependencies:[Bz],styles:[".search-container[_ngcontent-%COMP%]{position:fixed;top:20px;left:20px;width:250px;background-color:#fff;padding:5px;box-shadow:0 10px 10px #0000001a;border-radius:5px;border:1px solid rgb(0,0,0,.1)}"]})}return i})(),Vz=(()=>{class i{constructor(o){this.mapService=o,this.selectedTime=""}onTimeSelectionChange(o){this.mapService.distancePolyline(this.selectedTime)}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(bI))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-ubication-range"]],decls:11,vars:1,consts:[["for","tiempoCombo"],["id","tiempoCombo",3,"ngModel","ngModelChange","change"],["value","","disabled","","selected",""],["value","15"],["value","30"],["value","60"]],template:function(a,h){1&a&&(x.TgZ(0,"label",0),x._uU(1,"Selecciona un tiempo:"),x.qZA(),x.TgZ(2,"select",1),x.NdJ("ngModelChange",function(w){return h.selectedTime=w})("change",function(){return h.onTimeSelectionChange(h.selectedTime)}),x.TgZ(3,"option",2),x._uU(4,"Selecciona un tiempo"),x.qZA(),x.TgZ(5,"option",3),x._uU(6,"15 minutos"),x.qZA(),x.TgZ(7,"option",4),x._uU(8,"30 minutos"),x.qZA(),x.TgZ(9,"option",5),x._uU(10,"60 minutos"),x.qZA()()),2&a&&(x.xp6(2),x.Q6J("ngModel",h.selectedTime))},dependencies:[wk,Mk,_S,HE,KE],styles:["select[_ngcontent-%COMP%]{position:fixed;top:20px;right:170px;z-index:inherit;padding:10px;font-size:16px;border:2px solid #ccc;border-radius:5px;background-color:#fff;color:#333;cursor:pointer;outline:none}select[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:focus{border-color:#66afe9}"]})}return i})();function jz(i,n){if(1&i&&(x.TgZ(0,"p"),x._uU(1),x.qZA()),2&i){const o=x.oxw();x.xp6(1),x.Oqu(o.message)}}function $z(i,n){1&i&&(x.TgZ(0,"p"),x._uU(1,"\xa1La informaci\xf3n del recorrido est\xe1 lista!"),x.qZA())}function Gz(i,n){if(1&i&&(x.TgZ(0,"div",14)(1,"p"),x._uU(2),x.qZA(),x.TgZ(3,"p"),x._uU(4),x.qZA(),x.TgZ(5,"p"),x._uU(6),x.qZA(),x.TgZ(7,"p"),x._uU(8),x.qZA(),x.YNc(9,$z,2,0,"p",8),x.qZA()),2&i){const o=n.$implicit;x.xp6(2),x.Oqu(o.ubicacion),x.xp6(2),x.Oqu(o.hora),x.xp6(2),x.Oqu(o.tiempo_recorrido),x.xp6(2),x.Oqu(o.costo),x.xp6(1),x.Q6J("ngIf","ok"===o.estado)}}const HR=function(i){return{collapsed:i}},dw=function(i){return{active:i}};let Hz=(()=>{class i{toggleSidebar(){throw new Error("Method not implemented.")}constructor(o){this.http=o,this.temas=[],this.routeInfoArray=[],this.isCollapsed=!1,this.message=""}toggleTema(o){const a=this.temas.indexOf(o);a>-1?this.temas.splice(a,1):this.temas.push(o)}submitForm(){navigator.geolocation.getCurrentPosition(o=>{const a=o.coords.latitude,h=o.coords.longitude;this.temas.forEach(_=>{this.http.get(`http://localhost:5000/museos_cercanos?lat=${a}&lon=${h}&tema=${_}`).subscribe(S=>{this.routeInfoArray.push(S),this.message="\xa1La solicitud se proces\xf3 correctamente!",console.log("Response from Flask server:",S)},S=>{this.message="Ocurri\xf3 un error al procesar la solicitud",console.error("Error occurred:",S)})})},o=>{console.error("Error occurred while getting current position:",o),this.message="No se pudo obtener la ubicaci\xf3n actual del usuario"})}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(tI))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-generate-results-bard"]],decls:43,vars:32,consts:[["id","sidebar",3,"ngClass"],["id","sidebar-content"],[3,"submit"],[1,"form-section"],["id","theme-buttons",1,"theme-buttons"],["type","button",1,"theme-btn",3,"ngClass","click"],[1,"material-icons"],["type","submit",1,"submit-btn"],[4,"ngIf"],["id","content"],[1,"content-section",3,"ngClass"],["class","result-container",4,"ngFor","ngForOf"],["id","toggle-btn",3,"click"],[1,"fas","fa-bars"],[1,"result-container"]],template:function(a,h){1&a&&(x.TgZ(0,"div",0)(1,"div",1)(2,"h2"),x._uU(3,"Rutas, generadas para ti."),x.qZA(),x.TgZ(4,"form",2),x.NdJ("submit",function(){return h.submitForm()}),x.TgZ(5,"label"),x._uU(6,"Tema:"),x.qZA(),x.TgZ(7,"div",3)(8,"div",4)(9,"button",5),x.NdJ("click",function(){return h.toggleTema("arte")}),x.TgZ(10,"span",6),x._uU(11,"brush"),x.qZA()(),x.TgZ(12,"button",5),x.NdJ("click",function(){return h.toggleTema("ciencia")}),x.TgZ(13,"span",6),x._uU(14,"science"),x.qZA()(),x.TgZ(15,"button",5),x.NdJ("click",function(){return h.toggleTema("historia")}),x.TgZ(16,"span",6),x._uU(17,"account_balance"),x.qZA()(),x.TgZ(18,"button",5),x.NdJ("click",function(){return h.toggleTema("tecnolog\xeda")}),x.TgZ(19,"span",6),x._uU(20,"computer"),x.qZA()(),x.TgZ(21,"button",5),x.NdJ("click",function(){return h.toggleTema("hoteles")}),x.TgZ(22,"span",6),x._uU(23,"hotel"),x.qZA()(),x.TgZ(24,"button",5),x.NdJ("click",function(){return h.toggleTema("arqueolog\xeda")}),x.TgZ(25,"span",6),x._uU(26,"public"),x.qZA()(),x.TgZ(27,"button",5),x.NdJ("click",function(){return h.toggleTema("comida")}),x.TgZ(28,"span",6),x._uU(29,"restaurant"),x.qZA()(),x.TgZ(30,"button",5),x.NdJ("click",function(){return h.toggleTema("antropolog\xeda")}),x.TgZ(31,"span",6),x._uU(32,"emoji_people"),x.qZA()()()(),x.TgZ(33,"button",7),x._uU(34,"Generar Recorrido"),x.qZA()(),x.YNc(35,jz,2,1,"p",8),x.qZA(),x.TgZ(36,"div",9)(37,"div",10)(38,"h2"),x._uU(39,"Contenido Principal"),x.qZA(),x.YNc(40,Gz,10,5,"div",11),x.qZA()()(),x.TgZ(41,"button",12),x.NdJ("click",function(){return h.toggleSidebar()}),x._UZ(42,"i",13),x.qZA()),2&a&&(x.Q6J("ngClass",x.VKq(12,HR,h.isCollapsed)),x.xp6(9),x.Q6J("ngClass",x.VKq(14,dw,h.temas.includes("arte"))),x.xp6(3),x.Q6J("ngClass",x.VKq(16,dw,h.temas.includes("ciencia"))),x.xp6(3),x.Q6J("ngClass",x.VKq(18,dw,h.temas.includes("historia"))),x.xp6(3),x.Q6J("ngClass",x.VKq(20,dw,h.temas.includes("tecnolog\xeda"))),x.xp6(3),x.Q6J("ngClass",x.VKq(22,dw,h.temas.includes("hoteles"))),x.xp6(3),x.Q6J("ngClass",x.VKq(24,dw,h.temas.includes("arqueolog\xeda"))),x.xp6(3),x.Q6J("ngClass",x.VKq(26,dw,h.temas.includes("comida"))),x.xp6(3),x.Q6J("ngClass",x.VKq(28,dw,h.temas.includes("antropolog\xeda"))),x.xp6(5),x.Q6J("ngIf",h.message),x.xp6(2),x.Q6J("ngClass",x.VKq(30,HR,h.isCollapsed)),x.xp6(3),x.Q6J("ngForOf",h.routeInfoArray))},dependencies:[su,Va,ba,K2,$2,WE],styles:["body[_ngcontent-%COMP%]{margin:0;padding:0;font-family:Arial,sans-serif;background-color:#f1f1f1;position:relative}#sidebar[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:300px;height:100%;background:linear-gradient(to right,rgba(255,255,255,.95),rgba(255,255,255,0));z-index:1;transition:width .3s ease;padding-top:20px}.form-section[_ngcontent-%COMP%]{display:flex;width:500px;align-items:center;justify-content:space-between;background-color:#f9f9f9;padding:10px;border:1px solid #ccc;border-radius:5px;margin-top:20px}.theme-buttons[_ngcontent-%COMP%]{display:flex;gap:10px}.theme-btn[_ngcontent-%COMP%]{border:none;background:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:background-color .3s,box-shadow .3s;padding:10px;box-shadow:0 2px 4px #0000001a}.theme-btn[_ngcontent-%COMP%]:hover, .theme-btn.active[_ngcontent-%COMP%]{background-color:#ff9800;color:#fff;box-shadow:0 4px 8px #0003}.material-icons[_ngcontent-%COMP%]{font-size:24px;color:#333;transition:color .3s}.theme-btn.active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%], .theme-btn[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%]{color:#fff}#sidebar.collapsed[_ngcontent-%COMP%]{width:0;overflow:hidden}#sidebar-content[_ngcontent-%COMP%]{padding:20px;transition:padding .3s ease}#sidebar.collapsed[_ngcontent-%COMP%]   #sidebar-content[_ngcontent-%COMP%]{padding:0}#content[_ngcontent-%COMP%]{margin-left:25px;min-width:300px;padding:20px;transition:margin-left .3s ease}#content.collapsed[_ngcontent-%COMP%]{margin-left:0}.content-section[_ngcontent-%COMP%]{background-color:#fff;padding:20px;max-width:500px;margin-bottom:20px;border-radius:5px;box-shadow:0 0 10px #0000001a}#toggle-btn[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;cursor:pointer;padding:5px;background-color:transparent;color:#333;border:none;border-radius:3px;z-index:2;transition:left .3s ease}#sidebar.collapsed[_ngcontent-%COMP%]   #toggle-btn[_ngcontent-%COMP%]{left:10px}@media only screen and (max-width: 768px){#sidebar[_ngcontent-%COMP%]{width:200px}#content[_ngcontent-%COMP%]{margin-left:200px}#sidebar.collapsed[_ngcontent-%COMP%]{width:0}#content.collapsed[_ngcontent-%COMP%]{margin-left:0}}"]})}return i})();function qz(i,n){1&i&&x._UZ(0,"app-loading")}function Zz(i,n){1&i&&x._UZ(0,"app-map-view")(1,"app-generate-results-bard")(2,"app-btn-my-location")(3,"app-search-bar")(4,"app-ubication-range")}let Wz=(()=>{class i{constructor(o){this.placesService=o}get isUserLocationReady(){return this.placesService.isUserLocationReady}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(uT))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-map-screen"]],decls:4,vars:2,consts:[[4,"ngIf","ngIfElse"],["mapReady",""]],template:function(a,h){if(1&a&&(x.YNc(0,qz,1,0,"app-loading",0),x.YNc(1,Zz,5,0,"ng-template",null,1,x.W1O),x._UZ(3,"app-ubication-range")),2&a){const _=x.MAs(2);x.Q6J("ngIf",!h.isUserLocationReady)("ngIfElse",_)}},dependencies:[ba,Rz,Lz,Nz,Uz,Vz,Hz]})}return i})();function Kz(i,n){if(1&i&&(x.TgZ(0,"div")(1,"p"),x._uU(2),x.qZA()()),2&i){const o=x.oxw().$implicit;x.xp6(2),x.hij("Categor\xedas: ",o.categories.join(", "),"")}}function Yz(i,n){if(1&i){const o=x.EpF();x.TgZ(0,"div",2)(1,"div",3)(2,"h4"),x._uU(3),x.qZA(),x.TgZ(4,"p"),x._uU(5),x.qZA(),x.TgZ(6,"p"),x._uU(7),x.qZA(),x.YNc(8,Kz,3,1,"div",4),x.TgZ(9,"button",5),x.NdJ("click",function(){const _=x.CHM(o).$implicit,w=x.oxw();return x.KtG(w.onClickDelete(_))}),x._uU(10,"Borrar"),x.qZA()()()}if(2&i){const o=n.$implicit;x.xp6(3),x.Oqu(o.name),x.xp6(2),x.Oqu(o.description),x.xp6(2),x.AsE("Coordenadas: ",o.latitude," / ",o.longitude,""),x.xp6(1),x.Q6J("ngIf",o.categories&&o.categories.length>0)}}let Xz=(()=>{class i{constructor(o){this.placesService=o}ngOnInit(){this.placesService.places$.subscribe(o=>{this.places=o})}onClickDelete(o){var a=this;return(0,Je.Z)(function*(){const h=yield a.placesService.deletePlace(o);console.log(h)})()}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(OD))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-place-list"]],decls:2,vars:1,consts:[[1,"places"],["class","place",4,"ngFor","ngForOf"],[1,"place"],[1,"info"],[4,"ngIf"],[1,"btn","btn-outline-danger",3,"click"]],template:function(a,h){1&a&&(x.TgZ(0,"div",0),x.YNc(1,Yz,11,5,"div",1),x.qZA()),2&a&&(x.xp6(1),x.Q6J("ngForOf",h.places))},dependencies:[Va,ba],styles:[".place[_ngcontent-%COMP%]{border:1px solid black;border-radius:20px;display:grid;grid-template-columns:1fr 3fr;overflow:hidden;margin-bottom:20px}.place[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{padding:10px 20px}.place[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{background-size:cover;background-position:center}"]})}return i})();function Qz(i,n){if(1&i){const o=x.EpF();x.TgZ(0,"div")(1,"div",10)(2,"input",11),x.NdJ("change",function(){const _=x.CHM(o).$implicit,w=x.oxw();return x.KtG(w.toggleCategory(_))}),x.qZA(),x._uU(3),x.qZA()()}if(2&i){const o=n.$implicit,a=x.oxw();x.xp6(2),x.Q6J("checked",a.formulario.value.categories.includes(o)),x.xp6(1),x.hij(" ",o," ")}}let Jz=(()=>{class i{constructor(o){this.placesService=o,this.categories=["cultural","historia","familiar","naturaleza","parques","museos","diversion"],this.formulario=new ZE({name:new Rm,latitude:new Rm,longitude:new Rm,description:new Rm,image:new Rm(null),categories:new kA([])}),alert(this.categories)}ngOnInit(){}toggleCategory(o){const a=this.formulario.get("categories"),h=a.value.indexOf(o);-1!==h?a.removeAt(h):a.push(new Rm(o))}onImageSelected(o){this.formulario.patchValue({image:o.target.files[0]})}onSubmit(){var o=this;return(0,Je.Z)(function*(){const a=o.formulario.value;if(a.image){const _=yield o.placesService.uploadImage(a.image);a.imageURL=_}const h=yield o.placesService.addPlace(a);console.log(h)})()}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(OD))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-new-place"]],decls:26,vars:2,consts:[[3,"formGroup","ngSubmit"],[1,"mb-3"],[1,"form-label"],["type","text","formControlName","name",1,"form-control"],["cols","30","rows","10","formControlName","description",1,"form-control"],["type","text","formControlName","latitude",1,"form-control"],["type","text","formControlName","longitude",1,"form-control"],["type","file","accept","image/*",1,"form-control",3,"change"],[4,"ngFor","ngForOf"],["type","submit","value","Enviar",1,"btn","btn-info"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"checked","change"]],template:function(a,h){1&a&&(x.TgZ(0,"form",0),x.NdJ("ngSubmit",function(){return h.onSubmit()}),x.TgZ(1,"div",1)(2,"label",2),x._uU(3,"Name"),x.qZA(),x._UZ(4,"input",3),x.qZA(),x.TgZ(5,"div",1)(6,"label",2),x._uU(7,"Description"),x.qZA(),x._UZ(8,"textarea",4),x.qZA(),x.TgZ(9,"div",1)(10,"label",2),x._uU(11,"Latitude"),x.qZA(),x._UZ(12,"input",5),x.qZA(),x.TgZ(13,"div",1)(14,"label",2),x._uU(15,"Longitude"),x.qZA(),x._UZ(16,"input",6),x.qZA(),x.TgZ(17,"div",1)(18,"label",2),x._uU(19,"Image"),x.qZA(),x.TgZ(20,"input",7),x.NdJ("change",function(w){return h.onImageSelected(w)}),x.qZA()(),x.TgZ(21,"div",1)(22,"label",2),x._uU(23,"Categories"),x.qZA(),x.YNc(24,Qz,4,2,"div",8),x.qZA(),x._UZ(25,"input",9),x.qZA()),2&a&&(x.Q6J("formGroup",h.formulario),x.xp6(24),x.Q6J("ngForOf",h.categories))},dependencies:[K2,Gr,HE,$2,mS,AA,Va]})}return i})(),tB=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-screen-upload-location"]],decls:5,vars:0,consts:[[1,"form"],[1,"list"]],template:function(a,h){1&a&&(x.TgZ(0,"main")(1,"section",0),x._UZ(2,"app-new-place"),x.qZA(),x.TgZ(3,"section",1),x._UZ(4,"app-place-list"),x.qZA()())},dependencies:[Xz,Jz],styles:["main[_ngcontent-%COMP%]{max-width:1000px;margin:20px auto;display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;gap:40px}"]})}return i})();const eB=[{path:"",component:Az},{path:"signIn",component:L4},{path:"signUp",component:N4},{path:"about",component:Dz},{path:"association",component:(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-asociate"]],decls:98,vars:0,consts:[["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"logo"],[1,"nav"],["href","/about"],["href","/download"],["href","/association"],["href","/SingIn",1,"login"],[1,"hero"],[1,"container"],["action","#"],[1,"search-bar"],["type","text","placeholder","What? Ex: Paice, Resturent, Food, Automobile"],["type","text","placeholder","Location Ex: London, Newyoric Rome"],["type","submit"],[1,"categories"],["href","#"],[1,"featured"],[1,"listings"],[1,"listing"],["src","images/listing1.jpg","alt","Listing 1"],["src","images/listing2.jpg","alt","Listing 2"],["src","images/listing3.jpg","alt","Listing 3"]],template:function(a,h){1&a&&(x.TgZ(0,"head"),x._UZ(1,"meta",0)(2,"meta",1),x.TgZ(3,"title"),x._uU(4,"ListRace"),x.qZA()(),x.TgZ(5,"body")(6,"header")(7,"a",2),x._uU(8,"TripTrove"),x.qZA(),x.TgZ(9,"ul",3)(10,"li")(11,"a",4),x._uU(12,"ACERCA DE"),x.qZA()(),x.TgZ(13,"li")(14,"a",5),x._uU(15,"ANDROID"),x.qZA()(),x.TgZ(16,"li")(17,"a",6),x._uU(18,"ASOCIATE"),x.qZA()()(),x.TgZ(19,"a",7),x._uU(20,"INGRESAR"),x.qZA()(),x.TgZ(21,"section",8)(22,"div",9)(23,"h2"),x._uU(24,"BEST PLACE TO FIND AND EXPLORE"),x._UZ(25,"br"),x._uU(26,"THAT ALL YOU NEED"),x.qZA(),x.TgZ(27,"p"),x._uU(28,"Find Best Place, Restaurant, Hotel, Real State and many more think in just One click"),x.qZA(),x.TgZ(29,"form",10)(30,"div",11),x._UZ(31,"input",12)(32,"input",13),x.TgZ(33,"button",14),x._uU(34,"Search"),x.qZA()()()()(),x.TgZ(35,"section",15)(36,"div",9)(37,"h2"),x._uU(38,"Categories"),x.qZA(),x.TgZ(39,"ul")(40,"li")(41,"a",16),x._uU(42,"Restaurants"),x.qZA()(),x.TgZ(43,"li")(44,"a",16),x._uU(45,"Hotels"),x.qZA()(),x.TgZ(46,"li")(47,"a",16),x._uU(48,"Real Estate"),x.qZA()(),x.TgZ(49,"li")(50,"a",16),x._uU(51,"Attractions"),x.qZA()(),x.TgZ(52,"li")(53,"a",16),x._uU(54,"Shopping"),x.qZA()(),x.TgZ(55,"li")(56,"a",16),x._uU(57,"More"),x.qZA()()()()(),x.TgZ(58,"section",17)(59,"div",9)(60,"h2"),x._uU(61,"Featured Listings"),x.qZA(),x.TgZ(62,"div",18)(63,"div",19),x._UZ(64,"img",20),x.TgZ(65,"h3"),x._uU(66,"Listing Title 1"),x.qZA(),x.TgZ(67,"p"),x._uU(68,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed semper enim vitae leo pulvinar, sit amet tincidunt ipsum pharetra."),x.qZA(),x.TgZ(69,"a",16),x._uU(70,"View Listing"),x.qZA()(),x.TgZ(71,"div",19),x._UZ(72,"img",21),x.TgZ(73,"h3"),x._uU(74,"Listing Title 2"),x.qZA(),x.TgZ(75,"p"),x._uU(76,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed semper enim vitae leo pulvinar, sit amet tincidunt ipsum pharetra."),x.qZA(),x.TgZ(77,"a",16),x._uU(78,"View Listing"),x.qZA()(),x.TgZ(79,"div",19),x._UZ(80,"img",22),x.TgZ(81,"h3"),x._uU(82,"Listing Title 3"),x.qZA(),x.TgZ(83,"p"),x._uU(84,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed semper enim vitae leo pulvinar, sit amet tincidunt ipsum pharetra."),x.qZA(),x.TgZ(85,"a",16),x._uU(86,"View Listing"),x.qZA()()()()(),x.TgZ(87,"footer")(88,"div",9)(89,"p"),x._uU(90,"\xa9 2024 ListRace"),x.qZA(),x.TgZ(91,"ul")(92,"li")(93,"a",16),x._uU(94,"Terms of Service"),x.qZA()(),x.TgZ(95,"li")(96,"a",16),x._uU(97,"Privacy Policy"),x.qZA()()()()()())},dependencies:[K2,$2,WE],styles:['body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;margin:100px 0 0;padding:0}.container[_ngcontent-%COMP%]{width:90%;margin:0 auto}header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;transition:.9s;padding:40px 100px;z-index:100000;font-size:18px}header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;background-color:transparent;transition:background-color .5s ease}header.scrolled[_ngcontent-%COMP%]{background-color:#000}header.scrolled[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], header.scrolled[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}header.sticky[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]{color:#fff}header.sticky[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(2) a{color:#fff}header.sticky[_ngcontent-%COMP%]{padding:5px 100px;background:#000000}header.sticky[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:relative;font-weight:700;color:#000;text-decoration:none;font-size:2em;letter-spacing:2px;transition:.6s}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;list-style:none}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;margin:0 15px;text-decoration:none;color:#000;letter-spacing:2px;font-weight:500;transition:.5s;overflow:hidden}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;width:120%;height:3px;background-color:#000;z-index:-1;transition:transform .8s;border-radius:5px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{top:0;left:-10%;transform:scaleX(0);transform-origin:right}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{bottom:0;right:-10%;transform:scaleX(0);transform-origin:left}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:center}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0;list-style:none;text-align:right}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline;margin-left:20px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none}.hero[_ngcontent-%COMP%]{background-color:#f2f2f2;padding:50px 0;text-align:center}.hero[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.search-bar[_ngcontent-%COMP%]{margin-top:20px}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:40%;padding:10px;margin-right:10px;border:1px solid #ccc;border-radius:5px}.search-bar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#333;color:#fff;border:none;border-radius:5px;cursor:pointer}.categories[_ngcontent-%COMP%]{background-color:#fff;padding:50px 0}.categories[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.categories[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0;list-style:none}.categories[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:10px}.categories[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#333}.featured[_ngcontent-%COMP%]{padding:50px 0}.featured[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.listings[_ngcontent-%COMP%]{display:flex;justify-content:space-between;flex-wrap:wrap}.listing[_ngcontent-%COMP%]{width:30%;margin-bottom:30px}.listing[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;border-radius:5px}.listing[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:10px 0}.listing[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666}.listing[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;background-color:#333;color:#fff;text-decoration:none;border-radius:5px}footer[_ngcontent-%COMP%]{background-color:#333;color:#fff;padding:20px 0;text-align:center}footer[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0;list-style:none}footer[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline;margin-right:20px}footer[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none}']})}return i})()},{path:"maps",component:Wz,canActivate:[ZS]},{path:"dashboard",component:Tz,canActivate:[ZS]},{path:"admin-place",component:(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-admin-place"]],decls:26,vars:0,consts:[[1,"container-fluid"],[1,"row"],[1,"navbar","navbar-expand","navbar-light","bg-light","w-100"],[1,"container"],["href","#",1,"navbar-brand"],["type","button","data-toggle","collapse","data-target","#navbarNav","aria-controls","navbarNav","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNav",1,"collapse","navbar-collapse"],[1,"navbar-nav","ml-auto"],[1,"nav-item"],["href","#",1,"nav-link"],[1,"nav-item","dropdown"],["href","#","id","navbarDropdown","role","button","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"nav-link","dropdown-toggle"],["src","url_de_la_imagen_del_usuario","alt","Usuario","width","30","height","30",1,"rounded-circle"],["aria-labelledby","navbarDropdown",1,"dropdown-menu"],["href","#",1,"dropdown-item"],[1,"dropdown-divider"],["role","main",1,"col-md-10","ml-sm-auto","col-lg-10","px-md-4"]],template:function(a,h){1&a&&(x.TgZ(0,"div",0)(1,"div",1)(2,"nav",2)(3,"div",3)(4,"a",4),x._uU(5,"Admin Place"),x.qZA(),x.TgZ(6,"button",5),x._UZ(7,"span",6),x.qZA(),x.TgZ(8,"div",7)(9,"ul",8)(10,"li",9)(11,"a",10),x._uU(12,"Nuevo Correo"),x.qZA()(),x.TgZ(13,"li",11)(14,"a",12),x._UZ(15,"img",13),x.qZA(),x.TgZ(16,"div",14)(17,"a",15),x._uU(18,"Perfil"),x.qZA(),x.TgZ(19,"a",15),x._uU(20,"Configuraci\xf3n"),x.qZA(),x._UZ(21,"div",16),x.TgZ(22,"a",15),x._uU(23,"Cerrar sesi\xf3n"),x.qZA()()()()()()(),x.TgZ(24,"main",17),x._UZ(25,"app-screen-upload-location"),x.qZA()()())},dependencies:[tB],styles:["@charset \"UTF-8\";\n\n\n\n\n[_ngcontent-%COMP%]:root, [data-bs-theme=light][_ngcontent-%COMP%]{--bs-blue:#0d6efd;--bs-indigo:#6610f2;--bs-purple:#6f42c1;--bs-pink:#d63384;--bs-red:#dc3545;--bs-orange:#fd7e14;--bs-yellow:#ffc107;--bs-green:#198754;--bs-teal:#20c997;--bs-cyan:#0dcaf0;--bs-black:#000;--bs-white:#fff;--bs-gray:#6c757d;--bs-gray-dark:#343a40;--bs-gray-100:#f8f9fa;--bs-gray-200:#e9ecef;--bs-gray-300:#dee2e6;--bs-gray-400:#ced4da;--bs-gray-500:#adb5bd;--bs-gray-600:#6c757d;--bs-gray-700:#495057;--bs-gray-800:#343a40;--bs-gray-900:#212529;--bs-primary:#0d6efd;--bs-secondary:#6c757d;--bs-success:#198754;--bs-info:#0dcaf0;--bs-warning:#ffc107;--bs-danger:#dc3545;--bs-light:#f8f9fa;--bs-dark:#212529;--bs-primary-rgb:13,110,253;--bs-secondary-rgb:108,117,125;--bs-success-rgb:25,135,84;--bs-info-rgb:13,202,240;--bs-warning-rgb:255,193,7;--bs-danger-rgb:220,53,69;--bs-light-rgb:248,249,250;--bs-dark-rgb:33,37,41;--bs-primary-text-emphasis:#052c65;--bs-secondary-text-emphasis:#2b2f32;--bs-success-text-emphasis:#0a3622;--bs-info-text-emphasis:#055160;--bs-warning-text-emphasis:#664d03;--bs-danger-text-emphasis:#58151c;--bs-light-text-emphasis:#495057;--bs-dark-text-emphasis:#495057;--bs-primary-bg-subtle:#cfe2ff;--bs-secondary-bg-subtle:#e2e3e5;--bs-success-bg-subtle:#d1e7dd;--bs-info-bg-subtle:#cff4fc;--bs-warning-bg-subtle:#fff3cd;--bs-danger-bg-subtle:#f8d7da;--bs-light-bg-subtle:#fcfcfd;--bs-dark-bg-subtle:#ced4da;--bs-primary-border-subtle:#9ec5fe;--bs-secondary-border-subtle:#c4c8cb;--bs-success-border-subtle:#a3cfbb;--bs-info-border-subtle:#9eeaf9;--bs-warning-border-subtle:#ffe69c;--bs-danger-border-subtle:#f1aeb5;--bs-light-border-subtle:#e9ecef;--bs-dark-border-subtle:#adb5bd;--bs-white-rgb:255,255,255;--bs-black-rgb:0,0,0;--bs-font-sans-serif:system-ui,-apple-system,\"Segoe UI\",Roboto,\"Helvetica Neue\",\"Noto Sans\",\"Liberation Sans\",Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\",\"Segoe UI Symbol\",\"Noto Color Emoji\";--bs-font-monospace:SFMono-Regular,Menlo,Monaco,Consolas,\"Liberation Mono\",\"Courier New\",monospace;--bs-gradient:linear-gradient(180deg, rgba(255, 255, 255, .15), rgba(255, 255, 255, 0));--bs-body-font-family:var(--bs-font-sans-serif);--bs-body-font-size:1rem;--bs-body-font-weight:400;--bs-body-line-height:1.5;--bs-body-color:#212529;--bs-body-color-rgb:33,37,41;--bs-body-bg:#fff;--bs-body-bg-rgb:255,255,255;--bs-emphasis-color:#000;--bs-emphasis-color-rgb:0,0,0;--bs-secondary-color:rgba(33, 37, 41, .75);--bs-secondary-color-rgb:33,37,41;--bs-secondary-bg:#e9ecef;--bs-secondary-bg-rgb:233,236,239;--bs-tertiary-color:rgba(33, 37, 41, .5);--bs-tertiary-color-rgb:33,37,41;--bs-tertiary-bg:#f8f9fa;--bs-tertiary-bg-rgb:248,249,250;--bs-heading-color:inherit;--bs-link-color:#0d6efd;--bs-link-color-rgb:13,110,253;--bs-link-decoration:underline;--bs-link-hover-color:#0a58ca;--bs-link-hover-color-rgb:10,88,202;--bs-code-color:#d63384;--bs-highlight-color:#212529;--bs-highlight-bg:#fff3cd;--bs-border-width:1px;--bs-border-style:solid;--bs-border-color:#dee2e6;--bs-border-color-translucent:rgba(0, 0, 0, .175);--bs-border-radius:.375rem;--bs-border-radius-sm:.25rem;--bs-border-radius-lg:.5rem;--bs-border-radius-xl:1rem;--bs-border-radius-xxl:2rem;--bs-border-radius-2xl:var(--bs-border-radius-xxl);--bs-border-radius-pill:50rem;--bs-box-shadow:0 .5rem 1rem rgba(0, 0, 0, .15);--bs-box-shadow-sm:0 .125rem .25rem rgba(0, 0, 0, .075);--bs-box-shadow-lg:0 1rem 3rem rgba(0, 0, 0, .175);--bs-box-shadow-inset:inset 0 1px 2px rgba(0, 0, 0, .075);--bs-focus-ring-width:.25rem;--bs-focus-ring-opacity:.25;--bs-focus-ring-color:rgba(13, 110, 253, .25);--bs-form-valid-color:#198754;--bs-form-valid-border-color:#198754;--bs-form-invalid-color:#dc3545;--bs-form-invalid-border-color:#dc3545}[data-bs-theme=dark][_ngcontent-%COMP%]{color-scheme:dark;--bs-body-color:#dee2e6;--bs-body-color-rgb:222,226,230;--bs-body-bg:#212529;--bs-body-bg-rgb:33,37,41;--bs-emphasis-color:#fff;--bs-emphasis-color-rgb:255,255,255;--bs-secondary-color:rgba(222, 226, 230, .75);--bs-secondary-color-rgb:222,226,230;--bs-secondary-bg:#343a40;--bs-secondary-bg-rgb:52,58,64;--bs-tertiary-color:rgba(222, 226, 230, .5);--bs-tertiary-color-rgb:222,226,230;--bs-tertiary-bg:#2b3035;--bs-tertiary-bg-rgb:43,48,53;--bs-primary-text-emphasis:#6ea8fe;--bs-secondary-text-emphasis:#a7acb1;--bs-success-text-emphasis:#75b798;--bs-info-text-emphasis:#6edff6;--bs-warning-text-emphasis:#ffda6a;--bs-danger-text-emphasis:#ea868f;--bs-light-text-emphasis:#f8f9fa;--bs-dark-text-emphasis:#dee2e6;--bs-primary-bg-subtle:#031633;--bs-secondary-bg-subtle:#161719;--bs-success-bg-subtle:#051b11;--bs-info-bg-subtle:#032830;--bs-warning-bg-subtle:#332701;--bs-danger-bg-subtle:#2c0b0e;--bs-light-bg-subtle:#343a40;--bs-dark-bg-subtle:#1a1d20;--bs-primary-border-subtle:#084298;--bs-secondary-border-subtle:#41464b;--bs-success-border-subtle:#0f5132;--bs-info-border-subtle:#087990;--bs-warning-border-subtle:#997404;--bs-danger-border-subtle:#842029;--bs-light-border-subtle:#495057;--bs-dark-border-subtle:#343a40;--bs-heading-color:inherit;--bs-link-color:#6ea8fe;--bs-link-hover-color:#8bb9fe;--bs-link-color-rgb:110,168,254;--bs-link-hover-color-rgb:139,185,254;--bs-code-color:#e685b5;--bs-highlight-color:#dee2e6;--bs-highlight-bg:#664d03;--bs-border-color:#495057;--bs-border-color-translucent:rgba(255, 255, 255, .15);--bs-form-valid-color:#75b798;--bs-form-valid-border-color:#75b798;--bs-form-invalid-color:#ea868f;--bs-form-invalid-border-color:#ea868f}*[_ngcontent-%COMP%], [_ngcontent-%COMP%]:after, [_ngcontent-%COMP%]:before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){[_ngcontent-%COMP%]:root{scroll-behavior:smooth}}body[_ngcontent-%COMP%]{margin:0;font-family:var(--bs-body-font-family);font-size:var(--bs-body-font-size);font-weight:var(--bs-body-font-weight);line-height:var(--bs-body-line-height);color:var(--bs-body-color);text-align:var(--bs-body-text-align);background-color:var(--bs-body-bg);-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr[_ngcontent-%COMP%]{margin:1rem 0;color:inherit;border:0;border-top:var(--bs-border-width) solid;opacity:.25}.h1[_ngcontent-%COMP%], .h2[_ngcontent-%COMP%], .h3[_ngcontent-%COMP%], .h4[_ngcontent-%COMP%], .h5[_ngcontent-%COMP%], .h6[_ngcontent-%COMP%], h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2;color:var(--bs-heading-color)}.h1[_ngcontent-%COMP%], h1[_ngcontent-%COMP%]{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){.h1[_ngcontent-%COMP%], h1[_ngcontent-%COMP%]{font-size:2.5rem}}.h2[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){.h2[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{font-size:2rem}}.h3[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){.h3[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{font-size:1.75rem}}.h4[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){.h4[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{font-size:1.5rem}}.h5[_ngcontent-%COMP%], h5[_ngcontent-%COMP%]{font-size:1.25rem}.h6[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{font-size:1rem}p[_ngcontent-%COMP%]{margin-top:0;margin-bottom:1rem}abbr[title][_ngcontent-%COMP%]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address[_ngcontent-%COMP%]{margin-bottom:1rem;font-style:normal;line-height:inherit}ol[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]{padding-left:2rem}dl[_ngcontent-%COMP%], ol[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]{margin-top:0;margin-bottom:1rem}ol[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%], ol[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-bottom:0}dt[_ngcontent-%COMP%]{font-weight:700}dd[_ngcontent-%COMP%]{margin-bottom:.5rem;margin-left:0}blockquote[_ngcontent-%COMP%]{margin:0 0 1rem}b[_ngcontent-%COMP%], strong[_ngcontent-%COMP%]{font-weight:bolder}.small[_ngcontent-%COMP%], small[_ngcontent-%COMP%]{font-size:.875em}.mark[_ngcontent-%COMP%], mark[_ngcontent-%COMP%]{padding:.1875em;color:var(--bs-highlight-color);background-color:var(--bs-highlight-bg)}sub[_ngcontent-%COMP%], sup[_ngcontent-%COMP%]{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub[_ngcontent-%COMP%]{bottom:-.25em}sup[_ngcontent-%COMP%]{top:-.5em}a[_ngcontent-%COMP%]{color:rgba(var(--bs-link-color-rgb),var(--bs-link-opacity,1));text-decoration:underline}a[_ngcontent-%COMP%]:hover{--bs-link-color-rgb:var(--bs-link-hover-color-rgb)}a[_ngcontent-%COMP%]:not([href]):not([class]), a[_ngcontent-%COMP%]:not([href]):not([class]):hover{color:inherit;text-decoration:none}code[_ngcontent-%COMP%], kbd[_ngcontent-%COMP%], pre[_ngcontent-%COMP%], samp[_ngcontent-%COMP%]{font-family:var(--bs-font-monospace);font-size:1em}pre[_ngcontent-%COMP%]{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{font-size:inherit;color:inherit;word-break:normal}code[_ngcontent-%COMP%]{font-size:.875em;color:var(--bs-code-color);word-wrap:break-word}a[_ngcontent-%COMP%] > code[_ngcontent-%COMP%]{color:inherit}kbd[_ngcontent-%COMP%]{padding:.1875rem .375rem;font-size:.875em;color:var(--bs-body-bg);background-color:var(--bs-body-color);border-radius:.25rem}kbd[_ngcontent-%COMP%]   kbd[_ngcontent-%COMP%]{padding:0;font-size:1em}figure[_ngcontent-%COMP%]{margin:0 0 1rem}img[_ngcontent-%COMP%], svg[_ngcontent-%COMP%]{vertical-align:middle}table[_ngcontent-%COMP%]{caption-side:bottom;border-collapse:collapse}caption[_ngcontent-%COMP%]{padding-top:.5rem;padding-bottom:.5rem;color:var(--bs-secondary-color);text-align:left}th[_ngcontent-%COMP%]{text-align:inherit;text-align:-webkit-match-parent}tbody[_ngcontent-%COMP%], td[_ngcontent-%COMP%], tfoot[_ngcontent-%COMP%], th[_ngcontent-%COMP%], thead[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]{border-color:inherit;border-style:solid;border-width:0}label[_ngcontent-%COMP%]{display:inline-block}button[_ngcontent-%COMP%]{border-radius:0}button[_ngcontent-%COMP%]:focus:not(:focus-visible){outline:0}button[_ngcontent-%COMP%], input[_ngcontent-%COMP%], optgroup[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{text-transform:none}[role=button][_ngcontent-%COMP%]{cursor:pointer}select[_ngcontent-%COMP%]{word-wrap:normal}select[_ngcontent-%COMP%]:disabled{opacity:1}[list][_ngcontent-%COMP%]:not([type=date]):not([type=datetime-local]):not([type=month]):not([type=week]):not([type=time])::-webkit-calendar-picker-indicator{display:none!important}[type=button][_ngcontent-%COMP%], [type=reset][_ngcontent-%COMP%], [type=submit][_ngcontent-%COMP%], button[_ngcontent-%COMP%]{-webkit-appearance:button}[type=button][_ngcontent-%COMP%]:not(:disabled), [type=reset][_ngcontent-%COMP%]:not(:disabled), [type=submit][_ngcontent-%COMP%]:not(:disabled), button[_ngcontent-%COMP%]:not(:disabled){cursor:pointer}[_ngcontent-%COMP%]::-moz-focus-inner{padding:0;border-style:none}textarea[_ngcontent-%COMP%]{resize:vertical}fieldset[_ngcontent-%COMP%]{min-width:0;padding:0;margin:0;border:0}legend[_ngcontent-%COMP%]{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend[_ngcontent-%COMP%]{font-size:1.5rem}}legend[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{clear:left}[_ngcontent-%COMP%]::-webkit-datetime-edit-day-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-fields-wrapper, [_ngcontent-%COMP%]::-webkit-datetime-edit-hour-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-minute, [_ngcontent-%COMP%]::-webkit-datetime-edit-month-field, [_ngcontent-%COMP%]::-webkit-datetime-edit-text, [_ngcontent-%COMP%]::-webkit-datetime-edit-year-field{padding:0}[_ngcontent-%COMP%]::-webkit-inner-spin-button{height:auto}[type=search][_ngcontent-%COMP%]{-webkit-appearance:textfield;outline-offset:-2px}[_ngcontent-%COMP%]::-webkit-search-decoration{-webkit-appearance:none}[_ngcontent-%COMP%]::-webkit-color-swatch-wrapper{padding:0}[_ngcontent-%COMP%]::file-selector-button{font:inherit;-webkit-appearance:button}output[_ngcontent-%COMP%]{display:inline-block}iframe[_ngcontent-%COMP%]{border:0}summary[_ngcontent-%COMP%]{display:list-item;cursor:pointer}progress[_ngcontent-%COMP%]{vertical-align:baseline}[hidden][_ngcontent-%COMP%]{display:none!important}.lead[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:300}.display-1[_ngcontent-%COMP%]{font-size:calc(1.625rem + 4.5vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-1[_ngcontent-%COMP%]{font-size:5rem}}.display-2[_ngcontent-%COMP%]{font-size:calc(1.575rem + 3.9vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-2[_ngcontent-%COMP%]{font-size:4.5rem}}.display-3[_ngcontent-%COMP%]{font-size:calc(1.525rem + 3.3vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-3[_ngcontent-%COMP%]{font-size:4rem}}.display-4[_ngcontent-%COMP%]{font-size:calc(1.475rem + 2.7vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-4[_ngcontent-%COMP%]{font-size:3.5rem}}.display-5[_ngcontent-%COMP%]{font-size:calc(1.425rem + 2.1vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-5[_ngcontent-%COMP%]{font-size:3rem}}.display-6[_ngcontent-%COMP%]{font-size:calc(1.375rem + 1.5vw);font-weight:300;line-height:1.2}@media (min-width:1200px){.display-6[_ngcontent-%COMP%]{font-size:2.5rem}}.list-unstyled[_ngcontent-%COMP%], .list-inline[_ngcontent-%COMP%]{padding-left:0;list-style:none}.list-inline-item[_ngcontent-%COMP%]{display:inline-block}.list-inline-item[_ngcontent-%COMP%]:not(:last-child){margin-right:.5rem}.initialism[_ngcontent-%COMP%]{font-size:.875em;text-transform:uppercase}.blockquote[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1.25rem}.blockquote[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:last-child{margin-bottom:0}.blockquote-footer[_ngcontent-%COMP%]{margin-top:-1rem;margin-bottom:1rem;font-size:.875em;color:#6c757d}.blockquote-footer[_ngcontent-%COMP%]:before{content:\"\\2014\\a0\"}.img-fluid[_ngcontent-%COMP%]{max-width:100%;height:auto}.img-thumbnail[_ngcontent-%COMP%]{padding:.25rem;background-color:var(--bs-body-bg);border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius);max-width:100%;height:auto}.figure[_ngcontent-%COMP%]{display:inline-block}.figure-img[_ngcontent-%COMP%]{margin-bottom:.5rem;line-height:1}.figure-caption[_ngcontent-%COMP%]{font-size:.875em;color:var(--bs-secondary-color)}.container[_ngcontent-%COMP%], .container-fluid[_ngcontent-%COMP%], .container-lg[_ngcontent-%COMP%], .container-md[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%], .container-xl[_ngcontent-%COMP%], .container-xxl[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem;--bs-gutter-y:0;width:100%;padding-right:calc(var(--bs-gutter-x) * .5);padding-left:calc(var(--bs-gutter-x) * .5);margin-right:auto;margin-left:auto}@media (min-width:576px){.container[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%]{max-width:540px}}@media (min-width:768px){.container[_ngcontent-%COMP%], .container-md[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%]{max-width:720px}}@media (min-width:992px){.container[_ngcontent-%COMP%], .container-lg[_ngcontent-%COMP%], .container-md[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%]{max-width:960px}}@media (min-width:1200px){.container[_ngcontent-%COMP%], .container-lg[_ngcontent-%COMP%], .container-md[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%], .container-xl[_ngcontent-%COMP%]{max-width:1140px}}@media (min-width:1400px){.container[_ngcontent-%COMP%], .container-lg[_ngcontent-%COMP%], .container-md[_ngcontent-%COMP%], .container-sm[_ngcontent-%COMP%], .container-xl[_ngcontent-%COMP%], .container-xxl[_ngcontent-%COMP%]{max-width:1320px}}[_ngcontent-%COMP%]:root{--bs-breakpoint-xs:0;--bs-breakpoint-sm:576px;--bs-breakpoint-md:768px;--bs-breakpoint-lg:992px;--bs-breakpoint-xl:1200px;--bs-breakpoint-xxl:1400px}.row[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem;--bs-gutter-y:0;display:flex;flex-wrap:wrap;margin-top:calc(-1 * var(--bs-gutter-y));margin-right:calc(-.5 * var(--bs-gutter-x));margin-left:calc(-.5 * var(--bs-gutter-x))}.row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex-shrink:0;width:100%;max-width:100%;padding-right:calc(var(--bs-gutter-x) * .5);padding-left:calc(var(--bs-gutter-x) * .5);margin-top:var(--bs-gutter-y)}.col[_ngcontent-%COMP%]{flex:1 0 0%}.row-cols-auto[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.row-cols-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.row-cols-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.row-cols-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.row-cols-4[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.row-cols-5[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:20%}.row-cols-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-auto[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.col-1[_ngcontent-%COMP%]{flex:0 0 auto;width:8.33333333%}.col-2[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-3[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.col-4[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.col-5[_ngcontent-%COMP%]{flex:0 0 auto;width:41.66666667%}.col-6[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.col-7[_ngcontent-%COMP%]{flex:0 0 auto;width:58.33333333%}.col-8[_ngcontent-%COMP%]{flex:0 0 auto;width:66.66666667%}.col-9[_ngcontent-%COMP%]{flex:0 0 auto;width:75%}.col-10[_ngcontent-%COMP%]{flex:0 0 auto;width:83.33333333%}.col-11[_ngcontent-%COMP%]{flex:0 0 auto;width:91.66666667%}.col-12[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.offset-1[_ngcontent-%COMP%]{margin-left:8.33333333%}.offset-2[_ngcontent-%COMP%]{margin-left:16.66666667%}.offset-3[_ngcontent-%COMP%]{margin-left:25%}.offset-4[_ngcontent-%COMP%]{margin-left:33.33333333%}.offset-5[_ngcontent-%COMP%]{margin-left:41.66666667%}.offset-6[_ngcontent-%COMP%]{margin-left:50%}.offset-7[_ngcontent-%COMP%]{margin-left:58.33333333%}.offset-8[_ngcontent-%COMP%]{margin-left:66.66666667%}.offset-9[_ngcontent-%COMP%]{margin-left:75%}.offset-10[_ngcontent-%COMP%]{margin-left:83.33333333%}.offset-11[_ngcontent-%COMP%]{margin-left:91.66666667%}.g-0[_ngcontent-%COMP%], .gx-0[_ngcontent-%COMP%]{--bs-gutter-x:0}.g-0[_ngcontent-%COMP%], .gy-0[_ngcontent-%COMP%]{--bs-gutter-y:0}.g-1[_ngcontent-%COMP%], .gx-1[_ngcontent-%COMP%]{--bs-gutter-x:.25rem}.g-1[_ngcontent-%COMP%], .gy-1[_ngcontent-%COMP%]{--bs-gutter-y:.25rem}.g-2[_ngcontent-%COMP%], .gx-2[_ngcontent-%COMP%]{--bs-gutter-x:.5rem}.g-2[_ngcontent-%COMP%], .gy-2[_ngcontent-%COMP%]{--bs-gutter-y:.5rem}.g-3[_ngcontent-%COMP%], .gx-3[_ngcontent-%COMP%]{--bs-gutter-x:1rem}.g-3[_ngcontent-%COMP%], .gy-3[_ngcontent-%COMP%]{--bs-gutter-y:1rem}.g-4[_ngcontent-%COMP%], .gx-4[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem}.g-4[_ngcontent-%COMP%], .gy-4[_ngcontent-%COMP%]{--bs-gutter-y:1.5rem}.g-5[_ngcontent-%COMP%], .gx-5[_ngcontent-%COMP%]{--bs-gutter-x:3rem}.g-5[_ngcontent-%COMP%], .gy-5[_ngcontent-%COMP%]{--bs-gutter-y:3rem}@media (min-width:576px){.col-sm[_ngcontent-%COMP%]{flex:1 0 0%}.row-cols-sm-auto[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.row-cols-sm-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.row-cols-sm-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.row-cols-sm-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.row-cols-sm-4[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.row-cols-sm-5[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:20%}.row-cols-sm-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-sm-auto[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.col-sm-1[_ngcontent-%COMP%]{flex:0 0 auto;width:8.33333333%}.col-sm-2[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-sm-3[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.col-sm-4[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.col-sm-5[_ngcontent-%COMP%]{flex:0 0 auto;width:41.66666667%}.col-sm-6[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.col-sm-7[_ngcontent-%COMP%]{flex:0 0 auto;width:58.33333333%}.col-sm-8[_ngcontent-%COMP%]{flex:0 0 auto;width:66.66666667%}.col-sm-9[_ngcontent-%COMP%]{flex:0 0 auto;width:75%}.col-sm-10[_ngcontent-%COMP%]{flex:0 0 auto;width:83.33333333%}.col-sm-11[_ngcontent-%COMP%]{flex:0 0 auto;width:91.66666667%}.col-sm-12[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.offset-sm-0[_ngcontent-%COMP%]{margin-left:0}.offset-sm-1[_ngcontent-%COMP%]{margin-left:8.33333333%}.offset-sm-2[_ngcontent-%COMP%]{margin-left:16.66666667%}.offset-sm-3[_ngcontent-%COMP%]{margin-left:25%}.offset-sm-4[_ngcontent-%COMP%]{margin-left:33.33333333%}.offset-sm-5[_ngcontent-%COMP%]{margin-left:41.66666667%}.offset-sm-6[_ngcontent-%COMP%]{margin-left:50%}.offset-sm-7[_ngcontent-%COMP%]{margin-left:58.33333333%}.offset-sm-8[_ngcontent-%COMP%]{margin-left:66.66666667%}.offset-sm-9[_ngcontent-%COMP%]{margin-left:75%}.offset-sm-10[_ngcontent-%COMP%]{margin-left:83.33333333%}.offset-sm-11[_ngcontent-%COMP%]{margin-left:91.66666667%}.g-sm-0[_ngcontent-%COMP%], .gx-sm-0[_ngcontent-%COMP%]{--bs-gutter-x:0}.g-sm-0[_ngcontent-%COMP%], .gy-sm-0[_ngcontent-%COMP%]{--bs-gutter-y:0}.g-sm-1[_ngcontent-%COMP%], .gx-sm-1[_ngcontent-%COMP%]{--bs-gutter-x:.25rem}.g-sm-1[_ngcontent-%COMP%], .gy-sm-1[_ngcontent-%COMP%]{--bs-gutter-y:.25rem}.g-sm-2[_ngcontent-%COMP%], .gx-sm-2[_ngcontent-%COMP%]{--bs-gutter-x:.5rem}.g-sm-2[_ngcontent-%COMP%], .gy-sm-2[_ngcontent-%COMP%]{--bs-gutter-y:.5rem}.g-sm-3[_ngcontent-%COMP%], .gx-sm-3[_ngcontent-%COMP%]{--bs-gutter-x:1rem}.g-sm-3[_ngcontent-%COMP%], .gy-sm-3[_ngcontent-%COMP%]{--bs-gutter-y:1rem}.g-sm-4[_ngcontent-%COMP%], .gx-sm-4[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem}.g-sm-4[_ngcontent-%COMP%], .gy-sm-4[_ngcontent-%COMP%]{--bs-gutter-y:1.5rem}.g-sm-5[_ngcontent-%COMP%], .gx-sm-5[_ngcontent-%COMP%]{--bs-gutter-x:3rem}.g-sm-5[_ngcontent-%COMP%], .gy-sm-5[_ngcontent-%COMP%]{--bs-gutter-y:3rem}}@media (min-width:768px){.col-md[_ngcontent-%COMP%]{flex:1 0 0%}.row-cols-md-auto[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.row-cols-md-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.row-cols-md-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.row-cols-md-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.row-cols-md-4[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.row-cols-md-5[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:20%}.row-cols-md-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-md-auto[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.col-md-1[_ngcontent-%COMP%]{flex:0 0 auto;width:8.33333333%}.col-md-2[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-md-3[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.col-md-4[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.col-md-5[_ngcontent-%COMP%]{flex:0 0 auto;width:41.66666667%}.col-md-6[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.col-md-7[_ngcontent-%COMP%]{flex:0 0 auto;width:58.33333333%}.col-md-8[_ngcontent-%COMP%]{flex:0 0 auto;width:66.66666667%}.col-md-9[_ngcontent-%COMP%]{flex:0 0 auto;width:75%}.col-md-10[_ngcontent-%COMP%]{flex:0 0 auto;width:83.33333333%}.col-md-11[_ngcontent-%COMP%]{flex:0 0 auto;width:91.66666667%}.col-md-12[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.offset-md-0[_ngcontent-%COMP%]{margin-left:0}.offset-md-1[_ngcontent-%COMP%]{margin-left:8.33333333%}.offset-md-2[_ngcontent-%COMP%]{margin-left:16.66666667%}.offset-md-3[_ngcontent-%COMP%]{margin-left:25%}.offset-md-4[_ngcontent-%COMP%]{margin-left:33.33333333%}.offset-md-5[_ngcontent-%COMP%]{margin-left:41.66666667%}.offset-md-6[_ngcontent-%COMP%]{margin-left:50%}.offset-md-7[_ngcontent-%COMP%]{margin-left:58.33333333%}.offset-md-8[_ngcontent-%COMP%]{margin-left:66.66666667%}.offset-md-9[_ngcontent-%COMP%]{margin-left:75%}.offset-md-10[_ngcontent-%COMP%]{margin-left:83.33333333%}.offset-md-11[_ngcontent-%COMP%]{margin-left:91.66666667%}.g-md-0[_ngcontent-%COMP%], .gx-md-0[_ngcontent-%COMP%]{--bs-gutter-x:0}.g-md-0[_ngcontent-%COMP%], .gy-md-0[_ngcontent-%COMP%]{--bs-gutter-y:0}.g-md-1[_ngcontent-%COMP%], .gx-md-1[_ngcontent-%COMP%]{--bs-gutter-x:.25rem}.g-md-1[_ngcontent-%COMP%], .gy-md-1[_ngcontent-%COMP%]{--bs-gutter-y:.25rem}.g-md-2[_ngcontent-%COMP%], .gx-md-2[_ngcontent-%COMP%]{--bs-gutter-x:.5rem}.g-md-2[_ngcontent-%COMP%], .gy-md-2[_ngcontent-%COMP%]{--bs-gutter-y:.5rem}.g-md-3[_ngcontent-%COMP%], .gx-md-3[_ngcontent-%COMP%]{--bs-gutter-x:1rem}.g-md-3[_ngcontent-%COMP%], .gy-md-3[_ngcontent-%COMP%]{--bs-gutter-y:1rem}.g-md-4[_ngcontent-%COMP%], .gx-md-4[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem}.g-md-4[_ngcontent-%COMP%], .gy-md-4[_ngcontent-%COMP%]{--bs-gutter-y:1.5rem}.g-md-5[_ngcontent-%COMP%], .gx-md-5[_ngcontent-%COMP%]{--bs-gutter-x:3rem}.g-md-5[_ngcontent-%COMP%], .gy-md-5[_ngcontent-%COMP%]{--bs-gutter-y:3rem}}@media (min-width:992px){.col-lg[_ngcontent-%COMP%]{flex:1 0 0%}.row-cols-lg-auto[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.row-cols-lg-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.row-cols-lg-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.row-cols-lg-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.row-cols-lg-4[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.row-cols-lg-5[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:20%}.row-cols-lg-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-lg-auto[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.col-lg-1[_ngcontent-%COMP%]{flex:0 0 auto;width:8.33333333%}.col-lg-2[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-lg-3[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.col-lg-4[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.col-lg-5[_ngcontent-%COMP%]{flex:0 0 auto;width:41.66666667%}.col-lg-6[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.col-lg-7[_ngcontent-%COMP%]{flex:0 0 auto;width:58.33333333%}.col-lg-8[_ngcontent-%COMP%]{flex:0 0 auto;width:66.66666667%}.col-lg-9[_ngcontent-%COMP%]{flex:0 0 auto;width:75%}.col-lg-10[_ngcontent-%COMP%]{flex:0 0 auto;width:83.33333333%}.col-lg-11[_ngcontent-%COMP%]{flex:0 0 auto;width:91.66666667%}.col-lg-12[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.offset-lg-0[_ngcontent-%COMP%]{margin-left:0}.offset-lg-1[_ngcontent-%COMP%]{margin-left:8.33333333%}.offset-lg-2[_ngcontent-%COMP%]{margin-left:16.66666667%}.offset-lg-3[_ngcontent-%COMP%]{margin-left:25%}.offset-lg-4[_ngcontent-%COMP%]{margin-left:33.33333333%}.offset-lg-5[_ngcontent-%COMP%]{margin-left:41.66666667%}.offset-lg-6[_ngcontent-%COMP%]{margin-left:50%}.offset-lg-7[_ngcontent-%COMP%]{margin-left:58.33333333%}.offset-lg-8[_ngcontent-%COMP%]{margin-left:66.66666667%}.offset-lg-9[_ngcontent-%COMP%]{margin-left:75%}.offset-lg-10[_ngcontent-%COMP%]{margin-left:83.33333333%}.offset-lg-11[_ngcontent-%COMP%]{margin-left:91.66666667%}.g-lg-0[_ngcontent-%COMP%], .gx-lg-0[_ngcontent-%COMP%]{--bs-gutter-x:0}.g-lg-0[_ngcontent-%COMP%], .gy-lg-0[_ngcontent-%COMP%]{--bs-gutter-y:0}.g-lg-1[_ngcontent-%COMP%], .gx-lg-1[_ngcontent-%COMP%]{--bs-gutter-x:.25rem}.g-lg-1[_ngcontent-%COMP%], .gy-lg-1[_ngcontent-%COMP%]{--bs-gutter-y:.25rem}.g-lg-2[_ngcontent-%COMP%], .gx-lg-2[_ngcontent-%COMP%]{--bs-gutter-x:.5rem}.g-lg-2[_ngcontent-%COMP%], .gy-lg-2[_ngcontent-%COMP%]{--bs-gutter-y:.5rem}.g-lg-3[_ngcontent-%COMP%], .gx-lg-3[_ngcontent-%COMP%]{--bs-gutter-x:1rem}.g-lg-3[_ngcontent-%COMP%], .gy-lg-3[_ngcontent-%COMP%]{--bs-gutter-y:1rem}.g-lg-4[_ngcontent-%COMP%], .gx-lg-4[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem}.g-lg-4[_ngcontent-%COMP%], .gy-lg-4[_ngcontent-%COMP%]{--bs-gutter-y:1.5rem}.g-lg-5[_ngcontent-%COMP%], .gx-lg-5[_ngcontent-%COMP%]{--bs-gutter-x:3rem}.g-lg-5[_ngcontent-%COMP%], .gy-lg-5[_ngcontent-%COMP%]{--bs-gutter-y:3rem}}@media (min-width:1200px){.col-xl[_ngcontent-%COMP%]{flex:1 0 0%}.row-cols-xl-auto[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.row-cols-xl-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.row-cols-xl-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.row-cols-xl-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.row-cols-xl-4[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.row-cols-xl-5[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:20%}.row-cols-xl-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-xl-auto[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.col-xl-1[_ngcontent-%COMP%]{flex:0 0 auto;width:8.33333333%}.col-xl-2[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-xl-3[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.col-xl-4[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.col-xl-5[_ngcontent-%COMP%]{flex:0 0 auto;width:41.66666667%}.col-xl-6[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.col-xl-7[_ngcontent-%COMP%]{flex:0 0 auto;width:58.33333333%}.col-xl-8[_ngcontent-%COMP%]{flex:0 0 auto;width:66.66666667%}.col-xl-9[_ngcontent-%COMP%]{flex:0 0 auto;width:75%}.col-xl-10[_ngcontent-%COMP%]{flex:0 0 auto;width:83.33333333%}.col-xl-11[_ngcontent-%COMP%]{flex:0 0 auto;width:91.66666667%}.col-xl-12[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.offset-xl-0[_ngcontent-%COMP%]{margin-left:0}.offset-xl-1[_ngcontent-%COMP%]{margin-left:8.33333333%}.offset-xl-2[_ngcontent-%COMP%]{margin-left:16.66666667%}.offset-xl-3[_ngcontent-%COMP%]{margin-left:25%}.offset-xl-4[_ngcontent-%COMP%]{margin-left:33.33333333%}.offset-xl-5[_ngcontent-%COMP%]{margin-left:41.66666667%}.offset-xl-6[_ngcontent-%COMP%]{margin-left:50%}.offset-xl-7[_ngcontent-%COMP%]{margin-left:58.33333333%}.offset-xl-8[_ngcontent-%COMP%]{margin-left:66.66666667%}.offset-xl-9[_ngcontent-%COMP%]{margin-left:75%}.offset-xl-10[_ngcontent-%COMP%]{margin-left:83.33333333%}.offset-xl-11[_ngcontent-%COMP%]{margin-left:91.66666667%}.g-xl-0[_ngcontent-%COMP%], .gx-xl-0[_ngcontent-%COMP%]{--bs-gutter-x:0}.g-xl-0[_ngcontent-%COMP%], .gy-xl-0[_ngcontent-%COMP%]{--bs-gutter-y:0}.g-xl-1[_ngcontent-%COMP%], .gx-xl-1[_ngcontent-%COMP%]{--bs-gutter-x:.25rem}.g-xl-1[_ngcontent-%COMP%], .gy-xl-1[_ngcontent-%COMP%]{--bs-gutter-y:.25rem}.g-xl-2[_ngcontent-%COMP%], .gx-xl-2[_ngcontent-%COMP%]{--bs-gutter-x:.5rem}.g-xl-2[_ngcontent-%COMP%], .gy-xl-2[_ngcontent-%COMP%]{--bs-gutter-y:.5rem}.g-xl-3[_ngcontent-%COMP%], .gx-xl-3[_ngcontent-%COMP%]{--bs-gutter-x:1rem}.g-xl-3[_ngcontent-%COMP%], .gy-xl-3[_ngcontent-%COMP%]{--bs-gutter-y:1rem}.g-xl-4[_ngcontent-%COMP%], .gx-xl-4[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem}.g-xl-4[_ngcontent-%COMP%], .gy-xl-4[_ngcontent-%COMP%]{--bs-gutter-y:1.5rem}.g-xl-5[_ngcontent-%COMP%], .gx-xl-5[_ngcontent-%COMP%]{--bs-gutter-x:3rem}.g-xl-5[_ngcontent-%COMP%], .gy-xl-5[_ngcontent-%COMP%]{--bs-gutter-y:3rem}}@media (min-width:1400px){.col-xxl[_ngcontent-%COMP%]{flex:1 0 0%}.row-cols-xxl-auto[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.row-cols-xxl-1[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.row-cols-xxl-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.row-cols-xxl-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.row-cols-xxl-4[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.row-cols-xxl-5[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:20%}.row-cols-xxl-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-xxl-auto[_ngcontent-%COMP%]{flex:0 0 auto;width:auto}.col-xxl-1[_ngcontent-%COMP%]{flex:0 0 auto;width:8.33333333%}.col-xxl-2[_ngcontent-%COMP%]{flex:0 0 auto;width:16.66666667%}.col-xxl-3[_ngcontent-%COMP%]{flex:0 0 auto;width:25%}.col-xxl-4[_ngcontent-%COMP%]{flex:0 0 auto;width:33.33333333%}.col-xxl-5[_ngcontent-%COMP%]{flex:0 0 auto;width:41.66666667%}.col-xxl-6[_ngcontent-%COMP%]{flex:0 0 auto;width:50%}.col-xxl-7[_ngcontent-%COMP%]{flex:0 0 auto;width:58.33333333%}.col-xxl-8[_ngcontent-%COMP%]{flex:0 0 auto;width:66.66666667%}.col-xxl-9[_ngcontent-%COMP%]{flex:0 0 auto;width:75%}.col-xxl-10[_ngcontent-%COMP%]{flex:0 0 auto;width:83.33333333%}.col-xxl-11[_ngcontent-%COMP%]{flex:0 0 auto;width:91.66666667%}.col-xxl-12[_ngcontent-%COMP%]{flex:0 0 auto;width:100%}.offset-xxl-0[_ngcontent-%COMP%]{margin-left:0}.offset-xxl-1[_ngcontent-%COMP%]{margin-left:8.33333333%}.offset-xxl-2[_ngcontent-%COMP%]{margin-left:16.66666667%}.offset-xxl-3[_ngcontent-%COMP%]{margin-left:25%}.offset-xxl-4[_ngcontent-%COMP%]{margin-left:33.33333333%}.offset-xxl-5[_ngcontent-%COMP%]{margin-left:41.66666667%}.offset-xxl-6[_ngcontent-%COMP%]{margin-left:50%}.offset-xxl-7[_ngcontent-%COMP%]{margin-left:58.33333333%}.offset-xxl-8[_ngcontent-%COMP%]{margin-left:66.66666667%}.offset-xxl-9[_ngcontent-%COMP%]{margin-left:75%}.offset-xxl-10[_ngcontent-%COMP%]{margin-left:83.33333333%}.offset-xxl-11[_ngcontent-%COMP%]{margin-left:91.66666667%}.g-xxl-0[_ngcontent-%COMP%], .gx-xxl-0[_ngcontent-%COMP%]{--bs-gutter-x:0}.g-xxl-0[_ngcontent-%COMP%], .gy-xxl-0[_ngcontent-%COMP%]{--bs-gutter-y:0}.g-xxl-1[_ngcontent-%COMP%], .gx-xxl-1[_ngcontent-%COMP%]{--bs-gutter-x:.25rem}.g-xxl-1[_ngcontent-%COMP%], .gy-xxl-1[_ngcontent-%COMP%]{--bs-gutter-y:.25rem}.g-xxl-2[_ngcontent-%COMP%], .gx-xxl-2[_ngcontent-%COMP%]{--bs-gutter-x:.5rem}.g-xxl-2[_ngcontent-%COMP%], .gy-xxl-2[_ngcontent-%COMP%]{--bs-gutter-y:.5rem}.g-xxl-3[_ngcontent-%COMP%], .gx-xxl-3[_ngcontent-%COMP%]{--bs-gutter-x:1rem}.g-xxl-3[_ngcontent-%COMP%], .gy-xxl-3[_ngcontent-%COMP%]{--bs-gutter-y:1rem}.g-xxl-4[_ngcontent-%COMP%], .gx-xxl-4[_ngcontent-%COMP%]{--bs-gutter-x:1.5rem}.g-xxl-4[_ngcontent-%COMP%], .gy-xxl-4[_ngcontent-%COMP%]{--bs-gutter-y:1.5rem}.g-xxl-5[_ngcontent-%COMP%], .gx-xxl-5[_ngcontent-%COMP%]{--bs-gutter-x:3rem}.g-xxl-5[_ngcontent-%COMP%], .gy-xxl-5[_ngcontent-%COMP%]{--bs-gutter-y:3rem}}.table[_ngcontent-%COMP%]{--bs-table-color-type:initial;--bs-table-bg-type:initial;--bs-table-color-state:initial;--bs-table-bg-state:initial;--bs-table-color:var(--bs-emphasis-color);--bs-table-bg:var(--bs-body-bg);--bs-table-border-color:var(--bs-border-color);--bs-table-accent-bg:transparent;--bs-table-striped-color:var(--bs-emphasis-color);--bs-table-striped-bg:rgba(var(--bs-emphasis-color-rgb), .05);--bs-table-active-color:var(--bs-emphasis-color);--bs-table-active-bg:rgba(var(--bs-emphasis-color-rgb), .1);--bs-table-hover-color:var(--bs-emphasis-color);--bs-table-hover-bg:rgba(var(--bs-emphasis-color-rgb), .075);width:100%;margin-bottom:1rem;vertical-align:top;border-color:var(--bs-table-border-color)}.table[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.5rem;color:var(--bs-table-color-state,var(--bs-table-color-type,var(--bs-table-color)));background-color:var(--bs-table-bg);border-bottom-width:var(--bs-border-width);box-shadow:inset 0 0 0 9999px var(--bs-table-bg-state,var(--bs-table-bg-type,var(--bs-table-accent-bg)))}.table[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%]{vertical-align:inherit}.table[_ngcontent-%COMP%] > thead[_ngcontent-%COMP%]{vertical-align:bottom}.table-group-divider[_ngcontent-%COMP%]{border-top:calc(var(--bs-border-width) * 2) solid currentcolor}.caption-top[_ngcontent-%COMP%]{caption-side:top}.table-sm[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:.25rem}.table-bordered[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%]{border-width:var(--bs-border-width) 0}.table-bordered[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border-width:0 var(--bs-border-width)}.table-borderless[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > *[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border-bottom-width:0}.table-borderless[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:first-child){border-top-width:0}.table-striped[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:nth-of-type(odd) > *[_ngcontent-%COMP%]{--bs-table-color-type:var(--bs-table-striped-color);--bs-table-bg-type:var(--bs-table-striped-bg)}.table-striped-columns[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(caption) > tr[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:nth-child(2n){--bs-table-color-type:var(--bs-table-striped-color);--bs-table-bg-type:var(--bs-table-striped-bg)}.table-active[_ngcontent-%COMP%]{--bs-table-color-state:var(--bs-table-active-color);--bs-table-bg-state:var(--bs-table-active-bg)}.table-hover[_ngcontent-%COMP%] > tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%]:hover > *[_ngcontent-%COMP%]{--bs-table-color-state:var(--bs-table-hover-color);--bs-table-bg-state:var(--bs-table-hover-bg)}.table-primary[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#cfe2ff;--bs-table-border-color:#a6b5cc;--bs-table-striped-bg:#c5d7f2;--bs-table-striped-color:#000;--bs-table-active-bg:#bacbe6;--bs-table-active-color:#000;--bs-table-hover-bg:#bfd1ec;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-secondary[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#e2e3e5;--bs-table-border-color:#b5b6b7;--bs-table-striped-bg:#d7d8da;--bs-table-striped-color:#000;--bs-table-active-bg:#cbccce;--bs-table-active-color:#000;--bs-table-hover-bg:#d1d2d4;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-success[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#d1e7dd;--bs-table-border-color:#a7b9b1;--bs-table-striped-bg:#c7dbd2;--bs-table-striped-color:#000;--bs-table-active-bg:#bcd0c7;--bs-table-active-color:#000;--bs-table-hover-bg:#c1d6cc;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-info[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#cff4fc;--bs-table-border-color:#a6c3ca;--bs-table-striped-bg:#c5e8ef;--bs-table-striped-color:#000;--bs-table-active-bg:#badce3;--bs-table-active-color:#000;--bs-table-hover-bg:#bfe2e9;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-warning[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#fff3cd;--bs-table-border-color:#ccc2a4;--bs-table-striped-bg:#f2e7c3;--bs-table-striped-color:#000;--bs-table-active-bg:#e6dbb9;--bs-table-active-color:#000;--bs-table-hover-bg:#ece1be;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-danger[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#f8d7da;--bs-table-border-color:#c6acae;--bs-table-striped-bg:#eccccf;--bs-table-striped-color:#000;--bs-table-active-bg:#dfc2c4;--bs-table-active-color:#000;--bs-table-hover-bg:#e5c7ca;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-light[_ngcontent-%COMP%]{--bs-table-color:#000;--bs-table-bg:#f8f9fa;--bs-table-border-color:#c6c7c8;--bs-table-striped-bg:#ecedee;--bs-table-striped-color:#000;--bs-table-active-bg:#dfe0e1;--bs-table-active-color:#000;--bs-table-hover-bg:#e5e6e7;--bs-table-hover-color:#000;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-dark[_ngcontent-%COMP%]{--bs-table-color:#fff;--bs-table-bg:#212529;--bs-table-border-color:#4d5154;--bs-table-striped-bg:#2c3034;--bs-table-striped-color:#fff;--bs-table-active-bg:#373b3e;--bs-table-active-color:#fff;--bs-table-hover-bg:#323539;--bs-table-hover-color:#fff;color:var(--bs-table-color);border-color:var(--bs-table-border-color)}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}@media (max-width:575.98px){.table-responsive-sm[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:767.98px){.table-responsive-md[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:991.98px){.table-responsive-lg[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:1199.98px){.table-responsive-xl[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width:1399.98px){.table-responsive-xxl[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}.form-label[_ngcontent-%COMP%]{margin-bottom:.5rem}.col-form-label[_ngcontent-%COMP%]{padding-top:calc(.375rem + var(--bs-border-width));padding-bottom:calc(.375rem + var(--bs-border-width));margin-bottom:0;font-size:inherit;line-height:1.5}.col-form-label-lg[_ngcontent-%COMP%]{padding-top:calc(.5rem + var(--bs-border-width));padding-bottom:calc(.5rem + var(--bs-border-width));font-size:1.25rem}.col-form-label-sm[_ngcontent-%COMP%]{padding-top:calc(.25rem + var(--bs-border-width));padding-bottom:calc(.25rem + var(--bs-border-width));font-size:.875rem}.form-text[_ngcontent-%COMP%]{margin-top:.25rem;font-size:.875em;color:var(--bs-secondary-color)}.form-control[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:var(--bs-body-color);appearance:none;background-color:var(--bs-body-bg);background-clip:padding-box;border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius);transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control[_ngcontent-%COMP%]{transition:none}}.form-control[type=file][_ngcontent-%COMP%]{overflow:hidden}.form-control[type=file][_ngcontent-%COMP%]:not(:disabled):not([readonly]){cursor:pointer}.form-control[_ngcontent-%COMP%]:focus{color:var(--bs-body-color);background-color:var(--bs-body-bg);border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem #0d6efd40}.form-control[_ngcontent-%COMP%]::-webkit-date-and-time-value{min-width:85px;height:1.5em;margin:0}.form-control[_ngcontent-%COMP%]::-webkit-datetime-edit{display:block;padding:0}.form-control[_ngcontent-%COMP%]::placeholder{color:var(--bs-secondary-color);opacity:1}.form-control[_ngcontent-%COMP%]:disabled{background-color:var(--bs-secondary-bg);opacity:1}.form-control[_ngcontent-%COMP%]::file-selector-button{padding:.375rem .75rem;margin:-.375rem -.75rem;margin-inline-end:.75rem;color:var(--bs-body-color);background-color:var(--bs-tertiary-bg);pointer-events:none;border-color:inherit;border-style:solid;border-width:0;border-inline-end-width:var(--bs-border-width);border-radius:0;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-control[_ngcontent-%COMP%]::file-selector-button{transition:none}}.form-control[_ngcontent-%COMP%]:hover:not(:disabled):not([readonly])::file-selector-button{background-color:var(--bs-secondary-bg)}.form-control-plaintext[_ngcontent-%COMP%]{display:block;width:100%;padding:.375rem 0;margin-bottom:0;line-height:1.5;color:var(--bs-body-color);background-color:transparent;border:solid transparent;border-width:var(--bs-border-width) 0}.form-control-plaintext[_ngcontent-%COMP%]:focus{outline:0}.form-control-plaintext.form-control-lg[_ngcontent-%COMP%], .form-control-plaintext.form-control-sm[_ngcontent-%COMP%]{padding-right:0;padding-left:0}.form-control-sm[_ngcontent-%COMP%]{min-height:calc(1.5em + .5rem + calc(var(--bs-border-width) * 2));padding:.25rem .5rem;font-size:.875rem;border-radius:var(--bs-border-radius-sm)}.form-control-sm[_ngcontent-%COMP%]::file-selector-button{padding:.25rem .5rem;margin:-.25rem -.5rem;margin-inline-end:.5rem}.form-control-lg[_ngcontent-%COMP%]{min-height:calc(1.5em + 1rem + calc(var(--bs-border-width) * 2));padding:.5rem 1rem;font-size:1.25rem;border-radius:var(--bs-border-radius-lg)}.form-control-lg[_ngcontent-%COMP%]::file-selector-button{padding:.5rem 1rem;margin:-.5rem -1rem;margin-inline-end:1rem}textarea.form-control[_ngcontent-%COMP%]{min-height:calc(1.5em + .75rem + calc(var(--bs-border-width) * 2))}textarea.form-control-sm[_ngcontent-%COMP%]{min-height:calc(1.5em + .5rem + calc(var(--bs-border-width) * 2))}textarea.form-control-lg[_ngcontent-%COMP%]{min-height:calc(1.5em + 1rem + calc(var(--bs-border-width) * 2))}.form-control-color[_ngcontent-%COMP%]{width:3rem;height:calc(1.5em + .75rem + calc(var(--bs-border-width) * 2));padding:.375rem}.form-control-color[_ngcontent-%COMP%]:not(:disabled):not([readonly]){cursor:pointer}.form-control-color[_ngcontent-%COMP%]::-moz-color-swatch{border:0!important;border-radius:var(--bs-border-radius)}.form-control-color[_ngcontent-%COMP%]::-webkit-color-swatch{border:0!important;border-radius:var(--bs-border-radius)}.form-control-color.form-control-sm[_ngcontent-%COMP%]{height:calc(1.5em + .5rem + calc(var(--bs-border-width) * 2))}.form-control-color.form-control-lg[_ngcontent-%COMP%]{height:calc(1.5em + 1rem + calc(var(--bs-border-width) * 2))}.form-select[_ngcontent-%COMP%]{--bs-form-select-bg-img:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e\");display:block;width:100%;padding:.375rem 2.25rem .375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:var(--bs-body-color);appearance:none;background-color:var(--bs-body-bg);background-image:var(--bs-form-select-bg-img),var(--bs-form-select-bg-icon,none);background-repeat:no-repeat;background-position:right .75rem center;background-size:16px 12px;border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius);transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-select[_ngcontent-%COMP%]{transition:none}}.form-select[_ngcontent-%COMP%]:focus{border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem #0d6efd40}.form-select[multiple][_ngcontent-%COMP%], .form-select[size][_ngcontent-%COMP%]:not([size=\"1\"]){padding-right:.75rem;background-image:none}.form-select[_ngcontent-%COMP%]:disabled{background-color:var(--bs-secondary-bg)}.form-select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 var(--bs-body-color)}.form-select-sm[_ngcontent-%COMP%]{padding-top:.25rem;padding-bottom:.25rem;padding-left:.5rem;font-size:.875rem;border-radius:var(--bs-border-radius-sm)}.form-select-lg[_ngcontent-%COMP%]{padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;font-size:1.25rem;border-radius:var(--bs-border-radius-lg)}[data-bs-theme=dark][_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{--bs-form-select-bg-img:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23dee2e6' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e\")}.form-check[_ngcontent-%COMP%]{display:block;min-height:1.5rem;padding-left:1.5em;margin-bottom:.125rem}.form-check[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{float:left;margin-left:-1.5em}.form-check-reverse[_ngcontent-%COMP%]{padding-right:1.5em;padding-left:0;text-align:right}.form-check-reverse[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{float:right;margin-right:-1.5em;margin-left:0}.form-check-input[_ngcontent-%COMP%]{--bs-form-check-bg:var(--bs-body-bg);flex-shrink:0;width:1em;height:1em;margin-top:.25em;vertical-align:top;appearance:none;background-color:var(--bs-form-check-bg);background-image:var(--bs-form-check-bg-image);background-repeat:no-repeat;background-position:center;background-size:contain;border:var(--bs-border-width) solid var(--bs-border-color);-webkit-print-color-adjust:exact;print-color-adjust:exact}.form-check-input[type=checkbox][_ngcontent-%COMP%]{border-radius:.25em}.form-check-input[type=radio][_ngcontent-%COMP%]{border-radius:50%}.form-check-input[_ngcontent-%COMP%]:active{filter:brightness(90%)}.form-check-input[_ngcontent-%COMP%]:focus{border-color:#86b7fe;outline:0;box-shadow:0 0 0 .25rem #0d6efd40}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#0d6efd;border-color:#0d6efd}.form-check-input[_ngcontent-%COMP%]:checked[type=checkbox]{--bs-form-check-bg-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='3' d='m6 10 3 3 6-6'/%3e%3c/svg%3e\")}.form-check-input[_ngcontent-%COMP%]:checked[type=radio]{--bs-form-check-bg-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='2' fill='%23fff'/%3e%3c/svg%3e\")}.form-check-input[type=checkbox][_ngcontent-%COMP%]:indeterminate{background-color:#0d6efd;border-color:#0d6efd;--bs-form-check-bg-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3e%3cpath fill='none' stroke='%23fff' stroke-linecap='round' stroke-linejoin='round' stroke-width='3' d='M6 10h8'/%3e%3c/svg%3e\")}.form-check-input[_ngcontent-%COMP%]:disabled{pointer-events:none;filter:none;opacity:.5}.form-check-input[_ngcontent-%COMP%]:disabled ~ .form-check-label[_ngcontent-%COMP%], .form-check-input[disabled][_ngcontent-%COMP%] ~ .form-check-label[_ngcontent-%COMP%]{cursor:default;opacity:.5}.form-switch[_ngcontent-%COMP%]{padding-left:2.5em}.form-switch[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{--bs-form-switch-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='rgba%280, 0, 0, 0.25%29'/%3e%3c/svg%3e\");width:2em;margin-left:-2.5em;background-image:var(--bs-form-switch-bg);background-position:left center;border-radius:2em;transition:background-position .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-switch[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{transition:none}}.form-switch[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:focus{--bs-form-switch-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%2386b7fe'/%3e%3c/svg%3e\")}.form-switch[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:checked{background-position:right center;--bs-form-switch-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='%23fff'/%3e%3c/svg%3e\")}.form-switch.form-check-reverse[_ngcontent-%COMP%]{padding-right:2.5em;padding-left:0}.form-switch.form-check-reverse[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{margin-right:-2.5em;margin-left:0}.form-check-inline[_ngcontent-%COMP%]{display:inline-block;margin-right:1rem}.btn-check[_ngcontent-%COMP%]{position:absolute;clip:rect(0,0,0,0);pointer-events:none}.btn-check[_ngcontent-%COMP%]:disabled + .btn[_ngcontent-%COMP%], .btn-check[disabled][_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{pointer-events:none;filter:none;opacity:.65}[data-bs-theme=dark][_ngcontent-%COMP%]   .form-switch[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:not(:checked):not(:focus){--bs-form-switch-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='-4 -4 8 8'%3e%3ccircle r='3' fill='rgba%28255, 255, 255, 0.25%29'/%3e%3c/svg%3e\")}.form-range[_ngcontent-%COMP%]{width:100%;height:1.5rem;padding:0;appearance:none;background-color:transparent}.form-range[_ngcontent-%COMP%]:focus{outline:0}.form-range[_ngcontent-%COMP%]:focus::-webkit-slider-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .25rem #0d6efd40}.form-range[_ngcontent-%COMP%]:focus::-moz-range-thumb{box-shadow:0 0 0 1px #fff,0 0 0 .25rem #0d6efd40}.form-range[_ngcontent-%COMP%]::-moz-focus-outer{border:0}.form-range[_ngcontent-%COMP%]::-webkit-slider-thumb{width:1rem;height:1rem;margin-top:-.25rem;appearance:none;background-color:#0d6efd;border:0;border-radius:1rem;-webkit-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-range[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-transition:none;transition:none}}.form-range[_ngcontent-%COMP%]::-webkit-slider-thumb:active{background-color:#b6d4fe}.form-range[_ngcontent-%COMP%]::-webkit-slider-runnable-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:var(--bs-secondary-bg);border-color:transparent;border-radius:1rem}.form-range[_ngcontent-%COMP%]::-moz-range-thumb{width:1rem;height:1rem;appearance:none;background-color:#0d6efd;border:0;border-radius:1rem;-moz-transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;transition:background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.form-range[_ngcontent-%COMP%]::-moz-range-thumb{-moz-transition:none;transition:none}}.form-range[_ngcontent-%COMP%]::-moz-range-thumb:active{background-color:#b6d4fe}.form-range[_ngcontent-%COMP%]::-moz-range-track{width:100%;height:.5rem;color:transparent;cursor:pointer;background-color:var(--bs-secondary-bg);border-color:transparent;border-radius:1rem}.form-range[_ngcontent-%COMP%]:disabled{pointer-events:none}.form-range[_ngcontent-%COMP%]:disabled::-webkit-slider-thumb{background-color:var(--bs-secondary-color)}.form-range[_ngcontent-%COMP%]:disabled::-moz-range-thumb{background-color:var(--bs-secondary-color)}.form-floating[_ngcontent-%COMP%]{position:relative}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]{height:calc(3.5rem + calc(var(--bs-border-width) * 2));min-height:calc(3.5rem + calc(var(--bs-border-width) * 2));line-height:1.25}.form-floating[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:2;height:100%;padding:1rem .75rem;overflow:hidden;text-align:start;text-overflow:ellipsis;white-space:nowrap;pointer-events:none;border:var(--bs-border-width) solid transparent;transform-origin:0 0;transition:opacity .1s ease-in-out,transform .1s ease-in-out}@media (prefers-reduced-motion:reduce){.form-floating[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{transition:none}}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%]{padding:1rem .75rem}.form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%]::placeholder, .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]::placeholder{color:transparent}.form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%]:focus, .form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%]:not(:placeholder-shown), .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:focus, .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:placeholder-shown){padding-top:1.625rem;padding-bottom:.625rem}.form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%]:-webkit-autofill, .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:-webkit-autofill{padding-top:1.625rem;padding-bottom:.625rem}.form-floating[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]{padding-top:1.625rem;padding-bottom:.625rem}.form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%] ~ label[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:placeholder-shown) ~ label[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%] ~ label[_ngcontent-%COMP%]{color:rgba(var(--bs-body-color-rgb),.65);transform:scale(.85) translateY(-.5rem) translate(.15rem)}.form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%] ~ label[_ngcontent-%COMP%]:after, .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:focus ~ label[_ngcontent-%COMP%]:after, .form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:placeholder-shown) ~ label[_ngcontent-%COMP%]:after, .form-floating[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%] ~ label[_ngcontent-%COMP%]:after{position:absolute;inset:1rem .375rem;z-index:-1;height:1.5em;content:\"\";background-color:var(--bs-body-bg);border-radius:var(--bs-border-radius)}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:-webkit-autofill ~ label[_ngcontent-%COMP%]{color:rgba(var(--bs-body-color-rgb),.65);transform:scale(.85) translateY(-.5rem) translate(.15rem)}.form-floating[_ngcontent-%COMP%] > .form-control-plaintext[_ngcontent-%COMP%] ~ label[_ngcontent-%COMP%]{border-width:var(--bs-border-width) 0}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:disabled ~ label[_ngcontent-%COMP%], .form-floating[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:disabled ~ label[_ngcontent-%COMP%]{color:#6c757d}.form-floating[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:disabled ~ label[_ngcontent-%COMP%]:after, .form-floating[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:disabled ~ label[_ngcontent-%COMP%]:after{background-color:var(--bs-secondary-bg)}.input-group[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.input-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]{position:relative;flex:1 1 auto;width:1%;min-width:0}.input-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:focus, .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:focus-within, .input-group[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:focus{z-index:5}.input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{position:relative;z-index:2}.input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:focus{z-index:5}.input-group-text[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:var(--bs-body-color);text-align:center;white-space:nowrap;background-color:var(--bs-tertiary-bg);border:var(--bs-border-width) solid var(--bs-border-color);border-radius:var(--bs-border-radius)}.input-group-lg[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%], .input-group-lg[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%], .input-group-lg[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%], .input-group-lg[_ngcontent-%COMP%] > .input-group-text[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:1.25rem;border-radius:var(--bs-border-radius-lg)}.input-group-sm[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%], .input-group-sm[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%], .input-group-sm[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%], .input-group-sm[_ngcontent-%COMP%] > .input-group-text[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.875rem;border-radius:var(--bs-border-radius-sm)}.input-group-lg[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%], .input-group-sm[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]{padding-right:3rem}.input-group[_ngcontent-%COMP%]:not(.has-validation) > .dropdown-toggle[_ngcontent-%COMP%]:nth-last-child(n+3), .input-group[_ngcontent-%COMP%]:not(.has-validation) > .form-floating[_ngcontent-%COMP%]:not(:last-child) > .form-control[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]:not(.has-validation) > .form-floating[_ngcontent-%COMP%]:not(:last-child) > .form-select[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]:not(.has-validation) > [_ngcontent-%COMP%]:not(:last-child):not(.dropdown-toggle):not(.dropdown-menu):not(.form-floating){border-top-right-radius:0;border-bottom-right-radius:0}.input-group.has-validation[_ngcontent-%COMP%] > .dropdown-toggle[_ngcontent-%COMP%]:nth-last-child(n+4), .input-group.has-validation[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:nth-last-child(n+3) > .form-control[_ngcontent-%COMP%], .input-group.has-validation[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:nth-last-child(n+3) > .form-select[_ngcontent-%COMP%], .input-group.has-validation[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:nth-last-child(n+3):not(.dropdown-toggle):not(.dropdown-menu):not(.form-floating){border-top-right-radius:0;border-bottom-right-radius:0}.input-group[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:first-child):not(.dropdown-menu):not(.valid-tooltip):not(.valid-feedback):not(.invalid-tooltip):not(.invalid-feedback){margin-left:calc(var(--bs-border-width) * -1);border-top-left-radius:0;border-bottom-left-radius:0}.input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:not(:first-child) > .form-control[_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:not(:first-child) > .form-select[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}.valid-feedback[_ngcontent-%COMP%]{display:none;width:100%;margin-top:.25rem;font-size:.875em;color:var(--bs-form-valid-color)}.valid-tooltip[_ngcontent-%COMP%]{position:absolute;top:100%;z-index:5;display:none;max-width:100%;padding:.25rem .5rem;margin-top:.1rem;font-size:.875rem;color:#fff;background-color:var(--bs-success);border-radius:var(--bs-border-radius)}.is-valid[_ngcontent-%COMP%] ~ .valid-feedback[_ngcontent-%COMP%], .is-valid[_ngcontent-%COMP%] ~ .valid-tooltip[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:valid ~ .valid-feedback[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:valid ~ .valid-tooltip[_ngcontent-%COMP%]{display:block}.form-control.is-valid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:valid{border-color:var(--bs-form-valid-border-color);padding-right:calc(1.5em + .75rem);background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e\");background-repeat:no-repeat;background-position:right calc(.375em + .1875rem) center;background-size:calc(.75em + .375rem) calc(.75em + .375rem)}.form-control.is-valid[_ngcontent-%COMP%]:focus, .was-validated[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:valid:focus{border-color:var(--bs-form-valid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-success-rgb),.25)}.was-validated[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]:valid, textarea.form-control.is-valid[_ngcontent-%COMP%]{padding-right:calc(1.5em + .75rem);background-position:top calc(.375em + .1875rem) right calc(.375em + .1875rem)}.form-select.is-valid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:valid{border-color:var(--bs-form-valid-border-color)}.form-select.is-valid[_ngcontent-%COMP%]:not([multiple]):not([size]), .form-select.is-valid[_ngcontent-%COMP%]:not([multiple])[size=\"1\"], .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:valid:not([multiple]):not([size]), .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:valid:not([multiple])[size=\"1\"]{--bs-form-select-bg-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e\");padding-right:4.125rem;background-position:right .75rem center,center right 2.25rem;background-size:16px 12px,calc(.75em + .375rem) calc(.75em + .375rem)}.form-select.is-valid[_ngcontent-%COMP%]:focus, .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:valid:focus{border-color:var(--bs-form-valid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-success-rgb),.25)}.form-control-color.is-valid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-control-color[_ngcontent-%COMP%]:valid{width:calc(3.75rem + 1.5em)}.form-check-input.is-valid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:valid{border-color:var(--bs-form-valid-border-color)}.form-check-input.is-valid[_ngcontent-%COMP%]:checked, .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:valid:checked{background-color:var(--bs-form-valid-color)}.form-check-input.is-valid[_ngcontent-%COMP%]:focus, .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:valid:focus{box-shadow:0 0 0 .25rem rgba(var(--bs-success-rgb),.25)}.form-check-input.is-valid[_ngcontent-%COMP%] ~ .form-check-label[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:valid ~ .form-check-label[_ngcontent-%COMP%]{color:var(--bs-form-valid-color)}.form-check-inline[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%] ~ .valid-feedback[_ngcontent-%COMP%]{margin-left:.5em}.input-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:focus).is-valid, .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:not(:focus-within).is-valid, .input-group[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:not(:focus).is-valid, .was-validated[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:focus):valid, .was-validated[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:not(:focus-within):valid, .was-validated[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:not(:focus):valid{z-index:3}.invalid-feedback[_ngcontent-%COMP%]{display:none;width:100%;margin-top:.25rem;font-size:.875em;color:var(--bs-form-invalid-color)}.invalid-tooltip[_ngcontent-%COMP%]{position:absolute;top:100%;z-index:5;display:none;max-width:100%;padding:.25rem .5rem;margin-top:.1rem;font-size:.875rem;color:#fff;background-color:var(--bs-danger);border-radius:var(--bs-border-radius)}.is-invalid[_ngcontent-%COMP%] ~ .invalid-feedback[_ngcontent-%COMP%], .is-invalid[_ngcontent-%COMP%] ~ .invalid-tooltip[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:invalid ~ .invalid-feedback[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:invalid ~ .invalid-tooltip[_ngcontent-%COMP%]{display:block}.form-control.is-invalid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:invalid{border-color:var(--bs-form-invalid-border-color);padding-right:calc(1.5em + .75rem);background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e\");background-repeat:no-repeat;background-position:right calc(.375em + .1875rem) center;background-size:calc(.75em + .375rem) calc(.75em + .375rem)}.form-control.is-invalid[_ngcontent-%COMP%]:focus, .was-validated[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:invalid:focus{border-color:var(--bs-form-invalid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-danger-rgb),.25)}.was-validated[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]:invalid, textarea.form-control.is-invalid[_ngcontent-%COMP%]{padding-right:calc(1.5em + .75rem);background-position:top calc(.375em + .1875rem) right calc(.375em + .1875rem)}.form-select.is-invalid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:invalid{border-color:var(--bs-form-invalid-border-color)}.form-select.is-invalid[_ngcontent-%COMP%]:not([multiple]):not([size]), .form-select.is-invalid[_ngcontent-%COMP%]:not([multiple])[size=\"1\"], .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:invalid:not([multiple]):not([size]), .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:invalid:not([multiple])[size=\"1\"]{--bs-form-select-bg-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e\");padding-right:4.125rem;background-position:right .75rem center,center right 2.25rem;background-size:16px 12px,calc(.75em + .375rem) calc(.75em + .375rem)}.form-select.is-invalid[_ngcontent-%COMP%]:focus, .was-validated[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]:invalid:focus{border-color:var(--bs-form-invalid-border-color);box-shadow:0 0 0 .25rem rgba(var(--bs-danger-rgb),.25)}.form-control-color.is-invalid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-control-color[_ngcontent-%COMP%]:invalid{width:calc(3.75rem + 1.5em)}.form-check-input.is-invalid[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:invalid{border-color:var(--bs-form-invalid-border-color)}.form-check-input.is-invalid[_ngcontent-%COMP%]:checked, .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:invalid:checked{background-color:var(--bs-form-invalid-color)}.form-check-input.is-invalid[_ngcontent-%COMP%]:focus, .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:invalid:focus{box-shadow:0 0 0 .25rem rgba(var(--bs-danger-rgb),.25)}.form-check-input.is-invalid[_ngcontent-%COMP%] ~ .form-check-label[_ngcontent-%COMP%], .was-validated[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]:invalid ~ .form-check-label[_ngcontent-%COMP%]{color:var(--bs-form-invalid-color)}.form-check-inline[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%] ~ .invalid-feedback[_ngcontent-%COMP%]{margin-left:.5em}.input-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:focus).is-invalid, .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:not(:focus-within).is-invalid, .input-group[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:not(:focus).is-invalid, .was-validated[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]:not(:focus):invalid, .was-validated[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] > .form-floating[_ngcontent-%COMP%]:not(:focus-within):invalid, .was-validated[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%] > .form-select[_ngcontent-%COMP%]:not(:focus):invalid{z-index:4}.btn[_ngcontent-%COMP%]{--bs-btn-padding-x:.75rem;--bs-btn-padding-y:.375rem;--bs-btn-font-family: ;--bs-btn-font-size:1rem;--bs-btn-font-weight:400;--bs-btn-line-height:1.5;--bs-btn-color:var(--bs-body-color);--bs-btn-bg:transparent;--bs-btn-border-width:var(--bs-border-width);--bs-btn-border-color:transparent;--bs-btn-border-radius:var(--bs-border-radius);--bs-btn-hover-border-color:transparent;--bs-btn-box-shadow:inset 0 1px 0 rgba(255, 255, 255, .15),0 1px 1px rgba(0, 0, 0, .075);--bs-btn-disabled-opacity:.65;--bs-btn-focus-box-shadow:0 0 0 .25rem rgba(var(--bs-btn-focus-shadow-rgb), .5);display:inline-block;padding:var(--bs-btn-padding-y) var(--bs-btn-padding-x);font-family:var(--bs-btn-font-family);font-size:var(--bs-btn-font-size);font-weight:var(--bs-btn-font-weight);line-height:var(--bs-btn-line-height);color:var(--bs-btn-color);text-align:center;text-decoration:none;vertical-align:middle;cursor:pointer;-webkit-user-select:none;user-select:none;border:var(--bs-btn-border-width) solid var(--bs-btn-border-color);border-radius:var(--bs-btn-border-radius);background-color:var(--bs-btn-bg);transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.btn[_ngcontent-%COMP%]{transition:none}}.btn[_ngcontent-%COMP%]:hover{color:var(--bs-btn-hover-color);background-color:var(--bs-btn-hover-bg);border-color:var(--bs-btn-hover-border-color)}.btn-check[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]:hover{color:var(--bs-btn-color);background-color:var(--bs-btn-bg);border-color:var(--bs-btn-border-color)}.btn[_ngcontent-%COMP%]:focus-visible{color:var(--bs-btn-hover-color);background-color:var(--bs-btn-hover-bg);border-color:var(--bs-btn-hover-border-color);outline:0;box-shadow:var(--bs-btn-focus-box-shadow)}.btn-check[_ngcontent-%COMP%]:focus-visible + .btn[_ngcontent-%COMP%]{border-color:var(--bs-btn-hover-border-color);outline:0;box-shadow:var(--bs-btn-focus-box-shadow)}.btn-check[_ngcontent-%COMP%]:checked + .btn[_ngcontent-%COMP%], .btn.active[_ngcontent-%COMP%], .btn.show[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]:first-child:active, [_ngcontent-%COMP%]:not(.btn-check) + .btn[_ngcontent-%COMP%]:active{color:var(--bs-btn-active-color);background-color:var(--bs-btn-active-bg);border-color:var(--bs-btn-active-border-color)}.btn-check[_ngcontent-%COMP%]:checked + .btn[_ngcontent-%COMP%]:focus-visible, .btn.active[_ngcontent-%COMP%]:focus-visible, .btn.show[_ngcontent-%COMP%]:focus-visible, .btn[_ngcontent-%COMP%]:first-child:active:focus-visible, [_ngcontent-%COMP%]:not(.btn-check) + .btn[_ngcontent-%COMP%]:active:focus-visible{box-shadow:var(--bs-btn-focus-box-shadow)}.btn-check[_ngcontent-%COMP%]:checked:focus-visible + .btn[_ngcontent-%COMP%]{box-shadow:var(--bs-btn-focus-box-shadow)}.btn.disabled[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]:disabled, fieldset[_ngcontent-%COMP%]:disabled   .btn[_ngcontent-%COMP%]{color:var(--bs-btn-disabled-color);pointer-events:none;background-color:var(--bs-btn-disabled-bg);border-color:var(--bs-btn-disabled-border-color);opacity:var(--bs-btn-disabled-opacity)}.btn-primary[_ngcontent-%COMP%]{--bs-btn-color:#fff;--bs-btn-bg:#0d6efd;--bs-btn-border-color:#0d6efd;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#0b5ed7;--bs-btn-hover-border-color:#0a58ca;--bs-btn-focus-shadow-rgb:49,132,253;--bs-btn-active-color:#fff;--bs-btn-active-bg:#0a58ca;--bs-btn-active-border-color:#0a53be;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#0d6efd;--bs-btn-disabled-border-color:#0d6efd}.btn-secondary[_ngcontent-%COMP%]{--bs-btn-color:#fff;--bs-btn-bg:#6c757d;--bs-btn-border-color:#6c757d;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#5c636a;--bs-btn-hover-border-color:#565e64;--bs-btn-focus-shadow-rgb:130,138,145;--bs-btn-active-color:#fff;--bs-btn-active-bg:#565e64;--bs-btn-active-border-color:#51585e;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#6c757d;--bs-btn-disabled-border-color:#6c757d}.btn-success[_ngcontent-%COMP%]{--bs-btn-color:#fff;--bs-btn-bg:#198754;--bs-btn-border-color:#198754;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#157347;--bs-btn-hover-border-color:#146c43;--bs-btn-focus-shadow-rgb:60,153,110;--bs-btn-active-color:#fff;--bs-btn-active-bg:#146c43;--bs-btn-active-border-color:#13653f;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#198754;--bs-btn-disabled-border-color:#198754}.btn-info[_ngcontent-%COMP%]{--bs-btn-color:#000;--bs-btn-bg:#0dcaf0;--bs-btn-border-color:#0dcaf0;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#31d2f2;--bs-btn-hover-border-color:#25cff2;--bs-btn-focus-shadow-rgb:11,172,204;--bs-btn-active-color:#000;--bs-btn-active-bg:#3dd5f3;--bs-btn-active-border-color:#25cff2;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#000;--bs-btn-disabled-bg:#0dcaf0;--bs-btn-disabled-border-color:#0dcaf0}.btn-warning[_ngcontent-%COMP%]{--bs-btn-color:#000;--bs-btn-bg:#ffc107;--bs-btn-border-color:#ffc107;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#ffca2c;--bs-btn-hover-border-color:#ffc720;--bs-btn-focus-shadow-rgb:217,164,6;--bs-btn-active-color:#000;--bs-btn-active-bg:#ffcd39;--bs-btn-active-border-color:#ffc720;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#000;--bs-btn-disabled-bg:#ffc107;--bs-btn-disabled-border-color:#ffc107}.btn-danger[_ngcontent-%COMP%]{--bs-btn-color:#fff;--bs-btn-bg:#dc3545;--bs-btn-border-color:#dc3545;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#bb2d3b;--bs-btn-hover-border-color:#b02a37;--bs-btn-focus-shadow-rgb:225,83,97;--bs-btn-active-color:#fff;--bs-btn-active-bg:#b02a37;--bs-btn-active-border-color:#a52834;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#dc3545;--bs-btn-disabled-border-color:#dc3545}.btn-light[_ngcontent-%COMP%]{--bs-btn-color:#000;--bs-btn-bg:#f8f9fa;--bs-btn-border-color:#f8f9fa;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#d3d4d5;--bs-btn-hover-border-color:#c6c7c8;--bs-btn-focus-shadow-rgb:211,212,213;--bs-btn-active-color:#000;--bs-btn-active-bg:#c6c7c8;--bs-btn-active-border-color:#babbbc;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#000;--bs-btn-disabled-bg:#f8f9fa;--bs-btn-disabled-border-color:#f8f9fa}.btn-dark[_ngcontent-%COMP%]{--bs-btn-color:#fff;--bs-btn-bg:#212529;--bs-btn-border-color:#212529;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#424649;--bs-btn-hover-border-color:#373b3e;--bs-btn-focus-shadow-rgb:66,70,73;--bs-btn-active-color:#fff;--bs-btn-active-bg:#4d5154;--bs-btn-active-border-color:#373b3e;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#fff;--bs-btn-disabled-bg:#212529;--bs-btn-disabled-border-color:#212529}.btn-outline-primary[_ngcontent-%COMP%]{--bs-btn-color:#0d6efd;--bs-btn-border-color:#0d6efd;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#0d6efd;--bs-btn-hover-border-color:#0d6efd;--bs-btn-focus-shadow-rgb:13,110,253;--bs-btn-active-color:#fff;--bs-btn-active-bg:#0d6efd;--bs-btn-active-border-color:#0d6efd;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#0d6efd;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#0d6efd;--bs-gradient:none}.btn-outline-secondary[_ngcontent-%COMP%]{--bs-btn-color:#6c757d;--bs-btn-border-color:#6c757d;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#6c757d;--bs-btn-hover-border-color:#6c757d;--bs-btn-focus-shadow-rgb:108,117,125;--bs-btn-active-color:#fff;--bs-btn-active-bg:#6c757d;--bs-btn-active-border-color:#6c757d;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#6c757d;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#6c757d;--bs-gradient:none}.btn-outline-success[_ngcontent-%COMP%]{--bs-btn-color:#198754;--bs-btn-border-color:#198754;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#198754;--bs-btn-hover-border-color:#198754;--bs-btn-focus-shadow-rgb:25,135,84;--bs-btn-active-color:#fff;--bs-btn-active-bg:#198754;--bs-btn-active-border-color:#198754;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#198754;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#198754;--bs-gradient:none}.btn-outline-info[_ngcontent-%COMP%]{--bs-btn-color:#0dcaf0;--bs-btn-border-color:#0dcaf0;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#0dcaf0;--bs-btn-hover-border-color:#0dcaf0;--bs-btn-focus-shadow-rgb:13,202,240;--bs-btn-active-color:#000;--bs-btn-active-bg:#0dcaf0;--bs-btn-active-border-color:#0dcaf0;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#0dcaf0;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#0dcaf0;--bs-gradient:none}.btn-outline-warning[_ngcontent-%COMP%]{--bs-btn-color:#ffc107;--bs-btn-border-color:#ffc107;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#ffc107;--bs-btn-hover-border-color:#ffc107;--bs-btn-focus-shadow-rgb:255,193,7;--bs-btn-active-color:#000;--bs-btn-active-bg:#ffc107;--bs-btn-active-border-color:#ffc107;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#ffc107;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#ffc107;--bs-gradient:none}.btn-outline-danger[_ngcontent-%COMP%]{--bs-btn-color:#dc3545;--bs-btn-border-color:#dc3545;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#dc3545;--bs-btn-hover-border-color:#dc3545;--bs-btn-focus-shadow-rgb:220,53,69;--bs-btn-active-color:#fff;--bs-btn-active-bg:#dc3545;--bs-btn-active-border-color:#dc3545;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#dc3545;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#dc3545;--bs-gradient:none}.btn-outline-light[_ngcontent-%COMP%]{--bs-btn-color:#f8f9fa;--bs-btn-border-color:#f8f9fa;--bs-btn-hover-color:#000;--bs-btn-hover-bg:#f8f9fa;--bs-btn-hover-border-color:#f8f9fa;--bs-btn-focus-shadow-rgb:248,249,250;--bs-btn-active-color:#000;--bs-btn-active-bg:#f8f9fa;--bs-btn-active-border-color:#f8f9fa;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#f8f9fa;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#f8f9fa;--bs-gradient:none}.btn-outline-dark[_ngcontent-%COMP%]{--bs-btn-color:#212529;--bs-btn-border-color:#212529;--bs-btn-hover-color:#fff;--bs-btn-hover-bg:#212529;--bs-btn-hover-border-color:#212529;--bs-btn-focus-shadow-rgb:33,37,41;--bs-btn-active-color:#fff;--bs-btn-active-bg:#212529;--bs-btn-active-border-color:#212529;--bs-btn-active-shadow:inset 0 3px 5px rgba(0, 0, 0, .125);--bs-btn-disabled-color:#212529;--bs-btn-disabled-bg:transparent;--bs-btn-disabled-border-color:#212529;--bs-gradient:none}.btn-link[_ngcontent-%COMP%]{--bs-btn-font-weight:400;--bs-btn-color:var(--bs-link-color);--bs-btn-bg:transparent;--bs-btn-border-color:transparent;--bs-btn-hover-color:var(--bs-link-hover-color);--bs-btn-hover-border-color:transparent;--bs-btn-active-color:var(--bs-link-hover-color);--bs-btn-active-border-color:transparent;--bs-btn-disabled-color:#6c757d;--bs-btn-disabled-border-color:transparent;--bs-btn-box-shadow:0 0 0 #000;--bs-btn-focus-shadow-rgb:49,132,253;text-decoration:underline}.btn-link[_ngcontent-%COMP%]:focus-visible{color:var(--bs-btn-color)}.btn-link[_ngcontent-%COMP%]:hover{color:var(--bs-btn-hover-color)}.btn-group-lg[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%], .btn-lg[_ngcontent-%COMP%]{--bs-btn-padding-y:.5rem;--bs-btn-padding-x:1rem;--bs-btn-font-size:1.25rem;--bs-btn-border-radius:var(--bs-border-radius-lg)}.btn-group-sm[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%], .btn-sm[_ngcontent-%COMP%]{--bs-btn-padding-y:.25rem;--bs-btn-padding-x:.5rem;--bs-btn-font-size:.875rem;--bs-btn-border-radius:var(--bs-border-radius-sm)}.fade[_ngcontent-%COMP%]{transition:opacity .15s linear}@media (prefers-reduced-motion:reduce){.fade[_ngcontent-%COMP%]{transition:none}}.fade[_ngcontent-%COMP%]:not(.show){opacity:0}.collapse[_ngcontent-%COMP%]:not(.show){display:none}.collapsing[_ngcontent-%COMP%]{height:0;overflow:hidden;transition:height .35s ease}@media (prefers-reduced-motion:reduce){.collapsing[_ngcontent-%COMP%]{transition:none}}.collapsing.collapse-horizontal[_ngcontent-%COMP%]{width:0;height:auto;transition:width .35s ease}@media (prefers-reduced-motion:reduce){.collapsing.collapse-horizontal[_ngcontent-%COMP%]{transition:none}}.dropdown[_ngcontent-%COMP%], .dropdown-center[_ngcontent-%COMP%], .dropend[_ngcontent-%COMP%], .dropstart[_ngcontent-%COMP%], .dropup[_ngcontent-%COMP%], .dropup-center[_ngcontent-%COMP%]{position:relative}.dropdown-toggle[_ngcontent-%COMP%]{white-space:nowrap}.dropdown-toggle[_ngcontent-%COMP%]:after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:\"\";border-top:.3em solid;border-right:.3em solid transparent;border-bottom:0;border-left:.3em solid transparent}.dropdown-toggle[_ngcontent-%COMP%]:empty:after{margin-left:0}.dropdown-menu[_ngcontent-%COMP%]{--bs-dropdown-zindex:1000;--bs-dropdown-min-width:10rem;--bs-dropdown-padding-x:0;--bs-dropdown-padding-y:.5rem;--bs-dropdown-spacer:.125rem;--bs-dropdown-font-size:1rem;--bs-dropdown-color:var(--bs-body-color);--bs-dropdown-bg:var(--bs-body-bg);--bs-dropdown-border-color:var(--bs-border-color-translucent);--bs-dropdown-border-radius:var(--bs-border-radius);--bs-dropdown-border-width:var(--bs-border-width);--bs-dropdown-inner-border-radius:calc(var(--bs-border-radius) - var(--bs-border-width));--bs-dropdown-divider-bg:var(--bs-border-color-translucent);--bs-dropdown-divider-margin-y:.5rem;--bs-dropdown-box-shadow:var(--bs-box-shadow);--bs-dropdown-link-color:var(--bs-body-color);--bs-dropdown-link-hover-color:var(--bs-body-color);--bs-dropdown-link-hover-bg:var(--bs-tertiary-bg);--bs-dropdown-link-active-color:#fff;--bs-dropdown-link-active-bg:#0d6efd;--bs-dropdown-link-disabled-color:var(--bs-tertiary-color);--bs-dropdown-item-padding-x:1rem;--bs-dropdown-item-padding-y:.25rem;--bs-dropdown-header-color:#6c757d;--bs-dropdown-header-padding-x:1rem;--bs-dropdown-header-padding-y:.5rem;position:absolute;z-index:var(--bs-dropdown-zindex);display:none;min-width:var(--bs-dropdown-min-width);padding:var(--bs-dropdown-padding-y) var(--bs-dropdown-padding-x);margin:0;font-size:var(--bs-dropdown-font-size);color:var(--bs-dropdown-color);text-align:left;list-style:none;background-color:var(--bs-dropdown-bg);background-clip:padding-box;border:var(--bs-dropdown-border-width) solid var(--bs-dropdown-border-color);border-radius:var(--bs-dropdown-border-radius)}.dropdown-menu[data-bs-popper][_ngcontent-%COMP%]{top:100%;left:0;margin-top:var(--bs-dropdown-spacer)}.dropdown-menu-start[_ngcontent-%COMP%]{--bs-position:start}.dropdown-menu-start[data-bs-popper][_ngcontent-%COMP%]{right:auto;left:0}.dropdown-menu-end[_ngcontent-%COMP%]{--bs-position:end}.dropdown-menu-end[data-bs-popper][_ngcontent-%COMP%]{right:0;left:auto}@media (min-width:576px){.dropdown-menu-sm-start[_ngcontent-%COMP%]{--bs-position:start}.dropdown-menu-sm-start[data-bs-popper][_ngcontent-%COMP%]{right:auto;left:0}.dropdown-menu-sm-end[_ngcontent-%COMP%]{--bs-position:end}.dropdown-menu-sm-end[data-bs-popper][_ngcontent-%COMP%]{right:0;left:auto}}@media (min-width:768px){.dropdown-menu-md-start[_ngcontent-%COMP%]{--bs-position:start}.dropdown-menu-md-start[data-bs-popper][_ngcontent-%COMP%]{right:auto;left:0}.dropdown-menu-md-end[_ngcontent-%COMP%]{--bs-position:end}.dropdown-menu-md-end[data-bs-popper][_ngcontent-%COMP%]{right:0;left:auto}}@media (min-width:992px){.dropdown-menu-lg-start[_ngcontent-%COMP%]{--bs-position:start}.dropdown-menu-lg-start[data-bs-popper][_ngcontent-%COMP%]{right:auto;left:0}.dropdown-menu-lg-end[_ngcontent-%COMP%]{--bs-position:end}.dropdown-menu-lg-end[data-bs-popper][_ngcontent-%COMP%]{right:0;left:auto}}@media (min-width:1200px){.dropdown-menu-xl-start[_ngcontent-%COMP%]{--bs-position:start}.dropdown-menu-xl-start[data-bs-popper][_ngcontent-%COMP%]{right:auto;left:0}.dropdown-menu-xl-end[_ngcontent-%COMP%]{--bs-position:end}.dropdown-menu-xl-end[data-bs-popper][_ngcontent-%COMP%]{right:0;left:auto}}@media (min-width:1400px){.dropdown-menu-xxl-start[_ngcontent-%COMP%]{--bs-position:start}.dropdown-menu-xxl-start[data-bs-popper][_ngcontent-%COMP%]{right:auto;left:0}.dropdown-menu-xxl-end[_ngcontent-%COMP%]{--bs-position:end}.dropdown-menu-xxl-end[data-bs-popper][_ngcontent-%COMP%]{right:0;left:auto}}.dropup[_ngcontent-%COMP%]   .dropdown-menu[data-bs-popper][_ngcontent-%COMP%]{top:auto;bottom:100%;margin-top:0;margin-bottom:var(--bs-dropdown-spacer)}.dropup[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:\"\";border-top:0;border-right:.3em solid transparent;border-bottom:.3em solid;border-left:.3em solid transparent}.dropup[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:empty:after{margin-left:0}.dropend[_ngcontent-%COMP%]   .dropdown-menu[data-bs-popper][_ngcontent-%COMP%]{top:0;right:auto;left:100%;margin-top:0;margin-left:var(--bs-dropdown-spacer)}.dropend[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:\"\";border-top:.3em solid transparent;border-right:0;border-bottom:.3em solid transparent;border-left:.3em solid}.dropend[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:empty:after{margin-left:0}.dropend[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:after{vertical-align:0}.dropstart[_ngcontent-%COMP%]   .dropdown-menu[data-bs-popper][_ngcontent-%COMP%]{top:0;right:100%;left:auto;margin-top:0;margin-right:var(--bs-dropdown-spacer)}.dropstart[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:after{display:inline-block;margin-left:.255em;vertical-align:.255em;content:\"\";display:none}.dropstart[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:before{display:inline-block;margin-right:.255em;vertical-align:.255em;content:\"\";border-top:.3em solid transparent;border-right:.3em solid;border-bottom:.3em solid transparent}.dropstart[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:empty:after{margin-left:0}.dropstart[_ngcontent-%COMP%]   .dropdown-toggle[_ngcontent-%COMP%]:before{vertical-align:0}.dropdown-divider[_ngcontent-%COMP%]{height:0;margin:var(--bs-dropdown-divider-margin-y) 0;overflow:hidden;border-top:1px solid var(--bs-dropdown-divider-bg);opacity:1}.dropdown-item[_ngcontent-%COMP%]{display:block;width:100%;padding:var(--bs-dropdown-item-padding-y) var(--bs-dropdown-item-padding-x);clear:both;font-weight:400;color:var(--bs-dropdown-link-color);text-align:inherit;text-decoration:none;white-space:nowrap;background-color:transparent;border:0;border-radius:var(--bs-dropdown-item-border-radius,0)}.dropdown-item[_ngcontent-%COMP%]:focus, .dropdown-item[_ngcontent-%COMP%]:hover{color:var(--bs-dropdown-link-hover-color);background-color:var(--bs-dropdown-link-hover-bg)}.dropdown-item.active[_ngcontent-%COMP%], .dropdown-item[_ngcontent-%COMP%]:active{color:var(--bs-dropdown-link-active-color);text-decoration:none;background-color:var(--bs-dropdown-link-active-bg)}.dropdown-item.disabled[_ngcontent-%COMP%], .dropdown-item[_ngcontent-%COMP%]:disabled{color:var(--bs-dropdown-link-disabled-color);pointer-events:none;background-color:transparent}.dropdown-menu.show[_ngcontent-%COMP%]{display:block}.dropdown-header[_ngcontent-%COMP%]{display:block;padding:var(--bs-dropdown-header-padding-y) var(--bs-dropdown-header-padding-x);margin-bottom:0;font-size:.875rem;color:var(--bs-dropdown-header-color);white-space:nowrap}.dropdown-item-text[_ngcontent-%COMP%]{display:block;padding:var(--bs-dropdown-item-padding-y) var(--bs-dropdown-item-padding-x);color:var(--bs-dropdown-link-color)}.dropdown-menu-dark[_ngcontent-%COMP%]{--bs-dropdown-color:#dee2e6;--bs-dropdown-bg:#343a40;--bs-dropdown-border-color:var(--bs-border-color-translucent);--bs-dropdown-box-shadow: ;--bs-dropdown-link-color:#dee2e6;--bs-dropdown-link-hover-color:#fff;--bs-dropdown-divider-bg:var(--bs-border-color-translucent);--bs-dropdown-link-hover-bg:rgba(255, 255, 255, .15);--bs-dropdown-link-active-color:#fff;--bs-dropdown-link-active-bg:#0d6efd;--bs-dropdown-link-disabled-color:#adb5bd;--bs-dropdown-header-color:#adb5bd}.btn-group[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%]{position:relative;display:inline-flex;vertical-align:middle}.btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%], .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]{position:relative;flex:1 1 auto}.btn-group-vertical[_ngcontent-%COMP%] > .btn-check[_ngcontent-%COMP%]:checked + .btn[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%] > .btn-check[_ngcontent-%COMP%]:focus + .btn[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%] > .btn.active[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:active, .btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:focus, .btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:hover, .btn-group[_ngcontent-%COMP%] > .btn-check[_ngcontent-%COMP%]:checked + .btn[_ngcontent-%COMP%], .btn-group[_ngcontent-%COMP%] > .btn-check[_ngcontent-%COMP%]:focus + .btn[_ngcontent-%COMP%], .btn-group[_ngcontent-%COMP%] > .btn.active[_ngcontent-%COMP%], .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:active, .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:focus, .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:hover{z-index:1}.btn-toolbar[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:flex-start}.btn-toolbar[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{width:auto}.btn-group[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius)}.btn-group[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]:not(:first-child), .btn-group[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(.btn-check:first-child) + .btn[_ngcontent-%COMP%]{margin-left:calc(var(--bs-border-width) * -1)}.btn-group[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]:not(:last-child) > .btn[_ngcontent-%COMP%], .btn-group[_ngcontent-%COMP%] > .btn.dropdown-toggle-split[_ngcontent-%COMP%]:first-child, .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:not(:last-child):not(.dropdown-toggle){border-top-right-radius:0;border-bottom-right-radius:0}.btn-group[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]:not(:first-child) > .btn[_ngcontent-%COMP%], .btn-group[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:nth-child(n+3), .btn-group[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(.btn-check) + .btn[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}.dropdown-toggle-split[_ngcontent-%COMP%]{padding-right:.5625rem;padding-left:.5625rem}.dropdown-toggle-split[_ngcontent-%COMP%]:after, .dropend[_ngcontent-%COMP%]   .dropdown-toggle-split[_ngcontent-%COMP%]:after, .dropup[_ngcontent-%COMP%]   .dropdown-toggle-split[_ngcontent-%COMP%]:after{margin-left:0}.dropstart[_ngcontent-%COMP%]   .dropdown-toggle-split[_ngcontent-%COMP%]:before{margin-right:0}.btn-group-sm[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%] + .dropdown-toggle-split[_ngcontent-%COMP%], .btn-sm[_ngcontent-%COMP%] + .dropdown-toggle-split[_ngcontent-%COMP%]{padding-right:.375rem;padding-left:.375rem}.btn-group-lg[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%] + .dropdown-toggle-split[_ngcontent-%COMP%], .btn-lg[_ngcontent-%COMP%] + .dropdown-toggle-split[_ngcontent-%COMP%]{padding-right:.75rem;padding-left:.75rem}.btn-group-vertical[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;justify-content:center}.btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]{width:100%}.btn-group-vertical[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]:not(:first-child), .btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:not(:first-child){margin-top:calc(var(--bs-border-width) * -1)}.btn-group-vertical[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]:not(:last-child) > .btn[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%]:not(:last-child):not(.dropdown-toggle){border-bottom-right-radius:0;border-bottom-left-radius:0}.btn-group-vertical[_ngcontent-%COMP%] > .btn-group[_ngcontent-%COMP%]:not(:first-child) > .btn[_ngcontent-%COMP%], .btn-group-vertical[_ngcontent-%COMP%] > .btn[_ngcontent-%COMP%] ~ .btn[_ngcontent-%COMP%]{border-top-left-radius:0;border-top-right-radius:0}.nav[_ngcontent-%COMP%]{--bs-nav-link-padding-x:1rem;--bs-nav-link-padding-y:.5rem;--bs-nav-link-font-weight: ;--bs-nav-link-color:var(--bs-link-color);--bs-nav-link-hover-color:var(--bs-link-hover-color);--bs-nav-link-disabled-color:var(--bs-secondary-color);display:flex;flex-wrap:wrap;padding-left:0;margin-bottom:0;list-style:none}.nav-link[_ngcontent-%COMP%]{display:block;padding:var(--bs-nav-link-padding-y) var(--bs-nav-link-padding-x);font-size:var(--bs-nav-link-font-size);font-weight:var(--bs-nav-link-font-weight);color:var(--bs-nav-link-color);text-decoration:none;background:0 0;border:0;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out}@media (prefers-reduced-motion:reduce){.nav-link[_ngcontent-%COMP%]{transition:none}}.nav-link[_ngcontent-%COMP%]:focus, .nav-link[_ngcontent-%COMP%]:hover{color:var(--bs-nav-link-hover-color)}.nav-link[_ngcontent-%COMP%]:focus-visible{outline:0;box-shadow:0 0 0 .25rem #0d6efd40}.nav-link.disabled[_ngcontent-%COMP%], .nav-link[_ngcontent-%COMP%]:disabled{color:var(--bs-nav-link-disabled-color);pointer-events:none;cursor:default}.nav-tabs[_ngcontent-%COMP%]{--bs-nav-tabs-border-width:var(--bs-border-width);--bs-nav-tabs-border-color:var(--bs-border-color);--bs-nav-tabs-border-radius:var(--bs-border-radius);--bs-nav-tabs-link-hover-border-color:var(--bs-secondary-bg) var(--bs-secondary-bg) var(--bs-border-color);--bs-nav-tabs-link-active-color:var(--bs-emphasis-color);--bs-nav-tabs-link-active-bg:var(--bs-body-bg);--bs-nav-tabs-link-active-border-color:var(--bs-border-color) var(--bs-border-color) var(--bs-body-bg);border-bottom:var(--bs-nav-tabs-border-width) solid var(--bs-nav-tabs-border-color)}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{margin-bottom:calc(-1 * var(--bs-nav-tabs-border-width));border:var(--bs-nav-tabs-border-width) solid transparent;border-top-left-radius:var(--bs-nav-tabs-border-radius);border-top-right-radius:var(--bs-nav-tabs-border-radius)}.nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:focus, .nav-tabs[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{isolation:isolate;border-color:var(--bs-nav-tabs-link-hover-border-color)}.nav-tabs[_ngcontent-%COMP%]   .nav-item.show[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .nav-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:var(--bs-nav-tabs-link-active-color);background-color:var(--bs-nav-tabs-link-active-bg);border-color:var(--bs-nav-tabs-link-active-border-color)}.nav-tabs[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{margin-top:calc(-1 * var(--bs-nav-tabs-border-width));border-top-left-radius:0;border-top-right-radius:0}.nav-pills[_ngcontent-%COMP%]{--bs-nav-pills-border-radius:var(--bs-border-radius);--bs-nav-pills-link-active-color:#fff;--bs-nav-pills-link-active-bg:#0d6efd}.nav-pills[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{border-radius:var(--bs-nav-pills-border-radius)}.nav-pills[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%], .nav-pills[_ngcontent-%COMP%]   .show[_ngcontent-%COMP%] > .nav-link[_ngcontent-%COMP%]{color:var(--bs-nav-pills-link-active-color);background-color:var(--bs-nav-pills-link-active-bg)}.nav-underline[_ngcontent-%COMP%]{--bs-nav-underline-gap:1rem;--bs-nav-underline-border-width:.125rem;--bs-nav-underline-link-active-color:var(--bs-emphasis-color);gap:var(--bs-nav-underline-gap)}.nav-underline[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:0;padding-left:0;border-bottom:var(--bs-nav-underline-border-width) solid transparent}.nav-underline[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:focus, .nav-underline[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{border-bottom-color:currentcolor}.nav-underline[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%], .nav-underline[_ngcontent-%COMP%]   .show[_ngcontent-%COMP%] > .nav-link[_ngcontent-%COMP%]{font-weight:700;color:var(--bs-nav-underline-link-active-color);border-bottom-color:currentcolor}.nav-fill[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%], .nav-fill[_ngcontent-%COMP%] > .nav-link[_ngcontent-%COMP%]{flex:1 1 auto;text-align:center}.nav-justified[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%], .nav-justified[_ngcontent-%COMP%] > .nav-link[_ngcontent-%COMP%]{flex-basis:0;flex-grow:1;text-align:center}.nav-fill[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%], .nav-justified[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{width:100%}.tab-content[_ngcontent-%COMP%] > .tab-pane[_ngcontent-%COMP%]{display:none}.tab-content[_ngcontent-%COMP%] > .active[_ngcontent-%COMP%]{display:block}.navbar[_ngcontent-%COMP%]{--bs-navbar-padding-x:0;--bs-navbar-padding-y:.5rem;--bs-navbar-color:rgba(var(--bs-emphasis-color-rgb), .65);--bs-navbar-hover-color:rgba(var(--bs-emphasis-color-rgb), .8);--bs-navbar-disabled-color:rgba(var(--bs-emphasis-color-rgb), .3);--bs-navbar-active-color:rgba(var(--bs-emphasis-color-rgb), 1);--bs-navbar-brand-padding-y:.3125rem;--bs-navbar-brand-margin-end:1rem;--bs-navbar-brand-font-size:1.25rem;--bs-navbar-brand-color:rgba(var(--bs-emphasis-color-rgb), 1);--bs-navbar-brand-hover-color:rgba(var(--bs-emphasis-color-rgb), 1);--bs-navbar-nav-link-padding-x:.5rem;--bs-navbar-toggler-padding-y:.25rem;--bs-navbar-toggler-padding-x:.75rem;--bs-navbar-toggler-font-size:1.25rem;--bs-navbar-toggler-icon-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%2833, 37, 41, 0.75%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e\");--bs-navbar-toggler-border-color:rgba(var(--bs-emphasis-color-rgb), .15);--bs-navbar-toggler-border-radius:var(--bs-border-radius);--bs-navbar-toggler-focus-width:.25rem;--bs-navbar-toggler-transition:box-shadow .15s ease-in-out;position:relative;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;padding:var(--bs-navbar-padding-y) var(--bs-navbar-padding-x)}.navbar[_ngcontent-%COMP%] > .container[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%] > .container-fluid[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%] > .container-lg[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%] > .container-md[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%] > .container-sm[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%] > .container-xl[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%] > .container-xxl[_ngcontent-%COMP%]{display:flex;flex-wrap:inherit;align-items:center;justify-content:space-between}.navbar-brand[_ngcontent-%COMP%]{padding-top:var(--bs-navbar-brand-padding-y);padding-bottom:var(--bs-navbar-brand-padding-y);margin-right:var(--bs-navbar-brand-margin-end);font-size:var(--bs-navbar-brand-font-size);color:var(--bs-navbar-brand-color);text-decoration:none;white-space:nowrap}.navbar-brand[_ngcontent-%COMP%]:focus, .navbar-brand[_ngcontent-%COMP%]:hover{color:var(--bs-navbar-brand-hover-color)}.navbar-nav[_ngcontent-%COMP%]{--bs-nav-link-padding-x:0;--bs-nav-link-padding-y:.5rem;--bs-nav-link-font-weight: ;--bs-nav-link-color:var(--bs-navbar-color);--bs-nav-link-hover-color:var(--bs-navbar-hover-color);--bs-nav-link-disabled-color:var(--bs-navbar-disabled-color);display:flex;flex-direction:column;padding-left:0;margin-bottom:0;list-style:none}.navbar-nav[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%], .navbar-nav[_ngcontent-%COMP%]   .nav-link.show[_ngcontent-%COMP%]{color:var(--bs-navbar-active-color)}.navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:static}.navbar-text[_ngcontent-%COMP%]{padding-top:.5rem;padding-bottom:.5rem;color:var(--bs-navbar-color)}.navbar-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .navbar-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:focus, .navbar-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--bs-navbar-active-color)}.navbar-collapse[_ngcontent-%COMP%]{flex-basis:100%;flex-grow:1;align-items:center}.navbar-toggler[_ngcontent-%COMP%]{padding:var(--bs-navbar-toggler-padding-y) var(--bs-navbar-toggler-padding-x);font-size:var(--bs-navbar-toggler-font-size);line-height:1;color:var(--bs-navbar-color);background-color:transparent;border:var(--bs-border-width) solid var(--bs-navbar-toggler-border-color);border-radius:var(--bs-navbar-toggler-border-radius);transition:var(--bs-navbar-toggler-transition)}@media (prefers-reduced-motion:reduce){.navbar-toggler[_ngcontent-%COMP%]{transition:none}}.navbar-toggler[_ngcontent-%COMP%]:hover{text-decoration:none}.navbar-toggler[_ngcontent-%COMP%]:focus{text-decoration:none;outline:0;box-shadow:0 0 0 var(--bs-navbar-toggler-focus-width)}.navbar-toggler-icon[_ngcontent-%COMP%]{display:inline-block;width:1.5em;height:1.5em;vertical-align:middle;background-image:var(--bs-navbar-toggler-icon-bg);background-repeat:no-repeat;background-position:center;background-size:100%}.navbar-nav-scroll[_ngcontent-%COMP%]{max-height:var(--bs-scroll-height,75vh);overflow-y:auto}@media (min-width:576px){.navbar-expand-sm[_ngcontent-%COMP%]{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-sm[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row}.navbar-expand-sm[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute}.navbar-expand-sm[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-sm[_ngcontent-%COMP%]   .navbar-nav-scroll[_ngcontent-%COMP%]{overflow:visible}.navbar-expand-sm[_ngcontent-%COMP%]   .navbar-collapse[_ngcontent-%COMP%]{display:flex!important;flex-basis:auto}.navbar-expand-sm[_ngcontent-%COMP%]   .navbar-toggler[_ngcontent-%COMP%]{display:none}.navbar-expand-sm[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-sm[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.navbar-expand-sm[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:768px){.navbar-expand-md[_ngcontent-%COMP%]{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-md[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row}.navbar-expand-md[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute}.navbar-expand-md[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-md[_ngcontent-%COMP%]   .navbar-nav-scroll[_ngcontent-%COMP%]{overflow:visible}.navbar-expand-md[_ngcontent-%COMP%]   .navbar-collapse[_ngcontent-%COMP%]{display:flex!important;flex-basis:auto}.navbar-expand-md[_ngcontent-%COMP%]   .navbar-toggler[_ngcontent-%COMP%]{display:none}.navbar-expand-md[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-md[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.navbar-expand-md[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:992px){.navbar-expand-lg[_ngcontent-%COMP%]{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-lg[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row}.navbar-expand-lg[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute}.navbar-expand-lg[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-lg[_ngcontent-%COMP%]   .navbar-nav-scroll[_ngcontent-%COMP%]{overflow:visible}.navbar-expand-lg[_ngcontent-%COMP%]   .navbar-collapse[_ngcontent-%COMP%]{display:flex!important;flex-basis:auto}.navbar-expand-lg[_ngcontent-%COMP%]   .navbar-toggler[_ngcontent-%COMP%]{display:none}.navbar-expand-lg[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-lg[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.navbar-expand-lg[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:1200px){.navbar-expand-xl[_ngcontent-%COMP%]{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-xl[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row}.navbar-expand-xl[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute}.navbar-expand-xl[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-xl[_ngcontent-%COMP%]   .navbar-nav-scroll[_ngcontent-%COMP%]{overflow:visible}.navbar-expand-xl[_ngcontent-%COMP%]   .navbar-collapse[_ngcontent-%COMP%]{display:flex!important;flex-basis:auto}.navbar-expand-xl[_ngcontent-%COMP%]   .navbar-toggler[_ngcontent-%COMP%]{display:none}.navbar-expand-xl[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-xl[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.navbar-expand-xl[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible}}@media (min-width:1400px){.navbar-expand-xxl[_ngcontent-%COMP%]{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand-xxl[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row}.navbar-expand-xxl[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute}.navbar-expand-xxl[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand-xxl[_ngcontent-%COMP%]   .navbar-nav-scroll[_ngcontent-%COMP%]{overflow:visible}.navbar-expand-xxl[_ngcontent-%COMP%]   .navbar-collapse[_ngcontent-%COMP%]{display:flex!important;flex-basis:auto}.navbar-expand-xxl[_ngcontent-%COMP%]   .navbar-toggler[_ngcontent-%COMP%]{display:none}.navbar-expand-xxl[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand-xxl[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.navbar-expand-xxl[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible}}.navbar-expand[_ngcontent-%COMP%]{flex-wrap:nowrap;justify-content:flex-start}.navbar-expand[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{flex-direction:row}.navbar-expand[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]{position:absolute}.navbar-expand[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding-right:var(--bs-navbar-nav-link-padding-x);padding-left:var(--bs-navbar-nav-link-padding-x)}.navbar-expand[_ngcontent-%COMP%]   .navbar-nav-scroll[_ngcontent-%COMP%]{overflow:visible}.navbar-expand[_ngcontent-%COMP%]   .navbar-collapse[_ngcontent-%COMP%]{display:flex!important;flex-basis:auto}.navbar-expand[_ngcontent-%COMP%]   .navbar-toggler[_ngcontent-%COMP%]{display:none}.navbar-expand[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]{position:static;z-index:auto;flex-grow:1;width:auto!important;height:auto!important;visibility:visible!important;background-color:transparent!important;border:0!important;transform:none!important;transition:none}.navbar-expand[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.navbar-expand[_ngcontent-%COMP%]   .offcanvas[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible}.navbar-dark[_ngcontent-%COMP%], .navbar[data-bs-theme=dark][_ngcontent-%COMP%]{--bs-navbar-color:rgba(255, 255, 255, .55);--bs-navbar-hover-color:rgba(255, 255, 255, .75);--bs-navbar-disabled-color:rgba(255, 255, 255, .25);--bs-navbar-active-color:#fff;--bs-navbar-brand-color:#fff;--bs-navbar-brand-hover-color:#fff;--bs-navbar-toggler-border-color:rgba(255, 255, 255, .1);--bs-navbar-toggler-icon-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e\")}[data-bs-theme=dark][_ngcontent-%COMP%]   .navbar-toggler-icon[_ngcontent-%COMP%]{--bs-navbar-toggler-icon-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.55%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e\")}.card[_ngcontent-%COMP%]{--bs-card-spacer-y:1rem;--bs-card-spacer-x:1rem;--bs-card-title-spacer-y:.5rem;--bs-card-title-color: ;--bs-card-subtitle-color: ;--bs-card-border-width:var(--bs-border-width);--bs-card-border-color:var(--bs-border-color-translucent);--bs-card-border-radius:var(--bs-border-radius);--bs-card-box-shadow: ;--bs-card-inner-border-radius:calc(var(--bs-border-radius) - (var(--bs-border-width)));--bs-card-cap-padding-y:.5rem;--bs-card-cap-padding-x:1rem;--bs-card-cap-bg:rgba(var(--bs-body-color-rgb), .03);--bs-card-cap-color: ;--bs-card-height: ;--bs-card-color: ;--bs-card-bg:var(--bs-body-bg);--bs-card-img-overlay-padding:1rem;--bs-card-group-margin:.75rem;position:relative;display:flex;flex-direction:column;min-width:0;height:var(--bs-card-height);color:var(--bs-body-color);word-wrap:break-word;background-color:var(--bs-card-bg);background-clip:border-box;border:var(--bs-card-border-width) solid var(--bs-card-border-color);border-radius:var(--bs-card-border-radius)}.card[_ngcontent-%COMP%] > hr[_ngcontent-%COMP%]{margin-right:0;margin-left:0}.card[_ngcontent-%COMP%] > .list-group[_ngcontent-%COMP%]{border-top:inherit;border-bottom:inherit}.card[_ngcontent-%COMP%] > .list-group[_ngcontent-%COMP%]:first-child{border-top-width:0;border-top-left-radius:var(--bs-card-inner-border-radius);border-top-right-radius:var(--bs-card-inner-border-radius)}.card[_ngcontent-%COMP%] > .list-group[_ngcontent-%COMP%]:last-child{border-bottom-width:0;border-bottom-right-radius:var(--bs-card-inner-border-radius);border-bottom-left-radius:var(--bs-card-inner-border-radius)}.card[_ngcontent-%COMP%] > .card-header[_ngcontent-%COMP%] + .list-group[_ngcontent-%COMP%], .card[_ngcontent-%COMP%] > .list-group[_ngcontent-%COMP%] + .card-footer[_ngcontent-%COMP%]{border-top:0}.card-body[_ngcontent-%COMP%]{flex:1 1 auto;padding:var(--bs-card-spacer-y) var(--bs-card-spacer-x);color:var(--bs-card-color)}.card-title[_ngcontent-%COMP%]{margin-bottom:var(--bs-card-title-spacer-y);color:var(--bs-card-title-color)}.card-subtitle[_ngcontent-%COMP%]{margin-top:calc(-.5 * var(--bs-card-title-spacer-y));margin-bottom:0;color:var(--bs-card-subtitle-color)}.card-text[_ngcontent-%COMP%]:last-child{margin-bottom:0}.card-link[_ngcontent-%COMP%] + .card-link[_ngcontent-%COMP%]{margin-left:var(--bs-card-spacer-x)}.card-header[_ngcontent-%COMP%]{padding:var(--bs-card-cap-padding-y) var(--bs-card-cap-padding-x);margin-bottom:0;color:var(--bs-card-cap-color);background-color:var(--bs-card-cap-bg);border-bottom:var(--bs-card-border-width) solid var(--bs-card-border-color)}.card-header[_ngcontent-%COMP%]:first-child{border-radius:var(--bs-card-inner-border-radius) var(--bs-card-inner-border-radius) 0 0}.card-footer[_ngcontent-%COMP%]{padding:var(--bs-card-cap-padding-y) var(--bs-card-cap-padding-x);color:var(--bs-card-cap-color);background-color:var(--bs-card-cap-bg);border-top:var(--bs-card-border-width) solid var(--bs-card-border-color)}.card-footer[_ngcontent-%COMP%]:last-child{border-radius:0 0 var(--bs-card-inner-border-radius) var(--bs-card-inner-border-radius)}.card-header-tabs[_ngcontent-%COMP%]{margin-right:calc(-.5 * var(--bs-card-cap-padding-x));margin-bottom:calc(-1 * var(--bs-card-cap-padding-y));margin-left:calc(-.5 * var(--bs-card-cap-padding-x));border-bottom:0}.card-header-tabs[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background-color:var(--bs-card-bg);border-bottom-color:var(--bs-card-bg)}.card-header-pills[_ngcontent-%COMP%]{margin-right:calc(-.5 * var(--bs-card-cap-padding-x));margin-left:calc(-.5 * var(--bs-card-cap-padding-x))}.card-img-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;padding:var(--bs-card-img-overlay-padding);border-radius:var(--bs-card-inner-border-radius)}.card-img[_ngcontent-%COMP%], .card-img-bottom[_ngcontent-%COMP%], .card-img-top[_ngcontent-%COMP%]{width:100%}.card-img[_ngcontent-%COMP%], .card-img-top[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-card-inner-border-radius);border-top-right-radius:var(--bs-card-inner-border-radius)}.card-img[_ngcontent-%COMP%], .card-img-bottom[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-card-inner-border-radius);border-bottom-left-radius:var(--bs-card-inner-border-radius)}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]{margin-bottom:var(--bs-card-group-margin)}@media (min-width:576px){.card-group[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]{flex:1 0 0%;margin-bottom:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%] + .card[_ngcontent-%COMP%]{margin-left:0;border-left:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:last-child)   .card-header[_ngcontent-%COMP%], .card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:last-child)   .card-img-top[_ngcontent-%COMP%]{border-top-right-radius:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:last-child)   .card-footer[_ngcontent-%COMP%], .card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:last-child)   .card-img-bottom[_ngcontent-%COMP%]{border-bottom-right-radius:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:first-child){border-top-left-radius:0;border-bottom-left-radius:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:first-child)   .card-header[_ngcontent-%COMP%], .card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:first-child)   .card-img-top[_ngcontent-%COMP%]{border-top-left-radius:0}.card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:first-child)   .card-footer[_ngcontent-%COMP%], .card-group[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]:not(:first-child)   .card-img-bottom[_ngcontent-%COMP%]{border-bottom-left-radius:0}}.accordion[_ngcontent-%COMP%]{--bs-accordion-color:var(--bs-body-color);--bs-accordion-bg:var(--bs-body-bg);--bs-accordion-transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out,border-radius .15s ease;--bs-accordion-border-color:var(--bs-border-color);--bs-accordion-border-width:var(--bs-border-width);--bs-accordion-border-radius:var(--bs-border-radius);--bs-accordion-inner-border-radius:calc(var(--bs-border-radius) - (var(--bs-border-width)));--bs-accordion-btn-padding-x:1.25rem;--bs-accordion-btn-padding-y:1rem;--bs-accordion-btn-color:var(--bs-body-color);--bs-accordion-btn-bg:var(--bs-accordion-bg);--bs-accordion-btn-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='none' stroke='%23212529' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M2 5L8 11L14 5'/%3e%3c/svg%3e\");--bs-accordion-btn-icon-width:1.25rem;--bs-accordion-btn-icon-transform:rotate(-180deg);--bs-accordion-btn-icon-transition:transform .2s ease-in-out;--bs-accordion-btn-active-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='none' stroke='%23052c65' stroke-linecap='round' stroke-linejoin='round'%3e%3cpath d='M2 5L8 11L14 5'/%3e%3c/svg%3e\");--bs-accordion-btn-focus-box-shadow:0 0 0 .25rem rgba(13, 110, 253, .25);--bs-accordion-body-padding-x:1.25rem;--bs-accordion-body-padding-y:1rem;--bs-accordion-active-color:var(--bs-primary-text-emphasis);--bs-accordion-active-bg:var(--bs-primary-bg-subtle)}.accordion-button[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;width:100%;padding:var(--bs-accordion-btn-padding-y) var(--bs-accordion-btn-padding-x);font-size:1rem;color:var(--bs-accordion-btn-color);text-align:left;background-color:var(--bs-accordion-btn-bg);border:0;border-radius:0;overflow-anchor:none;transition:var(--bs-accordion-transition)}@media (prefers-reduced-motion:reduce){.accordion-button[_ngcontent-%COMP%]{transition:none}}.accordion-button[_ngcontent-%COMP%]:not(.collapsed){color:var(--bs-accordion-active-color);background-color:var(--bs-accordion-active-bg);box-shadow:inset 0 calc(-1 * var(--bs-accordion-border-width)) 0 var(--bs-accordion-border-color)}.accordion-button[_ngcontent-%COMP%]:not(.collapsed):after{background-image:var(--bs-accordion-btn-active-icon);transform:var(--bs-accordion-btn-icon-transform)}.accordion-button[_ngcontent-%COMP%]:after{flex-shrink:0;width:var(--bs-accordion-btn-icon-width);height:var(--bs-accordion-btn-icon-width);margin-left:auto;content:\"\";background-image:var(--bs-accordion-btn-icon);background-repeat:no-repeat;background-size:var(--bs-accordion-btn-icon-width);transition:var(--bs-accordion-btn-icon-transition)}@media (prefers-reduced-motion:reduce){.accordion-button[_ngcontent-%COMP%]:after{transition:none}}.accordion-button[_ngcontent-%COMP%]:hover{z-index:2}.accordion-button[_ngcontent-%COMP%]:focus{z-index:3;outline:0;box-shadow:var(--bs-accordion-btn-focus-box-shadow)}.accordion-header[_ngcontent-%COMP%]{margin-bottom:0}.accordion-item[_ngcontent-%COMP%]{color:var(--bs-accordion-color);background-color:var(--bs-accordion-bg);border:var(--bs-accordion-border-width) solid var(--bs-accordion-border-color)}.accordion-item[_ngcontent-%COMP%]:first-of-type{border-top-left-radius:var(--bs-accordion-border-radius);border-top-right-radius:var(--bs-accordion-border-radius)}.accordion-item[_ngcontent-%COMP%]:first-of-type > .accordion-header[_ngcontent-%COMP%]   .accordion-button[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-accordion-inner-border-radius);border-top-right-radius:var(--bs-accordion-inner-border-radius)}.accordion-item[_ngcontent-%COMP%]:not(:first-of-type){border-top:0}.accordion-item[_ngcontent-%COMP%]:last-of-type{border-bottom-right-radius:var(--bs-accordion-border-radius);border-bottom-left-radius:var(--bs-accordion-border-radius)}.accordion-item[_ngcontent-%COMP%]:last-of-type > .accordion-header[_ngcontent-%COMP%]   .accordion-button.collapsed[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-accordion-inner-border-radius);border-bottom-left-radius:var(--bs-accordion-inner-border-radius)}.accordion-item[_ngcontent-%COMP%]:last-of-type > .accordion-collapse[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-accordion-border-radius);border-bottom-left-radius:var(--bs-accordion-border-radius)}.accordion-body[_ngcontent-%COMP%]{padding:var(--bs-accordion-body-padding-y) var(--bs-accordion-body-padding-x)}.accordion-flush[_ngcontent-%COMP%] > .accordion-item[_ngcontent-%COMP%]{border-right:0;border-left:0;border-radius:0}.accordion-flush[_ngcontent-%COMP%] > .accordion-item[_ngcontent-%COMP%]:first-child{border-top:0}.accordion-flush[_ngcontent-%COMP%] > .accordion-item[_ngcontent-%COMP%]:last-child{border-bottom:0}.accordion-flush[_ngcontent-%COMP%] > .accordion-item[_ngcontent-%COMP%] > .accordion-header[_ngcontent-%COMP%]   .accordion-button[_ngcontent-%COMP%], .accordion-flush[_ngcontent-%COMP%] > .accordion-item[_ngcontent-%COMP%] > .accordion-header[_ngcontent-%COMP%]   .accordion-button.collapsed[_ngcontent-%COMP%]{border-radius:0}.accordion-flush[_ngcontent-%COMP%] > .accordion-item[_ngcontent-%COMP%] > .accordion-collapse[_ngcontent-%COMP%]{border-radius:0}[data-bs-theme=dark][_ngcontent-%COMP%]   .accordion-button[_ngcontent-%COMP%]:after{--bs-accordion-btn-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%236ea8fe'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e\");--bs-accordion-btn-active-icon:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%236ea8fe'%3e%3cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e\")}.breadcrumb[_ngcontent-%COMP%]{--bs-breadcrumb-padding-x:0;--bs-breadcrumb-padding-y:0;--bs-breadcrumb-margin-bottom:1rem;--bs-breadcrumb-bg: ;--bs-breadcrumb-border-radius: ;--bs-breadcrumb-divider-color:var(--bs-secondary-color);--bs-breadcrumb-item-padding-x:.5rem;--bs-breadcrumb-item-active-color:var(--bs-secondary-color);display:flex;flex-wrap:wrap;padding:var(--bs-breadcrumb-padding-y) var(--bs-breadcrumb-padding-x);margin-bottom:var(--bs-breadcrumb-margin-bottom);font-size:var(--bs-breadcrumb-font-size);list-style:none;background-color:var(--bs-breadcrumb-bg);border-radius:var(--bs-breadcrumb-border-radius)}.breadcrumb-item[_ngcontent-%COMP%] + .breadcrumb-item[_ngcontent-%COMP%]{padding-left:var(--bs-breadcrumb-item-padding-x)}.breadcrumb-item[_ngcontent-%COMP%] + .breadcrumb-item[_ngcontent-%COMP%]:before{float:left;padding-right:var(--bs-breadcrumb-item-padding-x);color:var(--bs-breadcrumb-divider-color);content:var(--bs-breadcrumb-divider, \"/\")}.breadcrumb-item.active[_ngcontent-%COMP%]{color:var(--bs-breadcrumb-item-active-color)}.pagination[_ngcontent-%COMP%]{--bs-pagination-padding-x:.75rem;--bs-pagination-padding-y:.375rem;--bs-pagination-font-size:1rem;--bs-pagination-color:var(--bs-link-color);--bs-pagination-bg:var(--bs-body-bg);--bs-pagination-border-width:var(--bs-border-width);--bs-pagination-border-color:var(--bs-border-color);--bs-pagination-border-radius:var(--bs-border-radius);--bs-pagination-hover-color:var(--bs-link-hover-color);--bs-pagination-hover-bg:var(--bs-tertiary-bg);--bs-pagination-hover-border-color:var(--bs-border-color);--bs-pagination-focus-color:var(--bs-link-hover-color);--bs-pagination-focus-bg:var(--bs-secondary-bg);--bs-pagination-focus-box-shadow:0 0 0 .25rem rgba(13, 110, 253, .25);--bs-pagination-active-color:#fff;--bs-pagination-active-bg:#0d6efd;--bs-pagination-active-border-color:#0d6efd;--bs-pagination-disabled-color:var(--bs-secondary-color);--bs-pagination-disabled-bg:var(--bs-secondary-bg);--bs-pagination-disabled-border-color:var(--bs-border-color);display:flex;padding-left:0;list-style:none}.page-link[_ngcontent-%COMP%]{position:relative;display:block;padding:var(--bs-pagination-padding-y) var(--bs-pagination-padding-x);font-size:var(--bs-pagination-font-size);color:var(--bs-pagination-color);text-decoration:none;background-color:var(--bs-pagination-bg);border:var(--bs-pagination-border-width) solid var(--bs-pagination-border-color);transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out}@media (prefers-reduced-motion:reduce){.page-link[_ngcontent-%COMP%]{transition:none}}.page-link[_ngcontent-%COMP%]:hover{z-index:2;color:var(--bs-pagination-hover-color);background-color:var(--bs-pagination-hover-bg);border-color:var(--bs-pagination-hover-border-color)}.page-link[_ngcontent-%COMP%]:focus{z-index:3;color:var(--bs-pagination-focus-color);background-color:var(--bs-pagination-focus-bg);outline:0;box-shadow:var(--bs-pagination-focus-box-shadow)}.active[_ngcontent-%COMP%] > .page-link[_ngcontent-%COMP%], .page-link.active[_ngcontent-%COMP%]{z-index:3;color:var(--bs-pagination-active-color);background-color:var(--bs-pagination-active-bg);border-color:var(--bs-pagination-active-border-color)}.disabled[_ngcontent-%COMP%] > .page-link[_ngcontent-%COMP%], .page-link.disabled[_ngcontent-%COMP%]{color:var(--bs-pagination-disabled-color);pointer-events:none;background-color:var(--bs-pagination-disabled-bg);border-color:var(--bs-pagination-disabled-border-color)}.page-item[_ngcontent-%COMP%]:not(:first-child)   .page-link[_ngcontent-%COMP%]{margin-left:calc(var(--bs-border-width) * -1)}.page-item[_ngcontent-%COMP%]:first-child   .page-link[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-pagination-border-radius);border-bottom-left-radius:var(--bs-pagination-border-radius)}.page-item[_ngcontent-%COMP%]:last-child   .page-link[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-pagination-border-radius);border-bottom-right-radius:var(--bs-pagination-border-radius)}.pagination-lg[_ngcontent-%COMP%]{--bs-pagination-padding-x:1.5rem;--bs-pagination-padding-y:.75rem;--bs-pagination-font-size:1.25rem;--bs-pagination-border-radius:var(--bs-border-radius-lg)}.pagination-sm[_ngcontent-%COMP%]{--bs-pagination-padding-x:.5rem;--bs-pagination-padding-y:.25rem;--bs-pagination-font-size:.875rem;--bs-pagination-border-radius:var(--bs-border-radius-sm)}.badge[_ngcontent-%COMP%]{--bs-badge-padding-x:.65em;--bs-badge-padding-y:.35em;--bs-badge-font-size:.75em;--bs-badge-font-weight:700;--bs-badge-color:#fff;--bs-badge-border-radius:var(--bs-border-radius);display:inline-block;padding:var(--bs-badge-padding-y) var(--bs-badge-padding-x);font-size:var(--bs-badge-font-size);font-weight:var(--bs-badge-font-weight);line-height:1;color:var(--bs-badge-color);text-align:center;white-space:nowrap;vertical-align:baseline;border-radius:var(--bs-badge-border-radius)}.badge[_ngcontent-%COMP%]:empty{display:none}.btn[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{position:relative;top:-1px}.alert[_ngcontent-%COMP%]{--bs-alert-bg:transparent;--bs-alert-padding-x:1rem;--bs-alert-padding-y:1rem;--bs-alert-margin-bottom:1rem;--bs-alert-color:inherit;--bs-alert-border-color:transparent;--bs-alert-border:var(--bs-border-width) solid var(--bs-alert-border-color);--bs-alert-border-radius:var(--bs-border-radius);--bs-alert-link-color:inherit;position:relative;padding:var(--bs-alert-padding-y) var(--bs-alert-padding-x);margin-bottom:var(--bs-alert-margin-bottom);color:var(--bs-alert-color);background-color:var(--bs-alert-bg);border:var(--bs-alert-border);border-radius:var(--bs-alert-border-radius)}.alert-heading[_ngcontent-%COMP%]{color:inherit}.alert-link[_ngcontent-%COMP%]{font-weight:700;color:var(--bs-alert-link-color)}.alert-dismissible[_ngcontent-%COMP%]{padding-right:3rem}.alert-dismissible[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:2;padding:1.25rem 1rem}.alert-primary[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-primary-text-emphasis);--bs-alert-bg:var(--bs-primary-bg-subtle);--bs-alert-border-color:var(--bs-primary-border-subtle);--bs-alert-link-color:var(--bs-primary-text-emphasis)}.alert-secondary[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-secondary-text-emphasis);--bs-alert-bg:var(--bs-secondary-bg-subtle);--bs-alert-border-color:var(--bs-secondary-border-subtle);--bs-alert-link-color:var(--bs-secondary-text-emphasis)}.alert-success[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-success-text-emphasis);--bs-alert-bg:var(--bs-success-bg-subtle);--bs-alert-border-color:var(--bs-success-border-subtle);--bs-alert-link-color:var(--bs-success-text-emphasis)}.alert-info[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-info-text-emphasis);--bs-alert-bg:var(--bs-info-bg-subtle);--bs-alert-border-color:var(--bs-info-border-subtle);--bs-alert-link-color:var(--bs-info-text-emphasis)}.alert-warning[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-warning-text-emphasis);--bs-alert-bg:var(--bs-warning-bg-subtle);--bs-alert-border-color:var(--bs-warning-border-subtle);--bs-alert-link-color:var(--bs-warning-text-emphasis)}.alert-danger[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-danger-text-emphasis);--bs-alert-bg:var(--bs-danger-bg-subtle);--bs-alert-border-color:var(--bs-danger-border-subtle);--bs-alert-link-color:var(--bs-danger-text-emphasis)}.alert-light[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-light-text-emphasis);--bs-alert-bg:var(--bs-light-bg-subtle);--bs-alert-border-color:var(--bs-light-border-subtle);--bs-alert-link-color:var(--bs-light-text-emphasis)}.alert-dark[_ngcontent-%COMP%]{--bs-alert-color:var(--bs-dark-text-emphasis);--bs-alert-bg:var(--bs-dark-bg-subtle);--bs-alert-border-color:var(--bs-dark-border-subtle);--bs-alert-link-color:var(--bs-dark-text-emphasis)}@keyframes _ngcontent-%COMP%_progress-bar-stripes{0%{background-position-x:1rem}}.progress[_ngcontent-%COMP%], .progress-stacked[_ngcontent-%COMP%]{--bs-progress-height:1rem;--bs-progress-font-size:.75rem;--bs-progress-bg:var(--bs-secondary-bg);--bs-progress-border-radius:var(--bs-border-radius);--bs-progress-box-shadow:var(--bs-box-shadow-inset);--bs-progress-bar-color:#fff;--bs-progress-bar-bg:#0d6efd;--bs-progress-bar-transition:width .6s ease;display:flex;height:var(--bs-progress-height);overflow:hidden;font-size:var(--bs-progress-font-size);background-color:var(--bs-progress-bg);border-radius:var(--bs-progress-border-radius)}.progress-bar[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;overflow:hidden;color:var(--bs-progress-bar-color);text-align:center;white-space:nowrap;background-color:var(--bs-progress-bar-bg);transition:var(--bs-progress-bar-transition)}@media (prefers-reduced-motion:reduce){.progress-bar[_ngcontent-%COMP%]{transition:none}}.progress-bar-striped[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);background-size:var(--bs-progress-height) var(--bs-progress-height)}.progress-stacked[_ngcontent-%COMP%] > .progress[_ngcontent-%COMP%]{overflow:visible}.progress-stacked[_ngcontent-%COMP%] > .progress[_ngcontent-%COMP%] > .progress-bar[_ngcontent-%COMP%]{width:100%}.progress-bar-animated[_ngcontent-%COMP%]{animation:1s linear infinite _ngcontent-%COMP%_progress-bar-stripes}@media (prefers-reduced-motion:reduce){.progress-bar-animated[_ngcontent-%COMP%]{animation:none}}.list-group[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-body-color);--bs-list-group-bg:var(--bs-body-bg);--bs-list-group-border-color:var(--bs-border-color);--bs-list-group-border-width:var(--bs-border-width);--bs-list-group-border-radius:var(--bs-border-radius);--bs-list-group-item-padding-x:1rem;--bs-list-group-item-padding-y:.5rem;--bs-list-group-action-color:var(--bs-secondary-color);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-tertiary-bg);--bs-list-group-action-active-color:var(--bs-body-color);--bs-list-group-action-active-bg:var(--bs-secondary-bg);--bs-list-group-disabled-color:var(--bs-secondary-color);--bs-list-group-disabled-bg:var(--bs-body-bg);--bs-list-group-active-color:#fff;--bs-list-group-active-bg:#0d6efd;--bs-list-group-active-border-color:#0d6efd;display:flex;flex-direction:column;padding-left:0;margin-bottom:0;border-radius:var(--bs-list-group-border-radius)}.list-group-numbered[_ngcontent-%COMP%]{list-style-type:none;counter-reset:section}.list-group-numbered[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:before{content:counters(section,\".\") \". \";counter-increment:section}.list-group-item-action[_ngcontent-%COMP%]{width:100%;color:var(--bs-list-group-action-color);text-align:inherit}.list-group-item-action[_ngcontent-%COMP%]:focus, .list-group-item-action[_ngcontent-%COMP%]:hover{z-index:1;color:var(--bs-list-group-action-hover-color);text-decoration:none;background-color:var(--bs-list-group-action-hover-bg)}.list-group-item-action[_ngcontent-%COMP%]:active{color:var(--bs-list-group-action-active-color);background-color:var(--bs-list-group-action-active-bg)}.list-group-item[_ngcontent-%COMP%]{position:relative;display:block;padding:var(--bs-list-group-item-padding-y) var(--bs-list-group-item-padding-x);color:var(--bs-list-group-color);text-decoration:none;background-color:var(--bs-list-group-bg);border:var(--bs-list-group-border-width) solid var(--bs-list-group-border-color)}.list-group-item[_ngcontent-%COMP%]:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.list-group-item[_ngcontent-%COMP%]:last-child{border-bottom-right-radius:inherit;border-bottom-left-radius:inherit}.list-group-item.disabled[_ngcontent-%COMP%], .list-group-item[_ngcontent-%COMP%]:disabled{color:var(--bs-list-group-disabled-color);pointer-events:none;background-color:var(--bs-list-group-disabled-bg)}.list-group-item.active[_ngcontent-%COMP%]{z-index:2;color:var(--bs-list-group-active-color);background-color:var(--bs-list-group-active-bg);border-color:var(--bs-list-group-active-border-color)}.list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:0}.list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-top:calc(-1 * var(--bs-list-group-border-width));border-top-width:var(--bs-list-group-border-width)}.list-group-horizontal[_ngcontent-%COMP%]{flex-direction:row}.list-group-horizontal[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal[_ngcontent-%COMP%] > .list-group-item.active[_ngcontent-%COMP%]{margin-top:0}.list-group-horizontal[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}@media (min-width:576px){.list-group-horizontal-sm[_ngcontent-%COMP%]{flex-direction:row}.list-group-horizontal-sm[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-sm[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-sm[_ngcontent-%COMP%] > .list-group-item.active[_ngcontent-%COMP%]{margin-top:0}.list-group-horizontal-sm[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-sm[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:768px){.list-group-horizontal-md[_ngcontent-%COMP%]{flex-direction:row}.list-group-horizontal-md[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-md[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-md[_ngcontent-%COMP%] > .list-group-item.active[_ngcontent-%COMP%]{margin-top:0}.list-group-horizontal-md[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-md[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:992px){.list-group-horizontal-lg[_ngcontent-%COMP%]{flex-direction:row}.list-group-horizontal-lg[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-lg[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-lg[_ngcontent-%COMP%] > .list-group-item.active[_ngcontent-%COMP%]{margin-top:0}.list-group-horizontal-lg[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-lg[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:1200px){.list-group-horizontal-xl[_ngcontent-%COMP%]{flex-direction:row}.list-group-horizontal-xl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-xl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-xl[_ngcontent-%COMP%] > .list-group-item.active[_ngcontent-%COMP%]{margin-top:0}.list-group-horizontal-xl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-xl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}@media (min-width:1400px){.list-group-horizontal-xxl[_ngcontent-%COMP%]{flex-direction:row}.list-group-horizontal-xxl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:first-child:not(:last-child){border-bottom-left-radius:var(--bs-list-group-border-radius);border-top-right-radius:0}.list-group-horizontal-xxl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child:not(:first-child){border-top-right-radius:var(--bs-list-group-border-radius);border-bottom-left-radius:0}.list-group-horizontal-xxl[_ngcontent-%COMP%] > .list-group-item.active[_ngcontent-%COMP%]{margin-top:0}.list-group-horizontal-xxl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item[_ngcontent-%COMP%]{border-top-width:var(--bs-list-group-border-width);border-left-width:0}.list-group-horizontal-xxl[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%] + .list-group-item.active[_ngcontent-%COMP%]{margin-left:calc(-1 * var(--bs-list-group-border-width));border-left-width:var(--bs-list-group-border-width)}}.list-group-flush[_ngcontent-%COMP%]{border-radius:0}.list-group-flush[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]{border-width:0 0 var(--bs-list-group-border-width)}.list-group-flush[_ngcontent-%COMP%] > .list-group-item[_ngcontent-%COMP%]:last-child{border-bottom-width:0}.list-group-item-primary[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-primary-text-emphasis);--bs-list-group-bg:var(--bs-primary-bg-subtle);--bs-list-group-border-color:var(--bs-primary-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-primary-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-primary-border-subtle);--bs-list-group-active-color:var(--bs-primary-bg-subtle);--bs-list-group-active-bg:var(--bs-primary-text-emphasis);--bs-list-group-active-border-color:var(--bs-primary-text-emphasis)}.list-group-item-secondary[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-secondary-text-emphasis);--bs-list-group-bg:var(--bs-secondary-bg-subtle);--bs-list-group-border-color:var(--bs-secondary-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-secondary-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-secondary-border-subtle);--bs-list-group-active-color:var(--bs-secondary-bg-subtle);--bs-list-group-active-bg:var(--bs-secondary-text-emphasis);--bs-list-group-active-border-color:var(--bs-secondary-text-emphasis)}.list-group-item-success[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-success-text-emphasis);--bs-list-group-bg:var(--bs-success-bg-subtle);--bs-list-group-border-color:var(--bs-success-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-success-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-success-border-subtle);--bs-list-group-active-color:var(--bs-success-bg-subtle);--bs-list-group-active-bg:var(--bs-success-text-emphasis);--bs-list-group-active-border-color:var(--bs-success-text-emphasis)}.list-group-item-info[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-info-text-emphasis);--bs-list-group-bg:var(--bs-info-bg-subtle);--bs-list-group-border-color:var(--bs-info-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-info-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-info-border-subtle);--bs-list-group-active-color:var(--bs-info-bg-subtle);--bs-list-group-active-bg:var(--bs-info-text-emphasis);--bs-list-group-active-border-color:var(--bs-info-text-emphasis)}.list-group-item-warning[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-warning-text-emphasis);--bs-list-group-bg:var(--bs-warning-bg-subtle);--bs-list-group-border-color:var(--bs-warning-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-warning-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-warning-border-subtle);--bs-list-group-active-color:var(--bs-warning-bg-subtle);--bs-list-group-active-bg:var(--bs-warning-text-emphasis);--bs-list-group-active-border-color:var(--bs-warning-text-emphasis)}.list-group-item-danger[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-danger-text-emphasis);--bs-list-group-bg:var(--bs-danger-bg-subtle);--bs-list-group-border-color:var(--bs-danger-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-danger-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-danger-border-subtle);--bs-list-group-active-color:var(--bs-danger-bg-subtle);--bs-list-group-active-bg:var(--bs-danger-text-emphasis);--bs-list-group-active-border-color:var(--bs-danger-text-emphasis)}.list-group-item-light[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-light-text-emphasis);--bs-list-group-bg:var(--bs-light-bg-subtle);--bs-list-group-border-color:var(--bs-light-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-light-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-light-border-subtle);--bs-list-group-active-color:var(--bs-light-bg-subtle);--bs-list-group-active-bg:var(--bs-light-text-emphasis);--bs-list-group-active-border-color:var(--bs-light-text-emphasis)}.list-group-item-dark[_ngcontent-%COMP%]{--bs-list-group-color:var(--bs-dark-text-emphasis);--bs-list-group-bg:var(--bs-dark-bg-subtle);--bs-list-group-border-color:var(--bs-dark-border-subtle);--bs-list-group-action-hover-color:var(--bs-emphasis-color);--bs-list-group-action-hover-bg:var(--bs-dark-border-subtle);--bs-list-group-action-active-color:var(--bs-emphasis-color);--bs-list-group-action-active-bg:var(--bs-dark-border-subtle);--bs-list-group-active-color:var(--bs-dark-bg-subtle);--bs-list-group-active-bg:var(--bs-dark-text-emphasis);--bs-list-group-active-border-color:var(--bs-dark-text-emphasis)}.btn-close[_ngcontent-%COMP%]{--bs-btn-close-color:#000;--bs-btn-close-bg:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23000'%3e%3cpath d='M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414z'/%3e%3c/svg%3e\");--bs-btn-close-opacity:.5;--bs-btn-close-hover-opacity:.75;--bs-btn-close-focus-shadow:0 0 0 .25rem rgba(13, 110, 253, .25);--bs-btn-close-focus-opacity:1;--bs-btn-close-disabled-opacity:.25;--bs-btn-close-white-filter:invert(1) grayscale(100%) brightness(200%);box-sizing:content-box;width:1em;height:1em;padding:.25em;color:var(--bs-btn-close-color);background:transparent var(--bs-btn-close-bg) center/1em auto no-repeat;border:0;border-radius:.375rem;opacity:var(--bs-btn-close-opacity)}.btn-close[_ngcontent-%COMP%]:hover{color:var(--bs-btn-close-color);text-decoration:none;opacity:var(--bs-btn-close-hover-opacity)}.btn-close[_ngcontent-%COMP%]:focus{outline:0;box-shadow:var(--bs-btn-close-focus-shadow);opacity:var(--bs-btn-close-focus-opacity)}.btn-close.disabled[_ngcontent-%COMP%], .btn-close[_ngcontent-%COMP%]:disabled{pointer-events:none;-webkit-user-select:none;user-select:none;opacity:var(--bs-btn-close-disabled-opacity)}.btn-close-white[_ngcontent-%COMP%], [data-bs-theme=dark][_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{filter:var(--bs-btn-close-white-filter)}.toast[_ngcontent-%COMP%]{--bs-toast-zindex:1090;--bs-toast-padding-x:.75rem;--bs-toast-padding-y:.5rem;--bs-toast-spacing:1.5rem;--bs-toast-max-width:350px;--bs-toast-font-size:.875rem;--bs-toast-color: ;--bs-toast-bg:rgba(var(--bs-body-bg-rgb), .85);--bs-toast-border-width:var(--bs-border-width);--bs-toast-border-color:var(--bs-border-color-translucent);--bs-toast-border-radius:var(--bs-border-radius);--bs-toast-box-shadow:var(--bs-box-shadow);--bs-toast-header-color:var(--bs-secondary-color);--bs-toast-header-bg:rgba(var(--bs-body-bg-rgb), .85);--bs-toast-header-border-color:var(--bs-border-color-translucent);width:var(--bs-toast-max-width);max-width:100%;font-size:var(--bs-toast-font-size);color:var(--bs-toast-color);pointer-events:auto;background-color:var(--bs-toast-bg);background-clip:padding-box;border:var(--bs-toast-border-width) solid var(--bs-toast-border-color);box-shadow:var(--bs-toast-box-shadow);border-radius:var(--bs-toast-border-radius)}.toast.showing[_ngcontent-%COMP%]{opacity:0}.toast[_ngcontent-%COMP%]:not(.show){display:none}.toast-container[_ngcontent-%COMP%]{--bs-toast-zindex:1090;position:absolute;z-index:var(--bs-toast-zindex);width:max-content;max-width:100%;pointer-events:none}.toast-container[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:last-child){margin-bottom:var(--bs-toast-spacing)}.toast-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:var(--bs-toast-padding-y) var(--bs-toast-padding-x);color:var(--bs-toast-header-color);background-color:var(--bs-toast-header-bg);background-clip:padding-box;border-bottom:var(--bs-toast-border-width) solid var(--bs-toast-header-border-color);border-top-left-radius:calc(var(--bs-toast-border-radius) - var(--bs-toast-border-width));border-top-right-radius:calc(var(--bs-toast-border-radius) - var(--bs-toast-border-width))}.toast-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{margin-right:calc(-.5 * var(--bs-toast-padding-x));margin-left:var(--bs-toast-padding-x)}.toast-body[_ngcontent-%COMP%]{padding:var(--bs-toast-padding-x);word-wrap:break-word}.modal[_ngcontent-%COMP%]{--bs-modal-zindex:1055;--bs-modal-width:500px;--bs-modal-padding:1rem;--bs-modal-margin:.5rem;--bs-modal-color: ;--bs-modal-bg:var(--bs-body-bg);--bs-modal-border-color:var(--bs-border-color-translucent);--bs-modal-border-width:var(--bs-border-width);--bs-modal-border-radius:var(--bs-border-radius-lg);--bs-modal-box-shadow:var(--bs-box-shadow-sm);--bs-modal-inner-border-radius:calc(var(--bs-border-radius-lg) - (var(--bs-border-width)));--bs-modal-header-padding-x:1rem;--bs-modal-header-padding-y:1rem;--bs-modal-header-padding:1rem 1rem;--bs-modal-header-border-color:var(--bs-border-color);--bs-modal-header-border-width:var(--bs-border-width);--bs-modal-title-line-height:1.5;--bs-modal-footer-gap:.5rem;--bs-modal-footer-bg: ;--bs-modal-footer-border-color:var(--bs-border-color);--bs-modal-footer-border-width:var(--bs-border-width);position:fixed;top:0;left:0;z-index:var(--bs-modal-zindex);display:none;width:100%;height:100%;overflow-x:hidden;overflow-y:auto;outline:0}.modal-dialog[_ngcontent-%COMP%]{position:relative;width:auto;margin:var(--bs-modal-margin);pointer-events:none}.modal.fade[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{transition:transform .3s ease-out;transform:translateY(-50px)}@media (prefers-reduced-motion:reduce){.modal.fade[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{transition:none}}.modal.show[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{transform:none}.modal.modal-static[_ngcontent-%COMP%]   .modal-dialog[_ngcontent-%COMP%]{transform:scale(1.02)}.modal-dialog-scrollable[_ngcontent-%COMP%]{height:calc(100% - var(--bs-modal-margin) * 2)}.modal-dialog-scrollable[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{max-height:100%;overflow:hidden}.modal-dialog-scrollable[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}.modal-dialog-centered[_ngcontent-%COMP%]{display:flex;align-items:center;min-height:calc(100% - var(--bs-modal-margin) * 2)}.modal-content[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;width:100%;color:var(--bs-modal-color);pointer-events:auto;background-color:var(--bs-modal-bg);background-clip:padding-box;border:var(--bs-modal-border-width) solid var(--bs-modal-border-color);border-radius:var(--bs-modal-border-radius);outline:0}.modal-backdrop[_ngcontent-%COMP%]{--bs-backdrop-zindex:1050;--bs-backdrop-bg:#000;--bs-backdrop-opacity:.5;position:fixed;top:0;left:0;z-index:var(--bs-backdrop-zindex);width:100vw;height:100vh;background-color:var(--bs-backdrop-bg)}.modal-backdrop.fade[_ngcontent-%COMP%]{opacity:0}.modal-backdrop.show[_ngcontent-%COMP%]{opacity:var(--bs-backdrop-opacity)}.modal-header[_ngcontent-%COMP%]{display:flex;flex-shrink:0;align-items:center;padding:var(--bs-modal-header-padding);border-bottom:var(--bs-modal-header-border-width) solid var(--bs-modal-header-border-color);border-top-left-radius:var(--bs-modal-inner-border-radius);border-top-right-radius:var(--bs-modal-inner-border-radius)}.modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{padding:calc(var(--bs-modal-header-padding-y) * .5) calc(var(--bs-modal-header-padding-x) * .5);margin:calc(-.5 * var(--bs-modal-header-padding-y)) calc(-.5 * var(--bs-modal-header-padding-x)) calc(-.5 * var(--bs-modal-header-padding-y)) auto}.modal-title[_ngcontent-%COMP%]{margin-bottom:0;line-height:var(--bs-modal-title-line-height)}.modal-body[_ngcontent-%COMP%]{position:relative;flex:1 1 auto;padding:var(--bs-modal-padding)}.modal-footer[_ngcontent-%COMP%]{display:flex;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;padding:calc(var(--bs-modal-padding) - var(--bs-modal-footer-gap) * .5);background-color:var(--bs-modal-footer-bg);border-top:var(--bs-modal-footer-border-width) solid var(--bs-modal-footer-border-color);border-bottom-right-radius:var(--bs-modal-inner-border-radius);border-bottom-left-radius:var(--bs-modal-inner-border-radius)}.modal-footer[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:calc(var(--bs-modal-footer-gap) * .5)}@media (min-width:576px){.modal[_ngcontent-%COMP%]{--bs-modal-margin:1.75rem;--bs-modal-box-shadow:var(--bs-box-shadow)}.modal-dialog[_ngcontent-%COMP%]{max-width:var(--bs-modal-width);margin-right:auto;margin-left:auto}.modal-sm[_ngcontent-%COMP%]{--bs-modal-width:300px}}@media (min-width:992px){.modal-lg[_ngcontent-%COMP%], .modal-xl[_ngcontent-%COMP%]{--bs-modal-width:800px}}@media (min-width:1200px){.modal-xl[_ngcontent-%COMP%]{--bs-modal-width:1140px}}.modal-fullscreen[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%], .modal-fullscreen[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}@media (max-width:575.98px){.modal-fullscreen-sm-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-sm-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-sm-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%], .modal-fullscreen-sm-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-sm-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}}@media (max-width:767.98px){.modal-fullscreen-md-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-md-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-md-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%], .modal-fullscreen-md-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-md-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}}@media (max-width:991.98px){.modal-fullscreen-lg-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-lg-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-lg-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%], .modal-fullscreen-lg-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-lg-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}}@media (max-width:1199.98px){.modal-fullscreen-xl-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-xl-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-xl-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%], .modal-fullscreen-xl-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-xl-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}}@media (max-width:1399.98px){.modal-fullscreen-xxl-down[_ngcontent-%COMP%]{width:100vw;max-width:none;height:100%;margin:0}.modal-fullscreen-xxl-down[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{height:100%;border:0;border-radius:0}.modal-fullscreen-xxl-down[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%], .modal-fullscreen-xxl-down[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{border-radius:0}.modal-fullscreen-xxl-down[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{overflow-y:auto}}.tooltip[_ngcontent-%COMP%]{--bs-tooltip-zindex:1080;--bs-tooltip-max-width:200px;--bs-tooltip-padding-x:.5rem;--bs-tooltip-padding-y:.25rem;--bs-tooltip-margin: ;--bs-tooltip-font-size:.875rem;--bs-tooltip-color:var(--bs-body-bg);--bs-tooltip-bg:var(--bs-emphasis-color);--bs-tooltip-border-radius:var(--bs-border-radius);--bs-tooltip-opacity:.9;--bs-tooltip-arrow-width:.8rem;--bs-tooltip-arrow-height:.4rem;z-index:var(--bs-tooltip-zindex);display:block;margin:var(--bs-tooltip-margin);font-family:var(--bs-font-sans-serif);font-style:normal;font-weight:400;line-height:1.5;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;white-space:normal;word-spacing:normal;line-break:auto;font-size:var(--bs-tooltip-font-size);word-wrap:break-word;opacity:0}.tooltip.show[_ngcontent-%COMP%]{opacity:var(--bs-tooltip-opacity)}.tooltip[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{display:block;width:var(--bs-tooltip-arrow-width);height:var(--bs-tooltip-arrow-height)}.tooltip[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before{position:absolute;content:\"\";border-color:transparent;border-style:solid}.bs-tooltip-auto[data-popper-placement^=top][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%], .bs-tooltip-top[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{bottom:calc(-1 * var(--bs-tooltip-arrow-height))}.bs-tooltip-auto[data-popper-placement^=top][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before, .bs-tooltip-top[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before{top:-1px;border-width:var(--bs-tooltip-arrow-height) calc(var(--bs-tooltip-arrow-width) * .5) 0;border-top-color:var(--bs-tooltip-bg)}.bs-tooltip-auto[data-popper-placement^=right][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%], .bs-tooltip-end[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{left:calc(-1 * var(--bs-tooltip-arrow-height));width:var(--bs-tooltip-arrow-height);height:var(--bs-tooltip-arrow-width)}.bs-tooltip-auto[data-popper-placement^=right][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before, .bs-tooltip-end[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before{right:-1px;border-width:calc(var(--bs-tooltip-arrow-width) * .5) var(--bs-tooltip-arrow-height) calc(var(--bs-tooltip-arrow-width) * .5) 0;border-right-color:var(--bs-tooltip-bg)}.bs-tooltip-auto[data-popper-placement^=bottom][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%], .bs-tooltip-bottom[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{top:calc(-1 * var(--bs-tooltip-arrow-height))}.bs-tooltip-auto[data-popper-placement^=bottom][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before, .bs-tooltip-bottom[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before{bottom:-1px;border-width:0 calc(var(--bs-tooltip-arrow-width) * .5) var(--bs-tooltip-arrow-height);border-bottom-color:var(--bs-tooltip-bg)}.bs-tooltip-auto[data-popper-placement^=left][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%], .bs-tooltip-start[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{right:calc(-1 * var(--bs-tooltip-arrow-height));width:var(--bs-tooltip-arrow-height);height:var(--bs-tooltip-arrow-width)}.bs-tooltip-auto[data-popper-placement^=left][_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before, .bs-tooltip-start[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]:before{left:-1px;border-width:calc(var(--bs-tooltip-arrow-width) * .5) 0 calc(var(--bs-tooltip-arrow-width) * .5) var(--bs-tooltip-arrow-height);border-left-color:var(--bs-tooltip-bg)}.tooltip-inner[_ngcontent-%COMP%]{max-width:var(--bs-tooltip-max-width);padding:var(--bs-tooltip-padding-y) var(--bs-tooltip-padding-x);color:var(--bs-tooltip-color);text-align:center;background-color:var(--bs-tooltip-bg);border-radius:var(--bs-tooltip-border-radius)}.popover[_ngcontent-%COMP%]{--bs-popover-zindex:1070;--bs-popover-max-width:276px;--bs-popover-font-size:.875rem;--bs-popover-bg:var(--bs-body-bg);--bs-popover-border-width:var(--bs-border-width);--bs-popover-border-color:var(--bs-border-color-translucent);--bs-popover-border-radius:var(--bs-border-radius-lg);--bs-popover-inner-border-radius:calc(var(--bs-border-radius-lg) - var(--bs-border-width));--bs-popover-box-shadow:var(--bs-box-shadow);--bs-popover-header-padding-x:1rem;--bs-popover-header-padding-y:.5rem;--bs-popover-header-font-size:1rem;--bs-popover-header-color:inherit;--bs-popover-header-bg:var(--bs-secondary-bg);--bs-popover-body-padding-x:1rem;--bs-popover-body-padding-y:1rem;--bs-popover-body-color:var(--bs-body-color);--bs-popover-arrow-width:1rem;--bs-popover-arrow-height:.5rem;--bs-popover-arrow-border:var(--bs-popover-border-color);z-index:var(--bs-popover-zindex);display:block;max-width:var(--bs-popover-max-width);font-family:var(--bs-font-sans-serif);font-style:normal;font-weight:400;line-height:1.5;text-align:left;text-align:start;text-decoration:none;text-shadow:none;text-transform:none;letter-spacing:normal;word-break:normal;white-space:normal;word-spacing:normal;line-break:auto;font-size:var(--bs-popover-font-size);word-wrap:break-word;background-color:var(--bs-popover-bg);background-clip:padding-box;border:var(--bs-popover-border-width) solid var(--bs-popover-border-color);border-radius:var(--bs-popover-border-radius)}.popover[_ngcontent-%COMP%]   .popover-arrow[_ngcontent-%COMP%]{display:block;width:var(--bs-popover-arrow-width);height:var(--bs-popover-arrow-height)}.popover[_ngcontent-%COMP%]   .popover-arrow[_ngcontent-%COMP%]:after, .popover[_ngcontent-%COMP%]   .popover-arrow[_ngcontent-%COMP%]:before{position:absolute;display:block;content:\"\";border-color:transparent;border-style:solid;border-width:0}.bs-popover-auto[data-popper-placement^=top][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%], .bs-popover-top[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]{bottom:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width))}.bs-popover-auto[data-popper-placement^=top][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-auto[data-popper-placement^=top][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-top[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-top[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{border-width:var(--bs-popover-arrow-height) calc(var(--bs-popover-arrow-width) * .5) 0}.bs-popover-auto[data-popper-placement^=top][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-top[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{bottom:0;border-top-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=top][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-top[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after{bottom:var(--bs-popover-border-width);border-top-color:var(--bs-popover-bg)}.bs-popover-auto[data-popper-placement^=right][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%], .bs-popover-end[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]{left:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width));width:var(--bs-popover-arrow-height);height:var(--bs-popover-arrow-width)}.bs-popover-auto[data-popper-placement^=right][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-auto[data-popper-placement^=right][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-end[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-end[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{border-width:calc(var(--bs-popover-arrow-width) * .5) var(--bs-popover-arrow-height) calc(var(--bs-popover-arrow-width) * .5) 0}.bs-popover-auto[data-popper-placement^=right][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-end[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{left:0;border-right-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=right][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-end[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after{left:var(--bs-popover-border-width);border-right-color:var(--bs-popover-bg)}.bs-popover-auto[data-popper-placement^=bottom][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%], .bs-popover-bottom[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]{top:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width))}.bs-popover-auto[data-popper-placement^=bottom][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-auto[data-popper-placement^=bottom][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-bottom[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-bottom[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{border-width:0 calc(var(--bs-popover-arrow-width) * .5) var(--bs-popover-arrow-height)}.bs-popover-auto[data-popper-placement^=bottom][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-bottom[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{top:0;border-bottom-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=bottom][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-bottom[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after{top:var(--bs-popover-border-width);border-bottom-color:var(--bs-popover-bg)}.bs-popover-auto[data-popper-placement^=bottom][_ngcontent-%COMP%]   .popover-header[_ngcontent-%COMP%]:before, .bs-popover-bottom[_ngcontent-%COMP%]   .popover-header[_ngcontent-%COMP%]:before{position:absolute;top:0;left:50%;display:block;width:var(--bs-popover-arrow-width);margin-left:calc(-.5 * var(--bs-popover-arrow-width));content:\"\";border-bottom:var(--bs-popover-border-width) solid var(--bs-popover-header-bg)}.bs-popover-auto[data-popper-placement^=left][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%], .bs-popover-start[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]{right:calc(-1 * (var(--bs-popover-arrow-height)) - var(--bs-popover-border-width));width:var(--bs-popover-arrow-height);height:var(--bs-popover-arrow-width)}.bs-popover-auto[data-popper-placement^=left][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-auto[data-popper-placement^=left][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-start[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-start[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{border-width:calc(var(--bs-popover-arrow-width) * .5) 0 calc(var(--bs-popover-arrow-width) * .5) var(--bs-popover-arrow-height)}.bs-popover-auto[data-popper-placement^=left][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before, .bs-popover-start[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:before{right:0;border-left-color:var(--bs-popover-arrow-border)}.bs-popover-auto[data-popper-placement^=left][_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after, .bs-popover-start[_ngcontent-%COMP%] > .popover-arrow[_ngcontent-%COMP%]:after{right:var(--bs-popover-border-width);border-left-color:var(--bs-popover-bg)}.popover-header[_ngcontent-%COMP%]{padding:var(--bs-popover-header-padding-y) var(--bs-popover-header-padding-x);margin-bottom:0;font-size:var(--bs-popover-header-font-size);color:var(--bs-popover-header-color);background-color:var(--bs-popover-header-bg);border-bottom:var(--bs-popover-border-width) solid var(--bs-popover-border-color);border-top-left-radius:var(--bs-popover-inner-border-radius);border-top-right-radius:var(--bs-popover-inner-border-radius)}.popover-header[_ngcontent-%COMP%]:empty{display:none}.popover-body[_ngcontent-%COMP%]{padding:var(--bs-popover-body-padding-y) var(--bs-popover-body-padding-x);color:var(--bs-popover-body-color)}.carousel[_ngcontent-%COMP%]{position:relative}.carousel.pointer-event[_ngcontent-%COMP%]{touch-action:pan-y}.carousel-inner[_ngcontent-%COMP%]{position:relative;width:100%;overflow:hidden}.carousel-inner[_ngcontent-%COMP%]:after{display:block;clear:both;content:\"\"}.carousel-item[_ngcontent-%COMP%]{position:relative;display:none;float:left;width:100%;margin-right:-100%;backface-visibility:hidden;transition:transform .6s ease-in-out}@media (prefers-reduced-motion:reduce){.carousel-item[_ngcontent-%COMP%]{transition:none}}.carousel-item-next[_ngcontent-%COMP%], .carousel-item-prev[_ngcontent-%COMP%], .carousel-item.active[_ngcontent-%COMP%]{display:block}.active.carousel-item-end[_ngcontent-%COMP%], .carousel-item-next[_ngcontent-%COMP%]:not(.carousel-item-start){transform:translate(100%)}.active.carousel-item-start[_ngcontent-%COMP%], .carousel-item-prev[_ngcontent-%COMP%]:not(.carousel-item-end){transform:translate(-100%)}.carousel-fade[_ngcontent-%COMP%]   .carousel-item[_ngcontent-%COMP%]{opacity:0;transition-property:opacity;transform:none}.carousel-fade[_ngcontent-%COMP%]   .carousel-item-next.carousel-item-start[_ngcontent-%COMP%], .carousel-fade[_ngcontent-%COMP%]   .carousel-item-prev.carousel-item-end[_ngcontent-%COMP%], .carousel-fade[_ngcontent-%COMP%]   .carousel-item.active[_ngcontent-%COMP%]{z-index:1;opacity:1}.carousel-fade[_ngcontent-%COMP%]   .active.carousel-item-end[_ngcontent-%COMP%], .carousel-fade[_ngcontent-%COMP%]   .active.carousel-item-start[_ngcontent-%COMP%]{z-index:0;opacity:0;transition:opacity 0s .6s}@media (prefers-reduced-motion:reduce){.carousel-fade[_ngcontent-%COMP%]   .active.carousel-item-end[_ngcontent-%COMP%], .carousel-fade[_ngcontent-%COMP%]   .active.carousel-item-start[_ngcontent-%COMP%]{transition:none}}.carousel-control-next[_ngcontent-%COMP%], .carousel-control-prev[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;z-index:1;display:flex;align-items:center;justify-content:center;width:15%;padding:0;color:#fff;text-align:center;background:0 0;border:0;opacity:.5;transition:opacity .15s ease}@media (prefers-reduced-motion:reduce){.carousel-control-next[_ngcontent-%COMP%], .carousel-control-prev[_ngcontent-%COMP%]{transition:none}}.carousel-control-next[_ngcontent-%COMP%]:focus, .carousel-control-next[_ngcontent-%COMP%]:hover, .carousel-control-prev[_ngcontent-%COMP%]:focus, .carousel-control-prev[_ngcontent-%COMP%]:hover{color:#fff;text-decoration:none;outline:0;opacity:.9}.carousel-control-prev[_ngcontent-%COMP%]{left:0}.carousel-control-next[_ngcontent-%COMP%]{right:0}.carousel-control-next-icon[_ngcontent-%COMP%], .carousel-control-prev-icon[_ngcontent-%COMP%]{display:inline-block;width:2rem;height:2rem;background-repeat:no-repeat;background-position:50%;background-size:100% 100%}.carousel-control-prev-icon[_ngcontent-%COMP%]{background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z'/%3e%3c/svg%3e\")}.carousel-control-next-icon[_ngcontent-%COMP%]{background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z'/%3e%3c/svg%3e\")}.carousel-indicators[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0;left:0;z-index:2;display:flex;justify-content:center;padding:0;margin-right:15%;margin-bottom:1rem;margin-left:15%}.carousel-indicators[_ngcontent-%COMP%]   [data-bs-target][_ngcontent-%COMP%]{box-sizing:content-box;flex:0 1 auto;width:30px;height:3px;padding:0;margin-right:3px;margin-left:3px;text-indent:-999px;cursor:pointer;background-color:#fff;background-clip:padding-box;border:0;border-top:10px solid transparent;border-bottom:10px solid transparent;opacity:.5;transition:opacity .6s ease}@media (prefers-reduced-motion:reduce){.carousel-indicators[_ngcontent-%COMP%]   [data-bs-target][_ngcontent-%COMP%]{transition:none}}.carousel-indicators[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{opacity:1}.carousel-caption[_ngcontent-%COMP%]{position:absolute;right:15%;bottom:1.25rem;left:15%;padding-top:1.25rem;padding-bottom:1.25rem;color:#fff;text-align:center}.carousel-dark[_ngcontent-%COMP%]   .carousel-control-next-icon[_ngcontent-%COMP%], .carousel-dark[_ngcontent-%COMP%]   .carousel-control-prev-icon[_ngcontent-%COMP%]{filter:invert(1) grayscale(100)}.carousel-dark[_ngcontent-%COMP%]   .carousel-indicators[_ngcontent-%COMP%]   [data-bs-target][_ngcontent-%COMP%]{background-color:#000}.carousel-dark[_ngcontent-%COMP%]   .carousel-caption[_ngcontent-%COMP%]{color:#000}[data-bs-theme=dark][_ngcontent-%COMP%]   .carousel[_ngcontent-%COMP%]   .carousel-control-next-icon[_ngcontent-%COMP%], [data-bs-theme=dark][_ngcontent-%COMP%]   .carousel[_ngcontent-%COMP%]   .carousel-control-prev-icon[_ngcontent-%COMP%], [data-bs-theme=dark].carousel[_ngcontent-%COMP%]   .carousel-control-next-icon[_ngcontent-%COMP%], [data-bs-theme=dark].carousel[_ngcontent-%COMP%]   .carousel-control-prev-icon[_ngcontent-%COMP%]{filter:invert(1) grayscale(100)}[data-bs-theme=dark][_ngcontent-%COMP%]   .carousel[_ngcontent-%COMP%]   .carousel-indicators[_ngcontent-%COMP%]   [data-bs-target][_ngcontent-%COMP%], [data-bs-theme=dark].carousel[_ngcontent-%COMP%]   .carousel-indicators[_ngcontent-%COMP%]   [data-bs-target][_ngcontent-%COMP%]{background-color:#000}[data-bs-theme=dark][_ngcontent-%COMP%]   .carousel[_ngcontent-%COMP%]   .carousel-caption[_ngcontent-%COMP%], [data-bs-theme=dark].carousel[_ngcontent-%COMP%]   .carousel-caption[_ngcontent-%COMP%]{color:#000}.spinner-border[_ngcontent-%COMP%], .spinner-grow[_ngcontent-%COMP%]{display:inline-block;width:var(--bs-spinner-width);height:var(--bs-spinner-height);vertical-align:var(--bs-spinner-vertical-align);border-radius:50%;animation:var(--bs-spinner-animation-speed) linear infinite var(--bs-spinner-animation-name)}@keyframes _ngcontent-%COMP%_spinner-border{to{transform:rotate(360deg)}}.spinner-border[_ngcontent-%COMP%]{--bs-spinner-width:2rem;--bs-spinner-height:2rem;--bs-spinner-vertical-align:-.125em;--bs-spinner-border-width:.25em;--bs-spinner-animation-speed:.75s;--bs-spinner-animation-name:spinner-border;border:var(--bs-spinner-border-width) solid currentcolor;border-right-color:transparent}.spinner-border-sm[_ngcontent-%COMP%]{--bs-spinner-width:1rem;--bs-spinner-height:1rem;--bs-spinner-border-width:.2em}@keyframes _ngcontent-%COMP%_spinner-grow{0%{transform:scale(0)}50%{opacity:1;transform:none}}.spinner-grow[_ngcontent-%COMP%]{--bs-spinner-width:2rem;--bs-spinner-height:2rem;--bs-spinner-vertical-align:-.125em;--bs-spinner-animation-speed:.75s;--bs-spinner-animation-name:spinner-grow;background-color:currentcolor;opacity:0}.spinner-grow-sm[_ngcontent-%COMP%]{--bs-spinner-width:1rem;--bs-spinner-height:1rem}@media (prefers-reduced-motion:reduce){.spinner-border[_ngcontent-%COMP%], .spinner-grow[_ngcontent-%COMP%]{--bs-spinner-animation-speed:1.5s}}.offcanvas[_ngcontent-%COMP%], .offcanvas-lg[_ngcontent-%COMP%], .offcanvas-md[_ngcontent-%COMP%], .offcanvas-sm[_ngcontent-%COMP%], .offcanvas-xl[_ngcontent-%COMP%], .offcanvas-xxl[_ngcontent-%COMP%]{--bs-offcanvas-zindex:1045;--bs-offcanvas-width:400px;--bs-offcanvas-height:30vh;--bs-offcanvas-padding-x:1rem;--bs-offcanvas-padding-y:1rem;--bs-offcanvas-color:var(--bs-body-color);--bs-offcanvas-bg:var(--bs-body-bg);--bs-offcanvas-border-width:var(--bs-border-width);--bs-offcanvas-border-color:var(--bs-border-color-translucent);--bs-offcanvas-box-shadow:var(--bs-box-shadow-sm);--bs-offcanvas-transition:transform .3s ease-in-out;--bs-offcanvas-title-line-height:1.5}@media (max-width:575.98px){.offcanvas-sm[_ngcontent-%COMP%]{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:575.98px) and (prefers-reduced-motion:reduce){.offcanvas-sm[_ngcontent-%COMP%]{transition:none}}@media (max-width:575.98px){.offcanvas-sm.offcanvas-start[_ngcontent-%COMP%]{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(-100%)}.offcanvas-sm.offcanvas-end[_ngcontent-%COMP%]{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(100%)}.offcanvas-sm.offcanvas-top[_ngcontent-%COMP%]{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-sm.offcanvas-bottom[_ngcontent-%COMP%]{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-sm.show[_ngcontent-%COMP%]:not(.hiding), .offcanvas-sm.showing[_ngcontent-%COMP%]{transform:none}.offcanvas-sm.hiding[_ngcontent-%COMP%], .offcanvas-sm.show[_ngcontent-%COMP%], .offcanvas-sm.showing[_ngcontent-%COMP%]{visibility:visible}}@media (min-width:576px){.offcanvas-sm[_ngcontent-%COMP%]{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-sm[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.offcanvas-sm[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:767.98px){.offcanvas-md[_ngcontent-%COMP%]{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:767.98px) and (prefers-reduced-motion:reduce){.offcanvas-md[_ngcontent-%COMP%]{transition:none}}@media (max-width:767.98px){.offcanvas-md.offcanvas-start[_ngcontent-%COMP%]{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(-100%)}.offcanvas-md.offcanvas-end[_ngcontent-%COMP%]{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(100%)}.offcanvas-md.offcanvas-top[_ngcontent-%COMP%]{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-md.offcanvas-bottom[_ngcontent-%COMP%]{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-md.show[_ngcontent-%COMP%]:not(.hiding), .offcanvas-md.showing[_ngcontent-%COMP%]{transform:none}.offcanvas-md.hiding[_ngcontent-%COMP%], .offcanvas-md.show[_ngcontent-%COMP%], .offcanvas-md.showing[_ngcontent-%COMP%]{visibility:visible}}@media (min-width:768px){.offcanvas-md[_ngcontent-%COMP%]{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-md[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.offcanvas-md[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:991.98px){.offcanvas-lg[_ngcontent-%COMP%]{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:991.98px) and (prefers-reduced-motion:reduce){.offcanvas-lg[_ngcontent-%COMP%]{transition:none}}@media (max-width:991.98px){.offcanvas-lg.offcanvas-start[_ngcontent-%COMP%]{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(-100%)}.offcanvas-lg.offcanvas-end[_ngcontent-%COMP%]{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(100%)}.offcanvas-lg.offcanvas-top[_ngcontent-%COMP%]{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-lg.offcanvas-bottom[_ngcontent-%COMP%]{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-lg.show[_ngcontent-%COMP%]:not(.hiding), .offcanvas-lg.showing[_ngcontent-%COMP%]{transform:none}.offcanvas-lg.hiding[_ngcontent-%COMP%], .offcanvas-lg.show[_ngcontent-%COMP%], .offcanvas-lg.showing[_ngcontent-%COMP%]{visibility:visible}}@media (min-width:992px){.offcanvas-lg[_ngcontent-%COMP%]{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-lg[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.offcanvas-lg[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:1199.98px){.offcanvas-xl[_ngcontent-%COMP%]{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:1199.98px) and (prefers-reduced-motion:reduce){.offcanvas-xl[_ngcontent-%COMP%]{transition:none}}@media (max-width:1199.98px){.offcanvas-xl.offcanvas-start[_ngcontent-%COMP%]{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(-100%)}.offcanvas-xl.offcanvas-end[_ngcontent-%COMP%]{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(100%)}.offcanvas-xl.offcanvas-top[_ngcontent-%COMP%]{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-xl.offcanvas-bottom[_ngcontent-%COMP%]{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-xl.show[_ngcontent-%COMP%]:not(.hiding), .offcanvas-xl.showing[_ngcontent-%COMP%]{transform:none}.offcanvas-xl.hiding[_ngcontent-%COMP%], .offcanvas-xl.show[_ngcontent-%COMP%], .offcanvas-xl.showing[_ngcontent-%COMP%]{visibility:visible}}@media (min-width:1200px){.offcanvas-xl[_ngcontent-%COMP%]{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-xl[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.offcanvas-xl[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}@media (max-width:1399.98px){.offcanvas-xxl[_ngcontent-%COMP%]{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}}@media (max-width:1399.98px) and (prefers-reduced-motion:reduce){.offcanvas-xxl[_ngcontent-%COMP%]{transition:none}}@media (max-width:1399.98px){.offcanvas-xxl.offcanvas-start[_ngcontent-%COMP%]{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(-100%)}.offcanvas-xxl.offcanvas-end[_ngcontent-%COMP%]{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(100%)}.offcanvas-xxl.offcanvas-top[_ngcontent-%COMP%]{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas-xxl.offcanvas-bottom[_ngcontent-%COMP%]{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas-xxl.show[_ngcontent-%COMP%]:not(.hiding), .offcanvas-xxl.showing[_ngcontent-%COMP%]{transform:none}.offcanvas-xxl.hiding[_ngcontent-%COMP%], .offcanvas-xxl.show[_ngcontent-%COMP%], .offcanvas-xxl.showing[_ngcontent-%COMP%]{visibility:visible}}@media (min-width:1400px){.offcanvas-xxl[_ngcontent-%COMP%]{--bs-offcanvas-height:auto;--bs-offcanvas-border-width:0;background-color:transparent!important}.offcanvas-xxl[_ngcontent-%COMP%]   .offcanvas-header[_ngcontent-%COMP%]{display:none}.offcanvas-xxl[_ngcontent-%COMP%]   .offcanvas-body[_ngcontent-%COMP%]{display:flex;flex-grow:0;padding:0;overflow-y:visible;background-color:transparent!important}}.offcanvas[_ngcontent-%COMP%]{position:fixed;bottom:0;z-index:var(--bs-offcanvas-zindex);display:flex;flex-direction:column;max-width:100%;color:var(--bs-offcanvas-color);visibility:hidden;background-color:var(--bs-offcanvas-bg);background-clip:padding-box;outline:0;transition:var(--bs-offcanvas-transition)}@media (prefers-reduced-motion:reduce){.offcanvas[_ngcontent-%COMP%]{transition:none}}.offcanvas.offcanvas-start[_ngcontent-%COMP%]{top:0;left:0;width:var(--bs-offcanvas-width);border-right:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(-100%)}.offcanvas.offcanvas-end[_ngcontent-%COMP%]{top:0;right:0;width:var(--bs-offcanvas-width);border-left:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translate(100%)}.offcanvas.offcanvas-top[_ngcontent-%COMP%]{top:0;right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-bottom:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(-100%)}.offcanvas.offcanvas-bottom[_ngcontent-%COMP%]{right:0;left:0;height:var(--bs-offcanvas-height);max-height:100%;border-top:var(--bs-offcanvas-border-width) solid var(--bs-offcanvas-border-color);transform:translateY(100%)}.offcanvas.show[_ngcontent-%COMP%]:not(.hiding), .offcanvas.showing[_ngcontent-%COMP%]{transform:none}.offcanvas.hiding[_ngcontent-%COMP%], .offcanvas.show[_ngcontent-%COMP%], .offcanvas.showing[_ngcontent-%COMP%]{visibility:visible}.offcanvas-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;z-index:1040;width:100vw;height:100vh;background-color:#000}.offcanvas-backdrop.fade[_ngcontent-%COMP%]{opacity:0}.offcanvas-backdrop.show[_ngcontent-%COMP%]{opacity:.5}.offcanvas-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:var(--bs-offcanvas-padding-y) var(--bs-offcanvas-padding-x)}.offcanvas-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{padding:calc(var(--bs-offcanvas-padding-y) * .5) calc(var(--bs-offcanvas-padding-x) * .5);margin:calc(-.5 * var(--bs-offcanvas-padding-y)) calc(-.5 * var(--bs-offcanvas-padding-x)) calc(-.5 * var(--bs-offcanvas-padding-y)) auto}.offcanvas-title[_ngcontent-%COMP%]{margin-bottom:0;line-height:var(--bs-offcanvas-title-line-height)}.offcanvas-body[_ngcontent-%COMP%]{flex-grow:1;padding:var(--bs-offcanvas-padding-y) var(--bs-offcanvas-padding-x);overflow-y:auto}.placeholder[_ngcontent-%COMP%]{display:inline-block;min-height:1em;vertical-align:middle;cursor:wait;background-color:currentcolor;opacity:.5}.placeholder.btn[_ngcontent-%COMP%]:before{display:inline-block;content:\"\"}.placeholder-xs[_ngcontent-%COMP%]{min-height:.6em}.placeholder-sm[_ngcontent-%COMP%]{min-height:.8em}.placeholder-lg[_ngcontent-%COMP%]{min-height:1.2em}.placeholder-glow[_ngcontent-%COMP%]   .placeholder[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_placeholder-glow 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_placeholder-glow{50%{opacity:.2}}.placeholder-wave[_ngcontent-%COMP%]{-webkit-mask-image:linear-gradient(130deg,#000 55%,rgba(0,0,0,.8) 75%,#000 95%);mask-image:linear-gradient(130deg,#000 55%,rgba(0,0,0,.8) 75%,#000 95%);-webkit-mask-size:200% 100%;mask-size:200% 100%;animation:_ngcontent-%COMP%_placeholder-wave 2s linear infinite}@keyframes _ngcontent-%COMP%_placeholder-wave{to{-webkit-mask-position:-200% 0%;mask-position:-200% 0%}}.clearfix[_ngcontent-%COMP%]:after{display:block;clear:both;content:\"\"}.text-bg-primary[_ngcontent-%COMP%]{color:#fff!important;background-color:RGBA(var(--bs-primary-rgb),var(--bs-bg-opacity,1))!important}.text-bg-secondary[_ngcontent-%COMP%]{color:#fff!important;background-color:RGBA(var(--bs-secondary-rgb),var(--bs-bg-opacity,1))!important}.text-bg-success[_ngcontent-%COMP%]{color:#fff!important;background-color:RGBA(var(--bs-success-rgb),var(--bs-bg-opacity,1))!important}.text-bg-info[_ngcontent-%COMP%]{color:#000!important;background-color:RGBA(var(--bs-info-rgb),var(--bs-bg-opacity,1))!important}.text-bg-warning[_ngcontent-%COMP%]{color:#000!important;background-color:RGBA(var(--bs-warning-rgb),var(--bs-bg-opacity,1))!important}.text-bg-danger[_ngcontent-%COMP%]{color:#fff!important;background-color:RGBA(var(--bs-danger-rgb),var(--bs-bg-opacity,1))!important}.text-bg-light[_ngcontent-%COMP%]{color:#000!important;background-color:RGBA(var(--bs-light-rgb),var(--bs-bg-opacity,1))!important}.text-bg-dark[_ngcontent-%COMP%]{color:#fff!important;background-color:RGBA(var(--bs-dark-rgb),var(--bs-bg-opacity,1))!important}.link-primary[_ngcontent-%COMP%]{color:RGBA(var(--bs-primary-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-primary-rgb),var(--bs-link-underline-opacity,1))!important}.link-primary[_ngcontent-%COMP%]:focus, .link-primary[_ngcontent-%COMP%]:hover{color:RGBA(10,88,202,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(10,88,202,var(--bs-link-underline-opacity,1))!important}.link-secondary[_ngcontent-%COMP%]{color:RGBA(var(--bs-secondary-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-secondary-rgb),var(--bs-link-underline-opacity,1))!important}.link-secondary[_ngcontent-%COMP%]:focus, .link-secondary[_ngcontent-%COMP%]:hover{color:RGBA(86,94,100,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(86,94,100,var(--bs-link-underline-opacity,1))!important}.link-success[_ngcontent-%COMP%]{color:RGBA(var(--bs-success-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-success-rgb),var(--bs-link-underline-opacity,1))!important}.link-success[_ngcontent-%COMP%]:focus, .link-success[_ngcontent-%COMP%]:hover{color:RGBA(20,108,67,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(20,108,67,var(--bs-link-underline-opacity,1))!important}.link-info[_ngcontent-%COMP%]{color:RGBA(var(--bs-info-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-info-rgb),var(--bs-link-underline-opacity,1))!important}.link-info[_ngcontent-%COMP%]:focus, .link-info[_ngcontent-%COMP%]:hover{color:RGBA(61,213,243,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(61,213,243,var(--bs-link-underline-opacity,1))!important}.link-warning[_ngcontent-%COMP%]{color:RGBA(var(--bs-warning-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-warning-rgb),var(--bs-link-underline-opacity,1))!important}.link-warning[_ngcontent-%COMP%]:focus, .link-warning[_ngcontent-%COMP%]:hover{color:RGBA(255,205,57,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(255,205,57,var(--bs-link-underline-opacity,1))!important}.link-danger[_ngcontent-%COMP%]{color:RGBA(var(--bs-danger-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-danger-rgb),var(--bs-link-underline-opacity,1))!important}.link-danger[_ngcontent-%COMP%]:focus, .link-danger[_ngcontent-%COMP%]:hover{color:RGBA(176,42,55,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(176,42,55,var(--bs-link-underline-opacity,1))!important}.link-light[_ngcontent-%COMP%]{color:RGBA(var(--bs-light-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-light-rgb),var(--bs-link-underline-opacity,1))!important}.link-light[_ngcontent-%COMP%]:focus, .link-light[_ngcontent-%COMP%]:hover{color:RGBA(249,250,251,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(249,250,251,var(--bs-link-underline-opacity,1))!important}.link-dark[_ngcontent-%COMP%]{color:RGBA(var(--bs-dark-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-dark-rgb),var(--bs-link-underline-opacity,1))!important}.link-dark[_ngcontent-%COMP%]:focus, .link-dark[_ngcontent-%COMP%]:hover{color:RGBA(26,30,33,var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(26,30,33,var(--bs-link-underline-opacity,1))!important}.link-body-emphasis[_ngcontent-%COMP%]{color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-opacity,1))!important;text-decoration-color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-underline-opacity,1))!important}.link-body-emphasis[_ngcontent-%COMP%]:focus, .link-body-emphasis[_ngcontent-%COMP%]:hover{color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-opacity,.75))!important;text-decoration-color:RGBA(var(--bs-emphasis-color-rgb),var(--bs-link-underline-opacity,.75))!important}.focus-ring[_ngcontent-%COMP%]:focus{outline:0;box-shadow:var(--bs-focus-ring-x,0) var(--bs-focus-ring-y,0) var(--bs-focus-ring-blur,0) var(--bs-focus-ring-width) var(--bs-focus-ring-color)}.icon-link[_ngcontent-%COMP%]{display:inline-flex;gap:.375rem;align-items:center;text-decoration-color:rgba(var(--bs-link-color-rgb),var(--bs-link-opacity,.5));text-underline-offset:.25em;backface-visibility:hidden}.icon-link[_ngcontent-%COMP%] > .bi[_ngcontent-%COMP%]{flex-shrink:0;width:1em;height:1em;fill:currentcolor;transition:.2s ease-in-out transform}@media (prefers-reduced-motion:reduce){.icon-link[_ngcontent-%COMP%] > .bi[_ngcontent-%COMP%]{transition:none}}.icon-link-hover[_ngcontent-%COMP%]:focus-visible > .bi[_ngcontent-%COMP%], .icon-link-hover[_ngcontent-%COMP%]:hover > .bi[_ngcontent-%COMP%]{transform:var(--bs-icon-link-transform,translate3d(.25em,0,0))}.ratio[_ngcontent-%COMP%]{position:relative;width:100%}.ratio[_ngcontent-%COMP%]:before{display:block;padding-top:var(--bs-aspect-ratio);content:\"\"}.ratio[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.ratio-1x1[_ngcontent-%COMP%]{--bs-aspect-ratio:100%}.ratio-4x3[_ngcontent-%COMP%]{--bs-aspect-ratio:75%}.ratio-16x9[_ngcontent-%COMP%]{--bs-aspect-ratio:56.25%}.ratio-21x9[_ngcontent-%COMP%]{--bs-aspect-ratio:42.8571428571%}.fixed-top[_ngcontent-%COMP%]{position:fixed;top:0;right:0;left:0;z-index:1030}.fixed-bottom[_ngcontent-%COMP%]{position:fixed;right:0;bottom:0;left:0;z-index:1030}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1020}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:1020}@media (min-width:576px){.sticky-sm-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1020}.sticky-sm-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:1020}}@media (min-width:768px){.sticky-md-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1020}.sticky-md-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:1020}}@media (min-width:992px){.sticky-lg-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1020}.sticky-lg-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:1020}}@media (min-width:1200px){.sticky-xl-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1020}.sticky-xl-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:1020}}@media (min-width:1400px){.sticky-xxl-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1020}.sticky-xxl-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;z-index:1020}}.hstack[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;align-self:stretch}.vstack[_ngcontent-%COMP%]{display:flex;flex:1 1 auto;flex-direction:column;align-self:stretch}.visually-hidden[_ngcontent-%COMP%], .visually-hidden-focusable[_ngcontent-%COMP%]:not(:focus):not(:focus-within){width:1px!important;height:1px!important;padding:0!important;margin:-1px!important;overflow:hidden!important;clip:rect(0,0,0,0)!important;white-space:nowrap!important;border:0!important}.visually-hidden-focusable[_ngcontent-%COMP%]:not(:focus):not(:focus-within):not(caption), .visually-hidden[_ngcontent-%COMP%]:not(caption){position:absolute!important}.stretched-link[_ngcontent-%COMP%]:after{position:absolute;inset:0;z-index:1;content:\"\"}.text-truncate[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.vr[_ngcontent-%COMP%]{display:inline-block;align-self:stretch;width:var(--bs-border-width);min-height:1em;background-color:currentcolor;opacity:.25}.align-baseline[_ngcontent-%COMP%]{vertical-align:baseline!important}.align-top[_ngcontent-%COMP%]{vertical-align:top!important}.align-middle[_ngcontent-%COMP%]{vertical-align:middle!important}.align-bottom[_ngcontent-%COMP%]{vertical-align:bottom!important}.align-text-bottom[_ngcontent-%COMP%]{vertical-align:text-bottom!important}.align-text-top[_ngcontent-%COMP%]{vertical-align:text-top!important}.float-start[_ngcontent-%COMP%]{float:left!important}.float-end[_ngcontent-%COMP%]{float:right!important}.float-none[_ngcontent-%COMP%]{float:none!important}.object-fit-contain[_ngcontent-%COMP%]{object-fit:contain!important}.object-fit-cover[_ngcontent-%COMP%]{object-fit:cover!important}.object-fit-fill[_ngcontent-%COMP%]{object-fit:fill!important}.object-fit-scale[_ngcontent-%COMP%]{object-fit:scale-down!important}.object-fit-none[_ngcontent-%COMP%]{object-fit:none!important}.opacity-0[_ngcontent-%COMP%]{opacity:0!important}.opacity-25[_ngcontent-%COMP%]{opacity:.25!important}.opacity-50[_ngcontent-%COMP%]{opacity:.5!important}.opacity-75[_ngcontent-%COMP%]{opacity:.75!important}.opacity-100[_ngcontent-%COMP%]{opacity:1!important}.overflow-auto[_ngcontent-%COMP%]{overflow:auto!important}.overflow-hidden[_ngcontent-%COMP%]{overflow:hidden!important}.overflow-visible[_ngcontent-%COMP%]{overflow:visible!important}.overflow-scroll[_ngcontent-%COMP%]{overflow:scroll!important}.overflow-x-auto[_ngcontent-%COMP%]{overflow-x:auto!important}.overflow-x-hidden[_ngcontent-%COMP%]{overflow-x:hidden!important}.overflow-x-visible[_ngcontent-%COMP%]{overflow-x:visible!important}.overflow-x-scroll[_ngcontent-%COMP%]{overflow-x:scroll!important}.overflow-y-auto[_ngcontent-%COMP%]{overflow-y:auto!important}.overflow-y-hidden[_ngcontent-%COMP%]{overflow-y:hidden!important}.overflow-y-visible[_ngcontent-%COMP%]{overflow-y:visible!important}.overflow-y-scroll[_ngcontent-%COMP%]{overflow-y:scroll!important}.d-inline[_ngcontent-%COMP%]{display:inline!important}.d-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-block[_ngcontent-%COMP%]{display:block!important}.d-grid[_ngcontent-%COMP%]{display:grid!important}.d-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-table[_ngcontent-%COMP%]{display:table!important}.d-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-flex[_ngcontent-%COMP%]{display:flex!important}.d-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-none[_ngcontent-%COMP%]{display:none!important}.shadow[_ngcontent-%COMP%]{box-shadow:var(--bs-box-shadow)!important}.shadow-sm[_ngcontent-%COMP%]{box-shadow:var(--bs-box-shadow-sm)!important}.shadow-lg[_ngcontent-%COMP%]{box-shadow:var(--bs-box-shadow-lg)!important}.shadow-none[_ngcontent-%COMP%]{box-shadow:none!important}.focus-ring-primary[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-primary-rgb), var(--bs-focus-ring-opacity))}.focus-ring-secondary[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-secondary-rgb), var(--bs-focus-ring-opacity))}.focus-ring-success[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-success-rgb), var(--bs-focus-ring-opacity))}.focus-ring-info[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-info-rgb), var(--bs-focus-ring-opacity))}.focus-ring-warning[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-warning-rgb), var(--bs-focus-ring-opacity))}.focus-ring-danger[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-danger-rgb), var(--bs-focus-ring-opacity))}.focus-ring-light[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-light-rgb), var(--bs-focus-ring-opacity))}.focus-ring-dark[_ngcontent-%COMP%]{--bs-focus-ring-color:rgba(var(--bs-dark-rgb), var(--bs-focus-ring-opacity))}.position-static[_ngcontent-%COMP%]{position:static!important}.position-relative[_ngcontent-%COMP%]{position:relative!important}.position-absolute[_ngcontent-%COMP%]{position:absolute!important}.position-fixed[_ngcontent-%COMP%]{position:fixed!important}.position-sticky[_ngcontent-%COMP%]{position:sticky!important}.top-0[_ngcontent-%COMP%]{top:0!important}.top-50[_ngcontent-%COMP%]{top:50%!important}.top-100[_ngcontent-%COMP%]{top:100%!important}.bottom-0[_ngcontent-%COMP%]{bottom:0!important}.bottom-50[_ngcontent-%COMP%]{bottom:50%!important}.bottom-100[_ngcontent-%COMP%]{bottom:100%!important}.start-0[_ngcontent-%COMP%]{left:0!important}.start-50[_ngcontent-%COMP%]{left:50%!important}.start-100[_ngcontent-%COMP%]{left:100%!important}.end-0[_ngcontent-%COMP%]{right:0!important}.end-50[_ngcontent-%COMP%]{right:50%!important}.end-100[_ngcontent-%COMP%]{right:100%!important}.translate-middle[_ngcontent-%COMP%]{transform:translate(-50%,-50%)!important}.translate-middle-x[_ngcontent-%COMP%]{transform:translate(-50%)!important}.translate-middle-y[_ngcontent-%COMP%]{transform:translateY(-50%)!important}.border[_ngcontent-%COMP%]{border:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-0[_ngcontent-%COMP%]{border:0!important}.border-top[_ngcontent-%COMP%]{border-top:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-top-0[_ngcontent-%COMP%]{border-top:0!important}.border-end[_ngcontent-%COMP%]{border-right:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-end-0[_ngcontent-%COMP%]{border-right:0!important}.border-bottom[_ngcontent-%COMP%]{border-bottom:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-bottom-0[_ngcontent-%COMP%]{border-bottom:0!important}.border-start[_ngcontent-%COMP%]{border-left:var(--bs-border-width) var(--bs-border-style) var(--bs-border-color)!important}.border-start-0[_ngcontent-%COMP%]{border-left:0!important}.border-primary[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-primary-rgb),var(--bs-border-opacity))!important}.border-secondary[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-secondary-rgb),var(--bs-border-opacity))!important}.border-success[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-success-rgb),var(--bs-border-opacity))!important}.border-info[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-info-rgb),var(--bs-border-opacity))!important}.border-warning[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-warning-rgb),var(--bs-border-opacity))!important}.border-danger[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-danger-rgb),var(--bs-border-opacity))!important}.border-light[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-light-rgb),var(--bs-border-opacity))!important}.border-dark[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-dark-rgb),var(--bs-border-opacity))!important}.border-black[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-black-rgb),var(--bs-border-opacity))!important}.border-white[_ngcontent-%COMP%]{--bs-border-opacity:1;border-color:rgba(var(--bs-white-rgb),var(--bs-border-opacity))!important}.border-primary-subtle[_ngcontent-%COMP%]{border-color:var(--bs-primary-border-subtle)!important}.border-secondary-subtle[_ngcontent-%COMP%]{border-color:var(--bs-secondary-border-subtle)!important}.border-success-subtle[_ngcontent-%COMP%]{border-color:var(--bs-success-border-subtle)!important}.border-info-subtle[_ngcontent-%COMP%]{border-color:var(--bs-info-border-subtle)!important}.border-warning-subtle[_ngcontent-%COMP%]{border-color:var(--bs-warning-border-subtle)!important}.border-danger-subtle[_ngcontent-%COMP%]{border-color:var(--bs-danger-border-subtle)!important}.border-light-subtle[_ngcontent-%COMP%]{border-color:var(--bs-light-border-subtle)!important}.border-dark-subtle[_ngcontent-%COMP%]{border-color:var(--bs-dark-border-subtle)!important}.border-1[_ngcontent-%COMP%]{border-width:1px!important}.border-2[_ngcontent-%COMP%]{border-width:2px!important}.border-3[_ngcontent-%COMP%]{border-width:3px!important}.border-4[_ngcontent-%COMP%]{border-width:4px!important}.border-5[_ngcontent-%COMP%]{border-width:5px!important}.border-opacity-10[_ngcontent-%COMP%]{--bs-border-opacity:.1}.border-opacity-25[_ngcontent-%COMP%]{--bs-border-opacity:.25}.border-opacity-50[_ngcontent-%COMP%]{--bs-border-opacity:.5}.border-opacity-75[_ngcontent-%COMP%]{--bs-border-opacity:.75}.border-opacity-100[_ngcontent-%COMP%]{--bs-border-opacity:1}.w-25[_ngcontent-%COMP%]{width:25%!important}.w-50[_ngcontent-%COMP%]{width:50%!important}.w-75[_ngcontent-%COMP%]{width:75%!important}.w-100[_ngcontent-%COMP%]{width:100%!important}.w-auto[_ngcontent-%COMP%]{width:auto!important}.mw-100[_ngcontent-%COMP%]{max-width:100%!important}.vw-100[_ngcontent-%COMP%]{width:100vw!important}.min-vw-100[_ngcontent-%COMP%]{min-width:100vw!important}.h-25[_ngcontent-%COMP%]{height:25%!important}.h-50[_ngcontent-%COMP%]{height:50%!important}.h-75[_ngcontent-%COMP%]{height:75%!important}.h-100[_ngcontent-%COMP%]{height:100%!important}.h-auto[_ngcontent-%COMP%]{height:auto!important}.mh-100[_ngcontent-%COMP%]{max-height:100%!important}.vh-100[_ngcontent-%COMP%]{height:100vh!important}.min-vh-100[_ngcontent-%COMP%]{min-height:100vh!important}.flex-fill[_ngcontent-%COMP%]{flex:1 1 auto!important}.flex-row[_ngcontent-%COMP%]{flex-direction:row!important}.flex-column[_ngcontent-%COMP%]{flex-direction:column!important}.flex-row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse!important}.flex-column-reverse[_ngcontent-%COMP%]{flex-direction:column-reverse!important}.flex-grow-0[_ngcontent-%COMP%]{flex-grow:0!important}.flex-grow-1[_ngcontent-%COMP%]{flex-grow:1!important}.flex-shrink-0[_ngcontent-%COMP%]{flex-shrink:0!important}.flex-shrink-1[_ngcontent-%COMP%]{flex-shrink:1!important}.flex-wrap[_ngcontent-%COMP%]{flex-wrap:wrap!important}.flex-nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap!important}.flex-wrap-reverse[_ngcontent-%COMP%]{flex-wrap:wrap-reverse!important}.justify-content-start[_ngcontent-%COMP%]{justify-content:flex-start!important}.justify-content-end[_ngcontent-%COMP%]{justify-content:flex-end!important}.justify-content-center[_ngcontent-%COMP%]{justify-content:center!important}.justify-content-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-around[_ngcontent-%COMP%]{justify-content:space-around!important}.justify-content-evenly[_ngcontent-%COMP%]{justify-content:space-evenly!important}.align-items-start[_ngcontent-%COMP%]{align-items:flex-start!important}.align-items-end[_ngcontent-%COMP%]{align-items:flex-end!important}.align-items-center[_ngcontent-%COMP%]{align-items:center!important}.align-items-baseline[_ngcontent-%COMP%]{align-items:baseline!important}.align-items-stretch[_ngcontent-%COMP%]{align-items:stretch!important}.align-content-start[_ngcontent-%COMP%]{align-content:flex-start!important}.align-content-end[_ngcontent-%COMP%]{align-content:flex-end!important}.align-content-center[_ngcontent-%COMP%]{align-content:center!important}.align-content-between[_ngcontent-%COMP%]{align-content:space-between!important}.align-content-around[_ngcontent-%COMP%]{align-content:space-around!important}.align-content-stretch[_ngcontent-%COMP%]{align-content:stretch!important}.align-self-auto[_ngcontent-%COMP%]{align-self:auto!important}.align-self-start[_ngcontent-%COMP%]{align-self:flex-start!important}.align-self-end[_ngcontent-%COMP%]{align-self:flex-end!important}.align-self-center[_ngcontent-%COMP%]{align-self:center!important}.align-self-baseline[_ngcontent-%COMP%]{align-self:baseline!important}.align-self-stretch[_ngcontent-%COMP%]{align-self:stretch!important}.order-first[_ngcontent-%COMP%]{order:-1!important}.order-0[_ngcontent-%COMP%]{order:0!important}.order-1[_ngcontent-%COMP%]{order:1!important}.order-2[_ngcontent-%COMP%]{order:2!important}.order-3[_ngcontent-%COMP%]{order:3!important}.order-4[_ngcontent-%COMP%]{order:4!important}.order-5[_ngcontent-%COMP%]{order:5!important}.order-last[_ngcontent-%COMP%]{order:6!important}.m-0[_ngcontent-%COMP%]{margin:0!important}.m-1[_ngcontent-%COMP%]{margin:.25rem!important}.m-2[_ngcontent-%COMP%]{margin:.5rem!important}.m-3[_ngcontent-%COMP%]{margin:1rem!important}.m-4[_ngcontent-%COMP%]{margin:1.5rem!important}.m-5[_ngcontent-%COMP%]{margin:3rem!important}.m-auto[_ngcontent-%COMP%]{margin:auto!important}.mx-0[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}.mx-1[_ngcontent-%COMP%]{margin-right:.25rem!important;margin-left:.25rem!important}.mx-2[_ngcontent-%COMP%]{margin-right:.5rem!important;margin-left:.5rem!important}.mx-3[_ngcontent-%COMP%]{margin-right:1rem!important;margin-left:1rem!important}.mx-4[_ngcontent-%COMP%]{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-5[_ngcontent-%COMP%]{margin-right:3rem!important;margin-left:3rem!important}.mx-auto[_ngcontent-%COMP%]{margin-right:auto!important;margin-left:auto!important}.my-0[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}.my-1[_ngcontent-%COMP%]{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-2[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-3[_ngcontent-%COMP%]{margin-top:1rem!important;margin-bottom:1rem!important}.my-4[_ngcontent-%COMP%]{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-5[_ngcontent-%COMP%]{margin-top:3rem!important;margin-bottom:3rem!important}.my-auto[_ngcontent-%COMP%]{margin-top:auto!important;margin-bottom:auto!important}.mt-0[_ngcontent-%COMP%]{margin-top:0!important}.mt-1[_ngcontent-%COMP%]{margin-top:.25rem!important}.mt-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}.mt-5[_ngcontent-%COMP%]{margin-top:3rem!important}.mt-auto[_ngcontent-%COMP%]{margin-top:auto!important}.me-0[_ngcontent-%COMP%]{margin-right:0!important}.me-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-3[_ngcontent-%COMP%]{margin-right:1rem!important}.me-4[_ngcontent-%COMP%]{margin-right:1.5rem!important}.me-5[_ngcontent-%COMP%]{margin-right:3rem!important}.me-auto[_ngcontent-%COMP%]{margin-right:auto!important}.mb-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-5[_ngcontent-%COMP%]{margin-bottom:3rem!important}.mb-auto[_ngcontent-%COMP%]{margin-bottom:auto!important}.ms-0[_ngcontent-%COMP%]{margin-left:0!important}.ms-1[_ngcontent-%COMP%]{margin-left:.25rem!important}.ms-2[_ngcontent-%COMP%]{margin-left:.5rem!important}.ms-3[_ngcontent-%COMP%]{margin-left:1rem!important}.ms-4[_ngcontent-%COMP%]{margin-left:1.5rem!important}.ms-5[_ngcontent-%COMP%]{margin-left:3rem!important}.ms-auto[_ngcontent-%COMP%]{margin-left:auto!important}.p-0[_ngcontent-%COMP%]{padding:0!important}.p-1[_ngcontent-%COMP%]{padding:.25rem!important}.p-2[_ngcontent-%COMP%]{padding:.5rem!important}.p-3[_ngcontent-%COMP%]{padding:1rem!important}.p-4[_ngcontent-%COMP%]{padding:1.5rem!important}.p-5[_ngcontent-%COMP%]{padding:3rem!important}.px-0[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.px-1[_ngcontent-%COMP%]{padding-right:.25rem!important;padding-left:.25rem!important}.px-2[_ngcontent-%COMP%]{padding-right:.5rem!important;padding-left:.5rem!important}.px-3[_ngcontent-%COMP%]{padding-right:1rem!important;padding-left:1rem!important}.px-4[_ngcontent-%COMP%]{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-5[_ngcontent-%COMP%]{padding-right:3rem!important;padding-left:3rem!important}.py-0[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.py-1[_ngcontent-%COMP%]{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-2[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-3[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important}.py-4[_ngcontent-%COMP%]{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.pt-0[_ngcontent-%COMP%]{padding-top:0!important}.pt-1[_ngcontent-%COMP%]{padding-top:.25rem!important}.pt-2[_ngcontent-%COMP%]{padding-top:.5rem!important}.pt-3[_ngcontent-%COMP%]{padding-top:1rem!important}.pt-4[_ngcontent-%COMP%]{padding-top:1.5rem!important}.pt-5[_ngcontent-%COMP%]{padding-top:3rem!important}.pe-0[_ngcontent-%COMP%]{padding-right:0!important}.pe-1[_ngcontent-%COMP%]{padding-right:.25rem!important}.pe-2[_ngcontent-%COMP%]{padding-right:.5rem!important}.pe-3[_ngcontent-%COMP%]{padding-right:1rem!important}.pe-4[_ngcontent-%COMP%]{padding-right:1.5rem!important}.pe-5[_ngcontent-%COMP%]{padding-right:3rem!important}.pb-0[_ngcontent-%COMP%]{padding-bottom:0!important}.pb-1[_ngcontent-%COMP%]{padding-bottom:.25rem!important}.pb-2[_ngcontent-%COMP%]{padding-bottom:.5rem!important}.pb-3[_ngcontent-%COMP%]{padding-bottom:1rem!important}.pb-4[_ngcontent-%COMP%]{padding-bottom:1.5rem!important}.pb-5[_ngcontent-%COMP%]{padding-bottom:3rem!important}.ps-0[_ngcontent-%COMP%]{padding-left:0!important}.ps-1[_ngcontent-%COMP%]{padding-left:.25rem!important}.ps-2[_ngcontent-%COMP%]{padding-left:.5rem!important}.ps-3[_ngcontent-%COMP%]{padding-left:1rem!important}.ps-4[_ngcontent-%COMP%]{padding-left:1.5rem!important}.ps-5[_ngcontent-%COMP%]{padding-left:3rem!important}.gap-0[_ngcontent-%COMP%]{gap:0!important}.gap-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-3[_ngcontent-%COMP%]{gap:1rem!important}.gap-4[_ngcontent-%COMP%]{gap:1.5rem!important}.gap-5[_ngcontent-%COMP%]{gap:3rem!important}.row-gap-0[_ngcontent-%COMP%]{row-gap:0!important}.row-gap-1[_ngcontent-%COMP%]{row-gap:.25rem!important}.row-gap-2[_ngcontent-%COMP%]{row-gap:.5rem!important}.row-gap-3[_ngcontent-%COMP%]{row-gap:1rem!important}.row-gap-4[_ngcontent-%COMP%]{row-gap:1.5rem!important}.row-gap-5[_ngcontent-%COMP%]{row-gap:3rem!important}.column-gap-0[_ngcontent-%COMP%]{column-gap:0!important}.column-gap-1[_ngcontent-%COMP%]{column-gap:.25rem!important}.column-gap-2[_ngcontent-%COMP%]{column-gap:.5rem!important}.column-gap-3[_ngcontent-%COMP%]{column-gap:1rem!important}.column-gap-4[_ngcontent-%COMP%]{column-gap:1.5rem!important}.column-gap-5[_ngcontent-%COMP%]{column-gap:3rem!important}.font-monospace[_ngcontent-%COMP%]{font-family:var(--bs-font-monospace)!important}.fs-1[_ngcontent-%COMP%]{font-size:calc(1.375rem + 1.5vw)!important}.fs-2[_ngcontent-%COMP%]{font-size:calc(1.325rem + .9vw)!important}.fs-3[_ngcontent-%COMP%]{font-size:calc(1.3rem + .6vw)!important}.fs-4[_ngcontent-%COMP%]{font-size:calc(1.275rem + .3vw)!important}.fs-5[_ngcontent-%COMP%]{font-size:1.25rem!important}.fs-6[_ngcontent-%COMP%]{font-size:1rem!important}.fst-italic[_ngcontent-%COMP%]{font-style:italic!important}.fst-normal[_ngcontent-%COMP%]{font-style:normal!important}.fw-lighter[_ngcontent-%COMP%]{font-weight:lighter!important}.fw-light[_ngcontent-%COMP%]{font-weight:300!important}.fw-normal[_ngcontent-%COMP%]{font-weight:400!important}.fw-medium[_ngcontent-%COMP%]{font-weight:500!important}.fw-semibold[_ngcontent-%COMP%]{font-weight:600!important}.fw-bold[_ngcontent-%COMP%]{font-weight:700!important}.fw-bolder[_ngcontent-%COMP%]{font-weight:bolder!important}.lh-1[_ngcontent-%COMP%]{line-height:1!important}.lh-sm[_ngcontent-%COMP%]{line-height:1.25!important}.lh-base[_ngcontent-%COMP%]{line-height:1.5!important}.lh-lg[_ngcontent-%COMP%]{line-height:2!important}.text-start[_ngcontent-%COMP%]{text-align:left!important}.text-end[_ngcontent-%COMP%]{text-align:right!important}.text-center[_ngcontent-%COMP%]{text-align:center!important}.text-decoration-none[_ngcontent-%COMP%]{text-decoration:none!important}.text-decoration-underline[_ngcontent-%COMP%]{text-decoration:underline!important}.text-decoration-line-through[_ngcontent-%COMP%]{text-decoration:line-through!important}.text-lowercase[_ngcontent-%COMP%]{text-transform:lowercase!important}.text-uppercase[_ngcontent-%COMP%]{text-transform:uppercase!important}.text-capitalize[_ngcontent-%COMP%]{text-transform:capitalize!important}.text-wrap[_ngcontent-%COMP%]{white-space:normal!important}.text-nowrap[_ngcontent-%COMP%]{white-space:nowrap!important}.text-break[_ngcontent-%COMP%]{word-wrap:break-word!important;word-break:break-word!important}.text-primary[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-primary-rgb),var(--bs-text-opacity))!important}.text-secondary[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-secondary-rgb),var(--bs-text-opacity))!important}.text-success[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-success-rgb),var(--bs-text-opacity))!important}.text-info[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-info-rgb),var(--bs-text-opacity))!important}.text-warning[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-warning-rgb),var(--bs-text-opacity))!important}.text-danger[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-danger-rgb),var(--bs-text-opacity))!important}.text-light[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-light-rgb),var(--bs-text-opacity))!important}.text-dark[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-dark-rgb),var(--bs-text-opacity))!important}.text-black[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-black-rgb),var(--bs-text-opacity))!important}.text-white[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-white-rgb),var(--bs-text-opacity))!important}.text-body[_ngcontent-%COMP%]{--bs-text-opacity:1;color:rgba(var(--bs-body-color-rgb),var(--bs-text-opacity))!important}.text-muted[_ngcontent-%COMP%]{--bs-text-opacity:1;color:var(--bs-secondary-color)!important}.text-black-50[_ngcontent-%COMP%]{--bs-text-opacity:1;color:#00000080!important}.text-white-50[_ngcontent-%COMP%]{--bs-text-opacity:1;color:#ffffff80!important}.text-body-secondary[_ngcontent-%COMP%]{--bs-text-opacity:1;color:var(--bs-secondary-color)!important}.text-body-tertiary[_ngcontent-%COMP%]{--bs-text-opacity:1;color:var(--bs-tertiary-color)!important}.text-body-emphasis[_ngcontent-%COMP%]{--bs-text-opacity:1;color:var(--bs-emphasis-color)!important}.text-reset[_ngcontent-%COMP%]{--bs-text-opacity:1;color:inherit!important}.text-opacity-25[_ngcontent-%COMP%]{--bs-text-opacity:.25}.text-opacity-50[_ngcontent-%COMP%]{--bs-text-opacity:.5}.text-opacity-75[_ngcontent-%COMP%]{--bs-text-opacity:.75}.text-opacity-100[_ngcontent-%COMP%]{--bs-text-opacity:1}.text-primary-emphasis[_ngcontent-%COMP%]{color:var(--bs-primary-text-emphasis)!important}.text-secondary-emphasis[_ngcontent-%COMP%]{color:var(--bs-secondary-text-emphasis)!important}.text-success-emphasis[_ngcontent-%COMP%]{color:var(--bs-success-text-emphasis)!important}.text-info-emphasis[_ngcontent-%COMP%]{color:var(--bs-info-text-emphasis)!important}.text-warning-emphasis[_ngcontent-%COMP%]{color:var(--bs-warning-text-emphasis)!important}.text-danger-emphasis[_ngcontent-%COMP%]{color:var(--bs-danger-text-emphasis)!important}.text-light-emphasis[_ngcontent-%COMP%]{color:var(--bs-light-text-emphasis)!important}.text-dark-emphasis[_ngcontent-%COMP%]{color:var(--bs-dark-text-emphasis)!important}.link-opacity-10[_ngcontent-%COMP%], .link-opacity-10-hover[_ngcontent-%COMP%]:hover{--bs-link-opacity:.1}.link-opacity-25[_ngcontent-%COMP%], .link-opacity-25-hover[_ngcontent-%COMP%]:hover{--bs-link-opacity:.25}.link-opacity-50[_ngcontent-%COMP%], .link-opacity-50-hover[_ngcontent-%COMP%]:hover{--bs-link-opacity:.5}.link-opacity-75[_ngcontent-%COMP%], .link-opacity-75-hover[_ngcontent-%COMP%]:hover{--bs-link-opacity:.75}.link-opacity-100[_ngcontent-%COMP%], .link-opacity-100-hover[_ngcontent-%COMP%]:hover{--bs-link-opacity:1}.link-offset-1[_ngcontent-%COMP%], .link-offset-1-hover[_ngcontent-%COMP%]:hover{text-underline-offset:.125em!important}.link-offset-2[_ngcontent-%COMP%], .link-offset-2-hover[_ngcontent-%COMP%]:hover{text-underline-offset:.25em!important}.link-offset-3[_ngcontent-%COMP%], .link-offset-3-hover[_ngcontent-%COMP%]:hover{text-underline-offset:.375em!important}.link-underline-primary[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-primary-rgb),var(--bs-link-underline-opacity))!important}.link-underline-secondary[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-secondary-rgb),var(--bs-link-underline-opacity))!important}.link-underline-success[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-success-rgb),var(--bs-link-underline-opacity))!important}.link-underline-info[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-info-rgb),var(--bs-link-underline-opacity))!important}.link-underline-warning[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-warning-rgb),var(--bs-link-underline-opacity))!important}.link-underline-danger[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-danger-rgb),var(--bs-link-underline-opacity))!important}.link-underline-light[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-light-rgb),var(--bs-link-underline-opacity))!important}.link-underline-dark[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-dark-rgb),var(--bs-link-underline-opacity))!important}.link-underline[_ngcontent-%COMP%]{--bs-link-underline-opacity:1;text-decoration-color:rgba(var(--bs-link-color-rgb),var(--bs-link-underline-opacity,1))!important}.link-underline-opacity-0[_ngcontent-%COMP%], .link-underline-opacity-0-hover[_ngcontent-%COMP%]:hover{--bs-link-underline-opacity:0}.link-underline-opacity-10[_ngcontent-%COMP%], .link-underline-opacity-10-hover[_ngcontent-%COMP%]:hover{--bs-link-underline-opacity:.1}.link-underline-opacity-25[_ngcontent-%COMP%], .link-underline-opacity-25-hover[_ngcontent-%COMP%]:hover{--bs-link-underline-opacity:.25}.link-underline-opacity-50[_ngcontent-%COMP%], .link-underline-opacity-50-hover[_ngcontent-%COMP%]:hover{--bs-link-underline-opacity:.5}.link-underline-opacity-75[_ngcontent-%COMP%], .link-underline-opacity-75-hover[_ngcontent-%COMP%]:hover{--bs-link-underline-opacity:.75}.link-underline-opacity-100[_ngcontent-%COMP%], .link-underline-opacity-100-hover[_ngcontent-%COMP%]:hover{--bs-link-underline-opacity:1}.bg-primary[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-primary-rgb),var(--bs-bg-opacity))!important}.bg-secondary[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-secondary-rgb),var(--bs-bg-opacity))!important}.bg-success[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-success-rgb),var(--bs-bg-opacity))!important}.bg-info[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-info-rgb),var(--bs-bg-opacity))!important}.bg-warning[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-warning-rgb),var(--bs-bg-opacity))!important}.bg-danger[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-danger-rgb),var(--bs-bg-opacity))!important}.bg-light[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-light-rgb),var(--bs-bg-opacity))!important}.bg-dark[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-dark-rgb),var(--bs-bg-opacity))!important}.bg-black[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-black-rgb),var(--bs-bg-opacity))!important}.bg-white[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-white-rgb),var(--bs-bg-opacity))!important}.bg-body[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-body-bg-rgb),var(--bs-bg-opacity))!important}.bg-transparent[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:transparent!important}.bg-body-secondary[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-secondary-bg-rgb),var(--bs-bg-opacity))!important}.bg-body-tertiary[_ngcontent-%COMP%]{--bs-bg-opacity:1;background-color:rgba(var(--bs-tertiary-bg-rgb),var(--bs-bg-opacity))!important}.bg-opacity-10[_ngcontent-%COMP%]{--bs-bg-opacity:.1}.bg-opacity-25[_ngcontent-%COMP%]{--bs-bg-opacity:.25}.bg-opacity-50[_ngcontent-%COMP%]{--bs-bg-opacity:.5}.bg-opacity-75[_ngcontent-%COMP%]{--bs-bg-opacity:.75}.bg-opacity-100[_ngcontent-%COMP%]{--bs-bg-opacity:1}.bg-primary-subtle[_ngcontent-%COMP%]{background-color:var(--bs-primary-bg-subtle)!important}.bg-secondary-subtle[_ngcontent-%COMP%]{background-color:var(--bs-secondary-bg-subtle)!important}.bg-success-subtle[_ngcontent-%COMP%]{background-color:var(--bs-success-bg-subtle)!important}.bg-info-subtle[_ngcontent-%COMP%]{background-color:var(--bs-info-bg-subtle)!important}.bg-warning-subtle[_ngcontent-%COMP%]{background-color:var(--bs-warning-bg-subtle)!important}.bg-danger-subtle[_ngcontent-%COMP%]{background-color:var(--bs-danger-bg-subtle)!important}.bg-light-subtle[_ngcontent-%COMP%]{background-color:var(--bs-light-bg-subtle)!important}.bg-dark-subtle[_ngcontent-%COMP%]{background-color:var(--bs-dark-bg-subtle)!important}.bg-gradient[_ngcontent-%COMP%]{background-image:var(--bs-gradient)!important}.user-select-all[_ngcontent-%COMP%]{-webkit-user-select:all!important;user-select:all!important}.user-select-auto[_ngcontent-%COMP%]{-webkit-user-select:auto!important;user-select:auto!important}.user-select-none[_ngcontent-%COMP%]{-webkit-user-select:none!important;user-select:none!important}.pe-none[_ngcontent-%COMP%]{pointer-events:none!important}.pe-auto[_ngcontent-%COMP%]{pointer-events:auto!important}.rounded[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius)!important}.rounded-0[_ngcontent-%COMP%]{border-radius:0!important}.rounded-1[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius-sm)!important}.rounded-2[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius)!important}.rounded-3[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius-lg)!important}.rounded-4[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius-xl)!important}.rounded-5[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius-xxl)!important}.rounded-circle[_ngcontent-%COMP%]{border-radius:50%!important}.rounded-pill[_ngcontent-%COMP%]{border-radius:var(--bs-border-radius-pill)!important}.rounded-top[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius)!important;border-top-right-radius:var(--bs-border-radius)!important}.rounded-top-0[_ngcontent-%COMP%]{border-top-left-radius:0!important;border-top-right-radius:0!important}.rounded-top-1[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius-sm)!important;border-top-right-radius:var(--bs-border-radius-sm)!important}.rounded-top-2[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius)!important;border-top-right-radius:var(--bs-border-radius)!important}.rounded-top-3[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius-lg)!important;border-top-right-radius:var(--bs-border-radius-lg)!important}.rounded-top-4[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius-xl)!important;border-top-right-radius:var(--bs-border-radius-xl)!important}.rounded-top-5[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius-xxl)!important;border-top-right-radius:var(--bs-border-radius-xxl)!important}.rounded-top-circle[_ngcontent-%COMP%]{border-top-left-radius:50%!important;border-top-right-radius:50%!important}.rounded-top-pill[_ngcontent-%COMP%]{border-top-left-radius:var(--bs-border-radius-pill)!important;border-top-right-radius:var(--bs-border-radius-pill)!important}.rounded-end[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius)!important;border-bottom-right-radius:var(--bs-border-radius)!important}.rounded-end-0[_ngcontent-%COMP%]{border-top-right-radius:0!important;border-bottom-right-radius:0!important}.rounded-end-1[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius-sm)!important;border-bottom-right-radius:var(--bs-border-radius-sm)!important}.rounded-end-2[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius)!important;border-bottom-right-radius:var(--bs-border-radius)!important}.rounded-end-3[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius-lg)!important;border-bottom-right-radius:var(--bs-border-radius-lg)!important}.rounded-end-4[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius-xl)!important;border-bottom-right-radius:var(--bs-border-radius-xl)!important}.rounded-end-5[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius-xxl)!important;border-bottom-right-radius:var(--bs-border-radius-xxl)!important}.rounded-end-circle[_ngcontent-%COMP%]{border-top-right-radius:50%!important;border-bottom-right-radius:50%!important}.rounded-end-pill[_ngcontent-%COMP%]{border-top-right-radius:var(--bs-border-radius-pill)!important;border-bottom-right-radius:var(--bs-border-radius-pill)!important}.rounded-bottom[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius)!important;border-bottom-left-radius:var(--bs-border-radius)!important}.rounded-bottom-0[_ngcontent-%COMP%]{border-bottom-right-radius:0!important;border-bottom-left-radius:0!important}.rounded-bottom-1[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius-sm)!important;border-bottom-left-radius:var(--bs-border-radius-sm)!important}.rounded-bottom-2[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius)!important;border-bottom-left-radius:var(--bs-border-radius)!important}.rounded-bottom-3[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius-lg)!important;border-bottom-left-radius:var(--bs-border-radius-lg)!important}.rounded-bottom-4[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius-xl)!important;border-bottom-left-radius:var(--bs-border-radius-xl)!important}.rounded-bottom-5[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius-xxl)!important;border-bottom-left-radius:var(--bs-border-radius-xxl)!important}.rounded-bottom-circle[_ngcontent-%COMP%]{border-bottom-right-radius:50%!important;border-bottom-left-radius:50%!important}.rounded-bottom-pill[_ngcontent-%COMP%]{border-bottom-right-radius:var(--bs-border-radius-pill)!important;border-bottom-left-radius:var(--bs-border-radius-pill)!important}.rounded-start[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius)!important;border-top-left-radius:var(--bs-border-radius)!important}.rounded-start-0[_ngcontent-%COMP%]{border-bottom-left-radius:0!important;border-top-left-radius:0!important}.rounded-start-1[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius-sm)!important;border-top-left-radius:var(--bs-border-radius-sm)!important}.rounded-start-2[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius)!important;border-top-left-radius:var(--bs-border-radius)!important}.rounded-start-3[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius-lg)!important;border-top-left-radius:var(--bs-border-radius-lg)!important}.rounded-start-4[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius-xl)!important;border-top-left-radius:var(--bs-border-radius-xl)!important}.rounded-start-5[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius-xxl)!important;border-top-left-radius:var(--bs-border-radius-xxl)!important}.rounded-start-circle[_ngcontent-%COMP%]{border-bottom-left-radius:50%!important;border-top-left-radius:50%!important}.rounded-start-pill[_ngcontent-%COMP%]{border-bottom-left-radius:var(--bs-border-radius-pill)!important;border-top-left-radius:var(--bs-border-radius-pill)!important}.visible[_ngcontent-%COMP%]{visibility:visible!important}.invisible[_ngcontent-%COMP%]{visibility:hidden!important}.z-n1[_ngcontent-%COMP%]{z-index:-1!important}.z-0[_ngcontent-%COMP%]{z-index:0!important}.z-1[_ngcontent-%COMP%]{z-index:1!important}.z-2[_ngcontent-%COMP%]{z-index:2!important}.z-3[_ngcontent-%COMP%]{z-index:3!important}@media (min-width:576px){.float-sm-start[_ngcontent-%COMP%]{float:left!important}.float-sm-end[_ngcontent-%COMP%]{float:right!important}.float-sm-none[_ngcontent-%COMP%]{float:none!important}.object-fit-sm-contain[_ngcontent-%COMP%]{object-fit:contain!important}.object-fit-sm-cover[_ngcontent-%COMP%]{object-fit:cover!important}.object-fit-sm-fill[_ngcontent-%COMP%]{object-fit:fill!important}.object-fit-sm-scale[_ngcontent-%COMP%]{object-fit:scale-down!important}.object-fit-sm-none[_ngcontent-%COMP%]{object-fit:none!important}.d-sm-inline[_ngcontent-%COMP%]{display:inline!important}.d-sm-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-sm-block[_ngcontent-%COMP%]{display:block!important}.d-sm-grid[_ngcontent-%COMP%]{display:grid!important}.d-sm-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-sm-table[_ngcontent-%COMP%]{display:table!important}.d-sm-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-sm-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-sm-flex[_ngcontent-%COMP%]{display:flex!important}.d-sm-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-sm-none[_ngcontent-%COMP%]{display:none!important}.flex-sm-fill[_ngcontent-%COMP%]{flex:1 1 auto!important}.flex-sm-row[_ngcontent-%COMP%]{flex-direction:row!important}.flex-sm-column[_ngcontent-%COMP%]{flex-direction:column!important}.flex-sm-row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse!important}.flex-sm-column-reverse[_ngcontent-%COMP%]{flex-direction:column-reverse!important}.flex-sm-grow-0[_ngcontent-%COMP%]{flex-grow:0!important}.flex-sm-grow-1[_ngcontent-%COMP%]{flex-grow:1!important}.flex-sm-shrink-0[_ngcontent-%COMP%]{flex-shrink:0!important}.flex-sm-shrink-1[_ngcontent-%COMP%]{flex-shrink:1!important}.flex-sm-wrap[_ngcontent-%COMP%]{flex-wrap:wrap!important}.flex-sm-nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap!important}.flex-sm-wrap-reverse[_ngcontent-%COMP%]{flex-wrap:wrap-reverse!important}.justify-content-sm-start[_ngcontent-%COMP%]{justify-content:flex-start!important}.justify-content-sm-end[_ngcontent-%COMP%]{justify-content:flex-end!important}.justify-content-sm-center[_ngcontent-%COMP%]{justify-content:center!important}.justify-content-sm-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-sm-around[_ngcontent-%COMP%]{justify-content:space-around!important}.justify-content-sm-evenly[_ngcontent-%COMP%]{justify-content:space-evenly!important}.align-items-sm-start[_ngcontent-%COMP%]{align-items:flex-start!important}.align-items-sm-end[_ngcontent-%COMP%]{align-items:flex-end!important}.align-items-sm-center[_ngcontent-%COMP%]{align-items:center!important}.align-items-sm-baseline[_ngcontent-%COMP%]{align-items:baseline!important}.align-items-sm-stretch[_ngcontent-%COMP%]{align-items:stretch!important}.align-content-sm-start[_ngcontent-%COMP%]{align-content:flex-start!important}.align-content-sm-end[_ngcontent-%COMP%]{align-content:flex-end!important}.align-content-sm-center[_ngcontent-%COMP%]{align-content:center!important}.align-content-sm-between[_ngcontent-%COMP%]{align-content:space-between!important}.align-content-sm-around[_ngcontent-%COMP%]{align-content:space-around!important}.align-content-sm-stretch[_ngcontent-%COMP%]{align-content:stretch!important}.align-self-sm-auto[_ngcontent-%COMP%]{align-self:auto!important}.align-self-sm-start[_ngcontent-%COMP%]{align-self:flex-start!important}.align-self-sm-end[_ngcontent-%COMP%]{align-self:flex-end!important}.align-self-sm-center[_ngcontent-%COMP%]{align-self:center!important}.align-self-sm-baseline[_ngcontent-%COMP%]{align-self:baseline!important}.align-self-sm-stretch[_ngcontent-%COMP%]{align-self:stretch!important}.order-sm-first[_ngcontent-%COMP%]{order:-1!important}.order-sm-0[_ngcontent-%COMP%]{order:0!important}.order-sm-1[_ngcontent-%COMP%]{order:1!important}.order-sm-2[_ngcontent-%COMP%]{order:2!important}.order-sm-3[_ngcontent-%COMP%]{order:3!important}.order-sm-4[_ngcontent-%COMP%]{order:4!important}.order-sm-5[_ngcontent-%COMP%]{order:5!important}.order-sm-last[_ngcontent-%COMP%]{order:6!important}.m-sm-0[_ngcontent-%COMP%]{margin:0!important}.m-sm-1[_ngcontent-%COMP%]{margin:.25rem!important}.m-sm-2[_ngcontent-%COMP%]{margin:.5rem!important}.m-sm-3[_ngcontent-%COMP%]{margin:1rem!important}.m-sm-4[_ngcontent-%COMP%]{margin:1.5rem!important}.m-sm-5[_ngcontent-%COMP%]{margin:3rem!important}.m-sm-auto[_ngcontent-%COMP%]{margin:auto!important}.mx-sm-0[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}.mx-sm-1[_ngcontent-%COMP%]{margin-right:.25rem!important;margin-left:.25rem!important}.mx-sm-2[_ngcontent-%COMP%]{margin-right:.5rem!important;margin-left:.5rem!important}.mx-sm-3[_ngcontent-%COMP%]{margin-right:1rem!important;margin-left:1rem!important}.mx-sm-4[_ngcontent-%COMP%]{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-sm-5[_ngcontent-%COMP%]{margin-right:3rem!important;margin-left:3rem!important}.mx-sm-auto[_ngcontent-%COMP%]{margin-right:auto!important;margin-left:auto!important}.my-sm-0[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}.my-sm-1[_ngcontent-%COMP%]{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-sm-2[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-sm-3[_ngcontent-%COMP%]{margin-top:1rem!important;margin-bottom:1rem!important}.my-sm-4[_ngcontent-%COMP%]{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-sm-5[_ngcontent-%COMP%]{margin-top:3rem!important;margin-bottom:3rem!important}.my-sm-auto[_ngcontent-%COMP%]{margin-top:auto!important;margin-bottom:auto!important}.mt-sm-0[_ngcontent-%COMP%]{margin-top:0!important}.mt-sm-1[_ngcontent-%COMP%]{margin-top:.25rem!important}.mt-sm-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-sm-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-sm-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}.mt-sm-5[_ngcontent-%COMP%]{margin-top:3rem!important}.mt-sm-auto[_ngcontent-%COMP%]{margin-top:auto!important}.me-sm-0[_ngcontent-%COMP%]{margin-right:0!important}.me-sm-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-sm-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-sm-3[_ngcontent-%COMP%]{margin-right:1rem!important}.me-sm-4[_ngcontent-%COMP%]{margin-right:1.5rem!important}.me-sm-5[_ngcontent-%COMP%]{margin-right:3rem!important}.me-sm-auto[_ngcontent-%COMP%]{margin-right:auto!important}.mb-sm-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-sm-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-sm-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-sm-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-sm-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-sm-5[_ngcontent-%COMP%]{margin-bottom:3rem!important}.mb-sm-auto[_ngcontent-%COMP%]{margin-bottom:auto!important}.ms-sm-0[_ngcontent-%COMP%]{margin-left:0!important}.ms-sm-1[_ngcontent-%COMP%]{margin-left:.25rem!important}.ms-sm-2[_ngcontent-%COMP%]{margin-left:.5rem!important}.ms-sm-3[_ngcontent-%COMP%]{margin-left:1rem!important}.ms-sm-4[_ngcontent-%COMP%]{margin-left:1.5rem!important}.ms-sm-5[_ngcontent-%COMP%]{margin-left:3rem!important}.ms-sm-auto[_ngcontent-%COMP%]{margin-left:auto!important}.p-sm-0[_ngcontent-%COMP%]{padding:0!important}.p-sm-1[_ngcontent-%COMP%]{padding:.25rem!important}.p-sm-2[_ngcontent-%COMP%]{padding:.5rem!important}.p-sm-3[_ngcontent-%COMP%]{padding:1rem!important}.p-sm-4[_ngcontent-%COMP%]{padding:1.5rem!important}.p-sm-5[_ngcontent-%COMP%]{padding:3rem!important}.px-sm-0[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.px-sm-1[_ngcontent-%COMP%]{padding-right:.25rem!important;padding-left:.25rem!important}.px-sm-2[_ngcontent-%COMP%]{padding-right:.5rem!important;padding-left:.5rem!important}.px-sm-3[_ngcontent-%COMP%]{padding-right:1rem!important;padding-left:1rem!important}.px-sm-4[_ngcontent-%COMP%]{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-sm-5[_ngcontent-%COMP%]{padding-right:3rem!important;padding-left:3rem!important}.py-sm-0[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.py-sm-1[_ngcontent-%COMP%]{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-sm-2[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-sm-3[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important}.py-sm-4[_ngcontent-%COMP%]{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-sm-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.pt-sm-0[_ngcontent-%COMP%]{padding-top:0!important}.pt-sm-1[_ngcontent-%COMP%]{padding-top:.25rem!important}.pt-sm-2[_ngcontent-%COMP%]{padding-top:.5rem!important}.pt-sm-3[_ngcontent-%COMP%]{padding-top:1rem!important}.pt-sm-4[_ngcontent-%COMP%]{padding-top:1.5rem!important}.pt-sm-5[_ngcontent-%COMP%]{padding-top:3rem!important}.pe-sm-0[_ngcontent-%COMP%]{padding-right:0!important}.pe-sm-1[_ngcontent-%COMP%]{padding-right:.25rem!important}.pe-sm-2[_ngcontent-%COMP%]{padding-right:.5rem!important}.pe-sm-3[_ngcontent-%COMP%]{padding-right:1rem!important}.pe-sm-4[_ngcontent-%COMP%]{padding-right:1.5rem!important}.pe-sm-5[_ngcontent-%COMP%]{padding-right:3rem!important}.pb-sm-0[_ngcontent-%COMP%]{padding-bottom:0!important}.pb-sm-1[_ngcontent-%COMP%]{padding-bottom:.25rem!important}.pb-sm-2[_ngcontent-%COMP%]{padding-bottom:.5rem!important}.pb-sm-3[_ngcontent-%COMP%]{padding-bottom:1rem!important}.pb-sm-4[_ngcontent-%COMP%]{padding-bottom:1.5rem!important}.pb-sm-5[_ngcontent-%COMP%]{padding-bottom:3rem!important}.ps-sm-0[_ngcontent-%COMP%]{padding-left:0!important}.ps-sm-1[_ngcontent-%COMP%]{padding-left:.25rem!important}.ps-sm-2[_ngcontent-%COMP%]{padding-left:.5rem!important}.ps-sm-3[_ngcontent-%COMP%]{padding-left:1rem!important}.ps-sm-4[_ngcontent-%COMP%]{padding-left:1.5rem!important}.ps-sm-5[_ngcontent-%COMP%]{padding-left:3rem!important}.gap-sm-0[_ngcontent-%COMP%]{gap:0!important}.gap-sm-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-sm-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-sm-3[_ngcontent-%COMP%]{gap:1rem!important}.gap-sm-4[_ngcontent-%COMP%]{gap:1.5rem!important}.gap-sm-5[_ngcontent-%COMP%]{gap:3rem!important}.row-gap-sm-0[_ngcontent-%COMP%]{row-gap:0!important}.row-gap-sm-1[_ngcontent-%COMP%]{row-gap:.25rem!important}.row-gap-sm-2[_ngcontent-%COMP%]{row-gap:.5rem!important}.row-gap-sm-3[_ngcontent-%COMP%]{row-gap:1rem!important}.row-gap-sm-4[_ngcontent-%COMP%]{row-gap:1.5rem!important}.row-gap-sm-5[_ngcontent-%COMP%]{row-gap:3rem!important}.column-gap-sm-0[_ngcontent-%COMP%]{column-gap:0!important}.column-gap-sm-1[_ngcontent-%COMP%]{column-gap:.25rem!important}.column-gap-sm-2[_ngcontent-%COMP%]{column-gap:.5rem!important}.column-gap-sm-3[_ngcontent-%COMP%]{column-gap:1rem!important}.column-gap-sm-4[_ngcontent-%COMP%]{column-gap:1.5rem!important}.column-gap-sm-5[_ngcontent-%COMP%]{column-gap:3rem!important}.text-sm-start[_ngcontent-%COMP%]{text-align:left!important}.text-sm-end[_ngcontent-%COMP%]{text-align:right!important}.text-sm-center[_ngcontent-%COMP%]{text-align:center!important}}@media (min-width:768px){.float-md-start[_ngcontent-%COMP%]{float:left!important}.float-md-end[_ngcontent-%COMP%]{float:right!important}.float-md-none[_ngcontent-%COMP%]{float:none!important}.object-fit-md-contain[_ngcontent-%COMP%]{object-fit:contain!important}.object-fit-md-cover[_ngcontent-%COMP%]{object-fit:cover!important}.object-fit-md-fill[_ngcontent-%COMP%]{object-fit:fill!important}.object-fit-md-scale[_ngcontent-%COMP%]{object-fit:scale-down!important}.object-fit-md-none[_ngcontent-%COMP%]{object-fit:none!important}.d-md-inline[_ngcontent-%COMP%]{display:inline!important}.d-md-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-md-block[_ngcontent-%COMP%]{display:block!important}.d-md-grid[_ngcontent-%COMP%]{display:grid!important}.d-md-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-md-table[_ngcontent-%COMP%]{display:table!important}.d-md-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-md-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-md-flex[_ngcontent-%COMP%]{display:flex!important}.d-md-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-md-none[_ngcontent-%COMP%]{display:none!important}.flex-md-fill[_ngcontent-%COMP%]{flex:1 1 auto!important}.flex-md-row[_ngcontent-%COMP%]{flex-direction:row!important}.flex-md-column[_ngcontent-%COMP%]{flex-direction:column!important}.flex-md-row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse!important}.flex-md-column-reverse[_ngcontent-%COMP%]{flex-direction:column-reverse!important}.flex-md-grow-0[_ngcontent-%COMP%]{flex-grow:0!important}.flex-md-grow-1[_ngcontent-%COMP%]{flex-grow:1!important}.flex-md-shrink-0[_ngcontent-%COMP%]{flex-shrink:0!important}.flex-md-shrink-1[_ngcontent-%COMP%]{flex-shrink:1!important}.flex-md-wrap[_ngcontent-%COMP%]{flex-wrap:wrap!important}.flex-md-nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap!important}.flex-md-wrap-reverse[_ngcontent-%COMP%]{flex-wrap:wrap-reverse!important}.justify-content-md-start[_ngcontent-%COMP%]{justify-content:flex-start!important}.justify-content-md-end[_ngcontent-%COMP%]{justify-content:flex-end!important}.justify-content-md-center[_ngcontent-%COMP%]{justify-content:center!important}.justify-content-md-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-md-around[_ngcontent-%COMP%]{justify-content:space-around!important}.justify-content-md-evenly[_ngcontent-%COMP%]{justify-content:space-evenly!important}.align-items-md-start[_ngcontent-%COMP%]{align-items:flex-start!important}.align-items-md-end[_ngcontent-%COMP%]{align-items:flex-end!important}.align-items-md-center[_ngcontent-%COMP%]{align-items:center!important}.align-items-md-baseline[_ngcontent-%COMP%]{align-items:baseline!important}.align-items-md-stretch[_ngcontent-%COMP%]{align-items:stretch!important}.align-content-md-start[_ngcontent-%COMP%]{align-content:flex-start!important}.align-content-md-end[_ngcontent-%COMP%]{align-content:flex-end!important}.align-content-md-center[_ngcontent-%COMP%]{align-content:center!important}.align-content-md-between[_ngcontent-%COMP%]{align-content:space-between!important}.align-content-md-around[_ngcontent-%COMP%]{align-content:space-around!important}.align-content-md-stretch[_ngcontent-%COMP%]{align-content:stretch!important}.align-self-md-auto[_ngcontent-%COMP%]{align-self:auto!important}.align-self-md-start[_ngcontent-%COMP%]{align-self:flex-start!important}.align-self-md-end[_ngcontent-%COMP%]{align-self:flex-end!important}.align-self-md-center[_ngcontent-%COMP%]{align-self:center!important}.align-self-md-baseline[_ngcontent-%COMP%]{align-self:baseline!important}.align-self-md-stretch[_ngcontent-%COMP%]{align-self:stretch!important}.order-md-first[_ngcontent-%COMP%]{order:-1!important}.order-md-0[_ngcontent-%COMP%]{order:0!important}.order-md-1[_ngcontent-%COMP%]{order:1!important}.order-md-2[_ngcontent-%COMP%]{order:2!important}.order-md-3[_ngcontent-%COMP%]{order:3!important}.order-md-4[_ngcontent-%COMP%]{order:4!important}.order-md-5[_ngcontent-%COMP%]{order:5!important}.order-md-last[_ngcontent-%COMP%]{order:6!important}.m-md-0[_ngcontent-%COMP%]{margin:0!important}.m-md-1[_ngcontent-%COMP%]{margin:.25rem!important}.m-md-2[_ngcontent-%COMP%]{margin:.5rem!important}.m-md-3[_ngcontent-%COMP%]{margin:1rem!important}.m-md-4[_ngcontent-%COMP%]{margin:1.5rem!important}.m-md-5[_ngcontent-%COMP%]{margin:3rem!important}.m-md-auto[_ngcontent-%COMP%]{margin:auto!important}.mx-md-0[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}.mx-md-1[_ngcontent-%COMP%]{margin-right:.25rem!important;margin-left:.25rem!important}.mx-md-2[_ngcontent-%COMP%]{margin-right:.5rem!important;margin-left:.5rem!important}.mx-md-3[_ngcontent-%COMP%]{margin-right:1rem!important;margin-left:1rem!important}.mx-md-4[_ngcontent-%COMP%]{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-md-5[_ngcontent-%COMP%]{margin-right:3rem!important;margin-left:3rem!important}.mx-md-auto[_ngcontent-%COMP%]{margin-right:auto!important;margin-left:auto!important}.my-md-0[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}.my-md-1[_ngcontent-%COMP%]{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-md-2[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-md-3[_ngcontent-%COMP%]{margin-top:1rem!important;margin-bottom:1rem!important}.my-md-4[_ngcontent-%COMP%]{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-md-5[_ngcontent-%COMP%]{margin-top:3rem!important;margin-bottom:3rem!important}.my-md-auto[_ngcontent-%COMP%]{margin-top:auto!important;margin-bottom:auto!important}.mt-md-0[_ngcontent-%COMP%]{margin-top:0!important}.mt-md-1[_ngcontent-%COMP%]{margin-top:.25rem!important}.mt-md-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-md-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-md-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}.mt-md-5[_ngcontent-%COMP%]{margin-top:3rem!important}.mt-md-auto[_ngcontent-%COMP%]{margin-top:auto!important}.me-md-0[_ngcontent-%COMP%]{margin-right:0!important}.me-md-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-md-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-md-3[_ngcontent-%COMP%]{margin-right:1rem!important}.me-md-4[_ngcontent-%COMP%]{margin-right:1.5rem!important}.me-md-5[_ngcontent-%COMP%]{margin-right:3rem!important}.me-md-auto[_ngcontent-%COMP%]{margin-right:auto!important}.mb-md-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-md-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-md-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-md-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-md-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-md-5[_ngcontent-%COMP%]{margin-bottom:3rem!important}.mb-md-auto[_ngcontent-%COMP%]{margin-bottom:auto!important}.ms-md-0[_ngcontent-%COMP%]{margin-left:0!important}.ms-md-1[_ngcontent-%COMP%]{margin-left:.25rem!important}.ms-md-2[_ngcontent-%COMP%]{margin-left:.5rem!important}.ms-md-3[_ngcontent-%COMP%]{margin-left:1rem!important}.ms-md-4[_ngcontent-%COMP%]{margin-left:1.5rem!important}.ms-md-5[_ngcontent-%COMP%]{margin-left:3rem!important}.ms-md-auto[_ngcontent-%COMP%]{margin-left:auto!important}.p-md-0[_ngcontent-%COMP%]{padding:0!important}.p-md-1[_ngcontent-%COMP%]{padding:.25rem!important}.p-md-2[_ngcontent-%COMP%]{padding:.5rem!important}.p-md-3[_ngcontent-%COMP%]{padding:1rem!important}.p-md-4[_ngcontent-%COMP%]{padding:1.5rem!important}.p-md-5[_ngcontent-%COMP%]{padding:3rem!important}.px-md-0[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.px-md-1[_ngcontent-%COMP%]{padding-right:.25rem!important;padding-left:.25rem!important}.px-md-2[_ngcontent-%COMP%]{padding-right:.5rem!important;padding-left:.5rem!important}.px-md-3[_ngcontent-%COMP%]{padding-right:1rem!important;padding-left:1rem!important}.px-md-4[_ngcontent-%COMP%]{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-md-5[_ngcontent-%COMP%]{padding-right:3rem!important;padding-left:3rem!important}.py-md-0[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.py-md-1[_ngcontent-%COMP%]{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-md-2[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-md-3[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important}.py-md-4[_ngcontent-%COMP%]{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-md-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.pt-md-0[_ngcontent-%COMP%]{padding-top:0!important}.pt-md-1[_ngcontent-%COMP%]{padding-top:.25rem!important}.pt-md-2[_ngcontent-%COMP%]{padding-top:.5rem!important}.pt-md-3[_ngcontent-%COMP%]{padding-top:1rem!important}.pt-md-4[_ngcontent-%COMP%]{padding-top:1.5rem!important}.pt-md-5[_ngcontent-%COMP%]{padding-top:3rem!important}.pe-md-0[_ngcontent-%COMP%]{padding-right:0!important}.pe-md-1[_ngcontent-%COMP%]{padding-right:.25rem!important}.pe-md-2[_ngcontent-%COMP%]{padding-right:.5rem!important}.pe-md-3[_ngcontent-%COMP%]{padding-right:1rem!important}.pe-md-4[_ngcontent-%COMP%]{padding-right:1.5rem!important}.pe-md-5[_ngcontent-%COMP%]{padding-right:3rem!important}.pb-md-0[_ngcontent-%COMP%]{padding-bottom:0!important}.pb-md-1[_ngcontent-%COMP%]{padding-bottom:.25rem!important}.pb-md-2[_ngcontent-%COMP%]{padding-bottom:.5rem!important}.pb-md-3[_ngcontent-%COMP%]{padding-bottom:1rem!important}.pb-md-4[_ngcontent-%COMP%]{padding-bottom:1.5rem!important}.pb-md-5[_ngcontent-%COMP%]{padding-bottom:3rem!important}.ps-md-0[_ngcontent-%COMP%]{padding-left:0!important}.ps-md-1[_ngcontent-%COMP%]{padding-left:.25rem!important}.ps-md-2[_ngcontent-%COMP%]{padding-left:.5rem!important}.ps-md-3[_ngcontent-%COMP%]{padding-left:1rem!important}.ps-md-4[_ngcontent-%COMP%]{padding-left:1.5rem!important}.ps-md-5[_ngcontent-%COMP%]{padding-left:3rem!important}.gap-md-0[_ngcontent-%COMP%]{gap:0!important}.gap-md-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-md-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-md-3[_ngcontent-%COMP%]{gap:1rem!important}.gap-md-4[_ngcontent-%COMP%]{gap:1.5rem!important}.gap-md-5[_ngcontent-%COMP%]{gap:3rem!important}.row-gap-md-0[_ngcontent-%COMP%]{row-gap:0!important}.row-gap-md-1[_ngcontent-%COMP%]{row-gap:.25rem!important}.row-gap-md-2[_ngcontent-%COMP%]{row-gap:.5rem!important}.row-gap-md-3[_ngcontent-%COMP%]{row-gap:1rem!important}.row-gap-md-4[_ngcontent-%COMP%]{row-gap:1.5rem!important}.row-gap-md-5[_ngcontent-%COMP%]{row-gap:3rem!important}.column-gap-md-0[_ngcontent-%COMP%]{column-gap:0!important}.column-gap-md-1[_ngcontent-%COMP%]{column-gap:.25rem!important}.column-gap-md-2[_ngcontent-%COMP%]{column-gap:.5rem!important}.column-gap-md-3[_ngcontent-%COMP%]{column-gap:1rem!important}.column-gap-md-4[_ngcontent-%COMP%]{column-gap:1.5rem!important}.column-gap-md-5[_ngcontent-%COMP%]{column-gap:3rem!important}.text-md-start[_ngcontent-%COMP%]{text-align:left!important}.text-md-end[_ngcontent-%COMP%]{text-align:right!important}.text-md-center[_ngcontent-%COMP%]{text-align:center!important}}@media (min-width:992px){.float-lg-start[_ngcontent-%COMP%]{float:left!important}.float-lg-end[_ngcontent-%COMP%]{float:right!important}.float-lg-none[_ngcontent-%COMP%]{float:none!important}.object-fit-lg-contain[_ngcontent-%COMP%]{object-fit:contain!important}.object-fit-lg-cover[_ngcontent-%COMP%]{object-fit:cover!important}.object-fit-lg-fill[_ngcontent-%COMP%]{object-fit:fill!important}.object-fit-lg-scale[_ngcontent-%COMP%]{object-fit:scale-down!important}.object-fit-lg-none[_ngcontent-%COMP%]{object-fit:none!important}.d-lg-inline[_ngcontent-%COMP%]{display:inline!important}.d-lg-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-lg-block[_ngcontent-%COMP%]{display:block!important}.d-lg-grid[_ngcontent-%COMP%]{display:grid!important}.d-lg-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-lg-table[_ngcontent-%COMP%]{display:table!important}.d-lg-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-lg-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-lg-flex[_ngcontent-%COMP%]{display:flex!important}.d-lg-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-lg-none[_ngcontent-%COMP%]{display:none!important}.flex-lg-fill[_ngcontent-%COMP%]{flex:1 1 auto!important}.flex-lg-row[_ngcontent-%COMP%]{flex-direction:row!important}.flex-lg-column[_ngcontent-%COMP%]{flex-direction:column!important}.flex-lg-row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse!important}.flex-lg-column-reverse[_ngcontent-%COMP%]{flex-direction:column-reverse!important}.flex-lg-grow-0[_ngcontent-%COMP%]{flex-grow:0!important}.flex-lg-grow-1[_ngcontent-%COMP%]{flex-grow:1!important}.flex-lg-shrink-0[_ngcontent-%COMP%]{flex-shrink:0!important}.flex-lg-shrink-1[_ngcontent-%COMP%]{flex-shrink:1!important}.flex-lg-wrap[_ngcontent-%COMP%]{flex-wrap:wrap!important}.flex-lg-nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap!important}.flex-lg-wrap-reverse[_ngcontent-%COMP%]{flex-wrap:wrap-reverse!important}.justify-content-lg-start[_ngcontent-%COMP%]{justify-content:flex-start!important}.justify-content-lg-end[_ngcontent-%COMP%]{justify-content:flex-end!important}.justify-content-lg-center[_ngcontent-%COMP%]{justify-content:center!important}.justify-content-lg-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-lg-around[_ngcontent-%COMP%]{justify-content:space-around!important}.justify-content-lg-evenly[_ngcontent-%COMP%]{justify-content:space-evenly!important}.align-items-lg-start[_ngcontent-%COMP%]{align-items:flex-start!important}.align-items-lg-end[_ngcontent-%COMP%]{align-items:flex-end!important}.align-items-lg-center[_ngcontent-%COMP%]{align-items:center!important}.align-items-lg-baseline[_ngcontent-%COMP%]{align-items:baseline!important}.align-items-lg-stretch[_ngcontent-%COMP%]{align-items:stretch!important}.align-content-lg-start[_ngcontent-%COMP%]{align-content:flex-start!important}.align-content-lg-end[_ngcontent-%COMP%]{align-content:flex-end!important}.align-content-lg-center[_ngcontent-%COMP%]{align-content:center!important}.align-content-lg-between[_ngcontent-%COMP%]{align-content:space-between!important}.align-content-lg-around[_ngcontent-%COMP%]{align-content:space-around!important}.align-content-lg-stretch[_ngcontent-%COMP%]{align-content:stretch!important}.align-self-lg-auto[_ngcontent-%COMP%]{align-self:auto!important}.align-self-lg-start[_ngcontent-%COMP%]{align-self:flex-start!important}.align-self-lg-end[_ngcontent-%COMP%]{align-self:flex-end!important}.align-self-lg-center[_ngcontent-%COMP%]{align-self:center!important}.align-self-lg-baseline[_ngcontent-%COMP%]{align-self:baseline!important}.align-self-lg-stretch[_ngcontent-%COMP%]{align-self:stretch!important}.order-lg-first[_ngcontent-%COMP%]{order:-1!important}.order-lg-0[_ngcontent-%COMP%]{order:0!important}.order-lg-1[_ngcontent-%COMP%]{order:1!important}.order-lg-2[_ngcontent-%COMP%]{order:2!important}.order-lg-3[_ngcontent-%COMP%]{order:3!important}.order-lg-4[_ngcontent-%COMP%]{order:4!important}.order-lg-5[_ngcontent-%COMP%]{order:5!important}.order-lg-last[_ngcontent-%COMP%]{order:6!important}.m-lg-0[_ngcontent-%COMP%]{margin:0!important}.m-lg-1[_ngcontent-%COMP%]{margin:.25rem!important}.m-lg-2[_ngcontent-%COMP%]{margin:.5rem!important}.m-lg-3[_ngcontent-%COMP%]{margin:1rem!important}.m-lg-4[_ngcontent-%COMP%]{margin:1.5rem!important}.m-lg-5[_ngcontent-%COMP%]{margin:3rem!important}.m-lg-auto[_ngcontent-%COMP%]{margin:auto!important}.mx-lg-0[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}.mx-lg-1[_ngcontent-%COMP%]{margin-right:.25rem!important;margin-left:.25rem!important}.mx-lg-2[_ngcontent-%COMP%]{margin-right:.5rem!important;margin-left:.5rem!important}.mx-lg-3[_ngcontent-%COMP%]{margin-right:1rem!important;margin-left:1rem!important}.mx-lg-4[_ngcontent-%COMP%]{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-lg-5[_ngcontent-%COMP%]{margin-right:3rem!important;margin-left:3rem!important}.mx-lg-auto[_ngcontent-%COMP%]{margin-right:auto!important;margin-left:auto!important}.my-lg-0[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}.my-lg-1[_ngcontent-%COMP%]{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-lg-2[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-lg-3[_ngcontent-%COMP%]{margin-top:1rem!important;margin-bottom:1rem!important}.my-lg-4[_ngcontent-%COMP%]{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-lg-5[_ngcontent-%COMP%]{margin-top:3rem!important;margin-bottom:3rem!important}.my-lg-auto[_ngcontent-%COMP%]{margin-top:auto!important;margin-bottom:auto!important}.mt-lg-0[_ngcontent-%COMP%]{margin-top:0!important}.mt-lg-1[_ngcontent-%COMP%]{margin-top:.25rem!important}.mt-lg-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-lg-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-lg-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}.mt-lg-5[_ngcontent-%COMP%]{margin-top:3rem!important}.mt-lg-auto[_ngcontent-%COMP%]{margin-top:auto!important}.me-lg-0[_ngcontent-%COMP%]{margin-right:0!important}.me-lg-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-lg-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-lg-3[_ngcontent-%COMP%]{margin-right:1rem!important}.me-lg-4[_ngcontent-%COMP%]{margin-right:1.5rem!important}.me-lg-5[_ngcontent-%COMP%]{margin-right:3rem!important}.me-lg-auto[_ngcontent-%COMP%]{margin-right:auto!important}.mb-lg-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-lg-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-lg-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-lg-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-lg-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-lg-5[_ngcontent-%COMP%]{margin-bottom:3rem!important}.mb-lg-auto[_ngcontent-%COMP%]{margin-bottom:auto!important}.ms-lg-0[_ngcontent-%COMP%]{margin-left:0!important}.ms-lg-1[_ngcontent-%COMP%]{margin-left:.25rem!important}.ms-lg-2[_ngcontent-%COMP%]{margin-left:.5rem!important}.ms-lg-3[_ngcontent-%COMP%]{margin-left:1rem!important}.ms-lg-4[_ngcontent-%COMP%]{margin-left:1.5rem!important}.ms-lg-5[_ngcontent-%COMP%]{margin-left:3rem!important}.ms-lg-auto[_ngcontent-%COMP%]{margin-left:auto!important}.p-lg-0[_ngcontent-%COMP%]{padding:0!important}.p-lg-1[_ngcontent-%COMP%]{padding:.25rem!important}.p-lg-2[_ngcontent-%COMP%]{padding:.5rem!important}.p-lg-3[_ngcontent-%COMP%]{padding:1rem!important}.p-lg-4[_ngcontent-%COMP%]{padding:1.5rem!important}.p-lg-5[_ngcontent-%COMP%]{padding:3rem!important}.px-lg-0[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.px-lg-1[_ngcontent-%COMP%]{padding-right:.25rem!important;padding-left:.25rem!important}.px-lg-2[_ngcontent-%COMP%]{padding-right:.5rem!important;padding-left:.5rem!important}.px-lg-3[_ngcontent-%COMP%]{padding-right:1rem!important;padding-left:1rem!important}.px-lg-4[_ngcontent-%COMP%]{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-lg-5[_ngcontent-%COMP%]{padding-right:3rem!important;padding-left:3rem!important}.py-lg-0[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.py-lg-1[_ngcontent-%COMP%]{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-lg-2[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-lg-3[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important}.py-lg-4[_ngcontent-%COMP%]{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-lg-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.pt-lg-0[_ngcontent-%COMP%]{padding-top:0!important}.pt-lg-1[_ngcontent-%COMP%]{padding-top:.25rem!important}.pt-lg-2[_ngcontent-%COMP%]{padding-top:.5rem!important}.pt-lg-3[_ngcontent-%COMP%]{padding-top:1rem!important}.pt-lg-4[_ngcontent-%COMP%]{padding-top:1.5rem!important}.pt-lg-5[_ngcontent-%COMP%]{padding-top:3rem!important}.pe-lg-0[_ngcontent-%COMP%]{padding-right:0!important}.pe-lg-1[_ngcontent-%COMP%]{padding-right:.25rem!important}.pe-lg-2[_ngcontent-%COMP%]{padding-right:.5rem!important}.pe-lg-3[_ngcontent-%COMP%]{padding-right:1rem!important}.pe-lg-4[_ngcontent-%COMP%]{padding-right:1.5rem!important}.pe-lg-5[_ngcontent-%COMP%]{padding-right:3rem!important}.pb-lg-0[_ngcontent-%COMP%]{padding-bottom:0!important}.pb-lg-1[_ngcontent-%COMP%]{padding-bottom:.25rem!important}.pb-lg-2[_ngcontent-%COMP%]{padding-bottom:.5rem!important}.pb-lg-3[_ngcontent-%COMP%]{padding-bottom:1rem!important}.pb-lg-4[_ngcontent-%COMP%]{padding-bottom:1.5rem!important}.pb-lg-5[_ngcontent-%COMP%]{padding-bottom:3rem!important}.ps-lg-0[_ngcontent-%COMP%]{padding-left:0!important}.ps-lg-1[_ngcontent-%COMP%]{padding-left:.25rem!important}.ps-lg-2[_ngcontent-%COMP%]{padding-left:.5rem!important}.ps-lg-3[_ngcontent-%COMP%]{padding-left:1rem!important}.ps-lg-4[_ngcontent-%COMP%]{padding-left:1.5rem!important}.ps-lg-5[_ngcontent-%COMP%]{padding-left:3rem!important}.gap-lg-0[_ngcontent-%COMP%]{gap:0!important}.gap-lg-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-lg-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-lg-3[_ngcontent-%COMP%]{gap:1rem!important}.gap-lg-4[_ngcontent-%COMP%]{gap:1.5rem!important}.gap-lg-5[_ngcontent-%COMP%]{gap:3rem!important}.row-gap-lg-0[_ngcontent-%COMP%]{row-gap:0!important}.row-gap-lg-1[_ngcontent-%COMP%]{row-gap:.25rem!important}.row-gap-lg-2[_ngcontent-%COMP%]{row-gap:.5rem!important}.row-gap-lg-3[_ngcontent-%COMP%]{row-gap:1rem!important}.row-gap-lg-4[_ngcontent-%COMP%]{row-gap:1.5rem!important}.row-gap-lg-5[_ngcontent-%COMP%]{row-gap:3rem!important}.column-gap-lg-0[_ngcontent-%COMP%]{column-gap:0!important}.column-gap-lg-1[_ngcontent-%COMP%]{column-gap:.25rem!important}.column-gap-lg-2[_ngcontent-%COMP%]{column-gap:.5rem!important}.column-gap-lg-3[_ngcontent-%COMP%]{column-gap:1rem!important}.column-gap-lg-4[_ngcontent-%COMP%]{column-gap:1.5rem!important}.column-gap-lg-5[_ngcontent-%COMP%]{column-gap:3rem!important}.text-lg-start[_ngcontent-%COMP%]{text-align:left!important}.text-lg-end[_ngcontent-%COMP%]{text-align:right!important}.text-lg-center[_ngcontent-%COMP%]{text-align:center!important}}@media (min-width:1200px){.float-xl-start[_ngcontent-%COMP%]{float:left!important}.float-xl-end[_ngcontent-%COMP%]{float:right!important}.float-xl-none[_ngcontent-%COMP%]{float:none!important}.object-fit-xl-contain[_ngcontent-%COMP%]{object-fit:contain!important}.object-fit-xl-cover[_ngcontent-%COMP%]{object-fit:cover!important}.object-fit-xl-fill[_ngcontent-%COMP%]{object-fit:fill!important}.object-fit-xl-scale[_ngcontent-%COMP%]{object-fit:scale-down!important}.object-fit-xl-none[_ngcontent-%COMP%]{object-fit:none!important}.d-xl-inline[_ngcontent-%COMP%]{display:inline!important}.d-xl-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-xl-block[_ngcontent-%COMP%]{display:block!important}.d-xl-grid[_ngcontent-%COMP%]{display:grid!important}.d-xl-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-xl-table[_ngcontent-%COMP%]{display:table!important}.d-xl-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-xl-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-xl-flex[_ngcontent-%COMP%]{display:flex!important}.d-xl-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-xl-none[_ngcontent-%COMP%]{display:none!important}.flex-xl-fill[_ngcontent-%COMP%]{flex:1 1 auto!important}.flex-xl-row[_ngcontent-%COMP%]{flex-direction:row!important}.flex-xl-column[_ngcontent-%COMP%]{flex-direction:column!important}.flex-xl-row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse!important}.flex-xl-column-reverse[_ngcontent-%COMP%]{flex-direction:column-reverse!important}.flex-xl-grow-0[_ngcontent-%COMP%]{flex-grow:0!important}.flex-xl-grow-1[_ngcontent-%COMP%]{flex-grow:1!important}.flex-xl-shrink-0[_ngcontent-%COMP%]{flex-shrink:0!important}.flex-xl-shrink-1[_ngcontent-%COMP%]{flex-shrink:1!important}.flex-xl-wrap[_ngcontent-%COMP%]{flex-wrap:wrap!important}.flex-xl-nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap!important}.flex-xl-wrap-reverse[_ngcontent-%COMP%]{flex-wrap:wrap-reverse!important}.justify-content-xl-start[_ngcontent-%COMP%]{justify-content:flex-start!important}.justify-content-xl-end[_ngcontent-%COMP%]{justify-content:flex-end!important}.justify-content-xl-center[_ngcontent-%COMP%]{justify-content:center!important}.justify-content-xl-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-xl-around[_ngcontent-%COMP%]{justify-content:space-around!important}.justify-content-xl-evenly[_ngcontent-%COMP%]{justify-content:space-evenly!important}.align-items-xl-start[_ngcontent-%COMP%]{align-items:flex-start!important}.align-items-xl-end[_ngcontent-%COMP%]{align-items:flex-end!important}.align-items-xl-center[_ngcontent-%COMP%]{align-items:center!important}.align-items-xl-baseline[_ngcontent-%COMP%]{align-items:baseline!important}.align-items-xl-stretch[_ngcontent-%COMP%]{align-items:stretch!important}.align-content-xl-start[_ngcontent-%COMP%]{align-content:flex-start!important}.align-content-xl-end[_ngcontent-%COMP%]{align-content:flex-end!important}.align-content-xl-center[_ngcontent-%COMP%]{align-content:center!important}.align-content-xl-between[_ngcontent-%COMP%]{align-content:space-between!important}.align-content-xl-around[_ngcontent-%COMP%]{align-content:space-around!important}.align-content-xl-stretch[_ngcontent-%COMP%]{align-content:stretch!important}.align-self-xl-auto[_ngcontent-%COMP%]{align-self:auto!important}.align-self-xl-start[_ngcontent-%COMP%]{align-self:flex-start!important}.align-self-xl-end[_ngcontent-%COMP%]{align-self:flex-end!important}.align-self-xl-center[_ngcontent-%COMP%]{align-self:center!important}.align-self-xl-baseline[_ngcontent-%COMP%]{align-self:baseline!important}.align-self-xl-stretch[_ngcontent-%COMP%]{align-self:stretch!important}.order-xl-first[_ngcontent-%COMP%]{order:-1!important}.order-xl-0[_ngcontent-%COMP%]{order:0!important}.order-xl-1[_ngcontent-%COMP%]{order:1!important}.order-xl-2[_ngcontent-%COMP%]{order:2!important}.order-xl-3[_ngcontent-%COMP%]{order:3!important}.order-xl-4[_ngcontent-%COMP%]{order:4!important}.order-xl-5[_ngcontent-%COMP%]{order:5!important}.order-xl-last[_ngcontent-%COMP%]{order:6!important}.m-xl-0[_ngcontent-%COMP%]{margin:0!important}.m-xl-1[_ngcontent-%COMP%]{margin:.25rem!important}.m-xl-2[_ngcontent-%COMP%]{margin:.5rem!important}.m-xl-3[_ngcontent-%COMP%]{margin:1rem!important}.m-xl-4[_ngcontent-%COMP%]{margin:1.5rem!important}.m-xl-5[_ngcontent-%COMP%]{margin:3rem!important}.m-xl-auto[_ngcontent-%COMP%]{margin:auto!important}.mx-xl-0[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}.mx-xl-1[_ngcontent-%COMP%]{margin-right:.25rem!important;margin-left:.25rem!important}.mx-xl-2[_ngcontent-%COMP%]{margin-right:.5rem!important;margin-left:.5rem!important}.mx-xl-3[_ngcontent-%COMP%]{margin-right:1rem!important;margin-left:1rem!important}.mx-xl-4[_ngcontent-%COMP%]{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-xl-5[_ngcontent-%COMP%]{margin-right:3rem!important;margin-left:3rem!important}.mx-xl-auto[_ngcontent-%COMP%]{margin-right:auto!important;margin-left:auto!important}.my-xl-0[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}.my-xl-1[_ngcontent-%COMP%]{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-xl-2[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-xl-3[_ngcontent-%COMP%]{margin-top:1rem!important;margin-bottom:1rem!important}.my-xl-4[_ngcontent-%COMP%]{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-xl-5[_ngcontent-%COMP%]{margin-top:3rem!important;margin-bottom:3rem!important}.my-xl-auto[_ngcontent-%COMP%]{margin-top:auto!important;margin-bottom:auto!important}.mt-xl-0[_ngcontent-%COMP%]{margin-top:0!important}.mt-xl-1[_ngcontent-%COMP%]{margin-top:.25rem!important}.mt-xl-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-xl-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-xl-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}.mt-xl-5[_ngcontent-%COMP%]{margin-top:3rem!important}.mt-xl-auto[_ngcontent-%COMP%]{margin-top:auto!important}.me-xl-0[_ngcontent-%COMP%]{margin-right:0!important}.me-xl-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-xl-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-xl-3[_ngcontent-%COMP%]{margin-right:1rem!important}.me-xl-4[_ngcontent-%COMP%]{margin-right:1.5rem!important}.me-xl-5[_ngcontent-%COMP%]{margin-right:3rem!important}.me-xl-auto[_ngcontent-%COMP%]{margin-right:auto!important}.mb-xl-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-xl-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-xl-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-xl-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-xl-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-xl-5[_ngcontent-%COMP%]{margin-bottom:3rem!important}.mb-xl-auto[_ngcontent-%COMP%]{margin-bottom:auto!important}.ms-xl-0[_ngcontent-%COMP%]{margin-left:0!important}.ms-xl-1[_ngcontent-%COMP%]{margin-left:.25rem!important}.ms-xl-2[_ngcontent-%COMP%]{margin-left:.5rem!important}.ms-xl-3[_ngcontent-%COMP%]{margin-left:1rem!important}.ms-xl-4[_ngcontent-%COMP%]{margin-left:1.5rem!important}.ms-xl-5[_ngcontent-%COMP%]{margin-left:3rem!important}.ms-xl-auto[_ngcontent-%COMP%]{margin-left:auto!important}.p-xl-0[_ngcontent-%COMP%]{padding:0!important}.p-xl-1[_ngcontent-%COMP%]{padding:.25rem!important}.p-xl-2[_ngcontent-%COMP%]{padding:.5rem!important}.p-xl-3[_ngcontent-%COMP%]{padding:1rem!important}.p-xl-4[_ngcontent-%COMP%]{padding:1.5rem!important}.p-xl-5[_ngcontent-%COMP%]{padding:3rem!important}.px-xl-0[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.px-xl-1[_ngcontent-%COMP%]{padding-right:.25rem!important;padding-left:.25rem!important}.px-xl-2[_ngcontent-%COMP%]{padding-right:.5rem!important;padding-left:.5rem!important}.px-xl-3[_ngcontent-%COMP%]{padding-right:1rem!important;padding-left:1rem!important}.px-xl-4[_ngcontent-%COMP%]{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-xl-5[_ngcontent-%COMP%]{padding-right:3rem!important;padding-left:3rem!important}.py-xl-0[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.py-xl-1[_ngcontent-%COMP%]{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-xl-2[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-xl-3[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important}.py-xl-4[_ngcontent-%COMP%]{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-xl-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.pt-xl-0[_ngcontent-%COMP%]{padding-top:0!important}.pt-xl-1[_ngcontent-%COMP%]{padding-top:.25rem!important}.pt-xl-2[_ngcontent-%COMP%]{padding-top:.5rem!important}.pt-xl-3[_ngcontent-%COMP%]{padding-top:1rem!important}.pt-xl-4[_ngcontent-%COMP%]{padding-top:1.5rem!important}.pt-xl-5[_ngcontent-%COMP%]{padding-top:3rem!important}.pe-xl-0[_ngcontent-%COMP%]{padding-right:0!important}.pe-xl-1[_ngcontent-%COMP%]{padding-right:.25rem!important}.pe-xl-2[_ngcontent-%COMP%]{padding-right:.5rem!important}.pe-xl-3[_ngcontent-%COMP%]{padding-right:1rem!important}.pe-xl-4[_ngcontent-%COMP%]{padding-right:1.5rem!important}.pe-xl-5[_ngcontent-%COMP%]{padding-right:3rem!important}.pb-xl-0[_ngcontent-%COMP%]{padding-bottom:0!important}.pb-xl-1[_ngcontent-%COMP%]{padding-bottom:.25rem!important}.pb-xl-2[_ngcontent-%COMP%]{padding-bottom:.5rem!important}.pb-xl-3[_ngcontent-%COMP%]{padding-bottom:1rem!important}.pb-xl-4[_ngcontent-%COMP%]{padding-bottom:1.5rem!important}.pb-xl-5[_ngcontent-%COMP%]{padding-bottom:3rem!important}.ps-xl-0[_ngcontent-%COMP%]{padding-left:0!important}.ps-xl-1[_ngcontent-%COMP%]{padding-left:.25rem!important}.ps-xl-2[_ngcontent-%COMP%]{padding-left:.5rem!important}.ps-xl-3[_ngcontent-%COMP%]{padding-left:1rem!important}.ps-xl-4[_ngcontent-%COMP%]{padding-left:1.5rem!important}.ps-xl-5[_ngcontent-%COMP%]{padding-left:3rem!important}.gap-xl-0[_ngcontent-%COMP%]{gap:0!important}.gap-xl-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-xl-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-xl-3[_ngcontent-%COMP%]{gap:1rem!important}.gap-xl-4[_ngcontent-%COMP%]{gap:1.5rem!important}.gap-xl-5[_ngcontent-%COMP%]{gap:3rem!important}.row-gap-xl-0[_ngcontent-%COMP%]{row-gap:0!important}.row-gap-xl-1[_ngcontent-%COMP%]{row-gap:.25rem!important}.row-gap-xl-2[_ngcontent-%COMP%]{row-gap:.5rem!important}.row-gap-xl-3[_ngcontent-%COMP%]{row-gap:1rem!important}.row-gap-xl-4[_ngcontent-%COMP%]{row-gap:1.5rem!important}.row-gap-xl-5[_ngcontent-%COMP%]{row-gap:3rem!important}.column-gap-xl-0[_ngcontent-%COMP%]{column-gap:0!important}.column-gap-xl-1[_ngcontent-%COMP%]{column-gap:.25rem!important}.column-gap-xl-2[_ngcontent-%COMP%]{column-gap:.5rem!important}.column-gap-xl-3[_ngcontent-%COMP%]{column-gap:1rem!important}.column-gap-xl-4[_ngcontent-%COMP%]{column-gap:1.5rem!important}.column-gap-xl-5[_ngcontent-%COMP%]{column-gap:3rem!important}.text-xl-start[_ngcontent-%COMP%]{text-align:left!important}.text-xl-end[_ngcontent-%COMP%]{text-align:right!important}.text-xl-center[_ngcontent-%COMP%]{text-align:center!important}}@media (min-width:1400px){.float-xxl-start[_ngcontent-%COMP%]{float:left!important}.float-xxl-end[_ngcontent-%COMP%]{float:right!important}.float-xxl-none[_ngcontent-%COMP%]{float:none!important}.object-fit-xxl-contain[_ngcontent-%COMP%]{object-fit:contain!important}.object-fit-xxl-cover[_ngcontent-%COMP%]{object-fit:cover!important}.object-fit-xxl-fill[_ngcontent-%COMP%]{object-fit:fill!important}.object-fit-xxl-scale[_ngcontent-%COMP%]{object-fit:scale-down!important}.object-fit-xxl-none[_ngcontent-%COMP%]{object-fit:none!important}.d-xxl-inline[_ngcontent-%COMP%]{display:inline!important}.d-xxl-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-xxl-block[_ngcontent-%COMP%]{display:block!important}.d-xxl-grid[_ngcontent-%COMP%]{display:grid!important}.d-xxl-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-xxl-table[_ngcontent-%COMP%]{display:table!important}.d-xxl-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-xxl-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-xxl-flex[_ngcontent-%COMP%]{display:flex!important}.d-xxl-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-xxl-none[_ngcontent-%COMP%]{display:none!important}.flex-xxl-fill[_ngcontent-%COMP%]{flex:1 1 auto!important}.flex-xxl-row[_ngcontent-%COMP%]{flex-direction:row!important}.flex-xxl-column[_ngcontent-%COMP%]{flex-direction:column!important}.flex-xxl-row-reverse[_ngcontent-%COMP%]{flex-direction:row-reverse!important}.flex-xxl-column-reverse[_ngcontent-%COMP%]{flex-direction:column-reverse!important}.flex-xxl-grow-0[_ngcontent-%COMP%]{flex-grow:0!important}.flex-xxl-grow-1[_ngcontent-%COMP%]{flex-grow:1!important}.flex-xxl-shrink-0[_ngcontent-%COMP%]{flex-shrink:0!important}.flex-xxl-shrink-1[_ngcontent-%COMP%]{flex-shrink:1!important}.flex-xxl-wrap[_ngcontent-%COMP%]{flex-wrap:wrap!important}.flex-xxl-nowrap[_ngcontent-%COMP%]{flex-wrap:nowrap!important}.flex-xxl-wrap-reverse[_ngcontent-%COMP%]{flex-wrap:wrap-reverse!important}.justify-content-xxl-start[_ngcontent-%COMP%]{justify-content:flex-start!important}.justify-content-xxl-end[_ngcontent-%COMP%]{justify-content:flex-end!important}.justify-content-xxl-center[_ngcontent-%COMP%]{justify-content:center!important}.justify-content-xxl-between[_ngcontent-%COMP%]{justify-content:space-between!important}.justify-content-xxl-around[_ngcontent-%COMP%]{justify-content:space-around!important}.justify-content-xxl-evenly[_ngcontent-%COMP%]{justify-content:space-evenly!important}.align-items-xxl-start[_ngcontent-%COMP%]{align-items:flex-start!important}.align-items-xxl-end[_ngcontent-%COMP%]{align-items:flex-end!important}.align-items-xxl-center[_ngcontent-%COMP%]{align-items:center!important}.align-items-xxl-baseline[_ngcontent-%COMP%]{align-items:baseline!important}.align-items-xxl-stretch[_ngcontent-%COMP%]{align-items:stretch!important}.align-content-xxl-start[_ngcontent-%COMP%]{align-content:flex-start!important}.align-content-xxl-end[_ngcontent-%COMP%]{align-content:flex-end!important}.align-content-xxl-center[_ngcontent-%COMP%]{align-content:center!important}.align-content-xxl-between[_ngcontent-%COMP%]{align-content:space-between!important}.align-content-xxl-around[_ngcontent-%COMP%]{align-content:space-around!important}.align-content-xxl-stretch[_ngcontent-%COMP%]{align-content:stretch!important}.align-self-xxl-auto[_ngcontent-%COMP%]{align-self:auto!important}.align-self-xxl-start[_ngcontent-%COMP%]{align-self:flex-start!important}.align-self-xxl-end[_ngcontent-%COMP%]{align-self:flex-end!important}.align-self-xxl-center[_ngcontent-%COMP%]{align-self:center!important}.align-self-xxl-baseline[_ngcontent-%COMP%]{align-self:baseline!important}.align-self-xxl-stretch[_ngcontent-%COMP%]{align-self:stretch!important}.order-xxl-first[_ngcontent-%COMP%]{order:-1!important}.order-xxl-0[_ngcontent-%COMP%]{order:0!important}.order-xxl-1[_ngcontent-%COMP%]{order:1!important}.order-xxl-2[_ngcontent-%COMP%]{order:2!important}.order-xxl-3[_ngcontent-%COMP%]{order:3!important}.order-xxl-4[_ngcontent-%COMP%]{order:4!important}.order-xxl-5[_ngcontent-%COMP%]{order:5!important}.order-xxl-last[_ngcontent-%COMP%]{order:6!important}.m-xxl-0[_ngcontent-%COMP%]{margin:0!important}.m-xxl-1[_ngcontent-%COMP%]{margin:.25rem!important}.m-xxl-2[_ngcontent-%COMP%]{margin:.5rem!important}.m-xxl-3[_ngcontent-%COMP%]{margin:1rem!important}.m-xxl-4[_ngcontent-%COMP%]{margin:1.5rem!important}.m-xxl-5[_ngcontent-%COMP%]{margin:3rem!important}.m-xxl-auto[_ngcontent-%COMP%]{margin:auto!important}.mx-xxl-0[_ngcontent-%COMP%]{margin-right:0!important;margin-left:0!important}.mx-xxl-1[_ngcontent-%COMP%]{margin-right:.25rem!important;margin-left:.25rem!important}.mx-xxl-2[_ngcontent-%COMP%]{margin-right:.5rem!important;margin-left:.5rem!important}.mx-xxl-3[_ngcontent-%COMP%]{margin-right:1rem!important;margin-left:1rem!important}.mx-xxl-4[_ngcontent-%COMP%]{margin-right:1.5rem!important;margin-left:1.5rem!important}.mx-xxl-5[_ngcontent-%COMP%]{margin-right:3rem!important;margin-left:3rem!important}.mx-xxl-auto[_ngcontent-%COMP%]{margin-right:auto!important;margin-left:auto!important}.my-xxl-0[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important}.my-xxl-1[_ngcontent-%COMP%]{margin-top:.25rem!important;margin-bottom:.25rem!important}.my-xxl-2[_ngcontent-%COMP%]{margin-top:.5rem!important;margin-bottom:.5rem!important}.my-xxl-3[_ngcontent-%COMP%]{margin-top:1rem!important;margin-bottom:1rem!important}.my-xxl-4[_ngcontent-%COMP%]{margin-top:1.5rem!important;margin-bottom:1.5rem!important}.my-xxl-5[_ngcontent-%COMP%]{margin-top:3rem!important;margin-bottom:3rem!important}.my-xxl-auto[_ngcontent-%COMP%]{margin-top:auto!important;margin-bottom:auto!important}.mt-xxl-0[_ngcontent-%COMP%]{margin-top:0!important}.mt-xxl-1[_ngcontent-%COMP%]{margin-top:.25rem!important}.mt-xxl-2[_ngcontent-%COMP%]{margin-top:.5rem!important}.mt-xxl-3[_ngcontent-%COMP%]{margin-top:1rem!important}.mt-xxl-4[_ngcontent-%COMP%]{margin-top:1.5rem!important}.mt-xxl-5[_ngcontent-%COMP%]{margin-top:3rem!important}.mt-xxl-auto[_ngcontent-%COMP%]{margin-top:auto!important}.me-xxl-0[_ngcontent-%COMP%]{margin-right:0!important}.me-xxl-1[_ngcontent-%COMP%]{margin-right:.25rem!important}.me-xxl-2[_ngcontent-%COMP%]{margin-right:.5rem!important}.me-xxl-3[_ngcontent-%COMP%]{margin-right:1rem!important}.me-xxl-4[_ngcontent-%COMP%]{margin-right:1.5rem!important}.me-xxl-5[_ngcontent-%COMP%]{margin-right:3rem!important}.me-xxl-auto[_ngcontent-%COMP%]{margin-right:auto!important}.mb-xxl-0[_ngcontent-%COMP%]{margin-bottom:0!important}.mb-xxl-1[_ngcontent-%COMP%]{margin-bottom:.25rem!important}.mb-xxl-2[_ngcontent-%COMP%]{margin-bottom:.5rem!important}.mb-xxl-3[_ngcontent-%COMP%]{margin-bottom:1rem!important}.mb-xxl-4[_ngcontent-%COMP%]{margin-bottom:1.5rem!important}.mb-xxl-5[_ngcontent-%COMP%]{margin-bottom:3rem!important}.mb-xxl-auto[_ngcontent-%COMP%]{margin-bottom:auto!important}.ms-xxl-0[_ngcontent-%COMP%]{margin-left:0!important}.ms-xxl-1[_ngcontent-%COMP%]{margin-left:.25rem!important}.ms-xxl-2[_ngcontent-%COMP%]{margin-left:.5rem!important}.ms-xxl-3[_ngcontent-%COMP%]{margin-left:1rem!important}.ms-xxl-4[_ngcontent-%COMP%]{margin-left:1.5rem!important}.ms-xxl-5[_ngcontent-%COMP%]{margin-left:3rem!important}.ms-xxl-auto[_ngcontent-%COMP%]{margin-left:auto!important}.p-xxl-0[_ngcontent-%COMP%]{padding:0!important}.p-xxl-1[_ngcontent-%COMP%]{padding:.25rem!important}.p-xxl-2[_ngcontent-%COMP%]{padding:.5rem!important}.p-xxl-3[_ngcontent-%COMP%]{padding:1rem!important}.p-xxl-4[_ngcontent-%COMP%]{padding:1.5rem!important}.p-xxl-5[_ngcontent-%COMP%]{padding:3rem!important}.px-xxl-0[_ngcontent-%COMP%]{padding-right:0!important;padding-left:0!important}.px-xxl-1[_ngcontent-%COMP%]{padding-right:.25rem!important;padding-left:.25rem!important}.px-xxl-2[_ngcontent-%COMP%]{padding-right:.5rem!important;padding-left:.5rem!important}.px-xxl-3[_ngcontent-%COMP%]{padding-right:1rem!important;padding-left:1rem!important}.px-xxl-4[_ngcontent-%COMP%]{padding-right:1.5rem!important;padding-left:1.5rem!important}.px-xxl-5[_ngcontent-%COMP%]{padding-right:3rem!important;padding-left:3rem!important}.py-xxl-0[_ngcontent-%COMP%]{padding-top:0!important;padding-bottom:0!important}.py-xxl-1[_ngcontent-%COMP%]{padding-top:.25rem!important;padding-bottom:.25rem!important}.py-xxl-2[_ngcontent-%COMP%]{padding-top:.5rem!important;padding-bottom:.5rem!important}.py-xxl-3[_ngcontent-%COMP%]{padding-top:1rem!important;padding-bottom:1rem!important}.py-xxl-4[_ngcontent-%COMP%]{padding-top:1.5rem!important;padding-bottom:1.5rem!important}.py-xxl-5[_ngcontent-%COMP%]{padding-top:3rem!important;padding-bottom:3rem!important}.pt-xxl-0[_ngcontent-%COMP%]{padding-top:0!important}.pt-xxl-1[_ngcontent-%COMP%]{padding-top:.25rem!important}.pt-xxl-2[_ngcontent-%COMP%]{padding-top:.5rem!important}.pt-xxl-3[_ngcontent-%COMP%]{padding-top:1rem!important}.pt-xxl-4[_ngcontent-%COMP%]{padding-top:1.5rem!important}.pt-xxl-5[_ngcontent-%COMP%]{padding-top:3rem!important}.pe-xxl-0[_ngcontent-%COMP%]{padding-right:0!important}.pe-xxl-1[_ngcontent-%COMP%]{padding-right:.25rem!important}.pe-xxl-2[_ngcontent-%COMP%]{padding-right:.5rem!important}.pe-xxl-3[_ngcontent-%COMP%]{padding-right:1rem!important}.pe-xxl-4[_ngcontent-%COMP%]{padding-right:1.5rem!important}.pe-xxl-5[_ngcontent-%COMP%]{padding-right:3rem!important}.pb-xxl-0[_ngcontent-%COMP%]{padding-bottom:0!important}.pb-xxl-1[_ngcontent-%COMP%]{padding-bottom:.25rem!important}.pb-xxl-2[_ngcontent-%COMP%]{padding-bottom:.5rem!important}.pb-xxl-3[_ngcontent-%COMP%]{padding-bottom:1rem!important}.pb-xxl-4[_ngcontent-%COMP%]{padding-bottom:1.5rem!important}.pb-xxl-5[_ngcontent-%COMP%]{padding-bottom:3rem!important}.ps-xxl-0[_ngcontent-%COMP%]{padding-left:0!important}.ps-xxl-1[_ngcontent-%COMP%]{padding-left:.25rem!important}.ps-xxl-2[_ngcontent-%COMP%]{padding-left:.5rem!important}.ps-xxl-3[_ngcontent-%COMP%]{padding-left:1rem!important}.ps-xxl-4[_ngcontent-%COMP%]{padding-left:1.5rem!important}.ps-xxl-5[_ngcontent-%COMP%]{padding-left:3rem!important}.gap-xxl-0[_ngcontent-%COMP%]{gap:0!important}.gap-xxl-1[_ngcontent-%COMP%]{gap:.25rem!important}.gap-xxl-2[_ngcontent-%COMP%]{gap:.5rem!important}.gap-xxl-3[_ngcontent-%COMP%]{gap:1rem!important}.gap-xxl-4[_ngcontent-%COMP%]{gap:1.5rem!important}.gap-xxl-5[_ngcontent-%COMP%]{gap:3rem!important}.row-gap-xxl-0[_ngcontent-%COMP%]{row-gap:0!important}.row-gap-xxl-1[_ngcontent-%COMP%]{row-gap:.25rem!important}.row-gap-xxl-2[_ngcontent-%COMP%]{row-gap:.5rem!important}.row-gap-xxl-3[_ngcontent-%COMP%]{row-gap:1rem!important}.row-gap-xxl-4[_ngcontent-%COMP%]{row-gap:1.5rem!important}.row-gap-xxl-5[_ngcontent-%COMP%]{row-gap:3rem!important}.column-gap-xxl-0[_ngcontent-%COMP%]{column-gap:0!important}.column-gap-xxl-1[_ngcontent-%COMP%]{column-gap:.25rem!important}.column-gap-xxl-2[_ngcontent-%COMP%]{column-gap:.5rem!important}.column-gap-xxl-3[_ngcontent-%COMP%]{column-gap:1rem!important}.column-gap-xxl-4[_ngcontent-%COMP%]{column-gap:1.5rem!important}.column-gap-xxl-5[_ngcontent-%COMP%]{column-gap:3rem!important}.text-xxl-start[_ngcontent-%COMP%]{text-align:left!important}.text-xxl-end[_ngcontent-%COMP%]{text-align:right!important}.text-xxl-center[_ngcontent-%COMP%]{text-align:center!important}}@media (min-width:1200px){.fs-1[_ngcontent-%COMP%]{font-size:2.5rem!important}.fs-2[_ngcontent-%COMP%]{font-size:2rem!important}.fs-3[_ngcontent-%COMP%]{font-size:1.75rem!important}.fs-4[_ngcontent-%COMP%]{font-size:1.5rem!important}}@media print{.d-print-inline[_ngcontent-%COMP%]{display:inline!important}.d-print-inline-block[_ngcontent-%COMP%]{display:inline-block!important}.d-print-block[_ngcontent-%COMP%]{display:block!important}.d-print-grid[_ngcontent-%COMP%]{display:grid!important}.d-print-inline-grid[_ngcontent-%COMP%]{display:inline-grid!important}.d-print-table[_ngcontent-%COMP%]{display:table!important}.d-print-table-row[_ngcontent-%COMP%]{display:table-row!important}.d-print-table-cell[_ngcontent-%COMP%]{display:table-cell!important}.d-print-flex[_ngcontent-%COMP%]{display:flex!important}.d-print-inline-flex[_ngcontent-%COMP%]{display:inline-flex!important}.d-print-none[_ngcontent-%COMP%]{display:none!important}}.list-group[_ngcontent-%COMP%]{margin-bottom:20px}.card[_ngcontent-%COMP%]{margin-top:20px}.list-group-item[_ngcontent-%COMP%]{cursor:pointer}.list-group-item[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}"]})}return i})(),canActivate:[ZS]},{path:"comments",component:(()=>{class i{constructor(o,a){this.fb=o,this.afAuth=a,this.userId=null,this.afAuth.authState.subscribe(h=>{this.userId=h?.uid||null}),this.commentForm=this.fb.group({comment:["",UM.required]})}static#t=this.\u0275fac=function(a){return new(a||i)(x.Y36(yL),x.Y36(dD))};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-comments"]],decls:9,vars:0,consts:[[1,"comment-form-container"],["id","commentForm"],["for","comment"],["id","comment","name","comment","required",""],["type","submit"]],template:function(a,h){1&a&&(x.TgZ(0,"div",0)(1,"h2"),x._uU(2,"Add Comment"),x.qZA(),x.TgZ(3,"form",1)(4,"label",2),x._uU(5,"Comment:"),x.qZA(),x._UZ(6,"textarea",3),x.TgZ(7,"button",4),x._uU(8,"Submit"),x.qZA()()())},dependencies:[K2,$2,WE],styles:["body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;display:flex;align-items:center;justify-content:center;height:100vh;margin:0}.comment-form-container[_ngcontent-%COMP%]{width:300px;padding:20px;border:1px solid #ccc;border-radius:8px}label[_ngcontent-%COMP%]{display:block;margin-bottom:8px}textarea[_ngcontent-%COMP%]{width:100%;height:80px;resize:vertical;margin-bottom:16px}button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:10px;border:none;border-radius:4px;cursor:pointer}"]})}return i})(),canActivate:[ZS]},{path:"android",component:(()=>{class i{onScroll(){this.toggleStickyHeader(window.scrollY>0)}toggleStickyHeader(o){const a=document.querySelector("header");a&&a.classList.toggle("sticky",o)}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-android"]],hostBindings:function(a,h){1&a&&x.NdJ("scroll",function(w){return h.onScroll(w)},!1,x.Jf7)},decls:53,vars:0,consts:[[1,"logo"],[1,"nav"],["href","/"],["routerLink","/about"],["routerLink","/android",1,"active"],["routerLink","/associate"],["routerLink","/signIn",1,"login"],[1,"card"],[1,"text-center",2,"background-color","#29a1c6","color","white"],[2,"margin-bottom","-2px","color","white"],[1,"footer-icons","d-flex","justify-content-center"],["width","24","height","24","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M11.9694 2C6.46483 2 2 6.58933 2 12.2474C2 16.7739 4.87462 20.6088 8.78899 21.9919C9.27829 22.0547 9.46177 21.7404 9.46177 21.4889C9.46177 21.2375 9.46177 20.6088 9.46177 19.7286C6.70948 20.3573 6.09786 18.3456 6.09786 18.3456C5.66972 17.1511 4.99694 16.8367 4.99694 16.8367C4.07951 16.2081 5.0581 16.2081 5.0581 16.2081C6.0367 16.2709 6.58716 17.2768 6.58716 17.2768C7.50459 18.8485 8.91131 18.4084 9.46177 18.1569C9.52294 17.4654 9.82875 17.0253 10.0734 16.7739C7.87156 16.5224 5.5474 15.6422 5.5474 11.6816C5.5474 10.55 5.91437 9.66984 6.58716 8.91543C6.52599 8.72682 6.15902 7.65808 6.70948 6.27499C6.70948 6.27499 7.56575 6.02352 9.46177 7.34374C10.2569 7.09227 11.1131 7.0294 11.9694 7.0294C12.8257 7.0294 13.682 7.15514 14.4771 7.34374C16.3731 6.02352 17.2294 6.27499 17.2294 6.27499C17.7798 7.65808 17.4128 8.72682 17.3517 8.97829C17.9633 9.66984 18.3914 10.6128 18.3914 11.7445C18.3914 15.7051 16.0673 16.5224 13.8654 16.7739C14.2324 17.0882 14.5382 17.7169 14.5382 18.6599C14.5382 20.043 14.5382 21.1117 14.5382 21.4889C14.5382 21.7404 14.7217 22.0547 15.211 21.9919C19.1865 20.6088 22 16.7739 22 12.2474C21.9388 6.58933 17.474 2 11.9694 2Z","fill","white"],["width","21","height","16","viewBox","0 0 21 16","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M17.789 1.34C16.4296 0.714 14.9761 0.259052 13.4565 0C13.2699 0.332095 13.0519 0.77877 12.9016 1.1341C11.2862 0.894993 9.68567 0.894993 8.10001 1.1341C7.94972 0.77877 7.72674 0.332095 7.53844 0C6.01721 0.259052 4.56204 0.715671 3.20267 1.34331C0.460812 5.42136 -0.28246 9.39811 0.0891771 13.3184C1.90772 14.655 3.67011 15.467 5.40275 15.9984C5.83055 15.4189 6.21209 14.8028 6.54078 14.1536C5.91478 13.9195 5.31521 13.6306 4.74869 13.2952C4.89898 13.1856 5.046 13.071 5.18803 12.9531C8.64342 14.5438 12.3978 14.5438 15.8119 12.9531C15.9556 13.071 16.1026 13.1856 16.2512 13.2952C15.683 13.6322 15.0818 13.9211 14.4558 14.1553C14.7845 14.8028 15.1644 15.4205 15.5939 16C17.3282 15.4687 19.0922 14.6567 20.9107 13.3184C21.3468 8.77378 20.1658 4.83355 17.789 1.34ZM7.01153 10.9075C5.97426 10.9075 5.12361 9.95435 5.12361 8.7937C5.12361 7.63305 5.95609 6.67831 7.01153 6.67831C8.06699 6.67831 8.91761 7.63138 8.89945 8.7937C8.90109 9.95435 8.06699 10.9075 7.01153 10.9075ZM13.9884 10.9075C12.9511 10.9075 12.1005 9.95435 12.1005 8.7937C12.1005 7.63305 12.9329 6.67831 13.9884 6.67831C15.0438 6.67831 15.8945 7.63138 15.8763 8.7937C15.8763 9.95435 15.0438 10.9075 13.9884 10.9075Z","fill","white"],["d","M3.49423 3.75H2.99508L3.29403 4.14973L9.76944 12.8079L3.26917 19.8302L2.88055 20.25H3.45264H4.94748H5.05674L5.13095 20.1698L10.742 14.1081L15.2604 20.1497L15.3354 20.25H15.4606H20.5475H21.0466L20.7477 19.8503L13.9009 10.6956L19.9415 4.16983L20.3301 3.75H19.7581H18.2632H18.154L18.0797 3.83018L12.9286 9.39535L8.78148 3.85027L8.70649 3.75H8.58127H3.49423ZM16.1372 18.6487L6.19179 5.3511H7.90428L17.8497 18.6487H16.1372Z","fill","white","stroke","#566171","stroke-width","0.5"],["width","20px","height","20px","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["clip-path","url(#clip0)"],["d","M13.8576 23.9999V13.0511H17.5296L18.0816 8.78391H13.8576V6.06231C13.8576 4.82871 14.1984 3.98391 15.9744 3.98391H18.24V0.143913C17.1442 0.0366489 16.0434 -0.011421 14.9424 -8.69234e-05C11.6832 -8.69234e-05 9.45121 1.98711 9.45121 5.63991V8.78391H5.76001V13.0511H9.44641V23.9999H13.8576Z","fill","white"],["id","clip0"],["width","24","height","24","fill","white"],["d","M16.1113 4.27729C15.9763 4.20752 15.8449 4.13104 15.7176 4.04813C15.3473 3.80333 15.0078 3.51489 14.7064 3.18901C13.9523 2.32613 13.6706 1.45076 13.5669 0.837875H13.571C13.4844 0.32915 13.5202 0 13.5256 0H10.0908V13.2818C10.0908 13.4602 10.0908 13.6364 10.0833 13.8106C10.0833 13.8322 10.0812 13.8522 10.08 13.8756C10.08 13.8851 10.08 13.8951 10.0779 13.9051C10.0779 13.9076 10.0779 13.9101 10.0779 13.9126C10.0417 14.3892 9.88891 14.8495 9.63303 15.2532C9.37715 15.6568 9.026 15.9914 8.61046 16.2275C8.17737 16.4739 7.68754 16.6032 7.18928 16.6025C5.58894 16.6025 4.29192 15.2976 4.29192 13.686C4.29192 12.0744 5.58894 10.7695 7.18928 10.7695C7.49221 10.7692 7.79328 10.8169 8.08132 10.9107L8.08548 7.41338C7.21109 7.30043 6.32279 7.36992 5.4766 7.61747C4.63041 7.86502 3.84471 8.28524 3.16906 8.85164C2.57703 9.36603 2.07931 9.97979 1.6983 10.6653C1.55331 10.9153 1.00625 11.9198 0.940004 13.5502C0.898339 14.4755 1.17624 15.4342 1.30874 15.8305V15.8388C1.39206 16.0721 1.71497 16.8683 2.24119 17.5395C2.66552 18.078 3.16685 18.5509 3.72903 18.9432V18.9349L3.73736 18.9432C5.4002 20.0732 7.24386 19.999 7.24386 19.999C7.56301 19.9861 8.63212 19.999 9.84623 19.4236C11.1928 18.7857 11.9595 17.8354 11.9595 17.8354C12.4492 17.2675 12.8387 16.6204 13.1111 15.9217C13.4219 15.1047 13.5256 14.1247 13.5256 13.7331V6.68675C13.5673 6.71175 14.1223 7.07881 14.1223 7.07881C14.1223 7.07881 14.9218 7.59129 16.1692 7.92502C17.0642 8.16251 18.27 8.21251 18.27 8.21251V4.80268C17.8475 4.84851 16.9896 4.71518 16.1113 4.27729Z","fill","white"],["d","M11.9968 7.9983C9.79333 7.9983 7.99515 9.79651 7.99515 12C7.99515 14.2035 9.79333 16.0017 11.9968 16.0017C14.2002 16.0017 15.9984 14.2035 15.9984 12C15.9984 9.79651 14.2002 7.9983 11.9968 7.9983ZM23.9987 12C23.9987 10.3429 24.0137 8.70077 23.9206 7.04665C23.8275 5.12536 23.3893 3.4202 21.9843 2.01525C20.5764 0.607302 18.8743 0.172008 16.953 0.0789456C15.2959 -0.0141173 13.6539 0.000892936 11.9998 0.000892936C10.3427 0.000892936 8.70061 -0.0141173 7.04652 0.0789456C5.12526 0.172008 3.42014 0.610305 2.01522 2.01525C0.607291 3.42321 0.172005 5.12536 0.0789442 7.04665C-0.014117 8.70377 0.000892919 10.3459 0.000892919 12C0.000892919 13.6541 -0.014117 15.2992 0.0789442 16.9533C0.172005 18.8746 0.610293 20.5798 2.01522 21.9847C3.42314 23.3927 5.12526 23.828 7.04652 23.9211C8.70361 24.0141 10.3457 23.9991 11.9998 23.9991C13.6569 23.9991 15.2989 24.0141 16.953 23.9211C18.8743 23.828 20.5794 23.3897 21.9843 21.9847C23.3923 20.5768 23.8275 18.8746 23.9206 16.9533C24.0167 15.2992 23.9987 13.6571 23.9987 12ZM11.9968 18.1572C8.58954 18.1572 5.83973 15.4073 5.83973 12C5.83973 8.5927 8.58954 5.84284 11.9968 5.84284C15.404 5.84284 18.1538 8.5927 18.1538 12C18.1538 15.4073 15.404 18.1572 11.9968 18.1572ZM18.406 7.02864C17.6105 7.02864 16.968 6.38621 16.968 5.59067C16.968 4.79513 17.6105 4.1527 18.406 4.1527C19.2015 4.1527 19.8439 4.79513 19.8439 5.59067C19.8442 5.77957 19.8071 5.96667 19.735 6.14124C19.6628 6.31581 19.5569 6.47442 19.4233 6.608C19.2897 6.74157 19.1311 6.84748 18.9565 6.91967C18.782 6.99185 18.5949 7.02888 18.406 7.02864Z","fill","white"],["href","#",2,"color","white"]],template:function(a,h){1&a&&(x.TgZ(0,"header")(1,"a",0),x._uU(2,"TripTrove"),x.qZA(),x.TgZ(3,"ul",1)(4,"li")(5,"a",2),x._uU(6,"INICIO"),x.qZA()(),x.TgZ(7,"li")(8,"a",3),x._uU(9,"ACERCA DE"),x.qZA()(),x.TgZ(10,"li")(11,"a",4),x._uU(12,"ANDROID"),x.qZA()(),x.TgZ(13,"li")(14,"a",5),x._uU(15,"ASOCIATE"),x.qZA()()(),x.TgZ(16,"a",6),x._uU(17,"INGRESAR"),x.qZA()(),x.TgZ(18,"body")(19,"div",7),x._uU(20,"Android"),x.qZA()(),x.TgZ(21,"footer",8)(22,"p",9),x._uU(23,"All Rights Reserved \xa9 TripTrove"),x.qZA(),x.TgZ(24,"div",10)(25,"div"),x.O4$(),x.TgZ(26,"svg",11),x._UZ(27,"path",12),x.qZA()(),x.kcU(),x.TgZ(28,"div"),x.O4$(),x.TgZ(29,"svg",13),x._UZ(30,"path",14),x.qZA()(),x.kcU(),x.TgZ(31,"div"),x.O4$(),x.TgZ(32,"svg",11),x._UZ(33,"path",15),x.qZA()(),x.TgZ(34,"svg",16)(35,"g",17),x._UZ(36,"path",18),x.qZA(),x.TgZ(37,"defs")(38,"clipPath",19),x._UZ(39,"rect",20),x.qZA()()(),x.kcU(),x.TgZ(40,"div"),x.O4$(),x.TgZ(41,"svg",16),x._UZ(42,"path",21),x.qZA()(),x.kcU(),x.TgZ(43,"div"),x.O4$(),x.TgZ(44,"svg",16),x._UZ(45,"path",22),x.qZA()()(),x.kcU(),x.TgZ(46,"div")(47,"a",23),x._uU(48,"Terms"),x.qZA(),x.TgZ(49,"a",23),x._uU(50,"Privacy"),x.qZA(),x.TgZ(51,"a",23),x._uU(52,"Security"),x.qZA()()())},dependencies:[cT],styles:['@import"https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap";*[_ngcontent-%COMP%]{box-sizing:border-box;font-family:Poppins,sans-serif;color:#000;text-decoration:none}body[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100vh;margin:0;background-image:url(fondoAndroid.ed14630c41fa3198.jpg);background-attachment:fixed;background-position:center;background-size:cover}header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;display:flex;justify-content:space-between;align-items:center;transition:.9s;padding:40px 100px;z-index:100000;font-size:18px}header[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]{color:#000;transition:.6s}header.sticky[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]{color:#fff;transition:.6s}header.sticky[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(2) a{color:#fff}header.sticky[_ngcontent-%COMP%]{padding:5px 100px;background:rgb(37,150,190)}header.sticky[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%], header.sticky[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:relative;font-weight:700;color:#000;text-decoration:none;font-size:2em;letter-spacing:2px;transition:.6s}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:relative;list-style:none}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:relative;margin:0 15px;text-decoration:none;color:#000;letter-spacing:2px;font-weight:500;transition:.5s;overflow:hidden}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;width:120%;height:3px;background-color:#000;z-index:-1;transition:transform .8s;border-radius:5px}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:before{top:0;left:-10%;transform:scaleX(0);transform-origin:right}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{bottom:0;right:-10%;transform:scaleX(0);transform-origin:left}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:before, header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:center}header[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{font-weight:700;font-size:120%}.contact-section[_ngcontent-%COMP%]{background-color:#202020;color:#fff;padding:50px;text-align:center;height:30vh}.company-info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;text-align:left;flex-wrap:wrap}.company-info[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:200px;margin-right:35px;border-radius:7px;margin-bottom:10px}.text-info[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]{flex:1;max-width:60%}.team-member[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]{margin-top:5px;margin-left:65px}.text-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .team-member[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;margin-bottom:10px;color:#fff}.text-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .team-member[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;margin-bottom:8px;color:#fff}.team-member[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .Myxi-text-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff}.card[_ngcontent-%COMP%]{position:relative;width:220px;height:320px;background:#29a1c6;display:flex;align-items:center;justify-content:center;font-size:25px;font-weight:700;border-radius:15px;cursor:pointer}.card[_ngcontent-%COMP%]:before, .card[_ngcontent-%COMP%]:after{position:absolute;content:"";width:20%;height:20%;display:flex;align-items:center;justify-content:center;font-size:25px;font-weight:700;background-color:#fff;transition:all .5s}.card[_ngcontent-%COMP%]:before{top:0;right:0;border-radius:0 15px 0 100%}.card[_ngcontent-%COMP%]:after{bottom:0;left:0;border-radius:0 100% 0 15px}.card[_ngcontent-%COMP%]:hover:before, .card[_ngcontent-%COMP%]:hover:after{width:100%;height:100%;border-radius:15px;transition:all .5s}.card[_ngcontent-%COMP%]:hover:after{content:"Pr\\f3ximamente"}footer[_ngcontent-%COMP%]{background-color:#f50;color:#fff;text-align:center;padding:20px 0;margin-top:0;width:100%;display:flex;justify-content:space-evenly;align-items:center;box-sizing:border-box}footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin:0 10px}footer[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:24px;height:24px;margin-right:5px}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 20px 0 0}a[_ngcontent-%COMP%]{cursor:pointer}']})}return i})()}];let nB=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=x.oAB({type:i});static#n=this.\u0275inj=x.cJS({imports:[oR.forRoot(eB),oR]})}return i})(),rB=(()=>{class i{constructor(){this.title="TripTrove"}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275cmp=x.Xpm({type:i,selectors:[["app-root"]],decls:7,vars:0,consts:[["charset","utf-8"],["href","/"],["name","viewport","content","width=device-width, initial-scale=1"]],template:function(a,h){1&a&&(x.TgZ(0,"head"),x._UZ(1,"meta",0),x.TgZ(2,"title"),x._uU(3,"TripTrove"),x.qZA(),x._UZ(4,"base",1)(5,"meta",2),x.qZA(),x._UZ(6,"router-outlet"))},dependencies:[eD]})}return i})(),oB=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=x.oAB({type:i});static#n=this.\u0275inj=x.cJS({imports:[Do,Nk]})}return i})(),iB=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=x.oAB({type:i});static#n=this.\u0275inj=x.cJS({imports:[Fk,Do]})}return i})();class qR{}class sB{}const ub="*";function ZR(i,n=null){return{type:2,steps:i,options:n}}function WR(i){return{type:6,styles:i,offset:null}}class PI{constructor(n=0,o=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+o}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const o="start"==n?this._onStartFns:this._onDoneFns;o.forEach(a=>a()),o.length=0}}class KR{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let o=0,a=0,h=0;const _=this.players.length;0==_?queueMicrotask(()=>this._onFinish()):this.players.forEach(w=>{w.onDone(()=>{++o==_&&this._onFinish()}),w.onDestroy(()=>{++a==_&&this._onDestroy()}),w.onStart(()=>{++h==_&&this._onStart()})}),this.totalTime=this.players.reduce((w,S)=>Math.max(w,S.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const o=n*this.totalTime;this.players.forEach(a=>{const h=a.totalTime?Math.min(1,o/a.totalTime):1;a.setPosition(h)})}getPosition(){const n=this.players.reduce((o,a)=>null===o||a.totalTime>o.totalTime?a:o,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const o="start"==n?this._onStartFns:this._onDoneFns;o.forEach(a=>a()),o.length=0}}function YR(i){return new x.vHH(3e3,!1)}function hw(i){switch(i.length){case 0:return new PI;case 1:return i[0];default:return new KR(i)}}function XR(i,n,o=new Map,a=new Map){const h=[],_=[];let w=-1,S=null;if(n.forEach(L=>{const B=L.get("offset"),H=B==w,Y=H&&S||new Map;L.forEach((pt,xt)=>{let At=xt,Ut=pt;if("offset"!==xt)switch(At=i.normalizePropertyName(At,h),Ut){case"!":Ut=o.get(xt);break;case ub:Ut=a.get(xt);break;default:Ut=i.normalizeStyleValue(xt,At,Ut,h)}Y.set(At,Ut)}),H||_.push(Y),S=Y,w=B}),h.length)throw function IB(i){return new x.vHH(3502,!1)}();return _}function ID(i,n,o,a){switch(n){case"start":i.onStart(()=>a(o&&SD(o,"start",i)));break;case"done":i.onDone(()=>a(o&&SD(o,"done",i)));break;case"destroy":i.onDestroy(()=>a(o&&SD(o,"destroy",i)))}}function SD(i,n,o){const _=AD(i.element,i.triggerName,i.fromState,i.toState,n||i.phaseName,o.totalTime??i.totalTime,!!o.disabled),w=i._data;return null!=w&&(_._data=w),_}function AD(i,n,o,a,h="",_=0,w){return{element:i,triggerName:n,fromState:o,toState:a,phaseName:h,totalTime:_,disabled:!!w}}function Uf(i,n,o){let a=i.get(n);return a||i.set(n,a=o),a}function QR(i){const n=i.indexOf(":");return[i.substring(1,n),i.slice(n+1)]}const VB=(()=>typeof document>"u"?null:document.documentElement)();function DD(i){const n=i.parentNode||i.host||null;return n===VB?null:n}let YM=null,JR=!1;function t5(i,n){for(;n;){if(n===i)return!0;n=DD(n)}return!1}function e5(i,n,o){if(o)return Array.from(i.querySelectorAll(n));const a=i.querySelector(n);return a?[a]:[]}let n5=(()=>{class i{validateStyleProperty(o){return function $B(i){YM||(YM=function GB(){return typeof document<"u"?document.body:null}()||{},JR=!!YM.style&&"WebkitAppearance"in YM.style);let n=!0;return YM.style&&!function jB(i){return"ebkit"==i.substring(1,6)}(i)&&(n=i in YM.style,!n&&JR&&(n="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in YM.style)),n}(o)}matchesElement(o,a){return!1}containsElement(o,a){return t5(o,a)}getParentElement(o){return DD(o)}query(o,a,h){return e5(o,a,h)}computeStyle(o,a,h){return h||""}animate(o,a,h,_,w,S=[],L){return new PI(h,_)}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})(),kD=(()=>{class i{static#t=this.NOOP=new n5}return i})();const HB=1e3,RD="ng-enter",WS="ng-leave",KS="ng-trigger",YS=".ng-trigger",o5="ng-animating",LD=".ng-animating";function db(i){if("number"==typeof i)return i;const n=i.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:ND(parseFloat(n[1]),n[2])}function ND(i,n){return"s"===n?i*HB:i}function XS(i,n,o){return i.hasOwnProperty("duration")?i:function ZB(i,n,o){let h,_=0,w="";if("string"==typeof i){const S=i.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===S)return n.push(YR()),{duration:0,delay:0,easing:""};h=ND(parseFloat(S[1]),S[2]);const L=S[3];null!=L&&(_=ND(parseFloat(L),S[4]));const B=S[5];B&&(w=B)}else h=i;if(!o){let S=!1,L=n.length;h<0&&(n.push(function aB(){return new x.vHH(3100,!1)}()),S=!0),_<0&&(n.push(function lB(){return new x.vHH(3101,!1)}()),S=!0),S&&n.splice(L,0,YR())}return{duration:h,delay:_,easing:w}}(i,n,o)}function OI(i,n={}){return Object.keys(i).forEach(o=>{n[o]=i[o]}),n}function i5(i){const n=new Map;return Object.keys(i).forEach(o=>{n.set(o,i[o])}),n}function fw(i,n=new Map,o){if(o)for(let[a,h]of o)n.set(a,h);for(let[a,h]of i)n.set(a,h);return n}function $y(i,n,o){n.forEach((a,h)=>{const _=zD(h);o&&!o.has(h)&&o.set(h,i.style[_]),i.style[_]=a})}function XM(i,n){n.forEach((o,a)=>{const h=zD(a);i.style[h]=""})}function EI(i){return Array.isArray(i)?1==i.length?i[0]:ZR(i):i}const FD=new RegExp("{{\\s*(.+?)\\s*}}","g");function a5(i){let n=[];if("string"==typeof i){let o;for(;o=FD.exec(i);)n.push(o[1]);FD.lastIndex=0}return n}function TI(i,n,o){const a=i.toString(),h=a.replace(FD,(_,w)=>{let S=n[w];return null==S&&(o.push(function uB(i){return new x.vHH(3003,!1)}()),S=""),S.toString()});return h==a?i:h}function QS(i){const n=[];let o=i.next();for(;!o.done;)n.push(o.value),o=i.next();return n}const YB=/-+([a-z0-9])/g;function zD(i){return i.replace(YB,(...n)=>n[1].toUpperCase())}function Vf(i,n,o){switch(n.type){case 7:return i.visitTrigger(n,o);case 0:return i.visitState(n,o);case 1:return i.visitTransition(n,o);case 2:return i.visitSequence(n,o);case 3:return i.visitGroup(n,o);case 4:return i.visitAnimate(n,o);case 5:return i.visitKeyframes(n,o);case 6:return i.visitStyle(n,o);case 8:return i.visitReference(n,o);case 9:return i.visitAnimateChild(n,o);case 10:return i.visitAnimateRef(n,o);case 11:return i.visitQuery(n,o);case 12:return i.visitStagger(n,o);default:throw function dB(i){return new x.vHH(3004,!1)}()}}function l5(i,n){return window.getComputedStyle(i)[n]}const JS="*";function JB(i,n){const o=[];return"string"==typeof i?i.split(/\s*,\s*/).forEach(a=>function tU(i,n,o){if(":"==i[0]){const L=function eU(i,n){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(o,a)=>parseFloat(a)>parseFloat(o);case":decrement":return(o,a)=>parseFloat(a)<parseFloat(o);default:return n.push(function PB(i){return new x.vHH(3016,!1)}()),"* => *"}}(i,o);if("function"==typeof L)return void n.push(L);i=L}const a=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==a||a.length<4)return o.push(function MB(i){return new x.vHH(3015,!1)}()),n;const h=a[1],_=a[2],w=a[3];n.push(c5(h,w));"<"==_[0]&&!(h==JS&&w==JS)&&n.push(c5(w,h))}(a,o,n)):o.push(i),o}const tA=new Set(["true","1"]),eA=new Set(["false","0"]);function c5(i,n){const o=tA.has(i)||eA.has(i),a=tA.has(n)||eA.has(n);return(h,_)=>{let w=i==JS||i==h,S=n==JS||n==_;return!w&&o&&"boolean"==typeof h&&(w=h?tA.has(i):eA.has(i)),!S&&a&&"boolean"==typeof _&&(S=_?tA.has(n):eA.has(n)),w&&S}}const nU=new RegExp("s*:selfs*,?","g");function BD(i,n,o,a){return new rU(i).build(n,o,a)}class rU{constructor(n){this._driver=n}build(n,o,a){const h=new sU(o);return this._resetContextStyleTimingState(h),Vf(this,EI(n),h)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,o){let a=o.queryCount=0,h=o.depCount=0;const _=[],w=[];return"@"==n.name.charAt(0)&&o.errors.push(function fB(){return new x.vHH(3006,!1)}()),n.definitions.forEach(S=>{if(this._resetContextStyleTimingState(o),0==S.type){const L=S,B=L.name;B.toString().split(/\s*,\s*/).forEach(H=>{L.name=H,_.push(this.visitState(L,o))}),L.name=B}else if(1==S.type){const L=this.visitTransition(S,o);a+=L.queryCount,h+=L.depCount,w.push(L)}else o.errors.push(function pB(){return new x.vHH(3007,!1)}())}),{type:7,name:n.name,states:_,transitions:w,queryCount:a,depCount:h,options:null}}visitState(n,o){const a=this.visitStyle(n.styles,o),h=n.options&&n.options.params||null;if(a.containsDynamicStyles){const _=new Set,w=h||{};a.styles.forEach(S=>{S instanceof Map&&S.forEach(L=>{a5(L).forEach(B=>{w.hasOwnProperty(B)||_.add(B)})})}),_.size&&(QS(_.values()),o.errors.push(function gB(i,n){return new x.vHH(3008,!1)}()))}return{type:0,name:n.name,style:a,options:h?{params:h}:null}}visitTransition(n,o){o.queryCount=0,o.depCount=0;const a=Vf(this,EI(n.animation),o);return{type:1,matchers:JB(n.expr,o.errors),animation:a,queryCount:o.queryCount,depCount:o.depCount,options:QM(n.options)}}visitSequence(n,o){return{type:2,steps:n.steps.map(a=>Vf(this,a,o)),options:QM(n.options)}}visitGroup(n,o){const a=o.currentTime;let h=0;const _=n.steps.map(w=>{o.currentTime=a;const S=Vf(this,w,o);return h=Math.max(h,o.currentTime),S});return o.currentTime=h,{type:3,steps:_,options:QM(n.options)}}visitAnimate(n,o){const a=function lU(i,n){if(i.hasOwnProperty("duration"))return i;if("number"==typeof i)return UD(XS(i,n).duration,0,"");const o=i;if(o.split(/\s+/).some(_=>"{"==_.charAt(0)&&"{"==_.charAt(1))){const _=UD(0,0,"");return _.dynamic=!0,_.strValue=o,_}const h=XS(o,n);return UD(h.duration,h.delay,h.easing)}(n.timings,o.errors);o.currentAnimateTimings=a;let h,_=n.styles?n.styles:WR({});if(5==_.type)h=this.visitKeyframes(_,o);else{let w=n.styles,S=!1;if(!w){S=!0;const B={};a.easing&&(B.easing=a.easing),w=WR(B)}o.currentTime+=a.duration+a.delay;const L=this.visitStyle(w,o);L.isEmptyStep=S,h=L}return o.currentAnimateTimings=null,{type:4,timings:a,style:h,options:null}}visitStyle(n,o){const a=this._makeStyleAst(n,o);return this._validateStyleAst(a,o),a}_makeStyleAst(n,o){const a=[],h=Array.isArray(n.styles)?n.styles:[n.styles];for(let S of h)"string"==typeof S?S===ub?a.push(S):o.errors.push(new x.vHH(3002,!1)):a.push(i5(S));let _=!1,w=null;return a.forEach(S=>{if(S instanceof Map&&(S.has("easing")&&(w=S.get("easing"),S.delete("easing")),!_))for(let L of S.values())if(L.toString().indexOf("{{")>=0){_=!0;break}}),{type:6,styles:a,easing:w,offset:n.offset,containsDynamicStyles:_,options:null}}_validateStyleAst(n,o){const a=o.currentAnimateTimings;let h=o.currentTime,_=o.currentTime;a&&_>0&&(_-=a.duration+a.delay),n.styles.forEach(w=>{"string"!=typeof w&&w.forEach((S,L)=>{const B=o.collectedStyles.get(o.currentQuerySelector),H=B.get(L);let Y=!0;H&&(_!=h&&_>=H.startTime&&h<=H.endTime&&(o.errors.push(function _B(i,n,o,a,h){return new x.vHH(3010,!1)}()),Y=!1),_=H.startTime),Y&&B.set(L,{startTime:_,endTime:h}),o.options&&function KB(i,n,o){const a=n.params||{},h=a5(i);h.length&&h.forEach(_=>{a.hasOwnProperty(_)||o.push(function cB(i){return new x.vHH(3001,!1)}())})}(S,o.options,o.errors)})})}visitKeyframes(n,o){const a={type:5,styles:[],options:null};if(!o.currentAnimateTimings)return o.errors.push(function yB(){return new x.vHH(3011,!1)}()),a;let _=0;const w=[];let S=!1,L=!1,B=0;const H=n.steps.map(qe=>{const fn=this._makeStyleAst(qe,o);let $e=null!=fn.offset?fn.offset:function aU(i){if("string"==typeof i)return null;let n=null;if(Array.isArray(i))i.forEach(o=>{if(o instanceof Map&&o.has("offset")){const a=o;n=parseFloat(a.get("offset")),a.delete("offset")}});else if(i instanceof Map&&i.has("offset")){const o=i;n=parseFloat(o.get("offset")),o.delete("offset")}return n}(fn.styles),cn=0;return null!=$e&&(_++,cn=fn.offset=$e),L=L||cn<0||cn>1,S=S||cn<B,B=cn,w.push(cn),fn});L&&o.errors.push(function vB(){return new x.vHH(3012,!1)}()),S&&o.errors.push(function bB(){return new x.vHH(3200,!1)}());const Y=n.steps.length;let pt=0;_>0&&_<Y?o.errors.push(function xB(){return new x.vHH(3202,!1)}()):0==_&&(pt=1/(Y-1));const xt=Y-1,At=o.currentTime,Ut=o.currentAnimateTimings,Zt=Ut.duration;return H.forEach((qe,fn)=>{const $e=pt>0?fn==xt?1:pt*fn:w[fn],cn=$e*Zt;o.currentTime=At+Ut.delay+cn,Ut.duration=cn,this._validateStyleAst(qe,o),qe.offset=$e,a.styles.push(qe)}),a}visitReference(n,o){return{type:8,animation:Vf(this,EI(n.animation),o),options:QM(n.options)}}visitAnimateChild(n,o){return o.depCount++,{type:9,options:QM(n.options)}}visitAnimateRef(n,o){return{type:10,animation:this.visitReference(n.animation,o),options:QM(n.options)}}visitQuery(n,o){const a=o.currentQuerySelector,h=n.options||{};o.queryCount++,o.currentQuery=n;const[_,w]=function oU(i){const n=!!i.split(/\s*,\s*/).find(o=>":self"==o);return n&&(i=i.replace(nU,"")),i=i.replace(/@\*/g,YS).replace(/@\w+/g,o=>YS+"-"+o.slice(1)).replace(/:animating/g,LD),[i,n]}(n.selector);o.currentQuerySelector=a.length?a+" "+_:_,Uf(o.collectedStyles,o.currentQuerySelector,new Map);const S=Vf(this,EI(n.animation),o);return o.currentQuery=null,o.currentQuerySelector=a,{type:11,selector:_,limit:h.limit||0,optional:!!h.optional,includeSelf:w,animation:S,originalSelector:n.selector,options:QM(n.options)}}visitStagger(n,o){o.currentQuery||o.errors.push(function wB(){return new x.vHH(3013,!1)}());const a="full"===n.timings?{duration:0,delay:0,easing:"full"}:XS(n.timings,o.errors,!0);return{type:12,animation:Vf(this,EI(n.animation),o),timings:a,options:null}}}class sU{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function QM(i){return i?(i=OI(i)).params&&(i.params=function iU(i){return i?OI(i):null}(i.params)):i={},i}function UD(i,n,o){return{duration:i,delay:n,easing:o}}function VD(i,n,o,a,h,_,w=null,S=!1){return{type:1,element:i,keyframes:n,preStyleProps:o,postStyleProps:a,duration:h,delay:_,totalTime:h+_,easing:w,subTimeline:S}}class nA{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,o){let a=this._map.get(n);a||this._map.set(n,a=[]),a.push(...o)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const dU=new RegExp(":enter","g"),fU=new RegExp(":leave","g");function jD(i,n,o,a,h,_=new Map,w=new Map,S,L,B=[]){return(new pU).buildKeyframes(i,n,o,a,h,_,w,S,L,B)}class pU{buildKeyframes(n,o,a,h,_,w,S,L,B,H=[]){B=B||new nA;const Y=new $D(n,o,B,h,_,H,[]);Y.options=L;const pt=L.delay?db(L.delay):0;Y.currentTimeline.delayNextStep(pt),Y.currentTimeline.setStyles([w],null,Y.errors,L),Vf(this,a,Y);const xt=Y.timelines.filter(At=>At.containsAnimation());if(xt.length&&S.size){let At;for(let Ut=xt.length-1;Ut>=0;Ut--){const Zt=xt[Ut];if(Zt.element===o){At=Zt;break}}At&&!At.allowOnlyTimelineStyles()&&At.setStyles([S],null,Y.errors,L)}return xt.length?xt.map(At=>At.buildKeyframes()):[VD(o,[],[],[],0,pt,"",!1)]}visitTrigger(n,o){}visitState(n,o){}visitTransition(n,o){}visitAnimateChild(n,o){const a=o.subInstructions.get(o.element);if(a){const h=o.createSubContext(n.options),_=o.currentTimeline.currentTime,w=this._visitSubInstructions(a,h,h.options);_!=w&&o.transformIntoNewTimeline(w)}o.previousNode=n}visitAnimateRef(n,o){const a=o.createSubContext(n.options);a.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],o,a),this.visitReference(n.animation,a),o.transformIntoNewTimeline(a.currentTimeline.currentTime),o.previousNode=n}_applyAnimationRefDelays(n,o,a){for(const h of n){const _=h?.delay;if(_){const w="number"==typeof _?_:db(TI(_,h?.params??{},o.errors));a.delayNextStep(w)}}}_visitSubInstructions(n,o,a){let _=o.currentTimeline.currentTime;const w=null!=a.duration?db(a.duration):null,S=null!=a.delay?db(a.delay):null;return 0!==w&&n.forEach(L=>{const B=o.appendInstructionToTimeline(L,w,S);_=Math.max(_,B.duration+B.delay)}),_}visitReference(n,o){o.updateOptions(n.options,!0),Vf(this,n.animation,o),o.previousNode=n}visitSequence(n,o){const a=o.subContextCount;let h=o;const _=n.options;if(_&&(_.params||_.delay)&&(h=o.createSubContext(_),h.transformIntoNewTimeline(),null!=_.delay)){6==h.previousNode.type&&(h.currentTimeline.snapshotCurrentStyles(),h.previousNode=rA);const w=db(_.delay);h.delayNextStep(w)}n.steps.length&&(n.steps.forEach(w=>Vf(this,w,h)),h.currentTimeline.applyStylesToKeyframe(),h.subContextCount>a&&h.transformIntoNewTimeline()),o.previousNode=n}visitGroup(n,o){const a=[];let h=o.currentTimeline.currentTime;const _=n.options&&n.options.delay?db(n.options.delay):0;n.steps.forEach(w=>{const S=o.createSubContext(n.options);_&&S.delayNextStep(_),Vf(this,w,S),h=Math.max(h,S.currentTimeline.currentTime),a.push(S.currentTimeline)}),a.forEach(w=>o.currentTimeline.mergeTimelineCollectedStyles(w)),o.transformIntoNewTimeline(h),o.previousNode=n}_visitTiming(n,o){if(n.dynamic){const a=n.strValue;return XS(o.params?TI(a,o.params,o.errors):a,o.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,o){const a=o.currentAnimateTimings=this._visitTiming(n.timings,o),h=o.currentTimeline;a.delay&&(o.incrementTime(a.delay),h.snapshotCurrentStyles());const _=n.style;5==_.type?this.visitKeyframes(_,o):(o.incrementTime(a.duration),this.visitStyle(_,o),h.applyStylesToKeyframe()),o.currentAnimateTimings=null,o.previousNode=n}visitStyle(n,o){const a=o.currentTimeline,h=o.currentAnimateTimings;!h&&a.hasCurrentStyleProperties()&&a.forwardFrame();const _=h&&h.easing||n.easing;n.isEmptyStep?a.applyEmptyStep(_):a.setStyles(n.styles,_,o.errors,o.options),o.previousNode=n}visitKeyframes(n,o){const a=o.currentAnimateTimings,h=o.currentTimeline.duration,_=a.duration,S=o.createSubContext().currentTimeline;S.easing=a.easing,n.styles.forEach(L=>{S.forwardTime((L.offset||0)*_),S.setStyles(L.styles,L.easing,o.errors,o.options),S.applyStylesToKeyframe()}),o.currentTimeline.mergeTimelineCollectedStyles(S),o.transformIntoNewTimeline(h+_),o.previousNode=n}visitQuery(n,o){const a=o.currentTimeline.currentTime,h=n.options||{},_=h.delay?db(h.delay):0;_&&(6===o.previousNode.type||0==a&&o.currentTimeline.hasCurrentStyleProperties())&&(o.currentTimeline.snapshotCurrentStyles(),o.previousNode=rA);let w=a;const S=o.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!h.optional,o.errors);o.currentQueryTotal=S.length;let L=null;S.forEach((B,H)=>{o.currentQueryIndex=H;const Y=o.createSubContext(n.options,B);_&&Y.delayNextStep(_),B===o.element&&(L=Y.currentTimeline),Vf(this,n.animation,Y),Y.currentTimeline.applyStylesToKeyframe(),w=Math.max(w,Y.currentTimeline.currentTime)}),o.currentQueryIndex=0,o.currentQueryTotal=0,o.transformIntoNewTimeline(w),L&&(o.currentTimeline.mergeTimelineCollectedStyles(L),o.currentTimeline.snapshotCurrentStyles()),o.previousNode=n}visitStagger(n,o){const a=o.parentContext,h=o.currentTimeline,_=n.timings,w=Math.abs(_.duration),S=w*(o.currentQueryTotal-1);let L=w*o.currentQueryIndex;switch(_.duration<0?"reverse":_.easing){case"reverse":L=S-L;break;case"full":L=a.currentStaggerTime}const H=o.currentTimeline;L&&H.delayNextStep(L);const Y=H.currentTime;Vf(this,n.animation,o),o.previousNode=n,a.currentStaggerTime=h.currentTime-Y+(h.startTime-a.currentTimeline.startTime)}}const rA={};class $D{constructor(n,o,a,h,_,w,S,L){this._driver=n,this.element=o,this.subInstructions=a,this._enterClassName=h,this._leaveClassName=_,this.errors=w,this.timelines=S,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=rA,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=L||new oA(this._driver,o,0),S.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,o){if(!n)return;const a=n;let h=this.options;null!=a.duration&&(h.duration=db(a.duration)),null!=a.delay&&(h.delay=db(a.delay));const _=a.params;if(_){let w=h.params;w||(w=this.options.params={}),Object.keys(_).forEach(S=>{(!o||!w.hasOwnProperty(S))&&(w[S]=TI(_[S],w,this.errors))})}}_copyOptions(){const n={};if(this.options){const o=this.options.params;if(o){const a=n.params={};Object.keys(o).forEach(h=>{a[h]=o[h]})}}return n}createSubContext(n=null,o,a){const h=o||this.element,_=new $D(this._driver,h,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(h,a||0));return _.previousNode=this.previousNode,_.currentAnimateTimings=this.currentAnimateTimings,_.options=this._copyOptions(),_.updateOptions(n),_.currentQueryIndex=this.currentQueryIndex,_.currentQueryTotal=this.currentQueryTotal,_.parentContext=this,this.subContextCount++,_}transformIntoNewTimeline(n){return this.previousNode=rA,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,o,a){const h={duration:o??n.duration,delay:this.currentTimeline.currentTime+(a??0)+n.delay,easing:""},_=new gU(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,h,n.stretchStartingKeyframe);return this.timelines.push(_),h}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,o,a,h,_,w){let S=[];if(h&&S.push(this.element),n.length>0){n=(n=n.replace(dU,"."+this._enterClassName)).replace(fU,"."+this._leaveClassName);let B=this._driver.query(this.element,n,1!=a);0!==a&&(B=a<0?B.slice(B.length+a,B.length):B.slice(0,a)),S.push(...B)}return!_&&0==S.length&&w.push(function CB(i){return new x.vHH(3014,!1)}()),S}}class oA{constructor(n,o,a,h){this._driver=n,this.element=o,this.startTime=a,this._elementTimelineStylesLookup=h,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(o),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(o,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const o=1===this._keyframes.size&&this._pendingStyles.size;this.duration||o?(this.forwardTime(this.currentTime+n),o&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,o){return this.applyStylesToKeyframe(),new oA(this._driver,n,o||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,o){this._localTimelineStyles.set(n,o),this._globalTimelineStyles.set(n,o),this._styleSummary.set(n,{time:this.currentTime,value:o})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[o,a]of this._globalTimelineStyles)this._backFill.set(o,a||ub),this._currentKeyframe.set(o,ub);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,o,a,h){o&&this._previousKeyframe.set("easing",o);const _=h&&h.params||{},w=function mU(i,n){const o=new Map;let a;return i.forEach(h=>{if("*"===h){a=a||n.keys();for(let _ of a)o.set(_,ub)}else fw(h,o)}),o}(n,this._globalTimelineStyles);for(let[S,L]of w){const B=TI(L,_,a);this._pendingStyles.set(S,B),this._localTimelineStyles.has(S)||this._backFill.set(S,this._globalTimelineStyles.get(S)??ub),this._updateStyle(S,B)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,o)=>{this._currentKeyframe.set(o,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,o)=>{this._currentKeyframe.has(o)||this._currentKeyframe.set(o,n)}))}snapshotCurrentStyles(){for(let[n,o]of this._localTimelineStyles)this._pendingStyles.set(n,o),this._updateStyle(n,o)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let o in this._currentKeyframe)n.push(o);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((o,a)=>{const h=this._styleSummary.get(a);(!h||o.time>h.time)&&this._updateStyle(a,o.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,o=new Set,a=1===this._keyframes.size&&0===this.duration;let h=[];this._keyframes.forEach((S,L)=>{const B=fw(S,new Map,this._backFill);B.forEach((H,Y)=>{"!"===H?n.add(Y):H===ub&&o.add(Y)}),a||B.set("offset",L/this.duration),h.push(B)});const _=n.size?QS(n.values()):[],w=o.size?QS(o.values()):[];if(a){const S=h[0],L=new Map(S);S.set("offset",0),L.set("offset",1),h=[S,L]}return VD(this.element,h,_,w,this.duration,this.startTime,this.easing,!1)}}class gU extends oA{constructor(n,o,a,h,_,w,S=!1){super(n,o,w.delay),this.keyframes=a,this.preStyleProps=h,this.postStyleProps=_,this._stretchStartingKeyframe=S,this.timings={duration:w.duration,delay:w.delay,easing:w.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:o,duration:a,easing:h}=this.timings;if(this._stretchStartingKeyframe&&o){const _=[],w=a+o,S=o/w,L=fw(n[0]);L.set("offset",0),_.push(L);const B=fw(n[0]);B.set("offset",h5(S)),_.push(B);const H=n.length-1;for(let Y=1;Y<=H;Y++){let pt=fw(n[Y]);const xt=pt.get("offset");pt.set("offset",h5((o+xt*a)/w)),_.push(pt)}a=w,o=0,h="",n=_}return VD(this.element,n,this.preStyleProps,this.postStyleProps,a,o,h,!0)}}function h5(i,n=3){const o=Math.pow(10,n-1);return Math.round(i*o)/o}class GD{}const _U=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class yU extends GD{normalizePropertyName(n,o){return zD(n)}normalizeStyleValue(n,o,a,h){let _="";const w=a.toString().trim();if(_U.has(o)&&0!==a&&"0"!==a)if("number"==typeof a)_="px";else{const S=a.match(/^[+-]?[\d\.]+([a-z]*)$/);S&&0==S[1].length&&h.push(function hB(i,n){return new x.vHH(3005,!1)}())}return w+_}}function f5(i,n,o,a,h,_,w,S,L,B,H,Y,pt){return{type:0,element:i,triggerName:n,isRemovalTransition:h,fromState:o,fromStyles:_,toState:a,toStyles:w,timelines:S,queriedElements:L,preStyleProps:B,postStyleProps:H,totalTime:Y,errors:pt}}const HD={};class p5{constructor(n,o,a){this._triggerName=n,this.ast=o,this._stateStyles=a}match(n,o,a,h){return function vU(i,n,o,a,h){return i.some(_=>_(n,o,a,h))}(this.ast.matchers,n,o,a,h)}buildStyles(n,o,a){let h=this._stateStyles.get("*");return void 0!==n&&(h=this._stateStyles.get(n?.toString())||h),h?h.buildStyles(o,a):new Map}build(n,o,a,h,_,w,S,L,B,H){const Y=[],pt=this.ast.options&&this.ast.options.params||HD,At=this.buildStyles(a,S&&S.params||HD,Y),Ut=L&&L.params||HD,Zt=this.buildStyles(h,Ut,Y),qe=new Set,fn=new Map,$e=new Map,cn="void"===h,Mr={params:bU(Ut,pt),delay:this.ast.options?.delay},Cr=H?[]:jD(n,o,this.ast.animation,_,w,At,Zt,Mr,B,Y);let Uo=0;if(Cr.forEach(ou=>{Uo=Math.max(ou.duration+ou.delay,Uo)}),Y.length)return f5(o,this._triggerName,a,h,cn,At,Zt,[],[],fn,$e,Uo,Y);Cr.forEach(ou=>{const hb=ou.element,I5=Uf(fn,hb,new Set);ou.preStyleProps.forEach(JM=>I5.add(JM));const SI=Uf($e,hb,new Set);ou.postStyleProps.forEach(JM=>SI.add(JM)),hb!==o&&qe.add(hb)});const ks=QS(qe.values());return f5(o,this._triggerName,a,h,cn,At,Zt,Cr,ks,fn,$e,Uo)}}function bU(i,n){const o=OI(n);for(const a in i)i.hasOwnProperty(a)&&null!=i[a]&&(o[a]=i[a]);return o}class xU{constructor(n,o,a){this.styles=n,this.defaultParams=o,this.normalizer=a}buildStyles(n,o){const a=new Map,h=OI(this.defaultParams);return Object.keys(n).forEach(_=>{const w=n[_];null!==w&&(h[_]=w)}),this.styles.styles.forEach(_=>{"string"!=typeof _&&_.forEach((w,S)=>{w&&(w=TI(w,h,o));const L=this.normalizer.normalizePropertyName(S,o);w=this.normalizer.normalizeStyleValue(S,L,w,o),a.set(S,w)})}),a}}class CU{constructor(n,o,a){this.name=n,this.ast=o,this._normalizer=a,this.transitionFactories=[],this.states=new Map,o.states.forEach(h=>{this.states.set(h.name,new xU(h.style,h.options&&h.options.params||{},a))}),g5(this.states,"true","1"),g5(this.states,"false","0"),o.transitions.forEach(h=>{this.transitionFactories.push(new p5(n,h,this.states))}),this.fallbackTransition=function MU(i,n,o){return new p5(i,{type:1,animation:{type:2,steps:[],options:null},matchers:[(w,S)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,o,a,h){return this.transitionFactories.find(w=>w.match(n,o,a,h))||null}matchStyles(n,o,a){return this.fallbackTransition.buildStyles(n,o,a)}}function g5(i,n,o){i.has(n)?i.has(o)||i.set(o,i.get(n)):i.has(o)&&i.set(n,i.get(o))}const PU=new nA;class OU{constructor(n,o,a){this.bodyNode=n,this._driver=o,this._normalizer=a,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,o){const a=[],_=BD(this._driver,o,a,[]);if(a.length)throw function SB(i){return new x.vHH(3503,!1)}();this._animations.set(n,_)}_buildPlayer(n,o,a){const h=n.element,_=XR(this._normalizer,n.keyframes,o,a);return this._driver.animate(h,_,n.duration,n.delay,n.easing,[],!0)}create(n,o,a={}){const h=[],_=this._animations.get(n);let w;const S=new Map;if(_?(w=jD(this._driver,o,_,RD,WS,new Map,new Map,a,PU,h),w.forEach(H=>{const Y=Uf(S,H.element,new Map);H.postStyleProps.forEach(pt=>Y.set(pt,null))})):(h.push(function AB(){return new x.vHH(3300,!1)}()),w=[]),h.length)throw function DB(i){return new x.vHH(3504,!1)}();S.forEach((H,Y)=>{H.forEach((pt,xt)=>{H.set(xt,this._driver.computeStyle(Y,xt,ub))})});const B=hw(w.map(H=>{const Y=S.get(H.element);return this._buildPlayer(H,new Map,Y)}));return this._playersById.set(n,B),B.onDestroy(()=>this.destroy(n)),this.players.push(B),B}destroy(n){const o=this._getPlayer(n);o.destroy(),this._playersById.delete(n);const a=this.players.indexOf(o);a>=0&&this.players.splice(a,1)}_getPlayer(n){const o=this._playersById.get(n);if(!o)throw function kB(i){return new x.vHH(3301,!1)}();return o}listen(n,o,a,h){const _=AD(o,"","","");return ID(this._getPlayer(n),a,_,h),()=>{}}command(n,o,a,h){if("register"==a)return void this.register(n,h[0]);if("create"==a)return void this.create(n,o,h[0]||{});const _=this._getPlayer(n);switch(a){case"play":_.play();break;case"pause":_.pause();break;case"reset":_.reset();break;case"restart":_.restart();break;case"finish":_.finish();break;case"init":_.init();break;case"setPosition":_.setPosition(parseFloat(h[0]));break;case"destroy":this.destroy(n)}}}const m5="ng-animate-queued",qD="ng-animate-disabled",AU=[],_5={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},DU={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Bm="__ng_removed";class ZD{get params(){return this.options.params}constructor(n,o=""){this.namespaceId=o;const a=n&&n.hasOwnProperty("value");if(this.value=function NU(i){return i??null}(a?n.value:n),a){const _=OI(n);delete _.value,this.options=_}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const o=n.params;if(o){const a=this.options.params;Object.keys(o).forEach(h=>{null==a[h]&&(a[h]=o[h])})}}}const II="void",WD=new ZD(II);class kU{constructor(n,o,a){this.id=n,this.hostElement=o,this._engine=a,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,sg(o,this._hostClassName)}listen(n,o,a,h){if(!this._triggers.has(o))throw function RB(i,n){return new x.vHH(3302,!1)}();if(null==a||0==a.length)throw function LB(i){return new x.vHH(3303,!1)}();if(!function FU(i){return"start"==i||"done"==i}(a))throw function NB(i,n){return new x.vHH(3400,!1)}();const _=Uf(this._elementListeners,n,[]),w={name:o,phase:a,callback:h};_.push(w);const S=Uf(this._engine.statesByElement,n,new Map);return S.has(o)||(sg(n,KS),sg(n,KS+"-"+o),S.set(o,WD)),()=>{this._engine.afterFlush(()=>{const L=_.indexOf(w);L>=0&&_.splice(L,1),this._triggers.has(o)||S.delete(o)})}}register(n,o){return!this._triggers.has(n)&&(this._triggers.set(n,o),!0)}_getTrigger(n){const o=this._triggers.get(n);if(!o)throw function FB(i){return new x.vHH(3401,!1)}();return o}trigger(n,o,a,h=!0){const _=this._getTrigger(o),w=new KD(this.id,o,n);let S=this._engine.statesByElement.get(n);S||(sg(n,KS),sg(n,KS+"-"+o),this._engine.statesByElement.set(n,S=new Map));let L=S.get(o);const B=new ZD(a,this.id);if(!(a&&a.hasOwnProperty("value"))&&L&&B.absorbOptions(L.options),S.set(o,B),L||(L=WD),B.value!==II&&L.value===B.value){if(!function UU(i,n){const o=Object.keys(i),a=Object.keys(n);if(o.length!=a.length)return!1;for(let h=0;h<o.length;h++){const _=o[h];if(!n.hasOwnProperty(_)||i[_]!==n[_])return!1}return!0}(L.params,B.params)){const Ut=[],Zt=_.matchStyles(L.value,L.params,Ut),qe=_.matchStyles(B.value,B.params,Ut);Ut.length?this._engine.reportError(Ut):this._engine.afterFlush(()=>{XM(n,Zt),$y(n,qe)})}return}const pt=Uf(this._engine.playersByElement,n,[]);pt.forEach(Ut=>{Ut.namespaceId==this.id&&Ut.triggerName==o&&Ut.queued&&Ut.destroy()});let xt=_.matchTransition(L.value,B.value,n,B.params),At=!1;if(!xt){if(!h)return;xt=_.fallbackTransition,At=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:o,transition:xt,fromState:L,toState:B,player:w,isFallbackTransition:At}),At||(sg(n,m5),w.onStart(()=>{pT(n,m5)})),w.onDone(()=>{let Ut=this.players.indexOf(w);Ut>=0&&this.players.splice(Ut,1);const Zt=this._engine.playersByElement.get(n);if(Zt){let qe=Zt.indexOf(w);qe>=0&&Zt.splice(qe,1)}}),this.players.push(w),pt.push(w),w}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(o=>o.delete(n)),this._elementListeners.forEach((o,a)=>{this._elementListeners.set(a,o.filter(h=>h.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const o=this._engine.playersByElement.get(n);o&&(o.forEach(a=>a.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,o){const a=this._engine.driver.query(n,YS,!0);a.forEach(h=>{if(h[Bm])return;const _=this._engine.fetchNamespacesByElement(h);_.size?_.forEach(w=>w.triggerLeaveAnimation(h,o,!1,!0)):this.clearElementCache(h)}),this._engine.afterFlushAnimationsDone(()=>a.forEach(h=>this.clearElementCache(h)))}triggerLeaveAnimation(n,o,a,h){const _=this._engine.statesByElement.get(n),w=new Map;if(_){const S=[];if(_.forEach((L,B)=>{if(w.set(B,L.value),this._triggers.has(B)){const H=this.trigger(n,B,II,h);H&&S.push(H)}}),S.length)return this._engine.markElementAsRemoved(this.id,n,!0,o,w),a&&hw(S).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const o=this._elementListeners.get(n),a=this._engine.statesByElement.get(n);if(o&&a){const h=new Set;o.forEach(_=>{const w=_.name;if(h.has(w))return;h.add(w);const L=this._triggers.get(w).fallbackTransition,B=a.get(w)||WD,H=new ZD(II),Y=new KD(this.id,w,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:w,transition:L,fromState:B,toState:H,player:Y,isFallbackTransition:!0})})}}removeNode(n,o){const a=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,o),this.triggerLeaveAnimation(n,o,!0))return;let h=!1;if(a.totalAnimations){const _=a.players.length?a.playersByQueriedElement.get(n):[];if(_&&_.length)h=!0;else{let w=n;for(;w=w.parentNode;)if(a.statesByElement.get(w)){h=!0;break}}}if(this.prepareLeaveAnimationListeners(n),h)a.markElementAsRemoved(this.id,n,!1,o);else{const _=n[Bm];(!_||_===_5)&&(a.afterFlush(()=>this.clearElementCache(n)),a.destroyInnerAnimations(n),a._onRemovalComplete(n,o))}}insertNode(n,o){sg(n,this._hostClassName)}drainQueuedTransitions(n){const o=[];return this._queue.forEach(a=>{const h=a.player;if(h.destroyed)return;const _=a.element,w=this._elementListeners.get(_);w&&w.forEach(S=>{if(S.name==a.triggerName){const L=AD(_,a.triggerName,a.fromState.value,a.toState.value);L._data=n,ID(a.player,S.phase,L,S.callback)}}),h.markedForDestroy?this._engine.afterFlush(()=>{h.destroy()}):o.push(a)}),this._queue=[],o.sort((a,h)=>{const _=a.transition.ast.depCount,w=h.transition.ast.depCount;return 0==_||0==w?_-w:this._engine.driver.containsElement(a.element,h.element)?1:-1})}destroy(n){this.players.forEach(o=>o.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class RU{_onRemovalComplete(n,o){this.onRemovalComplete(n,o)}constructor(n,o,a){this.bodyNode=n,this.driver=o,this._normalizer=a,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(h,_)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(o=>{o.players.forEach(a=>{a.queued&&n.push(a)})}),n}createNamespace(n,o){const a=new kU(n,o,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,o)?this._balanceNamespaceList(a,o):(this.newHostElements.set(o,a),this.collectEnterElement(o)),this._namespaceLookup[n]=a}_balanceNamespaceList(n,o){const a=this._namespaceList,h=this.namespacesByHostElement;if(a.length-1>=0){let w=!1,S=this.driver.getParentElement(o);for(;S;){const L=h.get(S);if(L){const B=a.indexOf(L);a.splice(B+1,0,n),w=!0;break}S=this.driver.getParentElement(S)}w||a.unshift(n)}else a.push(n);return h.set(o,n),n}register(n,o){let a=this._namespaceLookup[n];return a||(a=this.createNamespace(n,o)),a}registerTrigger(n,o,a){let h=this._namespaceLookup[n];h&&h.register(o,a)&&this.totalAnimations++}destroy(n,o){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const a=this._fetchNamespace(n);this.namespacesByHostElement.delete(a.hostElement);const h=this._namespaceList.indexOf(a);h>=0&&this._namespaceList.splice(h,1),a.destroy(o),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const o=new Set,a=this.statesByElement.get(n);if(a)for(let h of a.values())if(h.namespaceId){const _=this._fetchNamespace(h.namespaceId);_&&o.add(_)}return o}trigger(n,o,a,h){if(iA(o)){const _=this._fetchNamespace(n);if(_)return _.trigger(o,a,h),!0}return!1}insertNode(n,o,a,h){if(!iA(o))return;const _=o[Bm];if(_&&_.setForRemoval){_.setForRemoval=!1,_.setForMove=!0;const w=this.collectedLeaveElements.indexOf(o);w>=0&&this.collectedLeaveElements.splice(w,1)}if(n){const w=this._fetchNamespace(n);w&&w.insertNode(o,a)}h&&this.collectEnterElement(o)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,o){o?this.disabledNodes.has(n)||(this.disabledNodes.add(n),sg(n,qD)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),pT(n,qD))}removeNode(n,o,a){if(iA(o)){const h=n?this._fetchNamespace(n):null;h?h.removeNode(o,a):this.markElementAsRemoved(n,o,!1,a);const _=this.namespacesByHostElement.get(o);_&&_.id!==n&&_.removeNode(o,a)}else this._onRemovalComplete(o,a)}markElementAsRemoved(n,o,a,h,_){this.collectedLeaveElements.push(o),o[Bm]={namespaceId:n,setForRemoval:h,hasAnimation:a,removedBeforeQueried:!1,previousTriggersValues:_}}listen(n,o,a,h,_){return iA(o)?this._fetchNamespace(n).listen(o,a,h,_):()=>{}}_buildInstruction(n,o,a,h,_){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,a,h,n.fromState.options,n.toState.options,o,_)}destroyInnerAnimations(n){let o=this.driver.query(n,YS,!0);o.forEach(a=>this.destroyActiveAnimationsForElement(a)),0!=this.playersByQueriedElement.size&&(o=this.driver.query(n,LD,!0),o.forEach(a=>this.finishActiveQueriedAnimationOnElement(a)))}destroyActiveAnimationsForElement(n){const o=this.playersByElement.get(n);o&&o.forEach(a=>{a.queued?a.markedForDestroy=!0:a.destroy()})}finishActiveQueriedAnimationOnElement(n){const o=this.playersByQueriedElement.get(n);o&&o.forEach(a=>a.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return hw(this.players).onDone(()=>n());n()})}processLeaveNode(n){const o=n[Bm];if(o&&o.setForRemoval){if(n[Bm]=_5,o.namespaceId){this.destroyInnerAnimations(n);const a=this._fetchNamespace(o.namespaceId);a&&a.clearElementCache(n)}this._onRemovalComplete(n,o.setForRemoval)}n.classList?.contains(qD)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(a=>{this.markElementAsDisabled(a,!1)})}flush(n=-1){let o=[];if(this.newHostElements.size&&(this.newHostElements.forEach((a,h)=>this._balanceNamespaceList(a,h)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let a=0;a<this.collectedEnterElements.length;a++)sg(this.collectedEnterElements[a],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const a=[];try{o=this._flushAnimations(a,n)}finally{for(let h=0;h<a.length;h++)a[h]()}}else for(let a=0;a<this.collectedLeaveElements.length;a++)this.processLeaveNode(this.collectedLeaveElements[a]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(a=>a()),this._flushFns=[],this._whenQuietFns.length){const a=this._whenQuietFns;this._whenQuietFns=[],o.length?hw(o).onDone(()=>{a.forEach(h=>h())}):a.forEach(h=>h())}}reportError(n){throw function zB(i){return new x.vHH(3402,!1)}()}_flushAnimations(n,o){const a=new nA,h=[],_=new Map,w=[],S=new Map,L=new Map,B=new Map,H=new Set;this.disabledNodes.forEach(Qn=>{H.add(Qn);const Or=this.driver.query(Qn,".ng-animate-queued",!0);for(let jr=0;jr<Or.length;jr++)H.add(Or[jr])});const Y=this.bodyNode,pt=Array.from(this.statesByElement.keys()),xt=b5(pt,this.collectedEnterElements),At=new Map;let Ut=0;xt.forEach((Qn,Or)=>{const jr=RD+Ut++;At.set(Or,jr),Qn.forEach(ni=>sg(ni,jr))});const Zt=[],qe=new Set,fn=new Set;for(let Qn=0;Qn<this.collectedLeaveElements.length;Qn++){const Or=this.collectedLeaveElements[Qn],jr=Or[Bm];jr&&jr.setForRemoval&&(Zt.push(Or),qe.add(Or),jr.hasAnimation?this.driver.query(Or,".ng-star-inserted",!0).forEach(ni=>qe.add(ni)):fn.add(Or))}const $e=new Map,cn=b5(pt,Array.from(qe));cn.forEach((Qn,Or)=>{const jr=WS+Ut++;$e.set(Or,jr),Qn.forEach(ni=>sg(ni,jr))}),n.push(()=>{xt.forEach((Qn,Or)=>{const jr=At.get(Or);Qn.forEach(ni=>pT(ni,jr))}),cn.forEach((Qn,Or)=>{const jr=$e.get(Or);Qn.forEach(ni=>pT(ni,jr))}),Zt.forEach(Qn=>{this.processLeaveNode(Qn)})});const Mr=[],Cr=[];for(let Qn=this._namespaceList.length-1;Qn>=0;Qn--)this._namespaceList[Qn].drainQueuedTransitions(o).forEach(jr=>{const ni=jr.player,Fl=jr.element;if(Mr.push(ni),this.collectedEnterElements.length){const iu=Fl[Bm];if(iu&&iu.setForMove){if(iu.previousTriggersValues&&iu.previousTriggersValues.has(jr.triggerName)){const tP=iu.previousTriggersValues.get(jr.triggerName),ag=this.statesByElement.get(jr.element);if(ag&&ag.has(jr.triggerName)){const lA=ag.get(jr.triggerName);lA.value=tP,ag.set(jr.triggerName,lA)}}return void ni.destroy()}}const Gy=!Y||!this.driver.containsElement(Y,Fl),jf=$e.get(Fl),pw=At.get(Fl),Hs=this._buildInstruction(jr,a,pw,jf,Gy);if(Hs.errors&&Hs.errors.length)return void Cr.push(Hs);if(Gy)return ni.onStart(()=>XM(Fl,Hs.fromStyles)),ni.onDestroy(()=>$y(Fl,Hs.toStyles)),void h.push(ni);if(jr.isFallbackTransition)return ni.onStart(()=>XM(Fl,Hs.fromStyles)),ni.onDestroy(()=>$y(Fl,Hs.toStyles)),void h.push(ni);const D5=[];Hs.timelines.forEach(iu=>{iu.stretchStartingKeyframe=!0,this.disabledNodes.has(iu.element)||D5.push(iu)}),Hs.timelines=D5,a.append(Fl,Hs.timelines),w.push({instruction:Hs,player:ni,element:Fl}),Hs.queriedElements.forEach(iu=>Uf(S,iu,[]).push(ni)),Hs.preStyleProps.forEach((iu,tP)=>{if(iu.size){let ag=L.get(tP);ag||L.set(tP,ag=new Set),iu.forEach((lA,QD)=>ag.add(QD))}}),Hs.postStyleProps.forEach((iu,tP)=>{let ag=B.get(tP);ag||B.set(tP,ag=new Set),iu.forEach((lA,QD)=>ag.add(QD))})});if(Cr.length){const Qn=[];Cr.forEach(Or=>{Qn.push(function BB(i,n){return new x.vHH(3505,!1)}())}),Mr.forEach(Or=>Or.destroy()),this.reportError(Qn)}const Uo=new Map,ks=new Map;w.forEach(Qn=>{const Or=Qn.element;a.has(Or)&&(ks.set(Or,Or),this._beforeAnimationBuild(Qn.player.namespaceId,Qn.instruction,Uo))}),h.forEach(Qn=>{const Or=Qn.element;this._getPreviousPlayers(Or,!1,Qn.namespaceId,Qn.triggerName,null).forEach(ni=>{Uf(Uo,Or,[]).push(ni),ni.destroy()})});const ou=Zt.filter(Qn=>w5(Qn,L,B)),hb=new Map;v5(hb,this.driver,fn,B,ub).forEach(Qn=>{w5(Qn,L,B)&&ou.push(Qn)});const SI=new Map;xt.forEach((Qn,Or)=>{v5(SI,this.driver,new Set(Qn),L,"!")}),ou.forEach(Qn=>{const Or=hb.get(Qn),jr=SI.get(Qn);hb.set(Qn,new Map([...Or?.entries()??[],...jr?.entries()??[]]))});const JM=[],S5=[],A5={};w.forEach(Qn=>{const{element:Or,player:jr,instruction:ni}=Qn;if(a.has(Or)){if(H.has(Or))return jr.onDestroy(()=>$y(Or,ni.toStyles)),jr.disabled=!0,jr.overrideTotalTime(ni.totalTime),void h.push(jr);let Fl=A5;if(ks.size>1){let jf=Or;const pw=[];for(;jf=jf.parentNode;){const Hs=ks.get(jf);if(Hs){Fl=Hs;break}pw.push(jf)}pw.forEach(Hs=>ks.set(Hs,Fl))}const Gy=this._buildAnimation(jr.namespaceId,ni,Uo,_,SI,hb);if(jr.setRealPlayer(Gy),Fl===A5)JM.push(jr);else{const jf=this.playersByElement.get(Fl);jf&&jf.length&&(jr.parentPlayer=hw(jf)),h.push(jr)}}else XM(Or,ni.fromStyles),jr.onDestroy(()=>$y(Or,ni.toStyles)),S5.push(jr),H.has(Or)&&h.push(jr)}),S5.forEach(Qn=>{const Or=_.get(Qn.element);if(Or&&Or.length){const jr=hw(Or);Qn.setRealPlayer(jr)}}),h.forEach(Qn=>{Qn.parentPlayer?Qn.syncPlayerEvents(Qn.parentPlayer):Qn.destroy()});for(let Qn=0;Qn<Zt.length;Qn++){const Or=Zt[Qn],jr=Or[Bm];if(pT(Or,WS),jr&&jr.hasAnimation)continue;let ni=[];if(S.size){let Gy=S.get(Or);Gy&&Gy.length&&ni.push(...Gy);let jf=this.driver.query(Or,LD,!0);for(let pw=0;pw<jf.length;pw++){let Hs=S.get(jf[pw]);Hs&&Hs.length&&ni.push(...Hs)}}const Fl=ni.filter(Gy=>!Gy.destroyed);Fl.length?zU(this,Or,Fl):this.processLeaveNode(Or)}return Zt.length=0,JM.forEach(Qn=>{this.players.push(Qn),Qn.onDone(()=>{Qn.destroy();const Or=this.players.indexOf(Qn);this.players.splice(Or,1)}),Qn.play()}),JM}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,o,a,h,_){let w=[];if(o){const S=this.playersByQueriedElement.get(n);S&&(w=S)}else{const S=this.playersByElement.get(n);if(S){const L=!_||_==II;S.forEach(B=>{B.queued||!L&&B.triggerName!=h||w.push(B)})}}return(a||h)&&(w=w.filter(S=>!(a&&a!=S.namespaceId||h&&h!=S.triggerName))),w}_beforeAnimationBuild(n,o,a){const _=o.element,w=o.isRemovalTransition?void 0:n,S=o.isRemovalTransition?void 0:o.triggerName;for(const L of o.timelines){const B=L.element,H=B!==_,Y=Uf(a,B,[]);this._getPreviousPlayers(B,H,w,S,o.toState).forEach(xt=>{const At=xt.getRealPlayer();At.beforeDestroy&&At.beforeDestroy(),xt.destroy(),Y.push(xt)})}XM(_,o.fromStyles)}_buildAnimation(n,o,a,h,_,w){const S=o.triggerName,L=o.element,B=[],H=new Set,Y=new Set,pt=o.timelines.map(At=>{const Ut=At.element;H.add(Ut);const Zt=Ut[Bm];if(Zt&&Zt.removedBeforeQueried)return new PI(At.duration,At.delay);const qe=Ut!==L,fn=function BU(i){const n=[];return x5(i,n),n}((a.get(Ut)||AU).map(Uo=>Uo.getRealPlayer())).filter(Uo=>!!Uo.element&&Uo.element===Ut),$e=_.get(Ut),cn=w.get(Ut),Mr=XR(this._normalizer,At.keyframes,$e,cn),Cr=this._buildPlayer(At,Mr,fn);if(At.subTimeline&&h&&Y.add(Ut),qe){const Uo=new KD(n,S,Ut);Uo.setRealPlayer(Cr),B.push(Uo)}return Cr});B.forEach(At=>{Uf(this.playersByQueriedElement,At.element,[]).push(At),At.onDone(()=>function LU(i,n,o){let a=i.get(n);if(a){if(a.length){const h=a.indexOf(o);a.splice(h,1)}0==a.length&&i.delete(n)}return a}(this.playersByQueriedElement,At.element,At))}),H.forEach(At=>sg(At,o5));const xt=hw(pt);return xt.onDestroy(()=>{H.forEach(At=>pT(At,o5)),$y(L,o.toStyles)}),Y.forEach(At=>{Uf(h,At,[]).push(xt)}),xt}_buildPlayer(n,o,a){return o.length>0?this.driver.animate(n.element,o,n.duration,n.delay,n.easing,a):new PI(n.duration,n.delay)}}class KD{constructor(n,o,a){this.namespaceId=n,this.triggerName=o,this.element=a,this._player=new PI,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((o,a)=>{o.forEach(h=>ID(n,a,void 0,h))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const o=this._player;o.triggerCallback&&n.onStart(()=>o.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,o){Uf(this._queuedCallbacks,n,[]).push(o)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const o=this._player;o.triggerCallback&&o.triggerCallback(n)}}function iA(i){return i&&1===i.nodeType}function y5(i,n){const o=i.style.display;return i.style.display=n??"none",o}function v5(i,n,o,a,h){const _=[];o.forEach(L=>_.push(y5(L)));const w=[];a.forEach((L,B)=>{const H=new Map;L.forEach(Y=>{const pt=n.computeStyle(B,Y,h);H.set(Y,pt),(!pt||0==pt.length)&&(B[Bm]=DU,w.push(B))}),i.set(B,H)});let S=0;return o.forEach(L=>y5(L,_[S++])),w}function b5(i,n){const o=new Map;if(i.forEach(S=>o.set(S,[])),0==n.length)return o;const h=new Set(n),_=new Map;function w(S){if(!S)return 1;let L=_.get(S);if(L)return L;const B=S.parentNode;return L=o.has(B)?B:h.has(B)?1:w(B),_.set(S,L),L}return n.forEach(S=>{const L=w(S);1!==L&&o.get(L).push(S)}),o}function sg(i,n){i.classList?.add(n)}function pT(i,n){i.classList?.remove(n)}function zU(i,n,o){hw(o).onDone(()=>i.processLeaveNode(n))}function x5(i,n){for(let o=0;o<i.length;o++){const a=i[o];a instanceof KR?x5(a.players,n):n.push(a)}}function w5(i,n,o){const a=o.get(i);if(!a)return!1;let h=n.get(i);return h?a.forEach(_=>h.add(_)):n.set(i,a),o.delete(i),!0}class sA{constructor(n,o,a){this.bodyNode=n,this._driver=o,this._normalizer=a,this._triggerCache={},this.onRemovalComplete=(h,_)=>{},this._transitionEngine=new RU(n,o,a),this._timelineEngine=new OU(n,o,a),this._transitionEngine.onRemovalComplete=(h,_)=>this.onRemovalComplete(h,_)}registerTrigger(n,o,a,h,_){const w=n+"-"+h;let S=this._triggerCache[w];if(!S){const L=[],H=BD(this._driver,_,L,[]);if(L.length)throw function TB(i,n){return new x.vHH(3404,!1)}();S=function wU(i,n,o){return new CU(i,n,o)}(h,H,this._normalizer),this._triggerCache[w]=S}this._transitionEngine.registerTrigger(o,h,S)}register(n,o){this._transitionEngine.register(n,o)}destroy(n,o){this._transitionEngine.destroy(n,o)}onInsert(n,o,a,h){this._transitionEngine.insertNode(n,o,a,h)}onRemove(n,o,a){this._transitionEngine.removeNode(n,o,a)}disableAnimations(n,o){this._transitionEngine.markElementAsDisabled(n,o)}process(n,o,a,h){if("@"==a.charAt(0)){const[_,w]=QR(a);this._timelineEngine.command(_,o,w,h)}else this._transitionEngine.trigger(n,o,a,h)}listen(n,o,a,h,_){if("@"==a.charAt(0)){const[w,S]=QR(a);return this._timelineEngine.listen(w,o,S,_)}return this._transitionEngine.listen(n,o,a,h,_)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}let jU=(()=>{class i{static#t=this.initialStylesByElement=new WeakMap;constructor(o,a,h){this._element=o,this._startStyles=a,this._endStyles=h,this._state=0;let _=i.initialStylesByElement.get(o);_||i.initialStylesByElement.set(o,_=new Map),this._initialStyles=_}start(){this._state<1&&(this._startStyles&&$y(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&($y(this._element,this._initialStyles),this._endStyles&&($y(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(i.initialStylesByElement.delete(this._element),this._startStyles&&(XM(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(XM(this._element,this._endStyles),this._endStyles=null),$y(this._element,this._initialStyles),this._state=3)}}return i})();function YD(i){let n=null;return i.forEach((o,a)=>{(function $U(i){return"display"===i||"position"===i})(a)&&(n=n||new Map,n.set(a,o))}),n}class C5{constructor(n,o,a,h){this.element=n,this.keyframes=o,this.options=a,this._specialStyles=h,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=a.duration,this._delay=a.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map;const o=()=>this._onFinish();this.domPlayer.addEventListener("finish",o),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",o)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const o=[];return n.forEach(a=>{o.push(Object.fromEntries(a))}),o}_triggerWebAnimation(n,o,a){return n.animate(this._convertKeyframesToObject(o),a)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((a,h)=>{"offset"!==h&&n.set(h,this._finished?a:l5(this.element,h))}),this.currentSnapshot=n}triggerCallback(n){const o="start"===n?this._onStartFns:this._onDoneFns;o.forEach(a=>a()),o.length=0}}class GU{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,o){return!1}containsElement(n,o){return t5(n,o)}getParentElement(n){return DD(n)}query(n,o,a){return e5(n,o,a)}computeStyle(n,o,a){return window.getComputedStyle(n)[o]}animate(n,o,a,h,_,w=[]){const L={duration:a,delay:h,fill:0==h?"both":"forwards"};_&&(L.easing=_);const B=new Map,H=w.filter(xt=>xt instanceof C5);(function XB(i,n){return 0===i||0===n})(a,h)&&H.forEach(xt=>{xt.currentSnapshot.forEach((At,Ut)=>B.set(Ut,At))});let Y=function WB(i){return i.length?i[0]instanceof Map?i:i.map(n=>i5(n)):[]}(o).map(xt=>fw(xt));Y=function QB(i,n,o){if(o.size&&n.length){let a=n[0],h=[];if(o.forEach((_,w)=>{a.has(w)||h.push(w),a.set(w,_)}),h.length)for(let _=1;_<n.length;_++){let w=n[_];h.forEach(S=>w.set(S,l5(i,S)))}}return n}(n,Y,B);const pt=function VU(i,n){let o=null,a=null;return Array.isArray(n)&&n.length?(o=YD(n[0]),n.length>1&&(a=YD(n[n.length-1]))):n instanceof Map&&(o=YD(n)),o||a?new jU(i,o,a):null}(n,Y);return new C5(n,Y,L,pt)}}let HU=(()=>{class i extends qR{constructor(o,a){super(),this._nextAnimationId=0,this._renderer=o.createRenderer(a.body,{id:"0",encapsulation:x.ifc.None,styles:[],data:{animation:[]}})}build(o){const a=this._nextAnimationId.toString();this._nextAnimationId++;const h=Array.isArray(o)?ZR(o):o;return M5(this._renderer,null,a,"register",[h]),new qU(a,this._renderer)}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(x.FYo),x.LFG(ye))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();class qU extends sB{constructor(n,o){super(),this._id=n,this._renderer=o}create(n,o){return new ZU(this._id,n,o||{},this._renderer)}}class ZU{constructor(n,o,a,h){this.id=n,this.element=o,this._renderer=h,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",a)}_listen(n,o){return this._renderer.listen(this.element,`@@${this.id}:${n}`,o)}_command(n,...o){return M5(this._renderer,this.element,this.id,n,o)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function M5(i,n,o,a,h){return i.setProperty(n,`@@${o}:${a}`,h)}const P5="@.disabled";let WU=(()=>{class i{constructor(o,a,h){this.delegate=o,this.engine=a,this._zone=h,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,a.onRemovalComplete=(_,w)=>{const S=w?.parentNode(_);S&&w.removeChild(S,_)}}createRenderer(o,a){const _=this.delegate.createRenderer(o,a);if(!(o&&a&&a.data&&a.data.animation)){let H=this._rendererCache.get(_);return H||(H=new O5("",_,this.engine,()=>this._rendererCache.delete(_)),this._rendererCache.set(_,H)),H}const w=a.id,S=a.id+"-"+this._currentId;this._currentId++,this.engine.register(S,o);const L=H=>{Array.isArray(H)?H.forEach(L):this.engine.registerTrigger(w,S,o,H.name,H)};return a.data.animation.forEach(L),new KU(this,S,_,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(o,a,h){o>=0&&o<this._microtaskId?this._zone.run(()=>a(h)):(0==this._animationCallbacksBuffer.length&&queueMicrotask(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(_=>{const[w,S]=_;w(S)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([a,h]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(x.FYo),x.LFG(sA),x.LFG(x.R0b))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();class O5{constructor(n,o,a,h){this.namespaceId=n,this.delegate=o,this.engine=a,this._onDestroy=h}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,o){return this.delegate.createElement(n,o)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,o){this.delegate.appendChild(n,o),this.engine.onInsert(this.namespaceId,o,n,!1)}insertBefore(n,o,a,h=!0){this.delegate.insertBefore(n,o,a),this.engine.onInsert(this.namespaceId,o,n,h)}removeChild(n,o,a){this.engine.onRemove(this.namespaceId,o,this.delegate)}selectRootElement(n,o){return this.delegate.selectRootElement(n,o)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,o,a,h){this.delegate.setAttribute(n,o,a,h)}removeAttribute(n,o,a){this.delegate.removeAttribute(n,o,a)}addClass(n,o){this.delegate.addClass(n,o)}removeClass(n,o){this.delegate.removeClass(n,o)}setStyle(n,o,a,h){this.delegate.setStyle(n,o,a,h)}removeStyle(n,o,a){this.delegate.removeStyle(n,o,a)}setProperty(n,o,a){"@"==o.charAt(0)&&o==P5?this.disableAnimations(n,!!a):this.delegate.setProperty(n,o,a)}setValue(n,o){this.delegate.setValue(n,o)}listen(n,o,a){return this.delegate.listen(n,o,a)}disableAnimations(n,o){this.engine.disableAnimations(n,o)}}class KU extends O5{constructor(n,o,a,h,_){super(o,a,h,_),this.factory=n,this.namespaceId=o}setProperty(n,o,a){"@"==o.charAt(0)?"."==o.charAt(1)&&o==P5?this.disableAnimations(n,a=void 0===a||!!a):this.engine.process(this.namespaceId,n,o.slice(1),a):this.delegate.setProperty(n,o,a)}listen(n,o,a){if("@"==o.charAt(0)){const h=function YU(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}(n);let _=o.slice(1),w="";return"@"!=_.charAt(0)&&([_,w]=function XU(i){const n=i.indexOf(".");return[i.substring(0,n),i.slice(n+1)]}(_)),this.engine.listen(this.namespaceId,h,_,w,S=>{this.factory.scheduleListenerCallback(S._data||-1,a,S)})}return this.delegate.listen(n,o,a)}}let QU=(()=>{class i extends sA{constructor(o,a,h,_){super(o.body,a,h)}ngOnDestroy(){this.flush()}static#t=this.\u0275fac=function(a){return new(a||i)(x.LFG(ye),x.LFG(kD),x.LFG(GD),x.LFG(x.z2F))};static#e=this.\u0275prov=x.Yz7({token:i,factory:i.\u0275fac})}return i})();const E5=[{provide:qR,useClass:HU},{provide:GD,useFactory:function JU(){return new yU}},{provide:sA,useClass:QU},{provide:x.FYo,useFactory:function tV(i,n,o){return new WU(i,n,o)},deps:[Ah,sA,x.R0b]}],XD=[{provide:kD,useFactory:()=>new GU},{provide:x.QbO,useValue:"BrowserAnimations"},...E5],T5=[{provide:kD,useClass:n5},{provide:x.QbO,useValue:"NoopAnimations"},...E5];let eV=(()=>{class i{static withConfig(o){return{ngModule:i,providers:o.disableAnimations?T5:XD}}static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=x.oAB({type:i});static#n=this.\u0275inj=x.cJS({providers:XD,imports:[wu]})}return i})(),nV=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=x.oAB({type:i,bootstrap:[rB]});static#n=this.\u0275inj=x.cJS({imports:[wu,nB,Nk,oB,iB,jL,Fk,xg(()=>wl(vI_firebase)),Mi(()=>iP()),kM(()=>l()),Pa.hO.initializeApp(vI_firebase),eV]})}return i})();if(lR().accessToken="pk.eyJ1IjoibmFodW1sb3B6IiwiYSI6ImNsc3k2eGRlejBhYXIycm54YmxnaXlneTkifQ.wrnk_DcsIDYJ6a8OQSeE5Q",!navigator.geolocation)throw alert("Navegador no soporta el Geolocation"),new Error("Navegador no soporta el Geolocation");Ni().bootstrapModule(nV).catch(i=>console.error(i))},2574:function(Hn){Hn.exports=function(){"use strict";var we,ft,x;function mt(vt,lt){if(we)if(ft){var ye="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+we+")(sharedChunk); ("+ft+")(sharedChunk); self.onerror = null;",ke={};we(ke),x=lt(ke),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(x.workerUrl=window.URL.createObjectURL(new Blob([ye],{type:"text/javascript"})))}else ft=lt;else we=lt}return mt(0,function(vt){var lt=typeof self<"u"?self:{},ye="3.1.2";let ke;const ue={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==ke){const e=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{ke=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):e}catch{ke=e}}return ke},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ue.API_URL)return null;try{const e=new URL(ue.API_URL);return"api.mapbox.cn"===e.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===e.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},be={supported:!1,testSupport:function(e){!Yt&&Ot&&(Le?re(e):Pt=e)}};let Pt,Ot,Yt=!1,Le=!1;function re(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,Ot),e.isContextLost())return;be.supported=!0}catch{}e.deleteTexture(t),Yt=!0}lt.document&&(Ot=lt.document.createElement("img"),Ot.onload=function(){Pt&&re(Pt),Pt=null,Le=!0},Ot.onerror=function(){Yt=!0,Pt=null},Ot.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const tn="01";function We(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rn=Te;function Te(e,t,r,s){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(s-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=s}Te.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,s=0;s<8;s++){var c=this.sampleCurveX(r)-e;if(Math.abs(c)<t)return r;var d=this.sampleCurveDerivativeX(r);if(Math.abs(d)<1e-6)break;r-=c/d}var f=0,g=1;for(r=e,s=0;s<20&&(c=this.sampleCurveX(r),!(Math.abs(c-e)<t));s++)e>c?f=r:g=r,r=.5*(g-f)+f;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var Fn=We(rn),Ce=me;function me(e,t){this.x=e,this.y=t}me.prototype={clone:function(){return new me(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),s=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=s,this},_rotateAround:function(e,t){var r=Math.cos(e),s=Math.sin(e),c=t.y+s*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-s*(this.y-t.y),this.y=c,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},me.convert=function(e){return e instanceof me?e:Array.isArray(e)?new me(e[0],e[1]):e};var tt=We(Ce);function Xt(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!Xt(e[r],t[r]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!Xt(e[r],t[r]))return!1;return!0}return e===t}const Ve=Math.PI/180,Gt=180/Math.PI;function Ct(e){return e*Ve}function ge(e){return e*Gt}const en=[[0,0],[1,0],[1,1],[0,1]];function Vo(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function cs(e){let t=1/0,r=1/0,s=-1/0,c=-1/0;for(const d of e)t=Math.min(t,d.x),r=Math.min(r,d.y),s=Math.max(s,d.x),c=Math.max(c,d.y);return{min:new tt(t,r),max:new tt(s,c)}}function Gi(e,t,r=0,s=!0){const c=new tt(r,r),d=e.sub(c),f=t.add(c),g=[d,new tt(f.x,d.y),f,new tt(d.x,f.y)];return s&&g.push(d.clone()),g}function us(e,t,r,s){const c=new Fn(e,t,r,s);return function(d){return c.solve(d)}}const Yr=us(.25,.1,.25,1);function Ne(e,t,r){return Math.min(r,Math.max(t,e))}function vs(e,t,r){return(r=Ne((r-e)/(t-e),0,1))*r*(3-2*r)}function Wt(e,t,r){const s=r-t,c=((e-t)%s+s)%s+t;return c===t?r:c}function Kt(e,t,r){if(!e.length)return r(null,[]);let s=e.length;const c=new Array(e.length);let d=null;e.forEach((f,g)=>{t(f,(y,b)=>{y&&(d=y),c[g]=b,0==--s&&r(d,c)})})}function pe(e){const t=[];for(const r in e)t.push(e[r]);return t}function _t(e,...t){for(const r of t)for(const s in r)e[s]=r[s];return e}function he(e,t){const r={};for(let s=0;s<t.length;s++){const c=t[s];c in e&&(r[c]=e[c])}return r}let Ue=1;function In(){return Ue++}function qr(){return function e(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Co(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function tr(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Tn(e,t){e.forEach(r=>{t[r]&&(t[r]=t[r].bind(t))})}function pn(e,t){return-1!==e.indexOf(t,e.length-t.length)}function fo(e,t,r){const s={};for(const c in e)s[c]=t.call(r||this,e[c],c,e);return s}function ce(e,t,r){const s={};for(const c in e)t.call(r||this,e[c],c,e)&&(s[c]=e[c]);return s}function et(e){return Array.isArray(e)?e.map(et):"object"==typeof e&&e?fo(e,et):e}const nt={};function gt(e){nt[e]||(typeof console<"u"&&console.warn(e),nt[e]=!0)}function Qt(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function ie(e){let t=0;for(let r,s,c=0,d=e.length,f=d-1;c<d;f=c++)r=e[c],s=e[f],t+=(s.x-r.x)*(r.y+s.y);return t}function Pe([e,t,r]){const s=Ct(t+90),c=Ct(r);return{x:e*Math.cos(s)*Math.sin(c),y:e*Math.sin(s)*Math.sin(c),z:e*Math.cos(c),azimuthal:t,polar:r}}function Ge(e,t,r){const s=Math.sqrt(e*e+t*t+r*r),c=s>0?Math.acos(r/s)*Gt:0;let d=0!==e||0!==t?Math.atan2(-t,-e)*Gt+90:0;return d<0&&(d+=360),[s,d,c]}function ae(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Xe(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,s,c,d)=>{const f=c||d;return t[s]=!f||f.toLowerCase(),""}),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}let Ze=null;function Ie(){return!!lt.document.fullscreenElement||!!lt.document.webkitFullscreenElement}function gn(e){try{const t=lt[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function ur(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}function yn(e,t,r){e[4*t+0]=r[0],e[4*t+1]=r[1],e[4*t+2]=r[2],e[4*t+3]=r[3]}function Fr(e,t){return[Math.pow(e[0],2.2)*t,Math.pow(e[1],2.2)*t,Math.pow(e[2],2.2)*t]}function Xr(e){return[Math.pow(e[0],1/2.2),Math.pow(e[1],1/2.2),Math.pow(e[2],1/2.2)]}const Sn="mapbox-tiles";let Ar,dr,jo=500,Ur=50;function zl(){try{return lt.caches}catch{}}function er(){zl()&&!Ar&&(Ar=lt.caches.open(Sn))}function Rs(e){const t=e.indexOf("?");if(t<0)return e;const s=function(c){const d=c.indexOf("?");return d>0?c.slice(d+1).split("&"):[]}(e).filter(c=>{const d=c.split("=");return"language"===d[0]||"worldview"===d[0]});return s.length?`${e.slice(0,t)}?${s.join("&")}`:e.slice(0,t)}let ri=1/0;function ds(e){ri++,ri>Ur&&(e.getActor().send("enforceCacheSizeLimit",jo),ri=0)}const Ft={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};"function"==typeof Object.freeze&&Object.freeze(Ft);class Ht extends Error{constructor(t,r,s){401===r&&Nn(s)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=r,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const te=ae()?()=>self.worker&&self.worker.referrer:()=>("blob:"===lt.location.protocol?lt.parent:lt).location.href,le=function(e,t){if(!(/^file:/.test(r=e.url)||/^file:/.test(te())&&!/^\w+:/.test(r))){if(lt.fetch&&lt.Request&&lt.AbortController&&lt.Request.prototype.hasOwnProperty("signal"))return function(s,c){const d=new lt.AbortController,f=new lt.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:te(),referrerPolicy:s.referrerPolicy,signal:d.signal});let g=!1,y=!1;const b=(C=f.url).indexOf("sku=")>0&&Nn(C);var C;"json"===s.type&&f.headers.set("Accept","application/json");const P=(I,A,l)=>{if(y)return;if(I&&"SecurityError"!==I.message&&gt(I.toString()),A&&l)return E(A);const u=Date.now();lt.fetch(f).then(p=>{if(p.ok){const m=b?p.clone():null;return E(p,m,u)}return c(new Ht(p.statusText,p.status,s.url))}).catch(p=>{"AbortError"!==p.name&&c(new Error(`${p.message} ${s.url}`))})},E=(I,A,l)=>{("arrayBuffer"===s.type?I.arrayBuffer():"json"===s.type?I.json():I.text()).then(u=>{y||(A&&l&&function(p,m,v){if(er(),!Ar)return;const M={status:m.status,statusText:m.statusText,headers:new lt.Headers};m.headers.forEach((k,N)=>M.headers.set(N,k));const O=Xe(m.headers.get("Cache-Control")||"");if(O["no-store"])return;O["max-age"]&&M.headers.set("Expires",new Date(v+1e3*O["max-age"]).toUTCString());const T=M.headers.get("Expires");T&&(new Date(T).getTime()-v<42e4||function(k,N){if(void 0===dr)try{new Response(new ReadableStream),dr=!0}catch{dr=!1}dr?N(k.body):k.blob().then(N)}(m,k=>{const N=new lt.Response(k,M);er(),Ar&&Ar.then(F=>F.put(Rs(p.url),N)).catch(F=>gt(F.message))}))}(f,A,l),g=!0,c(null,u,I.headers.get("Cache-Control"),I.headers.get("Expires")))}).catch(u=>{y||c(new Error(u.message))})};return b?function(I,A){if(er(),!Ar)return A(null);const l=Rs(I.url);Ar.then(u=>{u.match(l).then(p=>{const m=function(v){if(!v)return!1;const M=new Date(v.headers.get("Expires")||0),O=Xe(v.headers.get("Cache-Control")||"");return M>Date.now()&&!O["no-cache"]}(p);u.delete(l),m&&u.put(l,p.clone()),A(null,p,m)}).catch(A)}).catch(A)}(f,P):P(null,null),{cancel:()=>{y=!0,g||d.abort()}}}(e,t);if(ae()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(s,c){const d=new lt.XMLHttpRequest;d.open(s.method||"GET",s.url,!0),"arrayBuffer"===s.type&&(d.responseType="arraybuffer");for(const f in s.headers)d.setRequestHeader(f,s.headers[f]);return"json"===s.type&&(d.responseType="text",d.setRequestHeader("Accept","application/json")),d.withCredentials="include"===s.credentials,d.onerror=()=>{c(new Error(d.statusText))},d.onload=()=>{if((d.status>=200&&d.status<300||0===d.status)&&null!==d.response){let f=d.response;if("json"===s.type)try{f=JSON.parse(d.response)}catch(g){return c(g)}c(null,f,d.getResponseHeader("Cache-Control"),d.getResponseHeader("Expires"))}else c(new Ht(d.statusText,d.status,s.url))},d.send(s.body),{cancel:()=>d.abort()}}(e,t)},_e=function(e,t){return le(_t(e,{type:"json"}),t)},ve=function(e,t){return le(_t(e,{type:"arrayBuffer"}),t)};function xe(e){const t=lt.document.createElement("a");return t.href=e,t.protocol===lt.document.location.protocol&&t.host===lt.document.location.host}const ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let at,ht;at=[],ht=0;const Bt=function(e,t){if(be.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ht>=ue.MAX_PARALLEL_IMAGE_REQUESTS){const d={requestParameters:e,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return at.push(d),d}ht++;let r=!1;const s=()=>{if(!r)for(r=!0,ht--;at.length&&ht<ue.MAX_PARALLEL_IMAGE_REQUESTS;){const d=at.shift(),{requestParameters:f,callback:g,cancelled:y}=d;y||(d.cancel=Bt(f,g).cancel)}},c=ve(e,(d,f,g,y)=>{s(),d?t(d):f&&(lt.createImageBitmap?function(b,C){const P=new lt.Blob([new Uint8Array(b)],{type:"image/png"});lt.createImageBitmap(P).then(E=>{C(null,E)}).catch(E=>{C(new Error(`Could not load image because of ${E.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(f,(b,C)=>t(b,C,g,y)):function(b,C){const P=new lt.Image,E=lt.URL;P.onload=()=>{C(null,P),E.revokeObjectURL(P.src),P.onload=null,lt.requestAnimationFrame(()=>{P.src=ot})},P.onerror=()=>C(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const I=new lt.Blob([new Uint8Array(b)],{type:"image/png"});P.src=b.byteLength?E.createObjectURL(I):ot}(f,(b,C)=>t(b,C,g,y)))});return{cancel:()=>{c.cancel(),s()}}},kt="NO_ACCESS_TOKEN";class ee{constructor(t,r,s){this._transformRequestFn=t,this._customAccessToken=r,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const t=function(){let r="";for(let s=0;s<10;s++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",tn,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,r){return this._transformRequestFn&&this._transformRequestFn(t,r)||{url:t}}normalizeStyleURL(t,r){if(!Ke(t))return t;const s=or(t);return s.params.push(`sdk=js-${ye}`),s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeGlyphsURL(t,r){if(!Ke(t))return t;const s=or(t);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeModelURL(t,r){if(!Ke(t))return t;const s=or(t);return s.path=`/models/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeSourceURL(t,r,s,c){if(!Ke(t))return t;const d=or(t);return d.path=`/v4/${d.authority}.json`,d.params.push("secure"),s&&d.params.push(`language=${s}`),c&&d.params.push(`worldview=${c}`),this._makeAPIURL(d,this._customAccessToken||r)}normalizeSpriteURL(t,r,s,c){const d=or(t);return Ke(t)?(d.path=`/styles/v1${d.path}/sprite${r}${s}`,this._makeAPIURL(d,this._customAccessToken||c)):(d.path+=`${r}${s}`,$o(d))}normalizeTileURL(t,r,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Ke(t))return t;const c=or(t);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||s&&"raster"!==c.authority&&512===s?"@2x":""}${be.supported?".webp":"$1"}`),"raster"===c.authority?c.path=`/${ue.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${ue.TILE_URL_VERSION}${c.path}`);const d=this._customAccessToken||function(f){for(const g of f){const y=g.match(/^access_token=(.*)$/);if(y)return y[1]}return null}(c.params)||ue.ACCESS_TOKEN;return ue.REQUIRE_ACCESS_TOKEN&&d&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,d)}canonicalizeTileURL(t,r){const s=or(t);if(!s.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!s.path.match(/\.[\w]+$/))return t;let c="mapbox://";s.path.match(/^\/raster\/v1\//)?c+=`raster/${s.path.replace(`/${ue.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${s.path.replace(`/${ue.TILE_URL_VERSION}/`,"")}`;let d=s.params;return r&&(d=d.filter(f=>!f.match(/^access_token=/))),d.length&&(c+=`?${d.join("&")}`),c}canonicalizeTileset(t,r){const s=!!r&&Ke(r),c=[];for(const d of t.tiles||[])Nn(d)?c.push(this.canonicalizeTileURL(d,s)):c.push(d);return c}_makeAPIURL(t,r){const s="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=or(ue.API_URL);if(t.protocol=c.protocol,t.authority=c.authority,"http"===t.protocol){const d=t.params.indexOf("secure");d>=0&&t.params.splice(d,1)}if("/"!==c.path&&(t.path=`${c.path}${t.path}`),!ue.REQUIRE_ACCESS_TOKEN)return $o(t);if(r=r||ue.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if("s"===r[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return t.params=t.params.filter(d=>-1===d.indexOf("access_token")),t.params.push(`access_token=${r||""}`),$o(t)}}function Ke(e){return 0===e.indexOf("mapbox:")}function Nn(e){return ue.API_URL_REGEX.test(e)}function yr(e){return ue.API_CDN_URL_REGEX.test(e)}function Er(e){return ue.API_STYLE_REGEX.test(e)&&!Qr(e)}function Qr(e){return ue.API_SPRITE_REGEX.test(e)}const Pr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function or(e){const t=e.match(Pr);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function $o(e){const t=e.params.length?`?${e.params.join("&")}`:"";return`${e.protocol}://${e.authority}${e.path}${t}`}const ir="mapbox.eventData";function qs(e){if(!e)return null;const t=e.split(".");if(!t||3!==t.length)return null;try{return JSON.parse(decodeURIComponent(lt.atob(t[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class ne{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const r=qs(ue.ACCESS_TOKEN);let s="";return s=r&&r.u?lt.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(c,d)=>String.fromCharCode(+("0x"+d)))):ue.ACCESS_TOKEN||"",t?`${ir}.${t}:${s}`:`${ir}:${s}`}fetchEventData(){const t=gn("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(t)try{const c=lt.localStorage.getItem(r);c&&(this.eventData=JSON.parse(c));const d=lt.localStorage.getItem(s);d&&(this.anonId=d)}catch{gt("Unable to read from LocalStorage")}}saveEventData(){const t=gn("localStorage"),r=this.getStorageKey(),s=this.getStorageKey("uuid");if(t)try{lt.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&lt.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{gt("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,r,s,c){if(!ue.EVENTS_URL)return;const d=or(ue.EVENTS_URL);d.params.push(`access_token=${c||ue.ACCESS_TOKEN||""}`);const f={event:this.type,created:new Date(t).toISOString()},g=r?_t(f,r):f,y={url:$o(d),headers:{"Content-Type":"text/plain"},body:JSON.stringify([g])};var C;this.pendingRequest=(C=b=>{this.pendingRequest=null,s(b),this.saveEventData(),this.processRequests(c)},le(_t(y,{method:"POST"}),C))}queueRequest(t,r){this.queue.push(t),this.processRequests(r)}}const Vt=new class extends ne{constructor(e){super("appUserTurnstile"),this._customAccessToken=e}postTurnstileEvent(e,t){ue.EVENTS_URL&&ue.ACCESS_TOKEN&&Array.isArray(e)&&e.some(r=>Ke(r)||Nn(r))&&this.queueRequest(Date.now(),t)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=qs(ue.ACCESS_TOKEN),r=t?t.u:ue.ACCESS_TOKEN;let s=r!==this.eventData.tokenU;tr(this.anonId)||(this.anonId=qr(),s=!0);const c=this.queue.shift();if(this.eventData.lastSuccess){const d=new Date(this.eventData.lastSuccess),f=new Date(c),g=(c-this.eventData.lastSuccess)/864e5;s=s||g>=1||g<-1||d.getDate()!==f.getDate()}else s=!0;s?this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ye,skuId:tn,"enabled.telemetry":!1,userId:this.anonId},d=>{d||(this.eventData.lastSuccess=c,this.eventData.tokenU=r)},e):this.processRequests()}},Re=Vt.postTurnstileEvent.bind(Vt),zn=new class extends ne{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(e,t,r,s){this.skuToken=t,this.errorCb=s,ue.EVENTS_URL&&(r||ue.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},r):this.errorCb(new Error(kt)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:r}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),tr(this.anonId)||(this.anonId=qr()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ye,skuId:tn,skuToken:this.skuToken,userId:this.anonId},s=>{s?this.errorCb(s):t&&(this.success[t]=!0)},e))}},vr=zn.postMapLoadEvent.bind(zn),sr=new class extends ne{constructor(){super("gljs.performance")}postPerformanceEvent(e,t){ue.EVENTS_URL&&(e||ue.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},e)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:t,performanceData:r}=this.queue.shift(),s=function(c){const d=lt.performance.getEntriesByType("resource"),f=lt.performance.getEntriesByType("mark"),g=function(E){const I={};if(E)for(const A in E)if("other"!==A)for(const l of E[A]){const u=`${A}ResolveRangeMin`,p=`${A}ResolveRangeMax`,m=`${A}RequestCount`,v=`${A}RequestCachedCount`;I[u]=Math.min(I[u]||1/0,l.startTime),I[p]=Math.max(I[p]||-1/0,l.responseEnd);const M=O=>{void 0===I[O]&&(I[O]=0),++I[O]};void 0!==l.transferSize&&0===l.transferSize&&M(v),M(m)}return I}(function(E,I){const A={};if(E)for(const l of E){const u=I(l);void 0===A[u]&&(A[u]=[]),A[u].push(l)}return A}(d,su)),y=lt.devicePixelRatio,b=lt.navigator.connection||lt.navigator.mozConnection||lt.navigator.webkitConnection,C={counters:[],metadata:[],attributes:[]},P=(E,I,A)=>{null!=A&&E.push({name:I,value:A.toString()})};for(const E in g)P(C.counters,E,g[E]);if(c.interactionRange[0]!==1/0&&c.interactionRange[1]!==-1/0&&(P(C.counters,"interactionRangeMin",c.interactionRange[0]),P(C.counters,"interactionRangeMax",c.interactionRange[1])),f)for(const E of Object.keys(ml)){const I=ml[E],A=f.find(l=>l.name===I);A&&P(C.counters,I,A.startTime)}return P(C.counters,"visibilityHidden",c.visibilityHidden),P(C.attributes,"style",function(E){if(E)for(const I of E){const A=I.name.split("?")[0];if(Er(A)){const l=A.split("/").slice(-2);if(2===l.length)return`mapbox://styles/${l[0]}/${l[1]}`}}}(d)),P(C.attributes,"terrainEnabled",c.terrainEnabled?"true":"false"),P(C.attributes,"fogEnabled",c.fogEnabled?"true":"false"),P(C.attributes,"projection",c.projection),P(C.attributes,"zoom",c.zoom),P(C.metadata,"devicePixelRatio",y),P(C.metadata,"connectionEffectiveType",b?b.effectiveType:void 0),P(C.metadata,"navigatorUserAgent",lt.navigator.userAgent),P(C.metadata,"screenWidth",lt.screen.width),P(C.metadata,"screenHeight",lt.screen.height),P(C.metadata,"windowWidth",lt.innerWidth),P(C.metadata,"windowHeight",lt.innerHeight),P(C.metadata,"mapWidth",c.width/y),P(C.metadata,"mapHeight",c.height/y),P(C.metadata,"webglRenderer",c.renderer),P(C.metadata,"webglVendor",c.vendor),P(C.metadata,"sdkVersion",ye),P(C.metadata,"sdkIdentifier","mapbox-gl-js"),C}(r);for(const c of s.metadata);for(const c of s.counters);for(const c of s.attributes);this.postEvent(t,s,()=>{},e)}},ao=sr.postPerformanceEvent.bind(sr),qo=new class extends ne{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(e,t,r,s){if(!ue.API_URL||!ue.SESSION_PATH)return;const c=or(ue.API_URL+ue.SESSION_PATH);c.params.push(`sku=${t||""}`),c.params.push(`access_token=${s||ue.ACCESS_TOKEN||""}`);const d={url:$o(c),headers:{"Content-Type":"text/plain"}};var g;this.pendingRequest=(g=f=>{this.pendingRequest=null,r(f),this.saveEventData(),this.processRequests(s)},le(_t(d,{method:"GET"}),g))}getSessionAPI(e,t,r,s){this.skuToken=t,this.errorCb=s,ue.SESSION_PATH&&ue.API_URL&&(r||ue.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},r):this.errorCb(new Error(kt)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:r}=this.queue.shift();t&&this.success[t]||this.getSession(r,this.skuToken,s=>{s?this.errorCb(s):t&&(this.success[t]=!0)},e)}},Io=qo.getSessionAPI.bind(qo),zr=new Set;function gl(e,t){t?zr.add(e):zr.delete(e)}const ml={create:"create",load:"load",fullLoad:"fullLoad"},mh={mark(e){lt.performance.mark(e)},measure(e,t,r){lt.performance.measure(e,t,r)}};function su(e){const t=e.name.split("?")[0];return yr(t)&&t.includes("mapbox-gl.js")?"javascript":yr(t)&&t.includes("mapbox-gl.css")?"css":ue.API_FONTS_REGEX.test(t)?"fontRange":Qr(t)?"sprite":Er(t)?"style":ue.API_TILEJSON_REGEX.test(t)?"tilejson":"other"}const bs=lt.performance;function Ua(e){const t=e?e.url.toString():void 0;return bs.getEntriesByName(t)}var lg=Va;function Va(e){return t=e,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var s,c,d=new Blob([""],{type:"text/javascript"}),f=URL.createObjectURL(d);try{c=new Worker(f),s=!0}catch{s=!1}return c&&c.terminate(),URL.revokeObjectURL(f),s}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var s=document.createElement("canvas");s.width=s.height=1;var c=s.getContext("2d");if(!c)return!1;var d=c.getImageData(0,0,1,1);return d&&d.width===s.width}()||(void 0===Zo[r=t&&t.failIfMajorPerformanceCaveat]&&(Zo[r]=function(s){var c,f,g,y,d=(f=s,g=document.createElement("canvas"),(y=Object.create(Va.webGLContextAttributes)).failIfMajorPerformanceCaveat=f,g.getContext("webgl",y)||g.getContext("experimental-webgl",y));if(!d)return!1;try{c=d.createShader(d.VERTEX_SHADER)}catch{return!1}return!(!c||d.isContextLost())&&(d.shaderSource(c,"void main() {}"),d.compileShader(c),!0===d.getShaderParameter(c,d.COMPILE_STATUS))}(r)),!Zo[r]||document.documentMode));var t,r}var Zo={};let cg,ba,ud,dd,ja;function hd(){return null==cg&&(cg=lt.OffscreenCanvas&&new lt.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof lt.createImageBitmap),cg}Va.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Mn={now:()=>void 0!==dd?dd:lt.performance.now(),setNow(e){dd=e},restoreNow(){dd=void 0},frame(e){const t=lt.requestAnimationFrame(e);return{cancel:()=>lt.cancelAnimationFrame(t)}},getImageData(e,t=0){const{width:r,height:s}=e;ja||(ja=lt.document.createElement("canvas"));const c=ja.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return(r>ja.width||s>ja.height)&&(ja.width=r,ja.height=s),c.clearRect(-t,-t,r+2*t,s+2*t),c.drawImage(e,0,0,r,s),c.getImageData(-t,-t,r+2*t,s+2*t)},resolveURL:e=>(ba||(ba=lt.document.createElement("a")),ba.href=e,ba.href),get devicePixelRatio(){return lt.devicePixelRatio},get prefersReducedMotion(){return!!lt.matchMedia&&(null==ud&&(ud=lt.matchMedia("(prefers-reduced-motion: reduce)")),ud.matches)},hasCanvasFingerprintNoise(){if(!hd())return!1;const e=new lt.OffscreenCanvas(85,1),t=e.getContext("2d",{willReadFrequently:!0});let r=0;for(let c=0;c<e.width;++c)t.fillStyle=`rgba(${r++},${r++},${r++}, 255)`,t.fillRect(c,0,1,1);const s=t.getImageData(0,0,e.width,e.height);r=0;for(let c=0;c<s.data.length;++c)if(c%4!=3&&r++!==s.data[c])return!0;return!1}};function eo(e,t,r){const s=lt.document.createElement(e);return void 0!==t&&(s.className=t),r&&r.appendChild(s),s}function oa(e,t,r){const s=lt.document.createElementNS("http://www.w3.org/2000/svg",e);for(const c of Object.keys(t))s.setAttributeNS(null,c,t[c]);return r&&r.appendChild(s),s}const Hi=lt.document&&lt.document.documentElement.style,au=Hi&&void 0!==Hi.userSelect?"userSelect":"WebkitUserSelect";let lu;function $f(){Hi&&au&&(lu=Hi[au],Hi[au]="none")}function Hy(){Hi&&au&&(Hi[au]=lu)}function xs(e){e.preventDefault(),e.stopPropagation(),lt.removeEventListener("click",xs,!0)}function _h(){lt.addEventListener("click",xs,!0),lt.setTimeout(()=>{lt.removeEventListener("click",xs,!0)},0)}function vi(e,t){const r=e.getBoundingClientRect();return Um(e,r,t)}function cu(e,t){const r=e.getBoundingClientRect(),s=[];for(let c=0;c<t.length;c++)s.push(Um(e,r,t[c]));return s}function Gf(e){return void 0!==lt.InstallTrigger&&2===e.button&&e.ctrlKey&&lt.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:e.button}function Um(e,t,r){const s=e.offsetWidth===t.width?1:e.offsetWidth/t.width;return new tt((r.clientX-t.left)*s,(r.clientY-t.top)*s)}function fd(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function yh(e,t,r){if(r&&r[e]){const s=r[e].indexOf(t);-1!==s&&r[e].splice(s,1)}}class de{constructor(t,r={}){_t(this,r),this.type=t}}class Cn extends de{constructor(t,r={}){super("error",_t({error:t},r))}}class Ro{on(t,r){return this._listeners=this._listeners||{},fd(t,r,this._listeners),this}off(t,r){return yh(t,r,this._listeners),yh(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},fd(t,r,this._oneTimeListeners),this):new Promise(s=>this.once(t,s))}fire(t,r){"string"==typeof t&&(t=new de(t,r||{}));const s=t.type;if(this.listens(s)){t.target=this;const c=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const g of c)g.call(this,t);const d=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const g of d)yh(s,g,this._oneTimeListeners),g.call(this,t);const f=this._eventedParent;f&&(_t(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),f.fire(t))}else t instanceof Cn&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var wt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class Fe{constructor(t,r,s,c){this.message=(t?`${t}: `:"")+s,c&&(this.identifier=c),null!=r&&r.__line__&&(this.line=r.__line__)}}class wc extends Fe{}function Zs(e,...t){for(const r of t)for(const s in r)e[s]=r[s];return e}function Wn(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Go(e){if(Array.isArray(e))return e.map(Go);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const r in e)t[r]=Go(e[r]);return t}return Wn(e)}class Yi extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}var hi=Yi;class Di{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[s,c]of r)this.bindings[s]=c}concat(t){return new Di(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var Vm=Di;const ws={kind:"null"},Ae={kind:"number"},br={kind:"string"},Tr={kind:"boolean"},Jr={kind:"color"},dn={kind:"object"},Ye={kind:"value"},Do={kind:"collator"},Cs={kind:"formatted"},$a={kind:"resolvedImage"};function Zr(e,t){return{kind:"array",itemType:e,N:t}}function no(e){if("array"===e.kind){const t=no(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const ki=[ws,Ae,br,Tr,Jr,Cs,dn,Zr(Ye),$a];function Xi(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Xi(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const r of ki)if(!Xi(r,t))return null}return`Expected ${no(e)} but found ${no(t)} instead.`}function pd(e,t){return t.some(r=>r.kind===e.kind)}function ar(e,t){return t.some(r=>"null"===r?null===e:"array"===r?Array.isArray(e):"object"===r?e&&!Array.isArray(e)&&"object"==typeof e:r===typeof e)}var Ws,Cc={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function xa(e){return(e=Math.round(e))<0?0:e>255?255:e}function Wo(e){return xa("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function uu(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function Ga(e,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}try{Ws={}.parseCSSColor=function(e){var t,r=e.replace(/ /g,"").toLowerCase();if(r in Cc)return Cc[r].slice();if("#"===r[0])return 4===r.length?(t=parseInt(r.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===r.length&&(t=parseInt(r.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var s=r.indexOf("("),c=r.indexOf(")");if(-1!==s&&c+1===r.length){var d=r.substr(0,s),f=r.substr(s+1,c-(s+1)).split(","),g=1;switch(d){case"rgba":if(4!==f.length)return null;g=uu(f.pop());case"rgb":return 3!==f.length?null:[Wo(f[0]),Wo(f[1]),Wo(f[2]),g];case"hsla":if(4!==f.length)return null;g=uu(f.pop());case"hsl":if(3!==f.length)return null;var y=(parseFloat(f[0])%360+360)%360/360,b=uu(f[1]),C=uu(f[2]),P=C<=.5?C*(b+1):C+b-C*b,E=2*C-P;return[xa(255*Ga(E,P,y+1/3)),xa(255*Ga(E,P,y)),xa(255*Ga(E,P,y-1/3)),g];default:return null}}return null}}catch{}class fi{constructor(t,r,s,c=1){this.r=t,this.g=r,this.b=s,this.a=c}static parse(t){if(!t)return;if(t instanceof fi)return t;if("string"!=typeof t)return;const r=Ws(t);return r?new fi(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[t,r,s,c]=this.toArray();return`rgba(${Math.round(t)},${Math.round(r)},${Math.round(s)},${c})`}toArray(){const{r:t,g:r,b:s,a:c}=this;return 0===c?[0,0,0,0]:[255*t/c,255*r/c,255*s/c,c]}toArray01(){const{r:t,g:r,b:s,a:c}=this;return 0===c?[0,0,0,0]:[t/c,r/c,s/c,c]}toArray01Scaled(t){const{r,g:s,b:c,a:d}=this;return 0===d?[0,0,0]:[r/d*t,s/d*t,c/d*t]}toArray01PremultipliedAlpha(){const{r:t,g:r,b:s,a:c}=this;return[t,r,s,c]}toArray01Linear(){const{r:t,g:r,b:s,a:c}=this;return 0===c?[0,0,0,0]:[Math.pow(t/c,2.2),Math.pow(r/c,2.2),Math.pow(s/c,2.2),c]}}fi.black=new fi(0,0,0,1),fi.white=new fi(1,1,1,1),fi.transparent=new fi(0,0,0,0),fi.red=new fi(1,0,0,1),fi.blue=new fi(0,0,1,1);var bn=fi;class Hf{constructor(t,r,s){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ia{constructor(t,r,s,c,d){this.text=t.normalize?t.normalize():t,this.image=r,this.scale=s,this.fontStack=c,this.textColor=d}}class pi{constructor(t){this.sections=t}static fromString(t){return new pi([new ia(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(t=>0!==t.text.length||t.image&&0!==t.image.namePrimary.length)}static factory(t){return t instanceof pi?t:pi.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const r of this.sections){if(r.image){t.push(["image",r.image.namePrimary]);continue}t.push(r.text);const s={};r.fontStack&&(s["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(s["font-scale"]=r.scale),r.textColor&&(s["text-color"]=["rgba"].concat(r.textColor.toArray())),t.push(s)}return t}}class Ri{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,r){return t?new Ri({namePrimary:t,nameSecondary:r,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function sa(e,t,r,s){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===s||"number"==typeof s&&s>=0&&s<=1?null:`Invalid rgba value [${[e,t,r,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof s?[e,t,r,s]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Yn(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof bn||e instanceof Hf||e instanceof pi||e instanceof Ri)return!0;if(Array.isArray(e)){for(const t of e)if(!Yn(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!Yn(e[t]))return!1;return!0}return!1}function gi(e){if(null===e)return ws;if("string"==typeof e)return br;if("boolean"==typeof e)return Tr;if("number"==typeof e)return Ae;if(e instanceof bn)return Jr;if(e instanceof Hf)return Do;if(e instanceof pi)return Cs;if(e instanceof Ri)return $a;if(Array.isArray(e)){const t=e.length;let r;for(const s of e){const c=gi(s);if(r){if(r===c)continue;r=Ye;break}r=c}return Zr(r||Ye,t)}return dn}function Bl(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof bn||e instanceof pi||e instanceof Ri?e.toString():JSON.stringify(e)}class gd{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(2!==t.length)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Yn(t[1]))return r.error("invalid value");const s=t[1];let c=gi(s);const d=r.expectedType;return"array"!==c.kind||0!==c.N||!d||"array"!==d.kind||"number"==typeof d.N&&0!==d.N||(c=d),new gd(c,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof bn?["rgba"].concat(this.value.toArray()):this.value instanceof pi?this.value.serialize():this.value}}var Ms=gd,Ko=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};const Ul={string:br,number:Ae,boolean:Tr,object:dn};class du{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let s,c=1;const d=t[0];if("array"===d){let g,y;if(t.length>2){const b=t[1];if("string"!=typeof b||!(b in Ul)||"object"===b)return r.error('The item type argument of "array" must be one of string, number, boolean',1);g=Ul[b],c++}else g=Ye;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);y=t[2],c++}s=Zr(g,y)}else s=Ul[d];const f=[];for(;c<t.length;c++){const g=r.parse(t[c],c,Ye);if(!g)return null;f.push(g)}return new du(s,f)}evaluate(t){for(let r=0;r<this.args.length;r++){const s=this.args[r].evaluate(t);if(!Xi(this.type,gi(s)))return s;if(r===this.args.length-1)throw new Ko(`Expected value to be of type ${no(this.type)}, but found ${no(gi(s))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,r=[t.kind];if("array"===t.kind){const s=t.itemType;if("string"===s.kind||"number"===s.kind||"boolean"===s.kind){r.push(s.kind);const c=t.N;("number"==typeof c||this.args.length>1)&&r.push(c)}}return r.concat(this.args.map(s=>s.serialize()))}}var zo=du;class aa{constructor(t){this.type=Cs,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const s=t[1];if(!Array.isArray(s)&&"object"==typeof s)return r.error("First argument must be an image or text section.");const c=[];let d=!1;for(let f=1;f<=t.length-1;++f){const g=t[f];if(d&&"object"==typeof g&&!Array.isArray(g)){d=!1;let y=null;if(g["font-scale"]&&(y=r.parse(g["font-scale"],1,Ae),!y))return null;let b=null;if(g["text-font"]&&(b=r.parse(g["text-font"],1,Zr(br)),!b))return null;let C=null;if(g["text-color"]&&(C=r.parse(g["text-color"],1,Jr),!C))return null;const P=c[c.length-1];P.scale=y,P.font=b,P.textColor=C}else{const y=r.parse(t[f],1,Ye);if(!y)return null;const b=y.type.kind;if("string"!==b&&"value"!==b&&"null"!==b&&"resolvedImage"!==b)return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,c.push({content:y,scale:null,font:null,textColor:null})}}return new aa(c)}evaluate(t){return new pi(this.sections.map(r=>{const s=r.content.evaluate(t);return gi(s)===$a?new ia("",s,null,null,null):new ia(Bl(s),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null)}))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const r of this.sections){t.push(r.content.serialize());const s={};r.scale&&(s["font-scale"]=r.scale.serialize()),r.font&&(s["text-font"]=r.font.serialize()),r.textColor&&(s["text-color"]=r.textColor.serialize()),t.push(s)}return t}}class bi{constructor(t,r){this.type=$a,this.inputPrimary=t,this.inputSecondary=r}static parse(t,r){if(t.length<2)return r.error("Expected two or more arguments.");const s=r.parse(t[1],1,br);if(!s)return r.error("No image name provided.");if(2===t.length)return new bi(s);const c=r.parse(t[2],1,br);return c?new bi(s,c):r.error("Secondary image variant is not a string.")}evaluate(t){const r=Ri.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return r&&t.availableImages&&(r.available=t.availableImages.indexOf(r.namePrimary)>-1,r.nameSecondary&&r.available&&t.availableImages&&(r.available=t.availableImages.indexOf(r.nameSecondary)>-1)),r}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Un(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}const hu={"to-boolean":Tr,"to-color":Jr,"to-number":Ae,"to-string":br};class _l{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const s=t[0],c=[];let d=ws;if("to-array"===s){if(!Array.isArray(t[1]))return null;const f=t[1].length;if(r.expectedType){if("array"!==r.expectedType.kind)return r.error(`Expected ${r.expectedType.kind} but found array.`);d=Zr(r.expectedType.itemType,f)}else{if(!(f>0&&Yn(t[1][0])))return null;d=Zr(gi(t[1][0]),f)}for(let g=0;g<f;g++){const y=t[1][g];let b;if("array"===Un(y))b=r.parse(y,void 0,d.itemType);else{const C=Un(y);if(C!==d.itemType.kind)return r.error(`Expected ${d.itemType.kind} but found ${C}.`);b=r.registry.literal.parse(["literal",void 0===y?null:y],r)}if(!b)return null;c.push(b)}}else{if(("to-boolean"===s||"to-string"===s)&&2!==t.length)return r.error("Expected one argument.");d=hu[s];for(let f=1;f<t.length;f++){const g=r.parse(t[f],f,Ye);if(!g)return null;c.push(g)}}return new _l(d,c)}evaluate(t){if("boolean"===this.type.kind)return!!this.args[0].evaluate(t);if("color"===this.type.kind){let r,s;for(const c of this.args){if(r=c.evaluate(t),s=null,r instanceof bn)return r;if("string"==typeof r){const d=t.parseColor(r);if(d)return d}else if(Array.isArray(r)&&(s=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:sa(r[0],r[1],r[2],r[3]),!s))return new bn(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Ko(s||`Could not parse color from value '${"string"==typeof r?r:String(JSON.stringify(r))}'`)}if("number"===this.type.kind){let r=null;for(const s of this.args){if(r=s.evaluate(t),null===r)return 0;const c=Number(r);if(!isNaN(c))return c}throw new Ko(`Could not convert ${JSON.stringify(r)} to number.`)}return"formatted"===this.type.kind?pi.fromString(Bl(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Ri.fromString(Bl(this.args[0].evaluate(t))):"array"===this.type.kind?this.args.map(r=>r.evaluate(t)):Bl(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if("formatted"===this.type.kind)return new aa([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new bi(this.args[0]).serialize();const t="array"===this.type.kind?[]:[`to-${this.type.kind}`];return this.eachChild(r=>{t.push(r.serialize())}),t}}var Ha=_l;const la=["Unknown","Point","LineString","Polygon"];var fu=class{constructor(e){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.options=e}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?la[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(e){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:r,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*t-e[0])+this.featureDistanceData.bearing[1]*(s*t-e[1])}return 0}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=bn.parse(e)),t}getConfig(e){return this.options?this.options.get(e):null}};class yl{constructor(t,r,s,c,d){this.name=t,this.type=r,this._evaluate=s,this.args=c,this._overloadIndex=d}evaluate(t){if(!this._evaluate){const r=yl.definitions[this.name];this._evaluate=Array.isArray(r)?r[2]:r.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,r){const s=t[0],c=yl.definitions[s];if(!c)return r.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(c)?c[0]:c.type,f=Array.isArray(c)?[[c[1],c[2]]]:c.overloads,g=[];let y=null,b=-1;for(const[C,P]of f){if(Array.isArray(C)&&C.length!==t.length-1)continue;g.push(C),b++,y=new wd(r.registry,r.path,null,r.scope,void 0,r.options);const E=[];let I=!1;for(let A=1;A<t.length;A++){const l=t[A],u=Array.isArray(C)?C[A-1]:C.type,p=y.parse(l,1+E.length,u);if(!p){I=!0;break}E.push(p)}if(!I)if(Array.isArray(C)&&C.length!==E.length)y.error(`Expected ${C.length} arguments, but found ${E.length} instead.`);else{for(let A=0;A<E.length;A++){const l=Array.isArray(C)?C[A]:C.type,u=E[A];y.concat(A+1).checkSubtype(l,u.type)}if(0===y.errors.length)return new yl(s,d,P,E,b)}}if(1===g.length)r.errors.push(...y.errors);else{const C=(g.length?g:f.map(([E])=>E)).map(ug).join(" | "),P=[];for(let E=1;E<t.length;E++){const I=r.parse(t[E],1+P.length);if(!I)return null;P.push(no(I.type))}r.error(`Expected arguments of type ${C}, but found (${P.join(", ")}) instead.`)}return null}static register(t,r){yl.definitions=r;for(const s in r)t[s]=yl}}function ug(e){return Array.isArray(e)?`(${e.map(no).join(", ")})`:`(${no(e.type)}...)`}var vl=yl;class vh{constructor(t,r,s){this.type=Do,this.locale=s,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(2!==t.length)return r.error("Expected one argument.");const s=t[1];if("object"!=typeof s||Array.isArray(s))return r.error("Collator options argument must be an object.");const c=r.parse(void 0!==s["case-sensitive"]&&s["case-sensitive"],1,Tr);if(!c)return null;const d=r.parse(void 0!==s["diacritic-sensitive"]&&s["diacritic-sensitive"],1,Tr);if(!d)return null;let f=null;return s.locale&&(f=r.parse(s.locale,1,br),!f)?null:new vh(c,d,f)}evaluate(t){return new Hf(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}var Yo={exports:{}};Yo.exports=function(){function e(s,c,d,f,g){for(;f>d;){if(f-d>600){var y=f-d+1,b=c-d+1,C=Math.log(y),P=.5*Math.exp(2*C/3),E=.5*Math.sqrt(C*P*(y-P)/y)*(b-y/2<0?-1:1);e(s,c,Math.max(d,Math.floor(c-b*P/y+E)),Math.min(f,Math.floor(c+(y-b)*P/y+E)),g)}var I=s[c],A=d,l=f;for(t(s,d,c),g(s[f],I)>0&&t(s,d,f);A<l;){for(t(s,A,l),A++,l--;g(s[A],I)<0;)A++;for(;g(s[l],I)>0;)l--}0===g(s[d],I)?t(s,d,l):t(s,++l,f),l<=c&&(d=l+1),c<=l&&(f=l-1)}}function t(s,c,d){var f=s[c];s[c]=s[d],s[d]=f}function r(s,c){return s<c?-1:s>c?1:0}return function(s,c,d,f,g){e(s,c,d||0,f||s.length-1,g||r)}}();var qy=We(Yo.exports);function gw(e){let t=0;for(let r,s,c=0,d=e.length,f=d-1;c<d;f=c++)r=e[c],s=e[f],t+=(s.x-r.x)*(r.y+s.y);return t}function bh(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function dg(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function qf(e,t,r){const s=e[0]-t[0],c=e[1]-t[1],d=e[0]-r[0],f=e[1]-r[1];return s*f-d*c==0&&s*d<=0&&c*f<=0}function Ps(e,t,r=!1){let s=!1;for(let g=0,y=t.length;g<y;g++){const b=t[g];for(let C=0,P=b.length,E=P-1;C<P;E=C++){const I=b[E],A=b[C];if(qf(e,I,A))return r;(d=I)[1]>(c=e)[1]!=(f=A)[1]>c[1]&&c[0]<(f[0]-d[0])*(c[1]-d[1])/(f[1]-d[1])+d[0]&&(s=!s)}}var c,d,f;return s}function jm(e,t,r,s){const c=s[0]-r[0],d=s[1]-r[1],f=(e[0]-r[0])*d-c*(e[1]-r[1]),g=(t[0]-r[0])*d-c*(t[1]-r[1]);return f>0&&g<0||f<0&&g>0}function pu(e,t,r,s){return(c=[s[0]-r[0],s[1]-r[1]])[0]*(d=[t[0]-e[0],t[1]-e[1]])[1]-c[1]*d[0]!=0&&!(!jm(e,t,r,s)||!jm(r,s,e,t));var c,d}const qa=8192;function fb(e,t){const r=(180+e[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,c=Math.pow(2,t.z);return[Math.round(r*c*qa),Math.round(s*c*qa)]}function Zy(e,t){for(let r=0;r<t.length;r++)if(Ps(e,t[r]))return!0;return!1}function hg(e,t,r){for(const s of r)for(let c=0,d=s.length,f=d-1;c<d;f=c++)if(pu(e,t,s[f],s[c]))return!0;return!1}function xh(e,t){for(let r=0;r<e.length;++r)if(!Ps(e[r],t))return!1;for(let r=0;r<e.length-1;++r)if(hg(e[r],e[r+1],t))return!1;return!0}function $m(e,t){for(let r=0;r<t.length;r++)if(xh(e,t[r]))return!0;return!1}function md(e,t,r){const s=[];for(let c=0;c<e.length;c++){const d=[];for(let f=0;f<e[c].length;f++){const g=fb(e[c][f],r);bh(t,g),d.push(g)}s.push(d)}return s}function wa(e,t,r){const s=[];for(let c=0;c<e.length;c++){const d=md(e[c],t,r);s.push(d)}return s}function Zf(e,t,r,s){if(e[0]<r[0]||e[0]>r[2]){const c=.5*s;let d=e[0]-r[0]>c?-s:r[0]-e[0]>c?s:0;0===d&&(d=e[0]-r[2]>c?-s:r[2]-e[0]>c?s:0),e[0]+=d}bh(t,e)}function Vl(e,t,r,s){const c=Math.pow(2,s.z)*qa,d=[s.x*qa,s.y*qa],f=[];if(!e)return f;for(const g of e)for(const y of g){const b=[y.x+d[0],y.y+d[1]];Zf(b,t,r,c),f.push(b)}return f}function ca(e,t,r,s){const c=Math.pow(2,s.z)*qa,d=[s.x*qa,s.y*qa],f=[];if(!e)return f;for(const y of e){const b=[];for(const C of y){const P=[C.x+d[0],C.y+d[1]];bh(t,P),b.push(P)}f.push(b)}if(t[2]-t[0]<=c/2){(g=t)[0]=g[1]=1/0,g[2]=g[3]=-1/0;for(const y of f)for(const b of y)Zf(b,t,r,c)}var g;return f}class gu{constructor(t,r){this.type=Tr,this.geojson=t,this.geometries=r}static parse(t,r){if(2!==t.length)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Yn(t[1])){const s=t[1];if("FeatureCollection"===s.type)for(let c=0;c<s.features.length;++c){const d=s.features[c].geometry.type;if("Polygon"===d||"MultiPolygon"===d)return new gu(s,s.features[c].geometry)}else if("Feature"===s.type){const c=s.geometry.type;if("Polygon"===c||"MultiPolygon"===c)return new gu(s,s.geometry)}else if("Polygon"===s.type||"MultiPolygon"===s.type)return new gu(s,s)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(r,s){const c=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],f=r.canonicalID();if(!f)return!1;if("Polygon"===s.type){const g=md(s.coordinates,d,f),y=Vl(r.geometry(),c,d,f);if(!dg(c,d))return!1;for(const b of y)if(!Ps(b,g))return!1}if("MultiPolygon"===s.type){const g=wa(s.coordinates,d,f),y=Vl(r.geometry(),c,d,f);if(!dg(c,d))return!1;for(const b of y)if(!Zy(b,g))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(r,s){const c=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],f=r.canonicalID();if(!f)return!1;if("Polygon"===s.type){const g=md(s.coordinates,d,f),y=ca(r.geometry(),c,d,f);if(!dg(c,d))return!1;for(const b of y)if(!xh(b,g))return!1}if("MultiPolygon"===s.type){const g=wa(s.coordinates,d,f),y=ca(r.geometry(),c,d,f);if(!dg(c,d))return!1;for(const b of y)if(!$m(b,g))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var wh=gu,qi={exports:{}};qi.exports=function(){var e={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},t=1/298.257223563,r=t*(2-t),s=Math.PI/180,c=function(b,C){if(void 0===b)throw new Error("No latitude given.");if(C&&!e[C])throw new Error("Unknown unit "+C+". Use one of: "+Object.keys(e).join(", "));var P=6378.137*s*(C?e[C]:1),E=Math.cos(b*s),I=1/(1-r*(1-E*E)),A=Math.sqrt(I);this.kx=P*A*E,this.ky=P*A*I*(1-r)},d={units:{configurable:!0}};function f(b,C){return b[0]===C[0]&&b[1]===C[1]}function g(b,C,P){var E=y(C[0]-b[0]);return[b[0]+E*P,b[1]+(C[1]-b[1])*P]}function y(b){for(;b<-180;)b+=360;for(;b>180;)b-=360;return b}return c.fromTile=function(b,C,P){var E=Math.PI*(1-2*(b+.5)/Math.pow(2,C)),I=Math.atan(.5*(Math.exp(E)-Math.exp(-E)))/s;return new c(I,P)},d.units.get=function(){return e},c.prototype.distance=function(b,C){var P=y(b[0]-C[0])*this.kx,E=(b[1]-C[1])*this.ky;return Math.sqrt(P*P+E*E)},c.prototype.bearing=function(b,C){var P=y(C[0]-b[0])*this.kx;return Math.atan2(P,(C[1]-b[1])*this.ky)/s},c.prototype.destination=function(b,C,P){var E=P*s;return this.offset(b,Math.sin(E)*C,Math.cos(E)*C)},c.prototype.offset=function(b,C,P){return[b[0]+C/this.kx,b[1]+P/this.ky]},c.prototype.lineDistance=function(b){for(var C=0,P=0;P<b.length-1;P++)C+=this.distance(b[P],b[P+1]);return C},c.prototype.area=function(b){for(var C=0,P=0;P<b.length;P++)for(var E=b[P],I=0,A=E.length,l=A-1;I<A;l=I++)C+=y(E[I][0]-E[l][0])*(E[I][1]+E[l][1])*(P?-1:1);return Math.abs(C)/2*this.kx*this.ky},c.prototype.along=function(b,C){var P=0;if(C<=0)return b[0];for(var E=0;E<b.length-1;E++){var I=b[E],A=b[E+1],l=this.distance(I,A);if((P+=l)>C)return g(I,A,(C-(P-l))/l)}return b[b.length-1]},c.prototype.pointToSegmentDistance=function(b,C,P){var E=C[0],I=C[1],A=y(P[0]-E)*this.kx,l=(P[1]-I)*this.ky,u=0;return 0===A&&0===l||((u=(y(b[0]-E)*this.kx*A+(b[1]-I)*this.ky*l)/(A*A+l*l))>1?(E=P[0],I=P[1]):u>0&&(E+=A/this.kx*u,I+=l/this.ky*u)),A=y(b[0]-E)*this.kx,l=(b[1]-I)*this.ky,Math.sqrt(A*A+l*l)},c.prototype.pointOnLine=function(b,C){for(var P,E,I,A,l=1/0,u=0;u<b.length-1;u++){var p=b[u][0],m=b[u][1],v=y(b[u+1][0]-p)*this.kx,M=(b[u+1][1]-m)*this.ky,O=0;0===v&&0===M||((O=(y(C[0]-p)*this.kx*v+(C[1]-m)*this.ky*M)/(v*v+M*M))>1?(p=b[u+1][0],m=b[u+1][1]):O>0&&(p+=v/this.kx*O,m+=M/this.ky*O));var T=(v=y(C[0]-p)*this.kx)*v+(M=(C[1]-m)*this.ky)*M;T<l&&(l=T,P=p,E=m,I=u,A=O)}return{point:[P,E],index:I,t:Math.max(0,Math.min(1,A))}},c.prototype.lineSlice=function(b,C,P){var E=this.pointOnLine(P,b),I=this.pointOnLine(P,C);if(E.index>I.index||E.index===I.index&&E.t>I.t){var A=E;E=I,I=A}var l=[E.point],u=E.index+1,p=I.index;!f(P[u],l[0])&&u<=p&&l.push(P[u]);for(var m=u+1;m<=p;m++)l.push(P[m]);return f(P[p],I.point)||l.push(I.point),l},c.prototype.lineSliceAlong=function(b,C,P){for(var E=0,I=[],A=0;A<P.length-1;A++){var l=P[A],u=P[A+1],p=this.distance(l,u);if((E+=p)>b&&0===I.length&&I.push(g(l,u,(b-(E-p))/p)),E>=C)return I.push(g(l,u,(C-(E-p))/p)),I;E>b&&I.push(u)}return I},c.prototype.bufferPoint=function(b,C){var P=C/this.ky,E=C/this.kx;return[b[0]-E,b[1]-P,b[0]+E,b[1]+P]},c.prototype.bufferBBox=function(b,C){var P=C/this.ky,E=C/this.kx;return[b[0]-E,b[1]-P,b[2]+E,b[3]+P]},c.prototype.insideBBox=function(b,C){return y(b[0]-C[0])>=0&&y(b[0]-C[2])<=0&&b[1]>=C[1]&&b[1]<=C[3]},Object.defineProperties(c,d),c}();var _d=We(qi.exports),Qi={exports:{}};Qi.exports=function(){var e=function(r,s){if(void 0===r&&(r=[]),void 0===s&&(s=t),this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(var c=(this.length>>1)-1;c>=0;c--)this._down(c)};function t(r,s){return r<s?-1:r>s?1:0}return e.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},e.prototype.pop=function(){if(0!==this.length){var r=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),r}},e.prototype.peek=function(){return this.data[0]},e.prototype._up=function(r){for(var s=this.data,c=this.compare,d=s[r];r>0;){var f=r-1>>1,g=s[f];if(c(d,g)>=0)break;s[r]=g,r=f}s[r]=d},e.prototype._down=function(r){for(var s=this.data,c=this.compare,d=this.length>>1,f=s[r];r<d;){var g=1+(r<<1),y=s[g],b=g+1;if(b<this.length&&c(s[b],y)<0&&(g=b,y=s[b]),c(y,f)>=0)break;s[r]=y,r=g}s[r]=f},e}();var Ch=We(Qi.exports),Dt=8192;function Li(e,t){return t.dist-e.dist}const fg=100,Mc=50;function Gm(e){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function jl(e){return e[1]-e[0]+1}function Za(e,t){const r=e[1]>=e[0]&&e[1]<t;return r||console.warn("Distance Expression: Index is out of range"),r}function Pc(e,t){if(e[0]>e[1])return[null,null];const r=jl(e);if(t){if(2===r)return[e,null];const s=Math.floor(r/2);return[[e[0],e[0]+s],[e[0]+s,e[1]]]}{if(1===r)return[e,null];const s=Math.floor(r/2)-1;return[[e[0],e[0]+s],[e[0]+s+1,e[1]]]}}function $l(e,t){const r=[1/0,1/0,-1/0,-1/0];if(!Za(t,e.length))return r;for(let s=t[0];s<=t[1];++s)bh(r,e[s]);return r}function Gl(e){const t=[1/0,1/0,-1/0,-1/0];for(let r=0;r<e.length;++r)for(let s=0;s<e[r].length;++s)bh(t,e[r][s]);return t}function Wa(e,t,r){if(Gm(e)||Gm(t))return NaN;let s=0,c=0;return e[2]<t[0]&&(s=t[0]-e[2]),e[0]>t[2]&&(s=e[0]-t[2]),e[1]>t[3]&&(c=e[1]-t[3]),e[3]<t[1]&&(c=t[1]-e[3]),r.distance([0,0],[s,c])}function Hl(e,t){const r=Math.pow(2,t.z);return[(c=(e.x/Dt+t.x)/r,360*c-180),(s=(e.y/Dt+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90)];var s,c}function Mh(e,t){const r=[];for(let s=0;s<e.length;++s)r.push(Hl(e[s],t));return r}function Wf(e,t,r){const s=r.pointOnLine(t,e).point;return r.distance(e,s)}function Hm(e,t,r,s,c){const d=r.slice(s[0],s[1]+1);let f=1/0;for(let g=t[0];g<=t[1];++g)if(0===(f=Math.min(f,Wf(e[g],d,c))))return 0;return f}function qm(e,t,r,s,c){const d=Math.min(c.pointToSegmentDistance(e,r,s),c.pointToSegmentDistance(t,r,s)),f=Math.min(c.pointToSegmentDistance(r,e,t),c.pointToSegmentDistance(s,e,t));return Math.min(d,f)}function Zm(e,t,r,s,c){if(!Za(t,e.length)||!Za(s,r.length))return NaN;let d=1/0;for(let f=t[0];f<t[1];++f)for(let g=s[0];g<s[1];++g){if(pu(e[f],e[f+1],r[g],r[g+1]))return 0;d=Math.min(d,qm(e[f],e[f+1],r[g],r[g+1],c))}return d}function Wm(e,t,r,s,c){if(!Za(t,e.length)||!Za(s,r.length))return NaN;let d=1/0;for(let f=t[0];f<=t[1];++f)for(let g=s[0];g<=s[1];++g)if(0===(d=Math.min(d,c.distance(e[f],r[g]))))return d;return d}function Km(e,t,r){if(Ps(e,t,!0))return 0;let s=1/0;for(const c of t){const d=c.length;if(d<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(c[0]!==c[d-1]&&0===(s=Math.min(s,r.pointToSegmentDistance(e,c[d-1],c[0])))||0===(s=Math.min(s,Wf(e,c,r))))return s}return s}function Ph(e,t,r,s){if(!Za(t,e.length))return NaN;for(let d=t[0];d<=t[1];++d)if(Ps(e[d],r,!0))return 0;let c=1/0;for(let d=t[0];d<t[1];++d)for(const f of r)for(let g=0,y=f.length,b=y-1;g<y;b=g++){if(pu(e[d],e[d+1],f[b],f[g]))return 0;c=Math.min(c,qm(e[d],e[d+1],f[b],f[g],s))}return c}function Oh(e,t){for(const r of e)for(let s=0;s<=r.length-1;++s)if(Ps(r[s],t,!0))return!0;return!1}function yd(e,t,r,s=1/0){const c=Gl(e),d=Gl(t);if(s!==1/0&&Wa(c,d,r)>=s)return s;if(dg(c,d)){if(Oh(e,t))return 0}else if(Oh(t,e))return 0;let f=s;for(const g of e)for(let y=0,b=g.length,C=b-1;y<b;C=y++)for(const P of t)for(let E=0,I=P.length,A=I-1;E<I;A=E++){if(pu(g[C],g[y],P[A],P[E]))return 0;f=Math.min(f,qm(g[C],g[y],P[A],P[E],r))}return f}function Eh(e,t,r,s,c,d,f){if(null===d||null===f)return;const g=Wa($l(s,d),$l(c,f),r);g<t&&e.push({dist:g,range1:d,range2:f})}function pg(e,t,r,s,c=1/0){let d=Math.min(s.distance(e[0],r[0][0]),c);if(0===d)return d;const f=new Ch([{dist:0,range1:[0,e.length-1],range2:[0,0]}],Li),g=t?Mc:fg,y=Gl(r);for(;f.length;){const b=f.pop();if(b.dist>=d)continue;const C=b.range1;if(jl(C)<=g){if(!Za(C,e.length))return NaN;if(t){const P=Ph(e,C,r,s);if(0===(d=Math.min(d,P)))return d}else for(let P=C[0];P<=C[1];++P){const E=Km(e[P],r,s);if(0===(d=Math.min(d,E)))return d}}else{const P=Pc(C,t);if(null!==P[0]){const E=Wa($l(e,P[0]),y,s);E<d&&f.push({dist:E,range1:P[0],range2:[0,0]})}if(null!==P[1]){const E=Wa($l(e,P[1]),y,s);E<d&&f.push({dist:E,range1:P[1],range2:[0,0]})}}}return d}function Kf(e,t,r,s,c,d=1/0){let f=Math.min(d,c.distance(e[0],r[0]));if(0===f)return f;const g=new Ch([{dist:0,range1:[0,e.length-1],range2:[0,r.length-1]}],Li),y=t?Mc:fg,b=s?Mc:fg;for(;g.length;){const C=g.pop();if(C.dist>=f)continue;const P=C.range1,E=C.range2;if(jl(P)<=y&&jl(E)<=b){if(!Za(P,e.length)||!Za(E,r.length))return NaN;if(t&&s?f=Math.min(f,Zm(e,P,r,E,c)):t||s?t&&!s?f=Math.min(f,Hm(r,E,e,P,c)):!t&&s&&(f=Math.min(f,Hm(e,P,r,E,c))):f=Math.min(f,Wm(e,P,r,E,c)),0===f)return f}else{const I=Pc(P,t),A=Pc(E,s);Eh(g,f,c,e,r,I[0],A[0]),Eh(g,f,c,e,r,I[0],A[1]),Eh(g,f,c,e,r,I[1],A[0]),Eh(g,f,c,e,r,I[1],A[1])}}return f}function vd(e,t,r,s,c=1/0){let d=c;const f=$l(e,[0,e.length-1]);for(const g of r)if(!(d!==1/0&&Wa(f,$l(g,[0,g.length-1]),s)>=d)&&(d=Math.min(d,Kf(e,t,g,!0,s,d)),0===d))return d;return d}function gg(e,t,r,s,c=1/0){let d=c;const f=$l(e,[0,e.length-1]);for(const g of r){if(d!==1/0&&Wa(f,Gl(g),s)>=d)continue;const y=pg(e,t,g,s,d);if(isNaN(y))return y;if(0===(d=Math.min(d,y)))return d}return d}function bd(e){return"Point"===e||"MultiPoint"===e||"LineString"===e||"MultiLineString"===e||"Polygon"===e||"MultiPolygon"===e}class xd{constructor(t,r){this.type=Ae,this.geojson=t,this.geometries=r}static parse(t,r){if(2!==t.length)return r.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(Yn(t[1])){const s=t[1];if("FeatureCollection"===s.type){for(let c=0;c<s.features.length;++c)if(bd(s.features[c].geometry.type))return new xd(s,s.features[c].geometry)}else if("Feature"===s.type){if(bd(s.geometry.type))return new xd(s,s.geometry)}else if(bd(s.type))return new xd(s,s)}return r.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const r=t.geometry(),s=t.canonicalID();if(null!=r&&null!=s){if("Point"===t.geometryType())return function(c,d,f){const g=[];for(const b of c)for(const C of b)g.push(Hl(C,d));const y=new _d(g[0][1],"meters");return"Point"===f.type||"MultiPoint"===f.type||"LineString"===f.type?Kf(g,!1,"Point"===f.type?[f.coordinates]:f.coordinates,"LineString"===f.type,y):"MultiLineString"===f.type?vd(g,!1,f.coordinates,y):"Polygon"===f.type||"MultiPolygon"===f.type?gg(g,!1,"Polygon"===f.type?[f.coordinates]:f.coordinates,y):null}(r,s,this.geometries);if("LineString"===t.geometryType())return function(c,d,f){const g=[];for(const b of c){const C=[];for(const P of b)C.push(Hl(P,d));g.push(C)}const y=new _d(g[0][0][1],"meters");if("Point"===f.type||"MultiPoint"===f.type||"LineString"===f.type)return vd("Point"===f.type?[f.coordinates]:f.coordinates,"LineString"===f.type,g,y);if("MultiLineString"===f.type){let b=1/0;for(let C=0;C<f.coordinates.length;C++){const P=vd(f.coordinates[C],!0,g,y,b);if(isNaN(P))return P;if(0===(b=Math.min(b,P)))return b}return b}if("Polygon"===f.type||"MultiPolygon"===f.type){let b=1/0;for(let C=0;C<g.length;C++){const P=gg(g[C],!0,"Polygon"===f.type?[f.coordinates]:f.coordinates,y,b);if(isNaN(P))return P;if(0===(b=Math.min(b,P)))return b}return b}return null}(r,s,this.geometries);if("Polygon"===t.geometryType())return function(c,d,f){const g=[];for(const b of function(C,P){const E=C.length;if(E<=1)return[C];const I=[];let A,l;for(let u=0;u<E;u++){const p=gw(C[u]);0!==p&&(C[u].area=Math.abs(p),void 0===l&&(l=p<0),l===p<0?(A&&I.push(A),A=[C[u]]):A.push(C[u]))}return A&&I.push(A),I}(c)){const C=[];for(let P=0;P<b.length;++P)C.push(Mh(b[P],d));g.push(C)}const y=new _d(g[0][0][0][1],"meters");if("Point"===f.type||"MultiPoint"===f.type||"LineString"===f.type)return gg("Point"===f.type?[f.coordinates]:f.coordinates,"LineString"===f.type,g,y);if("MultiLineString"===f.type){let b=1/0;for(let C=0;C<f.coordinates.length;C++){const P=gg(f.coordinates[C],!0,g,y,b);if(isNaN(P))return P;if(0===(b=Math.min(b,P)))return b}return b}return"Polygon"===f.type||"MultiPolygon"===f.type?function(b,C,P){let E=1/0;for(const I of b)for(const A of C){const l=yd(I,A,P,E);if(isNaN(l))return l;if(0===(E=Math.min(E,l)))return E}return E}("Polygon"===f.type?[f.coordinates]:f.coordinates,g,y):null}(r,s,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var Yf=xd;function Th(e){if(e instanceof vl&&("get"===e.name&&1===e.args.length||"feature-state"===e.name||"has"===e.name&&1===e.args.length||"properties"===e.name||"geometry-type"===e.name||"id"===e.name||/^filter-/.test(e.name))||e instanceof wh||e instanceof Yf)return!1;let t=!0;return e.eachChild(r=>{t&&!Th(r)&&(t=!1)}),t}function Oc(e){if(e instanceof vl&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild(r=>{t&&!Oc(r)&&(t=!1)}),t}function mg(e){if(e instanceof vl&&"config"===e.name)return!1;let t=!0;return e.eachChild(r=>{t&&!mg(r)&&(t=!1)}),t}function mu(e,t){if(e instanceof vl&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild(s=>{r&&!mu(s,t)&&(r=!1)}),r}class _u{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(2!==t.length||"string"!=typeof t[1])return r.error("'var' expression requires exactly one string literal argument.");const s=t[1];return r.scope.has(s)?new _u(s,r.scope.get(s)):r.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Ih=_u;class Ca{constructor(t,r=[],s,c=new Vm,d=[],f){this.registry=t,this.path=r,this.key=r.map(g=>`[${g}]`).join(""),this.scope=c,this.errors=d,this.expectedType=s,this.options=f}parse(t,r,s,c,d={}){return r||s?this.concat(r,s,c)._parse(t,d):this._parse(t,d)}_parse(t,r){function s(c,d,f){return"assert"===f?new zo(d,[c]):"coerce"===f?new Ha(d,[c]):c}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const c="string"==typeof t[0]?this.registry[t[0]]:void 0;if(c){let d=c.parse(t,this);if(!d)return null;if(this.expectedType){const f=this.expectedType,g=d.type;if("string"!==f.kind&&"number"!==f.kind&&"boolean"!==f.kind&&"object"!==f.kind&&"array"!==f.kind||"value"!==g.kind)if("color"!==f.kind&&"formatted"!==f.kind&&"resolvedImage"!==f.kind||"value"!==g.kind&&"string"!==g.kind){if(this.checkSubtype(f,g))return null}else d=s(d,f,r.typeAnnotation||"coerce");else d=s(d,f,r.typeAnnotation||"assert")}if(!(d instanceof Ms)&&"resolvedImage"!==d.type.kind&&Ec(d)){const f=new fu(this.options);try{d=new Ms(d.type,d.evaluate(f))}catch(g){return this.error(g.message),null}}return d}return Ha.parse(["to-array",t],this)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,s){const c="number"==typeof t?this.path.concat(t):this.path,d=s?this.scope.concat(s):this.scope;return new Ca(this.registry,c,r||null,d,this.errors,this.options)}error(t,...r){const s=`${this.key}${r.map(c=>`[${c}]`).join("")}`;this.errors.push(new hi(s,t))}checkSubtype(t,r){const s=Xi(t,r);return s&&this.error(s),s}}var wd=Ca;function Ec(e){if(e instanceof Ih)return Ec(e.boundExpression);if(e instanceof vl&&"error"===e.name||e instanceof vl&&"config"===e.name||e instanceof vh||e instanceof wh||e instanceof Yf)return!1;const t=e instanceof Ha||e instanceof zo;let r=!0;return e.eachChild(s=>{r=t?r&&Ec(s):r&&s instanceof Ms}),!!r&&Th(e)&&mu(e,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function Cd(e,t){const r=e.length-1;let s,c,d=0,f=r,g=0;for(;d<=f;)if(g=Math.floor((d+f)/2),s=e[g],c=e[g+1],s<=t){if(g===r||t<c)return g;d=g+1}else{if(!(s>t))throw new Ko("Input is not a number.");f=g-1}return 0}class Sh{constructor(t,r,s){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[c,d]of s)this.labels.push(c),this.outputs.push(d)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const s=r.parse(t[1],1,Ae);if(!s)return null;const c=[];let d=null;r.expectedType&&"value"!==r.expectedType.kind&&(d=r.expectedType);for(let f=1;f<t.length;f+=2){const g=1===f?-1/0:t[f],y=t[f+1],b=f,C=f+1;if("number"!=typeof g)return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',b);if(c.length&&c[c.length-1][0]>=g)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',b);const P=r.parse(y,C,d);if(!P)return null;d=d||P.type,c.push([g,P])}return new Sh(d,s,c)}evaluate(t){const r=this.labels,s=this.outputs;if(1===r.length)return s[0].evaluate(t);const c=this.input.evaluate(t);if(c<=r[0])return s[0].evaluate(t);const d=r.length;return c>=r[d-1]?s[d-1].evaluate(t):s[Cd(r,c)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&t.push(this.labels[r]),t.push(this.outputs[r].serialize());return t}}var Ym=Sh;function vn(e,t,r){return e*(1-r)+t*r}function _g(e,t,r){return e.map((s,c)=>vn(s,t[c],r))}var Md=Object.freeze({__proto__:null,array:_g,color:function(e,t,r){return new bn(vn(e.r,t.r,r),vn(e.g,t.g,r),vn(e.b,t.b,r),vn(e.a,t.a,r))},number:vn});const hs=4/29,Tc=6/29,Xm=3*Tc*Tc,Bo=Tc*Tc*Tc,Xf=Math.PI/180,yu=180/Math.PI;function Ji(e){return e>Bo?Math.pow(e,1/3):e/Xm+hs}function Qf(e){return e>Tc?e*e*e:Xm*(e-hs)}function vu(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function bu(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ua(e){const t=bu(e.r),r=bu(e.g),s=bu(e.b),c=Ji((.4124564*t+.3575761*r+.1804375*s)/.95047),d=Ji((.2126729*t+.7151522*r+.072175*s)/1);return{l:116*d-16,a:500*(c-d),b:200*(d-Ji((.0193339*t+.119192*r+.9503041*s)/1.08883)),alpha:e.a}}function Ic(e){let t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,s=isNaN(e.b)?t:t-e.b/200;return t=1*Qf(t),r=.95047*Qf(r),s=1.08883*Qf(s),new bn(vu(3.2404542*r-1.5371385*t-.4985314*s),vu(-.969266*r+1.8760108*t+.041556*s),vu(.0556434*r-.2040259*t+1.0572252*s),e.alpha)}function mw(e,t,r){const s=t-e;return e+r*(s>180||s<-180?s-360*Math.round(s/360):s)}const mi={forward:ua,reverse:Ic,interpolate:function(e,t,r){return{l:vn(e.l,t.l,r),a:vn(e.a,t.a,r),b:vn(e.b,t.b,r),alpha:vn(e.alpha,t.alpha,r)}}},Os={forward:function(e){const{l:t,a:r,b:s}=ua(e),c=Math.atan2(s,r)*yu;return{h:c<0?c+360:c,c:Math.sqrt(r*r+s*s),l:t,alpha:e.a}},reverse:function(e){const t=e.h*Xf,r=e.c;return Ic({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:mw(e.h,t.h,r),c:vn(e.c,t.c,r),l:vn(e.l,t.l,r),alpha:vn(e.alpha,t.alpha,r)}}};var Jf=Object.freeze({__proto__:null,hcl:Os,lab:mi});class tp{constructor(t,r,s,c,d){this.type=t,this.operator=r,this.interpolation=s,this.input=c,this.labels=[],this.outputs=[];for(const[f,g]of d)this.labels.push(f),this.outputs.push(g)}static interpolationFactor(t,r,s,c){let d=0;if("exponential"===t.name)d=Pd(r,t.base,s,c);else if("linear"===t.name)d=Pd(r,1,s,c);else if("cubic-bezier"===t.name){const f=t.controlPoints;d=new Fn(f[0],f[1],f[2],f[3]).solve(Pd(r,1,s,c))}return d}static parse(t,r){let[s,c,d,...f]=t;if(!Array.isArray(c)||0===c.length)return r.error("Expected an interpolation type expression.",1);if("linear"===c[0])c={name:"linear"};else if("exponential"===c[0]){const b=c[1];if("number"!=typeof b)return r.error("Exponential interpolation requires a numeric base.",1,1);c={name:"exponential",base:b}}else{if("cubic-bezier"!==c[0])return r.error(`Unknown interpolation type ${String(c[0])}`,1,0);{const b=c.slice(1);if(4!==b.length||b.some(C=>"number"!=typeof C||C<0||C>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);c={name:"cubic-bezier",controlPoints:b}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(d=r.parse(d,2,Ae),!d)return null;const g=[];let y=null;"interpolate-hcl"===s||"interpolate-lab"===s?y=Jr:r.expectedType&&"value"!==r.expectedType.kind&&(y=r.expectedType);for(let b=0;b<f.length;b+=2){const C=f[b],P=f[b+1],E=b+3,I=b+4;if("number"!=typeof C)return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(g.length&&g[g.length-1][0]>=C)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',E);const A=r.parse(P,I,y);if(!A)return null;y=y||A.type,g.push([C,A])}return"number"===y.kind||"color"===y.kind||"array"===y.kind&&"number"===y.itemType.kind&&"number"==typeof y.N?new tp(y,s,c,d,g):r.error(`Type ${no(y)} is not interpolatable.`)}evaluate(t){const r=this.labels,s=this.outputs;if(1===r.length)return s[0].evaluate(t);const c=this.input.evaluate(t);if(c<=r[0])return s[0].evaluate(t);const d=r.length;if(c>=r[d-1])return s[d-1].evaluate(t);const f=Cd(r,c),g=tp.interpolationFactor(this.interpolation,c,r[f],r[f+1]),y=s[f].evaluate(t),b=s[f+1].evaluate(t);return"interpolate"===this.operator?Md[this.type.kind.toLowerCase()](y,b,g):"interpolate-hcl"===this.operator?Os.reverse(Os.interpolate(Os.forward(y),Os.forward(b),g)):mi.reverse(mi.interpolate(mi.forward(y),mi.forward(b),g))}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,t,this.input.serialize()];for(let s=0;s<this.labels.length;s++)r.push(this.labels[s],this.outputs[s].serialize());return r}}function Pd(e,t,r,s){const c=s-r,d=e-r;return 0===c?0:1===t?d/c:(Math.pow(t,d)-1)/(Math.pow(t,c)-1)}var Ka=tp;class xu{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expectected at least one argument.");let s=null;const c=r.expectedType;c&&"value"!==c.kind&&(s=c);const d=[];for(const g of t.slice(1)){const y=r.parse(g,1+d.length,s,void 0,{typeAnnotation:"omit"});if(!y)return null;s=s||y.type,d.push(y)}const f=c&&d.some(g=>Xi(c,g.type));return new xu(f?Ye:s,d)}evaluate(t){let r,s=null,c=0;for(const d of this.args){if(c++,s=d.evaluate(t),s&&s instanceof Ri&&!s.available&&(r||(r=s),s=null,c===this.args.length))return r;if(null!==s)break}return s}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(r=>{t.push(r.serialize())}),t}}var Ni=xu;class lr{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const s=[];for(let d=1;d<t.length-1;d+=2){const f=t[d];if("string"!=typeof f)return r.error(`Expected string, but found ${typeof f} instead.`,d);if(/[^a-zA-Z0-9_]/.test(f))return r.error("Variable names must contain only alphanumeric characters or '_'.",d);const g=r.parse(t[d+1],d+1);if(!g)return null;s.push([f,g])}const c=r.parse(t[t.length-1],t.length-1,r.expectedType,s);return c?new lr(s,c):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[r,s]of this.bindings)t.push(r,s.serialize());return t.push(this.result.serialize()),t}}var xi=lr;class ep{constructor(t,r,s){this.type=t,this.index=r,this.input=s}static parse(t,r){if(3!==t.length)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,Ae),c=r.parse(t[2],2,Zr(r.expectedType||Ye));return s&&c?new ep(c.type.itemType,s,c):null}evaluate(t){const r=this.index.evaluate(t),s=this.input.evaluate(t);if(r<0)throw new Ko(`Array index out of bounds: ${r} < 0.`);if(r>=s.length)throw new Ko(`Array index out of bounds: ${r} > ${s.length-1}.`);if(r!==Math.floor(r))throw new Ko(`Array index must be an integer, but found ${r} instead.`);return s[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var wu=ep;class Dh{constructor(t,r){this.type=Tr,this.needle=t,this.haystack=r}static parse(t,r){if(3!==t.length)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,Ye),c=r.parse(t[2],2,Ye);return s&&c?pd(s.type,[Tr,br,Ae,ws,Ye])?new Dh(s,c):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${no(s.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(null==s)return!1;if(!ar(r,["boolean","string","number","null"]))throw new Ko(`Expected first argument to be of type boolean, string, number or null, but found ${no(gi(r))} instead.`);if(!ar(s,["string","array"]))throw new Ko(`Expected second argument to be of type array or string, but found ${no(gi(s))} instead.`);return s.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Wy=Dh;class Od{constructor(t,r,s){this.type=Ae,this.needle=t,this.haystack=r,this.fromIndex=s}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,Ye),c=r.parse(t[2],2,Ye);if(!s||!c)return null;if(!pd(s.type,[Tr,br,Ae,ws,Ye]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${no(s.type)} instead`);if(4===t.length){const d=r.parse(t[3],3,Ae);return d?new Od(s,c,d):null}return new Od(s,c)}evaluate(t){const r=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!ar(r,["boolean","string","number","null"]))throw new Ko(`Expected first argument to be of type boolean, string, number or null, but found ${no(gi(r))} instead.`);if(!ar(s,["string","array"]))throw new Ko(`Expected second argument to be of type array or string, but found ${no(gi(s))} instead.`);if(this.fromIndex){const c=this.fromIndex.evaluate(t);return s.indexOf(r,c)}return s.indexOf(r)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Cu=Od;class Sc{constructor(t,r,s,c,d,f){this.inputType=t,this.type=r,this.input=s,this.cases=c,this.outputs=d,this.otherwise=f}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let s,c;r.expectedType&&"value"!==r.expectedType.kind&&(c=r.expectedType);const d={},f=[];for(let b=2;b<t.length-1;b+=2){let C=t[b];const P=t[b+1];Array.isArray(C)||(C=[C]);const E=r.concat(b);if(0===C.length)return E.error("Expected at least one branch label.");for(const A of C){if("number"!=typeof A&&"string"!=typeof A)return E.error("Branch labels must be numbers or strings.");if("number"==typeof A&&Math.abs(A)>Number.MAX_SAFE_INTEGER)return E.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof A&&Math.floor(A)!==A)return E.error("Numeric branch labels must be integer values.");if(s){if(E.checkSubtype(s,gi(A)))return null}else s=gi(A);if(void 0!==d[String(A)])return E.error("Branch labels must be unique.");d[String(A)]=f.length}const I=r.parse(P,b,c);if(!I)return null;c=c||I.type,f.push(I)}const g=r.parse(t[1],1,Ye);if(!g)return null;const y=r.parse(t[t.length-1],t.length-1,c);return y?"value"!==g.type.kind&&r.concat(1).checkSubtype(s,g.type)?null:new Sc(s,c,g,d,f,y):null}evaluate(t){const r=this.input.evaluate(t);return(gi(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),s=[],c={};for(const f of r){const g=c[this.cases[f]];void 0===g?(c[this.cases[f]]=s.length,s.push([this.cases[f],[f]])):s[g][1].push(f)}const d=f=>"number"===this.inputType.kind?Number(f):f;for(const[f,g]of s)t.push(1===g.length?d(g[0]):g.map(d)),t.push(this.outputs[f].serialize());return t.push(this.otherwise.serialize()),t}}var Qm=Sc;class Ks{constructor(t,r,s){this.type=t,this.branches=r,this.otherwise=s}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let s;r.expectedType&&"value"!==r.expectedType.kind&&(s=r.expectedType);const c=[];for(let f=1;f<t.length-1;f+=2){const g=r.parse(t[f],f,Tr);if(!g)return null;const y=r.parse(t[f+1],f+1,s);if(!y)return null;c.push([g,y]),s=s||y.type}const d=r.parse(t[t.length-1],t.length-1,s);return d?new Ks(s,c,d):null}evaluate(t){for(const[r,s]of this.branches)if(r.evaluate(t))return s.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,s]of this.branches)t(r),t(s);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(r=>{t.push(r.serialize())}),t}}var Jm=Ks;class np{constructor(t,r,s,c){this.type=t,this.input=r,this.beginIndex=s,this.endIndex=c}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,Ye),c=r.parse(t[2],2,Ae);if(!s||!c)return null;if(!pd(s.type,[Zr(Ye),br,Ye]))return r.error(`Expected first argument to be of type array or string, but found ${no(s.type)} instead`);if(4===t.length){const d=r.parse(t[3],3,Ae);return d?new np(s.type,s,c,d):null}return new np(s.type,s,c)}evaluate(t){const r=this.input.evaluate(t),s=this.beginIndex.evaluate(t);if(!ar(r,["string","array"]))throw new Ko(`Expected first argument to be of type array or string, but found ${no(gi(r))} instead.`);if(this.endIndex){const c=this.endIndex.evaluate(t);return r.slice(s,c)}return r.slice(s)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Me=np;function ro(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function yg(e,t,r,s){return 0===s.compare(t,r)}function Ed(e,t,r){const s="=="!==e&&"!="!==e;return class k5{constructor(d,f,g){this.type=Tr,this.lhs=d,this.rhs=f,this.collator=g,this.hasUntypedArgument="value"===d.type.kind||"value"===f.type.kind}static parse(d,f){if(3!==d.length&&4!==d.length)return f.error("Expected two or three arguments.");const g=d[0];let y=f.parse(d[1],1,Ye);if(!y)return null;if(!ro(g,y.type))return f.concat(1).error(`"${g}" comparisons are not supported for type '${no(y.type)}'.`);let b=f.parse(d[2],2,Ye);if(!b)return null;if(!ro(g,b.type))return f.concat(2).error(`"${g}" comparisons are not supported for type '${no(b.type)}'.`);if(y.type.kind!==b.type.kind&&"value"!==y.type.kind&&"value"!==b.type.kind)return f.error(`Cannot compare types '${no(y.type)}' and '${no(b.type)}'.`);s&&("value"===y.type.kind&&"value"!==b.type.kind?y=new zo(b.type,[y]):"value"!==y.type.kind&&"value"===b.type.kind&&(b=new zo(y.type,[b])));let C=null;if(4===d.length){if("string"!==y.type.kind&&"string"!==b.type.kind&&"value"!==y.type.kind&&"value"!==b.type.kind)return f.error("Cannot use collator to compare non-string types.");if(C=f.parse(d[3],3,Do),!C)return null}return new k5(y,b,C)}evaluate(d){const f=this.lhs.evaluate(d),g=this.rhs.evaluate(d);if(s&&this.hasUntypedArgument){const y=gi(f),b=gi(g);if(y.kind!==b.kind||"string"!==y.kind&&"number"!==y.kind)throw new Ko(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${y.kind}, ${b.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const y=gi(f),b=gi(g);if("string"!==y.kind||"string"!==b.kind)return t(d,f,g)}return this.collator?r(d,f,g,this.collator.evaluate(d)):t(d,f,g)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}serialize(){const d=[e];return this.eachChild(f=>{d.push(f.serialize())}),d}}}const fs=Ed("==",function(e,t,r){return t===r},yg),t_=Ed("!=",function(e,t,r){return t!==r},function(e,t,r,s){return!yg(0,t,r,s)}),rp=Ed("<",function(e,t,r){return t<r},function(e,t,r,s){return s.compare(t,r)<0}),Ya=Ed(">",function(e,t,r){return t>r},function(e,t,r,s){return s.compare(t,r)>0}),kh=Ed("<=",function(e,t,r){return t<=r},function(e,t,r,s){return s.compare(t,r)<=0}),op=Ed(">=",function(e,t,r){return t>=r},function(e,t,r,s){return s.compare(t,r)>=0});class vg{constructor(t,r,s,c,d,f){this.type=br,this.number=t,this.locale=r,this.currency=s,this.unit=c,this.minFractionDigits=d,this.maxFractionDigits=f}static parse(t,r){if(3!==t.length)return r.error("Expected two arguments.");const s=r.parse(t[1],1,Ae);if(!s)return null;const c=t[2];if("object"!=typeof c||Array.isArray(c))return r.error("NumberFormat options argument must be an object.");let d=null;if(c.locale&&(d=r.parse(c.locale,1,br),!d))return null;let f=null;if(c.currency&&(f=r.parse(c.currency,1,br),!f))return null;let g=null;if(c.unit&&(g=r.parse(c.unit,1,br),!g))return null;let y=null;if(c["min-fraction-digits"]&&(y=r.parse(c["min-fraction-digits"],1,Ae),!y))return null;let b=null;return c["max-fraction-digits"]&&(b=r.parse(c["max-fraction-digits"],1,Ae),!b)?null:new vg(s,d,f,g,y,b)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class bg{constructor(t){this.type=Ae,this.input=t}static parse(t,r){if(2!==t.length)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=r.parse(t[1],1);return s?"array"!==s.type.kind&&"string"!==s.type.kind&&"value"!==s.type.kind?r.error(`Expected argument of type string or array, but found ${no(s.type)} instead.`):new bg(s):null}evaluate(t){const r=this.input.evaluate(t);if("string"==typeof r||Array.isArray(r))return r.length;throw new Ko(`Expected value to be of type string or array, but found ${no(gi(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(r=>{t.push(r.serialize())}),t}}function Rh(e){return function(){e=1831565813+(e|=0)|0;let t=Math.imul(e^e>>>15,1|e);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const Ls={"==":fs,"!=":t_,">":Ya,"<":rp,">=":op,"<=":kh,array:zo,at:wu,boolean:zo,case:Jm,coalesce:Ni,collator:vh,format:aa,image:bi,in:Wy,"index-of":Cu,interpolate:Ka,"interpolate-hcl":Ka,"interpolate-lab":Ka,length:bg,let:xi,literal:Ms,match:Qm,number:zo,"number-format":vg,object:zo,slice:Me,step:Ym,string:zo,"to-boolean":Ha,"to-color":Ha,"to-number":Ha,"to-string":Ha,var:Ih,within:wh,distance:Yf};function bl(e,[t,r,s,c]){t=t.evaluate(e),r=r.evaluate(e),s=s.evaluate(e);const d=c?c.evaluate(e):1,f=sa(t,r,s,d);if(f)throw new Ko(f);return new bn(t/255*d,r/255*d,s/255*d,d)}function Td(e,[t,r,s,c]){t=t.evaluate(e),r=r.evaluate(e),s=s.evaluate(e);const d=c?c.evaluate(e):1,f=(C=r,P=s,E=d,"number"==typeof(b=t)&&b>=0&&b<=360?"number"==typeof C&&C>=0&&C<=100&&"number"==typeof P&&P>=0&&P<=100?void 0===E||"number"==typeof E&&E>=0&&E<=1?null:`Invalid hsla value [${[b,C,P,E].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${("number"==typeof E?[b,C,P,E]:[b,C,P]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${("number"==typeof E?[b,C,P,E]:[b,C,P]).join(", ")}]: 'h' must be between 0 and 360.`);var b,C,P,E;if(f)throw new Ko(f);const g=`hsla(${t}, ${r}%, ${s}%, ${d})`,y=bn.parse(g);if(!y)throw new Ko(`Failed to parse HSLA color: ${g}`);return y}function Id(e,t){return e in t}function Ma(e,t){const r=t[e];return void 0===r?null:r}function e_(e,t){switch(e){case"string":return String(t);case"number":return+t;case"boolean":return!!t;case"color":return bn.parse(t)}return t}function ip(e,t,r,s){return void 0!==s&&(e=s*Math.round(e/s)),void 0!==t&&e<t&&(e=t),void 0!==r&&e>r&&(e=r),e}function Ky(e,t,r){r.length&&(t+=`\x1f${r}`);const s=e.getConfig(t);if(!s)return null;const{type:c,value:d,values:f,minValue:g,maxValue:y,stepValue:b}=s,C=s.default.evaluate(e);let P=d?d.evaluate(e):C;return c&&(P=e_(c,P)),void 0!==d&&void 0!==P&&f&&!f.includes(P)&&(P=C,c&&(P=e_(c,P))),void 0===P||void 0===g&&void 0===y&&void 0===b||("number"==typeof P?P=ip(P,g,y,b):Array.isArray(P)&&(P=P.map(E=>"number"==typeof E?ip(E,g,y,b):E))),P}function Ac(e){return{type:e}}vl.register(Ls,{error:[{kind:"error"},[br],(e,[t])=>{throw new Ko(t.evaluate(e))}],typeof:[br,[Ye],(e,[t])=>no(gi(t.evaluate(e)))],"to-rgba":[Zr(Ae,4),[Jr],(e,[t])=>t.evaluate(e).toArray()],rgb:[Jr,[Ae,Ae,Ae],bl],rgba:[Jr,[Ae,Ae,Ae,Ae],bl],hsl:[Jr,[Ae,Ae,Ae],Td],hsla:[Jr,[Ae,Ae,Ae,Ae],Td],has:{type:Tr,overloads:[[[br],(e,[t])=>Id(t.evaluate(e),e.properties())],[[br,dn],(e,[t,r])=>Id(t.evaluate(e),r.evaluate(e))]]},get:{type:Ye,overloads:[[[br],(e,[t])=>Ma(t.evaluate(e),e.properties())],[[br,dn],(e,[t,r])=>Ma(t.evaluate(e),r.evaluate(e))]]},config:{type:Ye,overloads:[[[br],(e,[t])=>Ky(e,t.evaluate(e),"")],[[br,br],(e,[t,r])=>Ky(e,t.evaluate(e),r.evaluate(e))]]},"feature-state":[Ye,[br],(e,[t])=>Ma(t.evaluate(e),e.featureState||{})],properties:[dn,[],e=>e.properties()],"geometry-type":[br,[],e=>e.geometryType()],id:[Ye,[],e=>e.id()],zoom:[Ae,[],e=>e.globals.zoom],pitch:[Ae,[],e=>e.globals.pitch||0],"distance-from-center":[Ae,[],e=>e.distanceFromCenter()],"measure-light":[Ae,[br],(e,[t])=>e.measureLight(t.evaluate(e))],"heatmap-density":[Ae,[],e=>e.globals.heatmapDensity||0],"line-progress":[Ae,[],e=>e.globals.lineProgress||0],"raster-value":[Ae,[],e=>e.globals.rasterValue||0],"sky-radial-progress":[Ae,[],e=>e.globals.skyRadialProgress||0],accumulated:[Ye,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[Ae,Ac(Ae),(e,t)=>{let r=0;for(const s of t)r+=s.evaluate(e);return r}],"*":[Ae,Ac(Ae),(e,t)=>{let r=1;for(const s of t)r*=s.evaluate(e);return r}],"-":{type:Ae,overloads:[[[Ae,Ae],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[Ae],(e,[t])=>-t.evaluate(e)]]},"/":[Ae,[Ae,Ae],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[Ae,[Ae,Ae],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[Ae,[],()=>Math.LN2],pi:[Ae,[],()=>Math.PI],e:[Ae,[],()=>Math.E],"^":[Ae,[Ae,Ae],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[Ae,[Ae],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[Ae,[Ae],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[Ae,[Ae],(e,[t])=>Math.log(t.evaluate(e))],log2:[Ae,[Ae],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[Ae,[Ae],(e,[t])=>Math.sin(t.evaluate(e))],cos:[Ae,[Ae],(e,[t])=>Math.cos(t.evaluate(e))],tan:[Ae,[Ae],(e,[t])=>Math.tan(t.evaluate(e))],asin:[Ae,[Ae],(e,[t])=>Math.asin(t.evaluate(e))],acos:[Ae,[Ae],(e,[t])=>Math.acos(t.evaluate(e))],atan:[Ae,[Ae],(e,[t])=>Math.atan(t.evaluate(e))],min:[Ae,Ac(Ae),(e,t)=>Math.min(...t.map(r=>r.evaluate(e)))],max:[Ae,Ac(Ae),(e,t)=>Math.max(...t.map(r=>r.evaluate(e)))],abs:[Ae,[Ae],(e,[t])=>Math.abs(t.evaluate(e))],round:[Ae,[Ae],(e,[t])=>{const r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[Ae,[Ae],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[Ae,[Ae],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[Tr,[br,Ye],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[Tr,[Ye],(e,[t])=>e.id()===t.value],"filter-type-==":[Tr,[br],(e,[t])=>e.geometryType()===t.value],"filter-<":[Tr,[br,Ye],(e,[t,r])=>{const s=e.properties()[t.value],c=r.value;return typeof s==typeof c&&s<c}],"filter-id-<":[Tr,[Ye],(e,[t])=>{const r=e.id(),s=t.value;return typeof r==typeof s&&r<s}],"filter->":[Tr,[br,Ye],(e,[t,r])=>{const s=e.properties()[t.value],c=r.value;return typeof s==typeof c&&s>c}],"filter-id->":[Tr,[Ye],(e,[t])=>{const r=e.id(),s=t.value;return typeof r==typeof s&&r>s}],"filter-<=":[Tr,[br,Ye],(e,[t,r])=>{const s=e.properties()[t.value],c=r.value;return typeof s==typeof c&&s<=c}],"filter-id-<=":[Tr,[Ye],(e,[t])=>{const r=e.id(),s=t.value;return typeof r==typeof s&&r<=s}],"filter->=":[Tr,[br,Ye],(e,[t,r])=>{const s=e.properties()[t.value],c=r.value;return typeof s==typeof c&&s>=c}],"filter-id->=":[Tr,[Ye],(e,[t])=>{const r=e.id(),s=t.value;return typeof r==typeof s&&r>=s}],"filter-has":[Tr,[Ye],(e,[t])=>t.value in e.properties()],"filter-has-id":[Tr,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[Tr,[Zr(br)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[Tr,[Zr(Ye)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[Tr,[br,Zr(Ye)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[Tr,[br,Zr(Ye)],(e,[t,r])=>function(s,c,d,f){for(;d<=f;){const g=d+f>>1;if(c[g]===s)return!0;c[g]>s?f=g-1:d=g+1}return!1}(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:Tr,overloads:[[[Tr,Tr],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[Ac(Tr),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:Tr,overloads:[[[Tr,Tr],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[Ac(Tr),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[Tr,[Tr],(e,[t])=>!t.evaluate(e)],"is-supported-script":[Tr,[br],(e,[t])=>{const r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[br,[br],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[br,[br],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[br,Ac(Ye),(e,t)=>t.map(r=>Bl(r.evaluate(e))).join("")],"resolved-locale":[br,[Do],(e,[t])=>t.evaluate(e).resolvedLocale()],random:[Ae,[Ae,Ae,Ye],(e,t)=>{const[r,s,c]=t.map(f=>f.evaluate(e));if(r>s||r===s)return r;let d;if("string"==typeof c)d=function(f){let g=0;if(0===f.length)return g;for(let y=0;y<f.length;y++)g=(g<<5)-g+f.charCodeAt(y),g&=g;return g}(c);else{if("number"!=typeof c)throw new Ko(`Invalid seed input: ${c}`);d=c}return r+Rh(d)()*(s-r)}]});var Dc=Ls;function Pa(e){return{result:"success",value:e}}function Wr(e){return{result:"error",value:e}}function da(e,t){return!!e&&!!e.parameters&&e.parameters.indexOf(t)>-1}function Ns(e){return"data-driven"===e["property-type"]}function Mu(e){return da(e.expression,"measure-light")}function kc(e){return da(e.expression,"zoom")}function Rc(e){return!!e.expression&&e.expression.interpolated}function xl(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function n_(e){return e}function Pu(e,t){const r="color"===t.type,s=e.stops&&"object"==typeof e.stops[0][0],c=s||!(s||void 0!==e.property),d=e.type||(Rc(t)?"exponential":"interval");if(r&&((e=Zs({},e)).stops&&(e.stops=e.stops.map(b=>[b[0],bn.parse(b[1])])),e.default=bn.parse(e.default?e.default:t.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!Jf[e.colorSpace])throw new Error(`Unknown color space: ${e.colorSpace}`);let f,g,y;if("exponential"===d)f=oi;else if("interval"===d)f=xg;else if("categorical"===d){f=Zl,g=Object.create(null);for(const b of e.stops)g[b[0]]=b[1];y=typeof e.stops[0][0]}else{if("identity"!==d)throw new Error(`Unknown function type "${d}"`);f=Eu}if(s){const b={},C=[];for(let I=0;I<e.stops.length;I++){const A=e.stops[I],l=A[0].zoom;void 0===b[l]&&(b[l]={zoom:l,type:e.type,property:e.property,default:e.default,stops:[]},C.push(l)),b[l].stops.push([A[0].value,A[1]])}const P=[];for(const I of C)P.push([b[I].zoom,Pu(b[I],t)]);const E={name:"linear"};return{kind:"composite",interpolationType:E,interpolationFactor:Ka.interpolationFactor.bind(void 0,E),zoomStops:P.map(I=>I[0]),evaluate:({zoom:I},A)=>oi({stops:P,base:e.base},t,I).evaluate(I,A)}}if(c){const b="exponential"===d?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:b,interpolationFactor:Ka.interpolationFactor.bind(void 0,b),zoomStops:e.stops.map(C=>C[0]),evaluate:({zoom:C})=>f(e,t,C,g,y)}}return{kind:"source",evaluate(b,C){const P=C&&C.properties?C.properties[e.property]:void 0;return void 0===P?Ou(e.default,t.default):f(e,t,P,g,y)}}}function Ou(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function Zl(e,t,r,s,c){return Ou(typeof r===c?s[r]:void 0,e.default,t.default)}function xg(e,t,r){if("number"!==Un(r))return Ou(e.default,t.default);const s=e.stops.length;if(1===s||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[s-1][0])return e.stops[s-1][1];const c=Cd(e.stops.map(d=>d[0]),r);return e.stops[c][1]}function oi(e,t,r){const s=void 0!==e.base?e.base:1;if("number"!==Un(r))return Ou(e.default,t.default);const c=e.stops.length;if(1===c||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[c-1][0])return e.stops[c-1][1];const d=Cd(e.stops.map(C=>C[0]),r),f=function(C,P,E,I){const A=I-E,l=C-E;return 0===A?0:1===P?l/A:(Math.pow(P,l)-1)/(Math.pow(P,A)-1)}(r,s,e.stops[d][0],e.stops[d+1][0]),g=e.stops[d][1],y=e.stops[d+1][1];let b=Md[t.type]||n_;if(e.colorSpace&&"rgb"!==e.colorSpace){const C=Jf[e.colorSpace];b=(P,E)=>C.reverse(C.interpolate(C.forward(P),C.forward(E),f))}return"function"==typeof g.evaluate?{evaluate(...C){const P=g.evaluate.apply(void 0,C),E=y.evaluate.apply(void 0,C);if(void 0!==P&&void 0!==E)return b(P,E,f)}}:b(g,y,f)}function Eu(e,t,r){return"color"===t.type?r=bn.parse(r):"formatted"===t.type?r=pi.fromString(r.toString()):"resolvedImage"===t.type?r=Ri.fromString(r.toString()):Un(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0),Ou(r,e.default,t.default)}class Xo{constructor(t,r,s){var c;this.expression=t,this._warningHistory={},this._evaluator=new fu(s),this._defaultValue=r?"color"===(c=r).type&&(xl(c.default)||Array.isArray(c.default))?new bn(0,0,0,0):"color"===c.type?bn.parse(c.default)||null:void 0===c.default?null:c.default:null,this._enumValues=r&&"enum"===r.type?r.values:null}evaluateWithoutErrorHandling(t,r,s,c,d,f,g,y){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=s,this._evaluator.canonical=c||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=f,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=y||null,this.expression.evaluate(this._evaluator)}evaluate(t,r,s,c,d,f,g,y){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=s||null,this._evaluator.canonical=c||null,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=f||null,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=y||null;try{const b=this.expression.evaluate(this._evaluator);if(null==b||"number"==typeof b&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Ko(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function wl(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Dc}function Wl(e,t,r){const s=new wd(Dc,[],t?function(d){const f={color:Jr,string:br,number:Ae,enum:br,boolean:Tr,formatted:Cs,resolvedImage:$a};return"array"===d.type?Zr(f[d.value]||Ye,d.length):f[d.type]}(t):void 0,void 0,void 0,r),c=s.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return c?Pa(new Xo(c,t,r)):Wr(s.errors)}class sp{constructor(t,r,s){this.kind=t,this._styleExpression=r,this.isLightConstant=s,this.isStateDependent="constant"!==t&&!Oc(r.expression),this.isConfigDependent=!mg(r.expression)}evaluateWithoutErrorHandling(t,r,s,c,d,f){return this._styleExpression.evaluateWithoutErrorHandling(t,r,s,c,d,f)}evaluate(t,r,s,c,d,f){return this._styleExpression.evaluate(t,r,s,c,d,f)}}class Es{constructor(t,r,s,c,d){this.kind=t,this.zoomStops=s,this._styleExpression=r,this.isStateDependent="camera"!==t&&!Oc(r.expression),this.isLightConstant=d,this.isConfigDependent=!mg(r.expression),this.interpolationType=c}evaluateWithoutErrorHandling(t,r,s,c,d,f){return this._styleExpression.evaluateWithoutErrorHandling(t,r,s,c,d,f)}evaluate(t,r,s,c,d,f){return this._styleExpression.evaluate(t,r,s,c,d,f)}interpolationFactor(t,r,s){return this.interpolationType?Ka.interpolationFactor(this.interpolationType,t,r,s):0}}function Je(e,t,r){if("error"===(e=Wl(e,t,r)).result)return e;const s=e.value.expression,c=Th(s);if(!c&&!Ns(t))return Wr([new hi("","data expressions not supported")]);const d=mu(s,["zoom","pitch","distance-from-center"]);if(!d&&!kc(t))return Wr([new hi("","zoom expressions not supported")]);const f=mu(s,["measure-light"]);if(!f&&!Mu(t))return Wr([new hi("","measure-light expression not supported")]);const g=t.expression&&t.expression.relaxZoomRestriction,y=Oa(s);return y||d||g?y instanceof hi?Wr([y]):y instanceof Ka&&!Rc(t)?Wr([new hi("",'"interpolate" expressions cannot be used with this property')]):Pa(y?new Es(c?"camera":"composite",e.value,y.labels,y instanceof Ka?y.interpolation:void 0,f):new sp(c?"constant":"source",e.value,f)):Wr([new hi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class ts{constructor(t,r){this._parameters=t,this._specification=r,Zs(this,Pu(this._parameters,this._specification))}static deserialize(t){return new ts(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Oa(e){let t=null;if(e instanceof xi)t=Oa(e.result);else if(e instanceof Ni){for(const r of e.args)if(t=Oa(r),t)break}else(e instanceof Ym||e instanceof Ka)&&e.input instanceof vl&&"zoom"===e.input.name&&(t=e);return t instanceof hi||e.eachChild(r=>{const s=Oa(r);s instanceof hi?t=s:t&&s&&t!==s&&(t=new hi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function $r(e){const t=e.key,r=e.value,s=e.valueSpec||{},c=e.objectElementValidators||{},d=e.style,f=e.styleSpec;let g=[];const y=Un(r);if("object"!==y)return[new Fe(t,r,`object expected, ${y} found`)];for(const b in r){const C=b.split(".")[0];let P;c[C]?P=c[C]:s[C]?P=wi:c["*"]?P=c["*"]:s["*"]&&(P=wi),P?g=g.concat(P({key:(t&&`${t}.`)+b,value:r[b],valueSpec:s[C]||s["*"],style:d,styleSpec:f,object:r,objectKey:b},r)):g.push(new wc(t,r[b],`unknown property "${b}"`))}for(const b in s)c[b]||s[b].required&&void 0===s[b].default&&void 0===r[b]&&g.push(new Fe(t,r,`missing required property "${b}"`));return g}function Kl(e){const t=e.value,r=e.valueSpec,s=e.style,c=e.styleSpec,d=e.key,f=e.arrayElementValidator||wi;if("array"!==Un(t))return[new Fe(d,t,`array expected, ${Un(t)} found`)];if(r.length&&t.length!==r.length)return[new Fe(d,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new Fe(d,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let g={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};c.$version<7&&(g.function=r.function),"object"===Un(r.value)&&(g=r.value);let y=[];for(let b=0;b<t.length;b++)y=y.concat(f({array:t,arrayIndex:b,value:t[b],valueSpec:g,style:s,styleSpec:c,key:`${d}[${b}]`},!0));return y}function Yl(e){const t=e.key,r=e.value,s=e.valueSpec;let c=Un(r);if("number"===c&&r!=r&&(c="NaN"),"number"!==c)return[new Fe(t,r,`number expected, ${c} found`)];if("minimum"in s){let d=s.minimum;if("array"===Un(s.minimum)&&(d=s.minimum[e.arrayIndex]),r<d)return[new Fe(t,r,`${r} is less than the minimum value ${d}`)]}if("maximum"in s){let d=s.maximum;if("array"===Un(s.maximum)&&(d=s.maximum[e.arrayIndex]),r>d)return[new Fe(t,r,`${r} is greater than the maximum value ${d}`)]}return[]}function Sd(e){const t=e.valueSpec,r=Wn(e.value.type);let s,c,d,f={};const g="categorical"!==r&&void 0===e.value.property,y=!g,b="array"===Un(e.value.stops)&&"array"===Un(e.value.stops[0])&&"object"===Un(e.value.stops[0][0]),C=$r({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(I){if("identity"===r)return[new Fe(I.key,I.value,'identity function may not have a "stops" property')];let A=[];const l=I.value;return A=A.concat(Kl({key:I.key,value:l,valueSpec:I.valueSpec,style:I.style,styleSpec:I.styleSpec,arrayElementValidator:P})),"array"===Un(l)&&0===l.length&&A.push(new Fe(I.key,l,"array must have at least one stop")),A},default:function(I){return wi({key:I.key,value:I.value,valueSpec:t,style:I.style,styleSpec:I.styleSpec})}}});return"identity"===r&&g&&C.push(new Fe(e.key,e.value,'missing required property "property"')),"identity"===r||e.value.stops||C.push(new Fe(e.key,e.value,'missing required property "stops"')),"exponential"===r&&e.valueSpec.expression&&!Rc(e.valueSpec)&&C.push(new Fe(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(y&&!Ns(e.valueSpec)?C.push(new Fe(e.key,e.value,"property functions not supported")):g&&!kc(e.valueSpec)&&C.push(new Fe(e.key,e.value,"zoom functions not supported"))),"categorical"!==r&&!b||void 0!==e.value.property||C.push(new Fe(e.key,e.value,'"property" property is required')),C;function P(I){let A=[];const l=I.value,u=I.key;if("array"!==Un(l))return[new Fe(u,l,`array expected, ${Un(l)} found`)];if(2!==l.length)return[new Fe(u,l,`array length 2 expected, length ${l.length} found`)];if(b){if("object"!==Un(l[0]))return[new Fe(u,l,`object expected, ${Un(l[0])} found`)];if(void 0===l[0].zoom)return[new Fe(u,l,"object stop key must have zoom")];if(void 0===l[0].value)return[new Fe(u,l,"object stop key must have value")];const p=Wn(l[0].zoom);if("number"!=typeof p)return[new Fe(u,l[0].zoom,"stop zoom values must be numbers")];if(d&&d>p)return[new Fe(u,l[0].zoom,"stop zoom values must appear in ascending order")];p!==d&&(d=p,c=void 0,f={}),A=A.concat($r({key:`${u}[0]`,value:l[0],valueSpec:{zoom:{}},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{zoom:Yl,value:E}}))}else A=A.concat(E({key:`${u}[0]`,value:l[0],valueSpec:{},style:I.style,styleSpec:I.styleSpec},l));return wl(Go(l[1]))?A.concat([new Fe(`${u}[1]`,l[1],"expressions are not allowed in function stops.")]):A.concat(wi({key:`${u}[1]`,value:l[1],valueSpec:t,style:I.style,styleSpec:I.styleSpec}))}function E(I,A){const l=Un(I.value),u=Wn(I.value),p=null!==I.value?I.value:A;if(s){if(l!==s)return[new Fe(I.key,p,`${l} stop domain type must match previous stop domain type ${s}`)]}else s=l;if("number"!==l&&"string"!==l&&"boolean"!==l&&"number"!=typeof u&&"string"!=typeof u&&"boolean"!=typeof u)return[new Fe(I.key,p,"stop domain value must be a number, string, or boolean")];if("number"!==l&&"categorical"!==r){let m=`number expected, ${l} found`;return Ns(t)&&void 0===r&&(m+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Fe(I.key,p,m)]}return"categorical"!==r||"number"!==l||"number"==typeof u&&isFinite(u)&&Math.floor(u)===u?"categorical"!==r&&"number"===l&&"number"==typeof u&&"number"==typeof c&&void 0!==c&&u<c?[new Fe(I.key,p,"stop domain values must appear in ascending order")]:(c=u,"categorical"===r&&u in f?[new Fe(I.key,p,"stop domain values must be unique")]:(f[u]=!0,[])):[new Fe(I.key,p,`integer expected, found ${String(u)}`)]}}function Ts(e){const t=("property"===e.expressionContext?Je:Wl)(Go(e.value),e.valueSpec);if("error"===t.result)return t.value.map(s=>new Fe(`${e.key}${s.key}`,e.value,s.message));const r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Fe(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Oc(r))return[new Fe(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext)return ii(r,e);if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!mu(r,["zoom","feature-state"]))return[new Fe(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Th(r))return[new Fe(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ii(e,t){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const c of t.valueSpec.expression.parameters)r.delete(c);if(0===r.size)return[];const s=[];return e instanceof vl&&r.has(e.name)?[new Fe(t.key,t.value,`["${e.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(e.eachChild(c=>{s.push(...ii(c,t))}),s)}function ap(e){const t=e.key,r=e.value,s=e.valueSpec,c=[];return Array.isArray(s.values)?-1===s.values.indexOf(Wn(r))&&c.push(new Fe(t,r,`expected one of [${s.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(s.values).indexOf(Wn(r))&&c.push(new Fe(t,r,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(r)} found`)),c}function Xa(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!Xa(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}function Tu(e,t="fill"){if(null==e)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Xa(e)||(e=Nh(e));const r=e;let s=!0;try{s=function(b){if(!Ad(b))return b;let C=Go(b);return Lh(C),C=Lc(C),C}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(r,null,2)}\n        `)}const c=wt[`filter_${t}`],d=Wl(s,c);let f=null;if("error"===d.result)throw new Error(d.value.map(b=>`${b.key}: ${b.message}`).join(", "));f=(b,C,P)=>d.value.evaluate(b,C,{},P);let g=null,y=null;if(s!==r){const b=Wl(r,c);if("error"===b.result)throw new Error(b.value.map(C=>`${C.key}: ${C.message}`).join(", "));g=(C,P,E,I,A)=>b.value.evaluate(C,P,{},E,void 0,void 0,I,A),y=!Th(b.value.expression)}return{filter:f,dynamicFilter:g||void 0,needGeometry:o_(s),needFeature:!!y}}function Lc(e){if(!Array.isArray(e))return e;const t=function(r){if(r_.has(r[0]))for(let s=1;s<r.length;s++)if(Ad(r[s]))return!0;return r}(e);return!0===t?t:t.map(r=>Lc(r))}function Lh(e){let t=!1;const r=[];if("case"===e[0]){for(let s=1;s<e.length-1;s+=2)t=t||Ad(e[s]),r.push(e[s+1]);r.push(e[e.length-1])}else if("match"===e[0]){t=t||Ad(e[1]);for(let s=2;s<e.length-1;s+=2)r.push(e[s+1]);r.push(e[e.length-1])}else if("step"===e[0]){t=t||Ad(e[1]);for(let s=1;s<e.length-1;s+=2)r.push(e[s+1])}t&&(e.length=0,e.push("any",...r));for(let s=1;s<e.length;s++)Lh(e[s])}function Ad(e){if(!Array.isArray(e))return!1;if("pitch"===(t=e[0])||"distance-from-center"===t)return!0;var t;for(let r=1;r<e.length;r++)if(Ad(e[r]))return!0;return!1}const r_=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function wg(e,t){return e<t?-1:e>t?1:0}function o_(e){if(!Array.isArray(e))return!1;if("within"===e[0]||"distance"===e[0])return!0;for(let t=1;t<e.length;t++)if(o_(e[t]))return!0;return!1}function Nh(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?Fh(e[1],e[2],"=="):"!="===t?ha(Fh(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?Fh(e[1],e[2],t):"any"===t?(r=e.slice(1),["any"].concat(r.map(Nh))):"all"===t?["all"].concat(e.slice(1).map(Nh)):"none"===t?["all"].concat(e.slice(1).map(Nh).map(ha)):"in"===t?ps(e[1],e.slice(2)):"!in"===t?ha(ps(e[1],e.slice(2))):"has"===t?lp(e[1]):"!has"!==t||ha(lp(e[1]));var r}function Fh(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function ps(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",e,["literal",t.sort(wg)]]:["filter-in-small",e,["literal",t]]}}function lp(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function ha(e){return["!",e]}function Xl(e){return Xa(Go(e.value))?Ts(Zs({},e,{expressionContext:"filter",valueSpec:e.styleSpec[`filter_${e.layerType||"fill"}`]})):Dd(e)}function Dd(e){const t=e.value,r=e.key;if("array"!==Un(t))return[new Fe(r,t,`array expected, ${Un(t)} found`)];const s=e.styleSpec;let c,d=[];if(t.length<1)return[new Fe(r,t,"filter array must have at least 1 element")];switch(d=d.concat(ap({key:`${r}[0]`,value:t[0],valueSpec:s.filter_operator,style:e.style,styleSpec:e.styleSpec})),Wn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===Wn(t[1])&&d.push(new Fe(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&d.push(new Fe(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(c=Un(t[1]),"string"!==c&&d.push(new Fe(`${r}[1]`,t[1],`string expected, ${c} found`)));for(let f=2;f<t.length;f++)c=Un(t[f]),"$type"===Wn(t[1])?d=d.concat(ap({key:`${r}[${f}]`,value:t[f],valueSpec:s.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==c&&"number"!==c&&"boolean"!==c&&d.push(new Fe(`${r}[${f}]`,t[f],`string, number, or boolean expected, ${c} found`));break;case"any":case"all":case"none":for(let f=1;f<t.length;f++)d=d.concat(Dd({key:`${r}[${f}]`,value:t[f],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":c=Un(t[1]),2!==t.length?d.push(new Fe(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==c&&d.push(new Fe(`${r}[1]`,t[1],`string expected, ${c} found`))}return d}function Qa(e,t){const r=e.key,s=e.style,c=e.layer,d=e.styleSpec,f=e.value,g=e.objectKey,y=d[`${t}_${e.layerType}`];if(!y)return[];const b=g.match(/^(.*)-transition$/);if("paint"===t&&b&&y[b[1]]&&y[b[1]].transition)return wi({key:r,value:f,valueSpec:d.transition,style:s,styleSpec:d});const C=e.valueSpec||y[g];if(!C)return[new wc(r,f,`unknown property "${g}"`)];let P;if("string"===Un(f)&&Ns(C)&&!C.tokens&&(P=/^{([^}]+)}$/.exec(f))){const I=`\`{ "type": "identity", "property": ${P?JSON.stringify(P[1]):'"_"'} }\``;return[new Fe(r,f,`"${g}" does not support interpolation syntax\nUse an identity property function instead: ${I}.`)]}const E=[];if("symbol"===e.layerType)"text-field"!==g||!s||s.glyphs||s.imports||E.push(new Fe(r,f,'use of "text-field" requires a style "glyphs" property')),"text-font"===g&&xl(Go(f))&&"identity"===Wn(f.type)&&E.push(new Fe(r,f,'"text-font" does not support identity functions'));else if("model"===e.layerType&&"paint"===t&&c&&c.layout&&c.layout.hasOwnProperty("model-id")&&Ns(C)&&(Mu(C)||kc(C))){const I=Je(Go(f),C),A=I.value.expression||I.value._styleExpression.expression;A&&!mu(A,["measure-light"])&&("model-emissive-strength"===g&&Th(A)&&Oc(A)||E.push(new Fe(r,f,`${g} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return E.concat(wi({key:e.key,value:f,valueSpec:C,style:s,styleSpec:d,expressionContext:"property",propertyType:t,propertyKey:g}))}function kd(e){return Qa(e,"paint")}function Ja(e){return Qa(e,"layout")}function cp(e){let t=[];const r=e.value,s=e.key,c=e.style,d=e.styleSpec;r.type||r.ref||t.push(new Fe(s,r,'either "type" or "ref" is required'));let f=Wn(r.type);const g=Wn(r.ref);if(r.id){const y=Wn(r.id);for(let b=0;b<e.arrayIndex;b++){const C=c.layers[b];Wn(C.id)===y&&t.push(new Fe(s,r.id,`duplicate layer id "${r.id}", previously used at line ${C.id.__line__}`))}}if("ref"in r){let y;["type","source","source-layer","filter","layout"].forEach(b=>{b in r&&t.push(new Fe(s,r[b],`"${b}" is prohibited for ref layers`))}),c.layers.forEach(b=>{Wn(b.id)===g&&(y=b)}),y?y.ref?t.push(new Fe(s,r.ref,"ref cannot reference another ref layer")):f=Wn(y.type):"string"==typeof g&&t.push(new Fe(s,r.ref,`ref layer "${g}" not found`))}else if("background"!==f&&"sky"!==f&&"slot"!==f)if(r.source){const y=c.sources&&c.sources[r.source],b=y&&Wn(y.type);y?"vector"===b&&"raster"===f?t.push(new Fe(s,r.source,`layer "${r.id}" requires a raster source`)):"raster"===b&&"raster"!==f?t.push(new Fe(s,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==b||r["source-layer"]?"raster-dem"===b&&"hillshade"!==f?t.push(new Fe(s,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==f||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||"geojson"===b&&y.lineMetrics||t.push(new Fe(s,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Fe(s,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new Fe(s,r.source,`source "${r.source}" not found`))}else t.push(new Fe(s,r,'missing required property "source"'));return t=t.concat($r({key:s,value:r,valueSpec:d.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":()=>[],type:()=>wi({key:`${s}.type`,value:r.type,valueSpec:d.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"}),filter:y=>Xl(Zs({layerType:f},y)),layout:y=>$r({layer:r,key:y.key,value:y.value,valueSpec:{},style:y.style,styleSpec:y.styleSpec,objectElementValidators:{"*":b=>Ja(Zs({layerType:f},b))}}),paint:y=>$r({layer:r,key:y.key,value:y.value,valueSpec:{},style:y.style,styleSpec:y.styleSpec,objectElementValidators:{"*":b=>kd(Zs({layerType:f,layer:r},b))}})}})),t}function Cl(e){const t=e.value,r=e.key,s=Un(t);return"string"!==s?[new Fe(r,t,`string expected, ${s} found`)]:[]}const up={promoteId:function({key:e,value:t}){if("string"===Un(t))return Cl({key:e,value:t});{const r=[];for(const s in t)r.push(...Cl({key:`${e}.${s}`,value:t[s]}));return r}}};function Cg(e){const t=e.value,r=e.key,s=e.styleSpec,c=e.style;if(!t.type)return[new Fe(r,t,'"type" is required')];const d=Wn(t.type);let f=[];switch(["vector","raster","raster-dem"].includes(d)&&(t.url||t.tiles||f.push(new Fe(r,t,'Either "url" or "tiles" is required.'))),d){case"vector":case"raster":case"raster-dem":return f=f.concat($r({key:r,value:t,valueSpec:s[`source_${d.replace("-","_")}`],style:e.style,styleSpec:s,objectElementValidators:up})),f;case"geojson":if(f=$r({key:r,value:t,valueSpec:s.source_geojson,style:c,styleSpec:s,objectElementValidators:up}),t.cluster)for(const g in t.clusterProperties){const[y,b]=t.clusterProperties[g],C="string"==typeof y?[y,["accumulated"],["get",g]]:y;f.push(...Ts({key:`${r}.${g}.map`,value:b,expressionContext:"cluster-map"})),f.push(...Ts({key:`${r}.${g}.reduce`,value:C,expressionContext:"cluster-reduce"}))}return f;case"video":return $r({key:r,value:t,valueSpec:s.source_video,style:c,styleSpec:s});case"image":return $r({key:r,value:t,valueSpec:s.source_image,style:c,styleSpec:s});case"canvas":return[new Fe(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ap({key:`${r}.type`,value:t.type,valueSpec:{values:Ys(s)},style:c,styleSpec:s})}}function Ys(e){return e.source.reduce((t,r)=>{const s=e[r];return"enum"===s.type.type&&(t=t.concat(Object.keys(s.type.values))),t},[])}function Mg(e){const t=e.value;let r=[];if(!t)return r;const s=Un(t);return"string"!==s?(r=r.concat([new Fe(e.key,t,`string expected, "${s}" found`)]),r):(function(c){const d=-1===c.indexOf("://");try{return new URL(c,d?"http://example.com":void 0),!0}catch{return!1}}(t)||(r=r.concat([new Fe(e.key,t,`invalid url "${t}"`)])),r)}function Ml(e){const t=e.value,r=e.styleSpec,s=r.light,c=e.style;let d=[];const f=Un(t);if(void 0===t)return d;if("object"!==f)return d=d.concat([new Fe("light",t,`object expected, ${f} found`)]),d;for(const g in t){const y=g.match(/^(.*)-transition$/);d=d.concat(y&&s[y[1]]&&s[y[1]].transition?wi({key:g,value:t[g],valueSpec:r.transition,style:c,styleSpec:r}):s[g]?wi({key:g,value:t[g],valueSpec:s[g],style:c,styleSpec:r}):[new Fe(g,t[g],`unknown property "${g}"`)])}return d}function Rd(e){const t=e.value;let r=[];if(!t)return r;const s=Un(t);if("object"!==s)return r=r.concat([new Fe("light-3d",t,`object expected, ${s} found`)]),r;const c=e.styleSpec,d=c["light-3d"],f=e.key,g=e.style,y=e.style.lights;for(const P of["type","id"])if(!(P in t))return r=r.concat([new Fe("light-3d",t,`missing property ${P} on light`)]),r;if(t.type&&y)for(let P=0;P<e.arrayIndex;P++){const E=Wn(t.type),I=y[P];Wn(I.type)===E&&r.push(new Fe(f,t.id,`duplicate light type "${t.type}", previously defined at line ${I.id.__line__}`))}const b=`properties_light_${t.type}`;if(!(b in c))return r=r.concat([new Fe("light-3d",t,`Invalid light type ${t.type}`)]),r;const C=c[b];for(const P in t)if("properties"===P){const E=t[P],I=Un(E);if("object"!==I)return r=r.concat([new Fe("properties",E,`object expected, ${I} found`)]),r;for(const A in E)r=r.concat(C[A]?wi({key:A,value:E[A],valueSpec:C[A],style:g,styleSpec:c}):[new wc(e.key,E[A],`unknown property "${A}"`)])}else{const E=P.match(/^(.*)-transition$/);r=r.concat(E&&d[E[1]]&&d[E[1]].transition?wi({key:P,value:t[P],valueSpec:c.transition,style:g,styleSpec:c}):d[P]?wi({key:P,value:t[P],valueSpec:d[P],style:g,styleSpec:c}):[new wc(P,t[P],`unknown property "${P}"`)])}return r}function dp(e){const t=e.value,r=e.key,s=e.style,c=e.styleSpec,d=c.terrain;let f=[];const g=Un(t);if(void 0===t||"null"===g)return f;if("object"!==g)return f=f.concat([new Fe("terrain",t,`object expected, ${g} found`)]),f;for(const y in t){const b=y.match(/^(.*)-transition$/);f=f.concat(b&&d[b[1]]&&d[b[1]].transition?wi({key:y,value:t[y],valueSpec:c.transition,style:s,styleSpec:c}):d[y]?wi({key:y,value:t[y],valueSpec:d[y],style:s,styleSpec:c}):[new wc(y,t[y],`unknown property "${y}"`)])}if(t.source){const y=s.sources&&s.sources[t.source],b=y&&Wn(y.type);y?"raster-dem"!==b&&f.push(new Fe(r,t.source,`terrain cannot be used with a source of type ${String(b)}, it only be used with a "raster-dem" source type`)):f.push(new Fe(r,t.source,`source "${t.source}" not found`))}else f.push(new Fe(r,t,'terrain is missing required property "source"'));return f}function Iu(e){const t=e.value,r=e.style,s=e.styleSpec,c=s.fog;let d=[];const f=Un(t);if(void 0===t)return d;if("object"!==f)return d=d.concat([new Fe("fog",t,`object expected, ${f} found`)]),d;for(const g in t){const y=g.match(/^(.*)-transition$/);d=d.concat(y&&c[y[1]]&&c[y[1]].transition?wi({key:g,value:t[g],valueSpec:s.transition,style:r,styleSpec:s}):c[g]?wi({key:g,value:t[g],valueSpec:c[g],style:r,styleSpec:s}):[new wc(g,t[g],`unknown property "${g}"`)])}return d}const Ld={"*":()=>[],array:Kl,boolean:function(e){const t=e.value,r=e.key,s=Un(t);return"boolean"!==s?[new Fe(r,t,`boolean expected, ${s} found`)]:[]},number:Yl,color:function(e){const t=e.key,r=e.value,s=Un(r);return"string"!==s?[new Fe(t,r,`color expected, ${s} found`)]:null===Ws(r)?[new Fe(t,r,`color expected, "${r}" found`)]:[]},enum:ap,filter:Xl,function:Sd,layer:cp,object:$r,source:Cg,model:Mg,light:Ml,"light-3d":Rd,terrain:dp,fog:Iu,string:Cl,formatted:function(e){return 0===Cl(e).length?[]:Ts(e)},resolvedImage:function(e){return 0===Cl(e).length?[]:Ts(e)},projection:function(e){const t=e.value,r=e.styleSpec,s=r.projection,c=e.style;let d=[];const f=Un(t);if("object"===f)for(const g in t)d=d.concat(wi({key:g,value:t[g],valueSpec:s[g],style:c,styleSpec:r}));else"string"!==f&&(d=d.concat([new Fe("projection",t,`object or string expected, ${f} found`)]));return d},import:function(e){const{value:t,styleSpec:r}=e,{data:s,...c}=t;Object.defineProperty(c,"__line__",{value:t.__line__,enumerable:!1});let d=$r(Zs({},e,{value:c,valueSpec:r.import}));return""===Wn(c.id)&&d.push(new Fe(`${e.key}.id`,c,"import id can't be an empty string")),s&&(d=d.concat(Su(s,r,{key:`${e.key}.data`}))),d}};function wi(e,t=!1){const r=e.value,s=e.valueSpec,c=e.styleSpec;if(s.expression&&xl(Wn(r)))return Sd(e);if(s.expression&&wl(Go(r)))return Ts(e);if(s.type&&Ld[s.type]){const d=Ld[s.type](e);return!0===t&&d.length>0&&"array"===Un(e.value)?Ts(e):d}return $r(Zs({},e,{valueSpec:s.type?c[s.type]:s}))}function zh(e){const t=e.value,r=e.key,s=Cl(e);return s.length||(-1===t.indexOf("{fontstack}")&&s.push(new Fe(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&s.push(new Fe(r,t,'"glyphs" url must include a "{range}" token'))),s}function Su(e,t=wt,r={}){return wi({key:r.key||"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:zh,"*":()=>[]}})}function Ea(e,t=wt){return fa(Su(e,t))}const Nd=e=>fa(Cg(e)),hp=e=>fa(Ml(e)),tl=e=>fa(Rd(e)),Fd=e=>fa(dp(e)),Bh=e=>fa(Iu(e)),Pg=e=>fa(cp(e)),fp=e=>fa(Xl(e)),Au=e=>fa(kd(e)),Nc=e=>fa(Ja(e)),es=e=>fa(Mg(e));function fa(e){return e.slice().sort((t,r)=>t.line&&r.line?t.line-r.line:0)}function Uh(e,t){let r=!1;if(t&&t.length)for(const s of t)s instanceof wc?gt(s.message):(e.fire(new Cn(new Error(s.message))),r=!0);return r}var Ql=Fi,Pl=3;function Fi(e,t,r){var s=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var c=new Int32Array(this.arrayBuffer);e=c[0],this.d=(t=c[1])+2*(r=c[2]);for(var d=0;d<this.d*this.d;d++){var f=c[Pl+d],g=c[Pl+d+1];s.push(f===g?null:c.subarray(f,g))}var y=c[Pl+s.length+1];this.keys=c.subarray(c[Pl+s.length],y),this.bboxes=c.subarray(y),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var b=0;b<this.d*this.d;b++)s.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var C=r/t*e;this.min=-C,this.max=e+C}Fi.prototype.insert=function(e,t,r,s,c){this._forEachCell(t,r,s,c,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(c)},Fi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Fi.prototype._insertCell=function(e,t,r,s,c,d){this.cells[c].push(d)},Fi.prototype.query=function(e,t,r,s,c){var d=this.min,f=this.max;if(e<=d&&t<=d&&f<=r&&f<=s&&!c)return Array.prototype.slice.call(this.keys);var g=[];return this._forEachCell(e,t,r,s,this._queryCell,g,{},c),g},Fi.prototype._queryCell=function(e,t,r,s,c,d,f,g){var y=this.cells[c];if(null!==y)for(var b=this.keys,C=this.bboxes,P=0;P<y.length;P++){var E=y[P];if(void 0===f[E]){var I=4*E;(g?g(C[I+0],C[I+1],C[I+2],C[I+3]):e<=C[I+2]&&t<=C[I+3]&&r>=C[I+0]&&s>=C[I+1])?(f[E]=!0,d.push(b[E])):f[E]=!1}}},Fi.prototype._forEachCell=function(e,t,r,s,c,d,f,g){for(var y=this._convertToCellCoord(e),b=this._convertToCellCoord(t),C=this._convertToCellCoord(r),P=this._convertToCellCoord(s),E=y;E<=C;E++)for(var I=b;I<=P;I++){var A=this.d*I+E;if((!g||g(this._convertFromCellCoord(E),this._convertFromCellCoord(I),this._convertFromCellCoord(E+1),this._convertFromCellCoord(I+1)))&&c.call(this,e,t,r,s,A,d,f,g))return}},Fi.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Fi.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Fi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=Pl+this.cells.length+1+1,r=0,s=0;s<this.cells.length;s++)r+=this.cells[s].length;var c=new Int32Array(t+r+this.keys.length+this.bboxes.length);c[0]=this.extent,c[1]=this.n,c[2]=this.padding;for(var d=t,f=0;f<e.length;f++){var g=e[f];c[Pl+f]=d,c.set(g,d),d+=g.length}return c[Pl+e.length]=d,c.set(this.keys,d),c[Pl+e.length+1]=d+=this.keys.length,c.set(this.bboxes,d),d+=this.bboxes.length,c.buffer};var Jl=We(Ql);const tc={};function De(e,t,r={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),tc[t]={klass:e,omit:r.omit||[]}}De(Object,"Object"),Jl.serialize=function(e,t){const r=e.toArrayBuffer();return t&&t.add(r),{buffer:r}},Jl.deserialize=function(e){return new Jl(e.buffer)},Object.defineProperty(Jl,"name",{value:"Grid"}),De(Jl,"Grid"),De(bn,"Color"),De(Error,"Error"),De(Ht,"AJAXError"),De(Ri,"ResolvedImage"),De(ts,"StylePropertyFunction"),De(Xo,"StyleExpression",{omit:["_evaluator"]}),De(Es,"ZoomDependentExpression"),De(sp,"ZoomConstantExpression"),De(vl,"CompoundExpression",{omit:["_evaluate"]});for(const e in Dc)tc[Dc[e]._classRegistryKey]||De(Dc[e],`Expression${e}`);function ec(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function zd(e){return lt.ImageBitmap&&e instanceof lt.ImageBitmap}function nc(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(ec(e)||zd(e))return t&&t.add(e),e;if(ArrayBuffer.isView(e)){const r=e;return t&&t.add(r.buffer),r}if(e instanceof lt.ImageData)return t&&t.add(e.data.buffer),e;if(Array.isArray(e)){const r=[];for(const s of e)r.push(nc(s,t));return r}if(e instanceof Map){const r={$name:"Map"};for(const[s,c]of e.entries())r[s]=nc(c);return r}if("object"==typeof e){const r=e.constructor,s=r._classRegistryKey;if(!s)throw new Error(`can't serialize object of unregistered class ${s}`);const c=r.serialize?r.serialize(e,t):{};if(!r.serialize){for(const d in e)e.hasOwnProperty(d)&&(tc[s].omit.indexOf(d)>=0||(c[d]=nc(e[d],t)));e instanceof Error&&(c.message=e.message)}if(c.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(c.$name=s),c}throw new Error("can't serialize object of type "+typeof e)}function U(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||ec(e)||zd(e)||ArrayBuffer.isView(e)||e instanceof lt.ImageData)return e;if(Array.isArray(e))return e.map(U);if("object"==typeof e){const t=e.$name||"Object";if("Map"===t){const c=new Map;for(const d of Object.keys(e))"$name"!==d&&c.set(d,U(e[d]));return c}const{klass:r}=tc[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(e);const s=Object.create(r.prototype);for(const c of Object.keys(e))"$name"!==c&&(s[c]=U(e[c]));return s}throw new Error("can't deserialize object of type "+typeof e)}const V={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519,"CJK Unified Ideographs Extension B":e=>e>=131072&&e<=173791};function W(e){for(const t of e)if(Lt(t.charCodeAt(0)))return!0;return!1}function ut(e){for(const t of e)if(!Mt(t.charCodeAt(0)))return!1;return!0}function Mt(e){return!(V.Arabic(e)||V["Arabic Supplement"](e)||V["Arabic Extended-A"](e)||V["Arabic Presentation Forms-A"](e)||V["Arabic Presentation Forms-B"](e))}function Lt(e){return!(746!==e&&747!==e&&(e<4352||!(V["Bopomofo Extended"](e)||V.Bopomofo(e)||V["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||V["CJK Compatibility Ideographs"](e)||V["CJK Compatibility"](e)||V["CJK Radicals Supplement"](e)||V["CJK Strokes"](e)||!(!V["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||V["CJK Unified Ideographs Extension A"](e)||V["CJK Unified Ideographs"](e)||V["Enclosed CJK Letters and Months"](e)||V["Hangul Compatibility Jamo"](e)||V["Hangul Jamo Extended-A"](e)||V["Hangul Jamo Extended-B"](e)||V["Hangul Jamo"](e)||V["Hangul Syllables"](e)||V.Hiragana(e)||V["Ideographic Description Characters"](e)||V.Kanbun(e)||V["Kangxi Radicals"](e)||V["Katakana Phonetic Extensions"](e)||V.Katakana(e)&&12540!==e||!(!V["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!V["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||V["Unified Canadian Aboriginal Syllabics"](e)||V["Unified Canadian Aboriginal Syllabics Extended"](e)||V["Vertical Forms"](e)||V["Yijing Hexagram Symbols"](e)||V["Yi Syllables"](e)||V["Yi Radicals"](e))))}function se(e){return!(Lt(e)||(t=e,V["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||V["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||V["Letterlike Symbols"](t)||V["Number Forms"](t)||V["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||V["Control Pictures"](t)&&9251!==t||V["Optical Character Recognition"](t)||V["Enclosed Alphanumerics"](t)||V["Geometric Shapes"](t)||V["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||V["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||V["CJK Symbols and Punctuation"](t)||V.Katakana(t)||V["Private Use Area"](t)||V["CJK Compatibility Forms"](t)||V["Small Form Variants"](t)||V["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t));var t}function on(e){return e>=1424&&e<=2303||V["Arabic Presentation Forms-A"](e)||V["Arabic Presentation Forms-B"](e)}function nn(e,t){return!(!t&&on(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||V.Khmer(e))}function xn(e){for(const t of e)if(on(t.charCodeAt(0)))return!0;return!1}const mr="deferred",hr="loading",_o="loaded";let Ci=null,si="unavailable",Ta=null;const _i=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(si="error"),Ci&&Ci(e)};function Zi(){Ia.fire(new de("pluginStateChange",{pluginStatus:si,pluginURL:Ta}))}const Ia=new Ro,Du=function(){return si},Vh=function(){if(si!==mr||!Ta)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");si=hr,Zi(),Ta&&ve({url:Ta},e=>{e?_i(e):(si=_o,Zi())})},el={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>si===_o||null!=el.applyArabicShaping,isLoading:()=>si===hr,setState(e){si=e.pluginStatus,Ta=e.pluginURL},isParsed:()=>null!=el.applyArabicShaping&&null!=el.processBidirectionalText&&null!=el.processStyledBidirectionalText,getPluginURL:()=>Ta};class Lo{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.transition=r.transition,this.pitch=r.pitch,this.brightness=r.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(r,s){for(const c of r)if(!nn(c.charCodeAt(0),s))return!1;return!0}(t,el.isLoaded())}}class Og{constructor(t,r,s){this.property=t,this.value=r,this.expression=function(c,d,f){if(xl(c))return new ts(c,d);if(wl(c)||Array.isArray(c)&&c.length>0){const g=Je(c,d,f);if("error"===g.result)throw new Error(g.value.map(y=>`${y.key}: ${y.message}`).join(", "));return g.value}{let g=c;return"string"==typeof c&&"color"===d.type&&(g=bn.parse(c)),{kind:"constant",isConfigDependent:!1,evaluate:()=>g}}}(void 0===r?t.specification.default:r,t.specification,s)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,r,s){return this.property.possiblyEvaluate(this,t,r,s)}}class i_{constructor(t,r){this.property=t,this.value=new Og(t,void 0,r)}transitioned(t,r){return new s_(this.property,this.value,r,_t({},t.transition,this.transition),t.now)}untransitioned(){return new s_(this.property,this.value,null,{},0)}}class Xs{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._options=r,this.isConfigDependent=!1}getValue(t){return et(this._values[t].value.value)}setValue(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new i_(this._values[t].property,this._options)),this._values[t].value=new Og(this._values[t].property,null===r?void 0:et(r),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].value.expression.isConfigDependent}setTransitionOrValue(t,r){r&&(this._options=r);const s=this._properties.properties;if(t)for(const c in t){const d=t[c];if(pn(c,"-transition")){const f=c.slice(0,-11);s[f]&&this.setTransition(f,d)}else s[c]&&this.setValue(c,d)}}getTransition(t){return et(this._values[t].transition)}setTransition(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new i_(this._values[t].property)),this._values[t].transition=et(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const s=this.getValue(r);void 0!==s&&(t[r]=s);const c=this.getTransition(r);void 0!==c&&(t[`${r}-transition`]=c)}return t}transitioned(t,r){const s=new z(this._properties);for(const c of Object.keys(this._values))s._values[c]=this._values[c].transitioned(t,r._values[c]);return s}untransitioned(){const t=new z(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class s_{constructor(t,r,s,c,d){const f=c.delay||0,g=c.duration||0;d=d||0,this.property=t,this.value=r,this.begin=d+f,this.end=this.begin+g,t.specification.transition&&(c.delay||c.duration)&&(this.prior=s)}possiblyEvaluate(t,r,s){const c=t.now||0,d=this.value.possiblyEvaluate(t,r,s),f=this.prior;if(f){if(c>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(c<this.begin)return f.possiblyEvaluate(t,r,s);{const g=(c-this.begin)/(this.end-this.begin);return this.property.interpolate(f.possiblyEvaluate(t,r,s),d,Vo(g))}}return d}}class z{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,s){const c=new j(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].possiblyEvaluate(t,r,s);return c}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class D{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._options=r,this.isConfigDependent=!1}getValue(t){return et(this._values[t].value)}setValue(t,r){this._values[t]=new Og(this._values[t].property,null===r?void 0:et(r),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].expression.isConfigDependent}serialize(){const t={};for(const r of Object.keys(this._values)){const s=this.getValue(r);void 0!==s&&(t[r]=s)}return t}possiblyEvaluate(t,r,s){const c=new j(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].possiblyEvaluate(t,r,s);return c}}class R{constructor(t,r,s){this.property=t,this.value=r,this.parameters=s}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,r,s,c){return this.property.evaluate(this.value,this.parameters,t,r,s,c)}}class j{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class G{constructor(t){this.specification=t}possiblyEvaluate(t,r){return t.expression.evaluate(r)}interpolate(t,r,s){const c=Md[this.specification.type];return c?c(t,r,s):t}}class Q{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,s,c){return new R(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(r,null,{},s,c)}:t.expression,r)}interpolate(t,r,s){if("constant"!==t.value.kind||"constant"!==r.value.kind)return t;if(void 0===t.value.value||void 0===r.value.value)return new R(this,{kind:"constant",value:void 0},t.parameters);const c=Md[this.specification.type];return c?new R(this,{kind:"constant",value:c(t.value.value,r.value.value,s)},t.parameters):t}evaluate(t,r,s,c,d,f){return"constant"===t.kind?t.value:t.evaluate(r,s,c,d,f)}}class St{constructor(t){this.specification=t}possiblyEvaluate(t,r,s,c){return!!t.expression.evaluate(r,null,{},s,c)}interpolate(){return!1}}class jt{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const r=new Lo(0,{});for(const s in t){const c=t[s];c.specification.overridable&&this.overridableProperties.push(s);const d=this.defaultPropertyValues[s]=new Og(c,void 0),f=this.defaultTransitionablePropertyValues[s]=new i_(c);this.defaultTransitioningPropertyValues[s]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=d.possiblyEvaluate(r)}}}De(Q,"DataDrivenProperty"),De(G,"DataConstantProperty"),De(St,"ColorRampProperty");function un(e){return e.indexOf("\x1f")>=0}function sn(e,t){return t?`${e}\x1f${t}`:e}function to(e){const t=e.indexOf("\x1f");return t>=0?e.slice(0,t):e}const ns="-transition";class gs extends Ro{constructor(t,r,s){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&"sky"!==t.type&&"slot"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),this.options=s,t.slot&&(this.slot=t.slot),r.layout&&(this._unevaluatedLayout=new D(r.layout,s),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),r.paint)){this._transitionablePaint=new Xs(r.paint,s);for(const c in t.paint)this.setPaintProperty(c,t.paint[c],{validate:!1});for(const c in t.layout)this.setLayoutProperty(c,t.layout[c],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new j(r.paint)}}setScope(t){this.scope=t,this.fqid=sn(this.id,t)}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,s={}){if(null!=r&&this._validate(Nc,`layers.${this.id}.layout.${t}`,t,r,s))return;if("custom"===this.type&&"visibility"===t)return void(this.visibility=r);const c=this._unevaluatedLayout;c._properties.properties[t]&&(c.setValue(t,r),this.isConfigDependent=this.isConfigDependent||c.isConfigDependent,"visibility"===t&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return pn(t,ns)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,s={}){if(null!=r&&this._validate(Au,`layers.${this.id}.paint.${t}`,t,r,s))return!1;const c=this._transitionablePaint,d=c._properties.properties;if(pn(t,ns)){const E=t.slice(0,-11);return d[E]&&c.setTransition(E,r||void 0),!1}if(!d[t])return!1;const f=c._values[t],g=f.value.isDataDriven(),y=f.value;c.setValue(t,r),this.isConfigDependent=this.isConfigDependent||c.isConfigDependent,this._handleSpecialPaintPropertyUpdate(t);const b=c._values[t].value,C=b.isDataDriven(),P=pn(t,"pattern")||"line-dasharray"===t;return C||g||P||this._handleOverridablePaintPropertyUpdate(t,y,b)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,r){return null}_handleOverridablePaintPropertyUpdate(t,r,s){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){return ce({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,r)=>!(void 0===t||"layout"===r&&!Object.keys(t).length||"paint"===r&&!Object.keys(t).length))}_validate(t,r,s,c,d={}){return(!d||!1!==d.validate)&&Uh(this,t.call(Ea,{key:r,layerType:this.type,objectKey:s,value:c,styleSpec:wt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof R&&Ns(r.property.specification)&&("source"===r.value.kind||"composite"===r.value.kind)&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Tu(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(){this._stats&&(this._stats.numRenderedVerticesInShadowPass=0,this._stats.numRenderedVerticesInTransparentPass=0)}}class jh{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(t,r){this._updatedSourceCaches[t]=r,this.setDirty()}discardSourceCacheUpdate(t){delete this._updatedSourceCaches[t]}updateLayer(t){const r=t.scope;this._updatedLayers[r]=this._updatedLayers[r]||new Set,this._updatedLayers[r].add(t.id),this.setDirty()}removeLayer(t){const r=t.scope;this._removedLayers[r]=this._removedLayers[r]||{},this._updatedLayers[r]=this._updatedLayers[r]||new Set,this._removedLayers[r][t.id]=t,this._updatedLayers[r].delete(t.id),this._updatedPaintProps.delete(t.fqid),this.setDirty()}getRemovedLayer(t){return this._removedLayers[t.scope]?this._removedLayers[t.scope][t.id]:null}discardLayerRemoval(t){this._removedLayers[t.scope]&&delete this._removedLayers[t.scope][t.id]}getLayerUpdatesByScope(){const t={};for(const r in this._updatedLayers)t[r]=t[r]||{},t[r].updatedIds=Array.from(this._updatedLayers[r].values());for(const r in this._removedLayers)t[r]=t[r]||{},t[r].removedIds=Object.keys(this._removedLayers[r]);return t}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(t){this._updatedPaintProps.add(t.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(t){this._updatedImages.add(t),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}const _w={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class $h{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Mo{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Dr(e,t=1){let r=0,s=0;return{members:e.map(c=>{const d=_w[c.type].BYTES_PER_ELEMENT,f=r=a_(r,Math.max(t,d)),g=c.components||1;return s=Math.max(s,d),r+=d*g,{name:c.name,type:c.type,components:g,offset:f}}),size:a_(r,Math.max(s,t)),alignment:t}}function a_(e,t){return Math.ceil(e/t)*t}class pa extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,r)}emplace(t,r,s){const c=2*t;return this.int16[c+0]=r,this.int16[c+1]=s,t}}pa.prototype.bytesPerElement=4,De(pa,"StructArrayLayout2i4");class l_ extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,r,s)}emplace(t,r,s,c){const d=3*t;return this.int16[d+0]=r,this.int16[d+1]=s,this.int16[d+2]=c,t}}l_.prototype.bytesPerElement=6,De(l_,"StructArrayLayout3i6");class nl extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,r,s,c)}emplace(t,r,s,c,d){const f=4*t;return this.int16[f+0]=r,this.int16[f+1]=s,this.int16[f+2]=c,this.int16[f+3]=d,t}}nl.prototype.bytesPerElement=8,De(nl,"StructArrayLayout4i8");class Gh extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,r,s,c,d)}emplace(t,r,s,c,d,f){const g=5*t;return this.int16[g+0]=r,this.int16[g+1]=s,this.int16[g+2]=c,this.int16[g+3]=d,this.int16[g+4]=f,t}}Gh.prototype.bytesPerElement=10,De(Gh,"StructArrayLayout5i10");class pb extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,r,s,c,d,f,g)}emplace(t,r,s,c,d,f,g,y){const b=6*t,C=12*t,P=3*t;return this.int16[b+0]=r,this.int16[b+1]=s,this.uint8[C+4]=c,this.uint8[C+5]=d,this.uint8[C+6]=f,this.uint8[C+7]=g,this.float32[P+2]=y,t}}pb.prototype.bytesPerElement=12,De(pb,"StructArrayLayout2i4ub1f12");class ku extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,r,s,c)}emplace(t,r,s,c,d){const f=4*t;return this.float32[f+0]=r,this.float32[f+1]=s,this.float32[f+2]=c,this.float32[f+3]=d,t}}ku.prototype.bytesPerElement=16,De(ku,"StructArrayLayout4f16");class rc extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,r,s,c,d)}emplace(t,r,s,c,d,f){const g=6*t,y=3*t;return this.uint16[g+0]=r,this.uint16[g+1]=s,this.uint16[g+2]=c,this.uint16[g+3]=d,this.float32[y+2]=f,t}}rc.prototype.bytesPerElement=12,De(rc,"StructArrayLayout4ui1f12");class Yy extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,r,s,c)}emplace(t,r,s,c,d){const f=4*t;return this.uint16[f+0]=r,this.uint16[f+1]=s,this.uint16[f+2]=c,this.uint16[f+3]=d,t}}Yy.prototype.bytesPerElement=8,De(Yy,"StructArrayLayout4ui8");class Xy extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,s,c,d,f)}emplace(t,r,s,c,d,f,g){const y=6*t;return this.int16[y+0]=r,this.int16[y+1]=s,this.int16[y+2]=c,this.int16[y+3]=d,this.int16[y+4]=f,this.int16[y+5]=g,t}}Xy.prototype.bytesPerElement=12,De(Xy,"StructArrayLayout6i12");class gb extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g,y,b,C,P,E){const I=this.length;return this.resize(I+1),this.emplace(I,t,r,s,c,d,f,g,y,b,C,P,E)}emplace(t,r,s,c,d,f,g,y,b,C,P,E,I){const A=12*t;return this.int16[A+0]=r,this.int16[A+1]=s,this.int16[A+2]=c,this.int16[A+3]=d,this.uint16[A+4]=f,this.uint16[A+5]=g,this.uint16[A+6]=y,this.uint16[A+7]=b,this.int16[A+8]=C,this.int16[A+9]=P,this.int16[A+10]=E,this.int16[A+11]=I,t}}gb.prototype.bytesPerElement=24,De(gb,"StructArrayLayout4i4ui4i24");class eP extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,s,c,d,f)}emplace(t,r,s,c,d,f,g){const y=10*t,b=5*t;return this.int16[y+0]=r,this.int16[y+1]=s,this.int16[y+2]=c,this.float32[b+2]=d,this.float32[b+3]=f,this.float32[b+4]=g,t}}eP.prototype.bytesPerElement=20,De(eP,"StructArrayLayout3i3f20");class Qy extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}Qy.prototype.bytesPerElement=4,De(Qy,"StructArrayLayout1ul4");class Ru extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,r)}emplace(t,r,s){const c=2*t;return this.uint16[c+0]=r,this.uint16[c+1]=s,t}}Ru.prototype.bytesPerElement=4,De(Ru,"StructArrayLayout2ui4");class mb extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g,y,b,C,P,E,I){const A=this.length;return this.resize(A+1),this.emplace(A,t,r,s,c,d,f,g,y,b,C,P,E,I)}emplace(t,r,s,c,d,f,g,y,b,C,P,E,I,A){const l=20*t,u=10*t;return this.int16[l+0]=r,this.int16[l+1]=s,this.int16[l+2]=c,this.int16[l+3]=d,this.int16[l+4]=f,this.float32[u+3]=g,this.float32[u+4]=y,this.float32[u+5]=b,this.float32[u+6]=C,this.int16[l+14]=P,this.uint32[u+8]=E,this.uint16[l+18]=I,this.uint16[l+19]=A,t}}mb.prototype.bytesPerElement=40,De(mb,"StructArrayLayout5i4f1i1ul2ui40");class _b extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,r,s,c,d,f,g)}emplace(t,r,s,c,d,f,g,y){const b=8*t;return this.int16[b+0]=r,this.int16[b+1]=s,this.int16[b+2]=c,this.int16[b+4]=d,this.int16[b+5]=f,this.int16[b+6]=g,this.int16[b+7]=y,t}}_b.prototype.bytesPerElement=16,De(_b,"StructArrayLayout3i2i2i16");class yb extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,r,s,c,d)}emplace(t,r,s,c,d,f){const g=4*t,y=8*t;return this.float32[g+0]=r,this.float32[g+1]=s,this.float32[g+2]=c,this.int16[y+6]=d,this.int16[y+7]=f,t}}yb.prototype.bytesPerElement=16,De(yb,"StructArrayLayout2f1f2i16");class nP extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,r,s,c)}emplace(t,r,s,c,d){const f=12*t,g=3*t;return this.uint8[f+0]=r,this.uint8[f+1]=s,this.float32[g+1]=c,this.float32[g+2]=d,t}}nP.prototype.bytesPerElement=12,De(nP,"StructArrayLayout2ub2f12");class Mi extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,r,s)}emplace(t,r,s,c){const d=3*t;return this.uint16[d+0]=r,this.uint16[d+1]=s,this.uint16[d+2]=c,t}}Mi.prototype.bytesPerElement=6,De(Mi,"StructArrayLayout3ui6");class gT extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p,m,v,M,O){const T=this.length;return this.resize(T+1),this.emplace(T,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p,m,v,M,O)}emplace(t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p,m,v,M,O,T){const k=30*t,N=15*t,F=60*t;return this.int16[k+0]=r,this.int16[k+1]=s,this.int16[k+2]=c,this.float32[N+2]=d,this.float32[N+3]=f,this.uint16[k+8]=g,this.uint16[k+9]=y,this.uint32[N+5]=b,this.uint32[N+6]=C,this.uint32[N+7]=P,this.uint16[k+16]=E,this.uint16[k+17]=I,this.uint16[k+18]=A,this.float32[N+10]=l,this.float32[N+11]=u,this.uint8[F+48]=p,this.uint8[F+49]=m,this.uint8[F+50]=v,this.uint32[N+13]=M,this.int16[k+28]=O,this.uint8[F+58]=T,t}}gT.prototype.bytesPerElement=60,De(gT,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class rP extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p,m,v,M,O,T,k,N,F,$,q,Z,X,K,J,st){const it=this.length;return this.resize(it+1),this.emplace(it,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p,m,v,M,O,T,k,N,F,$,q,Z,X,K,J,st)}emplace(t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p,m,v,M,O,T,k,N,F,$,q,Z,X,K,J,st,it){const rt=20*t,ct=40*t,yt=80*t;return this.float32[rt+0]=r,this.float32[rt+1]=s,this.int16[ct+4]=c,this.int16[ct+5]=d,this.int16[ct+6]=f,this.int16[ct+7]=g,this.int16[ct+8]=y,this.int16[ct+9]=b,this.int16[ct+10]=C,this.int16[ct+11]=P,this.int16[ct+12]=E,this.uint16[ct+13]=I,this.uint16[ct+14]=A,this.uint16[ct+15]=l,this.uint16[ct+16]=u,this.uint16[ct+17]=p,this.uint16[ct+18]=m,this.uint16[ct+19]=v,this.uint16[ct+20]=M,this.uint16[ct+21]=O,this.uint16[ct+22]=T,this.uint16[ct+23]=k,this.uint16[ct+24]=N,this.uint16[ct+25]=F,this.uint16[ct+26]=$,this.uint16[ct+27]=q,this.uint32[rt+14]=Z,this.float32[rt+15]=X,this.float32[rt+16]=K,this.float32[rt+17]=J,this.float32[rt+18]=st,this.uint8[yt+76]=it,t}}rP.prototype.bytesPerElement=80,De(rP,"StructArrayLayout2f9i15ui1ul4f1ub80");class vb extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}vb.prototype.bytesPerElement=4,De(vb,"StructArrayLayout1f4");class pp extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d){const f=this.length;return this.resize(f+1),this.emplace(f,t,r,s,c,d)}emplace(t,r,s,c,d,f){const g=5*t;return this.float32[g+0]=r,this.float32[g+1]=s,this.float32[g+2]=c,this.float32[g+3]=d,this.float32[g+4]=f,t}}pp.prototype.bytesPerElement=20,De(pp,"StructArrayLayout5f20");class mT extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,r,s,c,d,f,g)}emplace(t,r,s,c,d,f,g,y){const b=7*t;return this.float32[b+0]=r,this.float32[b+1]=s,this.float32[b+2]=c,this.float32[b+3]=d,this.float32[b+4]=f,this.float32[b+5]=g,this.float32[b+6]=y,t}}mT.prototype.bytesPerElement=28,De(mT,"StructArrayLayout7f28");class _T extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,t,r,s,c)}emplace(t,r,s,c,d){const f=6*t;return this.uint32[3*t+0]=r,this.uint16[f+2]=s,this.uint16[f+3]=c,this.uint16[f+4]=d,t}}_T.prototype.bytesPerElement=12,De(_T,"StructArrayLayout1ul3ui12");class c_ extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}c_.prototype.bytesPerElement=2,De(c_,"StructArrayLayout1ui2");class Jy extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,r,s)}emplace(t,r,s,c){const d=3*t;return this.float32[d+0]=r,this.float32[d+1]=s,this.float32[d+2]=c,t}}Jy.prototype.bytesPerElement=12,De(Jy,"StructArrayLayout3f12");class yw extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,r)}emplace(t,r,s){const c=2*t;return this.float32[c+0]=r,this.float32[c+1]=s,t}}yw.prototype.bytesPerElement=8,De(yw,"StructArrayLayout2f8");class yT extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u)}emplace(t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p){const m=16*t;return this.float32[m+0]=r,this.float32[m+1]=s,this.float32[m+2]=c,this.float32[m+3]=d,this.float32[m+4]=f,this.float32[m+5]=g,this.float32[m+6]=y,this.float32[m+7]=b,this.float32[m+8]=C,this.float32[m+9]=P,this.float32[m+10]=E,this.float32[m+11]=I,this.float32[m+12]=A,this.float32[m+13]=l,this.float32[m+14]=u,this.float32[m+15]=p,t}}yT.prototype.bytesPerElement=64,De(yT,"StructArrayLayout16f64");class oP extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,c,d,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,r,s,c,d,f,g)}emplace(t,r,s,c,d,f,g,y){const b=10*t,C=5*t;return this.uint16[b+0]=r,this.uint16[b+1]=s,this.uint16[b+2]=c,this.uint16[b+3]=d,this.float32[C+2]=f,this.float32[C+3]=g,this.float32[C+4]=y,t}}oP.prototype.bytesPerElement=20,De(oP,"StructArrayLayout4ui3f20");class vT extends Mo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint8[1*t+0]=r,t}}vT.prototype.bytesPerElement=1,De(vT,"StructArrayLayout1ub1");class iP extends $h{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}iP.prototype.size=40;class t0 extends mb{get(t){return new iP(this,t)}}De(t0,"CollisionBoxArray");class bb extends $h{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}bb.prototype.size=60;class sP extends gT{get(t){return new bb(this,t)}}De(sP,"PlacedSymbolArray");class aP extends $h{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}aP.prototype.size=80;class lP extends rP{get(t){return new aP(this,t)}}De(lP,"SymbolInstanceArray");class u_ extends vb{getoffsetX(t){return this.float32[1*t+0]}}De(u_,"GlyphOffsetArray");class cP extends pa{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}De(cP,"SymbolLineVertexArray");class uP extends $h{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}uP.prototype.size=12;class xb extends _T{get(t){return new uP(this,t)}}De(xb,"FeatureIndexArray");class wb extends Ru{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}De(wb,"FillExtrusionCentroidArray");const vw=Dr([{name:"a_pos",components:2,type:"Int16"}],4),AI=Dr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class lo{constructor(t=[]){this.segments=t}_prepareSegment(t,r,s,c){let d=this.segments[this.segments.length-1];return t>lo.MAX_VERTEX_ARRAY_LENGTH&&gt(`Max vertices per segment is ${lo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!d||d.vertexLength+t>lo.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==c)&&(d={vertexOffset:r,primitiveOffset:s,vertexLength:0,primitiveLength:0},void 0!==c&&(d.sortKey=c),this.segments.push(d)),d}prepareSegment(t,r,s,c){return this._prepareSegment(t,r.length,s.length,c)}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,s,c){return new lo([{vertexOffset:t,primitiveOffset:r,vertexLength:s,primitiveLength:c,vaos:{},sortKey:0}])}}function bT(e,t){return 256*(e=Ne(Math.floor(e),0,255))+Ne(Math.floor(t),0,255)}lo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,De(lo,"SegmentVector");const xT=Dr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),dP=Dr([{name:"a_dash",components:4,type:"Uint16"}]);var bw={exports:{}},DI={exports:function(t,r){var s,c,d,f,g,y,b,C;for(c=t.length-(s=3&t.length),d=r,g=3432918353,y=461845907,C=0;C<c;)b=255&t.charCodeAt(C)|(255&t.charCodeAt(++C))<<8|(255&t.charCodeAt(++C))<<16|(255&t.charCodeAt(++C))<<24,++C,d=27492+(65535&(f=5*(65535&(d=(d^=b=(65535&(b=(b=(65535&b)*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*y+(((b>>>16)*y&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(b=0,s){case 3:b^=(255&t.charCodeAt(C+2))<<16;case 2:b^=(255&t.charCodeAt(C+1))<<8;case 1:d^=b=(65535&(b=(b=(65535&(b^=255&t.charCodeAt(C)))*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*y+(((b>>>16)*y&65535)<<16)&4294967295}return d^=t.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0}}.exports,hP={exports:{}};hP.exports=function(t,r){for(var s,c=t.length,d=r^c,f=0;c>=4;)s=1540483477*(65535&(s=255&t.charCodeAt(f)|(255&t.charCodeAt(++f))<<8|(255&t.charCodeAt(++f))<<16|(255&t.charCodeAt(++f))<<24))+((1540483477*(s>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),c-=4,++f;switch(c){case 3:d^=(255&t.charCodeAt(f+2))<<16;case 2:d^=(255&t.charCodeAt(f+1))<<8;case 1:d=1540483477*(65535&(d^=255&t.charCodeAt(f)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var CT=DI,kI=hP.exports;bw.exports=CT,bw.exports.murmur3=CT,bw.exports.murmur2=kI;var rl=We(bw.exports);class d_{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,r,s,c){this.ids.push(fP(t)),this.positions.push(r,s,c)}eachPosition(t,r){const s=fP(t);let c=0,d=this.ids.length-1;for(;c<d;){const f=c+d>>1;this.ids[f]>=s?d=f:c=f+1}for(;this.ids[c]===s;)r(this.positions[3*c],this.positions[3*c+1],this.positions[3*c+2]),c++}static serialize(t,r){const s=new Float64Array(t.ids),c=new Uint32Array(t.positions);return Cb(s,c,0,s.length-1),r&&(r.add(s.buffer),r.add(c.buffer)),{ids:s,positions:c}}static deserialize(t){const r=new d_;let s;r.ids=t.ids,r.positions=t.positions;for(const c of r.ids)c!==s&&r.uniqueIds.push(c),s=c;return r.indexed=!0,r}}function fP(e){const t=+e;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:rl(String(e))}function Cb(e,t,r,s){for(;r<s;){const c=e[r+s>>1];let d=r-1,f=s+1;for(;;){do{d++}while(e[d]<c);do{f--}while(e[f]>c);if(d>=f)break;Qs(e,d,f),Qs(t,3*d,3*f),Qs(t,3*d+1,3*f+1),Qs(t,3*d+2,3*f+2)}f-r<s-f?(Cb(e,t,r,f),r=f+1):(Cb(e,t,f+1,s),s=f)}}function Qs(e,t,r){const s=e[t];e[t]=e[r],e[r]=s}De(d_,"FeaturePositionMap");class Fc{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,r){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,r),this.initialized=!0),!!this.location}}class cr extends Fc{constructor(t){super(t),this.current=0}set(t,r,s){this.fetchUniformLocation(t,r)&&this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}}class fe extends Fc{constructor(t){super(t),this.current=0}set(t,r,s){this.fetchUniformLocation(t,r)&&this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class fr extends Fc{constructor(t){super(t),this.current=[0,0]}set(t,r,s){this.fetchUniformLocation(t,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1])))}}class Kn extends Fc{constructor(t){super(t),this.current=[0,0,0]}set(t,r,s){this.fetchUniformLocation(t,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2])))}}class oc extends Fc{constructor(t){super(t),this.current=[0,0,0,0]}set(t,r,s){this.fetchUniformLocation(t,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3])))}}class h_ extends Fc{constructor(t){super(t),this.current=bn.transparent}set(t,r,s){this.fetchUniformLocation(t,r)&&(s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a)))}}const RI=new Float32Array(16);class Vn extends Fc{constructor(t){super(t),this.current=RI}set(t,r,s){if(this.fetchUniformLocation(t,r)){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let c=1;c<16;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}}}const LI=new Float32Array(9);class pP extends Fc{constructor(t){super(t),this.current=LI}set(t,r,s){if(this.fetchUniformLocation(t,r))for(let c=0;c<9;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}const gP=new Float32Array(4);class Mb extends Fc{constructor(t){super(t),this.current=gP}set(t,r,s){if(this.fetchUniformLocation(t,r))for(let c=0;c<4;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix2fv(this.location,!1,s);break}}}function mP(e){return[bT(255*e.r,255*e.g),bT(255*e.b,255*e.a)]}class Hh{constructor(t,r,s){this.value=t,this.uniformNames=r.map(c=>`u_${c}`),this.type=s}setUniform(t,r,s,c,d){r.set(t,d,c.constantOr(this.value))}getBinding(t,r){return"color"===this.type?new h_(t):new fe(t)}}class Sa{constructor(t,r){this.uniformNames=r.map(s=>`u_${s}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,r,s,c,d){const f="u_pattern"===d||"u_dash"===d?this.pattern:"u_pixel_ratio"===d?this.pixelRatio:null;f&&r.set(t,d,f)}getBinding(t,r){return"u_pattern"===r||"u_dash"===r?new oc(t):new fe(t)}}class an{constructor(t,r,s,c){this.expression=t,this.type=s,this.maxValue=0,this.paintVertexAttributes=r.map(d=>({name:`a_${d}`,type:"Float32",components:"color"===s?2:1,offset:0})),this.paintVertexArray=new c}populatePaintArray(t,r,s,c,d,f,g){const y=this.paintVertexArray.length,b=this.expression.evaluate(new Lo(0,{brightness:f}),r,{},d,c,g);this.paintVertexArray.resize(t),this._setPaintValue(y,t,b)}updatePaintArray(t,r,s,c,d,f,g){const y=this.expression.evaluate({zoom:0,brightness:g},s,c,void 0,d);this._setPaintValue(t,r,y)}_setPaintValue(t,r,s){if("color"===this.type){const c=mP(s);for(let d=t;d<r;d++)this.paintVertexArray.emplace(d,c[0],c[1])}else{for(let c=t;c<r;c++)this.paintVertexArray.emplace(c,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ol{constructor(t,r,s,c,d,f){this.expression=t,this.uniformNames=r.map(g=>`u_${g}_t`),this.type=s,this.useIntegerZoom=c,this.zoom=d,this.maxValue=0,this.paintVertexAttributes=r.map(g=>({name:`a_${g}`,type:"Float32",components:"color"===s?4:2,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,r,s,c,d,f,g){const y=this.expression.evaluate(new Lo(this.zoom,{brightness:f}),r,{},d,c,g),b=this.expression.evaluate(new Lo(this.zoom+1,{brightness:f}),r,{},d,c,g),C=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(C,t,y,b)}updatePaintArray(t,r,s,c,d,f,g){const y=this.expression.evaluate({zoom:this.zoom,brightness:g},s,c,void 0,d),b=this.expression.evaluate({zoom:this.zoom+1,brightness:g},s,c,void 0,d);this._setPaintValue(t,r,y,b)}_setPaintValue(t,r,s,c){if("color"===this.type){const d=mP(s),f=mP(c);for(let g=t;g<r;g++)this.paintVertexArray.emplace(g,d[0],d[1],f[0],f[1])}else{for(let d=t;d<r;d++)this.paintVertexArray.emplace(d,s,c);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r,s,c,d){const f=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,g=Ne(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);r.set(t,d,g)}getBinding(t,r){return new fe(t)}}class pr{constructor(t,r,s,c,d){this.expression=t,this.layerId=d,this.paintVertexAttributes=("array"===s?dP:xT).members;for(let f=0;f<r.length;++f);this.paintVertexArray=new c}populatePaintArray(t,r,s){const c=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(c,t,r.patterns&&r.patterns[this.layerId],s)}updatePaintArray(t,r,s,c,d,f,g){this._setPaintValues(t,r,s.patterns&&s.patterns[this.layerId],f)}_setPaintValues(t,r,s,c){if(!c||!s)return;const d=c[s];if(!d)return;const{tl:f,br:g,pixelRatio:y}=d;for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,f[0],f[1],g[0],g[1],y)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Lu{constructor(t,r,s=(()=>!0)){this.binders={},this._buffers=[];const c=[];for(const d in t.paint._values){const f=t.paint.get(d);if(!s(d)||!(f instanceof R&&Ns(f.property.specification)))continue;const g=Ob(d,t.type),y=f.value,b=f.property.specification.type,C=!!f.property.useIntegerZoom,P="line-dasharray"===d||d.endsWith("pattern"),E="line-dasharray"===d&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==y.kind||E)if("source"===y.kind||E||P){const I=_P(d,b,"source");this.binders[d]=P?new pr(y,g,b,I,t.id):new an(y,g,b,I),c.push(`/a_${d}`)}else{const I=_P(d,b,"composite");this.binders[d]=new Ol(y,g,b,C,r,I),c.push(`/z_${d}`)}else this.binders[d]=P?new Sa(y.value,g):new Hh(y.value,g,b),c.push(`/u_${d}`)}this.cacheKey=c.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof an||r instanceof Ol?r.maxValue:0}populatePaintArrays(t,r,s,c,d,f,g){for(const y in this.binders){const b=this.binders[y];(b instanceof an||b instanceof Ol||b instanceof pr)&&b.populatePaintArray(t,r,s,c,d,f,g)}}setConstantPatternPositions(t){for(const r in this.binders){const s=this.binders[r];s instanceof Sa&&s.setConstantPatternPositions(t)}}updatePaintArrays(t,r,s,c,d,f,g,y){let b=!1;const C=Object.keys(t),P=0!==C.length,E=P?C:r.uniqueIds;for(const I in this.binders){const A=this.binders[I];if((A instanceof an||A instanceof Ol||A instanceof pr)&&(!0===A.expression.isStateDependent||!1===A.expression.isLightConstant)){const l=d.paint.get(I);A.expression=l.value;for(const u of E){const p=t[u.toString()];r.eachPosition(u,(m,v,M)=>{const O=c.feature(m);A.updatePaintArray(v,M,O,p,f,g,y)})}if(!P)for(const u of s.uniqueIds){const p=t[u.toString()];s.eachPosition(u,(m,v,M)=>{const O=c.feature(m);A.updatePaintArray(v,M,O,p,f,g,y)})}b=!0}}return b}defines(){const t=[];for(const r in this.binders){const s=this.binders[r];(s instanceof Hh||s instanceof Sa)&&t.push(...s.uniformNames.map(c=>`#define HAS_UNIFORM_${c}`))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof an||s instanceof Ol||s instanceof pr)for(let c=0;c<s.paintVertexAttributes.length;c++)t.push(s.paintVertexAttributes[c].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof Hh||s instanceof Sa||s instanceof Ol)for(const c of s.uniformNames)t.push(c)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const r=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof Hh||c instanceof Sa||c instanceof Ol)for(const d of c.uniformNames)r.push({name:d,property:s,binding:c.getBinding(t,d)})}return r}setUniforms(t,r,s,c,d){for(const{name:f,property:g,binding:y}of s)this.binders[g].setUniform(t,y,d,c.get(g),f)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const r=this.binders[t];(r instanceof an||r instanceof Ol||r instanceof pr)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(t){for(const r in this.binders){const s=this.binders[r];(s instanceof an||s instanceof Ol||s instanceof pr)&&s.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof an||r instanceof Ol||r instanceof pr)&&r.destroy()}}}class ga{constructor(t,r,s=(()=>!0)){this.programConfigurations={};for(const c of t)this.programConfigurations[c.id]=new Lu(c,r,s);this.needsUpload=!1,this._featureMap=new d_,this._featureMapWithoutIds=new d_,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,r,s,c,d,f,g,y){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,r,c,d,f,g,y);void 0!==r.id?this._featureMap.add(r.id,s,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,s,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,s,c,d,f){for(const g of s)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,r,g,c,d,f||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const Pb={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Ob(e,t){return Pb[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}const xw={"line-pattern":{source:rc,composite:rc},"fill-pattern":{source:rc,composite:rc},"fill-extrusion-pattern":{source:rc,composite:rc},"line-dasharray":{source:Yy,composite:Yy}},Eb={color:{source:yw,composite:ku},number:{source:vb,composite:yw}};function _P(e,t,r){const s=xw[e];return s&&s[r]||Eb[t][r]}De(Hh,"ConstantBinder"),De(Sa,"PatternConstantBinder"),De(an,"SourceExpressionBinder"),De(pr,"PatternCompositeBinder"),De(Ol,"CompositeExpressionBinder"),De(Lu,"ProgramConfiguration",{omit:["_buffers"]}),De(ga,"ProgramConfigurationSet");class Qo{constructor(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof kn?new kn(t.lng,t.lat):kn.convert(t),this}setSouthWest(t){return this._sw=t instanceof kn?new kn(t.lng,t.lat):kn.convert(t),this}extend(t){const r=this._sw,s=this._ne;let c,d;if(t instanceof kn)c=t,d=t;else{if(!(t instanceof Qo))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(Qo.convert(t)):this.extend(kn.convert(t)):"object"==typeof t&&null!==t&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(kn.convert(t)):this;if(c=t._sw,d=t._ne,!c||!d)return this}return r||s?(r.lng=Math.min(c.lng,r.lng),r.lat=Math.min(c.lat,r.lat),s.lng=Math.max(d.lng,s.lng),s.lat=Math.max(d.lat,s.lat)):(this._sw=new kn(c.lng,c.lat),this._ne=new kn(d.lng,d.lat)),this}getCenter(){return new kn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new kn(this.getWest(),this.getNorth())}getSouthEast(){return new kn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:r,lat:s}=kn.convert(t);let c=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(c=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&c}static convert(t){return!t||t instanceof Qo?t:new Qo(t)}}var zi={},co={};Object.defineProperty(co,"__esModule",{value:!0}),co.setMatrixArrayType=function(e){co.ARRAY_TYPE=yP=e},co.toRadian=function(e){return e*f_},co.equals=function(e,t){return Math.abs(e-t)<=qh*Math.max(1,Math.abs(e),Math.abs(t))},co.RANDOM=co.ARRAY_TYPE=co.EPSILON=void 0;var qh=1e-6;co.EPSILON=qh;var yP=typeof Float32Array<"u"?Float32Array:Array;co.ARRAY_TYPE=yP;var ww=Math.random;co.RANDOM=ww;var f_=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var ko={};function Is(e){return(Is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(ko,"__esModule",{value:!0}),ko.create=function(){var e=new gp.ARRAY_TYPE(4);return gp.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},ko.clone=function(e){var t=new gp.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},ko.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},ko.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},ko.fromValues=function(e,t,r,s){var c=new gp.ARRAY_TYPE(4);return c[0]=e,c[1]=t,c[2]=r,c[3]=s,c},ko.set=function(e,t,r,s,c){return e[0]=t,e[1]=r,e[2]=s,e[3]=c,e},ko.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e},ko.invert=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=r*d-c*s;return f?(e[0]=d*(f=1/f),e[1]=-s*f,e[2]=-c*f,e[3]=r*f,e):null},ko.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e},ko.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},ko.multiply=Eg,ko.rotate=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=Math.sin(r),y=Math.cos(r);return e[0]=s*y+d*g,e[1]=c*y+f*g,e[2]=s*-g+d*y,e[3]=c*-g+f*y,e},ko.scale=function(e,t,r){var s=t[1],c=t[2],d=t[3],f=r[0],g=r[1];return e[0]=t[0]*f,e[1]=s*f,e[2]=c*g,e[3]=d*g,e},ko.fromRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=r,e[2]=-r,e[3]=s,e},ko.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e},ko.str=function(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},ko.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},ko.LDU=function(e,t,r,s){return e[2]=s[2]/s[0],r[0]=s[0],r[1]=s[1],r[3]=s[3]-e[2]*r[1],[e,t,r]},ko.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},ko.subtract=zc,ko.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},ko.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=e[3],f=t[0],g=t[1],y=t[2],b=t[3];return Math.abs(r-f)<=gp.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(s-g)<=gp.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-y)<=gp.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(d-b)<=gp.EPSILON*Math.max(1,Math.abs(d),Math.abs(b))},ko.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},ko.multiplyScalarAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e[2]=t[2]+r[2]*s,e[3]=t[3]+r[3]*s,e},ko.sub=ko.mul=void 0;var gp=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==Is(e)&&"function"!=typeof e)return{default:e};var r=p_(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(co);function p_(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(p_=function(s){return s?r:t})(e)}function Eg(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=r[0],y=r[1],b=r[2],C=r[3];return e[0]=s*g+d*y,e[1]=c*g+f*y,e[2]=s*b+d*C,e[3]=c*b+f*C,e}function zc(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}ko.mul=Eg,ko.sub=zc;var po={};function Tb(e){return(Tb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(po,"__esModule",{value:!0}),po.create=function(){var e=new Nu.ARRAY_TYPE(6);return Nu.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e},po.clone=function(e){var t=new Nu.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},po.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},po.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e},po.fromValues=function(e,t,r,s,c,d){var f=new Nu.ARRAY_TYPE(6);return f[0]=e,f[1]=t,f[2]=r,f[3]=s,f[4]=c,f[5]=d,f},po.set=function(e,t,r,s,c,d,f){return e[0]=t,e[1]=r,e[2]=s,e[3]=c,e[4]=d,e[5]=f,e},po.invert=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=r*d-s*c;return y?(e[0]=d*(y=1/y),e[1]=-s*y,e[2]=-c*y,e[3]=r*y,e[4]=(c*g-d*f)*y,e[5]=(s*f-r*g)*y,e):null},po.determinant=function(e){return e[0]*e[3]-e[1]*e[2]},po.multiply=vP,po.rotate=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=Math.sin(r),C=Math.cos(r);return e[0]=s*C+d*b,e[1]=c*C+f*b,e[2]=s*-b+d*C,e[3]=c*-b+f*C,e[4]=g,e[5]=y,e},po.scale=function(e,t,r){var s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=r[0],b=r[1];return e[0]=t[0]*y,e[1]=s*y,e[2]=c*b,e[3]=d*b,e[4]=f,e[5]=g,e},po.translate=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=r[0],C=r[1];return e[0]=s,e[1]=c,e[2]=d,e[3]=f,e[4]=s*b+d*C+g,e[5]=c*b+f*C+y,e},po.fromRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=r,e[2]=-r,e[3]=s,e[4]=0,e[5]=0,e},po.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e},po.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e},po.str=function(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"},po.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],1)},po.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e},po.subtract=Ig,po.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e},po.multiplyScalarAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e[2]=t[2]+r[2]*s,e[3]=t[3]+r[3]*s,e[4]=t[4]+r[4]*s,e[5]=t[5]+r[5]*s,e},po.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]},po.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=e[3],f=e[4],g=e[5],y=t[0],b=t[1],C=t[2],P=t[3],E=t[4],I=t[5];return Math.abs(r-y)<=Nu.EPSILON*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(s-b)<=Nu.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(c-C)<=Nu.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(d-P)<=Nu.EPSILON*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(f-E)<=Nu.EPSILON*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(g-I)<=Nu.EPSILON*Math.max(1,Math.abs(g),Math.abs(I))},po.sub=po.mul=void 0;var Nu=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==Tb(e)&&"function"!=typeof e)return{default:e};var r=Tg(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(co);function Tg(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(Tg=function(s){return s?r:t})(e)}function vP(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=r[0],C=r[1],P=r[2],E=r[3],I=r[4],A=r[5];return e[0]=s*b+d*C,e[1]=c*b+f*C,e[2]=s*P+d*E,e[3]=c*P+f*E,e[4]=s*I+d*A+g,e[5]=c*I+f*A+y,e}function Ig(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}po.mul=vP,po.sub=Ig;var uo={};function Ib(e){return(Ib="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(uo,"__esModule",{value:!0}),uo.create=function(){var e=new ol.ARRAY_TYPE(9);return ol.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},uo.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},uo.clone=function(e){var t=new ol.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},uo.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},uo.fromValues=function(e,t,r,s,c,d,f,g,y){var b=new ol.ARRAY_TYPE(9);return b[0]=e,b[1]=t,b[2]=r,b[3]=s,b[4]=c,b[5]=d,b[6]=f,b[7]=g,b[8]=y,b},uo.set=function(e,t,r,s,c,d,f,g,y,b){return e[0]=t,e[1]=r,e[2]=s,e[3]=c,e[4]=d,e[5]=f,e[6]=g,e[7]=y,e[8]=b,e},uo.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},uo.transpose=function(e,t){if(e===t){var r=t[1],s=t[2],c=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=s,e[7]=c}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},uo.invert=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=t[6],b=t[7],C=t[8],P=C*f-g*b,E=-C*d+g*y,I=b*d-f*y,A=r*P+s*E+c*I;return A?(e[0]=P*(A=1/A),e[1]=(-C*s+c*b)*A,e[2]=(g*s-c*f)*A,e[3]=E*A,e[4]=(C*r-c*y)*A,e[5]=(-g*r+c*d)*A,e[6]=I*A,e[7]=(-b*r+s*y)*A,e[8]=(f*r-s*d)*A,e):null},uo.adjoint=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=t[6],b=t[7],C=t[8];return e[0]=f*C-g*b,e[1]=c*b-s*C,e[2]=s*g-c*f,e[3]=g*y-d*C,e[4]=r*C-c*y,e[5]=c*d-r*g,e[6]=d*b-f*y,e[7]=s*y-r*b,e[8]=r*f-s*d,e},uo.determinant=function(e){var t=e[3],r=e[4],s=e[5],c=e[6],d=e[7],f=e[8];return e[0]*(f*r-s*d)+e[1]*(-f*t+s*c)+e[2]*(d*t-r*c)},uo.multiply=g_,uo.translate=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=t[6],C=t[7],P=t[8],E=r[0],I=r[1];return e[0]=s,e[1]=c,e[2]=d,e[3]=f,e[4]=g,e[5]=y,e[6]=E*s+I*f+b,e[7]=E*c+I*g+C,e[8]=E*d+I*y+P,e},uo.rotate=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=t[6],C=t[7],P=t[8],E=Math.sin(r),I=Math.cos(r);return e[0]=I*s+E*f,e[1]=I*c+E*g,e[2]=I*d+E*y,e[3]=I*f-E*s,e[4]=I*g-E*c,e[5]=I*y-E*d,e[6]=b,e[7]=C,e[8]=P,e},uo.scale=function(e,t,r){var s=r[0],c=r[1];return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=c*t[3],e[4]=c*t[4],e[5]=c*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},uo.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e},uo.fromRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=r,e[2]=0,e[3]=-r,e[4]=s,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},uo.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},uo.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e},uo.fromQuat=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=r+r,g=s+s,y=c+c,b=r*f,C=s*f,P=s*g,E=c*f,I=c*g,A=c*y,l=d*f,u=d*g,p=d*y;return e[0]=1-P-A,e[3]=C-p,e[6]=E+u,e[1]=C+p,e[4]=1-b-A,e[7]=I-l,e[2]=E-u,e[5]=I+l,e[8]=1-b-P,e},uo.normalFromMat4=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=t[6],b=t[7],C=t[8],P=t[9],E=t[10],I=t[11],A=t[12],l=t[13],u=t[14],p=t[15],m=r*g-s*f,v=r*y-c*f,M=r*b-d*f,O=s*y-c*g,T=s*b-d*g,k=c*b-d*y,N=C*l-P*A,F=C*u-E*A,$=C*p-I*A,q=P*u-E*l,Z=P*p-I*l,X=E*p-I*u,K=m*X-v*Z+M*q+O*$-T*F+k*N;return K?(e[0]=(g*X-y*Z+b*q)*(K=1/K),e[1]=(y*$-f*X-b*F)*K,e[2]=(f*Z-g*$+b*N)*K,e[3]=(c*Z-s*X-d*q)*K,e[4]=(r*X-c*$+d*F)*K,e[5]=(s*$-r*Z-d*N)*K,e[6]=(l*k-u*T+p*O)*K,e[7]=(u*M-A*k-p*v)*K,e[8]=(A*T-l*M+p*m)*K,e):null},uo.projection=function(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e},uo.str=function(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"},uo.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},uo.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e},uo.subtract=n0,uo.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e},uo.multiplyScalarAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e[2]=t[2]+r[2]*s,e[3]=t[3]+r[3]*s,e[4]=t[4]+r[4]*s,e[5]=t[5]+r[5]*s,e[6]=t[6]+r[6]*s,e[7]=t[7]+r[7]*s,e[8]=t[8]+r[8]*s,e},uo.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},uo.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=e[3],f=e[4],g=e[5],y=e[6],b=e[7],C=e[8],P=t[0],E=t[1],I=t[2],A=t[3],l=t[4],u=t[5],p=t[6],m=t[7],v=t[8];return Math.abs(r-P)<=ol.EPSILON*Math.max(1,Math.abs(r),Math.abs(P))&&Math.abs(s-E)<=ol.EPSILON*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(c-I)<=ol.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(d-A)<=ol.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(f-l)<=ol.EPSILON*Math.max(1,Math.abs(f),Math.abs(l))&&Math.abs(g-u)<=ol.EPSILON*Math.max(1,Math.abs(g),Math.abs(u))&&Math.abs(y-p)<=ol.EPSILON*Math.max(1,Math.abs(y),Math.abs(p))&&Math.abs(b-m)<=ol.EPSILON*Math.max(1,Math.abs(b),Math.abs(m))&&Math.abs(C-v)<=ol.EPSILON*Math.max(1,Math.abs(C),Math.abs(v))},uo.sub=uo.mul=void 0;var ol=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==Ib(e)&&"function"!=typeof e)return{default:e};var r=e0(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(co);function e0(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(e0=function(s){return s?r:t})(e)}function g_(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=t[6],C=t[7],P=t[8],E=r[0],I=r[1],A=r[2],l=r[3],u=r[4],p=r[5],m=r[6],v=r[7],M=r[8];return e[0]=E*s+I*f+A*b,e[1]=E*c+I*g+A*C,e[2]=E*d+I*y+A*P,e[3]=l*s+u*f+p*b,e[4]=l*c+u*g+p*C,e[5]=l*d+u*y+p*P,e[6]=m*s+v*f+M*b,e[7]=m*c+v*g+M*C,e[8]=m*d+v*y+M*P,e}function n0(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}uo.mul=g_,uo.sub=n0;var Bn={};function Zh(e){return(Zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.create=function(){var e=new Jo.ARRAY_TYPE(16);return Jo.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},Bn.clone=function(e){var t=new Jo.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Bn.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},Bn.fromValues=function(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l){var u=new Jo.ARRAY_TYPE(16);return u[0]=e,u[1]=t,u[2]=r,u[3]=s,u[4]=c,u[5]=d,u[6]=f,u[7]=g,u[8]=y,u[9]=b,u[10]=C,u[11]=P,u[12]=E,u[13]=I,u[14]=A,u[15]=l,u},Bn.set=function(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u){return e[0]=t,e[1]=r,e[2]=s,e[3]=c,e[4]=d,e[5]=f,e[6]=g,e[7]=y,e[8]=b,e[9]=C,e[10]=P,e[11]=E,e[12]=I,e[13]=A,e[14]=l,e[15]=u,e},Bn.identity=Wh,Bn.transpose=function(e,t){if(e===t){var r=t[1],s=t[2],c=t[3],d=t[6],f=t[7],g=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=s,e[9]=d,e[11]=t[14],e[12]=c,e[13]=f,e[14]=g}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},Bn.invert=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=t[6],b=t[7],C=t[8],P=t[9],E=t[10],I=t[11],A=t[12],l=t[13],u=t[14],p=t[15],m=r*g-s*f,v=r*y-c*f,M=r*b-d*f,O=s*y-c*g,T=s*b-d*g,k=c*b-d*y,N=C*l-P*A,F=C*u-E*A,$=C*p-I*A,q=P*u-E*l,Z=P*p-I*l,X=E*p-I*u,K=m*X-v*Z+M*q+O*$-T*F+k*N;return K?(e[0]=(g*X-y*Z+b*q)*(K=1/K),e[1]=(c*Z-s*X-d*q)*K,e[2]=(l*k-u*T+p*O)*K,e[3]=(E*T-P*k-I*O)*K,e[4]=(y*$-f*X-b*F)*K,e[5]=(r*X-c*$+d*F)*K,e[6]=(u*M-A*k-p*v)*K,e[7]=(C*k-E*M+I*v)*K,e[8]=(f*Z-g*$+b*N)*K,e[9]=(s*$-r*Z-d*N)*K,e[10]=(A*T-l*M+p*m)*K,e[11]=(P*M-C*T-I*m)*K,e[12]=(g*F-f*q-y*N)*K,e[13]=(r*q-s*F+c*N)*K,e[14]=(l*v-A*O-u*m)*K,e[15]=(C*O-P*v+E*m)*K,e):null},Bn.adjoint=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=t[4],g=t[5],y=t[6],b=t[7],C=t[8],P=t[9],E=t[10],I=t[11],A=t[12],l=t[13],u=t[14],p=t[15];return e[0]=g*(E*p-I*u)-P*(y*p-b*u)+l*(y*I-b*E),e[1]=-(s*(E*p-I*u)-P*(c*p-d*u)+l*(c*I-d*E)),e[2]=s*(y*p-b*u)-g*(c*p-d*u)+l*(c*b-d*y),e[3]=-(s*(y*I-b*E)-g*(c*I-d*E)+P*(c*b-d*y)),e[4]=-(f*(E*p-I*u)-C*(y*p-b*u)+A*(y*I-b*E)),e[5]=r*(E*p-I*u)-C*(c*p-d*u)+A*(c*I-d*E),e[6]=-(r*(y*p-b*u)-f*(c*p-d*u)+A*(c*b-d*y)),e[7]=r*(y*I-b*E)-f*(c*I-d*E)+C*(c*b-d*y),e[8]=f*(P*p-I*l)-C*(g*p-b*l)+A*(g*I-b*P),e[9]=-(r*(P*p-I*l)-C*(s*p-d*l)+A*(s*I-d*P)),e[10]=r*(g*p-b*l)-f*(s*p-d*l)+A*(s*b-d*g),e[11]=-(r*(g*I-b*P)-f*(s*I-d*P)+C*(s*b-d*g)),e[12]=-(f*(P*u-E*l)-C*(g*u-y*l)+A*(g*E-y*P)),e[13]=r*(P*u-E*l)-C*(s*u-c*l)+A*(s*E-c*P),e[14]=-(r*(g*u-y*l)-f*(s*u-c*l)+A*(s*y-c*g)),e[15]=r*(g*E-y*P)-f*(s*E-c*P)+C*(s*y-c*g),e},Bn.determinant=function(e){var t=e[0],r=e[1],s=e[2],c=e[3],d=e[4],f=e[5],g=e[6],y=e[7],b=e[8],C=e[9],P=e[10],E=e[11],I=e[12],A=e[13],l=e[14],u=e[15];return(t*f-r*d)*(P*u-E*l)-(t*g-s*d)*(C*u-E*A)+(t*y-c*d)*(C*l-P*A)+(r*g-s*f)*(b*u-E*I)-(r*y-c*f)*(b*l-P*I)+(s*y-c*g)*(b*A-C*I)},Bn.multiply=Cw,Bn.translate=function(e,t,r){var s,c,d,f,g,y,b,C,P,E,I,A,l=r[0],u=r[1],p=r[2];return t===e?(e[12]=t[0]*l+t[4]*u+t[8]*p+t[12],e[13]=t[1]*l+t[5]*u+t[9]*p+t[13],e[14]=t[2]*l+t[6]*u+t[10]*p+t[14],e[15]=t[3]*l+t[7]*u+t[11]*p+t[15]):(c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=t[6],C=t[7],P=t[8],E=t[9],I=t[10],A=t[11],e[0]=s=t[0],e[1]=c,e[2]=d,e[3]=f,e[4]=g,e[5]=y,e[6]=b,e[7]=C,e[8]=P,e[9]=E,e[10]=I,e[11]=A,e[12]=s*l+g*u+P*p+t[12],e[13]=c*l+y*u+E*p+t[13],e[14]=d*l+b*u+I*p+t[14],e[15]=f*l+C*u+A*p+t[15]),e},Bn.scale=function(e,t,r){var s=r[0],c=r[1],d=r[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*c,e[5]=t[5]*c,e[6]=t[6]*c,e[7]=t[7]*c,e[8]=t[8]*d,e[9]=t[9]*d,e[10]=t[10]*d,e[11]=t[11]*d,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},Bn.rotate=function(e,t,r,s){var c,d,f,g,y,b,C,P,E,I,A,l,u,p,m,v,M,O,T,k,N,F,$,q,Z=s[0],X=s[1],K=s[2],J=Math.hypot(Z,X,K);return J<Jo.EPSILON?null:(Z*=J=1/J,X*=J,K*=J,c=Math.sin(r),d=Math.cos(r),y=t[1],b=t[2],C=t[3],E=t[5],I=t[6],A=t[7],u=t[9],p=t[10],m=t[11],T=Z*X*(f=1-d)-K*c,k=X*X*f+d,N=K*X*f+Z*c,F=Z*K*f+X*c,$=X*K*f-Z*c,q=K*K*f+d,e[0]=(g=t[0])*(v=Z*Z*f+d)+(P=t[4])*(M=X*Z*f+K*c)+(l=t[8])*(O=K*Z*f-X*c),e[1]=y*v+E*M+u*O,e[2]=b*v+I*M+p*O,e[3]=C*v+A*M+m*O,e[4]=g*T+P*k+l*N,e[5]=y*T+E*k+u*N,e[6]=b*T+I*k+p*N,e[7]=C*T+A*k+m*N,e[8]=g*F+P*$+l*q,e[9]=y*F+E*$+u*q,e[10]=b*F+I*$+p*q,e[11]=C*F+A*$+m*q,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},Bn.rotateX=function(e,t,r){var s=Math.sin(r),c=Math.cos(r),d=t[4],f=t[5],g=t[6],y=t[7],b=t[8],C=t[9],P=t[10],E=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=d*c+b*s,e[5]=f*c+C*s,e[6]=g*c+P*s,e[7]=y*c+E*s,e[8]=b*c-d*s,e[9]=C*c-f*s,e[10]=P*c-g*s,e[11]=E*c-y*s,e},Bn.rotateY=function(e,t,r){var s=Math.sin(r),c=Math.cos(r),d=t[0],f=t[1],g=t[2],y=t[3],b=t[8],C=t[9],P=t[10],E=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=d*c-b*s,e[1]=f*c-C*s,e[2]=g*c-P*s,e[3]=y*c-E*s,e[8]=d*s+b*c,e[9]=f*s+C*c,e[10]=g*s+P*c,e[11]=y*s+E*c,e},Bn.rotateZ=function(e,t,r){var s=Math.sin(r),c=Math.cos(r),d=t[0],f=t[1],g=t[2],y=t[3],b=t[4],C=t[5],P=t[6],E=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=d*c+b*s,e[1]=f*c+C*s,e[2]=g*c+P*s,e[3]=y*c+E*s,e[4]=b*c-d*s,e[5]=C*c-f*s,e[6]=P*c-g*s,e[7]=E*c-y*s,e},Bn.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},Bn.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},Bn.fromRotation=function(e,t,r){var s,c,d,f=r[0],g=r[1],y=r[2],b=Math.hypot(f,g,y);return b<Jo.EPSILON?null:(f*=b=1/b,g*=b,y*=b,s=Math.sin(t),c=Math.cos(t),e[0]=f*f*(d=1-c)+c,e[1]=g*f*d+y*s,e[2]=y*f*d-g*s,e[3]=0,e[4]=f*g*d-y*s,e[5]=g*g*d+c,e[6]=y*g*d+f*s,e[7]=0,e[8]=f*y*d+g*s,e[9]=g*y*d-f*s,e[10]=y*y*d+c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},Bn.fromXRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},Bn.fromYRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},Bn.fromZRotation=function(e,t){var r=Math.sin(t),s=Math.cos(t);return e[0]=s,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},Bn.fromRotationTranslation=mp,Bn.fromQuat2=function(e,t){var r=new Jo.ARRAY_TYPE(3),s=-t[0],c=-t[1],d=-t[2],f=t[3],g=t[4],y=t[5],b=t[6],C=t[7],P=s*s+c*c+d*d+f*f;return P>0?(r[0]=2*(g*f+C*s+y*d-b*c)/P,r[1]=2*(y*f+C*c+b*s-g*d)/P,r[2]=2*(b*f+C*d+g*c-y*s)/P):(r[0]=2*(g*f+C*s+y*d-b*c),r[1]=2*(y*f+C*c+b*s-g*d),r[2]=2*(b*f+C*d+g*c-y*s)),mp(e,t,r),e},Bn.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},Bn.getScaling=m_,Bn.getRotation=function(e,t){var r=new Jo.ARRAY_TYPE(3);m_(r,t);var s=1/r[0],c=1/r[1],d=1/r[2],f=t[0]*s,g=t[1]*c,y=t[2]*d,b=t[4]*s,C=t[5]*c,P=t[6]*d,E=t[8]*s,I=t[9]*c,A=t[10]*d,l=f+C+A,u=0;return l>0?(u=2*Math.sqrt(l+1),e[3]=.25*u,e[0]=(P-I)/u,e[1]=(E-y)/u,e[2]=(g-b)/u):f>C&&f>A?(u=2*Math.sqrt(1+f-C-A),e[3]=(P-I)/u,e[0]=.25*u,e[1]=(g+b)/u,e[2]=(E+y)/u):C>A?(u=2*Math.sqrt(1+C-f-A),e[3]=(E-y)/u,e[0]=(g+b)/u,e[1]=.25*u,e[2]=(P+I)/u):(u=2*Math.sqrt(1+A-f-C),e[3]=(g-b)/u,e[0]=(E+y)/u,e[1]=(P+I)/u,e[2]=.25*u),e},Bn.fromRotationTranslationScale=function(e,t,r,s){var c=t[0],d=t[1],f=t[2],g=t[3],y=c+c,b=d+d,C=f+f,P=c*y,E=c*b,I=c*C,A=d*b,l=d*C,u=f*C,p=g*y,m=g*b,v=g*C,M=s[0],O=s[1],T=s[2];return e[0]=(1-(A+u))*M,e[1]=(E+v)*M,e[2]=(I-m)*M,e[3]=0,e[4]=(E-v)*O,e[5]=(1-(P+u))*O,e[6]=(l+p)*O,e[7]=0,e[8]=(I+m)*T,e[9]=(l-p)*T,e[10]=(1-(P+A))*T,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},Bn.fromRotationTranslationScaleOrigin=function(e,t,r,s,c){var d=t[0],f=t[1],g=t[2],y=t[3],b=d+d,C=f+f,P=g+g,E=d*b,I=d*C,A=d*P,l=f*C,u=f*P,p=g*P,m=y*b,v=y*C,M=y*P,O=s[0],T=s[1],k=s[2],N=c[0],F=c[1],$=c[2],q=(1-(l+p))*O,Z=(I+M)*O,X=(A-v)*O,K=(I-M)*T,J=(1-(E+p))*T,st=(u+m)*T,it=(A+v)*k,rt=(u-m)*k,ct=(1-(E+l))*k;return e[0]=q,e[1]=Z,e[2]=X,e[3]=0,e[4]=K,e[5]=J,e[6]=st,e[7]=0,e[8]=it,e[9]=rt,e[10]=ct,e[11]=0,e[12]=r[0]+N-(q*N+K*F+it*$),e[13]=r[1]+F-(Z*N+J*F+rt*$),e[14]=r[2]+$-(X*N+st*F+ct*$),e[15]=1,e},Bn.fromQuat=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=r+r,g=s+s,y=c+c,b=r*f,C=s*f,P=s*g,E=c*f,I=c*g,A=c*y,l=d*f,u=d*g,p=d*y;return e[0]=1-P-A,e[1]=C+p,e[2]=E-u,e[3]=0,e[4]=C-p,e[5]=1-b-A,e[6]=I+l,e[7]=0,e[8]=E+u,e[9]=I-l,e[10]=1-b-P,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},Bn.frustum=function(e,t,r,s,c,d,f){var g=1/(r-t),y=1/(c-s),b=1/(d-f);return e[0]=2*d*g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*d*y,e[6]=0,e[7]=0,e[8]=(r+t)*g,e[9]=(c+s)*y,e[10]=(f+d)*b,e[11]=-1,e[12]=0,e[13]=0,e[14]=f*d*2*b,e[15]=0,e},Bn.perspectiveNO=bP,Bn.perspectiveZO=function(e,t,r,s,c){var d,f=1/Math.tan(t/2);return e[0]=f/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=c&&c!==1/0?(e[10]=c*(d=1/(s-c)),e[14]=c*s*d):(e[10]=-1,e[14]=-s),e},Bn.perspectiveFromFieldOfView=function(e,t,r,s){var c=Math.tan(t.upDegrees*Math.PI/180),d=Math.tan(t.downDegrees*Math.PI/180),f=Math.tan(t.leftDegrees*Math.PI/180),g=Math.tan(t.rightDegrees*Math.PI/180),y=2/(f+g),b=2/(c+d);return e[0]=y,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=b,e[6]=0,e[7]=0,e[8]=-(f-g)*y*.5,e[9]=(c-d)*b*.5,e[10]=s/(r-s),e[11]=-1,e[12]=0,e[13]=0,e[14]=s*r/(r-s),e[15]=0,e},Bn.orthoNO=__,Bn.orthoZO=function(e,t,r,s,c,d,f){var g=1/(t-r),y=1/(s-c),b=1/(d-f);return e[0]=-2*g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=b,e[11]=0,e[12]=(t+r)*g,e[13]=(c+s)*y,e[14]=d*b,e[15]=1,e},Bn.lookAt=function(e,t,r,s){var c,d,f,g,y,b,C,P,E,I,A=t[0],l=t[1],u=t[2],p=s[0],m=s[1],v=s[2],M=r[0],O=r[1],T=r[2];return Math.abs(A-M)<Jo.EPSILON&&Math.abs(l-O)<Jo.EPSILON&&Math.abs(u-T)<Jo.EPSILON?Wh(e):(C=A-M,P=l-O,E=u-T,c=m*(E*=I=1/Math.hypot(C,P,E))-v*(P*=I),d=v*(C*=I)-p*E,f=p*P-m*C,(I=Math.hypot(c,d,f))?(c*=I=1/I,d*=I,f*=I):(c=0,d=0,f=0),g=P*f-E*d,y=E*c-C*f,b=C*d-P*c,(I=Math.hypot(g,y,b))?(g*=I=1/I,y*=I,b*=I):(g=0,y=0,b=0),e[0]=c,e[1]=g,e[2]=C,e[3]=0,e[4]=d,e[5]=y,e[6]=P,e[7]=0,e[8]=f,e[9]=b,e[10]=E,e[11]=0,e[12]=-(c*A+d*l+f*u),e[13]=-(g*A+y*l+b*u),e[14]=-(C*A+P*l+E*u),e[15]=1,e)},Bn.targetTo=function(e,t,r,s){var c=t[0],d=t[1],f=t[2],g=s[0],y=s[1],b=s[2],C=c-r[0],P=d-r[1],E=f-r[2],I=C*C+P*P+E*E;I>0&&(C*=I=1/Math.sqrt(I),P*=I,E*=I);var A=y*E-b*P,l=b*C-g*E,u=g*P-y*C;return(I=A*A+l*l+u*u)>0&&(A*=I=1/Math.sqrt(I),l*=I,u*=I),e[0]=A,e[1]=l,e[2]=u,e[3]=0,e[4]=P*u-E*l,e[5]=E*A-C*u,e[6]=C*l-P*A,e[7]=0,e[8]=C,e[9]=P,e[10]=E,e[11]=0,e[12]=c,e[13]=d,e[14]=f,e[15]=1,e},Bn.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},Bn.frob=function(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},Bn.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},Bn.subtract=Ab,Bn.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},Bn.multiplyScalarAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e[2]=t[2]+r[2]*s,e[3]=t[3]+r[3]*s,e[4]=t[4]+r[4]*s,e[5]=t[5]+r[5]*s,e[6]=t[6]+r[6]*s,e[7]=t[7]+r[7]*s,e[8]=t[8]+r[8]*s,e[9]=t[9]+r[9]*s,e[10]=t[10]+r[10]*s,e[11]=t[11]+r[11]*s,e[12]=t[12]+r[12]*s,e[13]=t[13]+r[13]*s,e[14]=t[14]+r[14]*s,e[15]=t[15]+r[15]*s,e},Bn.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},Bn.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=e[3],f=e[4],g=e[5],y=e[6],b=e[7],C=e[8],P=e[9],E=e[10],I=e[11],A=e[12],l=e[13],u=e[14],p=e[15],m=t[0],v=t[1],M=t[2],O=t[3],T=t[4],k=t[5],N=t[6],F=t[7],$=t[8],q=t[9],Z=t[10],X=t[11],K=t[12],J=t[13],st=t[14],it=t[15];return Math.abs(r-m)<=Jo.EPSILON*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(s-v)<=Jo.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(c-M)<=Jo.EPSILON*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(d-O)<=Jo.EPSILON*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(f-T)<=Jo.EPSILON*Math.max(1,Math.abs(f),Math.abs(T))&&Math.abs(g-k)<=Jo.EPSILON*Math.max(1,Math.abs(g),Math.abs(k))&&Math.abs(y-N)<=Jo.EPSILON*Math.max(1,Math.abs(y),Math.abs(N))&&Math.abs(b-F)<=Jo.EPSILON*Math.max(1,Math.abs(b),Math.abs(F))&&Math.abs(C-$)<=Jo.EPSILON*Math.max(1,Math.abs(C),Math.abs($))&&Math.abs(P-q)<=Jo.EPSILON*Math.max(1,Math.abs(P),Math.abs(q))&&Math.abs(E-Z)<=Jo.EPSILON*Math.max(1,Math.abs(E),Math.abs(Z))&&Math.abs(I-X)<=Jo.EPSILON*Math.max(1,Math.abs(I),Math.abs(X))&&Math.abs(A-K)<=Jo.EPSILON*Math.max(1,Math.abs(A),Math.abs(K))&&Math.abs(l-J)<=Jo.EPSILON*Math.max(1,Math.abs(l),Math.abs(J))&&Math.abs(u-st)<=Jo.EPSILON*Math.max(1,Math.abs(u),Math.abs(st))&&Math.abs(p-it)<=Jo.EPSILON*Math.max(1,Math.abs(p),Math.abs(it))},Bn.sub=Bn.mul=Bn.ortho=Bn.perspective=void 0;var Jo=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==Zh(e)&&"function"!=typeof e)return{default:e};var r=Sb(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(co);function Sb(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(Sb=function(s){return s?r:t})(e)}function Wh(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Cw(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=t[4],y=t[5],b=t[6],C=t[7],P=t[8],E=t[9],I=t[10],A=t[11],l=t[12],u=t[13],p=t[14],m=t[15],v=r[0],M=r[1],O=r[2],T=r[3];return e[0]=v*s+M*g+O*P+T*l,e[1]=v*c+M*y+O*E+T*u,e[2]=v*d+M*b+O*I+T*p,e[3]=v*f+M*C+O*A+T*m,e[4]=(v=r[4])*s+(M=r[5])*g+(O=r[6])*P+(T=r[7])*l,e[5]=v*c+M*y+O*E+T*u,e[6]=v*d+M*b+O*I+T*p,e[7]=v*f+M*C+O*A+T*m,e[8]=(v=r[8])*s+(M=r[9])*g+(O=r[10])*P+(T=r[11])*l,e[9]=v*c+M*y+O*E+T*u,e[10]=v*d+M*b+O*I+T*p,e[11]=v*f+M*C+O*A+T*m,e[12]=(v=r[12])*s+(M=r[13])*g+(O=r[14])*P+(T=r[15])*l,e[13]=v*c+M*y+O*E+T*u,e[14]=v*d+M*b+O*I+T*p,e[15]=v*f+M*C+O*A+T*m,e}function mp(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=s+s,y=c+c,b=d+d,C=s*g,P=s*y,E=s*b,I=c*y,A=c*b,l=d*b,u=f*g,p=f*y,m=f*b;return e[0]=1-(I+l),e[1]=P+m,e[2]=E-p,e[3]=0,e[4]=P-m,e[5]=1-(C+l),e[6]=A+u,e[7]=0,e[8]=E+p,e[9]=A-u,e[10]=1-(C+I),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function m_(e,t){var r=t[4],s=t[5],c=t[6],d=t[8],f=t[9],g=t[10];return e[0]=Math.hypot(t[0],t[1],t[2]),e[1]=Math.hypot(r,s,c),e[2]=Math.hypot(d,f,g),e}function bP(e,t,r,s,c){var d,f=1/Math.tan(t/2);return e[0]=f/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=c&&c!==1/0?(e[10]=(c+s)*(d=1/(s-c)),e[14]=2*c*s*d):(e[10]=-1,e[14]=-2*s),e}function __(e,t,r,s,c,d,f){var g=1/(t-r),y=1/(s-c),b=1/(d-f);return e[0]=-2*g,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*b,e[11]=0,e[12]=(t+r)*g,e[13]=(c+s)*y,e[14]=(f+d)*b,e[15]=1,e}function Ab(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}Bn.perspective=bP,Bn.ortho=__,Bn.mul=Cw,Bn.sub=Ab;var jn={},qn={};function r0(e){return(r0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(qn,"__esModule",{value:!0}),qn.create=y_,qn.clone=function(e){var t=new Fu.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},qn.length=Kh,qn.fromValues=function(e,t,r){var s=new Fu.ARRAY_TYPE(3);return s[0]=e,s[1]=t,s[2]=r,s},qn.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},qn.set=function(e,t,r,s){return e[0]=t,e[1]=r,e[2]=s,e},qn.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},qn.subtract=Db,qn.multiply=kb,qn.divide=xP,qn.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},qn.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},qn.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},qn.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},qn.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},qn.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},qn.scaleAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e[2]=t[2]+r[2]*s,e},qn.distance=Mw,qn.squaredDistance=Rb,qn.squaredLength=Pw,qn.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},qn.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},qn.normalize=function(e,t){var r=t[0],s=t[1],c=t[2],d=r*r+s*s+c*c;return d>0&&(d=1/Math.sqrt(d)),e[0]=t[0]*d,e[1]=t[1]*d,e[2]=t[2]*d,e},qn.dot=yp,qn.cross=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=r[0],g=r[1],y=r[2];return e[0]=c*y-d*g,e[1]=d*f-s*y,e[2]=s*g-c*f,e},qn.lerp=function(e,t,r,s){var c=t[0],d=t[1],f=t[2];return e[0]=c+s*(r[0]-c),e[1]=d+s*(r[1]-d),e[2]=f+s*(r[2]-f),e},qn.hermite=function(e,t,r,s,c,d){var f=d*d,g=f*(2*d-3)+1,y=f*(d-2)+d,b=f*(d-1),C=f*(3-2*d);return e[0]=t[0]*g+r[0]*y+s[0]*b+c[0]*C,e[1]=t[1]*g+r[1]*y+s[1]*b+c[1]*C,e[2]=t[2]*g+r[2]*y+s[2]*b+c[2]*C,e},qn.bezier=function(e,t,r,s,c,d){var f=1-d,g=f*f,y=d*d,b=g*f,C=3*d*g,P=3*y*f,E=y*d;return e[0]=t[0]*b+r[0]*C+s[0]*P+c[0]*E,e[1]=t[1]*b+r[1]*C+s[1]*P+c[1]*E,e[2]=t[2]*b+r[2]*C+s[2]*P+c[2]*E,e},qn.random=function(e,t){t=t||1;var r=2*Fu.RANDOM()*Math.PI,s=2*Fu.RANDOM()-1,c=Math.sqrt(1-s*s)*t;return e[0]=Math.cos(r)*c,e[1]=Math.sin(r)*c,e[2]=s*t,e},qn.transformMat4=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=r[3]*s+r[7]*c+r[11]*d+r[15];return e[0]=(r[0]*s+r[4]*c+r[8]*d+r[12])/(f=f||1),e[1]=(r[1]*s+r[5]*c+r[9]*d+r[13])/f,e[2]=(r[2]*s+r[6]*c+r[10]*d+r[14])/f,e},qn.transformMat3=function(e,t,r){var s=t[0],c=t[1],d=t[2];return e[0]=s*r[0]+c*r[3]+d*r[6],e[1]=s*r[1]+c*r[4]+d*r[7],e[2]=s*r[2]+c*r[5]+d*r[8],e},qn.transformQuat=function(e,t,r){var s=r[0],c=r[1],d=r[2],f=t[0],g=t[1],y=t[2],b=c*y-d*g,C=d*f-s*y,P=s*g-c*f,E=c*P-d*C,I=d*b-s*P,A=s*C-c*b,l=2*r[3];return C*=l,P*=l,I*=2,A*=2,e[0]=f+(b*=l)+(E*=2),e[1]=g+C+I,e[2]=y+P+A,e},qn.rotateX=function(e,t,r,s){var c=[],d=[];return c[0]=t[0]-r[0],c[1]=t[1]-r[1],c[2]=t[2]-r[2],d[0]=c[0],d[1]=c[1]*Math.cos(s)-c[2]*Math.sin(s),d[2]=c[1]*Math.sin(s)+c[2]*Math.cos(s),e[0]=d[0]+r[0],e[1]=d[1]+r[1],e[2]=d[2]+r[2],e},qn.rotateY=function(e,t,r,s){var c=[],d=[];return c[0]=t[0]-r[0],c[1]=t[1]-r[1],c[2]=t[2]-r[2],d[0]=c[2]*Math.sin(s)+c[0]*Math.cos(s),d[1]=c[1],d[2]=c[2]*Math.cos(s)-c[0]*Math.sin(s),e[0]=d[0]+r[0],e[1]=d[1]+r[1],e[2]=d[2]+r[2],e},qn.rotateZ=function(e,t,r,s){var c=[],d=[];return c[0]=t[0]-r[0],c[1]=t[1]-r[1],c[2]=t[2]-r[2],d[0]=c[0]*Math.cos(s)-c[1]*Math.sin(s),d[1]=c[0]*Math.sin(s)+c[1]*Math.cos(s),d[2]=c[2],e[0]=d[0]+r[0],e[1]=d[1]+r[1],e[2]=d[2]+r[2],e},qn.angle=function(e,t){var r=e[0],s=e[1],c=e[2],d=t[0],f=t[1],g=t[2],y=Math.sqrt(r*r+s*s+c*c)*Math.sqrt(d*d+f*f+g*g),b=y&&yp(e,t)/y;return Math.acos(Math.min(Math.max(b,-1),1))},qn.zero=function(e){return e[0]=0,e[1]=0,e[2]=0,e},qn.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},qn.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},qn.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=t[0],f=t[1],g=t[2];return Math.abs(r-d)<=Fu.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(s-f)<=Fu.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(c-g)<=Fu.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))},qn.forEach=qn.sqrLen=qn.len=qn.sqrDist=qn.dist=qn.div=qn.mul=qn.sub=void 0;var Fu=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r0(e)&&"function"!=typeof e)return{default:e};var r=_p(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(co);function _p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(_p=function(s){return s?r:t})(e)}function y_(){var e=new Fu.ARRAY_TYPE(3);return Fu.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Kh(e){return Math.hypot(e[0],e[1],e[2])}function Db(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function kb(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function xP(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function Mw(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])}function Rb(e,t){var r=t[0]-e[0],s=t[1]-e[1],c=t[2]-e[2];return r*r+s*s+c*c}function Pw(e){var t=e[0],r=e[1],s=e[2];return t*t+r*r+s*s}function yp(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}qn.sub=Db,qn.mul=kb,qn.div=xP,qn.dist=Mw,qn.sqrDist=Rb,qn.len=Kh,qn.sqrLen=Pw;var El,Lb=(El=y_(),function(e,t,r,s,c,d){var f,g;for(t||(t=3),r||(r=0),g=s?Math.min(s*t+r,e.length):e.length,f=r;f<g;f+=t)El[0]=e[f],El[1]=e[f+1],El[2]=e[f+2],c(El,El,d),e[f]=El[0],e[f+1]=El[1],e[f+2]=El[2];return e});qn.forEach=Lb;var gr={};function v_(e){return(v_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(gr,"__esModule",{value:!0}),gr.create=Fs,gr.clone=function(e){var t=new il.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},gr.fromValues=function(e,t,r,s){var c=new il.ARRAY_TYPE(4);return c[0]=e,c[1]=t,c[2]=r,c[3]=s,c},gr.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},gr.set=function(e,t,r,s,c){return e[0]=t,e[1]=r,e[2]=s,e[3]=c,e},gr.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},gr.subtract=Js,gr.multiply=s0,gr.divide=Nb,gr.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},gr.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},gr.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},gr.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},gr.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},gr.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},gr.scaleAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e[2]=t[2]+r[2]*s,e[3]=t[3]+r[3]*s,e},gr.distance=wP,gr.squaredDistance=Yh,gr.length=b_,gr.squaredLength=Ow,gr.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},gr.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},gr.normalize=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=r*r+s*s+c*c+d*d;return f>0&&(f=1/Math.sqrt(f)),e[0]=r*f,e[1]=s*f,e[2]=c*f,e[3]=d*f,e},gr.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},gr.cross=function(e,t,r,s){var c=r[0]*s[1]-r[1]*s[0],d=r[0]*s[2]-r[2]*s[0],f=r[0]*s[3]-r[3]*s[0],g=r[1]*s[2]-r[2]*s[1],y=r[1]*s[3]-r[3]*s[1],b=r[2]*s[3]-r[3]*s[2],C=t[0],P=t[1],E=t[2],I=t[3];return e[0]=P*b-E*y+I*g,e[1]=-C*b+E*f-I*d,e[2]=C*y-P*f+I*c,e[3]=-C*g+P*d-E*c,e},gr.lerp=function(e,t,r,s){var c=t[0],d=t[1],f=t[2],g=t[3];return e[0]=c+s*(r[0]-c),e[1]=d+s*(r[1]-d),e[2]=f+s*(r[2]-f),e[3]=g+s*(r[3]-g),e},gr.random=function(e,t){var r,s,c,d,f,g;t=t||1;do{f=(r=2*il.RANDOM()-1)*r+(s=2*il.RANDOM()-1)*s}while(f>=1);do{g=(c=2*il.RANDOM()-1)*c+(d=2*il.RANDOM()-1)*d}while(g>=1);var y=Math.sqrt((1-f)/g);return e[0]=t*r,e[1]=t*s,e[2]=t*c*y,e[3]=t*d*y,e},gr.transformMat4=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3];return e[0]=r[0]*s+r[4]*c+r[8]*d+r[12]*f,e[1]=r[1]*s+r[5]*c+r[9]*d+r[13]*f,e[2]=r[2]*s+r[6]*c+r[10]*d+r[14]*f,e[3]=r[3]*s+r[7]*c+r[11]*d+r[15]*f,e},gr.transformQuat=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=r[0],g=r[1],y=r[2],b=r[3],C=b*s+g*d-y*c,P=b*c+y*s-f*d,E=b*d+f*c-g*s,I=-f*s-g*c-y*d;return e[0]=C*b+I*-f+P*-y-E*-g,e[1]=P*b+I*-g+E*-f-C*-y,e[2]=E*b+I*-y+C*-g-P*-f,e[3]=t[3],e},gr.zero=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},gr.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},gr.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},gr.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=e[3],f=t[0],g=t[1],y=t[2],b=t[3];return Math.abs(r-f)<=il.EPSILON*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(s-g)<=il.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-y)<=il.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(d-b)<=il.EPSILON*Math.max(1,Math.abs(d),Math.abs(b))},gr.forEach=gr.sqrLen=gr.len=gr.sqrDist=gr.dist=gr.div=gr.mul=gr.sub=void 0;var il=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==v_(e)&&"function"!=typeof e)return{default:e};var r=o0(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(co);function o0(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o0=function(s){return s?r:t})(e)}function Fs(){var e=new il.ARRAY_TYPE(4);return il.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Js(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function s0(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function Nb(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function wP(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2],t[3]-e[3])}function Yh(e,t){var r=t[0]-e[0],s=t[1]-e[1],c=t[2]-e[2],d=t[3]-e[3];return r*r+s*s+c*c+d*d}function b_(e){return Math.hypot(e[0],e[1],e[2],e[3])}function Ow(e){var t=e[0],r=e[1],s=e[2],c=e[3];return t*t+r*r+s*s+c*c}gr.sub=Js,gr.mul=s0,gr.div=Nb,gr.dist=wP,gr.sqrDist=Yh,gr.len=b_,gr.sqrLen=Ow;var NI=function(){var e=Fs();return function(t,r,s,c,d,f){var g,y;for(r||(r=4),s||(s=0),y=c?Math.min(c*r+s,t.length):t.length,g=s;g<y;g+=r)e[0]=t[g],e[1]=t[g+1],e[2]=t[g+2],e[3]=t[g+3],d(e,e,f),t[g]=e[0],t[g+1]=e[1],t[g+2]=e[2],t[g+3]=e[3];return t}}();function CP(e){return(CP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}gr.forEach=NI,Object.defineProperty(jn,"__esModule",{value:!0}),jn.create=w_,jn.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},jn.setAxisAngle=Bb,jn.getAxisAngle=function(e,t){var r=2*Math.acos(t[3]),s=Math.sin(r/2);return s>x_.EPSILON?(e[0]=t[0]/s,e[1]=t[1]/s,e[2]=t[2]/s):(e[0]=1,e[1]=0,e[2]=0),r},jn.getAngle=function(e,t){var r=MP(e,t);return Math.acos(2*r*r-1)},jn.multiply=C_,jn.rotateX=function(e,t,r){r*=.5;var s=t[0],c=t[1],d=t[2],f=t[3],g=Math.sin(r),y=Math.cos(r);return e[0]=s*y+f*g,e[1]=c*y+d*g,e[2]=d*y-c*g,e[3]=f*y-s*g,e},jn.rotateY=function(e,t,r){r*=.5;var s=t[0],c=t[1],d=t[2],f=t[3],g=Math.sin(r),y=Math.cos(r);return e[0]=s*y-d*g,e[1]=c*y+f*g,e[2]=d*y+s*g,e[3]=f*y-c*g,e},jn.rotateZ=function(e,t,r){r*=.5;var s=t[0],c=t[1],d=t[2],f=t[3],g=Math.sin(r),y=Math.cos(r);return e[0]=s*y+c*g,e[1]=c*y-s*g,e[2]=d*y+f*g,e[3]=f*y-d*g,e},jn.calculateW=function(e,t){var r=t[0],s=t[1],c=t[2];return e[0]=r,e[1]=s,e[2]=c,e[3]=Math.sqrt(Math.abs(1-r*r-s*s-c*c)),e},jn.exp=zu,jn.ln=M_,jn.pow=function(e,t,r){return M_(e,t),Vb(e,e,r),zu(e,e),e},jn.slerp=Xh,jn.random=function(e){var t=x_.RANDOM(),r=x_.RANDOM(),s=x_.RANDOM(),c=Math.sqrt(1-t),d=Math.sqrt(t);return e[0]=c*Math.sin(2*Math.PI*r),e[1]=c*Math.cos(2*Math.PI*r),e[2]=d*Math.sin(2*Math.PI*s),e[3]=d*Math.cos(2*Math.PI*s),e},jn.invert=function(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=r*r+s*s+c*c+d*d,g=f?1/f:0;return e[0]=-r*g,e[1]=-s*g,e[2]=-c*g,e[3]=d*g,e},jn.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},jn.fromMat3=Ub,jn.fromEuler=function(e,t,r,s){var c=.5*Math.PI/180;t*=c,r*=c,s*=c;var d=Math.sin(t),f=Math.cos(t),g=Math.sin(r),y=Math.cos(r),b=Math.sin(s),C=Math.cos(s);return e[0]=d*y*C-f*g*b,e[1]=f*g*C+d*y*b,e[2]=f*y*b-d*g*C,e[3]=f*y*C+d*g*b,e},jn.str=function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},jn.setAxes=jn.sqlerp=jn.rotationTo=jn.equals=jn.exactEquals=jn.normalize=jn.sqrLen=jn.squaredLength=jn.len=jn.length=jn.lerp=jn.dot=jn.scale=jn.mul=jn.add=jn.set=jn.copy=jn.fromValues=jn.clone=void 0;var x_=zb(co),Fb=zb(uo),Bc=zb(qn),Aa=zb(gr);function Ew(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(Ew=function(s){return s?r:t})(e)}function zb(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==CP(e)&&"function"!=typeof e)return{default:e};var r=Ew(t);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}function w_(){var e=new x_.ARRAY_TYPE(4);return x_.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Bb(e,t,r){r*=.5;var s=Math.sin(r);return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=Math.cos(r),e}function C_(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=r[0],y=r[1],b=r[2],C=r[3];return e[0]=s*C+f*g+c*b-d*y,e[1]=c*C+f*y+d*g-s*b,e[2]=d*C+f*b+s*y-c*g,e[3]=f*C-s*g-c*y-d*b,e}function zu(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=Math.sqrt(r*r+s*s+c*c),g=Math.exp(d),y=f>0?g*Math.sin(f)/f:0;return e[0]=r*y,e[1]=s*y,e[2]=c*y,e[3]=g*Math.cos(f),e}function M_(e,t){var r=t[0],s=t[1],c=t[2],d=t[3],f=Math.sqrt(r*r+s*s+c*c),g=f>0?Math.atan2(f,d)/f:0;return e[0]=r*g,e[1]=s*g,e[2]=c*g,e[3]=.5*Math.log(r*r+s*s+c*c+d*d),e}function Xh(e,t,r,s){var c,d,f,g,y,b=t[0],C=t[1],P=t[2],E=t[3],I=r[0],A=r[1],l=r[2],u=r[3];return(d=b*I+C*A+P*l+E*u)<0&&(d=-d,I=-I,A=-A,l=-l,u=-u),1-d>x_.EPSILON?(c=Math.acos(d),f=Math.sin(c),g=Math.sin((1-s)*c)/f,y=Math.sin(s*c)/f):(g=1-s,y=s),e[0]=g*b+y*I,e[1]=g*C+y*A,e[2]=g*P+y*l,e[3]=g*E+y*u,e}function Ub(e,t){var r,s=t[0]+t[4]+t[8];if(s>0)r=Math.sqrt(s+1),e[3]=.5*r,e[0]=(t[5]-t[7])*(r=.5/r),e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var c=0;t[4]>t[0]&&(c=1),t[8]>t[3*c+c]&&(c=2);var d=(c+1)%3,f=(c+2)%3;r=Math.sqrt(t[3*c+c]-t[3*d+d]-t[3*f+f]+1),e[c]=.5*r,e[3]=(t[3*d+f]-t[3*f+d])*(r=.5/r),e[d]=(t[3*d+c]+t[3*c+d])*r,e[f]=(t[3*f+c]+t[3*c+f])*r}return e}jn.clone=Aa.clone,jn.fromValues=Aa.fromValues,jn.copy=Aa.copy,jn.set=Aa.set,jn.add=Aa.add,jn.mul=C_;var Vb=Aa.scale;jn.scale=Vb;var MP=Aa.dot;jn.dot=MP,jn.lerp=Aa.lerp;var jb=Aa.length;jn.length=jb,jn.len=jb;var MT=Aa.squaredLength;jn.squaredLength=MT,jn.sqrLen=MT;var a0=Aa.normalize;jn.normalize=a0,jn.exactEquals=Aa.exactEquals,jn.equals=Aa.equals;var ta,PT,OT,vp=(ta=Bc.create(),PT=Bc.fromValues(1,0,0),OT=Bc.fromValues(0,1,0),function(e,t,r){var s=Bc.dot(t,r);return s<-.999999?(Bc.cross(ta,PT,t),Bc.len(ta)<1e-6&&Bc.cross(ta,OT,t),Bc.normalize(ta,ta),Bb(e,ta,Math.PI),e):s>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(Bc.cross(ta,t,r),e[0]=ta[0],e[1]=ta[1],e[2]=ta[2],e[3]=1+s,a0(e,e))});jn.rotationTo=vp;var $b,P_,PP=($b=w_(),P_=w_(),function(e,t,r,s,c,d){return Xh($b,t,c,d),Xh(P_,r,s,d),Xh(e,$b,P_,2*d*(1-d)),e});jn.sqlerp=PP;var sl,Tw=(sl=Fb.create(),function(e,t,r,s){return sl[0]=r[0],sl[3]=r[1],sl[6]=r[2],sl[1]=s[0],sl[4]=s[1],sl[7]=s[2],sl[2]=-t[0],sl[5]=-t[1],sl[8]=-t[2],a0(e,Ub(e,sl))});jn.setAxes=Tw;var Dn={};function Gb(e){return(Gb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(Dn,"__esModule",{value:!0}),Dn.create=function(){var e=new ms.ARRAY_TYPE(8);return ms.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e},Dn.clone=function(e){var t=new ms.ARRAY_TYPE(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t},Dn.fromValues=function(e,t,r,s,c,d,f,g){var y=new ms.ARRAY_TYPE(8);return y[0]=e,y[1]=t,y[2]=r,y[3]=s,y[4]=c,y[5]=d,y[6]=f,y[7]=g,y},Dn.fromRotationTranslationValues=function(e,t,r,s,c,d,f){var g=new ms.ARRAY_TYPE(8);g[0]=e,g[1]=t,g[2]=r,g[3]=s;var y=.5*c,b=.5*d,C=.5*f;return g[4]=y*s+b*r-C*t,g[5]=b*s+C*e-y*r,g[6]=C*s+y*t-b*e,g[7]=-y*e-b*t-C*r,g},Dn.fromRotationTranslation=Zb,Dn.fromTranslation=function(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e},Dn.fromRotation=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},Dn.fromMat4=function(e,t){var r=Uc.create();bp.getRotation(r,t);var s=new ms.ARRAY_TYPE(3);return bp.getTranslation(s,t),Zb(e,r,s),e},Dn.copy=Sg,Dn.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e},Dn.set=function(e,t,r,s,c,d,f,g,y){return e[0]=t,e[1]=r,e[2]=s,e[3]=c,e[4]=d,e[5]=f,e[6]=g,e[7]=y,e},Dn.getDual=function(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e},Dn.setDual=function(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e},Dn.getTranslation=function(e,t){var r=t[4],s=t[5],c=t[6],d=t[7],f=-t[0],g=-t[1],y=-t[2],b=t[3];return e[0]=2*(r*b+d*f+s*y-c*g),e[1]=2*(s*b+d*g+c*f-r*y),e[2]=2*(c*b+d*y+r*g-s*f),e},Dn.translate=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=.5*r[0],y=.5*r[1],b=.5*r[2],C=t[4],P=t[5],E=t[6],I=t[7];return e[0]=s,e[1]=c,e[2]=d,e[3]=f,e[4]=f*g+c*b-d*y+C,e[5]=f*y+d*g-s*b+P,e[6]=f*b+s*y-c*g+E,e[7]=-s*g-c*y-d*b+I,e},Dn.rotateX=function(e,t,r){var s=-t[0],c=-t[1],d=-t[2],f=t[3],g=t[4],y=t[5],b=t[6],C=t[7],P=g*f+C*s+y*d-b*c,E=y*f+C*c+b*s-g*d,I=b*f+C*d+g*c-y*s,A=C*f-g*s-y*c-b*d;return Uc.rotateX(e,t,r),e[4]=P*(f=e[3])+A*(s=e[0])+E*(d=e[2])-I*(c=e[1]),e[5]=E*f+A*c+I*s-P*d,e[6]=I*f+A*d+P*c-E*s,e[7]=A*f-P*s-E*c-I*d,e},Dn.rotateY=function(e,t,r){var s=-t[0],c=-t[1],d=-t[2],f=t[3],g=t[4],y=t[5],b=t[6],C=t[7],P=g*f+C*s+y*d-b*c,E=y*f+C*c+b*s-g*d,I=b*f+C*d+g*c-y*s,A=C*f-g*s-y*c-b*d;return Uc.rotateY(e,t,r),e[4]=P*(f=e[3])+A*(s=e[0])+E*(d=e[2])-I*(c=e[1]),e[5]=E*f+A*c+I*s-P*d,e[6]=I*f+A*d+P*c-E*s,e[7]=A*f-P*s-E*c-I*d,e},Dn.rotateZ=function(e,t,r){var s=-t[0],c=-t[1],d=-t[2],f=t[3],g=t[4],y=t[5],b=t[6],C=t[7],P=g*f+C*s+y*d-b*c,E=y*f+C*c+b*s-g*d,I=b*f+C*d+g*c-y*s,A=C*f-g*s-y*c-b*d;return Uc.rotateZ(e,t,r),e[4]=P*(f=e[3])+A*(s=e[0])+E*(d=e[2])-I*(c=e[1]),e[5]=E*f+A*c+I*s-P*d,e[6]=I*f+A*d+P*c-E*s,e[7]=A*f-P*s-E*c-I*d,e},Dn.rotateByQuatAppend=function(e,t,r){var s=r[0],c=r[1],d=r[2],f=r[3],g=t[0],y=t[1],b=t[2],C=t[3];return e[0]=g*f+C*s+y*d-b*c,e[1]=y*f+C*c+b*s-g*d,e[2]=b*f+C*d+g*c-y*s,e[3]=C*f-g*s-y*c-b*d,e[4]=(g=t[4])*f+(C=t[7])*s+(y=t[5])*d-(b=t[6])*c,e[5]=y*f+C*c+b*s-g*d,e[6]=b*f+C*d+g*c-y*s,e[7]=C*f-g*s-y*c-b*d,e},Dn.rotateByQuatPrepend=function(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=r[0],y=r[1],b=r[2],C=r[3];return e[0]=s*C+f*g+c*b-d*y,e[1]=c*C+f*y+d*g-s*b,e[2]=d*C+f*b+s*y-c*g,e[3]=f*C-s*g-c*y-d*b,e[4]=s*(C=r[7])+f*(g=r[4])+c*(b=r[6])-d*(y=r[5]),e[5]=c*C+f*y+d*g-s*b,e[6]=d*C+f*b+s*y-c*g,e[7]=f*C-s*g-c*y-d*b,e},Dn.rotateAroundAxis=function(e,t,r,s){if(Math.abs(s)<ms.EPSILON)return Sg(e,t);var c=Math.hypot(r[0],r[1],r[2]);s*=.5;var d=Math.sin(s),f=d*r[0]/c,g=d*r[1]/c,y=d*r[2]/c,b=Math.cos(s),C=t[0],P=t[1],E=t[2],I=t[3];e[0]=C*b+I*f+P*y-E*g,e[1]=P*b+I*g+E*f-C*y,e[2]=E*b+I*y+C*g-P*f,e[3]=I*b-C*f-P*g-E*y;var A=t[4],l=t[5],u=t[6],p=t[7];return e[4]=A*b+p*f+l*y-u*g,e[5]=l*b+p*g+u*f-A*y,e[6]=u*b+p*y+A*g-l*f,e[7]=p*b-A*f-l*g-u*y,e},Dn.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e},Dn.multiply=Wb,Dn.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e},Dn.lerp=function(e,t,r,s){var c=1-s;return Kb(t,r)<0&&(s=-s),e[0]=t[0]*c+r[0]*s,e[1]=t[1]*c+r[1]*s,e[2]=t[2]*c+r[2]*s,e[3]=t[3]*c+r[3]*s,e[4]=t[4]*c+r[4]*s,e[5]=t[5]*c+r[5]*s,e[6]=t[6]*c+r[6]*s,e[7]=t[7]*c+r[7]*s,e},Dn.invert=function(e,t){var r=Ag(t);return e[0]=-t[0]/r,e[1]=-t[1]/r,e[2]=-t[2]/r,e[3]=t[3]/r,e[4]=-t[4]/r,e[5]=-t[5]/r,e[6]=-t[6]/r,e[7]=t[7]/r,e},Dn.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e},Dn.normalize=function(e,t){var r=Ag(t);if(r>0){r=Math.sqrt(r);var s=t[0]/r,c=t[1]/r,d=t[2]/r,f=t[3]/r,g=t[4],y=t[5],b=t[6],C=t[7],P=s*g+c*y+d*b+f*C;e[0]=s,e[1]=c,e[2]=d,e[3]=f,e[4]=(g-s*P)/r,e[5]=(y-c*P)/r,e[6]=(b-d*P)/r,e[7]=(C-f*P)/r}return e},Dn.str=function(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"},Dn.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]},Dn.equals=function(e,t){var r=e[0],s=e[1],c=e[2],d=e[3],f=e[4],g=e[5],y=e[6],b=e[7],C=t[0],P=t[1],E=t[2],I=t[3],A=t[4],l=t[5],u=t[6],p=t[7];return Math.abs(r-C)<=ms.EPSILON*Math.max(1,Math.abs(r),Math.abs(C))&&Math.abs(s-P)<=ms.EPSILON*Math.max(1,Math.abs(s),Math.abs(P))&&Math.abs(c-E)<=ms.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(d-I)<=ms.EPSILON*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(f-A)<=ms.EPSILON*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(g-l)<=ms.EPSILON*Math.max(1,Math.abs(g),Math.abs(l))&&Math.abs(y-u)<=ms.EPSILON*Math.max(1,Math.abs(y),Math.abs(u))&&Math.abs(b-p)<=ms.EPSILON*Math.max(1,Math.abs(b),Math.abs(p))},Dn.sqrLen=Dn.squaredLength=Dn.len=Dn.length=Dn.dot=Dn.mul=Dn.setReal=Dn.getReal=void 0;var ms=qb(co),Uc=qb(jn),bp=qb(Bn);function Hb(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(Hb=function(s){return s?r:t})(e)}function qb(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==Gb(e)&&"function"!=typeof e)return{default:e};var r=Hb(t);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}function Zb(e,t,r){var s=.5*r[0],c=.5*r[1],d=.5*r[2],f=t[0],g=t[1],y=t[2],b=t[3];return e[0]=f,e[1]=g,e[2]=y,e[3]=b,e[4]=s*b+c*y-d*g,e[5]=c*b+d*f-s*y,e[6]=d*b+s*g-c*f,e[7]=-s*f-c*g-d*y,e}function Sg(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function Wb(e,t,r){var s=t[0],c=t[1],d=t[2],f=t[3],g=r[4],y=r[5],b=r[6],C=r[7],P=t[4],E=t[5],I=t[6],A=t[7],l=r[0],u=r[1],p=r[2],m=r[3];return e[0]=s*m+f*l+c*p-d*u,e[1]=c*m+f*u+d*l-s*p,e[2]=d*m+f*p+s*u-c*l,e[3]=f*m-s*l-c*u-d*p,e[4]=s*C+f*g+c*b-d*y+P*m+A*l+E*p-I*u,e[5]=c*C+f*y+d*g-s*b+E*m+A*u+I*l-P*p,e[6]=d*C+f*b+s*y-c*g+I*m+A*p+P*u-E*l,e[7]=f*C-s*g-c*y-d*b+A*m-P*l-E*u-I*p,e}Dn.getReal=Uc.copy,Dn.setReal=Uc.copy,Dn.mul=Wb;var Kb=Uc.dot;Dn.dot=Kb;var Yb=Uc.length;Dn.length=Yb,Dn.len=Yb;var Ag=Uc.squaredLength;Dn.squaredLength=Ag,Dn.sqrLen=Ag;var Zn={};function Iw(e){return(Iw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.create=Qh,Zn.clone=function(e){var t=new O_.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},Zn.fromValues=function(e,t){var r=new O_.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r},Zn.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},Zn.set=function(e,t,r){return e[0]=t,e[1]=r,e},Zn.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},Zn.subtract=l0,Zn.multiply=Xb,Zn.divide=c0,Zn.ceil=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},Zn.floor=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},Zn.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},Zn.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},Zn.round=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},Zn.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},Zn.scaleAndAdd=function(e,t,r,s){return e[0]=t[0]+r[0]*s,e[1]=t[1]+r[1]*s,e},Zn.distance=u0,Zn.squaredDistance=OP,Zn.length=Dg,Zn.squaredLength=Qb,Zn.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},Zn.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},Zn.normalize=function(e,t){var r=t[0],s=t[1],c=r*r+s*s;return c>0&&(c=1/Math.sqrt(c)),e[0]=t[0]*c,e[1]=t[1]*c,e},Zn.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},Zn.cross=function(e,t,r){var s=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=s,e},Zn.lerp=function(e,t,r,s){var c=t[0],d=t[1];return e[0]=c+s*(r[0]-c),e[1]=d+s*(r[1]-d),e},Zn.random=function(e,t){t=t||1;var r=2*O_.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},Zn.transformMat2=function(e,t,r){var s=t[0],c=t[1];return e[0]=r[0]*s+r[2]*c,e[1]=r[1]*s+r[3]*c,e},Zn.transformMat2d=function(e,t,r){var s=t[0],c=t[1];return e[0]=r[0]*s+r[2]*c+r[4],e[1]=r[1]*s+r[3]*c+r[5],e},Zn.transformMat3=function(e,t,r){var s=t[0],c=t[1];return e[0]=r[0]*s+r[3]*c+r[6],e[1]=r[1]*s+r[4]*c+r[7],e},Zn.transformMat4=function(e,t,r){var s=t[0],c=t[1];return e[0]=r[0]*s+r[4]*c+r[12],e[1]=r[1]*s+r[5]*c+r[13],e},Zn.rotate=function(e,t,r,s){var c=t[0]-r[0],d=t[1]-r[1],f=Math.sin(s),g=Math.cos(s);return e[0]=c*g-d*f+r[0],e[1]=c*f+d*g+r[1],e},Zn.angle=function(e,t){var r=e[0],s=e[1],c=t[0],d=t[1],f=Math.sqrt(r*r+s*s)*Math.sqrt(c*c+d*d);return Math.acos(Math.min(Math.max(f&&(r*c+s*d)/f,-1),1))},Zn.zero=function(e){return e[0]=0,e[1]=0,e},Zn.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},Zn.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Zn.equals=function(e,t){var r=e[0],s=e[1],c=t[0],d=t[1];return Math.abs(r-c)<=O_.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(s-d)<=O_.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))},Zn.forEach=Zn.sqrLen=Zn.sqrDist=Zn.dist=Zn.div=Zn.mul=Zn.sub=Zn.len=void 0;var O_=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==Iw(e)&&"function"!=typeof e)return{default:e};var r=xp(void 0);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}(co);function xp(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(xp=function(s){return s?r:t})(e)}function Qh(){var e=new O_.ARRAY_TYPE(2);return O_.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e}function l0(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function Xb(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function c0(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function u0(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1])}function OP(e,t){var r=t[0]-e[0],s=t[1]-e[1];return r*r+s*s}function Dg(e){return Math.hypot(e[0],e[1])}function Qb(e){var t=e[0],r=e[1];return t*t+r*r}Zn.len=Dg,Zn.sub=l0,Zn.mul=Xb,Zn.div=c0,Zn.dist=u0,Zn.sqrDist=OP,Zn.sqrLen=Qb;var kg=function(){var e=Qh();return function(t,r,s,c,d,f){var g,y;for(r||(r=2),s||(s=0),y=c?Math.min(c*r+s,t.length):t.length,g=s;g<y;g+=r)e[0]=t[g],e[1]=t[g+1],d(e,e,f),t[g]=e[0],t[g+1]=e[1];return t}}();function E_(e){return(E_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}Zn.forEach=kg,Object.defineProperty(zi,"__esModule",{value:!0});var kr=zi.vec4=dt=zi.vec3=zi.vec2=zi.quat2=Bi=zi.quat=bt=zi.mat4=al=zi.mat3=zi.mat2d=Rg=zi.mat2=zi.glMatrix=void 0,Sw=Vc(co);zi.glMatrix=Sw;var Aw=Vc(ko),Rg=zi.mat2=Aw,Dw=Vc(po);zi.mat2d=Dw;var wp=Vc(uo),al=zi.mat3=wp,Jh=Vc(Bn),bt=zi.mat4=Jh,Jb=Vc(jn),Bi=zi.quat=Jb,d0=Vc(Dn);zi.quat2=d0;var So=Vc(Zn);zi.vec2=So;var tf=Vc(qn),dt=zi.vec3=tf,h0=Vc(gr);function EP(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(EP=function(s){return s?r:t})(e)}function Vc(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==E_(e)&&"function"!=typeof e)return{default:e};var r=EP(t);if(r&&r.has(e))return r.get(e);var s={},c=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in e)if("default"!==d&&Object.prototype.hasOwnProperty.call(e,d)){var f=c?Object.getOwnPropertyDescriptor(e,d):null;f&&(f.get||f.set)?Object.defineProperty(s,d,f):s[d]=e[d]}return s.default=e,r&&r.set(e,s),s}kr=zi.vec4=h0;const T_=Dr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:t1}=T_,TP=Dr([{name:"a_pos_3",components:3,type:"Int16"}]);var Cp=Dr([{name:"a_pos",type:"Int16",components:2}]),Mp={};!function(r){function s(d,f,g){var y=c(256*d,256*(f=Math.pow(2,g)-f-1),g),b=c(256*(d+1),256*(f+1),g);return y[0]+","+y[1]+","+b[0]+","+b[1]}function c(d,f,g){var y=2*Math.PI*6378137/256/Math.pow(2,g);return[d*y-2*Math.PI*6378137/2,f*y-2*Math.PI*6378137/2]}r.getURL=function(d,f,g,y,b,C){return C=C||{},d+"?"+["bbox="+s(g,y,b),"format="+(C.format||"image/png"),"service="+(C.service||"WMS"),"version="+(C.version||"1.1.1"),"request="+(C.request||"GetMap"),"srs="+(C.srs||"EPSG:3857"),"width="+(C.width||256),"height="+(C.height||256),"layers="+f].join("&")},r.getTileBBox=s,r.getMercCoords=c,Object.defineProperty(r,"__esModule",{value:!0})}(Mp);var ef=Mp;class ic{constructor(t,r,s){this.z=t,this.x=r,this.y=s,this.key=nf(0,t,t,r,s)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r){const s=ef.getTileBBox(this.x,this.y,this.z),c=function(d,f,g){let y,b="";for(let C=d;C>0;C--)y=1<<C-1,b+=(f&y?1:0)+(g&y?2:0);return b}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===r?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",c).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class f0{constructor(t,r){this.wrap=t,this.canonical=r,this.key=nf(t,r.z,r.z,r.x,r.y)}}class Ir{constructor(t,r,s,c,d){this.overscaledZ=t,this.wrap=r,this.canonical=new ic(s,+c,+d),this.key=0===r&&t===s?this.canonical.key:nf(r,t,s,c,d)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const r=this.canonical.z-t;return t>this.canonical.z?new Ir(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ir(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r=!0){if(this.overscaledZ===t&&r)return this.key;if(t>this.canonical.z)return nf(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-t;return nf(this.wrap*+r,t,t,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const r=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new Ir(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,s=2*this.canonical.x,c=2*this.canonical.y;return[new Ir(r,this.wrap,r,s,c),new Ir(r,this.wrap,r,s+1,c),new Ir(r,this.wrap,r,s,c+1),new Ir(r,this.wrap,r,s+1,c+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ir(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ir(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new f0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function nf(e,t,r,s,c){const d=1<<Math.min(r,22);let f=d*(c%d)+s%d;return e&&r<22&&(f+=d*d*((e<0?-2*e-1:2*e)%(1<<2*(22-r)))),16*(32*f+r)+(t-r)}const IP=[e=>{let t=e.canonical.x-1,r=e.wrap;return t<0&&(t=(1<<e.canonical.z)-1,r--),new Ir(e.overscaledZ,r,e.canonical.z,t,e.canonical.y)},e=>{let t=e.canonical.x+1,r=e.wrap;return t===1<<e.canonical.z&&(t=0,r++),new Ir(e.overscaledZ,r,e.canonical.z,t,e.canonical.y)},e=>new Ir(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,(0===e.canonical.y?1<<e.canonical.z:e.canonical.y)-1),e=>new Ir(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y===(1<<e.canonical.z)-1?0:e.canonical.y+1)];De(ic,"CanonicalTileID"),De(Ir,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});class e1{constructor(t,r){this.pos=t,this.dir=r}intersectsPlane(t,r,s){const c=dt.dot(r,this.dir);if(Math.abs(c)<1e-6)return!1;const d=((t[0]-this.pos[0])*r[0]+(t[1]-this.pos[1])*r[1]+(t[2]-this.pos[2])*r[2])/c;return s[0]=this.pos[0]+this.dir[0]*d,s[1]=this.pos[1]+this.dir[1]*d,s[2]=this.pos[2]+this.dir[2]*d,!0}closestPointOnSphere(t,r,s){if(dt.equals(this.pos,t)||0===r)return s[0]=s[1]=s[2]=0,!1;const[c,d,f]=this.dir,g=this.pos[0]-t[0],y=this.pos[1]-t[1],b=this.pos[2]-t[2],C=c*c+d*d+f*f,P=2*(g*c+y*d+b*f),E=P*P-4*C*(g*g+y*y+b*b-r*r);if(E<0){const I=Math.max(-P/2,0),A=g+c*I,l=y+d*I,u=b+f*I,p=Math.hypot(A,l,u);return s[0]=A*r/p,s[1]=l*r/p,s[2]=u*r/p,!1}{const I=(-P-Math.sqrt(E))/(2*C);if(I<0){const A=Math.hypot(g,y,b);return s[0]=g*r/A,s[1]=y*r/A,s[2]=b*r/A,!1}return s[0]=g+c*I,s[1]=y+d*I,s[2]=b+f*I,!0}}}class n1{constructor(t,r,s,c,d){this.TL=t,this.TR=r,this.BR=s,this.BL=c,this.horizon=d}static fromInvProjectionMatrix(t,r,s){const c=[-1,1,1],d=[1,1,1],f=[1,-1,1],g=[-1,-1,1],y=dt.transformMat4(c,c,t),b=dt.transformMat4(d,d,t),C=dt.transformMat4(f,f,t),P=dt.transformMat4(g,g,t);return new n1(y,b,C,P,r/s)}}function r1(e,t,r){let s=1/0,c=-1/0;const d=[];for(const f of e){dt.sub(d,f,t);const g=dt.dot(d,r);s=Math.min(s,g),c=Math.max(c,g)}return[s,c]}function SP(e,t){let r=!0;for(let s=0;s<e.planes.length;s++){const c=e.planes[s];let d=0;for(let f=0;f<t.length;f++)d+=dt.dot(c,t[f])+c[3]>=0;if(0===d)return 0;d!==t.length&&(r=!1)}return r?2:1}function I_(e,t){for(const r of e.projections){const s=r1(t,e.points[0],r.axis);if(r.projection[1]<s[0]||r.projection[0]>s[1])return 0}return 1}function o1(e,t){let r=0;const s=[0,0,0,0];for(let c=0;c<e.length;c++)s[0]=e[c][0],s[1]=e[c][1],s[2]=e[c][2],s[3]=1,kr.dot(s,t)>=0&&r++;return r}class sc{constructor(t,r){this.points=t||new Array(8).fill([0,0,0]),this.planes=r||new Array(6).fill([0,0,0,0]),this.bounds=yo.fromPoints(this.points),this.projections=[],this.frustumEdges=[dt.sub([],this.points[2],this.points[3]),dt.sub([],this.points[0],this.points[3]),dt.sub([],this.points[4],this.points[0]),dt.sub([],this.points[5],this.points[1]),dt.sub([],this.points[6],this.points[2]),dt.sub([],this.points[7],this.points[3])];for(const s of this.frustumEdges){const c=[0,-s[2],s[1]],d=[s[2],0,-s[0]];this.projections.push({axis:c,projection:r1(this.points,this.points[0],c)}),this.projections.push({axis:d,projection:r1(this.points,this.points[0],d)})}}static fromInvProjectionMatrix(t,r,s,c){const d=Math.pow(2,s),f=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const C=kr.transformMat4([],b,t),P=1/C[3]/r*d;return kr.mul(C,C,[P,P,c?1/C[3]:P,P])}),g=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const C=dt.sub([],f[b[0]],f[b[1]]),P=dt.sub([],f[b[2]],f[b[1]]),E=dt.normalize([],dt.cross([],C,P)),I=-dt.dot(E,f[b[1]]);return E.concat(I)}),y=[];for(let b=0;b<f.length;b++)y.push([f[b][0],f[b][1],f[b][2]]);return new sc(y,g)}intersectsPrecise(t,r,s){for(let c=0;c<r.length;c++)if(!o1(t,r[c]))return 0;for(let c=0;c<this.planes.length;c++)if(!o1(t,this.planes[c]))return 0;for(const c of s)for(const d of this.frustumEdges){const f=dt.cross([],c,d),g=dt.length(f);if(0===g)continue;dt.scale(f,f,1/g);const y=r1(this.points,this.points[0],f),b=r1(t,this.points[0],f);if(y[0]>b[1]||b[0]>y[1])return 0}return 1}}class yo{static fromPoints(t){const r=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];for(const c of t)dt.min(r,r,c),dt.max(s,s,c);return new yo(r,s)}static fromTileIdAndHeight(t,r,s){const c=1<<t.canonical.z,d=t.canonical.x,f=t.canonical.y;return new yo([d/c,f/c,r],[(d+1)/c,(f+1)/c,s])}static applyTransform(t,r){const s=t.getCorners();for(let c=0;c<s.length;++c)dt.transformMat4(s[c],s[c],r);return yo.fromPoints(s)}static projectAabbCorners(t,r){const s=t.getCorners();for(let c=0;c<s.length;++c)dt.transformMat4(s[c],s[c],r);return s}constructor(t,r){this.min=t,this.max=r,this.center=dt.scale([],dt.add([],this.min,this.max),.5)}quadrant(t){const r=[t%2==0,t<2],s=dt.clone(this.min),c=dt.clone(this.max);for(let d=0;d<r.length;d++)s[d]=r[d]?this.min[d]:this.center[d],c[d]=r[d]?this.center[d]:this.max[d];return c[2]=this.max[2],new yo(s,c)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,r=this.max;return[[t[0],t[1],t[2]],[r[0],t[1],t[2]],[r[0],r[1],t[2]],[t[0],r[1],t[2]],[t[0],t[1],r[2]],[r[0],t[1],r[2]],[r[0],r[1],r[2]],[t[0],r[1],r[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?SP(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?SP(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,r){return r||this.intersects(t)?I_(t,this.getCorners()):0}intersectsPreciseFlat(t,r){return r||this.intersectsFlat(t)?I_(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let r=0;r<3;++r)if(this.min[r]>t.max[r]||t.min[r]>this.max[r])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],t.min[r]),this.max[r]=Math.max(this.max[r],t.max[r])}encapsulatePoint(t){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],t[r]),this.max[r]=Math.max(this.max[r],t[r])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}De(yo,"Aabb");const Bu=5,Bd=6,ea=Dt/Math.PI/2,p0=16383,Uu=[64,32,16],na=-ea,ma=ea,S_=[new yo([na,na,na],[ma,ma,ma]),new yo([na,na,na],[0,0,ma]),new yo([0,na,na],[ma,0,ma]),new yo([na,0,na],[0,ma,ma]),new yo([0,0,na],[ma,ma,ma])];function i1(e){return e*ea/Ep}function Pp(e,t,r,s=!0){const c=dt.scale([],e._camera.position,e.worldSize),d=[t,r,1,1];kr.transformMat4(d,d,e.pixelMatrixInverse),kr.scale(d,d,1/d[3]);const f=dt.sub([],d,c),g=dt.normalize([],f),y=e.globeMatrix,b=[y[12],y[13],y[14]],C=dt.sub([],b,c),P=dt.length(C),E=dt.normalize([],C),I=e.worldSize/(2*Math.PI),A=dt.dot(E,g),l=Math.asin(I/P);if(l<Math.acos(A)){if(!s)return null;const q=[],Z=[];dt.scale(q,g,P/A),dt.normalize(Z,dt.sub(Z,q,C)),dt.normalize(g,dt.add(g,C,dt.scale(g,Z,Math.tan(l)*P)))}const u=[];new e1(c,g).closestPointOnSphere(b,I,u);const p=dt.normalize([],ur(y,0)),m=dt.normalize([],ur(y,1)),v=dt.normalize([],ur(y,2)),M=dt.dot(p,u),O=dt.dot(m,u),T=dt.dot(v,u),k=ge(Math.asin(-O/I));let N=ge(Math.atan2(M,T));N=e.center.lng+function(q,Z){const X=(Z-q+180)%360-180;return X<-180?X+360:X}(e.center.lng,N);const F=yi(N),$=Ne(Oo(k),0,1);return new Xn(F,$)}class sf{constructor(t,r,s){this.a=dt.sub([],t,s),this.b=dt.sub([],r,s),this.center=s;const c=dt.normalize([],this.a),d=dt.normalize([],this.b);this.angle=Math.acos(dt.dot(c,d))}}function kw(e,t){if(0===e.angle)return null;let r;return r=0===e.a[t]?1/e.angle*.5*Math.PI:1/e.angle*Math.atan(e.b[t]/e.a[t]/Math.sin(e.angle)-1/Math.tan(e.angle)),r<0||r>1?null:function(s,c,d,f){const g=Math.sin(d);return s*(Math.sin((1-f)*d)/g)+c*(Math.sin(f*d)/g)}(e.a[t],e.b[t],e.angle,Ne(r,0,1))+e.center[t]}function Po(e){if(e.z<=1)return S_[e.z+2*e.y+e.x];const t=l1(g0(e));return yo.fromPoints(t)}function Ud(e,t,r){return dt.scale(e,e,1-r),dt.scaleAndAdd(e,e,t,r)}function AP(e,t){const r=Pi(t.zoom);if(0===r)return Po(e);const s=g0(e),c=l1(s),d=yi(s.getWest())*t.worldSize,f=yi(s.getEast())*t.worldSize,g=Oo(s.getNorth())*t.worldSize,y=Oo(s.getSouth())*t.worldSize,b=[d,g,0],C=[f,g,0],P=[d,y,0],E=[f,y,0],I=bt.invert([],t.globeMatrix);return dt.transformMat4(b,b,I),dt.transformMat4(C,C,I),dt.transformMat4(P,P,I),dt.transformMat4(E,E,I),c[0]=Ud(c[0],P,r),c[1]=Ud(c[1],E,r),c[2]=Ud(c[2],C,r),c[3]=Ud(c[3],b,r),yo.fromPoints(c)}function s1(e,t,r){for(const s of e)dt.transformMat4(s,s,t),dt.scale(s,s,r)}function a1(e,t,r,s){const c=t/e.worldSize,d=e.globeMatrix;if(r.z<=1){const F=Po(r).getCorners();return s1(F,d,c),yo.fromPoints(F)}const f=g0(r,s),g=l1(f);s1(g,d,c);const y=Number.MAX_VALUE,b=[-y,-y,-y],C=[y,y,y];if(f.contains(e.center)){for(const q of g)dt.min(C,C,q),dt.max(b,b,q);b[2]=0;const F=e.point,$=[F.x*c,F.y*c,0];return dt.min(C,C,$),dt.max(b,b,$),new yo(C,b)}const P=[d[12]*c,d[13]*c,d[14]*c],E=f.getCenter(),I=Ne(e.center.lat,-vo,vo),A=Ne(E.lat,-vo,vo),l=yi(e.center.lng),u=Oo(I);let p=l-yi(E.lng);const m=u-Oo(A);p>.5?p-=1:p<-.5&&(p+=1);let v=0;if(Math.abs(p)>Math.abs(m))v=p>=0?1:3;else{v=m>=0?0:2;const F=[d[4]*c,d[5]*c,d[6]*c],$=-Math.sin(Ct(m>=0?f.getSouth():f.getNorth()))*ea;dt.scaleAndAdd(P,P,F,$)}const M=g[v],O=g[(v+1)%4],T=new sf(M,O,P),k=[kw(T,0)||M[0],kw(T,1)||M[1],kw(T,2)||M[2]],N=Pi(e.zoom);if(N>0){const F=function({x:q,y:Z,z:X},K,J,st,it){const rt=1/(1<<X);let ct=q*rt,yt=ct+rt,Et=Z*rt,Tt=Et+rt,zt=0;const Nt=(ct+yt)/2-st;return Nt>.5?zt=-1:Nt<-.5&&(zt=1),ct=((ct+zt)*K-(st*=K))*J+st,yt=((yt+zt)*K-st)*J+st,Et=(Et*K-(it*=K))*J+it,Tt=(Tt*K-it)*J+it,[[ct,Tt,0],[yt,Tt,0],[yt,Et,0],[ct,Et,0]]}(r,t,e._pixelsPerMercatorPixel,l,u);for(let q=0;q<g.length;q++)Ud(g[q],F[q],N);const $=dt.add([],F[v],F[(v+1)%4]);dt.scale($,$,.5),Ud(k,$,N)}for(const F of g)dt.min(C,C,F),dt.max(b,b,F);return C[2]=Math.min(M[2],O[2]),dt.min(C,C,k),dt.max(b,b,k),new yo(C,b)}function g0({x:e,y:t,z:r},s=!1){const c=1/(1<<r),d=new kn(ka(e*c),t===(1<<r)-1&&s?-90:ti((t+1)*c)),f=new kn(ka((e+1)*c),0===t&&s?90:ti(t*c));return new Qo(d,f)}function l1(e){const t=Ct(e.getNorth()),r=Ct(e.getSouth()),s=Math.cos(t),c=Math.cos(r),d=Math.sin(t),f=Math.sin(r),g=e.getWest(),y=e.getEast();return[A_(c,f,g),A_(c,f,y),A_(s,d,y),A_(s,d,g)]}function A_(e,t,r,s=ea){return r=Ct(r),[e*Math.sin(r)*s,-t*s,e*Math.cos(r)*s]}function ra(e,t,r){return A_(Math.cos(Ct(e)),Math.sin(Ct(e)),t,r)}function af(e,t,r,s){const c=1<<r.z,d=(e/Dt+r.x)/c;return ra(ti((t/Dt+r.y)/c),ka(d),s)}function ll({min:e,max:t}){return p0/Math.max(t[0]-e[0],t[1]-e[1],t[2]-e[2])}const Rw=new Float64Array(16);function lf(e){const t=ll(e),r=bt.fromScaling(Rw,[t,t,t]);return bt.translate(r,r,dt.negate([],e.min))}function D_(e){const t=bt.fromTranslation(Rw,e.min),r=1/ll(e);return bt.scale(t,t,[r,r,r])}function Op(e){const t=Dt/(2*Math.PI);return e/(2*Math.PI)/t}function k_(e,t){return Dt/(512*Math.pow(2,e))*ll(Po(t))}function c1(e,t,r,s,c){const d=Op(r),f=[e,t,-r/(2*Math.PI)],g=bt.identity(new Float64Array(16));return bt.translate(g,g,f),bt.scale(g,g,[d,d,d]),bt.rotateX(g,g,Ct(-c)),bt.rotateY(g,g,Ct(-s)),g}function u1(e){const t=e.pixelsPerMeter,r=t/oo(1,e.center.lat),s=bt.identity(new Float64Array(16));return bt.translate(s,s,[e.point.x,e.point.y,0]),bt.scale(s,s,[r,r,t]),Float32Array.from(s)}function Pi(e){return vs(Bu,Bd,e)}function DP(e,t,r){const s=bt.identity(new Float64Array(16)),c=(t/(1<<e)-.5)*Math.PI*2;return bt.rotateY(s,r.globeMatrix,c),Float32Array.from(s)}function m0(e,t,r){const s=Pi(r.zoom),c=e.style.map._antialias,d=t.options.extStandardDerivativesForceOff||e.terrain&&e.terrain.exaggeration()>0;return 0===s&&!c&&!d}function _0(e,t,r,s){const c=t.getNorth(),d=t.getSouth(),f=t.getWest(),g=t.getEast(),y=1<<e.z,b=g-f,C=c-d,P=b/64,E=-C/Uu[r],I=[0,P,0,E,0,0,c,f,0];if(e.z>0){const A=180/s;al.multiply(I,I,[A/b+1,0,0,0,A/C+1,0,-.5*A/P,.5*A/E,1])}return I[2]=y,I[5]=e.x,I[8]=e.y,I}function kP(e){const t=vo-5;e=Ne(e,-t,t)/t*90;const r=Math.pow(Math.abs(Math.sin(Ct(e))),3);return Math.round(r*(Uu.length-1))}function Vu(e){const t=[0,0,0],r=bt.identity(new Float64Array(16));return bt.multiply(r,e.pixelMatrix,e.globeMatrix),dt.transformMat4(t,t,r),new tt(t[0],t[1])}function Lg(e,t){const r=ra(t.lat,t.lng),s=function(d){const f=ra(d._center.lat,d._center.lng),g=dt.fromValues(0,1,0);let y=dt.cross([],g,f);const b=bt.fromRotation([],-d.angle,f);y=dt.transformMat4(y,y,b),bt.fromRotation(b,-d._pitch,y);const C=dt.normalize([],f);return dt.scale(C,C,i1(d.cameraToCenterDistance/d.pixelsPerMeter)),dt.transformMat4(C,C,b),dt.add([],f,C)}(e),c=dt.subtract([],s,r);return dt.angle(c,r)}function y0(e,t){return Lg(e,t)>Math.PI/2*1.01}const v0=Ct(85),Lw=Math.cos(v0),RP=Math.sin(v0);class d1{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,r){const s=new pa,c=new Mi,d=[],f=t+1+2,g=r[0]+1,y=r[0]+1+(1+r.length),b=(C,P,E)=>{let I=C===f-1?C-2:0===C?C:C-1;return I+=E?24575:0,[I,P]};for(let C=0;C<f;++C)s.emplaceBack(...b(C,0,!0));for(let C=0;C<g;++C)for(let P=0;P<f;++P)s.emplaceBack(...b(P,C,(0===P||P===f-1)&&!0));for(let C=0;C<r.length;++C){const P=r[C];for(let E=0;E<f;++E)s.emplaceBack(...b(E,P,!0))}for(let C=0;C<r.length;++C){const P=c.length,E=r[C]+1+2,I=new Mi;for(let u=0;u<E-1;u++){const p=u===E-2,m=p?f*(y-r.length+C-u):f;for(let v=0;v<f-1;v++){const M=u*f+v;0===u||p||0===v||v===f-2?(I.emplaceBack(M+1,M,M+m),I.emplaceBack(M+m,M+m+1,M+1)):(c.emplaceBack(M+1,M,M+m),c.emplaceBack(M+m,M+m+1,M+1))}}const A=lo.simpleSegment(0,P,s.length,c.length-P);for(let u=0;u<I.uint16.length;u+=3)c.emplaceBack(I.uint16[u],I.uint16[u+1],I.uint16[u+2]);const l=lo.simpleSegment(0,P,s.length,c.length-P);d.push({withoutSkirts:A,withSkirts:l})}return{vertices:s,indices:c,segments:d}}_createGrid(t){const r=this._fillGridMeshWithLods(64,Uu);this._gridSegments=r.segments,this._gridBuffer=t.createVertexBuffer(r.vertices,Cp.members),this._gridIndexBuffer=t.createIndexBuffer(r.indices,!0)}_createPoles(t){const r=new Mi;for(let g=0;g<=64;g++)r.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=t.createIndexBuffer(r,!0);const s=new pp,c=new pp,d=new pp,f=new pp;this._poleSegments=[];for(let g=0,y=0;g<Bu;g++){const b=360/(1<<g);s.emplaceBack(0,-ea,0,.5,0),c.emplaceBack(0,-ea,0,.5,1),d.emplaceBack(0,-ea,0,.5,.5),f.emplaceBack(0,-ea,0,.5,.5);for(let C=0;C<=64;C++){let P=C/64,E=0;const I=vn(0,b,P),[A,l,u]=A_(Lw,RP,I,ea);s.emplaceBack(A,l,u,P,E),c.emplaceBack(A,l,u,P,1-E);const p=Ct(I);P=.5+.5*Math.sin(p),E=.5+.5*Math.cos(p),d.emplaceBack(A,l,u,P,E),f.emplaceBack(A,l,u,P,1-E)}this._poleSegments.push(lo.simpleSegment(y,0,66,64)),y+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(s,t1,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(c,t1,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(d,t1,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(f,t1,!1)}getGridBuffers(t,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,r){return[r?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,r?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}}const Ep=6371008.8,b0=2*Math.PI*Ep;class Da{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Da(Wt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,s=this.lat*r,c=t.lat*r,d=Math.sin(s)*Math.sin(c)+Math.cos(s)*Math.cos(c)*Math.cos((t.lng-this.lng)*r);return Ep*Math.acos(Math.min(d,1))}toBounds(t=0){const r=360*t/40075017,s=r/Math.cos(Math.PI/180*this.lat);return new Qo(new Da(this.lng-s,this.lat-r),new Da(this.lng+s,this.lat+r))}toEcef(t){const r=i1(t);return ra(this.lat,this.lng,ea+r)}static convert(t){if(t instanceof Da)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new Da(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new Da(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var kn=Da;const h1=0,Nw=25.5;function x0(e){return b0*Math.cos(e*Math.PI/180)}function yi(e){return(180+e)/360}function Oo(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function oo(e,t){return e/x0(t)}function ka(e){return 360*e-180}function ti(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function LP(e,t){return e*x0(ti(t))}const vo=85.051129;function w0(e){return Math.cos(Ct(Ne(e,-vo,vo)))}function go(e,t){const r=Ne(t,h1,Nw),s=Math.pow(2,r);return w0(e)*b0/(512*s)}function ac(e){return 1/Math.cos(e*Math.PI/180)}function Tp(e,t=0){const r=Math.exp(Math.PI*(1-(e.y+t/Dt)/(1<<e.z)*2));return 80150034*r/(r*r+1)/Dt/(1<<e.z)}class Xn{constructor(t,r,s=0){this.x=+t,this.y=+r,this.z=+s}static fromLngLat(t,r=0){const s=kn.convert(t);return new Xn(yi(s.lng),Oo(s.lat),oo(r,s.lat))}toLngLat(){return new kn(ka(this.x),ti(this.y))}toAltitude(){return LP(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/b0*ac(ti(this.y))}}function R_(e,t,r,s,c,d,f,g,y){const b=(t+s)/2,C=(r+c)/2,P=new tt(b,C);g(P),function(E,I,A,l,u,p){const m=A-u,v=l-p;return Math.abs((l-I)*m-(A-E)*v)/Math.hypot(m,v)}(P.x,P.y,d.x,d.y,f.x,f.y)>=y?(R_(e,t,r,b,C,d,P,g,y),R_(e,b,C,s,c,P,f,g,y)):e.push(f)}function ju(e,t,r){let s=e[0],c=s.x,d=s.y;t(s);const f=[s];for(let g=1;g<e.length;g++){const y=e[g],{x:b,y:C}=y;t(y),R_(f,c,d,b,C,s,y,t,r),c=b,d=C,s=y}return f}function Vd(e,t,r,s){if(s(t,r)){const c=t.add(r)._mult(.5);Vd(e,t,c,s),Vd(e,c,r,s)}else e.push(r)}function Fw(e,t){let r=e[0];const s=[r];for(let c=1;c<e.length;c++){const d=e[c];Vd(s,r,d,t),r=d}return s}const zw=Math.pow(2,14)-1,jd=-zw-1;function Tl(e,t){const r=Math.round(e.x*t),s=Math.round(e.y*t);return e.x=Ne(r,jd,zw),e.y=Ne(s,jd,zw),(r<e.x||r>e.x+1||s<e.y||s>e.y+1)&&gt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),e}function Eo(e,t,r){const s=e.loadGeometry(),c=e.extent,d=Dt/c;if(t&&r&&r.projection.isReprojectedInTileSpace){const f=1<<t.z,{scale:g,x:y,y:b,projection:C}=r,P=E=>{const I=ka((t.x+E.x/c)/f),A=ti((t.y+E.y/c)/f),l=C.project(I,A);E.x=(l.x*g-y)*c,E.y=(l.y*g-b)*c};for(let E=0;E<s.length;E++)if(1!==e.type)s[E]=ju(s[E],P,1);else{const I=[];for(const A of s[E])A.x<0||A.x>=c||A.y<0||A.y>=c||(P(A),I.push(A));s[E]=I}}for(const f of s)for(const g of f)Tl(g,d);return s}function jc(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Eo(e):[]}}function Ng(e,t,r,s,c){e.emplaceBack(2*t+(s+1)/2,2*r+(c+1)/2)}function Fg(e,t,r){e.emplaceBack(t.x,t.y,t.z,16384*r[0],16384*r[1],16384*r[2])}class Wi{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new pa,this.indexArray=new Mi,this.segments=new lo,this.programConfigurations=new ga(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,s,c){const d=this.layers[0],f=[];let g=null;"circle"===d.type&&(g=d.layout.get("circle-sort-key"));for(const{feature:b,id:C,index:P,sourceLayerIndex:E}of t){const I=this.layers[0]._featureFilter.needGeometry,A=jc(b,I);if(!this.layers[0]._featureFilter.filter(new Lo(this.zoom),A,s))continue;const l=g?g.evaluate(A,{},s):void 0,u={id:C,properties:b.properties,type:b.type,sourceLayerIndex:E,index:P,geometry:I?A.geometry:Eo(b,s,c),patterns:{},sortKey:l};f.push(u)}g&&f.sort((b,C)=>b.sortKey-C.sortKey);let y=null;"globe"===c.projection.name&&(this.globeExtVertexArray=new Xy,y=c.projection);for(const b of f){const{geometry:C,index:P,sourceLayerIndex:E}=b,I=t[P].feature;this.addFeature(b,C,P,r.availableImages,s,y,r.brightness),r.featureIndex.insert(I,C,P,E,this.index)}}update(t,r,s,c,d){const f=0!==Object.keys(t).length;f&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,f?this.stateDependentLayers:this.layers,s,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,vw.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,AI.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,r,s,c,d,f,g){for(const y of r)for(const b of y){const C=b.x,P=b.y;if(C<0||C>=Dt||P<0||P>=Dt)continue;if(f){const A=f.projectTilePoint(C,P,d),l=f.upVector(d,C,P),u=this.globeExtVertexArray;Fg(u,A,l),Fg(u,A,l),Fg(u,A,l),Fg(u,A,l)}const E=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),I=E.vertexLength;Ng(this.layoutVertexArray,C,P,-1,-1),Ng(this.layoutVertexArray,C,P,1,-1),Ng(this.layoutVertexArray,C,P,1,1),Ng(this.layoutVertexArray,C,P,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+2,I+3),E.vertexLength+=4,E.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{},c,d,g)}}function Bw(e,t){for(let r=0;r<e.length;r++)if($c(t,e[r]))return!0;for(let r=0;r<t.length;r++)if($c(e,t[r]))return!0;return!!zg(e,t)}function Ip(e,t,r){return!!$c(e,t)||!!f1(t,e,r)}function NP(e,t){if(1===e.length)return Vw(t,e[0]);for(let r=0;r<t.length;r++){const s=t[r];for(let c=0;c<s.length;c++)if($c(e,s[c]))return!0}for(let r=0;r<e.length;r++)if(Vw(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(zg(e,t[r]))return!0;return!1}function ET(e,t,r){if(e.length>1){if(zg(e,t))return!0;for(let s=0;s<t.length;s++)if(f1(t[s],e,r))return!0}for(let s=0;s<e.length;s++)if(f1(e[s],t,r))return!0;return!1}function zg(e,t){if(0===e.length||0===t.length)return!1;for(let r=0;r<e.length-1;r++){const s=e[r],c=e[r+1];for(let d=0;d<t.length-1;d++)if(FP(s,c,t[d],t[d+1]))return!0}return!1}function FP(e,t,r,s){return Qt(e,r,s)!==Qt(t,r,s)&&Qt(e,t,r)!==Qt(e,t,s)}function f1(e,t,r){const s=r*r;if(1===t.length)return e.distSqr(t[0])<s;for(let c=1;c<t.length;c++)if(Uw(e,t[c-1],t[c])<s)return!0;return!1}function Uw(e,t,r){const s=t.distSqr(r);if(0===s)return e.distSqr(t);const c=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/s;return e.distSqr(c<0?t:c>1?r:r.sub(t)._mult(c)._add(t))}function Vw(e,t){let r,s,c,d=!1;for(let f=0;f<e.length;f++){r=e[f];for(let g=0,y=r.length-1;g<r.length;y=g++)s=r[g],c=r[y],s.y>t.y!=c.y>t.y&&t.x<(c.x-s.x)*(t.y-s.y)/(c.y-s.y)+s.x&&(d=!d)}return d}function $c(e,t){let r=!1;for(let s=0,c=e.length-1;s<e.length;c=s++){const d=e[s],f=e[c];d.y>t.y!=f.y>t.y&&t.x<(f.x-d.x)*(t.y-d.y)/(f.y-d.y)+d.x&&(r=!r)}return r}function zP(e,t,r,s,c){for(const f of e)if(t<=f.x&&r<=f.y&&s>=f.x&&c>=f.y)return!0;const d=[new tt(t,r),new tt(t,c),new tt(s,c),new tt(s,r)];if(e.length>2)for(const f of d)if($c(e,f))return!0;for(let f=0;f<e.length-1;f++)if(BP(e[f],e[f+1],d))return!0;return!1}function BP(e,t,r){const s=r[0],c=r[2];if(e.x<s.x&&t.x<s.x||e.x>c.x&&t.x>c.x||e.y<s.y&&t.y<s.y||e.y>c.y&&t.y>c.y)return!1;const d=Qt(e,t,r[0]);return d!==Qt(e,t,r[1])||d!==Qt(e,t,r[2])||d!==Qt(e,t,r[3])}function $u(e,t,r,s,c,d){let f=t.y-e.y,g=e.x-t.x;if(d=d||0){const y=f*f+g*g;if(0===y)return!0;const b=Math.sqrt(y);f/=b,g/=b}return!((r.x-e.x)*f+(r.y-e.y)*g-d<0||(s.x-e.x)*f+(s.y-e.y)*g-d<0||(c.x-e.x)*f+(c.y-e.y)*g-d<0)}function C0(e,t,r,s,c,d,f){return!($u(e,t,s,c,d,f)||$u(t,r,s,c,d,f)||$u(r,e,s,c,d,f)||$u(s,c,e,t,r,f)||$u(c,d,e,t,r,f)||$u(d,s,e,t,r,f))}function ai(e,t,r){const s=t.paint.get(e).value;return"constant"===s.kind?s.value:r.programConfigurations.get(t.id).getMaxValue(e)}function _a(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Il(e,t,r,s,c){if(!t[0]&&!t[1])return e;const d=tt.convert(t)._mult(c);"viewport"===r&&d._rotate(-s);const f=[];for(let g=0;g<e.length;g++)f.push(e[g].sub(d));return f}function p1(e,t,r,s){const c=tt.convert(e)._mult(s);return"viewport"===t&&c._rotate(-r),c}De(Wi,"CircleBucket",{omit:["layers"]});const FI=new jt({"circle-sort-key":new Q(wt.layout_circle["circle-sort-key"]),visibility:new G(wt.layout_circle.visibility)});var ze={paint:new jt({"circle-radius":new Q(wt.paint_circle["circle-radius"]),"circle-color":new Q(wt.paint_circle["circle-color"]),"circle-blur":new Q(wt.paint_circle["circle-blur"]),"circle-opacity":new Q(wt.paint_circle["circle-opacity"]),"circle-translate":new G(wt.paint_circle["circle-translate"]),"circle-translate-anchor":new G(wt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new G(wt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new G(wt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Q(wt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Q(wt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Q(wt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new G(wt.paint_circle["circle-emissive-strength"])}),layout:FI};const rs=bt.create(),lc=(e,t,r,s,c,d)=>{const f=e.transform,g="globe"===f.projection.name;let y;if("map"===d.paint.get("circle-pitch-alignment"))if(g){const C=k_(f.zoom,t.canonical)*f._pixelsPerMercatorPixel;y=Float32Array.from([C,0,0,C])}else y=f.calculatePixelsToTileUnitsMatrix(r);else y=new Float32Array([f.pixelsToGLUnits[0],0,0,f.pixelsToGLUnits[1]]);const b={u_camera_to_center_distance:e.transform.getCameraToCenterDistance(f.projection),u_matrix:e.translatePosMatrix(t.projMatrix,r,d.paint.get("circle-translate"),d.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Mn.devicePixelRatio,u_extrude_scale:y,u_inv_rot_matrix:rs,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:d.paint.get("circle-emissive-strength")};if(g){b.u_inv_rot_matrix=s,b.u_merc_center=c,b.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],b.u_zoom_transition=Pi(f.zoom);const C=c[0]*Dt,P=c[1]*Dt;b.u_up_dir=f.projection.upVector(new ic(0,0,0),C,P)}return b},Sp=e=>{const t=[];return"map"===e.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===e.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t};function wn(e,t,r,s,c,d,f,g,y){if(d&&e.queryGeometry.isAboveHorizon)return!1;d&&(y*=e.pixelToTileUnitsFactor);const b=e.tileID.canonical,C=r.projection.upVectorScale(b,r.center.lat,r.worldSize).metersToTile;for(const P of t)for(const E of P){const I=E.add(g),A=c&&r.elevation?r.elevation.exaggeration()*c.getElevationAt(I.x,I.y,!0):0,l=r.projection.projectTilePoint(I.x,I.y,b);if(A>0){const v=r.projection.upVector(b,I.x,I.y);l.x+=v[0]*C*A,l.y+=v[1]*C*A,l.z+=v[2]*C*A}const u=d?I:$n(l.x,l.y,l.z,s),p=d?e.tilespaceRays.map(v=>Jt(v,A)):e.queryGeometry.screenGeometry,m=kr.transformMat4([],[l.x,l.y,l.z,1],s);if(!f&&d?y*=m[3]/r.cameraToCenterDistance:f&&!d&&(y*=r.cameraToCenterDistance/m[3]),d){const v=ti((E.y/Dt+b.y)/(1<<b.z));y/=r.projection.pixelsPerMeter(v,1)/oo(1,v)}if(Ip(p,u,y))return!0}return!1}function $n(e,t,r,s){const c=kr.transformMat4([],[e,t,r,1],s);return new tt(c[0]/c[3],c[1]/c[3])}const UP=dt.fromValues(0,0,0),_n=dt.fromValues(0,0,1);function Jt(e,t){const r=dt.create();return UP[2]=t,e.intersectsPlane(UP,_n,r),new tt(r[0],r[1])}class Se extends Wi{}function Ss(e,{width:t,height:r},s,c){if(c){if(c instanceof Uint8ClampedArray)c=new Uint8Array(c.buffer);else if(c.length!==t*r*s)throw new RangeError("mismatched image size")}else c=new Uint8Array(t*r*s);return e.width=t,e.height=r,e.data=c,e}function g1(e,t,r){const{width:s,height:c}=t;s===e.width&&c===e.height||(VP(e,t,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,s),height:Math.min(e.height,c)},r),e.width=s,e.height=c,e.data=t.data)}function VP(e,t,r,s,c,d){if(0===c.width||0===c.height)return t;if(c.width>e.width||c.height>e.height||r.x>e.width-c.width||r.y>e.height-c.height)throw new RangeError("out of range source coordinates for image copy");if(c.width>t.width||c.height>t.height||s.x>t.width-c.width||s.y>t.height-c.height)throw new RangeError("out of range destination coordinates for image copy");const f=e.data,g=t.data;for(let y=0;y<c.height;y++){const b=((r.y+y)*e.width+r.x)*d,C=((s.y+y)*t.width+s.x)*d;for(let P=0;P<c.width*d;P++)g[C+P]=f[b+P]}return t}De(Se,"HeatmapBucket",{omit:["layers"]});class cf{constructor(t,r){Ss(this,t,1,r)}resize(t){g1(this,new cf(t),1)}clone(){return new cf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,s,c,d){VP(t,r,s,c,d,1)}}class Ui{constructor(t,r){Ss(this,t,4,r)}resize(t){g1(this,new Ui(t),4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Ui({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,s,c,d){VP(t,r,s,c,d,4)}}class TT{constructor(t,r){this.width=t.width,this.height=t.height,this.data=r instanceof Uint8Array?new Float32Array(r.buffer):r}}De(cf,"AlphaImage"),De(Ui,"RGBAImage");const jP=new jt({visibility:new G(wt.layout_heatmap.visibility)});var jw={paint:new jt({"heatmap-radius":new Q(wt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Q(wt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new G(wt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new St(wt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new G(wt.paint_heatmap["heatmap-opacity"])}),layout:jP};function $w(e){const t={},r=e.resolution||256,s=e.clips?e.clips.length:1,c=e.image||new Ui({width:r,height:s}),d=(f,g,y)=>{t[e.evaluationKey]=y;const b=e.expression.evaluate(t);b&&(c.data[f+g+0]=Math.floor(255*b.r/b.a),c.data[f+g+1]=Math.floor(255*b.g/b.a),c.data[f+g+2]=Math.floor(255*b.b/b.a),c.data[f+g+3]=Math.floor(255*b.a))};if(e.clips)for(let f=0,g=0;f<s;++f,g+=4*r)for(let y=0,b=0;y<r;y++,b+=4){const C=y/(r-1),{start:P,end:E}=e.clips[f];d(g,b,P*(1-C)+E*C)}else for(let f=0,g=0;f<r;f++,g+=4)d(0,g,f/(r-1));return c}const Gw=new jt({visibility:new G(wt.layout_hillshade.visibility)});var $P={paint:new jt({"hillshade-illumination-direction":new G(wt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new G(wt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new G(wt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new G(wt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new G(wt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new G(wt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new G(wt.paint_hillshade["hillshade-emissive-strength"])}),layout:Gw};const Hw=Dr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Br}=Hw;var uf={exports:{}};function L_(e,t,r){r=r||2;var s,c,d,f,g,y,b,C=t&&t.length,P=C?t[0]*r:e.length,E=An(e,0,P,r,!0),I=[];if(!E||E.next===E.prev)return I;if(C&&(E=function(l,u,p,m){var v,M,O,T=[];for(v=0,M=u.length;v<M;v++)(O=An(l,u[v]*m,v<M-1?u[v+1]*m:l.length,m,!1))===O.next&&(O.steiner=!0),T.push(N_(O));for(T.sort(df),v=0;v<T.length;v++)p=M0(T[v],p);return p}(e,t,E,r)),e.length>80*r){s=d=e[0],c=f=e[1];for(var A=r;A<P;A+=r)(g=e[A])<s&&(s=g),(y=e[A+1])<c&&(c=y),g>d&&(d=g),y>f&&(f=y);b=0!==(b=Math.max(d-s,f-c))?32767/b:0}return $d(E,I,r,s,c,b,0),I}function An(e,t,r,s,c){var d,f;if(c===Al(e,t,r,s)>0)for(d=t;d<r;d+=s)f=_1(d,e[d],e[d+1],f);else for(d=r-s;d>=t;d-=s)f=_1(d,e[d],e[d+1],f);return f&&Ug(f,f.next)&&(qt(f),f=f.next),f}function Rn(e,t){if(!e)return e;t||(t=e);var r,s=e;do{if(r=!1,s.steiner||!Ug(s,s.next)&&0!==Oi(s.prev,s,s.next))s=s.next;else{if(qt(s),(s=t=s.prev)===s.next)break;r=!0}}while(r||s!==t);return t}function $d(e,t,r,s,c,d,f){if(e){!f&&d&&function(C,P,E,I){var A=C;do{0===A.z&&(A.z=m1(A.x,A.y,P,E,I)),A.prevZ=A.prev,A.nextZ=A.next,A=A.next}while(A!==C);A.prevZ.nextZ=null,A.prevZ=null,function(l){var u,p,m,v,M,O,T,k,N=1;do{for(p=l,l=null,M=null,O=0;p;){for(O++,m=p,T=0,u=0;u<N&&(T++,m=m.nextZ);u++);for(k=N;T>0||k>0&&m;)0!==T&&(0===k||!m||p.z<=m.z)?(v=p,p=p.nextZ,T--):(v=m,m=m.nextZ,k--),M?M.nextZ=v:l=v,v.prevZ=M,M=v;p=m}M.nextZ=null,N*=2}while(O>1)}(A)}(e,s,c,d);for(var g,y,b=e;e.prev!==e.next;)if(g=e.prev,y=e.next,d?GP(e,s,c,d):io(e))t.push(g.i/r|0),t.push(e.i/r|0),t.push(y.i/r|0),qt(e),e=y.next,b=y.next;else if((e=y)===b){f?1===f?$d(e=_s(Rn(e),t,r),t,r,s,c,d,2):2===f&&hn(e,t,r,s,c,d):$d(Rn(e),t,r,s,c,d,1);break}}}function io(e){var t=e.prev,r=e,s=e.next;if(Oi(t,r,s)>=0)return!1;for(var c=t.x,d=r.x,f=s.x,g=t.y,y=r.y,b=s.y,C=c<d?c<f?c:f:d<f?d:f,P=g<y?g<b?g:b:y<b?y:b,E=c>d?c>f?c:f:d>f?d:f,I=g>y?g>b?g:b:y>b?y:b,A=s.next;A!==t;){if(A.x>=C&&A.x<=E&&A.y>=P&&A.y<=I&&Ap(c,g,d,y,f,b,A.x,A.y)&&Oi(A.prev,A,A.next)>=0)return!1;A=A.next}return!0}function GP(e,t,r,s){var c=e.prev,d=e,f=e.next;if(Oi(c,d,f)>=0)return!1;for(var g=c.x,y=d.x,b=f.x,C=c.y,P=d.y,E=f.y,I=g<y?g<b?g:b:y<b?y:b,A=C<P?C<E?C:E:P<E?P:E,l=g>y?g>b?g:b:y>b?y:b,u=C>P?C>E?C:E:P>E?P:E,p=m1(I,A,t,r,s),m=m1(l,u,t,r,s),v=e.prevZ,M=e.nextZ;v&&v.z>=p&&M&&M.z<=m;){if(v.x>=I&&v.x<=l&&v.y>=A&&v.y<=u&&v!==c&&v!==f&&Ap(g,C,y,P,b,E,v.x,v.y)&&Oi(v.prev,v,v.next)>=0||(v=v.prevZ,M.x>=I&&M.x<=l&&M.y>=A&&M.y<=u&&M!==c&&M!==f&&Ap(g,C,y,P,b,E,M.x,M.y)&&Oi(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;v&&v.z>=p;){if(v.x>=I&&v.x<=l&&v.y>=A&&v.y<=u&&v!==c&&v!==f&&Ap(g,C,y,P,b,E,v.x,v.y)&&Oi(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;M&&M.z<=m;){if(M.x>=I&&M.x<=l&&M.y>=A&&M.y<=u&&M!==c&&M!==f&&Ap(g,C,y,P,b,E,M.x,M.y)&&Oi(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function _s(e,t,r){var s=e;do{var c=s.prev,d=s.next.next;!Ug(c,d)&&Sl(c,s,s.next,d)&&z_(c,d)&&z_(d,c)&&(t.push(c.i/r|0),t.push(s.i/r|0),t.push(d.i/r|0),qt(s),qt(s.next),s=e=d),s=s.next}while(s!==e);return Rn(s)}function hn(e,t,r,s,c,d){var f=e;do{for(var g=f.next.next;g!==f.prev;){if(f.i!==g.i&&Bg(f,g)){var y=hf(f,g);return f=Rn(f,f.next),y=Rn(y,y.next),$d(f,t,r,s,c,d,0),void $d(y,t,r,s,c,d,0)}g=g.next}f=f.next}while(f!==e)}function df(e,t){return e.x-t.x}function M0(e,t){var r=function(c,d){var f,g=d,y=c.x,b=c.y,C=-1/0;do{if(b<=g.y&&b>=g.next.y&&g.next.y!==g.y){var P=g.x+(b-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(P<=y&&P>C&&(C=P,f=g.x<g.next.x?g:g.next,P===y))return f}g=g.next}while(g!==d);if(!f)return null;var E,I=f,A=f.x,l=f.y,u=1/0;g=f;do{y>=g.x&&g.x>=A&&y!==g.x&&Ap(b<l?y:C,b,A,l,b<l?C:y,b,g.x,g.y)&&(E=Math.abs(b-g.y)/(y-g.x),z_(g,c)&&(E<u||E===u&&(g.x>f.x||g.x===f.x&&Gu(f,g)))&&(f=g,u=E)),g=g.next}while(g!==I);return f}(e,t);if(!r)return t;var s=hf(r,e);return Rn(s,s.next),Rn(r,r.next)}function Gu(e,t){return Oi(e.prev,e,t.prev)<0&&Oi(t.next,e,e.next)<0}function m1(e,t,r,s,c){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*c|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-s)*c|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function N_(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Ap(e,t,r,s,c,d,f,g){return(c-f)*(t-g)>=(e-f)*(d-g)&&(e-f)*(s-g)>=(r-f)*(t-g)&&(r-f)*(d-g)>=(c-f)*(s-g)}function Bg(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,s){var c=r;do{if(c.i!==r.i&&c.next.i!==r.i&&c.i!==s.i&&c.next.i!==s.i&&Sl(c,c.next,r,s))return!0;c=c.next}while(c!==r);return!1}(e,t)&&(z_(e,t)&&z_(t,e)&&function(r,s){var c=r,d=!1,f=(r.x+s.x)/2,g=(r.y+s.y)/2;do{c.y>g!=c.next.y>g&&c.next.y!==c.y&&f<(c.next.x-c.x)*(g-c.y)/(c.next.y-c.y)+c.x&&(d=!d),c=c.next}while(c!==r);return d}(e,t)&&(Oi(e.prev,e,t.prev)||Oi(e,t.prev,t))||Ug(e,t)&&Oi(e.prev,e,e.next)>0&&Oi(t.prev,t,t.next)>0)}function Oi(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Ug(e,t){return e.x===t.x&&e.y===t.y}function Sl(e,t,r,s){var c=P0(Oi(e,t,r)),d=P0(Oi(e,t,s)),f=P0(Oi(r,s,e)),g=P0(Oi(r,s,t));return c!==d&&f!==g||!(0!==c||!F_(e,r,t))||!(0!==d||!F_(e,s,t))||!(0!==f||!F_(r,e,s))||!(0!==g||!F_(r,t,s))}function F_(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function P0(e){return e>0?1:e<0?-1:0}function z_(e,t){return Oi(e.prev,e,e.next)<0?Oi(e,t,e.next)>=0&&Oi(e,e.prev,t)>=0:Oi(e,t,e.prev)<0||Oi(e,e.next,t)<0}function hf(e,t){var r=new B_(e.i,e.x,e.y),s=new B_(t.i,t.x,t.y),c=e.next,d=t.prev;return e.next=t,t.prev=e,r.next=c,c.prev=r,s.next=r,r.prev=s,d.next=s,s.prev=d,s}function _1(e,t,r,s){var c=new B_(e,t,r);return s?(c.next=s.next,c.prev=s,s.next.prev=c,s.next=c):(c.prev=c,c.next=c),c}function qt(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function B_(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Al(e,t,r,s){for(var c=0,d=t,f=r-s;d<r;d+=s)c+=(e[f]-e[d])*(e[d+1]+e[f+1]),f=d;return c}uf.exports=L_,uf.exports.default=L_,L_.deviation=function(e,t,r,s){var c=t&&t.length,d=Math.abs(Al(e,0,c?t[0]*r:e.length,r));if(c)for(var f=0,g=t.length;f<g;f++)d-=Math.abs(Al(e,t[f]*r,f<g-1?t[f+1]*r:e.length,r));var y=0;for(f=0;f<s.length;f+=3){var b=s[f]*r,C=s[f+1]*r,P=s[f+2]*r;y+=Math.abs((e[b]-e[P])*(e[C+1]-e[b+1])-(e[b]-e[C])*(e[P+1]-e[b+1]))}return 0===d&&0===y?0:Math.abs((y-d)/d)},L_.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},s=0,c=0;c<e.length;c++){for(var d=0;d<e[c].length;d++)for(var f=0;f<t;f++)r.vertices.push(e[c][d][f]);c>0&&r.holes.push(s+=e[c-1].length)}return r};var O0=We(uf.exports);function Vg(e,t){const r=e.length;if(r<=1)return[e];const s=[];let c,d;for(let f=0;f<r;f++){const g=ie(e[f]);0!==g&&(e[f].area=Math.abs(g),void 0===d&&(d=g<0),d===g<0?(c&&s.push(c),c=[e[f]]):c.push(e[f]))}if(c&&s.push(c),t>1)for(let f=0;f<s.length;f++)s[f].length<=t||(qy(s[f],t,1,s[f].length-1,Dp),s[f]=s[f].slice(0,t));return s}function Dp(e,t){return t.area-e.area}function cl(e,t,r){const s=r.patternDependencies;let c=!1;for(const d of t){const f=d.paint.get(`${e}-pattern`);f.isConstant()||(c=!0);const g=f.constantOr(null);g&&(c=!0,s[g]=!0)}return c}function ff(e,t,r,s,c){const d=c.patternDependencies;for(const f of t){const g=f.paint.get(`${e}-pattern`).value;if("constant"!==g.kind){let y=g.evaluate({zoom:s},r,{},c.availableImages);y=y&&y.name?y.name:y,d[y]=!0,r.patterns[f.id]=y}}return r}class E0{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pa,this.indexArray=new Mi,this.indexArray2=new Ru,this.programConfigurations=new ga(t.layers,t.zoom),this.segments=new lo,this.segments2=new lo,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=t.projection}populate(t,r,s,c){this.hasPattern=cl("fill",this.layers,r);const d=this.layers[0].layout.get("fill-sort-key"),f=[];for(const{feature:g,id:y,index:b,sourceLayerIndex:C}of t){const P=this.layers[0]._featureFilter.needGeometry,E=jc(g,P);if(!this.layers[0]._featureFilter.filter(new Lo(this.zoom),E,s))continue;const I=d?d.evaluate(E,{},s,r.availableImages):void 0,A={id:y,properties:g.properties,type:g.type,sourceLayerIndex:C,index:b,geometry:P?E.geometry:Eo(g,s,c),patterns:{},sortKey:I};f.push(A)}d&&f.sort((g,y)=>g.sortKey-y.sortKey);for(const g of f){const{geometry:y,index:b,sourceLayerIndex:C}=g;if(this.hasPattern){const P=ff("fill",this.layers,g,this.zoom,r);this.patternFeatures.push(P)}else this.addFeature(g,y,b,s,{},r.availableImages,r.brightness);r.featureIndex.insert(t[b].feature,y,b,C,this.index)}}update(t,r,s,c,d){const f=0!==Object.keys(t).length;f&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,f?this.stateDependentLayers:this.layers,s,c,d)}addFeatures(t,r,s,c,d,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,s,c,f)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Br),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,s,c,d,f=[],g){for(const y of Vg(r,500)){let b=0;for(const l of y)b+=l.length;const C=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),P=C.vertexLength,E=[],I=[];for(const l of y){if(0===l.length)continue;l!==y[0]&&I.push(E.length/2);const u=this.segments2.prepareSegment(l.length,this.layoutVertexArray,this.indexArray2),p=u.vertexLength;this.layoutVertexArray.emplaceBack(l[0].x,l[0].y),this.indexArray2.emplaceBack(p+l.length-1,p),E.push(l[0].x),E.push(l[0].y);for(let m=1;m<l.length;m++)this.layoutVertexArray.emplaceBack(l[m].x,l[m].y),this.indexArray2.emplaceBack(p+m-1,p+m),E.push(l[m].x),E.push(l[m].y);u.vertexLength+=l.length,u.primitiveLength+=l.length}const A=O0(E,I);for(let l=0;l<A.length;l+=3)this.indexArray.emplaceBack(P+A[l],P+A[l+1],P+A[l+2]);C.vertexLength+=b,C.primitiveLength+=A.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,d,f,c,g)}}De(E0,"FillBucket",{omit:["layers","patternFeatures"]});const HP=new jt({"fill-sort-key":new Q(wt.layout_fill["fill-sort-key"]),visibility:new G(wt.layout_fill.visibility)});var qw={paint:new jt({"fill-antialias":new G(wt.paint_fill["fill-antialias"]),"fill-opacity":new Q(wt.paint_fill["fill-opacity"]),"fill-color":new Q(wt.paint_fill["fill-color"]),"fill-outline-color":new Q(wt.paint_fill["fill-outline-color"]),"fill-translate":new G(wt.paint_fill["fill-translate"]),"fill-translate-anchor":new G(wt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Q(wt.paint_fill["fill-pattern"]),"fill-emissive-strength":new G(wt.paint_fill["fill-emissive-strength"])}),layout:HP};const qP=Dr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),cc=Dr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),T0=Dr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),I0=Dr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Zw=Dr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Ra}=qP;var y1={},v1=Ce,Hu=jg;function jg(e,t,r,s,c){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=s,this._values=c,e.readFields(b1,this,t)}function b1(e,t,r){1==e?t.id=r.readVarint():2==e?function(s,c){for(var d=s.readVarint()+s.pos;s.pos<d;){var f=c._keys[s.readVarint()],g=c._values[s.readVarint()];c.properties[f]=g}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function ZP(e){for(var t,r,s=0,c=0,d=e.length,f=d-1;c<d;f=c++)s+=((r=e[f]).x-(t=e[c]).x)*(t.y+r.y);return s}jg.types=["Unknown","Point","LineString","Polygon"],jg.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,s=1,c=0,d=0,f=0,g=[];e.pos<r;){if(c<=0){var y=e.readVarint();s=7&y,c=y>>3}if(c--,1===s||2===s)d+=e.readSVarint(),f+=e.readSVarint(),1===s&&(t&&g.push(t),t=[]),t.push(new v1(d,f));else{if(7!==s)throw new Error("unknown command "+s);t&&t.push(t[0].clone())}}return t&&g.push(t),g},jg.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,s=0,c=0,d=0,f=1/0,g=-1/0,y=1/0,b=-1/0;e.pos<t;){if(s<=0){var C=e.readVarint();r=7&C,s=C>>3}if(s--,1===r||2===r)(c+=e.readSVarint())<f&&(f=c),c>g&&(g=c),(d+=e.readSVarint())<y&&(y=d),d>b&&(b=d);else if(7!==r)throw new Error("unknown command "+r)}return[f,y,g,b]},jg.prototype.toGeoJSON=function(e,t,r){var s,c,d=this.extent*Math.pow(2,r),f=this.extent*e,g=this.extent*t,y=this.loadGeometry(),b=jg.types[this.type];function C(I){for(var A=0;A<I.length;A++){var l=I[A];I[A]=[360*(l.x+f)/d-180,360/Math.PI*Math.atan(Math.exp((180-360*(l.y+g)/d)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(s=0;s<y.length;s++)P[s]=y[s][0];C(y=P);break;case 2:for(s=0;s<y.length;s++)C(y[s]);break;case 3:for(y=function(I){var A=I.length;if(A<=1)return[I];for(var l,u,p=[],m=0;m<A;m++){var v=ZP(I[m]);0!==v&&(void 0===u&&(u=v<0),u===v<0?(l&&p.push(l),l=[I[m]]):l.push(I[m]))}return l&&p.push(l),p}(y),s=0;s<y.length;s++)for(c=0;c<y[s].length;c++)C(y[s][c])}1===y.length?y=y[0]:b="Multi"+b;var E={type:"Feature",geometry:{type:b,coordinates:y},properties:this.properties};return"id"in this&&(E.id=this.id),E};var IT=Hu,qu=x1;function x1(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(ST,this,t),this.length=this._features.length}function ST(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(s){for(var c=null,d=s.readVarint()+s.pos;s.pos<d;){var f=s.readVarint()>>3;c=1===f?s.readString():2===f?s.readFloat():3===f?s.readDouble():4===f?s.readVarint64():5===f?s.readVarint():6===f?s.readSVarint():7===f?s.readBoolean():null}return c}(r))}x1.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new IT(this._pbf,t,this.extent,this._keys,this._values)};var WP=qu;function AT(e,t,r){if(3===e){var s=new WP(r,r.readVarint()+r.pos);s.length&&(t[s.name]=s)}}var w1=y1.VectorTile=function(e,t){this.layers=e.readFields(AT,{},t)},S0=y1.VectorTileFeature=Hu;function $g(e,t,r,s){const c=[],d=0===s?(f,g,y,b,C,P)=>{f.push(new tt(P,y+(P-g)/(b-g)*(C-y)))}:(f,g,y,b,C,P)=>{f.push(new tt(g+(P-y)/(C-y)*(b-g),P))};for(const f of e){const g=[];for(const y of f){if(y.length<=2)continue;const b=[];for(let E=0;E<y.length-1;E++){const I=y[E].x,A=y[E].y,l=y[E+1].x,u=y[E+1].y,p=0===s?I:A,m=0===s?l:u;p<t?m>t&&d(b,I,A,l,u,t):p>r?m<r&&d(b,I,A,l,u,r):b.push(y[E]),m<t&&p>=t&&d(b,I,A,l,u,t),m>r&&p<=r&&d(b,I,A,l,u,r)}let C=y[y.length-1];const P=0===s?C.x:C.y;P>=t&&P<=r&&b.push(C),b.length&&(C=b[b.length-1],b[0].x===C.x&&b[0].y===C.y||b.push(b[0]),g.push(b))}g.length&&c.push(g)}return c}y1.VectorTileLayer=qu;class C1{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const s=t[r];this._stringToNumber[s]=r,this._numberToString[r]=s}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}var zI={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(e,t,r,s,c){var d,f,g=8*c-s-1,y=(1<<g)-1,b=y>>1,C=-7,P=r?c-1:0,E=r?-1:1,I=e[t+P];for(P+=E,d=I&(1<<-C)-1,I>>=-C,C+=g;C>0;d=256*d+e[t+P],P+=E,C-=8);for(f=d&(1<<-C)-1,d>>=-C,C+=s;C>0;f=256*f+e[t+P],P+=E,C-=8);if(0===d)d=1-b;else{if(d===y)return f?NaN:1/0*(I?-1:1);f+=Math.pow(2,s),d-=b}return(I?-1:1)*f*Math.pow(2,d-s)},write:function(e,t,r,s,c,d){var f,g,y,b=8*d-c-1,C=(1<<b)-1,P=C>>1,E=23===c?Math.pow(2,-24)-Math.pow(2,-77):0,I=s?0:d-1,A=s?1:-1,l=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(g=isNaN(t)?1:0,f=C):(f=Math.floor(Math.log(t)/Math.LN2),t*(y=Math.pow(2,-f))<1&&(f--,y*=2),(t+=f+P>=1?E/y:E*Math.pow(2,1-P))*y>=2&&(f++,y/=2),f+P>=C?(g=0,f=C):f+P>=1?(g=(t*y-1)*Math.pow(2,c),f+=P):(g=t*Math.pow(2,P-1)*Math.pow(2,c),f=0));c>=8;e[r+I]=255&g,I+=A,g/=256,c-=8);for(f=f<<c|g,b+=c;b>0;e[r+I]=255&f,I+=A,f/=256,b-=8);e[r+I-A]|=128*l}},Ww=No,A0=zI;function No(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}No.Varint=0,No.Fixed64=1,No.Bytes=2,No.Fixed32=5;var M1=4294967296,D0=1/M1,Gd=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Hd(e){return e.type===No.Bytes?e.readVarint()+e.pos:e.pos+1}function P1(e,t,r){var s=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(s);for(var c=r.pos-1;c>=e;c--)r.buf[c+s]=r.buf[c]}function Kw(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function zs(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function KP(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Zu(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function U_(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function ci(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Hg(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function La(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Ei(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function V_(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Gc(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function ul(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}No.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var s=this.readVarint(),c=s>>3,d=this.pos;this.type=7&s,e(c,t,this),this.pos===d&&this.skip(s)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=V_(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=ul(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=V_(this.buf,this.pos)+V_(this.buf,this.pos+4)*M1;return this.pos+=8,e},readSFixed64:function(){var e=V_(this.buf,this.pos)+ul(this.buf,this.pos+4)*M1;return this.pos+=8,e},readFloat:function(){var e=A0.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=A0.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,s=this.buf;return t=127&(r=s[this.pos++]),r<128?t:(t|=(127&(r=s[this.pos++]))<<7,r<128?t:(t|=(127&(r=s[this.pos++]))<<14,r<128?t:(t|=(127&(r=s[this.pos++]))<<21,r<128?t:function(c,d,f){var g,y,b=f.buf;if(g=(112&(y=b[f.pos++]))>>4,y<128||(g|=(127&(y=b[f.pos++]))<<3,y<128)||(g|=(127&(y=b[f.pos++]))<<10,y<128)||(g|=(127&(y=b[f.pos++]))<<17,y<128)||(g|=(127&(y=b[f.pos++]))<<24,y<128)||(g|=(1&(y=b[f.pos++]))<<31,y<128))return function Gg(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}(c,g,d);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=s[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Gd?Gd.decode(this.buf.subarray(t,e)):function(r,s,c){for(var d="",f=s;f<c;){var g,y,b,C=r[f],P=null,E=C>239?4:C>223?3:C>191?2:1;if(f+E>c)break;1===E?C<128&&(P=C):2===E?128==(192&(g=r[f+1]))&&(P=(31&C)<<6|63&g)<=127&&(P=null):3===E?(y=r[f+2],128==(192&(g=r[f+1]))&&128==(192&y)&&((P=(15&C)<<12|(63&g)<<6|63&y)<=2047||P>=55296&&P<=57343)&&(P=null)):4===E&&(y=r[f+2],b=r[f+3],128==(192&(g=r[f+1]))&&128==(192&y)&&128==(192&b)&&((P=(15&C)<<18|(63&g)<<12|(63&y)<<6|63&b)<=65535||P>=1114112)&&(P=null)),null===P?(P=65533,E=1):P>65535&&(P-=65536,d+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),d+=String.fromCharCode(P),f+=E}return d}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==No.Bytes)return e.push(this.readVarint(t));var r=Hd(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==No.Bytes)return e.push(this.readSVarint());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==No.Bytes)return e.push(this.readBoolean());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==No.Bytes)return e.push(this.readFloat());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==No.Bytes)return e.push(this.readDouble());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==No.Bytes)return e.push(this.readFixed32());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==No.Bytes)return e.push(this.readSFixed32());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==No.Bytes)return e.push(this.readFixed64());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==No.Bytes)return e.push(this.readSFixed64());var t=Hd(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===No.Varint)for(;this.buf[this.pos++]>127;);else if(t===No.Bytes)this.pos=this.readVarint()+this.pos;else if(t===No.Fixed32)this.pos+=4;else{if(t!==No.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Gc(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Gc(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Gc(this.buf,-1&e,this.pos),Gc(this.buf,Math.floor(e*D0),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Gc(this.buf,-1&e,this.pos),Gc(this.buf,Math.floor(e*D0),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,r){var s,c,d,g;if(t>=0?(s=t%4294967296|0,c=t/4294967296|0):(c=~(-t/4294967296),4294967295^(s=~(-t%4294967296))?s=s+1|0:(s=0,c=c+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),d=s,(g=r).buf[g.pos++]=127&d|128,d>>>=7,g.buf[g.pos++]=127&d|128,d>>>=7,g.buf[g.pos++]=127&d|128,d>>>=7,g.buf[g.pos++]=127&d|128,g.buf[g.pos]=127&(d>>>=7),function(d,f){var g=(7&d)<<4;f.buf[f.pos++]|=g|((d>>>=3)?128:0),d&&(f.buf[f.pos++]=127&d|((d>>>=7)?128:0),d&&(f.buf[f.pos++]=127&d|((d>>>=7)?128:0),d&&(f.buf[f.pos++]=127&d|((d>>>=7)?128:0),d&&(f.buf[f.pos++]=127&d|((d>>>=7)?128:0),d&&(f.buf[f.pos++]=127&d)))))}(c,r)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(s,c,d){for(var f,g,y=0;y<c.length;y++){if((f=c.charCodeAt(y))>55295&&f<57344){if(!g){f>56319||y+1===c.length?(s[d++]=239,s[d++]=191,s[d++]=189):g=f;continue}if(f<56320){s[d++]=239,s[d++]=191,s[d++]=189,g=f;continue}f=g-55296<<10|f-56320|65536,g=null}else g&&(s[d++]=239,s[d++]=191,s[d++]=189,g=null);f<128?s[d++]=f:(f<2048?s[d++]=f>>6|192:(f<65536?s[d++]=f>>12|224:(s[d++]=f>>18|240,s[d++]=f>>12&63|128),s[d++]=f>>6&63|128),s[d++]=63&f|128)}return d}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&P1(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),A0.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),A0.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var s=this.pos-r;s>=128&&P1(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeMessage:function(e,t,r){this.writeTag(e,No.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Kw,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,zs,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,U_,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,KP,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Zu,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,ci,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Hg,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,La,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Ei,t)},writeBytesField:function(e,t){this.writeTag(e,No.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,No.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,No.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,No.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,No.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,No.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,No.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,No.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,No.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,No.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};var k0=We(Ww);const DT=["tile","layer","source","sourceLayer","state"];class ys{constructor(t,r,s,c,d){this.type="Feature",this._vectorTileFeature=t,this._z=r,this._x=s,this._y=c,this.properties=t.properties,this.id=d}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(t.id=this.id);for(const r of DT)void 0!==this[r]&&(t[r]=this[r]);return t}}class R0{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,r,s){const c=String(r);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][c]=this.stateChanges[t][c]||{},_t(this.stateChanges[t][c],s),null===this.deletedStates[t]){this.deletedStates[t]={};for(const d in this.state[t])d!==c&&(this.deletedStates[t][d]=null)}else if(this.deletedStates[t]&&null===this.deletedStates[t][c]){this.deletedStates[t][c]={};for(const d in this.state[t][c])s[d]||(this.deletedStates[t][c][d]=null)}else for(const d in s)this.deletedStates[t]&&this.deletedStates[t][c]&&null===this.deletedStates[t][c][d]&&delete this.deletedStates[t][c][d]}removeFeatureState(t,r,s){if(null===this.deletedStates[t])return;const c=String(r);if(this.deletedStates[t]=this.deletedStates[t]||{},s&&void 0!==r)null!==this.deletedStates[t][c]&&(this.deletedStates[t][c]=this.deletedStates[t][c]||{},this.deletedStates[t][c][s]=null);else if(void 0!==r)if(this.stateChanges[t]&&this.stateChanges[t][c])for(s in this.deletedStates[t][c]={},this.stateChanges[t][c])this.deletedStates[t][c][s]=null;else this.deletedStates[t][c]=null;else this.deletedStates[t]=null}getState(t,r){const s=String(r),c=_t({},(this.state[t]||{})[s],(this.stateChanges[t]||{})[s]);if(null===this.deletedStates[t])return{};if(this.deletedStates[t]){const d=this.deletedStates[t][r];if(null===d)return{};for(const f in d)delete c[f]}return c}initializeTileState(t,r){t.setFeatureState(this.state,r)}coalesceChanges(t,r){const s={};for(const c in this.stateChanges){this.state[c]=this.state[c]||{};const d={};for(const f in this.stateChanges[c])this.state[c][f]||(this.state[c][f]={}),_t(this.state[c][f],this.stateChanges[c][f]),d[f]=this.state[c][f];s[c]=d}for(const c in this.deletedStates){this.state[c]=this.state[c]||{};const d={};if(null===this.deletedStates[c])for(const f in this.state[c])d[f]={},this.state[c][f]={};else for(const f in this.deletedStates[c]){if(null===this.deletedStates[c][f])this.state[c][f]={};else if(this.state[c][f])for(const g of Object.keys(this.deletedStates[c][f]))delete this.state[c][f][g];d[f]=this.state[c][f]}s[c]=s[c]||{},_t(s[c],d)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(s).length)for(const c in t)t[c].setFeatureState(s,r)}}class pf{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,r){const s=this.toIdx(t,r);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(t,r){return this.leaves[this.toIdx(t,r)]}toIdx(t,r){return r*this.size+t}}function Vi(e,t,r,s){let c=0,d=Number.MAX_VALUE;for(let f=0;f<3;f++)if(Math.abs(s[f])<1e-15){if(r[f]<e[f]||r[f]>t[f])return null}else{const g=1/s[f];let y=(e[f]-r[f])*g,b=(t[f]-r[f])*g;if(y>b){const C=y;y=b,b=C}if(y>c&&(c=y),b<d&&(d=b),c>d)return null}return c}function Wu(e,t,r,s,c,d,f,g,y,b,C){const P=s-e,E=c-t,I=d-r,A=f-e,l=g-t,u=y-r,p=C[1]*u-C[2]*l,m=C[2]*A-C[0]*u,v=C[0]*l-C[1]*A,M=P*p+E*m+I*v;if(Math.abs(M)<1e-15)return null;const O=1/M,T=b[0]-e,k=b[1]-t,N=b[2]-r,F=(T*p+k*m+N*v)*O;if(F<0||F>1)return null;const $=k*I-N*E,q=N*P-T*I,Z=T*E-k*P,X=(C[0]*$+C[1]*q+C[2]*Z)*O;return X<0||F+X>1?null:(A*$+l*q+u*Z)*O}function L0(e,t,r){return(e-t)/(r-t)}function N0(e,t,r,s,c,d,f,g,y){const b=1<<r,C=d-s,P=f-c,E=(e+1)/b*C+s,I=(t+0)/b*P+c,A=(t+1)/b*P+c;g[0]=(e+0)/b*C+s,g[1]=I,y[0]=E,y[1]=A}class qd{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(d){const f=Math.ceil(Math.log2(d.dim/8)),g=[];let y=Math.ceil(Math.pow(2,f));const b=1/y,C=(I,A,l,u,p)=>{const m=u?1:0,v=(I+1)*l-m,M=A*l,O=(A+1)*l-m;p[0]=I*l,p[1]=M,p[2]=v,p[3]=O};let P=new pf(y);const E=[];for(let I=0;I<y*y;I++){C(I%y,Math.floor(I/y),b,!1,E);const A=Dl(E[0],E[1],d),l=Dl(E[2],E[1],d),u=Dl(E[2],E[3],d),p=Dl(E[0],E[3],d);P.minimums.push(Math.min(A,l,u,p)),P.maximums.push(Math.max(A,l,u,p)),P.leaves.push(1)}for(g.push(P),y/=2;y>=1;y/=2){const I=g[g.length-1];P=new pf(y);for(let A=0;A<y*y;A++){C(A%y,Math.floor(A/y),2,!0,E);const l=I.getElevation(E[0],E[1]),u=I.getElevation(E[2],E[1]),p=I.getElevation(E[2],E[3]),m=I.getElevation(E[0],E[3]),v=I.isLeaf(E[0],E[1]),M=I.isLeaf(E[2],E[1]),O=I.isLeaf(E[2],E[3]),T=I.isLeaf(E[0],E[3]),k=Math.min(l.min,u.min,p.min,m.min),N=Math.max(l.max,u.max,p.max,m.max),F=v&&M&&O&&T;P.maximums.push(N),P.minimums.push(k),P.leaves.push(N-k<=5&&F?1:0)}g.push(P)}return g}(this.dem),s=r.length-1,c=r[s];this._addNode(c.minimums[0],c.maximums[0],c.leaves[0]),this._construct(r,0,0,s,0)}raycastRoot(t,r,s,c,d,f,g=1){return Vi([t,r,-100],[s,c,this.maximums[0]*g],d,f)}raycast(t,r,s,c,d,f,g=1){if(!this.nodeCount)return null;const y=this.raycastRoot(t,r,s,c,d,f,g);if(null==y)return null;const b=[],C=[],P=[],E=[],I=[{idx:0,t:y,nodex:0,nodey:0,depth:0}];for(;I.length>0;){const{idx:A,t:l,nodex:u,nodey:p,depth:m}=I.pop();if(this.leaves[A]){N0(u,p,m,t,r,s,c,P,E);const M=1<<m,O=(u+0)/M,T=(u+1)/M,k=(p+0)/M,N=(p+1)/M,F=Dl(O,k,this.dem)*g,$=Dl(T,k,this.dem)*g,q=Dl(T,N,this.dem)*g,Z=Dl(O,N,this.dem)*g,X=Wu(P[0],P[1],F,E[0],P[1],$,E[0],E[1],q,d,f),K=Wu(E[0],E[1],q,P[0],E[1],Z,P[0],P[1],F,d,f),J=Math.min(null!==X?X:Number.MAX_VALUE,null!==K?K:Number.MAX_VALUE);if(J!==Number.MAX_VALUE)return J;{const st=dt.scaleAndAdd([],d,f,l);if(YP(F,$,Z,q,L0(st[0],P[0],E[0]),L0(st[1],P[1],E[1]))>=st[2])return l}continue}let v=0;for(let M=0;M<this._siblingOffset.length;M++){N0((u<<1)+this._siblingOffset[M][0],(p<<1)+this._siblingOffset[M][1],m+1,t,r,s,c,P,E),P[2]=-100,E[2]=this.maximums[this.childOffsets[A]+M]*g;const O=Vi(P,E,d,f);if(null!=O){const T=O;b[M]=T;let k=!1;for(let N=0;N<v&&!k;N++)T>=b[C[N]]&&(C.splice(N,0,M),k=!0);k||(C[v]=M),v++}}for(let M=0;M<v;M++){const O=C[M];I.push({idx:this.childOffsets[A]+O,t:b[O],nodex:(u<<1)+this._siblingOffset[O][0],nodey:(p<<1)+this._siblingOffset[O][1],depth:m+1})}}return null}_addNode(t,r,s){return this.minimums.push(t),this.maximums.push(r),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(t,r,s,c,d){if(1===t[c].isLeaf(r,s))return;this.childOffsets[d]||(this.childOffsets[d]=this.nodeCount);const f=c-1,g=t[f];let y=0,b=0;for(let C=0;C<this._siblingOffset.length;C++){const P=2*r+this._siblingOffset[C][0],E=2*s+this._siblingOffset[C][1],I=g.getElevation(P,E),A=g.isLeaf(P,E),l=this._addNode(I.min,I.max,A);A&&(y|=1<<C),b||(b=l)}for(let C=0;C<this._siblingOffset.length;C++)y&1<<C||this._construct(t,2*r+this._siblingOffset[C][0],2*s+this._siblingOffset[C][1],f,b+C)}}function YP(e,t,r,s,c,d){return vn(vn(e,r,d),vn(t,s,d),c)}function Dl(e,t,r){const s=r.dim,c=Ne(e*s-.5,0,s-1),d=Ne(t*s-.5,0,s-1),f=Math.floor(c),g=Math.floor(d),y=Math.min(f+1,s-1),b=Math.min(g+1,s-1);return YP(r.get(f,g),r.get(y,g),r.get(f,b),r.get(y,b),c-f,d-g)}const kp={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function O1(e,t,r){return(256*e*256+256*t+r)/10-1e4}function Rp(e,t,r){return 256*e+t+r/256-32768}class uc{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,r,s,c=!1){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(s&&"mapbox"!==s&&"terrarium"!==s)return gt(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const d=this.dim=r.height-2,f=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.floatView=new Float32Array(r.data.buffer),this.borderReady=c,this._modifiedForSources={},!c){for(let y=0;y<d;y++)f[this._idx(-1,y)]=f[this._idx(0,y)],f[this._idx(d,y)]=f[this._idx(d-1,y)],f[this._idx(y,-1)]=f[this._idx(y,0)],f[this._idx(y,d)]=f[this._idx(y,d-1)];f[this._idx(-1,-1)]=f[this._idx(0,0)],f[this._idx(d,-1)]=f[this._idx(d-1,0)],f[this._idx(-1,d)]=f[this._idx(0,d-1)],f[this._idx(d,d)]=f[this._idx(d-1,d-1)]}const g="terrarium"===s?Rp:O1;for(let y=0;y<f.length;++y){const b=4*y;this.floatView[y]=g(this.pixels[b],this.pixels[b+1],this.pixels[b+2])}this._timestamp=Mn.now()}_buildQuadTree(){this._tree=new qd(this)}get(t,r,s=!1){s&&(t=Ne(t,-1,this.dim),r=Ne(r,-1,this.dim));const c=this._idx(t,r);return this.floatView[c]}set(t,r,s){const c=this._idx(t,r),d=this.floatView[c];return this.floatView[c]=s,s-d}static getUnpackVector(t){return kp[t]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}static pack(t,r){const s=[0,0,0,0],c=uc.getUnpackVector(r);let d=Math.floor((t+c[3])/c[2]);return s[2]=d%256,d=Math.floor(d/256),s[1]=d%256,d=Math.floor(d/256),s[0]=d,s}getPixels(){return new TT({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,r,s){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let c=r*this.dim,d=r*this.dim+this.dim,f=s*this.dim,g=s*this.dim+this.dim;switch(r){case-1:c=d-1;break;case 1:d=c+1}switch(s){case-1:f=g-1;break;case 1:g=f+1}const y=-r*this.dim,b=-s*this.dim;for(let C=f;C<g;C++)for(let P=c;P<d;P++){const E=4*this._idx(P,C),I=4*this._idx(P+y,C+b);this.pixels[E+0]=t.pixels[I+0],this.pixels[E+1]=t.pixels[I+1],this.pixels[E+2]=t.pixels[I+2],this.pixels[E+3]=t.pixels[I+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}De(uc,"DEMData"),De(qd,"DemMinMaxQuadTree",{omit:["dem"]});class F0{isDataAvailableAtPoint(t){const r=this._source();if(this.isUsingMockSource()||!r||t.y<0||t.y>1)return!1;const s=r.getSource().maxzoom,c=1<<s,d=Math.floor(t.x),f=Math.floor((t.x-d)*c),g=Math.floor(t.y*c),y=this.findDEMTileFor(new Ir(s,d,s,f,g));return!(!y||!y.dem)}getAtPointOrZero(t,r=0){return this.getAtPoint(t,r)||0}getAtPoint(t,r,s=!0){if(this.isUsingMockSource())return null;null==r&&(r=null);const c=this._source();if(!c||t.y<0||t.y>1)return r;const d=c.getSource().maxzoom,f=1<<d,g=Math.floor(t.x),y=t.x-g,b=new Ir(d,g,d,Math.floor(y*f),Math.floor(t.y*f)),C=this.findDEMTileFor(b);if(!C||!C.dem)return r;const P=C.dem,E=1<<C.tileID.canonical.z,I=(y*E-C.tileID.canonical.x)*P.dim,A=(t.y*E-C.tileID.canonical.y)*P.dim,l=Math.floor(I),u=Math.floor(A);return(s?this.exaggeration():1)*vn(vn(P.get(l,u),P.get(l,u+1),A-u),vn(P.get(l+1,u),P.get(l+1,u+1),A-u),I-l)}getAtTileOffset(t,r,s){const c=1<<t.canonical.z;return this.getAtPointOrZero(new Xn(t.wrap+(t.canonical.x+r/Dt)/c,(t.canonical.y+s/Dt)/c))}getAtTileOffsetFunc(t,r,s,c){return d=>{const f=this.getAtTileOffset(t,d.x,d.y),g=c.upVector(t.canonical,d.x,d.y),y=c.upVectorScale(t.canonical,r,s).metersToTile;return dt.scale(g,g,f*y),g}}getForTilePoints(t,r,s,c){if(this.isUsingMockSource())return!1;const d=dc.create(this,t,c);return!!d&&(r.forEach(f=>{f[2]=this.exaggeration()*d.getElevationAt(f[0],f[1],s)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(t);if(!r||!r.dem)return null;const s=r.dem.tree,c=r.tileID,d=1<<t.canonical.z-c.canonical.z;let f=t.canonical.x/d-c.canonical.x,g=t.canonical.y/d-c.canonical.y,y=0;for(let b=0;b<t.canonical.z-c.canonical.z&&!s.leaves[y];b++){f*=2,g*=2;const C=2*Math.floor(g)+Math.floor(f);y=s.childOffsets[y]+C,f%=1,g%=1}return{min:this.exaggeration()*s.minimums[y],max:this.exaggeration()*s.maximums[y]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,r,s){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const t=this.visibleDemTiles;if(0===t.length)return null;let r=!1,s=Number.MAX_VALUE,c=Number.MIN_VALUE;for(const d of t){const f=this.getMinMaxForTile(d.tileID);f&&(s=Math.min(s,f.min),c=Math.max(c,f.max),r=!0)}return r?{min:s,max:c}:null}}class dc{constructor(t,r,s){this._demTile=t,this._dem=this._demTile.dem,this._scale=r,this._offset=s}static create(t,r,s){const c=s||t.findDEMTileFor(r);if(!c||!c.dem)return;const d=c.dem,f=c.tileID,g=1<<r.canonical.z-f.canonical.z;return new dc(c,d.dim/Dt/g,[(r.canonical.x/g-f.canonical.x)*d.dim,(r.canonical.y/g-f.canonical.y)*d.dim])}tileCoordToPixel(t,r){const s=r*this._scale+this._offset[1],c=Math.floor(t*this._scale+this._offset[0]),d=Math.floor(s);return new tt(c,d)}getElevationAt(t,r,s,c){const d=t*this._scale+this._offset[0],f=r*this._scale+this._offset[1],g=Math.floor(d),y=Math.floor(f),b=this._dem;return c=!!c,s?vn(vn(b.get(g,y,c),b.get(g,y+1,c),f-y),vn(b.get(g+1,y,c),b.get(g+1,y+1,c),f-y),d-g):b.get(g,y,c)}getElevationAtPixel(t,r,s){return this._dem.get(t,r,!!s)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*oo(1,t)*this._dem.stride}}class z0{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Jl(Dt,16,0),this.featureIndexArray=new xb,this.promoteId=r}insert(t,r,s,c,d,f=0){const g=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,c,d,f);const y=this.grid;for(let b=0;b<r.length;b++){const C=r[b],P=[1/0,1/0,-1/0,-1/0];for(let E=0;E<C.length;E++){const I=C[E];P[0]=Math.min(P[0],I.x),P[1]=Math.min(P[1],I.y),P[2]=Math.max(P[2],I.x),P[3]=Math.max(P[3],I.y)}P[0]<Dt&&P[1]<Dt&&P[2]>=0&&P[3]>=0&&y.insert(g,P[0],P[1],P[2],P[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new w1(new k0(this.rawTileData)).layers,this.sourceLayerCoder=new C1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,r,s,c){this.loadVTLayers();const d=t.params||{},f=Tu(d.filter),g=t.tileResult,y=t.transform,b=g.bufferedTilespaceBounds,C=this.grid.query(b.min.x,b.min.y,b.max.x,b.max.y,(A,l,u,p)=>zP(g.bufferedTilespaceGeometry,A,l,u,p));C.sort(Yw);let P=null;y.elevation&&C.length>0&&(P=dc.create(y.elevation,this.tileID));const E={};let I;for(let A=0;A<C.length;A++){const l=C[A];if(l===I)continue;I=l;const u=this.featureIndexArray.get(l);let p=null;this.loadMatchingFeature(E,u,f,d.layers,d.availableImages,r,s,c,(m,v,M,O=0)=>(p||(p=Eo(m,this.tileID.canonical,t.tileTransform)),v.queryIntersectsFeature(g,m,M,p,this.z,t.transform,t.pixelPosMatrix,P,O)))}return E}loadMatchingFeature(t,r,s,c,d,f,g,y,b){const{featureIndex:C,bucketIndex:P,sourceLayerIndex:E,layoutVertexArrayOffset:I}=r,A=this.bucketLayerIDs[P];if(c&&!function(m,v){for(let M=0;M<m.length;M++)if(v.indexOf(m[M])>=0)return!0;return!1}(c,A))return;const l=this.sourceLayerCoder.decode(E),u=this.vtLayers[l].feature(C);if(s.needGeometry){const m=jc(u,!0);if(!s.filter(new Lo(this.tileID.overscaledZ),m,this.tileID.canonical))return}else if(!s.filter(new Lo(this.tileID.overscaledZ),u))return;const p=this.getId(u,l);for(let m=0;m<A.length;m++){const v=A[m];if(c&&c.indexOf(v)<0)continue;const M=f[v];if(!M)continue;let O={};void 0!==p&&y&&(O=y.getState(M.sourceLayer||"_geojsonTileLayer",p));const T=_t({},g[v]);T.paint=gf(T.paint,M.paint,u,O,d),T.layout=gf(T.layout,M.layout,u,O,d);const k=!b||b(u,M,O,I);if(!k)continue;const N=new ys(u,this.z,this.x,this.y,p);N.layer=T;let F=t[v];void 0===F&&(F=t[v]=[]),F.push({featureIndex:C,feature:N,intersectionZ:k})}}lookupSymbolFeatures(t,r,s,c,d,f,g,y){const b={};this.loadVTLayers();const C=Tu(d);for(const P of t)this.loadMatchingFeature(b,{bucketIndex:s,sourceLayerIndex:c,featureIndex:P,layoutVertexArrayOffset:0},C,f,g,y,r);return b}loadFeature(t){const{featureIndex:r,sourceLayerIndex:s}=t;this.loadVTLayers();const c=this.sourceLayerCoder.decode(s),d=this.vtFeatures[c];if(d[r])return d[r];const f=this.vtLayers[c].feature(r);return d[r]=f,f}hasLayer(t){for(const r of this.bucketLayerIDs)for(const s of r)if(t===s)return!0;return!1}getId(t,r){let s=t.id;if(this.promoteId){const c="string"==typeof this.promoteId?this.promoteId:this.promoteId[r];null!=c&&(s=t.properties[c]),"boolean"==typeof s&&(s=Number(s))}return s}}function gf(e,t,r,s,c){return fo(e,(d,f)=>{const g=t instanceof j?t.get(f):null;return g&&g.evaluate?g.evaluate(r,s,c):g})}function Yw(e,t){return t-e}De(z0,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const qg=Dr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Zg=Dr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Xw=Dr([{name:"a_projected_pos",components:4,type:"Float32"}],4);Dr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const B0=Dr([{name:"a_z_offset",components:1,type:"Float32"}],4),XP=Dr([{name:"a_texb",components:2,type:"Uint16"}]),QP=Dr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),E1=Dr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_z_offset",components:1,type:"Float32"}]);Dr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const j_=Dr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Qw=Dr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Dr([{name:"triangle",components:3,type:"Uint16"}]),Dr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Dr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Dr([{type:"Float32",name:"offsetX"}]),Dr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var os=24;const Ku=128;function Jw(e,t){const{expression:r}=t;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new Lo(e+1))};if("source"===r.kind)return{kind:"source"};{const{zoomStops:s,interpolationType:c}=r;let d=0;for(;d<s.length&&s[d]<=e;)d++;d=Math.max(0,d-1);let f=d;for(;f<s.length&&s[f]<e+1;)f++;f=Math.min(s.length-1,f);const g=s[d],y=s[f];return"composite"===r.kind?{kind:"composite",minZoom:g,maxZoom:y,interpolationType:c}:{kind:"camera",minZoom:g,maxZoom:y,minSize:r.evaluate(new Lo(g)),maxSize:r.evaluate(new Lo(y)),interpolationType:c}}}function Wg(e,{uSize:t,uSizeT:r},{lowerSize:s,upperSize:c}){return"source"===e.kind?s/Ku:"composite"===e.kind?vn(s/Ku,c/Ku,r):t}function ui(e,t){let r=0,s=0;if("constant"===e.kind)s=e.layoutSize;else if("source"!==e.kind){const{interpolationType:c,minZoom:d,maxZoom:f}=e,g=c?Ne(Ka.interpolationFactor(c,t,d,f),0,1):0;"camera"===e.kind?s=vn(e.minSize,e.maxSize,g):r=g}return{uSizeT:r,uSize:s}}var kT=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ku,evaluateSizeForFeature:Wg,evaluateSizeForZoom:ui,getSizeData:Jw});function li(e,t,r){return e.sections.forEach(s=>{s.text=function(c,d,f){const g=d.layout.get("text-transform").evaluate(f,{});return"uppercase"===g?c=c.toLocaleUpperCase():"lowercase"===g&&(c=c.toLocaleLowerCase()),el.applyArabicShaping&&(c=el.applyArabicShaping(c)),c}(s.text,t,r)}),e}const Hc={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function JP(e){return"\ufe36"===e||"\ufe48"===e||"\ufe38"===e||"\ufe44"===e||"\ufe42"===e||"\ufe3e"===e||"\ufe3c"===e||"\ufe3a"===e||"\ufe18"===e||"\ufe40"===e||"\ufe10"===e||"\ufe13"===e||"\ufe14"===e||"\uff40"===e||"\uffe3"===e||"\ufe11"===e||"\ufe12"===e}function T1(e){return"\ufe35"===e||"\ufe47"===e||"\ufe37"===e||"\ufe43"===e||"\ufe41"===e||"\ufe3d"===e||"\ufe3b"===e||"\ufe39"===e||"\ufe17"===e||"\ufe3f"===e}const Lp=3;function Zd(e,t,r){t.glyphs=[],1===e&&r.readMessage($_,t)}function $_(e,t,r){if(3===e){const{id:s,bitmap:c,width:d,height:f,left:g,top:y,advance:b}=r.readMessage(xr,{});t.glyphs.push({id:s,bitmap:new cf({width:d+2*Lp,height:f+2*Lp},c),metrics:{width:d,height:f,left:g,top:y,advance:b}})}else 4===e?t.ascender=r.readSVarint():5===e&&(t.descender=r.readSVarint())}function xr(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}const bo=Lp,so={horizontal:1,vertical:2,horizontalOnly:3},dl=-17;class mf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){const s=new mf;return s.scale=t||1,s.fontStack=r,s}static forImage(t){const r=new mf;return r.imageName=t,r}}class qc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const s=new qc;for(let c=0;c<t.sections.length;c++){const d=t.sections[c];d.image?s.addImageSection(d):s.addTextSection(d,r)}return s}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(r,s){let c="";for(let d=0;d<r.length;d++){const f=r.charCodeAt(d+1)||null,g=r.charCodeAt(d-1)||null;c+=!s&&(f&&se(f)&&!Hc[r[d+1]]||g&&se(g)&&!Hc[r[d-1]])||!Hc[r[d]]?r[d]:Hc[r[d]]}return c}(this.text,t)}trim(){let t=0;for(let s=0;s<this.text.length&&Kd[this.text.charCodeAt(s)];s++)t++;let r=this.text.length;for(let s=this.text.length-1;s>=0&&s>=t&&Kd[this.text.charCodeAt(s)];s--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const s=new qc;return s.text=this.text.substring(t,r),s.sectionIndex=this.sectionIndex.slice(t,r),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}addTextSection(t,r){this.text+=t.text,this.sections.push(mf.forText(t.scale,t.fontStack||r));const s=this.sections.length-1;for(let c=0;c<t.text.length;++c)this.sectionIndex.push(s)}addImageSection(t){const r=t.image?t.image.namePrimary:"";if(0===r.length)return void gt("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCodePoint(s),this.sections.push(mf.forImage(r)),this.sectionIndex.push(this.sections.length-1)):gt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Wd(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A){const l=qc.fromFeature(e,c);P===so.vertical&&l.verticalizePunctuation(E);let u=[];const p=function(T,k,N,F,$,q){if(!T)return[];const Z=[],X=function(it,rt,ct,yt,Et,Tt){let zt=0;for(let Nt=0;Nt<it.length();Nt++){const $t=it.getSection(Nt);zt+=Np(it.getCodePoint(Nt),$t,yt,Et,rt,Tt)}return zt/Math.max(1,Math.ceil(zt/ct))}(T,k,N,F,$,q),K=T.text.indexOf("\u200b")>=0;let J=0;for(let it=0;it<T.length();it++){const rt=T.getSection(it),ct=T.getCodePoint(it);if(Kd[ct]||(J+=Np(ct,rt,F,$,k,q)),it<T.length()-1){const yt=!((st=ct)<11904||!(V["Bopomofo Extended"](st)||V.Bopomofo(st)||V["CJK Compatibility Forms"](st)||V["CJK Compatibility Ideographs"](st)||V["CJK Compatibility"](st)||V["CJK Radicals Supplement"](st)||V["CJK Strokes"](st)||V["CJK Symbols and Punctuation"](st)||V["CJK Unified Ideographs Extension A"](st)||V["CJK Unified Ideographs"](st)||V["Enclosed CJK Letters and Months"](st)||V["Halfwidth and Fullwidth Forms"](st)||V.Hiragana(st)||V["Ideographic Description Characters"](st)||V["Kangxi Radicals"](st)||V["Katakana Phonetic Extensions"](st)||V.Katakana(st)||V["Vertical Forms"](st)||V["Yi Radicals"](st)||V["Yi Syllables"](st)));(Kg[ct]||yt||rt.imageName)&&Z.push(Xg(it+1,J,X,Z,G_(ct,T.getCodePoint(it+1),yt&&K),!1))}}var st;return Fp(Xg(T.length(),J,X,Z,0,!0))}(l,b,d,t,s,I),{processBidirectionalText:m,processStyledBidirectionalText:v}=el;if(m&&1===l.sections.length){const T=m(l.toString(),p);for(const k of T){const N=new qc;N.text=k,N.sections=l.sections;for(let F=0;F<k.length;F++)N.sectionIndex.push(0);u.push(N)}}else if(v){const T=v(l.text,l.sectionIndex,p);for(const k of T){const N=new qc;N.text=k[0],N.sectionIndex=k[1],N.sections=l.sections,u.push(N)}}else u=function(T,k){const N=[],F=T.text;let $=0;for(const q of k)N.push(T.substring($,q)),$=q;return $<F.length&&N.push(T.substring($,F.length)),N}(l,p);const M=[],O={positionedLines:M,text:l.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(T,k,N,F,$,q,Z,X,K,J,st,it){let rt=0,ct=0,yt=0;const Et="right"===X?1:"left"===X?0:.5;let Tt=!1;for(const Oe of $){const Ee=Oe.getSections();for(const Be of Ee){if(Be.imageName)continue;const je=k[Be.fontStack];if(je&&(Tt=void 0!==je.ascender&&void 0!==je.descender,!Tt))break}if(!Tt)break}let zt=0;for(const Oe of $){Oe.trim();const Ee=Oe.getMaxScale(),Be=(Ee-1)*os,je={positionedGlyphs:[],lineOffset:0};T.positionedLines[zt]=je;const On=je.positionedGlyphs;let Qe=0;if(!Oe.length()){ct+=q,++zt;continue}let nr=0,ln=0;for(let En=0;En<Oe.length();En++){const mn=Oe.getSection(En),wr=Oe.getSectionIndex(En),Lr=Oe.getCodePoint(En);let rr=mn.scale,Kr=null,Ao=null,mo=null,Fo=os,$i=0;const Ii=!(K===so.horizontal||!st&&!Lt(Lr)||st&&(Kd[Lr]||(Nt=Lr,V.Arabic(Nt)||V["Arabic Supplement"](Nt)||V["Arabic Extended-A"](Nt)||V["Arabic Presentation Forms-A"](Nt)||V["Arabic Presentation Forms-B"](Nt))));if(mn.imageName){const Ho=F[mn.imageName];if(!Ho)continue;mo=mn.imageName,T.iconsInText=T.iconsInText||!0,Ao=Ho.paddedRect;const Gr=Ho.displaySize;rr=rr*os/it,Kr={width:Gr[0],height:Gr[1],left:0,top:-bo,advance:Ii?Gr[1]:Gr[0],localGlyph:!1},$i=Tt?-Kr.height*rr:dl+Ee*os-Gr[1]*rr,Fo=Kr.advance;const Si=(Ii?Gr[0]:Gr[1])*rr-os*Ee;Si>0&&Si>Qe&&(Qe=Si)}else{const Ho=N[mn.fontStack];if(!Ho)continue;Ho[Lr]&&(Ao=Ho[Lr]);const Gr=k[mn.fontStack];if(!Gr)continue;const Si=Gr.glyphs[Lr];if(!Si)continue;if(Kr=Si.metrics,Fo=8203!==Lr?os:0,Tt){const zf=void 0!==Gr.ascender?Math.abs(Gr.ascender):0,ls=void 0!==Gr.descender?Math.abs(Gr.descender):0,Ll=(zf+ls)*rr;nr<Ll&&(nr=Ll,ln=(zf-ls)/2*rr),$i=-zf*rr}else $i=dl+(Ee-rr)*os}Ii?(T.verticalizable=!0,On.push({glyph:Lr,imageName:mo,x:rt,y:ct+$i,vertical:Ii,scale:rr,localGlyph:Kr.localGlyph,fontStack:mn.fontStack,sectionIndex:wr,metrics:Kr,rect:Ao}),rt+=Fo*rr+J):(On.push({glyph:Lr,imageName:mo,x:rt,y:ct+$i,vertical:Ii,scale:rr,localGlyph:Kr.localGlyph,fontStack:mn.fontStack,sectionIndex:wr,metrics:Kr,rect:Ao}),rt+=Kr.advance*rr+J)}0!==On.length&&(yt=Math.max(rt-J,yt),Tt?I1(On,Et,Qe,ln,q*Ee/2):I1(On,Et,Qe,0,q/2)),rt=0;const Ln=q*Ee+Qe;je.lineOffset=Math.max(Qe,Be),ct+=Ln,++zt}var Nt;const $t=ct,{horizontalAlign:Rt,verticalAlign:oe}=U0(Z);(function(Oe,Ee,Be,je,On,Qe){const nr=(Ee-Be)*On,ln=-Qe*je;for(const Ln of Oe)for(const En of Ln.positionedGlyphs)En.x+=nr,En.y+=ln})(T.positionedLines,Et,Rt,oe,yt,$t),T.top+=-oe*$t,T.bottom=T.top+$t,T.left+=-Rt*yt,T.right=T.left+yt,T.hasBaseline=Tt}(O,t,r,s,u,f,g,y,P,b,E,A),!function(T){for(const k of T)if(0!==k.positionedGlyphs.length)return!1;return!0}(M)&&O}const Kd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Kg={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Np(e,t,r,s,c,d){if(t.imageName){const f=s[t.imageName];return f?f.displaySize[0]*t.scale*os/d+c:0}{const f=r[t.fontStack],g=f&&f.glyphs[e];return g?g.metrics.advance*t.scale+c:0}}function Yg(e,t,r,s){const c=Math.pow(e-t,2);return s?e<t?c/2:2*c:c+Math.abs(r)*r}function G_(e,t,r){let s=0;return 10===e&&(s-=1e4),r&&(s+=150),40!==e&&65288!==e||(s+=50),41!==t&&65289!==t||(s+=50),s}function Xg(e,t,r,s,c,d){let f=null,g=Yg(t,r,c,d);for(const y of s){const b=Yg(t-y.x,r,c,d)+y.badness;b<=g&&(f=y,g=b)}return{index:e,x:t,priorBreak:f,badness:g}}function Fp(e){return e?Fp(e.priorBreak).concat(e.index):[]}function U0(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function I1(e,t,r,s,c){if(!(t||r||s||c))return;const d=e.length-1,f=e[d],g=(f.x+f.metrics.advance*f.scale)*t;for(let y=0;y<=d;y++)e[y].x-=g,e[y].y+=r+s+c}function tO(e,t,r,s){const{horizontalAlign:c,verticalAlign:d}=U0(s),f=r[0]-e.displaySize[0]*c,g=r[1]-e.displaySize[1]*d;return{imagePrimary:e,imageSecondary:t,top:g,bottom:g+e.displaySize[1],left:f,right:f+e.displaySize[0]}}function tC(e,t,r,s,c,d){const f=e.imagePrimary;let g;if(f.content){const u=f.content,p=f.pixelRatio||1;g=[u[0]/p,u[1]/p,f.displaySize[0]-u[2]/p,f.displaySize[1]-u[3]/p]}const y=t.left*d,b=t.right*d;let C,P,E,I;"width"===r||"both"===r?(I=c[0]+y-s[3],P=c[0]+b+s[1]):(I=c[0]+(y+b-f.displaySize[0])/2,P=I+f.displaySize[0]);const A=t.top*d,l=t.bottom*d;return"height"===r||"both"===r?(C=c[1]+A-s[0],E=c[1]+l+s[2]):(C=c[1]+(A+l-f.displaySize[1])/2,E=C+f.displaySize[1]),{imagePrimary:f,imageSecondary:void 0,top:C,right:P,bottom:E,left:I,collisionPadding:g}}class Yd extends tt{constructor(t,r,s,c,d){super(t,r),this.angle=c,this.z=s,void 0!==d&&(this.segment=d)}clone(){return new Yd(this.x,this.y,this.z,this.angle,this.segment)}}function V0(e,t,r,s,c){if(void 0===t.segment)return!0;let d=t,f=t.segment+1,g=0;for(;g>-r/2;){if(f--,f<0)return!1;g-=e[f].dist(d),d=e[f]}g+=e[f].dist(e[f+1]),f++;const y=[];let b=0;for(;g<r/2;){const C=e[f],P=e[f+1];if(!P)return!1;let E=e[f-1].angleTo(C)-C.angleTo(P);for(E=Math.abs((E+3*Math.PI)%(2*Math.PI)-Math.PI),y.push({distance:g,angleDelta:E}),b+=E;g-y[0].distance>s;)b-=y.shift().angleDelta;if(b>c)return!1;f++,g+=C.dist(P)}return!0}function _f(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Qg(e,t,r){return e?.6*t*r:0}function H_(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function q_(e,t,r,s,c,d){const f=Qg(r,c,d),g=H_(r,s)*d;let y=0;const b=_f(e)/2;for(let C=0;C<e.length-1;C++){const P=e[C],E=e[C+1],I=P.dist(E);if(y+I>b){const A=(b-y)/I,l=vn(P.x,E.x,A),u=vn(P.y,E.y,A),p=new Yd(l,u,0,E.angleTo(P),C);return!f||V0(e,p,g,f,t)?p:void 0}y+=I}}function eO(e,t,r,s,c,d,f,g,y){const b=Qg(s,d,f),C=H_(s,c),P=C*f,E=0===e[0].x||e[0].x===y||0===e[0].y||e[0].y===y;return t-P<t/4&&(t=P+t/4),nO(e,E?t/2*g%t:(C/2+2*d)*f*g%t,t,b,r,P,E,!1,y)}function nO(e,t,r,s,c,d,f,g,y){const b=d/2,C=_f(e);let P=0,E=t-r,I=[];for(let A=0;A<e.length-1;A++){const l=e[A],u=e[A+1],p=l.dist(u),m=u.angleTo(l);for(;E+r<P+p;){E+=r;const v=(E-P)/p,M=vn(l.x,u.x,v),O=vn(l.y,u.y,v);if(M>=0&&M<y&&O>=0&&O<y&&E-b>=0&&E+b<=C){const T=new Yd(M,O,0,m,A);s&&!V0(e,T,d,s,c)||I.push(T)}}P+=p}return g||I.length||f||(I=nO(e,P/2,r,s,c,d,f,!0,y)),I}function yf(e,t,r,s,c){const d=[];for(let f=0;f<e.length;f++){const g=e[f];let y;for(let b=0;b<g.length-1;b++){let C=g[b],P=g[b+1];C.x<t&&P.x<t||(C.x<t?C=new tt(t,C.y+(t-C.x)/(P.x-C.x)*(P.y-C.y))._round():P.x<t&&(P=new tt(t,C.y+(t-C.x)/(P.x-C.x)*(P.y-C.y))._round()),C.y<r&&P.y<r||(C.y<r?C=new tt(C.x+(r-C.y)/(P.y-C.y)*(P.x-C.x),r)._round():P.y<r&&(P=new tt(C.x+(r-C.y)/(P.y-C.y)*(P.x-C.x),r)._round()),C.x>=s&&P.x>=s||(C.x>=s?C=new tt(s,C.y+(s-C.x)/(P.x-C.x)*(P.y-C.y))._round():P.x>=s&&(P=new tt(s,C.y+(s-C.x)/(P.x-C.x)*(P.y-C.y))._round()),C.y>=c&&P.y>=c||(C.y>=c?C=new tt(C.x+(c-C.y)/(P.y-C.y)*(P.x-C.x),c)._round():P.y>=c&&(P=new tt(C.x+(c-C.y)/(P.y-C.y)*(P.x-C.x),c)._round()),y&&C.equals(y[y.length-1])||(y=[C],d.push(y)),y.push(P)))))}}return d}function S1(e){let t=0,r=0;for(const f of e)t+=f.w*f.h,r=Math.max(r,f.w);e.sort((f,g)=>g.h-f.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let c=0,d=0;for(const f of e)for(let g=s.length-1;g>=0;g--){const y=s[g];if(!(f.w>y.w||f.h>y.h)){if(f.x=y.x,f.y=y.y,d=Math.max(d,f.y+f.h),c=Math.max(c,f.x+f.w),f.w===y.w&&f.h===y.h){const b=s.pop();g<s.length&&(s[g]=b)}else f.h===y.h?(y.x+=f.w,y.w-=f.w):f.w===y.w?(y.y+=f.h,y.h-=f.h):(s.push({x:y.x+f.w,y:y.y,w:y.w-f.w,h:f.h}),y.y+=f.h,y.h-=f.h);break}}return{w:c,h:d,fill:t/(c*d)||0}}De(Yd,"Anchor");const Bs=1;class eC{constructor(t,{pixelRatio:r,version:s,stretchX:c,stretchY:d,content:f}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=c,this.stretchY=d,this.content=f,this.version=s}get tl(){return[this.paddedRect.x+Bs,this.paddedRect.y+Bs]}get br(){return[this.paddedRect.x+this.paddedRect.w-Bs,this.paddedRect.y+this.paddedRect.h-Bs]}get displaySize(){return[(this.paddedRect.w-2*Bs)/this.pixelRatio,(this.paddedRect.h-2*Bs)/this.pixelRatio]}}class A1{constructor(t,r){const s={},c={};this.haveRenderCallbacks=[];const d=[];this.addImages(t,s,d),this.addImages(r,c,d);const{w:f,h:g}=S1(d),y=new Ui({width:f||1,height:g||1});for(const b in t){const C=t[b],P=s[b].paddedRect;Ui.copy(C.data,y,{x:0,y:0},{x:P.x+Bs,y:P.y+Bs},C.data)}for(const b in r){const C=r[b],P=c[b].paddedRect,E=P.x+Bs,I=P.y+Bs,A=C.data.width,l=C.data.height;Ui.copy(C.data,y,{x:0,y:0},{x:E,y:I},C.data),Ui.copy(C.data,y,{x:0,y:l-1},{x:E,y:I-1},{width:A,height:1}),Ui.copy(C.data,y,{x:0,y:0},{x:E,y:I+l},{width:A,height:1}),Ui.copy(C.data,y,{x:A-1,y:0},{x:E-1,y:I},{width:1,height:l}),Ui.copy(C.data,y,{x:0,y:0},{x:E+A,y:I},{width:1,height:l})}this.image=y,this.iconPositions=s,this.patternPositions=c}addImages(t,r,s){for(const c in t){const d=t[c],f={x:0,y:0,w:d.data.width+2*Bs,h:d.data.height+2*Bs};s.push(f),r[c]=new eC(f,d),d.hasRenderCallback&&this.haveRenderCallbacks.push(c)}}patchUpdatedImages(t,r,s){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>t.hasImage(c,s)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,s);for(const c in t.getUpdatedImages(s))this.patchUpdatedImage(this.iconPositions[c],t.getImage(c,s),r),this.patchUpdatedImage(this.patternPositions[c],t.getImage(c,s),r)}patchUpdatedImage(t,r,s){if(!t||!r||t.version===r.version)return;t.version=r.version;const[c,d]=t.tl;s.update(r.data,void 0,{x:c,y:d})}}De(eC,"ImagePosition"),De(A1,"ImageAtlas");const Jg=1e20;function D1(e,t,r,s,c,d,f,g,y){for(let b=t;b<t+s;b++)zp(e,r*d+b,d,c,f,g,y);for(let b=r;b<r+c;b++)zp(e,b*d+t,1,s,f,g,y)}function zp(e,t,r,s,c,d,f){d[0]=0,f[0]=-Jg,f[1]=Jg,c[0]=e[t];for(let g=1,y=0,b=0;g<s;g++){c[g]=e[t+g*r];const C=g*g;do{const P=d[y];b=(c[g]-c[P]+C-P*P)/(g-P)/2}while(b<=f[y]&&--y>-1);y++,d[y]=g,f[y]=b,f[y+1]=Jg}for(let g=0,y=0;g<s;g++){for(;f[y+1]<g;)y++;const b=d[y],C=g-b;e[t+g*r]=c[b]+C*C}}const Ti=2;class Xd{constructor(t,r,s){this.requestManager=t,this.localGlyphMode=r,this.localFontFamily=s,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,r){this.urls[r]=t}getGlyphs(t,r,s){const c=[],d=this.urls[r]||ue.GLYPHS_URL;for(const f in t)for(const g of t[f])c.push({stack:f,id:g});Kt(c,({stack:f,id:g},y)=>{let b=this.entries[f];b||(b=this.entries[f]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let C=b.glyphs[g];if(void 0!==C)return void y(null,{stack:f,id:g,glyph:C});if(C=this._tinySDF(b,f,g),C)return b.glyphs[g]=C,void y(null,{stack:f,id:g,glyph:C});const P=Math.floor(g/256);if(256*P>65535)return void y(new Error("glyphs > 65535 not supported"));if(b.ranges[P])return void y(null,{stack:f,id:g,glyph:C});let E=b.requests[P];E||(E=b.requests[P]=[],Xd.loadGlyphRange(f,P,d,this.requestManager,(I,A)=>{if(A){b.ascender=A.ascender,b.descender=A.descender;for(const l in A.glyphs)this._doesCharSupportLocalGlyph(+l)||(b.glyphs[+l]=A.glyphs[+l]);b.ranges[P]=!0}for(const l of E)l(I,A);delete b.requests[P]})),E.push((I,A)=>{I?y(I):A&&y(null,{stack:f,id:g,glyph:A.glyphs[g]||null})})},(f,g)=>{if(f)s(f);else if(g){const y={};for(const{stack:b,id:C,glyph:P}of g)void 0===y[b]&&(y[b]={}),void 0===y[b].glyphs&&(y[b].glyphs={}),y[b].glyphs[C]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics},y[b].ascender=this.entries[b].ascender,y[b].descender=this.entries[b].descender;s(null,y)}})}_doesCharSupportLocalGlyph(t){return 0!==this.localGlyphMode&&(2===this.localGlyphMode?!!this.localFontFamily:!!this.localFontFamily&&(V["CJK Unified Ideographs"](t)||V["Hangul Syllables"](t)||V.Hiragana(t)||V.Katakana(t)||V["CJK Symbols and Punctuation"](t)||V["CJK Unified Ideographs Extension A"](t)||V["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,r,s){const c=this.localFontFamily;if(!c||!this._doesCharSupportLocalGlyph(s))return;let d=t.tinySDF;if(!d){let l="400";/bold/i.test(r)?l="900":/medium/i.test(r)?l="500":/light/i.test(r)&&(l="200"),d=t.tinySDF=new Xd.TinySDF({fontFamily:c,fontWeight:l,fontSize:24*Ti,buffer:3*Ti,radius:8*Ti}),d.fontWeight=l}if(this.localGlyphs[d.fontWeight][s])return this.localGlyphs[d.fontWeight][s];const f=String.fromCodePoint(s),{data:g,width:y,height:b,glyphWidth:C,glyphHeight:P,glyphLeft:E,glyphTop:I,glyphAdvance:A}=d.draw(f);return this.localGlyphs[d.fontWeight][s]={id:s,bitmap:new cf({width:y,height:b},g),metrics:{width:C/Ti,height:P/Ti,left:E/Ti,top:I/Ti-27,advance:A/Ti,localGlyph:!0}}}}Xd.loadGlyphRange=function(e,t,r,s,c){const d=256*t,f=d+255,g=s.transformRequest(s.normalizeGlyphsURL(r).replace("{fontstack}",e).replace("{range}",`${d}-${f}`),Ft.Glyphs);ve(g,(y,b)=>{if(y)c(y);else if(b){const C={},P=new k0(b).readFields(Zd,{});for(const E of P.glyphs)C[E.id]=E;c(null,{glyphs:C,ascender:P.ascender,descender:P.descender})}})},Xd.TinySDF=class{constructor({fontSize:e=24,buffer:t=3,radius:r=8,cutoff:s=.25,fontFamily:c="sans-serif",fontWeight:d="normal",fontStyle:f="normal"}={}){this.buffer=t,this.cutoff=s,this.radius=r;const g=this.size=e+4*t,y=this._createCanvas(g),b=this.ctx=y.getContext("2d",{willReadFrequently:!0});b.font=`${f} ${d} ${e}px ${c}`,b.textBaseline="alphabetic",b.textAlign="left",b.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Uint16Array(g)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:s,actualBoundingBoxLeft:c,actualBoundingBoxRight:d}=this.ctx.measureText(e),f=Math.ceil(r),g=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(d-c))),y=Math.min(this.size-this.buffer,f+Math.ceil(s)),b=g+2*this.buffer,C=y+2*this.buffer,P=Math.max(b*C,0),E=new Uint8ClampedArray(P),I={data:E,width:b,height:C,glyphWidth:g,glyphHeight:y,glyphTop:f,glyphLeft:0,glyphAdvance:t};if(0===g||0===y)return I;const{ctx:A,buffer:l,gridInner:u,gridOuter:p}=this;A.clearRect(l,l,g,y),A.fillText(e,l,l+f);const m=A.getImageData(l,l,g,y);p.fill(Jg,0,P),u.fill(0,0,P);for(let v=0;v<y;v++)for(let M=0;M<g;M++){const O=m.data[4*(v*g+M)+3]/255;if(0===O)continue;const T=(v+l)*b+M+l;if(1===O)p[T]=0,u[T]=Jg;else{const k=.5-O;p[T]=k>0?k*k:0,u[T]=k<0?k*k:0}}D1(p,0,0,b,C,b,this.f,this.v,this.z),D1(u,l,l,g,y,b,this.f,this.v,this.z);for(let v=0;v<P;v++){const M=Math.sqrt(p[v])-Math.sqrt(u[v]);E[v]=Math.round(255-255*(M/this.radius+this.cutoff))}return I}};const hl=Bs;function Bp(e,t,r,s){const c=[],d=e.imagePrimary,f=d.pixelRatio,g=d.paddedRect.w-2*hl,y=d.paddedRect.h-2*hl,b=e.right-e.left,C=e.bottom-e.top,P=d.stretchX||[[0,g]],E=d.stretchY||[[0,y]],I=(q,Z)=>q+Z[1]-Z[0],A=P.reduce(I,0),l=E.reduce(I,0),u=g-A,p=y-l;let m=0,v=A,M=0,O=l,T=0,k=u,N=0,F=p;if(d.content&&s){const q=d.content;m=Up(P,0,q[0]),M=Up(E,0,q[1]),v=Up(P,q[0],q[2]),O=Up(E,q[1],q[3]),T=q[0]-m,N=q[1]-M,k=q[2]-q[0]-v,F=q[3]-q[1]-O}const $=(q,Z,X,K)=>{const J=Zc(q.stretch-m,v,b,e.left),st=Z_(q.fixed-T,k,q.stretch,A),it=Zc(Z.stretch-M,O,C,e.top),rt=Z_(Z.fixed-N,F,Z.stretch,l),ct=Zc(X.stretch-m,v,b,e.left),yt=Z_(X.fixed-T,k,X.stretch,A),Et=Zc(K.stretch-M,O,C,e.top),Tt=Z_(K.fixed-N,F,K.stretch,l),zt=new tt(J,it),Nt=new tt(ct,it),$t=new tt(ct,Et),Rt=new tt(J,Et),oe=new tt(st/f,rt/f),Oe=new tt(yt/f,Tt/f),Ee=t*Math.PI/180;if(Ee){const ln=Math.sin(Ee),Ln=Math.cos(Ee),En=[Ln,-ln,ln,Ln];zt._matMult(En),Nt._matMult(En),Rt._matMult(En),$t._matMult(En)}const Be=q.stretch+q.fixed,je=X.stretch+X.fixed,On=Z.stretch+Z.fixed,Qe=K.stretch+K.fixed,nr=e.imageSecondary;return{tl:zt,tr:Nt,bl:Rt,br:$t,texPrimary:{x:d.paddedRect.x+hl+Be,y:d.paddedRect.y+hl+On,w:je-Be,h:Qe-On},texSecondary:nr?{x:nr.paddedRect.x+hl+Be,y:nr.paddedRect.y+hl+On,w:je-Be,h:Qe-On}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:oe,pixelOffsetBR:Oe,minFontScaleX:k/f/b,minFontScaleY:F/f/C,isSDF:r}};if(s&&(d.stretchX||d.stretchY)){const q=j0(P,u,A),Z=j0(E,p,l);for(let X=0;X<q.length-1;X++){const K=q[X],J=q[X+1];for(let st=0;st<Z.length-1;st++)c.push($(K,Z[st],J,Z[st+1]))}}else c.push($({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:g+1},{fixed:0,stretch:y+1}));return c}function Up(e,t,r){let s=0;for(const c of e)s+=Math.max(t,Math.min(r,c[1]))-Math.max(t,Math.min(r,c[0]));return s}function j0(e,t,r){const s=[{fixed:-hl,stretch:0}];for(const[c,d]of e){const f=s[s.length-1];s.push({fixed:c-f.stretch,stretch:f.stretch}),s.push({fixed:c-f.stretch,stretch:f.stretch+(d-c)})}return s.push({fixed:t+hl,stretch:r}),s}function Zc(e,t,r,s){return e/t*r+s}function Z_(e,t,r,s){return e-t*r/s}function rO(e,t,r,s){const c=t+e.positionedLines[s].lineOffset;return 0===s?r+c/2:r+(c+(t+e.positionedLines[s-1].lineOffset))/2}function $0(e,t=1,r=!1){let s=1/0,c=1/0,d=-1/0,f=-1/0;const g=e[0];for(let I=0;I<g.length;I++){const A=g[I];(!I||A.x<s)&&(s=A.x),(!I||A.y<c)&&(c=A.y),(!I||A.x>d)&&(d=A.x),(!I||A.y>f)&&(f=A.y)}const y=Math.min(d-s,f-c);let b=y/2;const C=new Ch([],vf);if(0===y)return new tt(s,c);for(let I=s;I<d;I+=y)for(let A=c;A<f;A+=y)C.push(new W_(I+b,A+b,b,e));let P=function(I){let A=0,l=0,u=0;const p=I[0];for(let m=0,v=p.length,M=v-1;m<v;M=m++){const O=p[m],T=p[M],k=O.x*T.y-T.x*O.y;l+=(O.x+T.x)*k,u+=(O.y+T.y)*k,A+=3*k}return new W_(l/A,u/A,0,I)}(e),E=C.length;for(;C.length;){const I=C.pop();(I.d>P.d||!P.d)&&(P=I,r&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,E)),I.max-P.d<=t||(b=I.h/2,C.push(new W_(I.p.x-b,I.p.y-b,b,e)),C.push(new W_(I.p.x+b,I.p.y-b,b,e)),C.push(new W_(I.p.x-b,I.p.y+b,b,e)),C.push(new W_(I.p.x+b,I.p.y+b,b,e)),E+=4)}return r&&(console.log(`num probes: ${E}`),console.log(`best distance: ${P.d}`)),P.p}function vf(e,t){return t.max-e.max}class W_{constructor(t,r,s,c){this.p=new tt(t,r),this.h=s,this.d=function(d,f){let g=!1,y=1/0;for(let b=0;b<f.length;b++){const C=f[b];for(let P=0,E=C.length,I=E-1;P<E;I=P++){const A=C[P],l=C[I];A.y>d.y!=l.y>d.y&&d.x<(l.x-A.x)*(d.y-A.y)/(l.y-A.y)+A.x&&(g=!g),y=Math.min(y,Uw(d,A,l))}}return(g?1:-1)*Math.sqrt(y)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}}const Us=7,k1=Number.POSITIVE_INFINITY,tm=Math.sqrt(2);function em(e,[t,r]){let s=0,c=0;if(r===k1){t<0&&(t=0);const d=t/tm;switch(e){case"top-right":case"top-left":c=d-Us;break;case"bottom-right":case"bottom-left":c=-d+Us;break;case"bottom":c=-t+Us;break;case"top":c=t-Us}switch(e){case"top-right":case"bottom-right":s=-d;break;case"top-left":case"bottom-left":s=d;break;case"left":s=t;break;case"right":s=-t}}else{switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":c=r-Us;break;case"bottom-right":case"bottom-left":case"bottom":c=-r+Us}switch(e){case"top-right":case"bottom-right":case"right":s=-t;break;case"top-left":case"bottom-left":case"left":s=t}}return[s,c]}function hc(e,t,r,s,c,d,f,g,y,b,C){e.createArrays(),e.tilePixelRatio=Dt/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;const P=e.layers[0].layout,E=e.layers[0]._unevaluatedLayout._values,I={};if("composite"===e.textSizeData.kind){const{minZoom:p,maxZoom:m}=e.textSizeData;I.compositeTextSizes=[E["text-size"].possiblyEvaluate(new Lo(p),g),E["text-size"].possiblyEvaluate(new Lo(m),g)]}if("composite"===e.iconSizeData.kind){const{minZoom:p,maxZoom:m}=e.iconSizeData;I.compositeIconSizes=[E["icon-size"].possiblyEvaluate(new Lo(p),g),E["icon-size"].possiblyEvaluate(new Lo(m),g)]}I.layoutTextSize=E["text-size"].possiblyEvaluate(new Lo(y+1),g),I.layoutIconSize=E["icon-size"].possiblyEvaluate(new Lo(y+1),g),I.textMaxSize=E["text-size"].possiblyEvaluate(new Lo(18),g);const A="map"===P.get("text-rotation-alignment")&&"point"!==P.get("symbol-placement"),l=P.get("text-size");let u=!1;for(const p of e.features)if(p.icon&&p.icon.nameSecondary){u=!0;break}for(const p of e.features){const m=P.get("text-font").evaluate(p,{},g).join(","),v=l.evaluate(p,{},g),M=I.layoutTextSize.evaluate(p,{},g),O=(I.layoutIconSize.evaluate(p,{},g),{horizontal:{},vertical:void 0}),T=p.text;let k,N=[0,0];if(T){const q=T.toString(),Z=P.get("text-letter-spacing").evaluate(p,{},g)*os,X=P.get("text-line-height").evaluate(p,{},g)*os,K=ut(q)?Z:0,J=P.get("text-anchor").evaluate(p,{},g),st=P.get("text-variable-anchor");if(!st){const Et=P.get("text-radial-offset").evaluate(p,{},g);N=Et?em(J,[Et*os,k1]):P.get("text-offset").evaluate(p,{},g).map(Tt=>Tt*os)}let it=A?"center":P.get("text-justify").evaluate(p,{},g);const rt="point"===P.get("symbol-placement"),ct=rt?P.get("text-max-width").evaluate(p,{},g)*os:1/0,yt=Et=>{e.allowVerticalPlacement&&W(q)&&(O.vertical=Wd(T,t,r,c,m,ct,X,J,Et,K,N,so.vertical,!0,M,v))};if(!A&&st){const Et="auto"===it?st.map(zt=>nC(zt)):[it];let Tt=!1;for(let zt=0;zt<Et.length;zt++){const Nt=Et[zt];if(!O.horizontal[Nt])if(Tt)O.horizontal[Nt]=O.horizontal[0];else{const $t=Wd(T,t,r,c,m,ct,X,"center",Nt,K,N,so.horizontal,!1,M,v);$t&&(O.horizontal[Nt]=$t,Tt=1===$t.positionedLines.length)}}yt("left")}else{if("auto"===it&&(it=nC(J)),rt||P.get("text-writing-mode").indexOf("horizontal")>=0||!W(q)){const Et=Wd(T,t,r,c,m,ct,X,J,it,K,N,so.horizontal,!1,M,v);Et&&(O.horizontal[it]=Et)}yt(rt?"left":it)}}let F=!1;if(p.icon&&p.icon.namePrimary){const q=s[p.icon.namePrimary];q&&(k=tO(c[p.icon.namePrimary],p.icon.nameSecondary?c[p.icon.nameSecondary]:void 0,P.get("icon-offset").evaluate(p,{},g),P.get("icon-anchor").evaluate(p,{},g)),F=q.sdf,void 0===e.sdfIcons?e.sdfIcons=q.sdf:e.sdfIcons!==q.sdf&&gt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(q.pixelRatio!==e.pixelRatio||0!==P.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}const $=rC(O.horizontal)||O.vertical;e.iconsInText||(e.iconsInText=!!$&&$.iconsInText),($||k)&&G0(e,p,O,k,s,I,M,0,N,F,f,g,b,C,u)}d&&e.generateCollisionDebugBuffers(y,e.collisionBoxArray)}function nC(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function G0(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A){let l=d.textMaxSize.evaluate(t,{},P);void 0===l&&(l=f);const u=e.layers[0].layout,p=u.get("icon-offset").evaluate(t,{},P),m=rC(r.horizontal)||r.vertical,v="globe"===E.name,M=os,O=f/M,T=e.tilePixelRatio*l/M,k=(J=e.overscaling,e.zoom>18&&J>2&&(J>>=1),Math.max(Dt/(512*J),1)*u.get("symbol-spacing")),N=u.get("text-padding")*e.tilePixelRatio,F=u.get("icon-padding")*e.tilePixelRatio,$=Ct(u.get("text-max-angle")),q="map"===u.get("text-rotation-alignment")&&"point"!==u.get("symbol-placement"),Z="map"===u.get("icon-rotation-alignment")&&"point"!==u.get("symbol-placement"),X=u.get("symbol-placement"),K=k/2;var J;const st=u.get("icon-text-fit").evaluate(t,{},P),it=u.get("icon-text-fit-padding").evaluate(t,{},P),rt="none"!==st;let ct;!1===e.hasAnyIconTextFit&&rt&&(e.hasAnyIconTextFit=!0),s&&rt&&(e.allowVerticalPlacement&&r.vertical&&(ct=tC(s,r.vertical,st,it,p,O)),m&&(s=tC(s,m,st,it,p,O)));const yt=(Et,Tt,zt)=>{if(Tt.x<0||Tt.x>=Dt||Tt.y<0||Tt.y>=Dt)return;let Nt=null;if(v){const{x:$t,y:Rt,z:oe}=E.projectTilePoint(Tt.x,Tt.y,zt);Nt={anchor:new Yd($t,Rt,oe,0,void 0),up:E.upVector(zt,Tt.x,Tt.y)}}!function($t,Rt,oe,Oe,Ee,Be,je,On,Qe,nr,ln,Ln,En,mn,wr,Lr,rr,Kr,Ao,mo,Fo,$i,Ii,Ho,Gr,Si,zf){const ls=$t.addToLineVertexArray(Rt,Oe);let Ll,BM,UM,VM,k2,R2,L2,N2=0,F2=0,z2=0,B2=0,rw=-1,UE=-1;const Bf={};let U2=rl("");const Ly=oe?oe.anchor:Rt,V2="none"!==Qe.layout.get("icon-text-fit").evaluate(Fo,{},Gr);let VE=0,jE=0;if(void 0===Qe._unevaluatedLayout.getValue("text-radial-offset")?[VE,jE]=Qe.layout.get("text-offset").evaluate(Fo,{},Gr).map(bc=>bc*os):(VE=Qe.layout.get("text-radial-offset").evaluate(Fo,{},Gr)*os,jE=k1),$t.allowVerticalPlacement&&Ee.vertical){const bc=Ee.vertical;if(wr)R2=R1(bc),On&&(L2=R1(On));else{const xc=Qe.layout.get("text-rotate").evaluate(Fo,{},Gr)+90;UM=K_(nr,Ly,Rt,ln,Ln,En,bc,mn,xc,Lr),On&&(VM=K_(nr,Ly,Rt,ln,Ln,En,On,Kr,xc))}}if(Be){const bc=Qe.layout.get("icon-rotate").evaluate(Fo,{},Gr),xc=Bp(Be,bc,Ii,V2),ob=On?Bp(On,bc,Ii,V2):void 0;BM=K_(nr,Ly,Rt,ln,Ln,En,Be,Kr,bc),N2=4*xc.length;const GE=$t.iconSizeData;let og=null;"source"===GE.kind?(og=[Ku*Qe.layout.get("icon-size").evaluate(Fo,{},Gr)],og[0]>Qd&&gt(`${$t.layerIds[0]}: Value for "icon-size" is >= ${H0}. Reduce your "icon-size".`)):"composite"===GE.kind&&(og=[Ku*$i.compositeIconSizes[0].evaluate(Fo,{},Gr),Ku*$i.compositeIconSizes[1].evaluate(Fo,{},Gr)],(og[0]>Qd||og[1]>Qd)&&gt(`${$t.layerIds[0]}: Value for "icon-size" is >= ${H0}. Reduce your "icon-size".`)),$t.addSymbols($t.icon,xc,og,mo,Ao,Fo,!1,oe,Rt,ls.lineStartIndex,ls.lineLength,-1,Ho,Gr,Si,zf),rw=$t.icon.placedSymbolArray.length-1,ob&&(F2=4*ob.length,$t.addSymbols($t.icon,ob,og,mo,Ao,Fo,so.vertical,oe,Rt,ls.lineStartIndex,ls.lineLength,-1,Ho,Gr,Si,zf),UE=$t.icon.placedSymbolArray.length-1)}for(const bc in Ee.horizontal){const xc=Ee.horizontal[bc];Ll||(U2=rl(xc.text),wr?k2=R1(xc):Ll=K_(nr,Ly,Rt,ln,Ln,En,xc,mn,Qe.layout.get("text-rotate").evaluate(Fo,{},Gr),Lr));const ob=1===xc.positionedLines.length;if(z2+=Hr($t,oe,Rt,xc,je,Qe,wr,Fo,Lr,ls,Ee.vertical?so.horizontal:so.horizontalOnly,ob?Object.keys(Ee.horizontal):[bc],Bf,rw,$i,Ho,Gr,Si),ob)break}Ee.vertical&&(B2+=Hr($t,oe,Rt,Ee.vertical,je,Qe,wr,Fo,Lr,ls,so.vertical,["vertical"],Bf,UE,$i,Ho,Gr,Si));let rg=-1;const $E=(bc,xc)=>bc?Math.max(bc,xc):xc;rg=$E(k2,rg),rg=$E(R2,rg),rg=$E(L2,rg);const j2=rg>-1?1:0;$t.glyphOffsetArray.length>=xf.MAX_GLYPHS&&gt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Fo.sortKey&&$t.addToSortKeyRanges($t.symbolInstances.length,Fo.sortKey),$t.symbolInstances.emplaceBack(Rt.x,Rt.y,Ly.x,Ly.y,Ly.z,Bf.right>=0?Bf.right:-1,Bf.center>=0?Bf.center:-1,Bf.left>=0?Bf.left:-1,Bf.vertical>=0?Bf.vertical:-1,rw,UE,U2,void 0!==Ll?Ll:$t.collisionBoxArray.length,void 0!==Ll?Ll+1:$t.collisionBoxArray.length,void 0!==UM?UM:$t.collisionBoxArray.length,void 0!==UM?UM+1:$t.collisionBoxArray.length,void 0!==BM?BM:$t.collisionBoxArray.length,void 0!==BM?BM+1:$t.collisionBoxArray.length,VM||$t.collisionBoxArray.length,VM?VM+1:$t.collisionBoxArray.length,ln,z2,B2,N2,F2,j2,0,VE,jE,rg,0,V2?1:0)}(e,Tt,Nt,Et,r,s,c,ct,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,N,q,y,0,F,Z,p,t,d,b,C,P,I,A)};if("line"===X)for(const Et of yf(t.geometry,0,0,Dt,Dt)){const Tt=eO(Et,k,$,r.vertical||m,s,M,T,e.overscaling,Dt);for(const zt of Tt)m&&oC(e,m.text,K,zt)||yt(Et,zt,P)}else if("line-center"===X){for(const Et of t.geometry)if(Et.length>1){const Tt=q_(Et,$,r.vertical||m,s,M,T);Tt&&yt(Et,Tt,P)}}else if("Polygon"===t.type)for(const Et of Vg(t.geometry,0)){const Tt=$0(Et,16);yt(Et[0],new Yd(Tt.x,Tt.y,0,0,void 0),P)}else if("LineString"===t.type)for(const Et of t.geometry)yt(Et,new Yd(Et[0].x,Et[0].y,0,0,void 0),P);else if("Point"===t.type)for(const Et of t.geometry)for(const Tt of Et)yt([Tt],new Yd(Tt.x,Tt.y,0,0,void 0),P)}const H0=255,Qd=H0*Ku;function Hr(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p){const m=function(O,T,k,N,F,$,q,Z){const X=[];if(0===T.positionedLines.length)return X;const K=N.layout.get("text-rotate").evaluate($,{})*Math.PI/180,J=function(yt){const Et=yt[0],Tt=yt[1],zt=Et*Tt;return zt>0?[Et,-Tt]:zt<0?[-Et,Tt]:0===Et?[Tt,Et]:[Tt,-Et]}(k);let st=Math.abs(T.top-T.bottom);for(const yt of T.positionedLines)st-=yt.lineOffset;const it=T.positionedLines.length,rt=st/it;let ct=T.top-k[1];for(let yt=0;yt<it;++yt){const Et=T.positionedLines[yt];ct=rO(T,rt,ct,yt);for(const Tt of Et.positionedGlyphs){if(!Tt.rect)continue;const zt=Tt.rect||{};let Nt=bo+1,$t=!0,Rt=1,oe=0;if(Tt.imageName){const mo=q[Tt.imageName];if(!mo)continue;if(mo.sdf){gt("SDF images are not supported in formatted text and will be ignored.");continue}$t=!1,Rt=mo.pixelRatio,Nt=Bs/Rt}const Oe=(F||Z)&&Tt.vertical,Ee=Tt.metrics.advance*Tt.scale/2,Be=Tt.metrics,je=Tt.rect;if(null===je)continue;Z&&T.verticalizable&&(oe=Tt.imageName?Ee-Tt.metrics.width*Tt.scale/2:0);const On=F?[Tt.x+Ee,Tt.y]:[0,0];let Qe=[0,0],nr=[0,0],ln=!1;F||(Oe?(nr=[Tt.x+Ee+J[0],Tt.y+J[1]-oe],ln=!0):Qe=[Tt.x+Ee+k[0],Tt.y+k[1]-oe]);const Ln=je.w*Tt.scale/(Rt*(Tt.localGlyph?Ti:1)),En=je.h*Tt.scale/(Rt*(Tt.localGlyph?Ti:1));let mn,wr,Lr,rr;if(Oe){const mo=Tt.y-ct,Fo=new tt(-Ee,Ee-mo),$i=-Math.PI/2,Ii=new tt(...nr);mn=new tt(-Ee+Qe[0],Qe[1]),mn._rotateAround($i,Fo)._add(Ii),mn.x+=-mo+Ee,mn.y-=(Be.left-Nt)*Tt.scale;const Ho=Tt.imageName?Be.advance*Tt.scale:os*Tt.scale,Gr=String.fromCodePoint(Tt.glyph);JP(Gr)?mn.x+=(1-Nt)*Tt.scale:T1(Gr)?mn.x+=Ho-Be.height*Tt.scale+(-Nt-1)*Tt.scale:mn.x+=Tt.imageName||Be.width+2*Nt===je.w&&Be.height+2*Nt===je.h?(Ho-En)/2:(Ho-(Be.height+2*Nt)*Tt.scale)/2,wr=new tt(mn.x,mn.y-Ln),Lr=new tt(mn.x+En,mn.y),rr=new tt(mn.x+En,mn.y-Ln)}else{const mo=(Be.left-Nt)*Tt.scale-Ee+Qe[0],Fo=(-Be.top-Nt)*Tt.scale+Qe[1],$i=mo+Ln,Ii=Fo+En;mn=new tt(mo,Fo),wr=new tt($i,Fo),Lr=new tt(mo,Ii),rr=new tt($i,Ii)}if(K){let mo;mo=F?new tt(0,0):ln?new tt(J[0],J[1]):new tt(k[0],k[1]),mn._rotateAround(K,mo),wr._rotateAround(K,mo),Lr._rotateAround(K,mo),rr._rotateAround(K,mo)}const Kr=new tt(0,0),Ao=new tt(0,0);X.push({tl:mn,tr:wr,bl:Lr,br:rr,texPrimary:zt,texSecondary:void 0,writingMode:T.writingMode,glyphOffset:On,sectionIndex:Tt.sectionIndex,isSDF:$t,pixelOffsetTL:Kr,pixelOffsetBR:Ao,minFontScaleX:0,minFontScaleY:0})}}return X}(0,s,y,d,f,g,c,e.allowVerticalPlacement),v=e.textSizeData;let M=null;"source"===v.kind?(M=[Ku*d.layout.get("text-size").evaluate(g,{},u)],M[0]>Qd&&gt(`${e.layerIds[0]}: Value for "text-size" is >= ${H0}. Reduce your "text-size".`)):"composite"===v.kind&&(M=[Ku*A.compositeTextSizes[0].evaluate(g,{},u),Ku*A.compositeTextSizes[1].evaluate(g,{},u)],(M[0]>Qd||M[1]>Qd)&&gt(`${e.layerIds[0]}: Value for "text-size" is >= ${H0}. Reduce your "text-size".`)),e.addSymbols(e.text,m,M,y,f,g,C,t,r,b.lineStartIndex,b.lineLength,I,l,u,p,!1);for(const O of P)E[O]=e.text.placedSymbolArray.length-1;return 4*m.length}function rC(e){for(const t in e)return e[t];return null}function K_(e,t,r,s,c,d,f,g,y,b){let C=f.top,P=f.bottom,E=f.left,I=f.right;const A=f.collisionPadding;if(A&&(E-=A[0],C-=A[1],I+=A[2],P+=A[3]),y){const l=new tt(E,C),u=new tt(I,C),p=new tt(E,P),m=new tt(I,P),v=Ct(y);let M=new tt(0,0);b&&(M=new tt(b[0],b[1])),l._rotateAround(v,M),u._rotateAround(v,M),p._rotateAround(v,M),m._rotateAround(v,M),E=Math.min(l.x,u.x,p.x,m.x),I=Math.max(l.x,u.x,p.x,m.x),C=Math.min(l.y,u.y,p.y,m.y),P=Math.max(l.y,u.y,p.y,m.y)}return e.emplaceBack(t.x,t.y,t.z,r.x,r.y,E,C,I,P,g,s,c,d),e.length-1}function R1(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);const t=e.bottom-e.top;return t>0?Math.max(10,t):null}function oC(e,t,r,s){const c=e.compareText;if(t in c){const d=c[t];for(let f=d.length-1;f>=0;f--)if(s.dist(d[f])<r)return!0}else c[t]=[];return c[t].push(s),!1}function L1(e,t){const r=e.fovAboveCenter,s=e.elevation?e.elevation.getMinElevationBelowMSL()*t:0,c=(e._camera.position[2]*e.worldSize-s)/Math.cos(e._pitch),d=Math.sin(r)*c/Math.sin(Math.max(Math.PI/2-e._pitch-r,.01)),f=Math.sin(e._pitch)*d+c;return Math.min(1.01*f,c*(1/e._horizonShift))}function Yu(e,t){if(!t.isReprojectedInTileSpace)return{scale:1<<e.z,x:e.x,y:e.y,x2:e.x+1,y2:e.y+1,projection:t};const r=Math.pow(2,-e.z),s=e.x*r,c=(e.x+1)*r,d=e.y*r,f=(e.y+1)*r,g=ka(s),y=ka(c),b=ti(d),C=ti(f),P=t.project(g,b),E=t.project(y,b),I=t.project(y,C),A=t.project(g,C);let l=Math.min(P.x,E.x,I.x,A.x),u=Math.min(P.y,E.y,I.y,A.y),p=Math.max(P.x,E.x,I.x,A.x),m=Math.max(P.y,E.y,I.y,A.y);const v=r/16;function M(T,k,N,F,$,q){const Z=(N+$)/2,X=(F+q)/2,K=t.project(ka(Z),ti(X)),J=Math.max(0,l-K.x,u-K.y,K.x-p,K.y-m);l=Math.min(l,K.x),p=Math.max(p,K.x),u=Math.min(u,K.y),m=Math.max(m,K.y),J>v&&(M(T,K,N,F,Z,X),M(K,k,Z,X,$,q))}M(P,E,s,d,c,d),M(E,I,c,d,c,f),M(I,A,c,f,s,f),M(A,P,s,f,s,d),l-=v,u-=v,p+=v,m+=v;const O=1/Math.max(p-l,m-u);return{scale:O,x:l*O,y:u*O,x2:p*O,y2:m*O,projection:t}}function oO(e,t,r,s,c,d,f,g,y){if("globe"===y.name)return a1(e,t,new ic(r,s,c),!1);const b=Yu({z:r,x:s,y:c},y);return new yo([(d+b.x/b.scale)*t,t*(b.y/b.scale),f],[(d+b.x2/b.scale)*t,t*(b.y2/b.scale),g])}function iO(e,{x:t,y:r},s=0){return new tt(((t-s)*e.scale-e.x)*Dt,(r*e.scale-e.y)*Dt)}function iC(e,t,r=0){return dt.fromValues(((t.x-r)*e.scale-e.x)*Dt,(t.y*e.scale-e.y)*Dt,LP(t.z,t.y))}const nm=bt.identity(new Float32Array(16));class Na{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,r){return{x:0,y:0,z:0}}unproject(t,r){return new kn(0,0)}projectTilePoint(t,r,s){return{x:t,y:r,z:0}}locationPoint(t,r,s=!0){return t._coordinatePoint(t.locationCoordinate(r),s)}pixelsPerMeter(t,r){return oo(1,t)*r}pixelSpaceConversion(t,r,s){return 1}farthestPixelDistance(t){return L1(t,t.pixelsPerMeter)}pointCoordinate(t,r,s,c){const d=t.horizonLineFromTop(!1),f=new tt(r,Math.max(d,s));return t.rayIntersectionCoordinate(t.pointRayIntersection(f,c))}pointCoordinate3D(t,r,s){const c=new tt(r,s);if(t.elevation)return t.elevation.pointCoordinate(c);{const d=this.pointCoordinate(t,c.x,c.y,0);return[d.x,d.y,d.z]}}isPointAboveHorizon(t,r){if(t.elevation)return!this.pointCoordinate3D(t,r.x,r.y);const s=t.horizonLineFromTop();return r.y<s}createInversionMatrix(t,r){return nm}createTileMatrix(t,r,s){let c,d,f;const g=s.canonical,y=bt.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const b=Yu(g,this);c=1,d=b.x+s.wrap*b.scale,f=b.y,bt.scale(y,y,[c/b.scale,c/b.scale,t.pixelsPerMeter/r])}else c=r/t.zoomScale(g.z),d=(g.x+Math.pow(2,g.z)*s.wrap)*c,f=g.y*c;return bt.translate(y,y,[d,f,0]),bt.scale(y,y,[c/Dt,c/Dt,1]),y}upVector(t,r,s){return[0,0,1]}upVectorScale(t,r,s){return{metersToTile:1}}}class N1 extends Na{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[r,s]=this.parallels=t.parallels||[29.5,45.5],c=Math.sin(Ct(r));this.n=(c+Math.sin(Ct(s)))/2,this.c=1+c*(2*this.n-c),this.r0=Math.sqrt(this.c)/this.n}project(t,r){const{n:s,c,r0:d}=this,f=Ct(t-this.center[0]),g=Ct(r),y=Math.sqrt(c-2*s*Math.sin(g))/s;return{x:y*Math.sin(f*s),y:y*Math.cos(f*s)-d,z:0}}unproject(t,r){const{n:s,c,r0:d}=this,f=d+r;let g=Math.atan2(t,Math.abs(f))*Math.sign(f);f*s<0&&(g-=Math.PI*Math.sign(t)*Math.sign(f));const y=Ct(this.center[0])*s;g=Wt(g,-Math.PI-y,Math.PI-y);const b=Ne(ge(g/s)+this.center[0],-180,180),C=Math.asin(Ne((c-(t*t+f*f)*s*s)/(2*s),-1,1)),P=Ne(ge(C),-vo,vo);return new kn(b,P)}}const Xu=1.340264,bf=-.081106,fc=893e-6,Vp=.003796,Y_=Math.sqrt(3)/2;class q0 extends Na{project(t,r){r=r/180*Math.PI,t=t/180*Math.PI;const s=Math.asin(Y_*Math.sin(r)),c=s*s,d=c*c*c;return{x:.5*(t*Math.cos(s)/(Y_*(Xu+3*bf*c+d*(7*fc+9*Vp*c)))/Math.PI+.5),y:1-.5*(s*(Xu+bf*c+d*(fc+Vp*c))/Math.PI+1),z:0}}unproject(t,r){t=(2*t-.5)*Math.PI;let s=r=(2*(1-r)-1)*Math.PI,c=s*s,d=c*c*c;for(let C,P,E,I=0;I<12&&(P=s*(Xu+bf*c+d*(fc+Vp*c))-r,E=Xu+3*bf*c+d*(7*fc+9*Vp*c),C=P/E,s=Ne(s-C,-Math.PI/3,Math.PI/3),c=s*s,d=c*c*c,!(Math.abs(C)<1e-12));++I);const f=Y_*t*(Xu+3*bf*c+d*(7*fc+9*Vp*c))/Math.cos(s),g=Math.asin(Math.sin(s)/Y_),y=Ne(180*f/Math.PI,-180,180),b=Ne(180*g/Math.PI,-vo,vo);return new kn(y,b)}}class RT extends Na{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,r){return{x:.5+t/360,y:.5-r/360,z:0}}unproject(t,r){const s=360*(t-.5),c=Ne(360*(.5-r),-vo,vo);return new kn(s,c)}}const X_=Math.PI/2;function ei(e){return Math.tan((X_+e)/2)}class Q_ extends Na{constructor(t){super(t),this.center=t.center||[0,30];const[r,s]=this.parallels=t.parallels||[30,30];let c=Ct(r),d=Ct(s);this.southernCenter=c+d<0,this.southernCenter&&(c=-c,d=-d);const f=Math.cos(c),g=ei(c);this.n=c===d?Math.sin(c):Math.log(f/Math.cos(d))/Math.log(ei(d)/g),this.f=f*Math.pow(ei(c),this.n)/this.n}project(t,r){r=Ct(r),this.southernCenter&&(r=-r),t=Ct(t-this.center[0]);const s=1e-6,{n:c,f:d}=this;d>0?r<-X_+s&&(r=-X_+s):r>X_-s&&(r=X_-s);const f=d/Math.pow(ei(r),c);let g=f*Math.sin(c*t),y=d-f*Math.cos(c*t);return g=.5*(g/Math.PI+.5),y=.5*(y/Math.PI+.5),{x:g,y:this.southernCenter?y:1-y,z:0}}unproject(t,r){t=(2*t-.5)*Math.PI,this.southernCenter&&(r=1-r),r=(2*(1-r)-.5)*Math.PI;const{n:s,f:c}=this,d=c-r,f=Math.sign(d),g=Math.sign(s)*Math.sqrt(t*t+d*d);let y=Math.atan2(t,Math.abs(d))*f;d*s<0&&(y-=Math.PI*Math.sign(t)*f);const b=Ne(ge(y/s)+this.center[0],-180,180),C=Ne(ge(2*Math.atan(Math.pow(c/g,1/s))-X_),-vo,vo);return new kn(b,this.southernCenter?-C:C)}}class J_ extends Na{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,r){return{x:yi(t),y:Oo(r),z:0}}unproject(t,r){const s=ka(t),c=ti(r);return new kn(s,c)}}const F1=Ct(vo);class LT extends Na{project(t,r){const s=(r=Ct(r))*r,c=s*s;return{x:.5*((t=Ct(t))*(.8707-.131979*s+c*(c*(.003971*s-.001529*c)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+s*(.015085+c*(.028874*s-.044475-.005916*c)))/Math.PI+1),z:0}}unproject(t,r){t=(2*t-.5)*Math.PI;let s=r=(2*(1-r)-1)*Math.PI,c=25,d=0,f=s*s;do{f=s*s;const b=f*f;d=(s*(1.007226+f*(.015085+b*(.028874*f-.044475-.005916*b)))-r)/(1.007226+f*(.045255+b*(.259866*f-.311325-.005916*11*b))),s=Ne(s-d,-F1,F1)}while(Math.abs(d)>1e-6&&--c>0);f=s*s;const g=Ne(ge(t/(.8707+f*(f*(f*f*f*(.003971-.001529*f)-.013791)-.131979))),-180,180),y=ge(s);return new kn(g,y)}}const ty=Ct(vo);class sO extends Na{project(t,r){r=Ct(r),t=Ct(t);const s=Math.cos(r),c=2/Math.PI,d=Math.acos(s*Math.cos(t/2)),f=Math.sin(d)/d,g=.5*(t*c+2*s*Math.sin(t/2)/f)||0,y=.5*(r+Math.sin(r)/f)||0;return{x:.5*(g/Math.PI+.5),y:1-.5*(y/Math.PI+1),z:0}}unproject(t,r){let s=t=(2*t-.5)*Math.PI,c=r=(2*(1-r)-1)*Math.PI,d=25;const f=1e-6;let g=0,y=0;do{const b=Math.cos(c),C=Math.sin(c),P=2*C*b,E=C*C,I=b*b,A=Math.cos(s/2),l=Math.sin(s/2),u=2*A*l,p=l*l,m=1-I*A*A,v=m?1/m:0,M=m?Math.acos(b*A)*Math.sqrt(1/m):0,O=.5*(2*M*b*l+2*s/Math.PI)-t,T=.5*(M*C+c)-r,k=.5*v*(I*p+M*b*A*E)+1/Math.PI,N=v*(u*P/4-M*C*l),F=.125*v*(P*l-M*C*I*u),$=.5*v*(E*A+M*p*b)+.5,q=N*F-$*k;g=(T*N-O*$)/q,y=(O*F-T*k)/q,s=Ne(s-g,-Math.PI,Math.PI),c=Ne(c-y,-ty,ty)}while((Math.abs(g)>f||Math.abs(y)>f)&&--d>0);return new kn(ge(s),ge(c))}}class Z0 extends Na{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ct(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,r){const{scale:s,cosPhi:c}=this;return{x:Ct(t)*c*s+.5,y:-Math.sin(Ct(r))/c*s+.5,z:0}}unproject(t,r){const{scale:s,cosPhi:c}=this,d=-(r-.5)/s,f=Ne(ge((t-.5)/s)/c,-180,180),g=Math.asin(Ne(d*c,-1,1)),y=Ne(ge(g),-vo,vo);return new kn(f,y)}}class rm extends J_{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,r,s){const c=af(t,r,s),d=lf(Po(s));return dt.transformMat4(c,c,d),{x:c[0],y:c[1],z:c[2]}}locationPoint(t,r){const s=ra(r.lat,r.lng),c=dt.normalize([],s),d=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(r),t._centerAltitude):t._centerAltitude,f=oo(1,0)*Dt*d;dt.scaleAndAdd(s,s,c,f);const g=bt.identity(new Float64Array(16));return bt.multiply(g,t.pixelMatrix,t.globeMatrix),dt.transformMat4(s,s,g),new tt(s[0],s[1])}pixelsPerMeter(t,r){return oo(1,0)*r}pixelSpaceConversion(t,r,s){const c=oo(1,t)*r,d=vn(oo(1,45)*r,c,s);return this.pixelsPerMeter(t,r)/d}createTileMatrix(t,r,s){const c=D_(Po(s.canonical));return bt.multiply(new Float64Array(16),t.globeMatrix,c)}createInversionMatrix(t,r){const{center:s}=t,c=lf(Po(r));return bt.rotateY(c,c,Ct(s.lng)),bt.rotateX(c,c,Ct(s.lat)),bt.scale(c,c,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(c)}pointCoordinate(t,r,s,c){return Pp(t,r,s,!0)||new Xn(0,0)}pointCoordinate3D(t,r,s){const c=this.pointCoordinate(t,r,s,0);return[c.x,c.y,c.z]}isPointAboveHorizon(t,r){return!Pp(t,r.x,r.y,!1)}farthestPixelDistance(t){const r=function(c,d){const f=c.cameraToCenterDistance,g=c._centerAltitude*d,y=c._camera,b=c._camera.forward(),C=dt.add([],dt.scale([],b,-f),[0,0,g]),P=c.worldSize/(2*Math.PI),E=[0,0,-P],I=c.width/c.height,A=Math.tan(c.fovAboveCenter),l=dt.scale([],y.up(),A),u=dt.scale([],y.right(),A*I),p=dt.normalize([],dt.add([],dt.add([],b,l),u)),m=[];let v;if(new e1(C,p).closestPointOnSphere(E,P,m)){const M=dt.add([],m,E),O=dt.sub([],M,C);v=Math.cos(c.fovAboveCenter)*dt.length(O)}else{const M=dt.sub([],C,E),O=dt.sub([],E,C);dt.normalize(O,O);const T=dt.length(M)-P;v=Math.sqrt(T*(T+2*P));const k=Math.acos(v/(P+T))-Math.acos(dt.dot(b,O));v*=Math.cos(k)}return 1.01*v}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),s=Pi(t.zoom);if(s>0){const c=L1(t,oo(1,t.center.lat)*t.worldSize),d=t.worldSize/(2*Math.PI),f=Math.max(t.width,t.height)/t.worldSize*Math.PI;return vn(r,c+d*(1-Math.cos(f)),Math.pow(s,10))}return r}upVector(t,r,s){return af(r,s,t,1)}upVectorScale(t){return{metersToTile:i1(ll(Po(t)))}}}function kl(e){const t=e.parallels,r=!!t&&Math.abs(t[0]+t[1])<.01;switch(e.name){case"mercator":return new J_(e);case"equirectangular":return new RT(e);case"naturalEarth":return new LT(e);case"equalEarth":return new q0(e);case"winkelTripel":return new sO(e);case"albers":return r?new Z0(e):new N1(e);case"lambertConformalConic":return r?new Z0(e):new Q_(e);case"globe":return new rm(e)}throw new Error(`Invalid projection name: ${e.name}`)}const sC=new jt({"symbol-placement":new G(wt.layout_symbol["symbol-placement"]),"symbol-spacing":new G(wt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new G(wt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Q(wt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new G(wt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new G(wt.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new G(wt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new G(wt.layout_symbol["icon-ignore-placement"]),"icon-optional":new G(wt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new G(wt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Q(wt.layout_symbol["icon-size"]),"icon-text-fit":new Q(wt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Q(wt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Q(wt.layout_symbol["icon-image"]),"icon-rotate":new Q(wt.layout_symbol["icon-rotate"]),"icon-padding":new G(wt.layout_symbol["icon-padding"]),"icon-keep-upright":new G(wt.layout_symbol["icon-keep-upright"]),"icon-offset":new Q(wt.layout_symbol["icon-offset"]),"icon-anchor":new Q(wt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new G(wt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new G(wt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new G(wt.layout_symbol["text-rotation-alignment"]),"text-field":new Q(wt.layout_symbol["text-field"]),"text-font":new Q(wt.layout_symbol["text-font"]),"text-size":new Q(wt.layout_symbol["text-size"]),"text-max-width":new Q(wt.layout_symbol["text-max-width"]),"text-line-height":new Q(wt.layout_symbol["text-line-height"]),"text-letter-spacing":new Q(wt.layout_symbol["text-letter-spacing"]),"text-justify":new Q(wt.layout_symbol["text-justify"]),"text-radial-offset":new Q(wt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new G(wt.layout_symbol["text-variable-anchor"]),"text-anchor":new Q(wt.layout_symbol["text-anchor"]),"text-max-angle":new G(wt.layout_symbol["text-max-angle"]),"text-writing-mode":new G(wt.layout_symbol["text-writing-mode"]),"text-rotate":new Q(wt.layout_symbol["text-rotate"]),"text-padding":new G(wt.layout_symbol["text-padding"]),"text-keep-upright":new G(wt.layout_symbol["text-keep-upright"]),"text-transform":new Q(wt.layout_symbol["text-transform"]),"text-offset":new Q(wt.layout_symbol["text-offset"]),"text-allow-overlap":new G(wt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new G(wt.layout_symbol["text-ignore-placement"]),"text-optional":new G(wt.layout_symbol["text-optional"]),visibility:new G(wt.layout_symbol.visibility)});var z1={paint:new jt({"icon-opacity":new Q(wt.paint_symbol["icon-opacity"]),"icon-emissive-strength":new Q(wt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Q(wt.paint_symbol["text-emissive-strength"]),"icon-color":new Q(wt.paint_symbol["icon-color"]),"icon-halo-color":new Q(wt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Q(wt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Q(wt.paint_symbol["icon-halo-blur"]),"icon-translate":new G(wt.paint_symbol["icon-translate"]),"icon-translate-anchor":new G(wt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Q(wt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Q(wt.paint_symbol["text-opacity"]),"text-color":new Q(wt.paint_symbol["text-color"],{runtimeType:Jr,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Q(wt.paint_symbol["text-halo-color"]),"text-halo-width":new Q(wt.paint_symbol["text-halo-width"]),"text-halo-blur":new Q(wt.paint_symbol["text-halo-blur"]),"text-translate":new G(wt.paint_symbol["text-translate"]),"text-translate-anchor":new G(wt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new G(wt.paint_symbol["icon-color-saturation"])}),layout:sC};class B1{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ws,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}De(B1,"FormatSectionOverride",{omit:["defaultValue"]});class Jd extends gs{constructor(t,r){super(t,z1,r)}recalculate(t,r){super.recalculate(t,r),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const c=[];for(const d of s)c.indexOf(d)<0&&c.push(d);this.layout._values["text-writing-mode"]=c}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,r,s,c){const d=this.layout.get(t).evaluate(r,{},s,c),f=this._unevaluatedLayout._values[t];return f.isDataDriven()||wl(f.value)||!d?d:(g=r.properties,d.replace(/{([^{}]+)}/g,(b,C)=>C in g?String(g[C]):""));var g}createBucket(t){return new xf(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of z1.paint.overridableProperties){if(!Jd.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),s=new B1(r),c=new Xo(s,r.property.specification);let d=null;d="constant"===r.value.kind||"source"===r.value.kind?new sp("source",c):new Es("composite",c,r.value.zoomStops,r.value._interpolationType),this.paint._values[t]=new R(r.property,d,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,s){return!(!this.layout||r.isDataDriven()||s.isDataDriven())&&Jd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const s=t.get("text-field"),c=z1.paint.properties[r];let d=!1;const f=g=>{for(const y of g)if(c.overrides&&c.overrides.hasOverride(y))return void(d=!0)};if("constant"===s.value.kind&&s.value.value instanceof pi)f(s.value.value.sections);else if("source"===s.value.kind){const g=b=>{d||(b instanceof Ms&&gi(b.value)===Cs?f(b.value.sections):b instanceof aa?f(b.sections):b.eachChild(g))},y=s.value;y._styleExpression&&g(y._styleExpression.expression)}return d}getProgramIds(){const t=0!==this.paint.get("icon-opacity").constantOr(1),r=0!==this.paint.get("text-opacity").constantOr(1),s=[];return t&&s.push("symbolIcon"),r&&s.push("symbolSDF"),s}getDefaultProgramParams(t,r){return{config:new Lu(this,r),overrideFog:!1}}}const U1=S0.types,V1=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ey(e,t,r,s,c,d,f,g,y,b,C,P,E){const I=g?Math.min(Qd,Math.round(g[0])):0,A=g?Math.min(Qd,Math.round(g[1])):0;e.emplaceBack(t,r,Math.round(32*s),Math.round(32*c),d,f,(I<<1)+(y?1:0),A,16*b,16*C,256*P,256*E)}function ny(e,t,r){e.emplaceBack(t,r)}function j1(e,t,r,s,c,d,f){e.emplaceBack(t,r,s,c,d,f)}function W0(e,t,r,s,c){const d=5*t+2;e.float32[d+0]=r,e.float32[d+1]=s,e.float32[d+2]=c}function di(e,t,r,s,c){e.emplaceBack(t,r,s,c),e.emplaceBack(t,r,s,c),e.emplaceBack(t,r,s,c),e.emplaceBack(t,r,s,c)}function To(e){for(const t of e.sections)if(xn(t.text))return!0;return!1}class K0{constructor(t){this.layoutVertexArray=new gb,this.indexArray=new Mi,this.programConfigurations=t,this.segments=new lo,this.dynamicLayoutVertexArray=new ku,this.opacityVertexArray=new Qy,this.placedSymbolArray=new sP,this.iconTransitioningVertexArray=new Ru,this.globeExtVertexArray=new eP,this.zOffsetVertexArray=new vb}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length&&0===this.iconTransitioningVertexArray.length}upload(t,r,s,c,d){this.isEmpty()||(s&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qg.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Xw.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,V1,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,XP.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Zg.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||d)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,B0.members,!0)),this.opacityVertexBuffer.itemSize=1),(s||c)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}De(K0,"SymbolBuffers");class Y0{constructor(t,r,s){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new s,this.segments=new lo,this.collisionVertexArray=new nP,this.collisionVertexArrayExt=new ku}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,QP.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,E1.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}De(Y0,"CollisionBuffers");class om{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(f=>f.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=bt.identity([]),this.placementViewportMatrix=bt.identity([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Jw(this.zoom,r["text-size"]),this.iconSizeData=Jw(this.zoom,r["icon-size"]);const s=this.layers[0].layout,c=s.get("symbol-sort-key"),d=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==d&&void 0!==c.constantOr(1),this.sortFeaturesByY=("viewport-y"===d||"auto"===d&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(f=>so[f]),this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=s.get("symbol-z-elevate")}createArrays(){this.text=new K0(new ga(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new K0(new ga(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new u_,this.lineVertexArray=new cP,this.symbolInstances=new lP}calculateGlyphDependencies(t,r,s,c,d){for(let f=0;f<t.length;f++){const g=t.codePointAt(f);if(void 0===g)break;if(r[g]=!0,c&&d&&g<=65535){const y=Hc[t.charAt(f)];y&&(r[y.charCodeAt(0)]=!0)}}}populate(t,r,s,c){const d=this.layers[0],f=d.layout,g="globe"===this.projection.name,y=f.get("text-font"),b=f.get("text-field"),C=f.get("icon-image"),P=("constant"!==b.value.kind||b.value.value instanceof pi&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&("constant"!==y.value.kind||y.value.value.length>0),E="constant"!==C.value.kind||!!C.value.value||Object.keys(C.parameters).length>0,I=f.get("symbol-sort-key");if(this.features=[],!P&&!E)return;const A=r.iconDependencies,l=r.glyphDependencies,u=r.availableImages,p=new Lo(this.zoom);for(const{feature:m,id:v,index:M,sourceLayerIndex:O}of t){const T=d._featureFilter.needGeometry,k=jc(m,T);if(!d._featureFilter.filter(p,k,s))continue;if(T||(k.geometry=Eo(m,s,c)),g&&1!==m.type&&s.z<=5){const q=k.geometry,Z=.98078528056,X=(K,J)=>{const st=af(K.x,K.y,s,1),it=af(J.x,J.y,s,1);return dt.dot(st,it)<Z};for(let K=0;K<q.length;K++)q[K]=Fw(q[K],X)}let N,F;if(P){const q=d.getValueAndResolveTokens("text-field",k,s,u),Z=pi.factory(q);To(Z)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Du()||this.hasRTLText&&el.isParsed())&&(N=li(Z,d,k))}if(E){const q=d.getValueAndResolveTokens("icon-image",k,s,u);F=q instanceof Ri?q:Ri.fromString(q)}if(!N&&!F)continue;const $=this.sortFeaturesByKey?I.evaluate(k,{},s):void 0;if(this.features.push({id:v,text:N,icon:F,index:M,sourceLayerIndex:O,geometry:k.geometry,properties:m.properties,type:U1[m.type],sortKey:$}),F&&(A[F.namePrimary]=!0,F.nameSecondary&&(A[F.nameSecondary]=!0)),N){const q=y.evaluate(k,{},s).join(","),Z="map"===f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(so.vertical)>=0;for(const X of N.sections)if(X.image)A[X.image.namePrimary]=!0;else{const K=W(N.toString()),J=X.fontStack||q,st=l[J]=l[J]||{};this.calculateGlyphDependencies(X.text,st,Z,this.allowVerticalPlacement,K)}}}"line"===f.get("symbol-placement")&&(this.features=function(m){const v={},M={},O=[];let T=0;function k(q){O.push(m[q]),T++}function N(q,Z,X){const K=M[q];return delete M[q],M[Z]=K,O[K].geometry[0].pop(),O[K].geometry[0]=O[K].geometry[0].concat(X[0]),K}function F(q,Z,X){const K=v[Z];return delete v[Z],v[q]=K,O[K].geometry[0].shift(),O[K].geometry[0]=X[0].concat(O[K].geometry[0]),K}function $(q,Z,X){const K=X?Z[0][Z[0].length-1]:Z[0][0];return`${q}:${K.x}:${K.y}`}for(let q=0;q<m.length;q++){const Z=m[q],X=Z.geometry,K=Z.text?Z.text.toString():null;if(!K){k(q);continue}const J=$(K,X),st=$(K,X,!0);if(J in M&&st in v&&M[J]!==v[st]){const it=F(J,st,X),rt=N(J,st,O[it].geometry);delete v[J],delete M[st],M[$(K,O[rt].geometry,!0)]=rt,O[it].geometry=null}else J in M?N(J,st,X):st in v?F(J,st,X):(k(q),v[J]=T-1,M[st]=T-1)}return O.filter(q=>q.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((m,v)=>m.sortKey-v.sortKey)}update(t,r,s,c,d){const f=0!==Object.keys(t).length;if(f&&!this.stateDependentLayers.length)return;const g=f?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,r,g,s,c,d),this.icon.programConfigurations.updatePaintArrays(t,r,g,s,c,d)}updateZOffset(){const t=(d,f,g)=>{s+=f,s>d.length&&d.resize(s);for(let y=-f;y<0;y++)d.emplace(y+s,g)},r=(d,f,g)=>{c+=f,c>d.length&&d.resize(c);for(let y=-f;y<0;y++)d.emplace(y+c,g)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let s=0,c=0;for(let d=0;d<this.symbolInstances.length;d++){const f=this.symbolInstances.get(d),{numHorizontalGlyphVertices:g,numVerticalGlyphVertices:y,numIconVertices:b}=f,C=f.zOffset,P=b>0;if((g>0||y>0)&&(t(this.text.zOffsetVertexArray,g,C),t(this.text.zOffsetVertexArray,y,C)),P){const{placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:I}=f;E>=0&&r(this.icon.zOffsetVertexArray,b,C),I>=0&&r(this.icon.zOffsetVertexArray,f.numVerticalIconVertices,C)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=kl(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const s=this.lineVertexArray.length;if(void 0!==t.segment)for(const{x:c,y:d}of r)this.lineVertexArray.emplaceBack(c,d);return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u){const p=t.indexArray,m=t.layoutVertexArray,v=t.globeExtVertexArray,M=t.segments.prepareSegment(4*r.length,m,p,this.canOverlap?f.sortKey:void 0),O=this.glyphOffsetArray.length,T=M.vertexLength,k=this.allowVerticalPlacement&&g===so.vertical?Math.PI/2:0,N=f.text&&f.text.sections;for(let $=0;$<r.length;$++){const{tl:q,tr:Z,bl:X,br:K,texPrimary:J,texSecondary:st,pixelOffsetTL:it,pixelOffsetBR:rt,minFontScaleX:ct,minFontScaleY:yt,glyphOffset:Et,isSDF:Tt,sectionIndex:zt}=r[$],Nt=M.vertexLength,$t=Et[1];if(ey(m,b.x,b.y,q.x,$t+q.y,J.x,J.y,s,Tt,it.x,it.y,ct,yt),ey(m,b.x,b.y,Z.x,$t+Z.y,J.x+J.w,J.y,s,Tt,rt.x,it.y,ct,yt),ey(m,b.x,b.y,X.x,$t+X.y,J.x,J.y+J.h,s,Tt,it.x,rt.y,ct,yt),ey(m,b.x,b.y,K.x,$t+K.y,J.x+J.w,J.y+J.h,s,Tt,rt.x,rt.y,ct,yt),y){const{x:Rt,y:oe,z:Oe}=y.anchor,[Ee,Be,je]=y.up;j1(v,Rt,oe,Oe,Ee,Be,je),j1(v,Rt,oe,Oe,Ee,Be,je),j1(v,Rt,oe,Oe,Ee,Be,je),j1(v,Rt,oe,Oe,Ee,Be,je),di(t.dynamicLayoutVertexArray,Rt,oe,Oe,k)}else di(t.dynamicLayoutVertexArray,b.x,b.y,b.z,k);if(u){const Rt=st||J;ny(t.iconTransitioningVertexArray,Rt.x,Rt.y),ny(t.iconTransitioningVertexArray,Rt.x+Rt.w,Rt.y),ny(t.iconTransitioningVertexArray,Rt.x,Rt.y+Rt.h),ny(t.iconTransitioningVertexArray,Rt.x+Rt.w,Rt.y+Rt.h)}p.emplaceBack(Nt,Nt+1,Nt+2),p.emplaceBack(Nt+1,Nt+2,Nt+3),M.vertexLength+=4,M.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Et[0]),$!==r.length-1&&zt===r[$+1].sectionIndex||t.programConfigurations.populatePaintArrays(m.length,f,f.index,{},I,A,l,N&&N[zt])}const F=y?y.anchor:b;t.placedSymbolArray.emplaceBack(F.x,F.y,F.z,b.x,b.y,O,this.glyphOffsetArray.length-O,T,C,P,b.segment,s?s[0]:0,s?s[1]:0,c[0],c[1],g,0,!1,0,E,0)}_commitLayoutVertex(t,r,s,c,d,f,g){t.emplaceBack(r,s,c,d,f,Math.round(g.x),Math.round(g.y))}_addCollisionDebugVertices(t,r,s,c,d,f,g){const y=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),b=y.vertexLength,C=g.tileAnchorX,P=g.tileAnchorY;for(let I=0;I<4;I++)s.collisionVertexArray.emplaceBack(0,0,0,0);this._commitDebugCollisionVertexUpdate(s.collisionVertexArrayExt,r,t.padding,g.zOffset),this._commitLayoutVertex(s.layoutVertexArray,c,d,f,C,P,new tt(t.x1,t.y1)),this._commitLayoutVertex(s.layoutVertexArray,c,d,f,C,P,new tt(t.x2,t.y1)),this._commitLayoutVertex(s.layoutVertexArray,c,d,f,C,P,new tt(t.x2,t.y2)),this._commitLayoutVertex(s.layoutVertexArray,c,d,f,C,P,new tt(t.x1,t.y2)),y.vertexLength+=4;const E=s.indexArray;E.emplaceBack(b,b+1),E.emplaceBack(b+1,b+2),E.emplaceBack(b+2,b+3),E.emplaceBack(b+3,b),y.primitiveLength+=4}_addTextDebugCollisionBoxes(t,r,s,c,d,f){for(let g=c;g<d;g++){const y=s.get(g),b=this.getSymbolInstanceTextSize(t,f,r,g);this._addCollisionDebugVertices(y,b,this.textCollisionBox,y.projectedAnchorX,y.projectedAnchorY,y.projectedAnchorZ,f)}}_addIconDebugCollisionBoxes(t,r,s,c,d,f){for(let g=c;g<d;g++){const y=s.get(g),b=this.getSymbolInstanceIconSize(t,r,f.placedIconSymbolIndex);this._addCollisionDebugVertices(y,b,this.iconCollisionBox,y.projectedAnchorX,y.projectedAnchorY,y.projectedAnchorZ,f)}}generateCollisionDebugBuffers(t,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Y0(_b,j_.members,Ru),this.iconCollisionBox=new Y0(_b,j_.members,Ru);const s=ui(this.iconSizeData,t),c=ui(this.textSizeData,t);for(let d=0;d<this.symbolInstances.length;d++){const f=this.symbolInstances.get(d);this._addTextDebugCollisionBoxes(c,t,r,f.textBoxStartIndex,f.textBoxEndIndex,f),this._addTextDebugCollisionBoxes(c,t,r,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f),this._addIconDebugCollisionBoxes(s,t,r,f.iconBoxStartIndex,f.iconBoxEndIndex,f),this._addIconDebugCollisionBoxes(s,t,r,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f)}}getSymbolInstanceTextSize(t,r,s,c){const d=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:c),f=Wg(this.textSizeData,t,d)/os;return this.tilePixelRatio*f}getSymbolInstanceIconSize(t,r,s){const c=this.icon.placedSymbolArray.get(s),d=Wg(this.iconSizeData,t,c);return this.tilePixelRatio*d}_commitDebugCollisionVertexUpdate(t,r,s,c){t.emplaceBack(r,-s,-s,c),t.emplaceBack(r,s,-s,c),t.emplaceBack(r,s,s,c),t.emplaceBack(r,-s,s,c)}_updateTextDebugCollisionBoxes(t,r,s,c,d,f){for(let g=c;g<d;g++){const y=s.get(g),b=this.getSymbolInstanceTextSize(t,f,r,g);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,b,y.padding,f.zOffset)}}_updateIconDebugCollisionBoxes(t,r,s,c,d,f){for(let g=c;g<d;g++){const y=s.get(g),b=this.getSymbolInstanceIconSize(t,r,f.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,b,y.padding,f.zOffset)}}updateCollisionDebugBuffers(t,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=ui(this.iconSizeData,t),c=ui(this.textSizeData,t);for(let d=0;d<this.symbolInstances.length;d++){const f=this.symbolInstances.get(d);this._updateTextDebugCollisionBoxes(c,t,r,f.textBoxStartIndex,f.textBoxEndIndex,f),this._updateTextDebugCollisionBoxes(c,t,r,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f),this._updateIconDebugCollisionBoxes(s,t,r,f.iconBoxStartIndex,f.iconBoxEndIndex,f),this._updateIconDebugCollisionBoxes(s,t,r,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,r,s,c,d,f,g,y,b){const C={};if(r<s){const{x1:P,y1:E,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:M,featureIndex:O}=t.get(r);C.textBox={x1:P,y1:E,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:M},C.textFeatureIndex=O}if(c<d){const{x1:P,y1:E,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:M,featureIndex:O}=t.get(c);C.verticalTextBox={x1:P,y1:E,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:M},C.verticalTextFeatureIndex=O}if(f<g){const{x1:P,y1:E,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:M,featureIndex:O}=t.get(f);C.iconBox={x1:P,y1:E,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:M},C.iconFeatureIndex=O}if(y<b){const{x1:P,y1:E,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:M,featureIndex:O}=t.get(y);C.verticalIconBox={x1:P,y1:E,x2:I,y2:A,padding:l,projectedAnchorX:u,projectedAnchorY:p,projectedAnchorZ:m,tileAnchorX:v,tileAnchorY:M},C.verticalIconFeatureIndex=O}return C}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,r){const s=t.placedSymbolArray.get(r),c=s.vertexStartIndex+4*s.numGlyphs;for(let d=s.vertexStartIndex;d<c;d+=4)t.indexArray.emplaceBack(d,d+1,d+2),t.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const r=Math.sin(t),s=Math.cos(t),c=[],d=[],f=[];for(let g=0;g<this.symbolInstances.length;++g){f.push(g);const y=this.symbolInstances.get(g);c.push(0|Math.round(r*y.tileAnchorX+s*y.tileAnchorY)),d.push(y.featureIndex)}return f.sort((g,y)=>c[g]-c[y]||d[y]-d[g]),f}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,r)=>this.symbolInstances.get(r).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,r){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===r?s.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const s=this.symbolInstances.get(r);this.featureSortOrder.push(s.featureIndex);const{rightJustifiedTextSymbolIndex:c,centerJustifiedTextSymbolIndex:d,leftJustifiedTextSymbolIndex:f,verticalPlacedTextSymbolIndex:g,placedIconSymbolIndex:y,verticalPlacedIconSymbolIndex:b}=s;c>=0&&this.addIndicesForPlacedSymbol(this.text,c),d>=0&&d!==c&&this.addIndicesForPlacedSymbol(this.text,d),f>=0&&f!==d&&f!==c&&this.addIndicesForPlacedSymbol(this.text,f),g>=0&&this.addIndicesForPlacedSymbol(this.text,g),y>=0&&this.addIndicesForPlacedSymbol(this.icon,y),b>=0&&this.addIndicesForPlacedSymbol(this.icon,b)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}De(om,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),om.MAX_GLYPHS=65535,om.addDynamicAttributes=di;var xf=om;const aC=Dr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:aO}=aC,lC=Dr([{name:"a_packed",components:4,type:"Float32"}]),{members:X0}=lC,th=S0.types,Q0=Math.cos(Math.PI/180*37.5);class jp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new pb,this.layoutVertexArray2=new ku,this.indexArray=new Mi,this.programConfigurations=new ga(t.layers,t.zoom),this.segments=new lo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,s,c){this.hasPattern=cl("line",this.layers,r);const d=this.layers[0].layout.get("line-sort-key"),f=[];for(const{feature:C,id:P,index:E,sourceLayerIndex:I}of t){const A=this.layers[0]._featureFilter.needGeometry,l=jc(C,A);if(!this.layers[0]._featureFilter.filter(new Lo(this.zoom),l,s))continue;const u=d?d.evaluate(l,{},s):void 0,p={id:P,properties:C.properties,type:C.type,sourceLayerIndex:I,index:E,geometry:A?l.geometry:Eo(C,s,c),patterns:{},sortKey:u};f.push(p)}d&&f.sort((C,P)=>C.sortKey-P.sortKey);const{lineAtlas:g,featureIndex:y}=r,b=this.addConstantDashes(g);for(const C of f){const{geometry:P,index:E,sourceLayerIndex:I}=C;if(b&&this.addFeatureDashes(C,g),this.hasPattern){const A=ff("line",this.layers,C,this.zoom,r);this.patternFeatures.push(A)}else this.addFeature(C,P,E,s,g.positions,r.availableImages,r.brightness);y.insert(t[E].feature,P,E,I,this.index)}}addConstantDashes(t){let r=!1;for(const s of this.layers){const c=s.paint.get("line-dasharray").value,d=s.layout.get("line-cap").value;if("constant"!==c.kind||"constant"!==d.kind)r=!0;else{const f=d.value,g=c.value;if(!g)continue;t.addDash(g,f)}}return r}addFeatureDashes(t,r){const s=this.zoom;for(const c of this.layers){const d=c.paint.get("line-dasharray").value,f=c.layout.get("line-cap").value;if("constant"===d.kind&&"constant"===f.kind)continue;let g,y;if("constant"===d.kind){if(g=d.value,!g)continue}else g=d.evaluate({zoom:s},t);y="constant"===f.kind?f.value:f.evaluate({zoom:s},t),r.addDash(g,y),t.patterns[c.id]=r.getKey(g,y)}}update(t,r,s,c,d){const f=0!==Object.keys(t).length;f&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,f?this.stateDependentLayers:this.layers,s,c,d)}addFeatures(t,r,s,c,d,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,s,c,f)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,X0)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,aO),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,s,c,d,f,g){const y=this.layers[0].layout,b=y.get("line-join").evaluate(t,{}),C=y.get("line-cap").evaluate(t,{}),P=y.get("line-miter-limit"),E=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const I of r)this.addLine(I,t,b,C,P,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,d,f,c,g)}addLine(t,r,s,c,d,f){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let p=0;p<t.length-1;p++)this.totalDistance+=t[p].dist(t[p+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const g="Polygon"===th[r.type];let y=t.length;for(;y>=2&&t[y-1].equals(t[y-2]);)y--;let b=0;for(;b<y-1&&t[b].equals(t[b+1]);)b++;if(y<(g?3:2))return;"bevel"===s&&(d=1.05);const C=this.overscaling<=16?15*Dt/(512*this.overscaling):0,P=this.segments.prepareSegment(10*y,this.layoutVertexArray,this.indexArray);let E,I,A,l,u;this.e1=this.e2=-1,g&&(E=t[y-2],u=t[b].sub(E)._unit()._perp());for(let p=b;p<y;p++){if(A=p===y-1?g?t[b+1]:void 0:t[p+1],A&&t[p].equals(A))continue;u&&(l=u),E&&(I=E),E=t[p],u=A?A.sub(E)._unit()._perp():l,l=l||u;let m=l.add(u);0===m.x&&0===m.y||m._unit();const v=l.x*u.x+l.y*u.y,M=m.x*u.x+m.y*u.y,O=0!==M?1/M:1/0,T=2*Math.sqrt(2-2*M),k=M<Q0&&I&&A,N=l.x*u.y-l.y*u.x>0;if(k&&p>b){const q=E.dist(I);if(q>2*C){const Z=E.sub(E.sub(I)._mult(C/q)._round());this.updateDistance(I,Z),this.addCurrentVertex(Z,l,0,0,P),I=Z}}const F=I&&A;let $=F?s:g?"butt":c;if(F&&"round"===$&&(O<f?$="miter":O<=2&&($="fakeround")),"miter"===$&&O>d&&($="bevel"),"bevel"===$&&(O>2&&($="flipbevel"),O<d&&($="miter")),I&&this.updateDistance(I,E),"miter"===$)m._mult(O),this.addCurrentVertex(E,m,0,0,P);else if("flipbevel"===$){if(O>100)m=u.mult(-1);else{const q=O*l.add(u).mag()/l.sub(u).mag();m._perp()._mult(q*(N?-1:1))}this.addCurrentVertex(E,m,0,0,P),this.addCurrentVertex(E,m.mult(-1),0,0,P)}else if("bevel"===$||"fakeround"===$){const q=-Math.sqrt(O*O-1),Z=N?q:0,X=N?0:q;if(I&&this.addCurrentVertex(E,l,Z,X,P),"fakeround"===$){const K=Math.round(180*T/Math.PI/20);for(let J=1;J<K;J++){let st=J/K;if(.5!==st){const rt=st-.5;st+=st*rt*(st-1)*((1.0904+v*(v*(3.55645-1.43519*v)-3.2452))*rt*rt+(.848013+v*(.215638*v-1.06021)))}const it=u.sub(l)._mult(st)._add(l)._unit()._mult(N?-1:1);this.addHalfVertex(E,it.x,it.y,!1,N,0,P)}}A&&this.addCurrentVertex(E,u,-Z,-X,P)}else if("butt"===$)this.addCurrentVertex(E,m,0,0,P);else if("square"===$){const q=I?1:-1;I||this.addCurrentVertex(E,m,q,q,P),this.addCurrentVertex(E,m,0,0,P),I&&this.addCurrentVertex(E,m,q,q,P)}else"round"===$&&(I&&(this.addCurrentVertex(E,l,0,0,P),this.addCurrentVertex(E,l,1,1,P,!0)),A&&(this.addCurrentVertex(E,u,-1,-1,P,!0),this.addCurrentVertex(E,u,0,0,P)));if(k&&p<y-1){const q=E.dist(A);if(q>2*C){const Z=E.add(A.sub(E)._mult(C/q)._round());this.updateDistance(E,Z),this.addCurrentVertex(Z,u,0,0,P),E=Z}}}}addCurrentVertex(t,r,s,c,d,f=!1){const g=r.y*c-r.x,y=-r.y-r.x*c;this.addHalfVertex(t,r.x+r.y*s,r.y-r.x*s,f,!1,s,d),this.addHalfVertex(t,g,y,f,!0,-c,d)}addHalfVertex({x:t,y:r},s,c,d,f,g,y){this.layoutVertexArray.emplaceBack((t<<1)+(d?1:0),(r<<1)+(f?1:0),Math.round(63*s)+128,Math.round(63*c)+128,1+(0===g?0:g<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const b=y.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,b),y.primitiveLength++),f?this.e2=b:this.e1=b}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}De(jp,"LineBucket",{omit:["layers","patternFeatures"]});class xo{constructor(t,r,s,c){this.context=t,this.format=s,this.texture=t.gl.createTexture(),this.update(r,c)}update(t,r,s){const{width:c,height:d}=t,{context:f}=this,{gl:g}=f,{HTMLImageElement:y,HTMLCanvasElement:b,HTMLVideoElement:C,ImageData:P,ImageBitmap:E}=lt;if(g.bindTexture(g.TEXTURE_2D,this.texture),f.pixelStoreUnpackFlipY.set(!1),f.pixelStoreUnpack.set(1),f.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!r||!1!==r.premultiply)),s||this.size&&this.size[0]===c&&this.size[1]===d){const{x:I,y:A}=s||{x:0,y:0};if(t instanceof y||t instanceof b||t instanceof C||t instanceof P||E&&t instanceof E)g.texSubImage2D(g.TEXTURE_2D,0,I,A,g.RGBA,g.UNSIGNED_BYTE,t);else{let l=this.format,u=g.UNSIGNED_BYTE;this.format===g.R32F&&(l=g.RED,u=g.FLOAT),g.texSubImage2D(g.TEXTURE_2D,0,I,A,c,d,l,u,t.data)}}else if(this.size=[c,d],t instanceof y||t instanceof b||t instanceof C||t instanceof P||E&&t instanceof E){let I=this.format;this.format===g.R8&&(I=g.RED),g.texImage2D(g.TEXTURE_2D,0,this.format,I,g.UNSIGNED_BYTE,t)}else{let I=this.format,A=this.format,l=g.UNSIGNED_BYTE;this.format===g.DEPTH_COMPONENT&&(I=g.DEPTH_COMPONENT16,l=g.UNSIGNED_SHORT),this.format===g.R32F&&(l=g.FLOAT,A=g.RED),g.texImage2D(g.TEXTURE_2D,0,I,c,d,0,A,l,t.data)}this.useMipmap=!(!r||!r.useMipmap),this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(t,r){const{context:s}=this,{gl:c}=s;c.bindTexture(c.TEXTURE_2D,this.texture),t!==this.minFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,t),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,this.useMipmap?t===c.NEAREST?c.NEAREST_MIPMAP_NEAREST:c.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),r!==this.wrapS&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,r),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,r),this.wrapS=r)}bindExtraParam(t,r,s,c){const{context:d}=this,{gl:f}=d;f.bindTexture(f.TEXTURE_2D,this.texture),r!==this.magFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,r),this.magFilter=r),t!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap?t===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),s!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,s),this.wrapS=s),c!==this.wrapT&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,c),this.wrapT=c)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class pc{constructor(t,r){this.context=t,this.texture=r}bind(t,r){const{context:s}=this,{gl:c}=s;c.bindTexture(c.TEXTURE_2D,this.texture),t!==this.minFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,t),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,t),this.minFilter=t),r!==this.wrapS&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,r),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,r),this.wrapS=r)}}const Ju=new Uint16Array(8184);for(let e=0;e<2046;e++){let t=e+2,r=0,s=0,c=0,d=0,f=0,g=0;for(1&t?c=d=f=32:r=s=g=32;(t>>=1)>1;){const b=r+c>>1,C=s+d>>1;1&t?(c=r,d=s,r=f,s=g):(r=c,s=d,c=f,d=g),f=b,g=C}const y=4*e;Ju[y+0]=r,Ju[y+1]=s,Ju[y+2]=c,Ju[y+3]=d}const wf=new Uint16Array(2178),$p=new Uint8Array(1089),J0=new Uint16Array(1089);function lO(e){return 0===e?-.03125:32===e?.03125:0}var $1=Dr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const cO={type:2,extent:Dt,loadGeometry:()=>[[new tt(0,0),new tt(Dt+1,0),new tt(Dt+1,Dt+1),new tt(0,Dt+1),new tt(0,0)]]};class Ki{constructor(t,r,s,c,d){this.tileID=t,this.uid=In(),this.uses=0,this.tileSize=r,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=d,c&&c.style&&(this._lastUpdatedBrightness=c.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",c&&c.transform&&(this.projection=c.transform.projection)}registerFadeDuration(t){const r=t+this.timeAdded;r<Mn.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Yu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,r,s){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(c,d){const f={};if(!d)return f;for(const g of c){const y=g.layerIds.map(b=>d.getLayer(b)).filter(Boolean);if(0!==y.length){g.layers=y,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(b=>y.filter(C=>C.id===b)[0]));for(const b of y)f[b.fqid]=g}}return f}(t.buckets,r.style),this.hasSymbolBuckets=!1;for(const c in this.buckets){const d=this.buckets[c];if(d instanceof xf){if(this.hasSymbolBuckets=!0,!s)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const c in this.buckets){const d=this.buckets[c];if(d instanceof xf&&d.hasRTLText){this.hasRTLText=!0,el.isLoading()||el.isLoaded()||"deferred"!==Du()||Vh();break}}this.queryPadding=0;for(const c in this.buckets){const d=this.buckets[c],f=r.style.getOwnLayer(c);if(!f)continue;const g=f.queryRadius(d);this.queryPadding=Math.max(this.queryPadding,g)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new t0}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const s in this.buckets){const c=this.buckets[s];c.uploadPending()&&c.upload(t)}const r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new xo(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new xo(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new xo(t,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t,r,s){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,s),!r||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const c=r.style.getBrightness();(this._lastUpdatedBrightness||c)&&(this._lastUpdatedBrightness&&c&&Math.abs(this._lastUpdatedBrightness-c)<.001||(this._lastUpdatedBrightness=c,this.updateBuckets(void 0,r)))}queryRenderedFeatures(t,r,s,c,d,f,g,y){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:c,pixelPosMatrix:g,transform:f,params:d,tileTransform:this.tileTransform},t,r,s):{}}querySourceFeatures(t,r){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const c=s.loadVTLayers(),d=r?r.sourceLayer:"",f=c._geojsonTileLayer||c[d];if(!f)return;const g=Tu(r&&r.filter),{z:y,x:b,y:C}=this.tileID.canonical,P={z:y,x:b,y:C};for(let E=0;E<f.length;E++){const I=f.feature(E);if(g.needGeometry){const u=jc(I,!0);if(!g.filter(new Lo(this.tileID.overscaledZ),u,this.tileID.canonical))continue}else if(!g.filter(new Lo(this.tileID.overscaledZ),I))continue;const A=s.getId(I,d),l=new ys(I,y,b,C,A);l.tile=P,t.push(l)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}bucketsLoaded(){for(const t in this.buckets)if(this.buckets[t].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const r=this.expirationTime;if(t.cacheControl){const s=Xe(t.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const s=Date.now();let c=!1;if(this.expirationTime>s)c=!1;else if(r)if(this.expirationTime<r)c=!0;else{const d=this.expirationTime-r;d?this.expirationTime=s+Math.max(d,3e4):c=!0}else c=!0;c?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(t,r){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(t).length&&r&&this.updateBuckets(t,r)}updateBuckets(t,r){if(!this.latestFeatureIndex)return;const s=this.latestFeatureIndex.loadVTLayers(),c=r.style.listImages(),d=r.style.getBrightness();for(const f in this.buckets){if(!r.style.hasLayer(f))continue;const g=this.buckets[f],y=g.layers[0].sourceLayer||"_geojsonTileLayer",b=s[y];let C={};if(t&&(C=t[y],!b||!C||0===Object.keys(C).length))continue;if(g.update(C,b,c,this.imageAtlas&&this.imageAtlas.patternPositions||{},d),g instanceof jp||g instanceof E0){const E=r.style.getOwnSourceCache(g.layers[0].source);r._terrain&&r._terrain.enabled&&E&&g.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(E.id,this.tileID)}const P=r&&r.style&&r.style.getOwnLayer(f);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(g)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Mn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Mn.now()+t}setTexture(t,r){const s=r.context,c=s.gl;this.texture=this.texture||r.getTileTexture(t.width),this.texture&&this.texture instanceof xo?this.texture.update(t,{useMipmap:!0}):(this.texture=new xo(s,t,c.RGBA,{useMipmap:!0}),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE))}setDependencies(t,r){const s={};for(const c of r)s[c]=!0;this.dependencies[t]=s}hasDependency(t,r){for(const s of t){const c=this.dependencies[s];if(c)for(const d of r)if(c[d])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,r){if(!r||"mercator"===r.name||this._tileDebugBuffer)return;const s=Eo(cO,this.tileID.canonical,this.tileTransform)[0],c=new pa,d=new c_;for(let f=0;f<s.length;f++){const{x:g,y}=s[f];c.emplaceBack(g,y),d.emplaceBack(f)}d.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(d),this._tileDebugBuffer=t.createVertexBuffer(c,Cp.members),this._tileDebugSegments=lo.simpleSegment(0,0,c.length,d.length)}_makeTileBoundsBuffers(t,r){if(this._tileBoundsBuffer||!r||"mercator"===r.name)return;const s=Eo(cO,this.tileID.canonical,this.tileTransform)[0];let c,d;if(this.isRaster){const f=function(g,y){const b=Yu(g,y),C=Math.pow(2,g.z);for(let u=0;u<33;u++)for(let p=0;p<33;p++){const m=ka((g.x+(p+lO(p))/32)/C),v=ti((g.y+(u+lO(u))/32)/C),M=y.project(m,v),O=33*u+p;wf[2*O+0]=Math.round((M.x*b.scale-b.x)*Dt),wf[2*O+1]=Math.round((M.y*b.scale-b.y)*Dt)}$p.fill(0),J0.fill(0);for(let u=2045;u>=0;u--){const p=4*u,m=Ju[p+0],v=Ju[p+1],M=Ju[p+2],O=Ju[p+3],T=m+M>>1,k=v+O>>1,N=T+k-v,F=k+m-T,$=33*v+m,q=33*O+M,Z=33*k+T,X=Math.hypot((wf[2*$+0]+wf[2*q+0])/2-wf[2*Z+0],(wf[2*$+1]+wf[2*q+1])/2-wf[2*Z+1])>=16;$p[Z]=$p[Z]||(X?1:0),u<1022&&($p[Z]=$p[Z]||$p[33*(v+F>>1)+(m+N>>1)]||$p[33*(O+F>>1)+(M+N>>1)])}const P=new nl,E=new Mi;let I=0;function A(u,p){const m=33*p+u;return 0===J0[m]&&(P.emplaceBack(wf[2*m+0],wf[2*m+1],u*Dt/32,p*Dt/32),J0[m]=++I),J0[m]-1}function l(u,p,m,v,M,O){const T=u+m>>1,k=p+v>>1;if(Math.abs(u-M)+Math.abs(p-O)>1&&$p[33*k+T])l(M,O,u,p,T,k),l(m,v,M,O,T,k);else{const N=A(u,p),F=A(m,v),$=A(M,O);E.emplaceBack(N,F,$)}}return l(0,0,32,32,32,0),l(32,32,0,0,0,32),{vertices:P,indices:E}}(this.tileID.canonical,r);c=f.vertices,d=f.indices}else{c=new nl,d=new Mi;for(const{x:g,y}of s)c.emplaceBack(g,y,0,0);const f=O0(c.int16,void 0,4);for(let g=0;g<f.length;g+=3)d.emplaceBack(f[g],f[g+1],f[g+2])}this._tileBoundsBuffer=t.createVertexBuffer(c,$1.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(d),this._tileBoundsSegments=lo.simpleSegment(0,0,c.length,d.length)}_makeGlobeTileDebugBuffers(t,r){const s=r.projection;if(!s||"globe"!==s.name||r.freezeTileCoverage)return;const c=this.tileID.canonical,d=lf(AP(c,r)),f=Pi(r.zoom);let g;f>0&&(g=bt.invert(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,c,r,d,g,f),this._makeGlobeTileDebugTextBuffer(t,c,r,d,g,f)}_globePoint(t,r,s,c,d,f,g){let y=af(t,r,s);if(f){const b=1<<s.z,C=yi(c.center.lng),P=Oo(c.center.lat),E=(s.x+.5)/b-C;let I=0;E>.5?I=-1:E<-.5&&(I=1);let A=(t/Dt+s.x)/b+I,l=(r/Dt+s.y)/b;A=(A-C)*c._pixelsPerMercatorPixel+C,l=(l-P)*c._pixelsPerMercatorPixel+P;const u=[A*c.worldSize,l*c.worldSize,0];dt.transformMat4(u,u,f),y=Ud(y,u,g)}return dt.transformMat4(y,y,d)}_makeGlobeTileDebugBorderBuffer(t,r,s,c,d,f){const g=new pa,y=new c_,b=new l_,C=(E,I,A,l,u)=>{const p=(A-E)/(u-1),m=(l-I)/(u-1),v=g.length;for(let M=0;M<u;M++){const O=E+M*p,T=I+M*m;g.emplaceBack(O,T);const k=this._globePoint(O,T,r,s,c,d,f);b.emplaceBack(k[0],k[1],k[2]),y.emplaceBack(v+M)}},P=Dt;C(0,0,P,0,16),C(P,0,P,P,16),C(P,P,0,P,16),C(0,P,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(y),this._tileDebugBuffer=t.createVertexBuffer(g,Cp.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(b,TP.members),this._tileDebugSegments=lo.simpleSegment(0,0,g.length,y.length)}_makeGlobeTileDebugTextBuffer(t,r,s,c,d,f){const g=Dt/4,y=new pa,b=new Mi,C=new l_,P=25;b.reserve(32),y.reserve(P),C.reserve(P);const E=(I,A)=>P*I+A;for(let I=0;I<P;I++){const A=I*g;for(let l=0;l<P;l++){const u=l*g;y.emplaceBack(u,A);const p=this._globePoint(u,A,r,s,c,d,f);C.emplaceBack(p[0],p[1],p[2])}}for(let I=0;I<4;I++)for(let A=0;A<4;A++){const l=E(I,A),u=E(I,A+1),p=E(I+1,A),m=E(I+1,A+1);b.emplaceBack(l,u,p),b.emplaceBack(p,u,m)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(b),this._tileDebugTextBuffer=t.createVertexBuffer(y,Cp.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(C,TP.members),this._tileDebugTextSegments=lo.simpleSegment(0,0,P,32)}destroy(t=!1){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!t&&this.texture&&this.texture instanceof xo&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.latestFeatureIndex=null,this.state="unloaded"}}class G1{constructor(t,r){this.max=t,this.onRemove=r,this.reset()}reset(){for(const t in this.data)for(const r of this.data[t])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(t,r,s){const c=t.wrapped().key;void 0===this.data[c]&&(this.data[c]=[]);const d={value:r,timeout:void 0};if(void 0!==s&&(d.timeout=setTimeout(()=>{this.remove(t,d)},s)),this.data[c].push(d),this.order.push(c),this.order.length>this.max){const f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const r=this.data[t].shift();return r.timeout&&clearTimeout(r.timeout),0===this.data[t].length&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),r.value}getByKey(t){const r=this.data[t];return r?r[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,r){if(!this.has(t))return this;const s=t.wrapped().key,c=void 0===r?0:this.data[s].indexOf(r),d=this.data[s][c];return this.data[s].splice(c,1),d.timeout&&clearTimeout(d.timeout),0===this.data[s].length&&delete this.data[s],this.onRemove(d.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(t){const r=[];for(const s in this.data)for(const c of this.data[s])t(c.value)||r.push(c);for(const s of r)this.remove(s.value.tileID,s)}}let im=(()=>{class e{constructor(r,s,c,d){this.id=e.uniqueIdxCounter,e.uniqueIdxCounter++,this.context=r;const f=r.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||d||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){this.id=e.uniqueIdxCounter,e.uniqueIdxCounter++;const s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}return e.uniqueIdxCounter=0,e})();const uO={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class dO{constructor(t,r,s,c,d,f){this.length=r.length,this.attributes=s,this.itemSize=r.bytesPerElement,this.dynamicDraw=c,this.instanceCount=f,this.context=t;const g=t.gl;this.buffer=g.createBuffer(),t.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||d||r.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,r){for(let s=0;s<this.attributes.length;s++){const c=r.attributes[this.attributes[s].name];void 0!==c&&t.enableVertexAttribArray(c)}}setVertexAttribPointers(t,r,s){for(let c=0;c<this.attributes.length;c++){const d=this.attributes[c],f=r.attributes[d.name];void 0!==f&&t.vertexAttribPointer(f,d.components,t[uO[d.type]],!1,this.itemSize,d.offset+this.itemSize*(s||0))}}setVertexAttribDivisor(t,r,s){for(let c=0;c<this.attributes.length;c++){const d=r.attributes[this.attributes[c].name];void 0!==d&&this.instanceCount&&this.instanceCount>0&&t.vertexAttribDivisor(d,s)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class _r{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class H1 extends _r{getDefault(){return bn.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class cC extends _r{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class eh extends _r{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class nh extends _r{getDefault(){return[!0,!0,!0,!0]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class uC extends _r{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class dC extends _r{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class tv extends _r{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const r=this.current;(t.func!==r.func||t.ref!==r.ref||t.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class hC extends _r{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class NT extends _r{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=t,this.dirty=!1}}class fC extends _r{getDefault(){return[0,1]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class pC extends _r{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=t,this.dirty=!1}}class rh extends _r{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class ev extends _r{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.BLEND):r.disable(r.BLEND),this.current=t,this.dirty=!1}}class gC extends _r{getDefault(){const t=this.gl;return[t.ONE,t.ZERO,t.ONE,t.ZERO]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class oh extends _r{getDefault(){return bn.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Wc extends _r{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(t,t),this.current=t,this.dirty=!1)}}class gc extends _r{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=t,this.dirty=!1}}class mC extends _r{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class hO extends _r{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let fO=class extends _r{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};class FT extends _r{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class zT extends _r{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class BT extends _r{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class ih extends _r{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class sh extends _r{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class pO extends _r{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class gO extends _r{getDefault(){return null}set(t){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class mO extends _r{getDefault(){return null}set(t){this.gl&&(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class Cf extends _r{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class _C extends _r{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class _O extends _r{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class sm extends _r{constructor(t,r){super(t),this.context=t,this.parent=r}getDefault(){return null}}class q1 extends sm{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Mf extends sm{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,this.attachment(),r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Gp extends sm{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,this.attachment(),r.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Hp extends Mf{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class nv{constructor(t,r,s,c,d){this.context=t,this.width=r,this.height=s;const f=this.framebuffer=t.gl.createFramebuffer();c&&(this.colorAttachment=new q1(t,f)),d&&(this.depthAttachmentType=d,this.depthAttachment="renderbuffer"===d?new Mf(t,f):new Gp(t,f))}destroy(){const t=this.context.gl;if(this.colorAttachment){const r=this.colorAttachment.get();r&&t.deleteTexture(r)}if(this.depthAttachment&&this.depthAttachmentType)if("renderbuffer"===this.depthAttachmentType){const r=this.depthAttachment.get();r&&t.deleteRenderbuffer(r)}else{const r=this.depthAttachment.get();r&&t.deleteTexture(r)}t.deleteFramebuffer(this.framebuffer)}}class Pn{constructor(t,r,s){this.func=t,this.mask=r,this.range=s}}Pn.ReadOnly=!1,Pn.ReadWrite=!0,Pn.disabled=new Pn(519,Pn.ReadOnly,[0,1]);class Gn{constructor(t,r,s,c,d,f){this.test=t,this.ref=r,this.mask=s,this.fail=c,this.depthFail=d,this.pass=f}}Gn.disabled=new Gn({func:519,mask:0},0,0,7680,7680,7680);class Sr{constructor(t,r,s,c){this.blendFunction=t,this.blendColor=r,this.mask=s,this.blendEquation=c}}Sr.Replace=[1,0,1,0],Sr.disabled=new Sr(Sr.Replace,bn.transparent,[!1,!1,!1,!1]),Sr.unblended=new Sr(Sr.Replace,bn.transparent,[!0,!0,!0,!0]),Sr.alphaBlended=new Sr([1,771,1,771],bn.transparent,[!0,!0,!0,!0]),Sr.multiply=new Sr([774,0,774,0],bn.transparent,[!0,!0,!0,!0]);class Jn{constructor(t,r,s){this.enable=t,this.mode=r,this.frontFace=s}}Jn.disabled=new Jn(!1,1029,2305),Jn.backCCW=new Jn(!0,1029,2305),Jn.backCW=new Jn(!0,1029,2304),Jn.frontCW=new Jn(!0,1028,2304),Jn.frontCCW=new Jn(!0,1028,2305);class ov{constructor(t,r){this.gl=t,this.clearColor=new H1(this),this.clearDepth=new cC(this),this.clearStencil=new eh(this),this.colorMask=new nh(this),this.depthMask=new uC(this),this.stencilMask=new dC(this),this.stencilFunc=new tv(this),this.stencilOp=new hC(this),this.stencilTest=new NT(this),this.depthRange=new fC(this),this.depthTest=new pC(this),this.depthFunc=new rh(this),this.blend=new ev(this),this.blendFunc=new gC(this),this.blendColor=new oh(this),this.blendEquation=new Wc(this),this.cullFace=new gc(this),this.cullFaceSide=new mC(this),this.frontFace=new hO(this),this.program=new fO(this),this.activeTexture=new FT(this),this.viewport=new zT(this),this.bindFramebuffer=new BT(this),this.bindRenderbuffer=new ih(this),this.bindTexture=new sh(this),this.bindVertexBuffer=new pO(this),this.bindElementBuffer=new gO(this),this.bindVertexArrayOES=new mO(this),this.pixelStoreUnpack=new Cf(this),this.pixelStoreUnpackPremultiplyAlpha=new _C(this),this.pixelStoreUnpackFlipY=new _O(this),this.options=r?{...r}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=t.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,r,s){return new im(this,t,r,s)}createVertexBuffer(t,r,s,c,d){return new dO(this,t,r,s,c,d)}createRenderbuffer(t,r,s){const c=this.gl,d=c.createRenderbuffer();return this.bindRenderbuffer.set(d),c.renderbufferStorage(c.RENDERBUFFER,t,r,s),this.bindRenderbuffer.set(null),d}createFramebuffer(t,r,s,c){return new nv(this,t,r,s,c)}clear({color:t,depth:r,stencil:s,colorMask:c}){const d=this.gl;let f=0;t&&(f|=d.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(c||[!0,!0,!0,!0])),void 0!==r&&(f|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),void 0!==s&&(f|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(s),this.stencilMask.set(255)),d.clear(f)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){Xt(t.blendFunction,Sr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor),t.blendEquation?this.blendEquation.set(t.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(t.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class Fa extends Ro{constructor(t,r,s){super(),this.id=t,this._onlySymbols=s,r.on("data",c=>{"source"===c.dataType&&"metadata"===c.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===c.dataType&&"content"===c.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new G1(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this._coveredTiles={},this._shadowCasterTiles={},this._state=new R0,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(t){this.map=t,this._minTileCacheSize=void 0===this._minTileCacheSize&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const r=this._tiles[t];if("errored"!==r.state&&("loaded"!==r.state||!r.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,r){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,r)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const s=this._tiles[r];s.upload(t),s.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return pe(this._tiles).map(t=>t.tileID).sort(Pf).map(t=>t.key)}getRenderableIds(t,r){const s=[];for(const c in this._tiles)this._isIdRenderable(+c,t,r)&&s.push(this._tiles[c]);return t?s.sort((c,d)=>{const f=c.tileID,g=d.tileID,y=new tt(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),b=new tt(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-g.overscaledZ||b.y-y.y||b.x-y.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort(Pf).map(c=>c.key)}hasRenderableParent(t){const r=this.findLoadedParent(t,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(t,r,s){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(r||!this._tiles[t].holdingForFade())&&(s||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)"errored"!==this._tiles[t].state&&this._reloadTile(+t,"reloading")}}_reloadTile(t,r){const s=this._tiles[t];s&&("loading"!==s.state&&(s.state=r),this._loadTile(s,this._tileLoaded.bind(this,s,t,r)))}_tileLoaded(t,r,s,c){if(c)if(t.state="errored",404!==c.status)this._source.fire(new Cn(c,{tile:t}));else{if(!(t.tileID.key in this._loadedParentTiles))return void this._source.fire(new de("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id}));if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const d=this.map.painter.terrain;this.update(this.transform,d.getScaledDemTileSize(),!0),d.resetTileLookupCache(this.id)}else this.update(this.transform)}else t.timeAdded=Mn.now(),"expired"===s&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(r,t),"raster-dem"===this._source.type&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new de("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const r=this.getRenderableIds();for(let c=0;c<r.length;c++){const d=r[c];if(t.neighboringTiles&&t.neighboringTiles[d]){const f=this.getTileByID(d);s(t,f),s(f,t)}}function s(c,d){if(!c.dem||c.dem.borderReady)return;c.needsHillshadePrepare=!0,c.needsDEMTextureUpload=!0;let f=d.tileID.canonical.x-c.tileID.canonical.x;const g=d.tileID.canonical.y-c.tileID.canonical.y,y=Math.pow(2,c.tileID.canonical.z),b=d.tileID.key;0===f&&0===g||Math.abs(g)>1||(Math.abs(f)>1&&(1===Math.abs(f+y)?f+=y:1===Math.abs(f-y)&&(f-=y)),d.dem&&c.dem&&(c.dem.backfillBorder(d.dem,f,g),c.neighboringTiles&&c.neighboringTiles[b]&&(c.neighboringTiles[b].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,r,s,c){for(const d in this._tiles){let f=this._tiles[d];if(c[d]||!f.hasData()||f.tileID.overscaledZ<=r||f.tileID.overscaledZ>s)continue;let g=f.tileID;for(;f&&f.tileID.overscaledZ>r+1;){const b=f.tileID.scaledTo(f.tileID.overscaledZ-1);f=this._tiles[b.key],f&&f.hasData()&&(g=b)}let y=g;for(;y.overscaledZ>r;)if(y=y.scaledTo(y.overscaledZ-1),t[y.key]){c[g.key]=g;break}}}findLoadedParent(t,r){if(t.key in this._loadedParentTiles){const s=this._loadedParentTiles[t.key];return s&&s.tileID.overscaledZ>=r?s:null}for(let s=t.overscaledZ-1;s>=r;s--){const c=t.scaledTo(s),d=this._getLoadedTile(c);if(d)return d}}_getLoadedTile(t){const r=this._tiles[t.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,r){r=r||this._source.tileSize;const s=Math.ceil(t.width/r)+1,c=Math.ceil(t.height/r)+1,d=Math.floor(s*c*5),f="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,d):d,g="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(g)}handleWrapJump(t){const r=Math.round((t-(void 0===this._prevLng?t:this._prevLng))/360);if(this._prevLng=t,r){const s={};for(const c in this._tiles){const d=this._tiles[c];d.tileID=d.tileID.unwrapTo(d.tileID.wrap+r),s[d.tileID.key]=d}this._tiles=s;for(const c in this._timers)clearTimeout(this._timers[c]),delete this._timers[c];for(const c in this._tiles)this._setTileReloadTimer(+c,this._tiles[c])}}update(t,r,s,c){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let d;if(this.updateCacheSize(t,r),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new Ir(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y)):(d=t.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(d=d.filter(y=>this._source.hasTile(y)))):d=[],d.length>0&&this.castsShadows&&c&&"globe"!==this.transform.projection.name&&!this.usedForTerrain&&!yC(this._source.type)){const y=t.coveringZoomLevel({tileSize:r||this._source.tileSize,roundZoom:this._source.roundZoom&&!s}),b=Math.min(y,this._source.maxzoom),C=t.extendTileCoverForShadows(d,c,b);for(const P of C)this._shadowCasterTiles[P.key]=!0,d.push(P)}const f=this._updateRetainedTiles(d);if(yC(this._source.type)&&0!==d.length){const y={},b={},C=Object.keys(f);for(const E of C){const I=f[E],A=this._tiles[E];if(!A||A.fadeEndTime&&A.fadeEndTime<=Mn.now())continue;const l=this.findLoadedParent(I,Math.max(I.overscaledZ-Fa.maxOverzooming,this._source.minzoom));l&&(this._addTile(l.tileID),y[l.tileID.key]=l.tileID),b[E]=I}const P=d[d.length-1].overscaledZ;for(const E in this._tiles){const I=this._tiles[E];if(f[E]||!I.hasData())continue;let A=I.tileID;for(;A.overscaledZ>P;){A=A.scaledTo(A.overscaledZ-1);const l=this._tiles[A.key];if(l&&l.hasData()&&b[A.key]){f[E]=I.tileID;break}}}for(const E in y)f[E]||(this._coveredTiles[E]=!0,f[E]=y[E])}for(const y in f)this._tiles[y].clearFadeHold();const g=function(y,b){const C=[];for(const P in y)P in b||C.push(P);return C}(this._tiles,f);for(const y of g){const b=this._tiles[y];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(+y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const r={};if(0===t.length)return r;const s={},c=t.reduce((b,C)=>Math.min(b,C.overscaledZ),1/0),d=t[0].overscaledZ,f=Math.max(d-Fa.maxOverzooming,this._source.minzoom),g=Math.max(d+Fa.maxUnderzooming,this._source.minzoom),y={};for(const b of t){const C=this._addTile(b);r[b.key]=b,C.hasData()||c<this._source.maxzoom&&(y[b.key]=b)}this._retainLoadedChildren(y,c,g,r);for(const b of t){let C=this._tiles[b.key];if(C.hasData())continue;if(b.canonical.z>=this._source.maxzoom){const E=b.children(this._source.maxzoom)[0],I=this.getTile(E);if(I&&I.hasData()){r[E.key]=E;continue}}else{const E=b.children(this._source.maxzoom);if(r[E[0].key]&&r[E[1].key]&&r[E[2].key]&&r[E[3].key])continue}let P=C.wasRequested();for(let E=b.overscaledZ-1;E>=f;--E){const I=b.scaledTo(E);if(s[I.key]||(s[I.key]=!0,C=this.getTile(I),!C&&P&&(C=this._addTile(I)),C&&(r[I.key]=I,P=C.wasRequested(),C.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const r=[];let s,c=this._tiles[t].tileID;for(;c.overscaledZ>0;){if(c.key in this._loadedParentTiles){s=this._loadedParentTiles[c.key];break}r.push(c.key);const d=c.scaledTo(c.overscaledZ-1);if(s=this._getLoadedTile(d),s)break;c=d}for(const d of r)this._loadedParentTiles[d]=s}}_addTile(t){let r=this._tiles[t.key];if(r)return!0!==r.isExtraShadowCaster||this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),r;r=this._cache.getAndRemove(t),r&&(this._setTileReloadTimer(t.key,r),r.tileID=t,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,r)));const s=!!r;if(!s){const c=this.map?this.map.painter:null;r=new Ki(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,c,this._isRaster),this._loadTile(r,this._tileLoaded.bind(this,r,t.key,r.state))}return r?(r.uses++,this._tiles[t.key]=r,s||this._source.fire(new de("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(t,r){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const s=r.getExpiryTimeout();s&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},s))}_removeTile(t){const r=this._tiles[t];r&&(r.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),r.uses>0||(r.hasData()&&"reloading"!==r.state?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,r,s){const c=[],d=this.transform;if(!d)return c;const f="globe"===d.projection.name,g=yi(d.center.lng);for(const y in this._tiles){const b=this._tiles[y];if(s&&b.clearQueryDebugViz(),b.holdingForFade())continue;let C;if(f){const P=b.tileID.canonical;if(0===P.z){const E=[Math.abs(Ne(g,...ry(P,-1))-g),Math.abs(Ne(g,...ry(P,1))-g)];C=[0,2*E.indexOf(Math.min(...E))-1]}else{const E=[Math.abs(Ne(g,...ry(P,-1))-g),Math.abs(Ne(g,...ry(P,0))-g),Math.abs(Ne(g,...ry(P,1))-g)];C=[E.indexOf(Math.min(...E))-1]}}else C=[0];for(const P of C){const E=t.containsTile(b,d,r,P);E&&c.push(E)}}return c}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,r){const s=this.getRenderableIds(t,r).map(d=>this._tiles[d].tileID),c="globe"===this.transform.projection.name;for(const d of s)d.projMatrix=this.transform.calculateProjMatrix(d.toUnwrapped()),d.expandedProjMatrix=c?this.transform.calculateProjMatrix(d.toUnwrapped(),!1,!0):d.projMatrix;return s}sortCoordinatesByDistance(t){const r=t.slice(),s=this.transform._camera.position,c=this.transform._camera.forward(),d={};for(const f of r){const g=1/(1<<f.canonical.z);d[f.key]=((f.canonical.x+.5)*g+f.wrap-s[0])*c[0]+((f.canonical.y+.5)*g-s[1])*c[1]-s[2]*c[2]}return r.sort((f,g)=>d[f.key]-d[g.key]),r}hasTransition(){if(this._source.hasTransition())return!0;if(yC(this._source.type))for(const t in this._tiles){const r=this._tiles[t];if(void 0!==r.fadeEndTime&&r.fadeEndTime>=Mn.now())return!0}return!1}setFeatureState(t,r,s){this._state.updateState(t=t||"_geojsonTileLayer",r,s)}removeFeatureState(t,r,s){this._state.removeFeatureState(t=t||"_geojsonTileLayer",r,s)}getFeatureState(t,r){return this._state.getState(t=t||"_geojsonTileLayer",r)}setDependencies(t,r,s){const c=this._tiles[t];c&&c.setDependencies(r,s)}reloadTilesForDependencies(t,r){for(const s in this._tiles)this._tiles[s].hasDependency(t,r)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(t,r))}_preloadTiles(t,r){if(!this._sourceLoaded){const g=()=>{this._sourceLoaded&&(this._source.off("data",g),this._preloadTiles(t,r))};return void this._source.on("data",g)}const s=new Map,c=Array.isArray(t)?t:[t],d=this.map.painter.terrain,f=this.usedForTerrain&&d?d.getScaledDemTileSize():this._source.tileSize;for(const g of c){const y=g.coveringTiles({tileSize:f,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const b of y)s.set(b.key,b);this.usedForTerrain&&g.updateElevation(!1)}Kt(Array.from(s.values()),(g,y)=>{const b=new Ki(g,this._source.tileSize*g.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(b,C=>{"raster-dem"===this._source.type&&b.dem&&this._backfillDEM(b),y(C,b)})},r)}}function Pf(e,t){const r=Math.abs(2*e.wrap)-+(e.wrap<0),s=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||s-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function yC(e){return"raster"===e||"image"===e||"video"===e||"custom"===e}function ry(e,t){const r=1<<e.z;return[e.x/r+t,(e.x+1)/r+t]}Fa.maxOverzooming=10,Fa.maxUnderzooming=3;const UT=Dr([{name:"a_pos_3f",components:3,type:"Float32"}]),VT=Dr([{name:"a_color_3f",components:3,type:"Float32"}]),jT=Dr([{name:"a_color_4f",components:4,type:"Float32"}]),iv=Dr([{name:"a_uv_2f",components:2,type:"Float32"}]),cm=Dr([{name:"a_normal_3f",components:3,type:"Float32"}]),qp=Dr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),yO=Dr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class vC{constructor(t=0,r=0,s=0,c=0){if(isNaN(t)||t<0||isNaN(r)||r<0||isNaN(s)||s<0||isNaN(c)||c<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=r,this.left=s,this.right=c}interpolate(t,r,s){return null!=r.top&&null!=t.top&&(this.top=vn(t.top,r.top,s)),null!=r.bottom&&null!=t.bottom&&(this.bottom=vn(t.bottom,r.bottom,s)),null!=r.left&&null!=t.left&&(this.left=vn(t.left,r.left,s)),null!=r.right&&null!=t.right&&(this.right=vn(t.right,r.right,s)),this}getCenter(t,r){const s=Ne((this.left+t-this.right)/2,0,t),c=Ne((this.top+r-this.bottom)/2,0,r);return new tt(s,c)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new vC(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function bC(e,t){const r=ur(e,3);bt.fromQuat(e,t),yn(e,3,r)}function xC(e,t){const r=Bi.identity([]);return Bi.rotateZ(r,r,-t),Bi.rotateX(r,r,-e),r}function W1(e,t){const r=[e[0],e[1],0],s=[t[0],t[1],0];if(dt.length(r)>=1e-15){const f=dt.normalize([],r);dt.scale(s,f,dt.dot(s,f)),t[0]=s[0],t[1]=s[1]}const c=dt.cross([],t,e);if(dt.len(c)<1e-15)return null;const d=Math.atan2(-c[1],c[0]);return xC(Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2]),d)}class K1{constructor(t,r){this.position=t,this.orientation=r}get position(){return this._position}set position(t){if(t){const r=t instanceof Xn?t:new Xn(t[0],t[1],t[2]);this._renderWorldCopies&&(r.x=Wt(r.x,0,1)),this._position=r}else this._position=null}lookAtPoint(t,r){if(this.orientation=null,!this.position)return;const s=this.position,c=this._elevation?this._elevation.getAtPointOrZero(Xn.fromLngLat(t)):0,d=Xn.fromLngLat(t,c),f=[d.x-s.x,d.y-s.y,d.z-s.z];r||(r=[0,0,1]),r[2]=Math.abs(r[2]),this.orientation=W1(f,r)}setPitchBearing(t,r){this.orientation=xC(Ct(t),Ct(-r))}}class sv{constructor(t,r){this._transform=bt.identity([]),this.orientation=r,this.position=t}get mercatorPosition(){const t=this.position;return new Xn(t[0],t[1],t[2])}get position(){const t=ur(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var r;t&&yn(this._transform,3,[(r=t)[0],r[1],r[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||Bi.identity([]),t&&bC(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),r=this.right();return{bearing:Math.atan2(-r[1],r[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,r){this._orientation=xC(t,r),bC(this._transform,this._orientation)}forward(){const t=ur(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=ur(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=ur(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,r){const s=new Float64Array(16);return bt.invert(s,this.getWorldToCamera(t,r)),s}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(t,r,s){const c=this.position;dt.scale(c,c,-t);const d=new Float64Array(16);return bt.fromScaling(d,[s,s,s]),bt.translate(d,d,c),d[10]*=r,d}getWorldToCamera(t,r){const s=new Float64Array(16),c=new Float64Array(4),d=this.position;return Bi.conjugate(c,this._orientation),dt.scale(d,d,-t),bt.fromQuat(s,c),bt.translate(s,s,d),s[1]*=-1,s[5]*=-1,s[9]*=-1,s[13]*=-1,s[8]*=r,s[9]*=r,s[10]*=r,s[11]*=r,s}getCameraToClipPerspective(t,r,s,c){const d=new Float64Array(16);return bt.perspective(d,t,r,s,c),d}getCameraToClipOrthographic(t,r,s,c,d,f){const g=new Float64Array(16);return bt.ortho(g,t,r,s,c,d,f),g}getDistanceToElevation(t,r=!1){const s=0===t?0:oo(t,r?ti(this.position[1]):this.position[1]),c=this.forward();return(s-this.position[2])/c[2]}clone(){return new sv([...this.position],[...this.orientation])}}function Y1(e,t){const r=oy(e.projection,e.zoom,e.width,e.height),s=function(d,f,g,y,b){const C=new kn(g.lng-180*Kc,g.lat),P=new kn(g.lng+180*Kc,g.lat),E=d.project(C.lng,C.lat),I=d.project(P.lng,P.lat),A=-Math.atan2(I.y-E.y,I.x-E.x),l=Xn.fromLngLat(g);l.y=Ne(l.y,-1+Kc,1-Kc);const u=l.toLngLat(),p=d.project(u.lng,u.lat),m=Xn.fromLngLat(u);m.x+=Kc;const v=m.toLngLat(),M=d.project(v.lng,v.lat),O=av(M.x-p.x,M.y-p.y,A),T=Xn.fromLngLat(u);T.y+=Kc;const k=T.toLngLat(),N=d.project(k.lng,k.lat),F=av(N.x-p.x,N.y-p.y,A),$=Math.abs(O.x)/Math.abs(F.y),q=bt.identity([]);bt.rotateZ(q,q,-A*(1-(b?0:y)));const Z=bt.identity([]);return bt.scale(Z,Z,[1,1-(1-$)*y,1]),Z[4]=-F.x/F.y*y,bt.rotateZ(Z,Z,A),bt.multiply(Z,q,Z),Z}(e.projection,0,e.center,r,t),c=X1(e);return bt.scale(s,s,[c,c,1]),s}function X1(e){const t=e.projection,r=oy(e.projection,e.zoom,e.width,e.height),s=wC(t,e.center),c=wC(t,kn.convert(t.center));return Math.pow(2,s*r+(1-r)*c)}function oy(e,t,r,s,c=1/0){const d=e.range;if(!d)return 0;const f=Math.min(c,Math.max(r,s)),g=Math.log(f/1024)/Math.LN2;return vs(d[0]+g,d[1]+g,t)}const Kc=1/4e4;function wC(e,t){const r=Ne(t.lat,-vo,vo),s=new kn(t.lng-180*Kc,r),c=new kn(t.lng+180*Kc,r),d=e.project(s.lng,r),f=e.project(c.lng,r),g=Xn.fromLngLat(s),y=Xn.fromLngLat(c),b=f.x-d.x,C=f.y-d.y,P=y.x-g.x,E=y.y-g.y,I=Math.sqrt((P*P+E*E)/(b*b+C*C));return Math.log(I)/Math.LN2}function av(e,t,r){const s=Math.cos(r),c=Math.sin(r);return{x:e*s-t*c,y:e*c+t*s}}function td(e,t,r){return t*(Dt/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}const um={unknown:0,flipRequired:1,flipNotRequired:2},CC=Math.tan(85*Math.PI/180);function Of(e,t,r,s,c,d,f){const g=bt.create();if(r)if("globe"===d.name){const y=function(b,C){const{x:P,y:E}=b.point,I=c1(P,E,b.worldSize/b._pixelsPerMercatorPixel,0,0);return bt.multiply(I,I,D_(Po(C)))}(c,t);bt.multiply(g,g,y)}else{const y=Rg.invert([],f);g[0]=y[0],g[1]=y[1],g[4]=y[2],g[5]=y[3],s||bt.rotateZ(g,g,c.angle)}else bt.multiply(g,c.labelPlaneMatrix,e);return g}function iy(e,t,r,s,c,d,f){const g=Of(e,t,r,s,c,d,f);return"globe"===d.name&&r||(g[2]=g[6]=g[10]=g[14]=0),g}function dm(e,t,r,s,c,d,f){if(r){if("globe"===d.name){const g=Of(e,t,r,s,c,d,f);return bt.invert(g,g),bt.multiply(g,e,g),g}{const g=bt.clone(e),y=bt.identity([]);return y[0]=f[0],y[1]=f[1],y[4]=f[2],y[5]=f[3],bt.multiply(g,g,y),s||bt.rotateZ(g,g,-c.angle),g}}return c.glCoordMatrix}function mc(e,t,r,s){const c=[e,t,r,1];r?kr.transformMat4(c,c,s):$T(c,c,s);const d=c[3];return c[0]/=d,c[1]/=d,c[2]/=d,c}function Q1(e,t){return Math.min(.5+e/t*.5,1.5)}function is(e,t){const r=e[0]/e[3],s=e[1]/e[3];return r>=-t[0]&&r<=t[0]&&s>=-t[1]&&s<=t[1]}function vO(e,t,r,s,c,d,f,g,y,b){const C=r.transform,P=s?e.textSizeData:e.iconSizeData,E=ui(P,r.transform.zoom),I="globe"===C.projection.name,A=[256/r.width*2+1,256/r.height*2+1],l=s?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;l.clear();let u=null;I&&(u=s?e.text.globeExtVertexArray:e.icon.globeExtVertexArray);const p=e.lineVertexArray,m=s?e.text.placedSymbolArray:e.icon.placedSymbolArray,v=r.transform.width/r.transform.height;let M,O=!1;for(let T=0;T<m.length;T++){const k=m.get(T),{numGlyphs:N,writingMode:F}=k;if(F!==so.vertical||O||M===so.horizontal||(O=!0),M=F,(k.hidden||F===so.vertical)&&!O){_c(N,l);continue}O=!1;const $=new tt(k.tileAnchorX,k.tileAnchorY);let{x:q,y:Z,z:X}=C.projection.projectTilePoint($.x,$.y,b.canonical);if(y){const[zt,Nt,$t]=y($);q+=zt,Z+=Nt,X+=$t}const K=[q,Z,X,1];if(kr.transformMat4(K,K,t),!is(K,A)){_c(N,l);continue}const J=K[3],st=Q1(r.transform.getCameraToCenterDistance(C.projection),J),it=Wg(P,E,k),rt=f?it/st:it*st,ct=mc(q,Z,X,c);if(ct[3]<=0){_c(N,l);continue}let yt={};const Et=f?null:y,Tt=bO(k,rt,!1,g,t,c,d,e.glyphOffsetArray,p,l,u,ct,$,yt,v,Et,C.projection,b,f);O=Tt.useVertical,Et&&Tt.needsFlipping&&(yt={}),(Tt.notEnoughRoom||O||Tt.needsFlipping&&bO(k,rt,!0,g,t,c,d,e.glyphOffsetArray,p,l,u,ct,$,yt,v,Et,C.projection,b,f).notEnoughRoom)&&_c(N,l)}s?(e.text.dynamicLayoutVertexBuffer.updateData(l),u&&e.text.globeExtVertexBuffer&&e.text.globeExtVertexBuffer.updateData(u)):(e.icon.dynamicLayoutVertexBuffer.updateData(l),u&&e.icon.globeExtVertexBuffer&&e.icon.globeExtVertexBuffer.updateData(u))}function lv(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l){const{lineStartIndex:u,glyphStartIndex:p,segment:m}=g,v=p+g.numGlyphs,M=u+g.lineLength,O=t.getoffsetX(p),T=t.getoffsetX(v-1),k=ay(e*O,r,s,c,d,f,m,u,M,y,b,C,P,E,!0,I,A,l);if(!k)return null;const N=ay(e*T,r,s,c,d,f,m,u,M,y,b,C,P,E,!0,I,A,l);return N?{first:k,last:N}:null}function ah(e,t,r,s){return e===so.horizontal&&Math.abs(s)>Math.abs(r)?{useVertical:!0}:e===so.vertical?s>0?{needsFlipping:!0}:null:t!==um.unknown&&(0===(c=r)||Math.abs(s/c)>CC)?t===um.flipRequired?{needsFlipping:!0}:null:r<0?{needsFlipping:!0}:null;var c}function bO(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p,m){const v=t/24,M=e.lineOffsetX*v,O=e.lineOffsetY*v,{lineStartIndex:T,glyphStartIndex:k,numGlyphs:N,segment:F,writingMode:$,flipState:q}=e,Z=T+e.lineLength,X=K=>{if(C){const[rt,ct,yt]=K.up,Et=b.length;W0(C,Et+0,rt,ct,yt),W0(C,Et+1,rt,ct,yt),W0(C,Et+2,rt,ct,yt),W0(C,Et+3,rt,ct,yt)}const[J,st,it]=K.point;di(b,J,st,it,K.angle)};if(N>1){const K=lv(v,g,M,O,r,P,E,e,y,d,I,l,!1,u,p,m);if(!K)return{notEnoughRoom:!0};if(s&&!r){let[J,st,it]=K.first.point,[rt,ct,yt]=K.last.point;[J,st]=mc(J,st,it,f),[rt,ct]=mc(rt,ct,yt,f);const Et=ah($,q,(rt-J)*A,ct-st);if(e.flipState=Et&&Et.needsFlipping?um.flipRequired:um.flipNotRequired,Et)return Et}X(K.first);for(let J=k+1;J<k+N-1;J++){const st=ay(v*g.getoffsetX(J),M,O,r,P,E,F,T,Z,y,d,I,l,!1,!1,u,p,m);if(!st)return b.length-=4*(J-k),{notEnoughRoom:!0};X(st)}X(K.last)}else{if(s&&!r){const J=mc(E.x,E.y,0,c),st=T+F+1,it=new tt(y.getx(st),y.gety(st)),rt=mc(it.x,it.y,0,c),ct=rt[3]>0?rt:sy(E,it,J,1,c,void 0,u,p.canonical),yt=ah($,q,(ct[0]-J[0])*A,ct[1]-J[1]);if(e.flipState=yt&&yt.needsFlipping?um.flipRequired:um.flipNotRequired,yt)return yt}const K=ay(v*g.getoffsetX(k),M,O,r,P,E,F,T,Z,y,d,I,l,!1,!1,u,p,m);if(!K)return{notEnoughRoom:!0};X(K)}return{}}function ed(e,t,r,s,c){const{x:d,y:f,z:g}=s.projectTilePoint(e.x,e.y,t);if(!c)return mc(d,f,g,r);const[y,b,C]=c(e);return mc(d+y,f+b,g+C,r)}function sy(e,t,r,s,c,d,f,g){const y=ed(e.sub(t)._unit()._add(e),g,c,f,d);return dt.sub(y,r,y),dt.normalize(y,y),dt.scaleAndAdd(y,r,y,s)}function ay(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p){const m=s?e-t:e+t;let v=m>0?1:-1,M=0;s&&(v*=-1,M=Math.PI),v<0&&(M+=Math.PI);let O=g+f+(v>0?0:1)|0,T=c,k=c,N=0,F=0;const $=Math.abs(m),q=[],Z=[];let X=d,K=X;const J=()=>sy(K,X,k,$-N+1,C,E,l,u.canonical);for(;N+F<=$;){if(O+=v,O<g||O>=y)return null;if(k=T,K=X,q.push(k),I&&Z.push(K),X=new tt(b.getx(O),b.gety(O)),T=P[O],!T){const Nt=ed(X,u.canonical,C,l,E);T=Nt[3]>0?P[O]=Nt:J()}N+=F,F=dt.distance(k,T)}A&&E&&(P[O]&&(T=J(),F=dt.distance(k,T)),P[O]=T);const st=($-N)/F,it=X.sub(K)._mult(st)._add(K),rt=dt.sub([],T,k),ct=dt.scaleAndAdd([],k,rt,st);let yt=[0,0,1],Et=rt[0],Tt=rt[1];if(p&&(yt=l.upVector(u.canonical,it.x,it.y),0!==yt[0]||0!==yt[1]||1!==yt[2])){const Nt=[yt[2],0,-yt[0]],$t=dt.cross([],yt,Nt);dt.normalize(Nt,Nt),dt.normalize($t,$t),Et=dt.dot(rt,Nt),Tt=dt.dot(rt,$t)}if(r){const Nt=dt.cross([],yt,rt);dt.normalize(Nt,Nt),dt.scaleAndAdd(ct,ct,Nt,r*v)}const zt=M+Math.atan2(Tt,Et);return q.push(ct),I&&Z.push(it),{point:ct,angle:zt,path:q,tilePath:Z,up:yt}}function _c(e,t){const r=t.length,s=r+4*e;t.resize(s),t.float32.fill(-1/0,4*r,4*s)}function $T(e,t,r){const s=t[0],c=t[1];return e[0]=r[0]*s+r[4]*c+r[12],e[1]=r[1]*s+r[5]*c+r[13],e[3]=r[3]*s+r[7]*c+r[15],e}const Yc=(e,t,r)=>(1-r)*e+r*t,MC=e=>e*e*e*e*e;class lh{constructor(t,r,s,c,d,f,g){this.tileSize=512,this._renderWorldCopies=void 0===d||d,this._minZoom=t||0,this._maxZoom=r||22,this._minPitch=s??0,this._maxPitch=c??60,this.setProjection(f),this.setMaxBounds(g),this.width=0,this.height=0,this._center=new kn(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new vC,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new sv,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const t=new lh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get isOrthographic(){return"globe"!==this.projection.name&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return"globe"!==this.projection.name&&!this.isOrthographic}updateElevation(t,r=!1){const s=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||s)&&this._updateCameraOnTerrain(),(t||s)&&this._constrainCamera(r),this._calcMatrices()}getProjection(){return he(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const r=this.projection?this.getProjection():void 0;this.projection=kl(this.projectionOptions);const s=!Xt(r,this.getProjection());return s&&this._calcMatrices(),this.mercatorFromTransition=!1,s}setOrthographicProjectionAtLowPitch(t){return this._orthographicProjectionAtLowPitch!==t&&(this._orthographicProjectionAtLowPitch=t,this._calcMatrices(),!0)}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=kl({name:"mercator"});const r=t!==this.projection.name;return r&&this._calcMatrices(),r}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return oo(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new tt(this.width,this.height)}get bearing(){return Wt(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const r=-t*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=Rg.create(),Rg.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const r=Ne(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=Ct(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const r=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==r&&(this._unmodified=!1,this._setZoom(r),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){const t=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,r=this.elevation&&t===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||t===Number.NEGATIVE_INFINITY&&(!r||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const s=this._elevation;r||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&s.exaggeration()&&this._centerAltitudeValidForExaggeration!==s.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*s.exaggeration(),this._centerAltitudeValidForExaggeration=s.exaggeration()):(this._centerAltitude=t||0,this._centerAltitudeValidForExaggeration=s.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,r=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],s=this.horizonLineFromTop();let c=0,d=0;for(let f=0;f<r.length;f++){const g=new tt(r[f][0]*this.width,s+r[f][1]*(this.height-s)),y=t.pointCoordinate(g);if(!y)continue;const b=1/Math.hypot(y[0]-this._camera.position[0],y[1]-this._camera.position[1]);c+=y[3]*b,d+=b}return 0===d?NaN:c/d}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const t=this._seaLevelZoom,r=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),s=this.pixelsPerMeter/this.worldSize*r,c=this._mercatorZfromZoom(t),d=this._mercatorZfromZoom(this._maxZoom),f=Math.max(c-s,d);this._setZoom(this._zoomFromMercatorZ(f))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const r=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let s;s=t.z<this._camera.position[2]?[r.x,r.y,r.z]:[t.x,t.y,t.z];const c=dt.length(dt.sub([],this._camera.position,s));return Ne(this._zoomFromMercatorZ(c),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let r=!1;if(t.orientation&&!Bi.exactEquals(t.orientation,this._camera.orientation)&&(r=this._setCameraOrientation(t.orientation)),t.position){const s=[t.position.x,t.position.y,t.position.z];dt.exactEquals(s,this._camera.position)||(this._setCameraPosition(s),r=!0)}r&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,r=new K1;return r.position=new Xn(t[0],t[1],t[2]),r.orientation=this._camera.orientation,r._elevation=this.elevation,r._renderWorldCopies=this.renderWorldCopies,r}_setCameraOrientation(t){if(!Bi.length(t))return!1;Bi.normalize(t,t);const r=dt.transformQuat([],[0,0,-1],t),s=dt.transformQuat([],[0,-1,0],t);if(s[2]<0)return!1;const c=W1(r,s);return!!c&&(this._camera.orientation=c,!0)}_setCameraPosition(t){const r=this.zoomScale(this.minZoom)*this.tileSize,s=this.zoomScale(this.maxZoom)*this.tileSize,c=this.cameraToCenterDistance;t[2]=Ne(t[2],c/s,c/r),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,r,s){this._unmodified=!1,this._edgeInsets.interpolate(t,r,s),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const r=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,r)}getVisibleUnwrappedCoordinates(t){const r=[new f0(0,t)];if(this.renderWorldCopies){const s=this.pointCoordinate(new tt(0,0)),c=this.pointCoordinate(new tt(this.width,0)),d=this.pointCoordinate(new tt(this.width,this.height)),f=this.pointCoordinate(new tt(0,this.height)),g=Math.floor(Math.min(s.x,c.x,d.x,f.x)),y=Math.floor(Math.max(s.x,c.x,d.x,f.x)),b=1;for(let C=g-b;C<=y+b;C++)0!==C&&r.push(new f0(C,t))}return r}isLODDisabled(t){return(!t||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(t,r,s){let c=[];if(0===r[0]&&0===r[1])return c;for(const f of t){const g=f.canonical,y=f.overscaledZ,b=f.wrap,C=1<<g.z,P=g.x+1<C,E=g.x>0,I=g.y+1<C,A=g.y>0,l=f.wrap-(E?0:1),u=f.wrap+(P?0:1),p=E?g.x-1:C-1,m=P?g.x+1:0;r[0]<0?(c.push(new Ir(y,u,g.z,m,g.y)),r[1]<0&&I&&(c.push(new Ir(y,b,g.z,g.x,g.y+1)),c.push(new Ir(y,u,g.z,m,g.y+1))),r[1]>0&&A&&(c.push(new Ir(y,b,g.z,g.x,g.y-1)),c.push(new Ir(y,u,g.z,m,g.y-1)))):r[0]>0?(c.push(new Ir(y,l,g.z,p,g.y)),r[1]<0&&I&&(c.push(new Ir(y,b,g.z,g.x,g.y+1)),c.push(new Ir(y,l,g.z,p,g.y+1))),r[1]>0&&A&&(c.push(new Ir(y,b,g.z,g.x,g.y-1)),c.push(new Ir(y,l,g.z,p,g.y-1)))):r[1]<0&&I?c.push(new Ir(y,b,g.z,g.x,g.y+1)):A&&c.push(new Ir(y,b,g.z,g.x,g.y-1))}if(c.length>1){c.sort((y,b)=>y.overscaledZ-b.overscaledZ||y.wrap-b.wrap||y.canonical.z-b.canonical.z||y.canonical.x-b.canonical.x||y.canonical.y-b.canonical.y);let f=0,g=0;for(;g<c.length;)c[g].equals(c[f])?++g:c[++f]=c[g++];c.length=f+1}const d=[];for(const f of c)c.some(g=>f.isChildOf(g))||d.push(f);return c=d.filter(f=>!t.some(g=>!!(f.overscaledZ<s&&g.isChildOf(f))||f.equals(g)||f.isChildOf(g))),c}coveringTiles(t){let r=this.coveringZoomLevel(t);const s=r,c=this.elevation&&this.elevation.exaggeration(),d=c&&!t.isTerrainDEM,f="mercator"===this.projection.name;if(void 0!==t.minzoom&&r<t.minzoom)return[];void 0!==t.maxzoom&&r>t.maxzoom&&(r=t.maxzoom);const g=this.locationCoordinate(this.center),y=this.center.lat,b=1<<r,C=[b*g.x,b*g.y,0],P="globe"===this.projection.name,E=!P,I=sc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,E),A=P?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),l=b*oo(1,this.center.lat),u=this._camera.position[2]/oo(1,this.center.lat),p=[b*A.x,b*A.y,u*(E?1:l)],m=P||c,v=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),M=this.isLODDisabled(!0)?r:0;let O;if(this._elevation&&t.isTerrainDEM)O=1e4*this._elevation.exaggeration();else if(this._elevation){const rt=this._elevation.getMinMaxForVisibleTiles();O=rt?rt.max:this._centerAltitude}else O=this._centerAltitude;const T=t.isTerrainDEM?-O:this._elevation?this._elevation.getMinElevationBelowMSL():0,k=this.projection.isReprojectedInTileSpace?X1(this):1,N=rt=>{const yt=new Xn(rt.x+25e-6,rt.y,rt.z),Et=new Xn(rt.x,rt.y+25e-6,rt.z),Tt=rt.toLngLat(),zt=yt.toLngLat(),Nt=Et.toLngLat(),$t=this.locationCoordinate(Tt),Rt=this.locationCoordinate(zt),oe=this.locationCoordinate(Nt),Oe=Math.hypot(Rt.x-$t.x,Rt.y-$t.y),Ee=Math.hypot(oe.x-$t.x,oe.y-$t.y);return Math.sqrt(Oe*Ee)*k/25e-6},F=rt=>{const ct=O,yt=T;return{aabb:oO(this,b,0,0,0,rt,yt,ct,this.projection),zoom:0,x:0,y:0,minZ:yt,maxZ:ct,wrap:rt,fullyVisible:!1}},$=[];let q=[];const Z=r,X=t.reparseOverscaled?s:r,K=rt=>rt*rt,J=K((u-this._centerAltitude)*l),st=rt=>{if(!this._elevation||!rt.tileID||!f)return;const ct=this._elevation.getMinMaxForTile(rt.tileID),yt=rt.aabb;ct?(yt.min[2]=ct.min,yt.max[2]=ct.max,yt.center[2]=(yt.min[2]+yt.max[2])/2):(rt.shouldSplit=it(rt),rt.shouldSplit||(yt.min[2]=yt.max[2]=yt.center[2]=this._centerAltitude))},it=rt=>{if(rt.zoom<M)return!0;if(rt.zoom===Z)return!1;if(null!=rt.shouldSplit)return rt.shouldSplit;const ct=rt.aabb.distanceX(p),yt=rt.aabb.distanceY(p);let Et=J,Tt=1;if(P){Et=K(rt.aabb.distanceZ(p));const $t=Math.pow(2,rt.zoom),Rt=ti((rt.y+1)/$t),oe=ti(rt.y/$t),Oe=Math.min(Math.max(y,Rt),oe),Ee=x0(Oe)/x0(y);if(Tt=Oe===y?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ee/this._mercatorScaleRatio),this.zoom<=Bu&&rt.zoom===Z-1&&Ee>=.9)return!0}else if(d&&(Et=K(rt.aabb.distanceZ(p)*l)),this.projection.isReprojectedInTileSpace&&s<=5){const $t=Math.pow(2,rt.zoom),Rt=N(new Xn((rt.x+.5)/$t,(rt.y+.5)/$t));Tt=Rt>.85?1:Rt}const zt=ct*ct+yt*yt+Et;return zt<K((1<<Z-rt.zoom)*v*Tt*(($t,Rt)=>{if(Rt*K(.707)<$t)return 1;const oe=Math.sqrt(Rt/$t);return oe/(1.4144271570014144+(Math.pow(1.1,oe-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Et,J),zt))};if(this.renderWorldCopies)for(let rt=1;rt<=3;rt++)$.push(F(-rt)),$.push(F(rt));for($.push(F(0));$.length>0;){const rt=$.pop(),ct=rt.x,yt=rt.y;let Et=rt.fullyVisible;const Tt=()=>"globe"===this.projection.name&&(0===rt.y||rt.y===(1<<rt.zoom)-1);if(!Et){let zt=m?rt.aabb.intersects(I):rt.aabb.intersectsFlat(I);if(0===zt&&Tt()){const Nt=new ic(rt.zoom,ct,yt);zt=a1(this,b,Nt,!0).intersects(I)}if(0===zt)continue;Et=2===zt}if(rt.zoom!==Z&&it(rt))for(let zt=0;zt<4;zt++){const Nt=(ct<<1)+zt%2,$t=(yt<<1)+(zt>>1),Rt={aabb:f?rt.aabb.quadrant(zt):oO(this,b,rt.zoom+1,Nt,$t,rt.wrap,rt.minZ,rt.maxZ,this.projection),zoom:rt.zoom+1,x:Nt,y:$t,wrap:rt.wrap,fullyVisible:Et,tileID:void 0,shouldSplit:void 0,minZ:rt.minZ,maxZ:rt.maxZ};d&&!P&&(Rt.tileID=new Ir(rt.zoom+1===Z?X:rt.zoom+1,rt.wrap,rt.zoom+1,Nt,$t),st(Rt)),$.push(Rt)}else{const zt=rt.zoom===Z?X:rt.zoom;if(t.minzoom&&t.minzoom>zt)continue;if(!Et){let oe=m?rt.aabb.intersectsPrecise(I):rt.aabb.intersectsPreciseFlat(I);if(0===oe&&Tt()){const Oe=new ic(rt.zoom,ct,yt);oe=a1(this,b,Oe,!0).intersectsPrecise(I)}if(0===oe)continue}const Nt=C[0]-(.5+ct+(rt.wrap<<rt.zoom))*(1<<r-rt.zoom),$t=C[1]-.5-yt,Rt=rt.tileID?rt.tileID:new Ir(zt,rt.wrap,rt.zoom,ct,yt);q.push({tileID:Rt,distanceSq:Nt*Nt+$t*$t})}}if(this.fogCullDistSq){const rt=this.fogCullDistSq,ct=this.horizonLineFromTop();q=q.filter(yt=>{const Et=[0,0,0,1],Tt=[Dt,Dt,0,1],zt=this.calculateFogTileMatrix(yt.tileID.toUnwrapped());kr.transformMat4(Et,Et,zt),kr.transformMat4(Tt,Tt,zt);const Nt=function(oe,Oe,Ee){let Be=0;for(let je=0;je<2;++je)oe[je]>0&&(Be+=(oe[je]-0)*(oe[je]-0)),Oe[je]<0&&(Be+=(0-Oe[je])*(0-Oe[je]));return Be}(kr.min([],Et,Tt),kr.max([],Et,Tt));if(0===Nt)return!0;let $t=!1;const Rt=this._elevation;if(Rt&&Nt>rt&&0!==ct){const oe=this.calculateProjMatrix(yt.tileID.toUnwrapped());let Oe;t.isTerrainDEM||(Oe=Rt.getMinMaxForTile(yt.tileID)),Oe||(Oe={min:T,max:O});const Ee=function(je){const On=Math.round((je+45+360)%360/90)%4;return en[On]}(this.rotation),Be=[Ee[0]*Dt,Ee[1]*Dt,Oe.max];dt.transformMat4(Be,Be,oe),$t=(1-Be[1])*this.height*.5<ct}return Nt<rt||$t})}return q.sort((rt,ct)=>rt.distanceSq-ct.distanceSq).map(rt=>rt.tileID)}resize(t,r){this.width=t,this.height=r,this.pixelsToGLUnits=[2/t,-2/r],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const r=Ne(t.lat,-vo,vo),s=this.projection.project(t.lng,r);return new tt(s.x*this.worldSize,s.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/oo(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,r){let s,c;const d=this.centerPoint;if("globe"===this.projection.name){const g=this.worldSize;s=(r.x-d.x)/g,c=(r.y-d.y)/g}else{const g=this.pointCoordinate(r),y=this.pointCoordinate(d);s=g.x-y.x,c=g.y-y.y}const f=this.locationCoordinate(t);this.setLocation(new Xn(f.x-s,f.y-c))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,r){const s=r?oo(r,t.lat):void 0,c=this.projection.project(t.lng,t.lat);return new Xn(c.x,c.y,s)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,r){const s=r??this._centerAltitude,c=[t.x,t.y,0,1],d=[t.x,t.y,1,1];kr.transformMat4(c,c,this.pixelMatrixInverse),kr.transformMat4(d,d,this.pixelMatrixInverse);const f=d[3];kr.scale(c,c,1/c[3]),kr.scale(d,d,1/f);const g=c[2],y=d[2];return{p0:c,p1:d,t:g===y?0:(s-g)/(y-g)}}screenPointToMercatorRay(t){const r=[t.x,t.y,0,1],s=[t.x,t.y,1,1];return kr.transformMat4(r,r,this.pixelMatrixInverse),kr.transformMat4(s,s,this.pixelMatrixInverse),kr.scale(r,r,1/r[3]),kr.scale(s,s,1/s[3]),r[2]=oo(r[2],this._center.lat)*this.worldSize,s[2]=oo(s[2],this._center.lat)*this.worldSize,kr.scale(r,r,1/this.worldSize),kr.scale(s,s,1/this.worldSize),new e1([r[0],r[1],r[2]],dt.normalize([],dt.sub([],s,r)))}rayIntersectionCoordinate(t){const{p0:r,p1:s,t:c}=t,d=oo(r[2],this._center.lat),f=oo(s[2],this._center.lat);return new Xn(vn(r[0],s[0],c)/this.worldSize,vn(r[1],s[1],c)/this.worldSize,vn(d,f,c))}pointCoordinate(t,r=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,r)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let r=this.projection.pointCoordinate3D(this,t.x,t.y);if(r)return new Xn(r[0],r[1],r[2]);let s=0,c=this.horizonLineFromTop();if(t.y>c)return this.pointCoordinate(t);const d=.02*c,f=t.clone();for(let g=0;g<10&&c-s>d;g++){f.y=vn(s,c,.66);const y=this.projection.pointCoordinate3D(this,f.x,f.y);y?(c=f.y,r=y):s=f.y}return r?new Xn(r[0],r[1],r[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=Bd)return!this.isPointAboveHorizon(t);const r=this.pointCoordinate(t);return r.y>=0&&r.y<=1}_coordinatePoint(t,r){const s=r&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,c=[t.x*this.worldSize,t.y*this.worldSize,s+t.toAltitude(),1];return kr.transformMat4(c,c,this.pixelMatrix),c[3]>0?new tt(c[0]/c[3],c[1]/c[3]):new tt(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:r}=this._edgeInsets,s=this.height-this._edgeInsets.bottom,c=this.width-this._edgeInsets.right,d=this.pointLocation3D(new tt(r,t)),f=this.pointLocation3D(new tt(c,t)),g=this.pointLocation3D(new tt(c,s)),y=this.pointLocation3D(new tt(r,s));let b=Math.min(d.lng,f.lng,g.lng,y.lng),C=Math.max(d.lng,f.lng,g.lng,y.lng),P=Math.min(d.lat,f.lat,g.lat,y.lat),E=Math.max(d.lat,f.lat,g.lat,y.lat);const I=Math.pow(2,-this.zoom)/16*270,A="globe"===this.projection.name?1:4,l=(u,p,m,v,M)=>{const O=(u+m)/2,T=(p+v)/2,k=new tt(O,T),{lng:N,lat:F}=this.pointLocation3D(k),$=Math.max(0,b-N,P-F,N-C,F-E);b=Math.min(b,N),C=Math.max(C,N),P=Math.min(P,F),E=Math.max(E,F),(M<A||$>I)&&(l(u,p,O,T,M+1),l(O,T,m,v,M+1))};if(l(r,t,c,t,1),l(c,t,c,s,1),l(c,s,r,s,1),l(r,s,r,t,1),"globe"===this.projection.name){const[u,p]=function(m){const v=bt.identity(new Float64Array(16));bt.multiply(v,m.pixelMatrix,m.globeMatrix);const M=[0,na,0],O=[0,ma,0];return dt.transformMat4(M,M,v),dt.transformMat4(O,O,v),[M[0]>0&&M[0]<=m.width&&M[1]>0&&M[1]<=m.height&&!y0(m,new kn(m.center.lat,90)),O[0]>0&&O[0]<=m.width&&O[1]>0&&O[1]<=m.height&&!y0(m,new kn(m.center.lat,-90))]}(this);u?(E=90,C=180,b=-180):p&&(P=-90,C=180,b=-180)}return new Qo(new kn(b,P),new kn(C,E))}_getBoundsRectangular(t,r){const{top:s,left:c}=this._edgeInsets,d=this.height-this._edgeInsets.bottom,f=this.width-this._edgeInsets.right,g=new tt(c,s),y=new tt(f,s),b=new tt(f,d),C=new tt(c,d);let P=this.pointCoordinate(g,t),E=this.pointCoordinate(y,t);const I=this.pointCoordinate(b,r),A=this.pointCoordinate(C,r),l=(u,p)=>(p.y-u.y)/(p.x-u.x);return P.y>1&&E.y>=0?P=new Xn((1-A.y)/l(A,P)+A.x,1):P.y<0&&E.y<=1&&(P=new Xn(-A.y/l(A,P)+A.x,0)),E.y>1&&P.y>=0?E=new Xn((1-I.y)/l(I,E)+I.x,1):E.y<0&&P.y<=1&&(E=new Xn(-I.y/l(I,E)+I.x,0)),(new Qo).extend(this.coordinateLocation(P)).extend(this.coordinateLocation(E)).extend(this.coordinateLocation(A)).extend(this.coordinateLocation(I))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const r=t.visibleDemTiles.reduce((s,c)=>{if(c.dem){const d=c.dem.tree;s.min=Math.min(s.min,d.minimums[0]),s.max=Math.max(s.max,d.maximums[0])}return s},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(r.min*t.exaggeration(),r.max*t.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(t=!0){const r=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,s=this.height/2-r*(1-this._horizonShift);return t?Math.max(0,s):s}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-vo,this.maxLat=vo,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=yi(this.minLng)*this.tileSize,this.worldMaxX=yi(this.maxLng)*this.tileSize,this.worldMinY=Oo(this.maxLat)*this.tileSize,this.worldMaxY=Oo(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,r){return this.projection.createTileMatrix(this,r,t)}calculateDistanceTileData(t){const r=t.key,s=this._distanceTileDataCache;if(s[r])return s[r];const c=t.canonical,d=1/this.height,f=this.cameraWorldSize,g=f/this.zoomScale(c.z),y=(c.x+Math.pow(2,c.z)*t.wrap)*g,b=c.y*g,C=this.point;C.x*=f/this.worldSize,C.y*=f/this.worldSize;const P=this.angle,E=Math.sin(-P),I=-Math.cos(-P);return s[r]={bearing:[E,I],center:[(C.x-y)*d,(C.y-b)*d],scale:g/Dt*d},s[r]}calculateFogTileMatrix(t){const r=t.key,s=this._fogTileMatrixCache;if(s[r])return s[r];const c=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return bt.multiply(c,this.worldToFogMatrix,c),s[r]=new Float32Array(c),s[r]}calculateProjMatrix(t,r=!1,s=!1){const c=t.key;let d;if(d=s?this._expandedProjMatrixCache:r?this._alignedProjMatrixCache:this._projMatrixCache,d[c])return d[c];const f=this.calculatePosMatrix(t,this.worldSize);let g;return g=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:s?this.expandedFarZProjMatrix:r?this.alignedProjMatrix:this.projMatrix,bt.multiply(f,g,f),d[c]=new Float32Array(f),d[c]}calculatePixelsToTileUnitsMatrix(t){const r=t.tileID.key,s=this._pixelsToTileUnitsCache;if(s[r])return s[r];const c=function(d,f){const{scale:g}=d.tileTransform,y=g*Dt/(d.tileSize*Math.pow(2,f.zoom-d.tileID.overscaledZ+d.tileID.canonical.z));return Rg.scale(new Float32Array(4),f.inverseAdjustmentMatrix,[y,y])}(t,this);return s[r]=c,s[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const t=1/this.worldSize,r=bt.fromScaling([],[t,t,t]);return bt.multiply(r,r,this.globeMatrix),r}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const t=this._elevation;this._updateCameraState();const r=oo(1,this._center.lat)*this.worldSize,s=this._computeCameraPosition(r),c=this._camera.forward(),d=oo(1,this._center.lat);s[2]/=d,c[2]/=d,dt.normalize(c,c);const f=t.raycast(s,c,t.exaggeration());if(f){const g=dt.scaleAndAdd([],s,c,f),y=new Xn(g[0],g[1],oo(g[2],ti(g[1]))),b=(y.z+dt.length([y.x-s[0],y.y-s[1],y.z-s[2]*d]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(b),this._centerAltitude=y.toAltitude(),this._center=this.coordinateLocation(y),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const r=this._elevation,s=oo(1,this._center.lat)*this.worldSize,c=this._computeCameraPosition(s),d=r.getAtPointOrZero(new Xn(...c)),f=this.pixelsPerMeter/this.worldSize*d,g=this._minimumHeightOverTerrain(),y=c[2]-f;if(y<=g)if(y<0||t){const b=this.locationCoordinate(this._center,this._centerAltitude),C=[c[0],c[1],b.z-c[2]],P=dt.length(C);C[2]-=(g-y)/this._pixelsPerMercatorPixel;const E=dt.length(C);if(0===E)return;dt.scale(C,C,P/E*this._pixelsPerMercatorPixel),this._camera.position=[c[0],c[1],b.z*this._pixelsPerMercatorPixel-C[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const E=this.center;return E.lat=Ne(E.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(E.lng=Ne(E.lng,this.minLng,this.maxLng)),this.center=E,void(this._constraining=!1)}const r=this._unmodified,{x:s,y:c}=this.point;let d=0,f=s,g=c;const y=this.width/2,b=this.height/2,C=this.worldMinY*this.scale,P=this.worldMaxY*this.scale;if(c-b<C&&(g=C+b),c+b>P&&(g=P-b),P-C<this.height&&(d=Math.max(d,this.height/(P-C)),g=(P+C)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const E=this.worldMinX*this.scale,I=this.worldMaxX*this.scale,A=this.worldSize/2-(E+I)/2;f=(s+A+this.worldSize)%this.worldSize-A,f-y<E&&(f=E+y),f+y>I&&(f=I-y),I-E<this.width&&(d=Math.max(d,this.width/(I-E)),f=(I+E)/2)}f===s&&g===c||(this.center=this.unproject(new tt(f,g))),d&&(this.zoom+=this.scaleZoom(d)),this._constrainCamera(),this._unmodified=r,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,r="globe"===this.projection.name,s=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=oo(1,this.center.lat)/oo(1,45));const c=oy(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,c),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const d="meters"===this.projection.zAxisUnit?s:1,f=this._camera.getWorldToCamera(this.worldSize,d);let g;const y=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(y[8]=2*-t.x/this.width,y[9]=2*t.y/this.height,this.isOrthographic){let F=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),$=F*this.aspect,q=-$,Z=-F;$-=t.x,q-=t.x,F+=t.y,Z+=t.y,g=this._camera.getCameraToClipOrthographic(q,$,Z,F,this._nearZ,this._farZ),((X,K,J,st)=>{for(let it=0;it<16;it++)X[it]=Yc(K[it],J[it],st)})(g,g,y,MC(this.pitch>=15?1:this.pitch/15))}else g=y;const b=bt.mul([],y,f);let C=bt.mul([],g,f);if(this.projection.isReprojectedInTileSpace){const F=this.locationCoordinate(this.center),$=bt.identity([]);bt.translate($,$,[F.x*this.worldSize,F.y*this.worldSize,0]),bt.multiply($,$,Y1(this)),bt.translate($,$,[-F.x*this.worldSize,-F.y*this.worldSize,0]),bt.multiply(C,C,$),bt.multiply(b,b,$),this.inverseAdjustmentMatrix=function(q){const Z=Y1(q,!0);return Rg.invert([],[Z[0],Z[1],Z[4],Z[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=bt.scale([],C,[this.worldSize,this.worldSize,this.worldSize/d,1]),this.projMatrix=C,this.invProjMatrix=bt.invert(new Float64Array(16),this.projMatrix),r){const F=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);F[8]=2*-t.x/this.width,F[9]=2*t.y/this.height,this.expandedFarZProjMatrix=bt.mul([],F,f)}else this.expandedFarZProjMatrix=this.projMatrix;const P=bt.invert([],g);this.frustumCorners=n1.fromInvProjectionMatrix(P,this.horizonLineFromTop(),this.height),this.cameraFrustum=sc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!r);const E=new Float32Array(16);bt.identity(E),bt.scale(E,E,[1,-1,1]),bt.rotateX(E,E,this._pitch),bt.rotateZ(E,E,this.angle);const I=bt.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=bt.clone(I);const A=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;I[8]=2*-t.x/this.width,I[9]=2*(t.y+A)/this.height,this.skyboxMatrix=bt.multiply(E,I,E);const l=this.point,u=l.x,p=l.y,m=this.width%2/2,v=this.height%2/2,M=Math.cos(this.angle),O=Math.sin(this.angle),T=u-Math.round(u)+M*m+O*v,k=p-Math.round(p)+M*v+O*m,N=new Float64Array(C);if(bt.translate(N,N,[T>.5?T-1:T,k>.5?k-1:k,0]),this.alignedProjMatrix=N,C=bt.create(),bt.scale(C,C,[this.width/2,-this.height/2,1]),bt.translate(C,C,[1,-1,0]),this.labelPlaneMatrix=C,C=bt.create(),bt.scale(C,C,[1,-1,1]),bt.translate(C,C,[-1,-1,0]),bt.scale(C,C,[2/this.width,2/this.height,1]),this.glCoordMatrix=C,this.pixelMatrix=bt.multiply(new Float64Array(16),this.labelPlaneMatrix,b),this._calcFogMatrices(),this._distanceTileDataCache={},C=bt.invert(new Float64Array(16),this.pixelMatrix),!C)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=C,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=function($){const{x:q,y:Z}=$.point,{lng:X,lat:K}=$._center;return c1(q,Z,$.worldSize,X,K)}(this);const F=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=dt.transformMat4(F,F,f),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=C;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,r=this.cameraPixelsPerMeter,s=this._camera.position,c=1/this.height/this._pixelsPerMercatorPixel,d=[t,t,r];dt.scale(d,d,c),dt.scale(s,s,-1),dt.multiply(s,s,d);const f=bt.create();bt.translate(f,f,s),bt.scale(f,f,d),this.mercatorFogMatrix=f,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,r,c)}_computeCameraPosition(t){const r=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,s=this._camera.forward(),c=this.point,d=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*r-t/this.worldSize*this._centerAltitude;return[c.x/this.worldSize-s[0]*d,c.y/this.worldSize-s[1]*d,t/this.worldSize*this._centerAltitude-s[2]*d]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const r=this._maxCameraBoundsDistance()*Math.cos(this._pitch),s=this._camera.position[2],c=t[2];let d=1;this.projection.wrap&&(this.center=this.center.wrap()),c>0&&(d=Math.min((r-s)/c,1)),this._camera.position=dt.scaleAndAdd([],this._camera.position,t,d),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,r=this._camera.forward(),{pitch:s,bearing:c}=this._camera.getPitchBearing(),d=oo(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,f=this._mercatorZfromZoom(this._maxZoom)*Math.cos(Ct(this._maxPitch)),g=Math.max((t[2]-d)/Math.cos(s),f),y=this._zoomFromMercatorZ(g);dt.scaleAndAdd(t,t,r,g),this._pitch=Ne(s,Ct(this.minPitch),Ct(this.maxPitch)),this.angle=Wt(c,-Math.PI,Math.PI),this._setZoom(Ne(y,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new Xn(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(t){let r=0,s=Bd,c=0,d=1/0;for(;s-r>1e-6&&s>r;){const f=r+.5*(s-r),g=this.tileSize*Math.pow(2,f),y=this.getCameraToCenterDistance(this.projection,f,g),b=this.scaleZoom(y/(t*this.tileSize)),C=Math.abs(f-b);C<d&&(d=C,c=f),f<b?r=f:s=f}return c}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(gt("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,r){const s=Math.min(t.x,r.x),c=Math.max(t.x,r.x),d=Math.min(t.y,r.y),f=Math.max(t.y,r.y);if(d<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const g=[new tt(s,d),new tt(c,f),new tt(s,f),new tt(c,d)],y=this.renderWorldCopies?-3:0,b=this.renderWorldCopies?4:1;for(const C of g){const P=this.pointRayIntersection(C);if(P.t<0)return!0;const E=this.rayIntersectionCoordinate(P);if(E.x<y||E.y<0||E.x>b||E.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+ge(this.fovAboveCenter)>88||this.anyCornerOffEdge(new tt(0,0),new tt(this.width,this.height))}zoomDeltaToMovement(t,r){const s=dt.length(dt.sub([],this._camera.position,t)),c=this._zoomFromMercatorZ(s)+r;return s-this._mercatorZfromZoom(c)}getCameraPoint(){if("globe"===this.projection.name){const t=function([r,s,c],d){const f=[r,s,c,1];kr.transformMat4(f,f,d);const g=f[3]=Math.max(f[3],1e-6);return f[0]/=g,f[1]/=g,f[2]/=g,f}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new tt(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new tt(0,t))}}getCameraToCenterDistance(t,r=this.zoom,s=this.worldSize){const c=oy(t,r,this.width,this.height,1024),d=t.pixelSpaceConversion(this.center.lat,s,c);let f=.5/Math.tan(.5*this._fov)*this.height*d;return this.isOrthographic&&(f=Yc(1,f,MC(this.pitch>=15?1:this.pitch/15))),f}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&bt.multiply(t,t,this.globeMatrix),t}getFrustum(t){return sc.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,t,"meters"===this.projection.zAxisUnit)}}function PC(e,t,r){bt.identity(e),bt.rotateZ(e,e,Ct(t[2])),bt.rotateX(e,e,Ct(t[0])),bt.rotateY(e,e,Ct(t[1])),bt.scale(e,e,r),bt.multiply(e,e,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Ef(e,t,r,s,c,d,f,g){const y=[r[0]-t[0],r[1]-t[1],0],b=[s[0]-t[0],s[1]-t[1],0];if(dt.length(y)<1e-12||dt.length(b)<1e-12)return Bi.identity(e);const C=dt.cross([],y,b);dt.normalize(C,C),dt.subtract(b,s,t),y[2]=(d-c)*g,b[2]=(f-c)*g;const P=y;return dt.cross(P,y,b),dt.normalize(P,P),Bi.rotationTo(e,C,P)}function OC(e,t,r=!1){const s=Pi(t.zoom),c=function(d,f,g){const y=f.worldSize,b=[d[12],d[13],d[14]],C=ti(b[1]/y),P=ka(b[0]/y),E=bt.identity([]),I=oo(1,C)*y,A=oo(1,0)*y*go(C,f.zoom),l=1/Op(y);let u=A*l;if(g){const M=oy(f.projection,f.zoom,f.width,f.height,1024);u=l*f.projection.pixelSpaceConversion(f.center.lat,y,M)}const p=ra(C,P);dt.add(p,p,dt.scale([],dt.normalize([],p),I*u*b[2]));const m=function(M){const O=[M[0],M[1],M[2]];let T=[0,1,0];const k=dt.cross([],T,O);return dt.cross(T,O,k),0===dt.squaredLength(T)&&(T=[0,1,0],dt.cross(k,O,T)),dt.normalize(k,k),dt.normalize(T,T),dt.normalize(O,O),[k[0],k[1],k[2],0,T[0],T[1],T[2],0,O[0],O[1],O[2],0,M[0],M[1],M[2],1]}(p);bt.scale(E,E,[u,u,u*I]),bt.translate(E,E,[-b[0],-b[1],-b[2]]);const v=bt.multiply([],f.globeMatrix,m);return bt.multiply(v,v,E),bt.multiply(v,v,d),v}(e,t,r);return s>0?function(f,g,y){const b=(A,l,u)=>{const p=dt.length(A),m=dt.length(l),v=Ud(A,l,u);return dt.scale(v,v,1/dt.length(v)*vn(p,m,u))},C=b([f[0],f[1],f[2]],[g[0],g[1],g[2]],y),P=b([f[4],f[5],f[6]],[g[4],g[5],g[6]],y),E=b([f[8],f[9],f[10]],[g[8],g[9],g[10]],y),I=Ud([f[12],f[13],f[14]],[g[12],g[13],g[14]],y);return[C[0],C[1],C[2],0,P[0],P[1],P[2],0,E[0],E[1],E[2],0,I[0],I[1],I[2],1]}(c,function(f,g){const y=g.worldSize,b=oo(1,0)*y*go(g.center.lat,g.zoom)/Op(y),C=oo(1,g.center.lat)*y,P=bt.identity([]);return bt.rotateY(P,P,Ct(g.center.lng)),bt.rotateX(P,P,Ct(g.center.lat)),bt.translate(P,P,[0,0,ea]),bt.scale(P,P,[b,b,b*C]),bt.translate(P,P,[g.point.x-.5*y,g.point.y-.5*y,0]),bt.multiply(P,P,f),bt.multiply(P,g.globeMatrix,P)}(e,t),s):c}const cv=[1,1,1];class pl{constructor(t,r,s,c){this.id=t,this.position=null!=r?new kn(r[0],r[1]):new kn(0,0),this.orientation=s??[0,0,0],this.nodes=c,this.uploaded=!1,this.aabb=new yo([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,r){if(bt.multiply(t.matrix,r,t.matrix),t.meshes)for(const s of t.meshes){const c=yo.applyTransform(s.aabb,t.matrix);this.aabb.encapsulate(c)}if(t.children)for(const s of t.children)this._applyTransformations(s,t.matrix)}computeBoundsAndApplyParent(){const t=bt.identity([]);for(const r of this.nodes)this._applyTransformations(r,t)}_positionModelOnTerrain(t,r){const s=t.elevation;if(!s)return 0;const c=yo.projectAabbCorners(this.aabb,this.matrix),d=oo(1,this.position.lat)*t.worldSize,f=function(p,m){const v=[0,0,1],M=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const O of M){const T=p[O.corners[0]],k=p[O.corners[1]],N=p[O.corners[2]],F=[k[0]-T[0],k[1]-T[1],m*(k[2]-T[2])],$=dt.cross(F,F,[N[0]-T[0],N[1]-T[1],m*(N[2]-T[2])]);dt.normalize($,$),O.dotProductWithUp=dt.dot($,v)}return M.sort((O,T)=>O.dotProductWithUp-T.dotProductWithUp),M[0].corners}(c,d),g=c[f[0]],y=c[f[1]],b=c[f[2]],C=c[f[3]],P=s.getAtPointOrZero(new Xn(g[0]/t.worldSize,g[1]/t.worldSize),0),E=s.getAtPointOrZero(new Xn(y[0]/t.worldSize,y[1]/t.worldSize),0),I=s.getAtPointOrZero(new Xn(b[0]/t.worldSize,b[1]/t.worldSize),0),A=s.getAtPointOrZero(new Xn(C[0]/t.worldSize,C[1]/t.worldSize),0),l=(P+A)/2,u=(E+I)/2;return l>u?E<I?Ef(r,y,C,g,E,A,P,d):Ef(r,b,g,C,I,P,A,d):P<A?Ef(r,g,y,b,P,E,I,d):Ef(r,C,b,y,A,I,E,d),Math.max(l,u)}computeModelMatrix(t,r,s,c,d,f,g=!1){const y=t.transform,b=y.zoom,C=y.project(this.position),P=go(this.position.lat,b),E=1/P;bt.identity(this.matrix),bt.translate(this.matrix,this.matrix,[C.x+c[0]*E,C.y+c[1]*E,c[2]]);let I=1,A=1;const l=y.worldSize;if(g){if("mercator"===y.projection.name){let v=0;y.elevation&&(v=y.elevation.getAtPointOrZero(new Xn(C.x/l,C.y/l),0));const M=kr.transformMat4([],[C.x,C.y,v,1],y.projMatrix)[3]/y.cameraToCenterDistance;I=M,A=M*go(y.center.lat,b)}else if("globe"===y.projection.name){const v=OC(this.matrix,y),M=bt.multiply([],y.projMatrix,v),O=[0,0,0,1];kr.transformMat4(O,O,M);const T=O[3]/y.cameraToCenterDistance,k=Pi(b),N=y.projection.pixelsPerMeter(this.position.lat,l)*go(this.position.lat,b),F=y.projection.pixelsPerMeter(y.center.lat,l)*go(y.center.lat,b);I=T/vn(N,w0(y.center.lat),k),A=T*P/N,I*=F,A*=F}}else I=E;bt.scale(this.matrix,this.matrix,[I,I,A]);const u=[...this.matrix],p=this.orientation,m=[];if(PC(m,[p[0]+r[0],p[1]+r[1],p[2]+r[2]],s),bt.multiply(this.matrix,u,m),d&&y.elevation){let v=0;const M=[];if(f&&y.elevation){v=this._positionModelOnTerrain(y,M);const O=bt.fromQuat([],M),T=bt.multiply([],O,m);bt.multiply(this.matrix,u,T)}else v=y.elevation.getAtPointOrZero(new Xn(C.x/l,C.y/l),0);0!==v&&(this.matrix[14]+=v)}}upload(t){if(!this.uploaded){for(const r of this.nodes)J1(r,t);for(const r of this.nodes)uv(r);this.uploaded=!0}}destroy(){for(const t of this.nodes)dv(t)}}function hm(e,t,r=!1){e.uploaded||(e.gfxTexture=new xo(t,e.image,r?t.gl.R8:t.gl.RGBA,{useMipmap:e.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),e.uploaded=!0,e.image=null)}function xO(e,t,r){e.indexBuffer=t.createIndexBuffer(e.indexArray,!1,!0),e.vertexBuffer=t.createVertexBuffer(e.vertexArray,UT.members,!1,!0),e.normalArray&&(e.normalBuffer=t.createVertexBuffer(e.normalArray,cm.members,!1,!0)),e.texcoordArray&&(e.texcoordBuffer=t.createVertexBuffer(e.texcoordArray,iv.members,!1,!0)),e.colorArray&&(e.colorBuffer=t.createVertexBuffer(e.colorArray,(12===e.colorArray.bytesPerElement?VT:jT).members,!1,!0)),e.featureArray&&(e.pbrBuffer=t.createVertexBuffer(e.featureArray,yO.members,!0)),e.segments=lo.simpleSegment(0,0,e.vertexArray.length,e.indexArray.length);const s=e.material;s.pbrMetallicRoughness.baseColorTexture&&hm(s.pbrMetallicRoughness.baseColorTexture,t),s.pbrMetallicRoughness.metallicRoughnessTexture&&hm(s.pbrMetallicRoughness.metallicRoughnessTexture,t),s.normalTexture&&hm(s.normalTexture,t),s.occlusionTexture&&hm(s.occlusionTexture,t,r),s.emissionTexture&&hm(s.emissionTexture,t)}function J1(e,t,r){if(e.meshes)for(const s of e.meshes)xO(s,t,r);if(e.children)for(const s of e.children)J1(s,t,r)}function uv(e){if(e.meshes)for(const t of e.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(e.children)for(const t of e.children)uv(t)}function dv(e){if(e.meshes)for(const r of e.meshes)r.vertexBuffer&&(r.vertexBuffer.destroy(),r.indexBuffer.destroy(),r.normalBuffer&&r.normalBuffer.destroy(),r.texcoordBuffer&&r.texcoordBuffer.destroy(),r.colorBuffer&&r.colorBuffer.destroy(),r.pbrBuffer&&r.pbrBuffer.destroy(),r.segments.destroy(),r.material&&((t=r.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(e.children)for(const r of e.children)dv(r)}class tx{constructor(t,r){this.feature=t,this.instancedDataOffset=r,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class Tf{constructor(){this.instancedDataArray=new yT,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class fm{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(t,r,s,c){this.tileToMeter=Tp(s);const d=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:f,id:g,index:y,sourceLayerIndex:b}of t){const C=jc(f,d);if(!this.layers[0]._featureFilter.filter(new Lo(this.zoom),C,s))continue;const P={id:g,sourceLayerIndex:b,index:y,geometry:d?C.geometry:Eo(f,s,c),properties:f.properties,type:f.type,patterns:{}},E=this.addFeature(P,P.geometry,C);E&&r.featureIndex.insert(f,P.geometry,y,b,this.index,this.instancesPerModel[E].instancedDataArray.length)}this.lookup=null}update(t,r,s,c){for(const d in this.instancesPerModel){const f=this.instancesPerModel[d];for(const g in t)f.idToFeaturesIndex.hasOwnProperty(g)&&this.evaluate(f.features[f.idToFeaturesIndex[g]],t[g],f,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const r in this.instancesPerModel){const s=this.instancesPerModel[r];for(const c of s.features){const d=this.layers[0],f=c.feature,g=this.canonical,y=d.paint.get("model-rotation").evaluate(f,{},g),b=d.paint.get("model-scale").evaluate(f,{},g),C=d.paint.get("model-translation").evaluate(f,{},g);dt.exactEquals(c.rotation,y)&&dt.exactEquals(c.scale,b)&&dt.exactEquals(c.translation,C)||(this.evaluate(c,c.featureStates,s,!0),t=!0)}}return t}isEmpty(){for(const t in this.instancesPerModel)if(0!==this.instancesPerModel[t].instancedDataArray.length)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const r in this.instancesPerModel){const s=this.instancesPerModel[r];s.instancedDataArray.length<0||0===s.instancedDataArray.length||(s.instancedDataBuffer?s.instancedDataBuffer.updateData(s.instancedDataArray):s.instancedDataBuffer=t.createVertexBuffer(s.instancedDataArray,qp.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const r=this.instancesPerModel[t];0!==r.instancedDataArray.length&&r.instancedDataBuffer&&r.instancedDataBuffer.destroy()}}addFeature(t,r,s){const c=this.layers[0],d=c.layout.get("model-id").evaluate(s,{},this.canonical);if(!d)return gt(`modelId is not evaluated for layer ${c.id} and it is not going to get rendered.`),d;this.instancesPerModel[d]||(this.instancesPerModel[d]=new Tf);const f=this.instancesPerModel[d],g=f.instancedDataArray,y=new tx(s,g.length);for(const b of r)for(const C of b){if(C.x<0||C.x>=Dt||C.y<0||C.y>=Dt)continue;const P=(this.lookupDim-1)/Dt,E=this.lookupDim*(C.y*P|0)+C.x*P|0;if(this.lookup){if(0!==this.lookup[E])continue;this.lookup[E]=1}this.instanceCount++;const I=g.length;g.resize(I+1),f.instancesEvaluatedElevation.push(0),g.float32[16*I]=C.x,g.float32[16*I+1]=C.y}return y.instancedDataCount=f.instancedDataArray.length-y.instancedDataOffset,y.instancedDataCount>0&&(t.id&&(f.idToFeaturesIndex[t.id]=f.features.length),f.features.push(y),this.evaluate(y,{},f,!1)),d}evaluate(t,r,s,c){const d=this.layers[0],f=t.feature,g=this.canonical,y=t.rotation=d.paint.get("model-rotation").evaluate(f,r,g),b=t.scale=d.paint.get("model-scale").evaluate(f,r,g),C=t.translation=d.paint.get("model-translation").evaluate(f,r,g),P=d.paint.get("model-color").evaluate(f,r,g);P.a=d.paint.get("model-color-mix-intensity").evaluate(f,r,g);const E=[];this.maxVerticalOffset<C[2]&&(this.maxVerticalOffset=C[2]),this.maxScale=Math.max(Math.max(this.maxScale,b[0]),Math.max(b[1],b[2])),PC(E,y,b);const I=Math.round(100*P.a)+P.b/1.05;for(let A=0;A<t.instancedDataCount;++A){const l=t.instancedDataOffset+A,u=16*l,p=s.instancedDataArray.float32;let m=0;c&&(m=p[u+6]-s.instancesEvaluatedElevation[l]);const v=0|p[u+1];p[u]=(0|p[u])+P.r/1.05,p[u+1]=v+P.g/1.05,p[u+2]=I,p[u+3]=1/(g.z>10?this.tileToMeter:Tp(g,v)),p[u+4]=C[0],p[u+5]=C[1],p[u+6]=C[2]+m,p[u+7]=E[0],p[u+8]=E[1],p[u+9]=E[2],p[u+10]=E[4],p[u+11]=E[5],p[u+12]=E[6],p[u+13]=E[8],p[u+14]=E[9],p[u+15]=E[10],s.instancesEvaluatedElevation[l]=C[2]}}}De(fm,"ModelBucket",{omit:["layers"]}),De(Tf,"PerModelAttributes"),De(tx,"ModelFeature");const wO=new jt({visibility:new G(wt.layout_model.visibility),"model-id":new Q(wt.layout_model["model-id"])});var CO={paint:new jt({"model-opacity":new G(wt.paint_model["model-opacity"]),"model-rotation":new Q(wt.paint_model["model-rotation"]),"model-scale":new Q(wt.paint_model["model-scale"]),"model-translation":new Q(wt.paint_model["model-translation"]),"model-color":new Q(wt.paint_model["model-color"]),"model-color-mix-intensity":new Q(wt.paint_model["model-color-mix-intensity"]),"model-type":new G(wt.paint_model["model-type"]),"model-cast-shadows":new G(wt.paint_model["model-cast-shadows"]),"model-receive-shadows":new G(wt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new G(wt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Q(wt.paint_model["model-emissive-strength"]),"model-roughness":new Q(wt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Q(wt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new G(wt.paint_model["model-cutoff-fade-range"])}),layout:wO};const EC=new Float32Array(262144),Xc=new Uint8Array(262144);function MO(e){let t=0;if(e.meshes)for(const r of e.meshes)t=Math.max(t,r.aabb.max[2]);if(e.children)for(const r of e.children)t=Math.max(t,MO(r));return t}const PO=["","wall","door","roof","window","lamp","logo"];class ex{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:t.id,geometry:[],properties:{height:MO(t)}}}}class ss{constructor(t,r,s,c){this.nodes=t,this.id=r,this.modelTraits|=1,this.uploaded=!1,this.hasPattern=!1,s&&(this.modelTraits|=4),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=c,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const r=this.getNodesInfo();for(const s of r){const c=s.node;this.uploaded?this.updatePbrBuffer(c):J1(c,t,!0)}for(const s of r)uv(s.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let r=!1;if(!t.meshes)return r;for(const s of t.meshes)s.pbrBuffer&&(s.pbrBuffer.updateData(s.featureArray),r=!0);return r}needsReEvaluation(t,r,s){const c=t.transform.projectionOptions,d=t.style.getBrightness(),f=this.brightness!==d;return!!(!this.uploaded||this.dirty||c.name!==this.projection.name||ly(s.paint.get("model-color").value,f)||ly(s.paint.get("model-color-mix-intensity").value,f)||ly(s.paint.get("model-roughness").value,f)||ly(s.paint.get("model-emissive-strength").value,f)||ly(s.paint.get("model-height-based-emissive-strength-multiplier").value,f))&&(this.projection=c,this.brightness=d,!0)}evaluateScale(t,r){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const s=this.getNodesInfo(),c=this.id.canonical;for(const d of s){const f=d.feature;d.evaluatedScale=r.paint.get("model-scale").evaluate(f,{},c)}}evaluate(t){const r=this.getNodesInfo();for(const s of r){if(!s.node.meshes)continue;const c=s.feature,d=s.node.meshes&&s.node.meshes[0].featureData,f=s.evaluatedColor[2],g=s.evaluatedRMEA[2],y=this.id.canonical;if(s.hasTranslucentParts=!1,d){for(let b=0;b<PO.length;b++){const C=PO[b];C.length&&(c.properties.part=C);const P=t.paint.get("model-color").evaluate(c,{},y),E=t.paint.get("model-color-mix-intensity").evaluate(c,{},y);s.evaluatedColor[b]=[P.r,P.g,P.b,E],s.evaluatedRMEA[b][0]=t.paint.get("model-roughness").evaluate(c,{},y),s.evaluatedRMEA[b][2]=t.paint.get("model-emissive-strength").evaluate(c,{},y),s.evaluatedRMEA[b][3]=P.a,s.emissionHeightBasedParams[b]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(c,{},y),!s.hasTranslucentParts&&P.a<1&&(s.hasTranslucentParts=!0)}delete c.properties.part,EO(s,f!==s.evaluatedColor[2]||g!==s.evaluatedRMEA[2])}s.evaluatedScale=t.paint.get("model-scale").evaluate(c,{},y),this.updatePbrBuffer(s.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,r,s,c){const d=t.findDEMTileFor(s);if(d&&(d.tileID.canonical!==this.terrainTile||r!==this.terrainExaggeration)){if(d.dem&&d.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=d.tileID.overscaledZ;const f=dc.create(t,s,d);if(!f)return;4&this.modelTraits&&this.updateDEM(t,f,s,c);for(const g of this.getNodesInfo()){const y=g.node;if(!y.footprint||!y.footprint.vertices||!y.footprint.vertices.length)continue;const b=y.footprint.vertices;let C=f.getElevationAt(b[0].x,b[0].y,!0,!0);for(let P=1;P<b.length;P++)C=Math.min(C,f.getElevationAt(b[P].x,b[P].y,!0,!0));y.elevation=C}}this.terrainTile=d.tileID.canonical,this.terrainExaggeration=r}}updateDEM(t,r,s,c){let d=r._dem._modifiedForSources[c];if(void 0===d&&(r._dem._modifiedForSources[c]=[],d=r._dem._modifiedForSources[c]),d.includes(s.canonical))return;const f=r._dem.dim;d.push(s.canonical);let g=!1;for(const y of this.getNodesInfo()){const b=y.node;if(!b.footprint||!b.footprint.grid)continue;const C=b.footprint.grid,P=r.tileCoordToPixel(C.min.x,C.min.y),E=r.tileCoordToPixel(C.max.x,C.max.y),I=Math.min(Math.min(f-E.y,P.x),Math.min(P.y,f-E.x));if(I<0)continue;const A=Ne(I,2,5);let l=Math.max(0,P.x-A),u=Math.max(0,P.y-A),p=Math.min(E.x+A,f-1),m=Math.min(E.y+A,f-1);for(let T=u;T<=m;++T)for(let k=l;k<=p;++k)Xc[T*f+k]=255;let v=0,M=0;for(let T=0;T<C.cellsY;++T)for(let k=0;k<C.cellsX;++k){if(!C.cells[T*C.cellsX+k])continue;const N=r.tileCoordToPixel(C.min.x+k/C.xScale,C.min.y+T/C.yScale),F=r.tileCoordToPixel(C.min.x+(k+1)/C.xScale,C.min.y+(T+1)/C.yScale);for(let $=N.y;$<=Math.min(F.y+1,f-1);++$)for(let q=N.x;q<=Math.min(F.x+1,f-1);++q)255===Xc[$*f+q]&&(Xc[$*f+q]=0,v+=r.getElevationAtPixel(q,$),M++)}const O=v/M;l=Math.max(1,P.x-A),u=Math.max(1,P.y-A),p=Math.min(E.x+A,f-2),m=Math.min(E.y+A,f-2),g=!0;for(let T=u;T<=m;++T)for(let k=l;k<=p;++k)0===Xc[T*f+k]&&(EC[T*f+k]=r._dem.set(k,T,O));for(let T=1;T<A;++T){l=Math.max(1,P.x-T),u=Math.max(1,P.y-T),p=Math.min(E.x+T,f-2),m=Math.min(E.y+T,f-2);for(let k=u;k<=m;++k)for(let N=l;N<=p;++N){const F=k*f+N;if(255===Xc[F]){let $=0,q=0,Z=-1,X=-1;for(let K=-1;K<=1;++K)for(let J=-1;J<=1;++J){const st=(k+K)*f+N+J;if(Xc[st]>=T)continue;const it=EC[st],rt=Math.abs(it);rt>q&&($=it,q=rt,Z=J,X=K)}if(q>.1){const K=1-(T+.5*Math.abs(Z*X))/A;let J=r._dem.get(N,k)+$*K;const st=r._dem.get(N+Z,k+X),it=r._dem.get(N-Z,k-X,!0);(J-st)*(J-it)>0&&(J=(st+it)/2),EC[F]=r._dem.set(N,k,J),Xc[F]=T}}}}}g&&(r._demTile.needsDEMTextureUpload=!0,r._dem._timestamp=Mn.now())}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const t of this.nodes)this.nodesInfo.push(new ex(t));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const t of this.nodes)dv(t);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const t=this.getNodesInfo();for(const r of t)uv(r.node),dv(r.node)}isEmpty(){return!this.nodes.length}updateReplacement(t,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;const s=r.getReplacementRegionsForTile(t.toUnwrapped()),c=this.getNodesInfo();for(let d=0;d<this.nodesInfo.length;d++){const f=c[d].node;c[d].hiddenByReplacement=!!f.footprint&&!s.find(g=>g.footprint===f.footprint)}}getHeightAtTileCoord(t,r){const s=this.getNodesInfo(),c=[];for(let d=0;d<this.nodesInfo.length;d++){const f=s[d],g=f.node.meshes[0];if(t<g.aabb.min[0]||r<g.aabb.min[1]||t>g.aabb.max[0]||r>g.aabb.max[1])continue;const y=(t-g.aabb.min[0])/(g.aabb.max[0]-g.aabb.min[0])*64|0,b=64*Math.min(63,(r-g.aabb.min[1])/(g.aabb.max[1]-g.aabb.min[1])*64|0)+Math.min(63,y);if(!(g.heightmap[b]<0&&f.node.footprint))return f.hiddenByReplacement?void 0:{height:g.heightmap[b],maxHeight:f.feature.properties.height,hidden:!1,verticalScale:f.evaluatedScale[2]};if(f.node.footprint.grid.query(new tt(t,r),new tt(t,r),c),c.length>0)return{height:void 0,maxHeight:f.feature.properties.height,hidden:f.hiddenByReplacement,verticalScale:f.evaluatedScale[2]}}}}function ly(e,t){return!e.isLightConstant&&t}function OO(e,t,r,s,c,d,f,g){let y=(61440&t|(61440&t)>>4)>>8,b=(3840&t|(3840&t)>>4)>>4,C=240&t|(240&t)>>4;r[3]>0&&(y=vn(y,255*r[0],r[3]),b=vn(b,255*r[1],r[3]),C=vn(C,255*r[2],r[3]));const P=y<<8|b,E=C<<8|Math.floor(255*s[3]),I=function(T){const k=Ne(T,0,2);return Math.min(Math.round(.5*k*255),255)}(s[2])<<8|15*s[0]<<4|15*s[1],A=Ne(c[0],0,1),l=Ne(c[1],0,1),u=Ne(c[2],0,1),p=Ne(c[3],0,1);let m,v,M,O;if(A!==l&&f!==d&&l!==A){const T=f-d;v=1/(T*(l-A)),M=-(d+T*A)/(T*(l-A));const k=Ne(c[4],-1,1);O=Math.pow(10,k),m=255*u<<8|255*p}else m=65535,v=0,M=1,O=1;if(e.emplaceBack(P,E,I,m,v,M,O),g){const T=g.length;g.clear();for(let k=0;k<T;k++)g.emplaceBack(P,E,I,m,v,M,O)}}function EO(e,t){const r=e.node;let s=0;for(const c of r.meshes){if(r.lights&&r.lightMeshIndex===s||!c.featureData)continue;c.featureArray=new oP,c.featureArray.reserve(c.featureData.length);let d=t;for(const f of c.featureData){let g;const y=65535&f,b=(15&y)<8?15&y:0,C=f>>16&65535,P=e.evaluatedRMEA[b],E=e.evaluatedColor[b],I=e.emissionHeightBasedParams[b];if(d&&2===b&&r.lights&&(g=new oP,g.resize(10*r.lights.length)),OO(c.featureArray,C,E,P,I,c.aabb.min[2],c.aabb.max[2],g),g&&d){d=!1;const A=r.meshes[r.lightMeshIndex];A.featureArray=g,A.featureArray._trim()}}c.featureArray._trim(),s++}}De(ss,"Tiled3dModelBucket",{omit:["layers"]}),De(ex,"Tiled3dModelFeature");class GT{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t){const r=fv(new tt(0,0),new tt(Dt,Dt),t),s=[];for(const c of this._activeRegions){if(c.hiddenByOverlap||!hv(r,c))continue;const d=HT(c.min,c.max,t);s.push({min:d.min,max:d.max,sourceId:this._sourceIds[c.priority],footprint:c.footprint,footprintTileId:c.tileId})}return s}setSources(t){this._setSources(t.map(r=>({getSourceId:()=>r.cache.id,getFootprints:()=>{const s=[];for(const c of r.cache.getVisibleCoordinates()){const d=r.cache.getTile(c).buckets[r.layer];if(d)for(const f of d.getNodesInfo()){const g=f.node;g.footprint&&s.push({footprint:g.footprint,id:c.toUnwrapped()})}}return s}})))}_addSource(t){const r=t.getFootprints();if(0!==r.length){for(const s of r){if(!s.footprint)continue;const c=fv(s.footprint.min,s.footprint.max,s.id);this._activeRegions.push({min:c.min,max:c.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:s.id,footprint:s.footprint})}this._sourceIds.push(t.getSourceId())}}_computeReplacement(){this._activeRegions.sort((r,s)=>r.priority-s.priority||uh(r.min,s.min)||uh(r.max,s.max));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let r=0,s=0;for(;!t&&r!==this._activeRegions.length;){const c=this._activeRegions[r],d=this._prevRegions[s];t=c.priority!==d.priority||!cy(c,d),++r,++s}}if(t){++this._updateTime;const r=s=>{const c=this._activeRegions;if(s>=c.length)return s;const d=c[s].priority;for(;s<c.length&&c[s].priority===d;)++s;return s};if(this._sourceIds.length>1){let s=0,c=r(s);for(;s!==c;){let d=s;const f=s;for(;d!==c;){const g=this._activeRegions[d];g.hiddenByOverlap=!1;for(let y=0;y<f;y++){const b=this._activeRegions[y];if(!b.hiddenByOverlap&&hv(g,b)&&(g.hiddenByOverlap=pv(g.footprint,g.tileId,b.footprint,b.tileId),g.hiddenByOverlap))break}++d}s=c,c=r(s)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let r=t.length-1;r>=0;r--)this._addSource(t[r]);this._computeReplacement()}}function uh(e,t){return e.x-t.x||e.y-t.y}function cy(e,t){return 0===uh(e.min,t.min)&&0===uh(e.max,t.max)}function hv(e,t){return!(e.min.x>t.max.x||e.max.x<t.min.x||e.min.y>t.max.y||e.max.y<t.min.y)}function fv(e,t,r){const s=1/Dt,c=1/(1<<r.canonical.z),d=(t.x*s+r.canonical.x)*c+r.wrap,f=(t.y*s+r.canonical.y)*c;return{min:new tt((e.x*s+r.canonical.x)*c+r.wrap,(e.y*s+r.canonical.y)*c),max:new tt(d,f)}}function HT(e,t,r){const s=1<<r.canonical.z,c=((t.x-r.wrap)*s-r.canonical.x)*Dt,d=(t.y*s-r.canonical.y)*Dt;return{min:new tt(((e.x-r.wrap)*s-r.canonical.x)*Dt,(e.y*s-r.canonical.y)*Dt),max:new tt(c,d)}}function nx(e,t,r,s,c,d,f){const g=e.indices,y=e.vertices,b=[];for(let C=s;C<s+c;C+=3){const P=t[r[C+0]+d],E=t[r[C+1]+d],I=t[r[C+2]+d],A=Math.min(P.x,E.x,I.x),l=Math.max(P.x,E.x,I.x),u=Math.min(P.y,E.y,I.y),p=Math.max(P.y,E.y,I.y);b.length=0,e.grid.query(new tt(A,u),new tt(l,p),b);for(let m=0;m<b.length;m++){const v=b[m];if(C0(y[g[3*v+0]],y[g[3*v+1]],y[g[3*v+2]],P,E,I,f))return!0}}return!1}function pv(e,t,r,s){if(!e||!r)return!1;let c=e.vertices;if(!t.canonical.equals(s.canonical)||t.wrap!==s.wrap){if(r.vertices.length<e.vertices.length)return pv(r,s,e,t);const d=t.canonical,f=s.canonical,g=Math.pow(2,f.z-d.z);c=e.vertices.map(y=>new tt(y.x*d.x*Dt*g-f.x*Dt,y.y*d.y*Dt*g-f.y*Dt))}return nx(r,c,e.indices,0,e.indices.length,0,0)}const rx=S0.types,gv=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],mv=["fill-extrusion-flood-light-ground-radius"],TC=Math.pow(2,13),IC=Math.pow(2,15)-1,TO=new tt(0,1),If=2147483648;function _v(e,t,r,s,c,d,f,g){e.emplaceBack((t<<1)+f,(r<<1)+d,(Math.floor(s*TC)<<1)+c,Math.round(g))}function ox(e,t,r,s,c,d){e.emplaceBack(t.x,t.y,(r.x<<1)+s,(r.y<<1)+c,d)}function Zp(e,t,r){e.emplaceBack(t.x,t.y,t.z,16384*r[0],16384*r[1],16384*r[2])}class yv{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class SC{constructor(){this.centroidXY=new tt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new tt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new tt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new tt(this.max.x-this.min.x,this.max.y-this.min.y)}}class IO{constructor(){this.acc=new tt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,r){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=r.x,t.min.y=t.max.y=r.y)}appendEdge(t,r,s){this.accCount++,this.acc._add(r);let c=!!this.borders;r.x<t.min.x?(t.min.x=r.x,c=!0):r.x>t.max.x&&(t.max.x=r.x,c=!0),r.y<t.min.y?(t.min.y=r.y,c=!0):r.y>t.max.y&&(t.max.y=r.y,c=!0),((0===r.x||r.x===Dt)&&r.x===s.x)!=((0===r.y||r.y===Dt)&&r.y===s.y)&&this.processBorderOverlap(r,s),c&&this.checkBorderIntersection(r,s)}checkBorderIntersection(t,r){r.x<0!=t.x<0&&this.addBorderIntersection(0,vn(r.y,t.y,(0-r.x)/(t.x-r.x))),r.x>Dt!=t.x>Dt&&this.addBorderIntersection(1,vn(r.y,t.y,(Dt-r.x)/(t.x-r.x))),r.y<0!=t.y<0&&this.addBorderIntersection(2,vn(r.x,t.x,(0-r.y)/(t.y-r.y))),r.y>Dt!=t.y>Dt&&this.addBorderIntersection(3,vn(r.x,t.x,(Dt-r.y)/(t.y-r.y)))}addBorderIntersection(t,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[t];r<s[0]&&(s[0]=r),r>s[1]&&(s[1]=r)}processBorderOverlap(t,r){if(t.x===r.x){if(t.y===r.y)return;const s=0===t.x?0:1;this.addBorderIntersection(s,r.y),this.addBorderIntersection(s,t.y)}else{const s=0===t.y?2:3;this.addBorderIntersection(s,r.x),this.addBorderIntersection(s,t.x)}}centroid(){return 0===this.accCount?new tt(0,0):new tt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,r)=>t+ +(r[0]!==Number.MAX_VALUE),0):0}}function ix(e,t){const r=e.add(t)._unit(),s=Ne(e.x*r.x+e.y*r.y,-1,1);var c,d,f;return c=Math.acos(s),Math.min(4,Math.max(-4,Math.tan(c)))/4*IC*((d=e).x*(f=t).y-d.y*f.x<0?-1:1)}const vv=[e=>e.x<0,e=>e.x>Dt,e=>e.y<0,e=>e.y>Dt];function uy(e,t,r,s){const c=[4];if(0===s)return c;r._mult(s);const d=e.sub(r),f=t.sub(r),g=[e,t,d,f];for(let y=0;y<4;y++)for(const b of g)if(vv[y](b)){c.push(y);break}return c}class pm{constructor(t){this.vertexArray=new Gh,this.indexArray=new Mi,this.programConfigurations=new ga(t.layers,t.zoom,r=>mv.includes(r)),this._segments=new lo,this.hiddenByLandmarkVertexArray=new vT,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new lo}getDefaultSegment(){return this.regionSegments[4]}hasData(){return 0!==this.vertexArray.length}addData(t,r,s,c=!1){const d=t.length;if(d>2){let f=Math.max(0,this._segments.get().length-1);const g=this._segments._prepareSegment(4*d,this.vertexArray.length,2*this._segmentToGroundQuads[f].length);let y;f!==this._segments.get().length-1&&(f++,this._segmentToGroundQuads[f]=[],this._segmentToRegionTriCounts[f]=[0,0,0,0,0]);{const b=t[0],C=t[1];y=ix(b.sub(t[d-1])._perp()._unit(),C.sub(b)._perp()._unit())}for(let b=0;b<d;b++){const C=b===d-1?0:b+1,P=t[b],E=t[C],I=t[C===d-1?0:C+1],A=E.sub(P)._perp()._unit(),l=ix(A,I.sub(E)._perp()._unit()),u=y,p=l;if(xv(P,E,r)||c&&SO(P,r)&&SO(E,r)){y=l;continue}const m=g.vertexLength;ox(this.vertexArray,P,E,1,1,u),ox(this.vertexArray,P,E,1,0,u),ox(this.vertexArray,P,E,0,1,p),ox(this.vertexArray,P,E,0,0,p),g.vertexLength+=4;const v=uy(P,E,A,s);for(const M of v)this._segmentToGroundQuads[f].push({id:m,region:M}),this._segmentToRegionTriCounts[f][M]+=2,g.primitiveLength+=2;y=l}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),r=t.length;for(let s=0;s<r;s++)this._segmentToGroundQuads[s].sort((c,d)=>c.region-d.region);for(let s=0;s<r;s++){const c=this._segmentToGroundQuads[s],d=t[s],f=this._segmentToRegionTriCounts[s];f.reduce((y,b)=>y+b,0);let g=0;for(let y=0;y<=4;y++){const b=f[y];if(0!==b){let C=this.regionSegments[y];C||(C=this.regionSegments[y]=new lo);const P={vertexOffset:d.vertexOffset,primitiveOffset:d.primitiveOffset+g,vertexLength:d.vertexLength,primitiveLength:b};C.get().push(P)}g+=b}for(let y=0;y<c.length;y++){const b=c[y].id;this.indexArray.emplaceBack(b,b+1,b+3),this.indexArray.emplaceBack(b,b+3,b+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,r,s,c,d,f){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,r,s,c,d,f)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,cc.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,r,s,c,d,f){this.hasData()&&this.programConfigurations.updatePaintArrays(t,r,s,c,d,f)}updateHiddenByLandmark(t){if(!this.hasData())return;const r=t.groundVertexCount+t.groundVertexArrayOffset;if(0===t.groundVertexCount)return;const s=t.flags&If?1:0;for(let c=t.groundVertexArrayOffset;c<r;++c)this.hiddenByLandmarkVertexArray.emplace(c,s);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,I0.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const r=this.regionSegments[t];r&&r.destroy()}}}}class gm{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Mi,this.footprintVertices=new pa,this.footprintSegments=[],this.layoutVertexArray=new nl,this.centroidVertexArray=new wb,this.indexArray=new Mi,this.programConfigurations=new ga(t.layers,t.zoom,r=>gv.includes(r)),this.segments=new lo,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.groundEffect=new pm(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}populate(t,r,s,c){this.features=[],this.hasPattern=cl("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=Tp(s),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:d,id:f,index:g,sourceLayerIndex:y}of t){const b=this.layers[0]._featureFilter.needGeometry,C=jc(d,b);if(!this.layers[0]._featureFilter.filter(new Lo(this.zoom),C,s))continue;const P={id:f,sourceLayerIndex:y,index:g,geometry:b?C.geometry:Eo(d,s,c),properties:d.properties,type:d.type,patterns:{}},E=this.layoutVertexArray.length;this.hasPattern?this.features.push(ff("fill-extrusion",this.layers,P,this.zoom,r)):this.addFeature(P,P.geometry,g,s,{},r.availableImages,c,r.brightness),r.featureIndex.insert(d,P.geometry,g,y,this.index,E)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,r,s,c,d,f){for(const g of this.features){const{geometry:y}=g;this.addFeature(g,y,g.index,r,s,c,d,f)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles()}update(t,r,s,c,d){const f=0!==Object.keys(t).length;if(f&&!this.stateDependentLayers.length)return;const g=f?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,r,g,s,c,d),this.groundEffect.update(t,r,g,s,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ra),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,Zw.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,T0.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,s,c,d,f,g,y){const b=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,C=[new tt(0,0),new tt(Dt,Dt)],P=g.projection,E="globe"===P.name,I="Polygon"===rx[t.type],A=new IO;A.centroidDataIndex=this.centroidData.length;const l=new SC,u=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},c)<=0,p=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},c);l.height=p,l.vertexArrayOffset=this.layoutVertexArray.length,l.groundVertexArrayOffset=this.groundEffect.vertexArray.length,E&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Xy);const m=Vg(r,500);for(let N=m.length-1;N>=0;N--){const F=m[N];(0===F.length||(v=F[0]).every($=>$.x<=0)||v.every($=>$.x>=Dt)||v.every($=>$.y<=0)||v.every($=>$.y>=Dt))&&m.splice(N,1)}var v;let M;if(E)M=lx(m,C,c);else{M=[];for(const N of m)M.push({polygon:N,bounds:C})}const O=I?this.edgeRadius:0,T=O>0&&this.zoom<17,k=(N,F)=>{if(0===N.length)return!1;const $=N[N.length-1];return F.x===$.x&&F.y===$.y};for(const{polygon:N,bounds:F}of M){let $=0,q=0;for(const J of N)I&&!J[0].equals(J[J.length-1])&&J.push(J[0]),q+=I?J.length-1:J.length;const Z=this.segments.prepareSegment((I?5:4)*q,this.layoutVertexArray,this.indexArray);l.footprintSegIdx<0&&(l.footprintSegIdx=this.footprintSegments.length),l.polygonSegIdx<0&&(l.polygonSegIdx=this.polygonSegments.length);const X={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},K=new yv;if(K.vertexOffset=this.footprintVertices.length,K.indexOffset=3*this.footprintIndices.length,K.ringIndices=[],I){const J=[],st=[];$=Z.vertexLength;for(let rt=0;rt<N.length;rt++){const ct=N[rt];ct.length&&0!==rt&&st.push(J.length/2);const yt=[];let Et,Tt;Et=ct[1].sub(ct[0])._perp()._unit(),K.ringIndices.push(ct.length-1);for(let zt=1;zt<ct.length;zt++){const Nt=ct[zt],$t=ct[zt===ct.length-1?1:zt+1],Rt=Nt.clone();if(O){Tt=$t.sub(Nt)._perp()._unit();const oe=Et.add(Tt)._unit(),Oe=O*Math.min(4,1/(Et.x*oe.x+Et.y*oe.y));Rt.x+=Oe*oe.x,Rt.y+=Oe*oe.y,Rt.x=Math.round(Rt.x),Rt.y=Math.round(Rt.y),Et=Tt}!u||0!==O&&!T||k(yt,Rt)||yt.push(Rt),_v(this.layoutVertexArray,Rt.x,Rt.y,0,0,1,1,0),Z.vertexLength++,this.footprintVertices.emplaceBack(Nt.x,Nt.y),J.push(Nt.x,Nt.y),E&&Zp(this.layoutVertexExtArray,P.projectTilePoint(Rt.x,Rt.y,c),P.upVector(c,Rt.x,Rt.y))}u&&(0===O||T)&&(0!==yt.length&&k(yt,yt[0])&&yt.pop(),this.groundEffect.addData(yt,F,b))}const it=O0(J,st);for(let rt=0;rt<it.length;rt+=3)this.footprintIndices.emplaceBack(K.vertexOffset+it[rt+0],K.vertexOffset+it[rt+1],K.vertexOffset+it[rt+2]),this.indexArray.emplaceBack($+it[rt],$+it[rt+2],$+it[rt+1]),Z.primitiveLength++;K.indexCount+=it.length,K.vertexCount+=this.footprintVertices.length-K.vertexOffset}for(let J=0;J<N.length;J++){const st=N[J];A.startRing(l,st[0]);let it=st.length>4&&sx(st[st.length-2],st[0],st[1]),rt=O?qT(st[st.length-2],st[0],st[1],O):0;const ct=[];let yt,Et,Tt;Et=st[1].sub(st[0])._perp()._unit();let zt=!0;for(let Nt=1,$t=0;Nt<st.length;Nt++){let Rt=st[Nt-1],oe=st[Nt];const Oe=st[Nt===st.length-1?1:Nt+1];if(A.appendEdge(l,oe,Rt),xv(oe,Rt,F)){O&&(Et=Oe.sub(oe)._perp()._unit(),zt=!zt);continue}const Ee=oe.sub(Rt)._perp(),Be=Ee.x/(Math.abs(Ee.x)+Math.abs(Ee.y)),je=Ee.y>0?1:0,On=Rt.dist(oe);if($t+On>32768&&($t=0),O){Tt=Oe.sub(oe)._perp()._unit();let Ln=AC(Rt,oe,Oe,bv(Et,Tt),O);isNaN(Ln)&&(Ln=0);const En=oe.sub(Rt)._unit();Rt=Rt.add(En.mult(rt))._round(),oe=oe.add(En.mult(-Ln))._round(),rt=Ln,Et=Tt,u&&this.zoom>=17&&(k(ct,Rt)||ct.push(Rt),k(ct,oe)||ct.push(oe))}const Qe=Z.vertexLength,nr=st.length>4&&sx(Rt,oe,Oe);let ln=dy($t,it,zt);if(_v(this.layoutVertexArray,Rt.x,Rt.y,Be,je,0,0,ln),_v(this.layoutVertexArray,Rt.x,Rt.y,Be,je,0,1,ln),$t+=On,ln=dy($t,nr,!zt),it=nr,_v(this.layoutVertexArray,oe.x,oe.y,Be,je,0,0,ln),_v(this.layoutVertexArray,oe.x,oe.y,Be,je,0,1,ln),Z.vertexLength+=4,this.indexArray.emplaceBack(Qe+0,Qe+1,Qe+2),this.indexArray.emplaceBack(Qe+1,Qe+3,Qe+2),Z.primitiveLength+=2,O){const Ln=$+(1===Nt?st.length-2:Nt-2),En=1===Nt?$:Ln+1;if(this.indexArray.emplaceBack(Qe+1,Ln,Qe+3),this.indexArray.emplaceBack(Ln,En,Qe+3),Z.primitiveLength+=2,void 0===yt&&(yt=Qe),!xv(Oe,st[Nt],F)){const mn=Nt===st.length-1?yt:Z.vertexLength;this.indexArray.emplaceBack(Qe+2,Qe+3,mn),this.indexArray.emplaceBack(Qe+3,mn+1,mn),this.indexArray.emplaceBack(Qe+3,En,mn+1),Z.primitiveLength+=3}zt=!zt}if(E){const Ln=this.layoutVertexExtArray,En=P.projectTilePoint(Rt.x,Rt.y,c),mn=P.projectTilePoint(oe.x,oe.y,c),wr=P.upVector(c,Rt.x,Rt.y),Lr=P.upVector(c,oe.x,oe.y);Zp(Ln,En,wr),Zp(Ln,En,wr),Zp(Ln,mn,Lr),Zp(Ln,mn,Lr)}}I&&($+=st.length-1),u&&O&&this.zoom>=17&&(0!==ct.length&&k(ct,ct[0])&&ct.pop(),this.groundEffect.addData(ct,F,b,O>0))}this.footprintSegments.push(K),X.triangleCount=this.indexArray.length-X.triangleArrayOffset,this.polygonSegments.push(X),++l.footprintSegLen,++l.polygonSegLen}if(l.vertexCount=this.layoutVertexArray.length-l.vertexArrayOffset,l.groundVertexCount=this.groundEffect.vertexArray.length-l.groundVertexArrayOffset,0!==l.vertexCount){if(l.centroidXY=A.borders?TO:this.encodeCentroid(A,l),this.centroidData.push(l),A.borders){this.featuresOnBorder.push(A);const N=this.featuresOnBorder.length-1;for(let F=0;F<A.borders.length;F++)A.borders[F][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[F].push(N)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,d,f,c,y),this.groundEffect.addPaintPropertiesData(t,s,d,f,c,y),this.maxHeight=Math.max(this.maxHeight,p)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((r,s)=>this.featuresOnBorder[r].borders[t][0]-this.featuresOnBorder[s].borders[t][0])}splitToSubtiles(){const t=[];for(let g=0;g<this.centroidData.length;g++){const y=this.centroidData[g],b=+(y.min.y+y.max.y>Dt),C=2*b+(+(y.min.x+y.max.x>Dt)^b);for(let P=0;P<y.polygonSegLen;P++){const E=y.polygonSegIdx+P;t.push({centroidIdx:g,subtile:C,polygonSegmentIdx:E,triangleSegmentIdx:this.polygonSegments[E].triangleSegIdx})}}const r=new Mi;t.sort((g,y)=>g.triangleSegmentIdx===y.triangleSegmentIdx?g.subtile-y.subtile:g.triangleSegmentIdx-y.triangleSegmentIdx);let s=0,c=0,d=0;for(const g of t){if(g.triangleSegmentIdx!==s)break;d++}const f=t.length;for(;c!==t.length;){s=t[c].triangleSegmentIdx;let g=0,y=c,b=c;for(let C=y;C<d&&t[C].subtile===g;C++)b++;for(;y!==d;){const C=t[y];g=C.subtile;const P=this.centroidData[C.centroidIdx].min.clone(),E=this.centroidData[C.centroidIdx].max.clone(),I={vertexOffset:this.segments.segments[s].vertexOffset,primitiveOffset:r.length,vertexLength:this.segments.segments[s].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let A=y;A<b;A++){const l=t[A],u=this.polygonSegments[l.polygonSegmentIdx],p=this.centroidData[l.centroidIdx].min,m=this.centroidData[l.centroidIdx].max,v=this.indexArray.uint16;for(let M=u.triangleArrayOffset;M<u.triangleArrayOffset+u.triangleCount;M++)r.emplaceBack(v[3*M],v[3*M+1],v[3*M+2]);I.primitiveLength+=u.triangleCount,P.x=Math.min(P.x,p.x),P.y=Math.min(P.y,p.y),E.x=Math.max(E.x,m.x),E.y=Math.max(E.y,m.y)}I.primitiveLength>0&&this.triangleSubSegments.push({segment:I,min:P,max:E}),y=b;for(let A=y;A<d&&t[A].subtile===t[y].subtile;A++)b++}c=d;for(let C=c;C<f&&t[C].triangleSegmentIdx===t[c].triangleSegmentIdx;C++)d++}r._trim(),this.indexArray=r}getVisibleSegments(t,r,s){let c=0,d=0;const f=1<<t.canonical.z;if(r){const l=r.getMinMaxForTile(t);l&&(c=l.min,d=l.max)}d+=this.maxHeight;const g=t.toUnwrapped();let y;const b=[g.canonical.x/f+g.wrap,g.canonical.y/f],C=[(g.canonical.x+1)/f+g.wrap,(g.canonical.y+1)/f],P=new lo,E=(l,u,p)=>[l[0]*(1-p[0])+u[0]*p[0],l[1]*(1-p[1])+u[1]*p[1]],I=[],A=[];for(const l of this.triangleSubSegments){I[0]=l.min.x/Dt,I[1]=l.min.y/Dt,A[0]=l.max.x/Dt,A[1]=l.max.y/Dt;const u=E(b,C,I),p=E(b,C,A);if(0===new yo([u[0],u[1],c],[p[0],p[1],d]).intersectsPrecise(s)){y&&(P.segments.push(y),y=void 0);continue}const m=l.segment;y&&y.vertexOffset!==m.vertexOffset&&(P.segments.push(y),y=void 0),y?(y.vertexLength+=m.vertexLength,y.primitiveLength+=m.primitiveLength):y={vertexOffset:m.vertexOffset,primitiveLength:m.primitiveLength,vertexLength:m.vertexLength,primitiveOffset:m.primitiveOffset,sortKey:void 0,vaos:{}}}return y&&P.segments.push(y),P}encodeCentroid(t,r){const s=t.centroid(),c=r.span(),d=Math.min(7,Math.round(c.x*this.tileToMeter/10)),f=Math.min(7,Math.round(c.y*this.tileToMeter/10));return new tt(Ne(s.x,1,Dt-1)<<3|d,Ne(s.y,1,Dt-1)<<3|f)}showCentroid(t){const r=this.centroidData[t.centroidDataIndex];r.flags&=If,r.centroidXY.x=0,r.centroidXY.y=0,this.writeCentroidToBuffer(r)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const r=t.vertexArrayOffset,s=t.vertexCount+t.vertexArrayOffset,c=t.flags&If?TO:t.centroidXY,d=this.centroidVertexArray.geta_centroid_pos0(r);if(this.centroidVertexArray.geta_centroid_pos1(r)!==c.y||d!==c.x){for(let f=r;f<s;++f)this.centroidVertexArray.emplace(f,c.x,c.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;const s=r.getReplacementRegionsForTile(t.toUnwrapped());if(function(d,f){if(d.length!==f.length)return!1;for(let g=0;g<d.length;g++)if(d[g].sourceId!==f[g].sourceId||!cy(d[g],f[g]))return!1;return!0}(this.activeReplacements,s))return;if(this.activeReplacements=s,0===this.centroidVertexArray.length)this.createCentroidsBuffer();else for(const d of this.centroidData)d.flags&=2147483647;const c=[];for(const d of this.activeReplacements){const f=Math.pow(2,d.footprintTileId.canonical.z-t.canonical.z);for(const g of this.centroidData)if(!(g.flags&If||d.min.x>g.max.x||g.min.x>d.max.x||d.min.y>g.max.y||g.min.y>d.max.y))for(let y=0;y<g.footprintSegLen;y++){const b=this.footprintSegments[g.footprintSegIdx+y];if(c.length=0,AO(this.footprintVertices,b.vertexOffset,b.vertexCount,d.footprintTileId.canonical,t.canonical,c),nx(d.footprint,c,this.footprintIndices.uint16,b.indexOffset,b.indexCount,-b.vertexOffset,-f)){g.flags|=If;break}}}for(const d of this.centroidData)this.writeCentroidToBuffer(d);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,r,s){let c=!1;for(let d=0;d<s.footprintSegLen;d++){const f=this.footprintSegments[s.footprintSegIdx+d];let g=0;for(const y of f.ringIndices){for(let b=g,C=y+g-1;b<y+g;C=b++){const P=this.footprintVertices.int16[2*(b+f.vertexOffset)+0],E=this.footprintVertices.int16[2*(b+f.vertexOffset)+1],I=this.footprintVertices.int16[2*(C+f.vertexOffset)+1];E>r!=I>r&&t<(this.footprintVertices.int16[2*(C+f.vertexOffset)+0]-P)*(r-E)/(I-E)+P&&(c=!c)}g=y}}return c}getHeightAtTileCoord(t,r){let s=Number.NEGATIVE_INFINITY,c=!0;const d=4*(t+Dt)*Dt+(r+Dt);if(this.partLookup.hasOwnProperty(d)){const f=this.partLookup[d];return f?{height:f.height,hidden:!!(f.flags&If)}:void 0}for(const f of this.centroidData)t>f.max.x||f.min.x>t||r>f.max.y||f.min.y>r||this.footprintContainsPoint(t,r,f)&&f&&f.height>s&&(s=f.height,this.partLookup[d]=f,c=!!(f.flags&If));if(s!==Number.NEGATIVE_INFINITY)return{height:s,hidden:c};this.partLookup[d]=void 0}}function bv(e,t){const r=e.add(t)._unit();return e.x*r.x+e.y*r.y}function qT(e,t,r,s){const c=t.sub(e)._perp()._unit(),d=r.sub(t)._perp()._unit();return AC(e,t,r,bv(c,d),s)}function AC(e,t,r,s,c){const d=Math.sqrt(1-s*s);return Math.min(e.dist(t)/3,t.dist(r)/3,c*d/s)}function xv(e,t,r){return e.x<r[0].x&&t.x<r[0].x||e.x>r[1].x&&t.x>r[1].x||e.y<r[0].y&&t.y<r[0].y||e.y>r[1].y&&t.y>r[1].y}function SO(e,t){return e.x<t[0].x||e.x>t[1].x||e.y<t[0].y||e.y>t[1].y}function sx(e,t,r){if(e.x<0||e.x>=Dt||t.x<0||t.x>=Dt||r.x<0||r.x>=Dt)return!1;const s=r.sub(t),c=s.perp(),d=e.sub(t);return(s.x*d.x+s.y*d.y)/Math.sqrt((s.x*s.x+s.y*s.y)*(d.x*d.x+d.y*d.y))>-.866&&c.x*d.x+c.y*d.y<0}function dy(e,t,r){const s=t?2|e:-3&e;return r?1|s:-2&s}function ax(){const e=Math.PI/32,t=Math.tan(e),r=Ep;return r*Math.sqrt(1+2*t*t)-r}function lx(e,t,r){const s=1<<r.z,c=ka(r.x/s),d=ka((r.x+1)/s),f=ti(r.y/s),g=ti((r.y+1)/s);return function(y,b,C,P,E=0,I){const A=[];if(!y.length||!C||!P)return A;const l=(T,k)=>{for(const N of T)A.push({polygon:N,bounds:k})},u=Math.ceil(Math.log2(C)),p=Math.ceil(Math.log2(P)),m=u-p,v=[];for(let T=0;T<Math.abs(m);T++)v.push(m>0?0:1);for(let T=0;T<Math.min(u,p);T++)v.push(0),v.push(1);let M=y;if(M=$g(M,b[0].y-E,b[1].y+E,1),M=$g(M,b[0].x-E,b[1].x+E,0),!M.length)return A;const O=[];for(v.length?O.push({polygons:M,bounds:b,depth:0}):l(M,b);O.length;){const T=O.pop(),k=T.depth,N=v[k],F=T.bounds[0],$=T.bounds[1],q=0===N?F.x:F.y,Z=0===N?$.x:$.y,X=I?I(N,q,Z):.5*(q+Z),K=$g(T.polygons,q-E,X+E,N),J=$g(T.polygons,X-E,Z+E,N);if(K.length){const st=[F,new tt(0===N?X:$.x,1===N?X:$.y)];v.length>k+1?O.push({polygons:K,bounds:st,depth:k+1}):l(K,st)}if(J.length){const st=[new tt(0===N?X:F.x,1===N?X:F.y),$];v.length>k+1?O.push({polygons:J,bounds:st,depth:k+1}):l(J,st)}}return A}(e,t,Math.ceil((d-c)/11.25),Math.ceil((f-g)/11.25),1,(y,b,C)=>{if(0===y)return.5*(b+C);{const P=ti((r.y+b/Dt)/s);return(Oo(.5*(ti((r.y+C/Dt)/s)+P))*s-r.y)*Dt}})}function AO(e,t,r,s,c,d){const f=Math.pow(2,s.z-c.z);for(let g=0;g<r;g++){let y=e.int16[2*(g+t)+0],b=e.int16[2*(g+t)+1];y=(y+c.x*Dt)*f-s.x*Dt,b=(b+c.y*Dt)*f-s.y*Dt,d.push(new tt(y,b))}}De(gm,"FillExtrusionBucket",{omit:["layers","features"]}),De(SC,"PartData"),De(yv,"FootprintSegment"),De(IO,"BorderCentroidData"),De(pm,"GroundEffect");const cx=new jt({visibility:new G(wt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new G(wt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var ux={paint:new jt({"fill-extrusion-opacity":new G(wt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Q(wt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new G(wt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new G(wt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Q(wt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Q(wt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Q(wt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new G(wt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new G(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new G(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new G(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new G(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new G(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new G(wt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new G(wt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Q(wt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Q(wt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new G(wt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new G(wt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new G(wt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new G(wt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new G(wt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"])}),layout:cx};class nd extends tt{constructor(t,r,s){super(t,r),this.z=s}}function Wp(e,t){return e.x*t.x+e.y*t.y}function hy(e,t){if(1===e.length){let r=0;const s=t[r++];let c;for(;!c||s.equals(c);)if(c=t[r++],!c)return 1/0;for(;r<t.length;r++){const d=t[r],f=e[0],g=c.sub(s),y=d.sub(s),b=f.sub(s),C=Wp(g,g),P=Wp(g,y),E=Wp(y,y),I=Wp(b,g),A=Wp(b,y),l=C*E-P*P,u=(E*I-P*A)/l,p=(C*A-P*I)/l,m=s.z*(1-u-p)+c.z*u+d.z*p;if(isFinite(m))return m}return 1/0}{let r=1/0;for(const s of t)r=Math.min(r,s.z);return r}}function dx(e,t,r,s,c,d,f,g){const y=f*c.getElevationAt(e,t,!0,!0),b=0!==d[0],C=b?0===d[1]?f*(d[0]/7-450):f*function(P,E,I){const A=Math.floor(E[0]/8),l=Math.floor(E[1]/8),u=10*(E[0]-8*A),p=10*(E[1]-8*l),m=P.getElevationAt(A,l,!0,!0),v=P.getMeterToDEM(I),M=Math.floor(.5*(u*v-1)),O=Math.floor(.5*(p*v-1)),T=P.tileCoordToPixel(A,l),k=2*M+1,N=2*O+1,F=(rt=k,ct=N,[(J=P).getElevationAtPixel(st=T.x-M,it=T.y-O,!0),J.getElevationAtPixel(st+ct,it,!0),J.getElevationAtPixel(st,it+ct,!0),J.getElevationAtPixel(st+rt,it+ct,!0)]),$=Math.abs(F[0]-F[1]),q=Math.abs(F[2]-F[3]),Z=Math.abs(F[0]-F[2])+Math.abs(F[1]-F[3]),X=Math.min(.25,.5*v*($+q)/k),K=Math.min(.25,.5*v*Z/N);var J,st,it,rt,ct;return m+Math.max(X*u,K*p)}(c,d,g):y;return{base:y+(0===r)?-1:r,top:b?Math.max(C+s,y+r+2):y+s}}const hx=new jt({"line-cap":new Q(wt.layout_line["line-cap"]),"line-join":new Q(wt.layout_line["line-join"]),"line-miter-limit":new G(wt.layout_line["line-miter-limit"]),"line-round-limit":new G(wt.layout_line["line-round-limit"]),"line-sort-key":new Q(wt.layout_line["line-sort-key"]),visibility:new G(wt.layout_line.visibility)});var fx={paint:new jt({"line-opacity":new Q(wt.paint_line["line-opacity"]),"line-color":new Q(wt.paint_line["line-color"]),"line-translate":new G(wt.paint_line["line-translate"]),"line-translate-anchor":new G(wt.paint_line["line-translate-anchor"]),"line-width":new Q(wt.paint_line["line-width"]),"line-gap-width":new Q(wt.paint_line["line-gap-width"]),"line-offset":new Q(wt.paint_line["line-offset"]),"line-blur":new Q(wt.paint_line["line-blur"]),"line-dasharray":new Q(wt.paint_line["line-dasharray"]),"line-pattern":new Q(wt.paint_line["line-pattern"]),"line-gradient":new St(wt.paint_line["line-gradient"]),"line-trim-offset":new G(wt.paint_line["line-trim-offset"]),"line-emissive-strength":new G(wt.paint_line["line-emissive-strength"]),"line-border-width":new Q(wt.paint_line["line-border-width"]),"line-border-color":new Q(wt.paint_line["line-border-color"])}),layout:hx};const ZT=(e,t,r,s,c,d,f)=>{const g=e.transform,y=g.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:fy(e,t,r,s),u_pixels_to_tile_units:y,u_device_pixel_ratio:d,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:c,u_texsize:DC(r)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:wv(t,e.transform),u_alpha_discard_threshold:0,u_trim_offset:f,u_emissive_strength:r.paint.get("line-emissive-strength")}},DO=(e,t,r,s,c)=>{const d=e.transform;return{u_matrix:fy(e,t,r,s),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:d.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:c,u_image:0,u_tile_units_to_pixels:wv(t,d),u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function wv(e,t){return 1/td(e,1,t.tileZoom)}function fy(e,t,r,s){return e.translatePosMatrix(s||t.tileID.projMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const kO=e=>{const t=[];DC(e)&&t.push("RENDER_LINE_DASH"),e.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const r=e.paint.get("line-trim-offset");return 0===r[0]&&0===r[1]||t.push("RENDER_LINE_TRIM_OFFSET"),0!==e.paint.get("line-border-width").constantOr(1)&&t.push("RENDER_LINE_BORDER"),t};function DC(e){const t=e.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}const ya=new class extends Q{possiblyEvaluate(e,t){return t=new Lo(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,s){return t=_t({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,s)}}(fx.paint.properties["line-width"].specification);function RO(e,t){return t>0?t+2*e:e}ya.useIntegerZoom=!0;const LO=new jt({visibility:new G(wt.layout_background.visibility)});var px={paint:new jt({"background-color":new G(wt.paint_background["background-color"]),"background-pattern":new G(wt.paint_background["background-pattern"]),"background-opacity":new G(wt.paint_background["background-opacity"]),"background-emissive-strength":new G(wt.paint_background["background-emissive-strength"])}),layout:LO};const Cv=new jt({visibility:new G(wt.layout_raster.visibility)});var kC={paint:new jt({"raster-opacity":new G(wt.paint_raster["raster-opacity"]),"raster-color":new St(wt.paint_raster["raster-color"]),"raster-color-mix":new G(wt.paint_raster["raster-color-mix"]),"raster-color-range":new G(wt.paint_raster["raster-color-range"]),"raster-hue-rotate":new G(wt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new G(wt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new G(wt.paint_raster["raster-brightness-max"]),"raster-saturation":new G(wt.paint_raster["raster-saturation"]),"raster-contrast":new G(wt.paint_raster["raster-contrast"]),"raster-resampling":new G(wt.paint_raster["raster-resampling"]),"raster-fade-duration":new G(wt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new G(wt.paint_raster["raster-emissive-strength"]),"raster-array-band":new G(wt.paint_raster["raster-array-band"]),"raster-elevation":new G(wt.paint_raster["raster-elevation"])}),layout:Cv};function RC(e,t,r,s,c,d,f,g){const y=[e,r,c,t,s,d,1,1,1],b=[f,g,1],C=al.adjoint([],y),[P,E,I]=dt.transformMat3(b,b,al.transpose(C,C));return al.multiply(y,[P,0,0,0,E,0,0,0,I],y)}class Qc extends Ro{constructor(t,r,s,c){super(),this.id=t,this.dispatcher=s,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(c),this.options=r,this._dirty=!1}load(t,r){if(this._loaded=r||!1,this.fire(new de("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=Bt(this.map._requestManager.transformRequest(this.url,Ft.Image),(s,c)=>{if(this._imageRequest=null,this._loaded=!0,s)this.fire(new Cn(s));else if(c){const{HTMLImageElement:d}=lt;this.image=c instanceof d?Mn.getImageData(c):c,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new pc(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new de("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof pc||this.texture.destroy()}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let r=t[0][1],s=t[0][1];for(const d of t)d[1]>s&&(s=d[1]),d[1]<r&&(r=d[1]);const c=(s+r)/2;if(c>vo?this.onNorthPole=!0:c<-vo&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const d=t.map(Xn.fromLngLat);this.tileID=function(f){let g=1/0,y=1/0,b=-1/0,C=-1/0;for(const A of f)g=Math.min(g,A.x),y=Math.min(y,A.y),b=Math.max(b,A.x),C=Math.max(C,A.y);const P=Math.max(b-g,C-y),E=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),I=Math.pow(2,E);return new ic(E,Math.floor((g+b)/2*I),Math.floor((y+C)/2*I))}(d),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new de("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const y in this.tiles){const b=this.tiles[y];"loaded"!==b.state&&(b.state="loaded",b.texture=this.texture)}if(this._boundsArray)return;const r=Yu(this.tileID,this.map.transform.projection),[s,c,d,f]=this.coordinates.map(y=>{const b=r.projection.project(y[0],y[1]);return iO(r,b)._round()});this.perspectiveTransform=function(y,b,C,P,E,I,A,l,u,p){const m=RC(0,0,y,0,0,b,y,b),v=RC(C,P,E,I,A,l,u,p);return al.multiply(v,al.adjoint(m,m),v),[v[6]/v[8]*y/Dt,v[7]/v[8]*b/Dt]}(this.width,this.height,s.x,s.y,c.x,c.y,f.x,f.y,d.x,d.y);const g=this._boundsArray=new nl;g.emplaceBack(s.x,s.y,0,0),g.emplaceBack(c.x,c.y,Dt,0),g.emplaceBack(f.x,f.y,0,Dt),g.emplaceBack(d.x,d.y,Dt,Dt),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(g,$1.members),this.boundsSegments=lo.simpleSegment(0,0,4,2)}prepare(){const t=0!==Object.keys(this.tiles).length;if(this.tileID&&!t)return;const r=this.map.painter.context,s=r.gl;!this._dirty||this.texture instanceof pc||(this.texture?this.texture.update(this.image):(this.texture=new xo(r,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(r)}loadTile(t,r){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},r(null)):(t.state="errored",r(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class NO extends gs{constructor(t){super(t,{}),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(t){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}const FO=new jt({visibility:new G(wt.layout_sky.visibility)});var WT={paint:new jt({"sky-type":new G(wt.paint_sky["sky-type"]),"sky-atmosphere-sun":new G(wt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new G(wt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new G(wt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new G(wt.paint_sky["sky-gradient-radius"]),"sky-gradient":new St(wt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new G(wt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new G(wt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new G(wt.paint_sky["sky-opacity"])}),layout:FO};function Mv(e,t,r){const s=[0,0,1],c=Bi.identity([]);return Bi.rotateY(c,c,r?-Ct(e)+Math.PI:Ct(e)),Bi.rotateX(c,c,-Ct(t)),dt.transformQuat(s,s,c),dt.normalize(s,s)}var zO={paint:new jt({})};const KT={circle:class extends gs{constructor(e,t){super(e,ze,t)}createBucket(e){return new Wi(e)}queryRadius(e){const t=e;return ai("circle-radius",this,t)+ai("circle-stroke-width",this,t)+_a(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,r,s,c,d,f,g){const y=p1(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),d.angle,e.pixelToTileUnitsFactor),b=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r);return wn(e,s,d,f,g,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),y,b)}getProgramIds(){return["circle"]}getDefaultProgramParams(e,t){const r=Sp(this);return{config:new Lu(this,t),defines:r,overrideFog:!1}}},heatmap:class extends gs{createBucket(e){return new Se(e)}constructor(e,t){super(e,jw,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=$w({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(e){return ai("heatmap-radius",this,e)}queryIntersectsFeature(e,t,r,s,c,d,f,g){const y=this.paint.get("heatmap-radius").evaluate(t,r);return wn(e,s,d,f,g,!0,!0,new tt(0,0),y)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(e,t){return"heatmap"===e?{config:new Lu(this,t),overrideFog:!1}:{}}},hillshade:class extends gs{constructor(e,t){super(e,$P,t)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(e,t){return{overrideFog:!1}}},fill:class extends gs{constructor(e,t){super(e,qw,t)}getProgramIds(){const e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),r=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getDefaultProgramParams(e,t){return{config:new Lu(this,t),overrideFog:!1}}recalculate(e,t){super.recalculate(e,t);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new E0(e)}queryRadius(){return _a(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,r,s,c,d){return!e.queryGeometry.isAboveHorizon&&NP(Il(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),d.angle,e.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends gs{constructor(e,t){super(e,ux,t),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(e){return new gm(e)}queryRadius(){return _a(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(e,t,r,s,c,d,f,g,y){const b=p1(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),d.angle,e.pixelToTileUnitsFactor),C=this.paint.get("fill-extrusion-height").evaluate(t,r),P=this.paint.get("fill-extrusion-base").evaluate(t,r),E=[0,0],I=g&&d.elevation,A=d.elevation?d.elevation.exaggeration():1,l=e.tile.getBucket(this);if(I&&l instanceof gm){const M=l.centroidVertexArray,O=y+1;O<M.length&&(E[0]=M.geta_centroid_pos0(O),E[1]=M.geta_centroid_pos1(O))}if(0===E[0]&&1===E[1])return!1;"globe"===d.projection.name&&(s=lx([s],[new tt(0,0),new tt(Dt,Dt)],e.tileID.canonical).map(M=>M.polygon).flat());const u=I?g:null,[p,m]=(O=s,T=P,k=C,N=b,F=f,$=u,q=E,Z=A,X=d.center.lat,"globe"===(M=d).projection.name?function(J,st,it,rt,ct,yt,Et,Tt,zt,Nt,$t){const Rt=[],oe=[],Oe=J.projection.upVectorScale($t,J.center.lat,J.worldSize).metersToTile,Ee=[0,0,0,1],Be=[0,0,0,1],je=(Qe,nr,ln,Ln)=>{Qe[0]=nr,Qe[1]=ln,Qe[2]=Ln,Qe[3]=1},On=ax();it>0&&(it+=On),rt+=On;for(const Qe of st){const nr=[],ln=[];for(const Ln of Qe){const En=Ln.x+ct.x,mn=Ln.y+ct.y,wr=J.projection.projectTilePoint(En,mn,$t),Lr=J.projection.upVector($t,Ln.x,Ln.y);let rr=it,Kr=rt;if(Et){const Ao=dx(En,mn,it,rt,Et,Tt,zt,Nt);rr+=Ao.base,Kr+=Ao.top}0!==it?je(Ee,wr.x+Lr[0]*Oe*rr,wr.y+Lr[1]*Oe*rr,wr.z+Lr[2]*Oe*rr):je(Ee,wr.x,wr.y,wr.z),je(Be,wr.x+Lr[0]*Oe*Kr,wr.y+Lr[1]*Oe*Kr,wr.z+Lr[2]*Oe*Kr),dt.transformMat4(Ee,Ee,yt),dt.transformMat4(Be,Be,yt),nr.push(new nd(Ee[0],Ee[1],Ee[2])),ln.push(new nd(Be[0],Be[1],Be[2]))}Rt.push(nr),oe.push(ln)}return[Rt,oe]}(M,O,T,k,N,F,$,q,Z,X,e.tileID.canonical):$?function(J,st,it,rt,ct,yt,Et,Tt,zt){const Nt=[],$t=[],Rt=[0,0,0,1];for(const oe of J){const Oe=[],Ee=[];for(const Be of oe){const je=Be.x+rt.x,On=Be.y+rt.y,Qe=dx(je,On,st,it,yt,Et,Tt,zt);Rt[0]=je,Rt[1]=On,Rt[2]=Qe.base,Rt[3]=1,kr.transformMat4(Rt,Rt,ct),Rt[3]=Math.max(Rt[3],1e-5);const nr=new nd(Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]);Rt[0]=je,Rt[1]=On,Rt[2]=Qe.top,Rt[3]=1,kr.transformMat4(Rt,Rt,ct),Rt[3]=Math.max(Rt[3],1e-5);const ln=new nd(Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]);Oe.push(nr),Ee.push(ln)}Nt.push(Oe),$t.push(Ee)}return[Nt,$t]}(O,T,k,N,F,$,q,Z,X):function(J,st,it,rt,ct){const yt=[],Et=[],Tt=ct[8]*st,zt=ct[9]*st,Nt=ct[10]*st,$t=ct[11]*st,Rt=ct[8]*it,oe=ct[9]*it,Oe=ct[10]*it,Ee=ct[11]*it;for(const Be of J){const je=[],On=[];for(const Qe of Be){const nr=Qe.x+rt.x,ln=Qe.y+rt.y,Ln=ct[0]*nr+ct[4]*ln+ct[12],En=ct[1]*nr+ct[5]*ln+ct[13],mn=ct[2]*nr+ct[6]*ln+ct[14],wr=ct[3]*nr+ct[7]*ln+ct[15],Lr=Ln+Tt,rr=En+zt,Kr=mn+Nt,Ao=Math.max(wr+$t,1e-5),mo=Ln+Rt,Fo=En+oe,$i=mn+Oe,Ii=Math.max(wr+Ee,1e-5);je.push(new nd(Lr/Ao,rr/Ao,Kr/Ao)),On.push(new nd(mo/Ii,Fo/Ii,$i/Ii))}yt.push(je),Et.push(On)}return[yt,Et]}(O,T,k,N,F)),v=e.queryGeometry;var M,O,T,k,N,F,$,q,Z,X;return function(M,O,T){let k=1/0;NP(T,O)&&(k=hy(T,O[0]));for(let N=0;N<O.length;N++){const F=O[N],$=M[N];for(let q=0;q<F.length-1;q++){const Z=F[q],X=[Z,F[q+1],$[q+1],$[q],Z];Bw(T,X)&&(k=Math.min(k,hy(T,X)))}}return k!==1/0&&k}(p,m,v.isPointQuery()?v.screenBounds:v.screenGeometry)}},line:class extends gs{constructor(e,t){super(e,fx,t),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Ym,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=ya.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new jp(e)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(e,t){const r=kO(this);return{config:new Lu(this,t),defines:r,overrideFog:!1}}queryRadius(e){const t=e,r=RO(ai("line-width",this,t),ai("line-gap-width",this,t)),s=ai("line-offset",this,t);return r/2+Math.abs(s)+_a(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,r,s,c,d){if(e.queryGeometry.isAboveHorizon)return!1;const f=Il(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),d.angle,e.pixelToTileUnitsFactor),g=e.pixelToTileUnitsFactor/2*RO(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),y=this.paint.get("line-offset").evaluate(t,r);return y&&(s=function(b,C){const P=[],E=new tt(0,0);for(let I=0;I<b.length;I++){const A=b[I],l=[];for(let u=0;u<A.length;u++){const p=A[u],m=A[u+1],v=0===u?E:p.sub(A[u-1])._unit()._perp(),M=u===A.length-1?E:m.sub(p)._unit()._perp(),O=v._add(M)._unit();O._mult(1/(O.x*M.x+O.y*M.y)),l.push(O._mult(C)._add(p))}P.push(l)}return P}(s,y*e.pixelToTileUnitsFactor)),function(b,C,P){for(let E=0;E<C.length;E++){const I=C[E];if(b.length>=3)for(let A=0;A<I.length;A++)if($c(b,I[A]))return!0;if(ET(b,I,P))return!0}return!1}(f,s,g)}isTileClipped(){return!0}},symbol:Jd,background:class extends gs{constructor(e,t){super(e,px,t)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(e,t){return{overrideFog:!1}}},raster:class extends gs{constructor(e,t){super(e,kC,t),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}isLayerDraped(e){return!(e&&e._source instanceof Qc)||!e._source.onNorthPole&&!e._source.onSouthPole&&0===this.paint.get("raster-elevation")}_handleSpecialPaintPropertyUpdate(e){"raster-color"!==e&&"raster-color-range"!==e||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const e=this._transitionablePaint._values["raster-color"].value.expression,[t,r]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=$w({expression:e,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:t,end:r}],resolution:256}),this.colorRampTexture=null}},sky:class extends gs{constructor(e,t){super(e,WT,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"sky-gradient"===e?this._updateColorRamp():"sky-atmosphere-sun"!==e&&"sky-atmosphere-halo-color"!==e&&"sky-atmosphere-color"!==e&&"sky-atmosphere-sun-intensity"!==e||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=$w({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(e){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=e.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(e,t){if("atmosphere"===this.paint.get("sky-type")){const s=this.paint.get("sky-atmosphere-sun"),c=!s,d=e.style.light,f=d.properties.get("position");return c&&"viewport"===d.properties.get("anchor")&&gt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),c?Mv(f.azimuthal,90-f.polar,t):Mv(s[0],90-s[1],t)}const r=this.paint.get("sky-gradient-center");return Mv(r[0],90-r[1],t)}isSky(){return!0}markSkyboxValid(e){this._skyboxInvalidated=!1,this._lightPosition=e.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const e=this.paint.get("sky-type");return"atmosphere"===e?["skyboxCapture","skybox"]:"gradient"===e?["skyboxGradient"]:null}},slot:class extends gs{constructor(e,t){super(e,zO)}},model:class extends gs{constructor(e,t){super(e,CO,t)}createBucket(e){return new fm(e)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(){return 0}queryIntersectsFeature(){return!1}_handleOverridablePaintPropertyUpdate(e,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven()||"model-color"!==e&&"model-color-mix-intensity"!==e&&"model-rotation"!==e&&"model-scale"!==e&&"model-translation"!==e&&"model-emissive-strength"!==e)}_isPropertyZoomDependent(e){const t=this._transitionablePaint._values[e];return null!=t&&null!=t.value&&null!=t.value.expression&&t.value.expression instanceof Es}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}}};function Kp(e,t){return"custom"===e.type?new NO(e):new KT[e.type](e,t)}function LC(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class py extends Ro{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(t){this.images[t]={},this.loaded[t]=!1,this.updatedImages[t]={},this.patterns[t]={},this.callbackDispatchedThisFrame[t]={},this.atlasImage[t]=new Ui({width:1,height:1})}isLoaded(){for(const t in this.loaded)if(!this.loaded[t])return!1;return!0}setLoaded(t,r){if(this.loaded[r]!==t&&(this.loaded[r]=t,t)){for(const{ids:s,callback:c}of this.requestors)this._notify(s,r,c);this.requestors=[]}}hasImage(t,r){return!!this.getImage(t,r)}getImage(t,r){return this.images[r][t]}addImage(t,r,s){this._validate(t,s)&&(this.images[r][t]=s)}_validate(t,r){let s=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new Cn(new Error(`Image "${t}" has invalid "stretchX" value`))),s=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new Cn(new Error(`Image "${t}" has invalid "stretchY" value`))),s=!1),this._validateContent(r.content,r)||(this.fire(new Cn(new Error(`Image "${t}" has invalid "content" value`))),s=!1),s}_validateStretch(t,r){if(!t)return!0;let s=0;for(const c of t){if(c[0]<s||c[1]<c[0]||r<c[1])return!1;s=c[1]}return!0}_validateContent(t,r){return!(t&&(4!==t.length||t[0]<0||r.data.width<t[0]||t[1]<0||r.data.height<t[1]||t[2]<0||r.data.width<t[2]||t[3]<0||r.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,r,s){s.version=this.images[r][t].version+1,this.images[r][t]=s,this.updatedImages[r][t]=!0}removeImage(t,r){const s=this.images[r][t];delete this.images[r][t],delete this.patterns[r][t],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(t){return Object.keys(this.images[t])}getImages(t,r,s){let c=!0;const d=!!this.loaded[r];if(!d)for(const f of t)this.images[r][f]||(c=!1);d||c?this._notify(t,r,s):this.requestors.push({ids:t,scope:r,callback:s})}getUpdatedImages(t){return this.updatedImages[t]}_notify(t,r,s){const c={};for(const d of t){this.images[r][d]||this.fire(new de("styleimagemissing",{id:d}));const f=this.images[r][d];f?c[d]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,hasRenderCallback:!(!f.userImage||!f.userImage.render)}:gt(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}s(null,c)}getPixelSize(t){const{width:r,height:s}=this.atlasImage[t];return{width:r,height:s}}getPattern(t,r){const s=this.patterns[r][t],c=this.getImage(t,r);if(!c)return null;if(s&&s.position.version===c.version)return s.position;if(s)s.position.version=c.version;else{const d={w:c.data.width+2,h:c.data.height+2,x:0,y:0},f=new eC(d,c);this.patterns[r][t]={bin:d,position:f}}return this._updatePatternAtlas(r),this.patterns[r][t].position}bind(t,r){const s=t.gl;let c=this.atlasTexture[r];c?this.dirty&&(c.update(this.atlasImage[r]),this.dirty=!1):(c=new xo(t,this.atlasImage[r],s.RGBA),this.atlasTexture[r]=c),c.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(t){const r=[];for(const f in this.patterns[t])r.push(this.patterns[t][f].bin);const{w:s,h:c}=S1(r),d=this.atlasImage[t];d.resize({width:s||1,height:c||1});for(const f in this.patterns[t]){const{bin:g}=this.patterns[t][f],y=g.x+1,b=g.y+1,C=this.images[t][f].data,P=C.width,E=C.height;Ui.copy(C,d,{x:0,y:0},{x:y,y:b},{width:P,height:E}),Ui.copy(C,d,{x:0,y:E-1},{x:y,y:b-1},{width:P,height:1}),Ui.copy(C,d,{x:0,y:0},{x:y,y:b+E},{width:P,height:1}),Ui.copy(C,d,{x:P-1,y:0},{x:y-1,y:b},{width:1,height:E}),Ui.copy(C,d,{x:0,y:0},{x:y+P,y:b},{width:1,height:E})}this.dirty=!0}beginFrame(){for(const t in this.images)this.callbackDispatchedThisFrame[t]={}}dispatchRenderCallbacks(t,r){for(const s of t){if(this.callbackDispatchedThisFrame[r][s])continue;this.callbackDispatchedThisFrame[r][s]=!0;const c=this.images[r][s];LC(c)&&this.updateImage(s,r,c)}}}const Pv=new jt({anchor:new G(wt.light.anchor),position:new class{constructor(e){this.specification=e}possiblyEvaluate(e,t){return Pe(e.expression.evaluate(t))}interpolate(e,t,r){return{x:vn(e.x,t.x,r),y:vn(e.y,t.y,r),z:vn(e.z,t.z,r),azimuthal:vn(e.azimuthal,t.azimuthal,r),polar:vn(e.polar,t.polar,r)}}}(wt.light.position),color:new G(wt.light.color),intensity:new G(wt.light.intensity)});class mm extends Ro{constructor(t,r="flat"){super(),this._transitionable=new Xs(Pv),this.setLight(t,r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,r,s={}){this._validate(hp,t,s)||(this._transitionable.setTransitionOrValue(t),this.id=r)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,s){return(!s||!1!==s.validate)&&Uh(this,t.call(Ea,_t({value:r,style:{glyphs:!0,sprite:!0},styleSpec:wt})))}}const gy=new jt({source:new G(wt.terrain.source),exaggeration:new G(wt.terrain.exaggeration)});let Ov=class extends Ro{constructor(e,t,r,s){super(),this.scope=r,this._transitionable=new Xs(gy,s),this._transitionable.setTransitionOrValue(e,s),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=t}get(){return this._transitionable.serialize()}set(e,t){this._transitionable.setTransitionOrValue(e,t)}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}getExaggeration(e){return this._transitioning.possiblyEvaluate(new Lo(e)).get("exaggeration")}isZoomDependent(){const e=this._transitionable._values.exaggeration;return null!=e&&null!=e.value&&null!=e.value.expression&&e.value.expression instanceof Es}};const NC=45,gx=65,rd=.05;function od(e,t,r,s){const c=vs(NC,gx,r),[d,f]=mx(e,s);let g=1-Math.min(1,Math.exp((t-d)/(f-d)*-6));return g*=g*g,g=Math.min(1,1.00747*g),g*c*e.alpha}function mx(e,t){const r=.5/Math.tan(.5*t);return[e.range[0]+r,e.range[1]+r]}function Yp(e,t,r,s,c){const d=dt.transformMat4([],[t,r,s],c.mercatorFogMatrix);return od(e,dt.length(d),c.pitch,c._fov)}function Ev(e,t,r,s,c,d,f){const g=[[r,s,0],[c,s,0],[c,d,0],[r,d,0]];let y=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(const C of g){const P=dt.transformMat4([],C,t),E=dt.length(P);y=Math.min(y,E),b=Math.max(b,E)}return[od(e,y,f.pitch,f._fov),od(e,b,f.pitch,f._fov)]}const YT=new jt({range:new G(wt.fog.range),color:new G(wt.fog.color),"high-color":new G(wt.fog["high-color"]),"space-color":new G(wt.fog["space-color"]),"horizon-blend":new G(wt.fog["horizon-blend"]),"star-intensity":new G(wt.fog["star-intensity"]),"vertical-range":new G(wt.fog["vertical-range"])});class BO extends Ro{constructor(t,r){super(),this._transitionable=new Xs(YT),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=r}get state(){const t=this._transform,r="globe"===t.projection.name,s=Pi(t.zoom),c=this.properties.get("range"),d=[.5,3];return{range:r?[vn(d[0],c[0],s),vn(d[1],c[1],s)]:c,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,r={}){if(this._validate(Bh,t,r))return;const s=_t({},t);for(const c of Object.keys(wt.fog))void 0===s[c]&&(s[c]=wt.fog[c].default);this._transitionable.setTransitionOrValue(s)}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const r=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:vs(NC,gx,t))*r.a}getOpacityAtLatLng(t,r){return this._transform.projection.supportsFog?function(s,c,d){const f=Xn.fromLngLat(c),g=d.elevation?d.elevation.getAtPointOrZero(f):0;return Yp(s,f.x,f.y,g,d)}(this.state,t,r):0}getOpacityForTile(t){if(!this._transform.projection.supportsFog)return[1,1];const r=this._transform.calculateFogTileMatrix(t.toUnwrapped());return Ev(this.state,r,0,0,Dt,Dt,this._transform)}getOpacityForBounds(t,r,s,c,d){return this._transform.projection.supportsFog?Ev(this.state,t,r,s,c,d,this._transform):[1,1]}getFovAdjustedRange(t){return this._transform.projection.supportsFog?mx(this.state,t):[0,1]}isVisibleOnFrustum(t){if(!this._transform.projection.supportsFog)return!1;const r=[4,5,6,7];for(const s of r){const c=t.points[s];let d;if(c[2]>=0)d=c;else{const f=t.points[s-4];d=_g(f,c,f[2]/(f[2]-c[2]))}if(Yp(this.state,d[0],d[1],0,this._transform)>=rd)return!0}return!1}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,s){return(!s||!1!==s.validate)&&Uh(this,t.call(Ea,_t({value:r,style:{glyphs:!0,sprite:!0},styleSpec:wt})))}}class FC{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Tv{constructor(){this.tasks={},this.taskQueue=[],Tn(["process"],this),this.invoker=new FC(this.process),this.nextId=0}add(t,r){const s=this.nextId++,c=function({type:d,isSymbolTile:f,zoom:g}){return g=g||0,"message"===d?0:"maybePrepare"!==d||f?"parseTile"!==d||f?"parseTile"===d&&f?300-g:"maybePrepare"===d&&f?400-g:500:200-g:100-g}(r);if(0===c){ae();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:t,metadata:r,priority:c,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){ae();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const t=this.pick();if(null===t)return;const r=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let t=null,r=1/0;for(let c=0;c<this.taskQueue.length;c++){const d=this.tasks[this.taskQueue[c]];d.priority<r&&(r=d.priority,t=c)}if(null===t)return null;const s=this.taskQueue[t];return this.taskQueue.splice(t,1),s}remove(){this.invoker.remove()}}class Iv{constructor(t,r,s){this.target=t,this.parent=r,this.mapId=s,this.callbacks={},this.cancelCallbacks={},Tn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Tv}send(t,r,s,c,d=!1,f){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=f,this.callbacks[g]=s);const y=new Set;return this.target.postMessage({id:g,type:t,hasCallback:!!s,targetMapId:c,mustQueue:d,sourceMapId:this.mapId,data:nc(r,y)},y),{cancel:()=>{s&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(t){const r=t.data,s=r.id;if(s&&(!r.targetMapId||this.mapId===r.targetMapId))if("<cancel>"===r.type){const c=this.cancelCallbacks[s];delete this.cancelCallbacks[s],c&&c.cancel()}else if(r.mustQueue||ae()){const c=this.callbacks[s];this.cancelCallbacks[s]=this.scheduler.add(()=>this.processTask(s,r),c&&c.metadata||{type:"message"})}else this.processTask(s,r)}processTask(t,r){if("<response>"===r.type){const s=this.callbacks[t];delete this.callbacks[t],s&&(r.error?s(U(r.error)):s(null,U(r.data)))}else{const s=new Set,c=r.hasCallback?(f,g)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:f?nc(f):null,data:nc(g,s)},s)}:f=>{},d=U(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,d,c);else if(this.parent.getWorkerSource){const f=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,f[0],d.source,d.scope)[f[1]](d,c)}else c(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}let _m=(()=>{class e{constructor(r,s){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=In();const c=this.workerPool.acquire(this.id);for(let d=0;d<c.length;d++){const f=new e.Actor(c[d],s,this.id);f.name=`Worker ${d}`,this.actors.push(f)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(r,s,c){Kt(this.actors,(d,f)=>{d.send(r,s,f)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(r=>{r.remove()}),this.actors=[],this.workerPool.release(this.id)}}return e.Actor=Iv,e})();class _x extends Ro{constructor(t,r,s,c){super(),this.scope=s,this._options=t,this.properties=new j(r),this._transitionable=new Xs(r,new Map(c)),this._transitionable.setTransitionOrValue(t.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(t){this._transitionable.setTransitionOrValue(this._options.properties,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(t,r){this._options=t,this._transitionable.setTransitionOrValue(t.properties,r)}shadowsEnabled(){return!!this.properties&&!0===this.properties.get("cast-shadows")}}const my=new jt({color:new G(wt.properties_light_ambient.color),intensity:new G(wt.properties_light_ambient.intensity)}),yx=new jt({direction:new class{constructor(e){this.specification=e}possiblyEvaluate(e,t){return function([r,s]){const c=Pe([1,r,s]);return{x:c.x,y:c.y,z:c.z}}(e.expression.evaluate(t))}interpolate(e,t,r){return{x:vn(e.x,t.x,r),y:vn(e.y,t.y,r),z:vn(e.z,t.z,r)}}}(wt.properties_light_directional.direction),color:new G(wt.properties_light_directional.color),intensity:new G(wt.properties_light_directional.intensity),"cast-shadows":new G(wt.properties_light_directional["cast-shadows"]),"shadow-intensity":new G(wt.properties_light_directional["shadow-intensity"])});class Sv{constructor(t,r,s,c){this.screenBounds=t,this.cameraPoint=r,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=s,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,c)}static createFromScreenPoints(t,r){let s,c;if(t instanceof tt||"number"==typeof t[0]){const d=tt.convert(t);s=[d],c=r.isPointAboveHorizon(d)}else{const d=tt.convert(t[0]),f=tt.convert(t[1]);s=[d,f],c=Gi(d,f).every(g=>r.isPointAboveHorizon(g))}return new Sv(s,r.getCameraPoint(),c,r)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(t){return Gi(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const r=this.screenBounds[0],s=1===this.screenBounds.length?this.screenBounds[0].add(new tt(1,1)):this.screenBounds[1],c=Gi(r,s,0,!1);return this.cameraPoint.y>s.y&&(this.cameraPoint.x>r.x&&this.cameraPoint.x<s.x?c.splice(3,0,this.cameraPoint):this.cameraPoint.x>=s.x?c[2]=this.cameraPoint:this.cameraPoint.x<=r.x&&(c[3]=this.cameraPoint)),function(d,f){const g=[];for(let y=0;y<d.length;y++){const b=Wt(y-1,-1,d.length-1),C=Wt(y+1,-1,d.length-1),P=d[y],E=d[C],I=d[b].sub(P).unit(),A=E.sub(P).unit(),l=A.angleWithSep(I.x,I.y),u=I.add(A).unit().mult(-1*f/Math.sin(l/2));g.push(P.add(u))}return g}(c,t)}bufferedCameraGeometryGlobe(t){const r=this.screenBounds[0],s=1===this.screenBounds.length?this.screenBounds[0].add(new tt(1,1)):this.screenBounds[1],c=Gi(r,s,t),d=this.cameraPoint.clone();switch(3*((d.y>r.y)+(d.y>s.y))+((d.x>r.x)+(d.x>s.x))){case 0:c[0]=d,c[4]=d.clone();break;case 1:c.splice(1,0,d);break;case 2:c[1]=d;break;case 3:c.splice(4,0,d);break;case 5:c.splice(2,0,d);break;case 6:c[3]=d;break;case 7:c.splice(3,0,d);break;case 8:c[2]=d}return c}containsTile(t,r,s,c=0){const d=t.queryPadding/r._pixelsPerMercatorPixel+1,f=s?this._bufferedCameraMercator(d,r):this._bufferedScreenMercator(d,r);let g=t.tileID.wrap+(f.unwrapped?c:0);const y=f.polygon.map(u=>iO(t.tileTransform,u,g));if(!zP(y,0,0,Dt,Dt))return;g=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?c:0);const b=this.screenGeometryMercator.polygon.map(u=>iC(t.tileTransform,u,g)),C=b.map(u=>new tt(u[0],u[1])),P=r.getFreeCameraOptions().position||new Xn(0,0,0),E=iC(t.tileTransform,P,g),I=b.map(u=>{const p=dt.sub(u,u,E);return dt.normalize(p,p),new e1(E,p)}),A=td(t,1,r.zoom)*r._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:C,tilespaceRays:I,bufferedTilespaceGeometry:y,bufferedTilespaceBounds:(l=cs(y),l.min.x=Ne(l.min.x,0,Dt),l.min.y=Ne(l.min.y,0,Dt),l.max.x=Ne(l.max.x,0,Dt),l.max.y=Ne(l.max.y,0,Dt),l),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:A};var l}_bufferedScreenMercator(t,r){const s=bx(t);if(this._screenRaycastCache[s])return this._screenRaycastCache[s];{let c;return c="globe"===r.projection.name?this._projectAndResample(this.bufferedScreenGeometry(t),r):{polygon:this.bufferedScreenGeometry(t).map(d=>r.pointCoordinate3D(d)),unwrapped:!0},this._screenRaycastCache[s]=c,c}}_bufferedCameraMercator(t,r){const s=bx(t);if(this._cameraRaycastCache[s])return this._cameraRaycastCache[s];{let c;return c="globe"===r.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),r):{polygon:this.bufferedCameraGeometry(t).map(d=>r.pointCoordinate3D(d)),unwrapped:!0},this._cameraRaycastCache[s]=c,c}}_projectAndResample(t,r){const s=function(d,f){const g=bt.multiply([],f.pixelMatrix,f.globeMatrix),y=[0,-ea,0,1],b=[0,ea,0,1],C=[0,0,0,1];kr.transformMat4(y,y,g),kr.transformMat4(b,b,g),kr.transformMat4(C,C,g);const P=new tt(y[0]/y[3],y[1]/y[3]),E=new tt(b[0]/b[3],b[1]/b[3]),I=$c(d,P)&&y[3]<C[3],A=$c(d,E)&&b[3]<C[3];if(!I&&!A)return null;const l=function(k,N,F){for(let $=1;$<k.length;$++){const q=ym(N.pointCoordinate3D(k[$-1]).x),Z=ym(N.pointCoordinate3D(k[$]).x);if(F<0){if(q<Z)return{idx:$,t:-q/(Z-1-q)}}else if(Z<q)return{idx:$,t:(1-q)/(Z+1-q)}}return null}(d,f,I?-1:1);if(!l)return null;const{idx:u,t:p}=l;let m=u>1?vx(d.slice(0,u),f):[],v=u<d.length?vx(d.slice(u),f):[];m=m.map(k=>new tt(ym(k.x),k.y)),v=v.map(k=>new tt(ym(k.x),k.y));const M=[...m];0===M.length&&M.push(v[v.length-1]);const O=vn(M[M.length-1].y,(0===v.length?m[0]:v[0]).y,p);let T;return T=I?[new tt(0,O),new tt(0,0),new tt(1,0),new tt(1,O)]:[new tt(1,O),new tt(1,1),new tt(0,1),new tt(0,O)],M.push(...T),0===v.length?M.push(m[0]):M.push(...v),{polygon:M.map(k=>new Xn(k.x,k.y)),unwrapped:!1}}(t,r);if(s)return s;const c=function(d,f){let g=!1,y=-1/0,b=0;for(let P=0;P<d.length-1;P++)d[P].x>y&&(y=d[P].x,b=P);for(let P=0;P<d.length-1;P++){const E=(b+P)%(d.length-1),I=d[E],A=d[E+1];Math.abs(I.x-A.x)>.5&&(I.x<A.x?(I.x+=1,0===E&&(d[d.length-1].x+=1)):(A.x+=1,E+1===d.length-1&&(d[0].x+=1)),g=!0)}const C=yi(f.center.lng);return g&&C<Math.abs(C-1)&&d.forEach(P=>{P.x-=1}),{polygon:d,unwrapped:g}}(vx(t,r).map(d=>new tt(ym(d.x),d.y)),r);return{polygon:c.polygon.map(d=>new Xn(d.x,d.y)),unwrapped:c.unwrapped}}}function vx(e,t){return ju(e,r=>{const s=t.pointCoordinate3D(r);r.x=s.x,r.y=s.y},1/256)}function ym(e){return e<0?1+e%1:e%1}function bx(e){return 100*e|0}function xx(e,t,r,s,c){const d=function(f,g){if(f)return c(f);if(g){e.url&&g.tiles&&e.tiles&&delete e.tiles;const y=he(_t(g,e),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);g.vector_layers&&(y.vectorLayers=g.vector_layers,y.vectorLayerIds=y.vectorLayers.map(b=>b.id)),y.tiles=t.canonicalizeTileset(y,e.url),c(null,y)}};return e.url?_e(t.transformRequest(t.normalizeSourceURL(e.url,null,r,s),Ft.Source),d):Mn.frame(()=>d(null,e))}class _y{constructor(t,r,s){this.bounds=Qo.convert(this.validateBounds(t)),this.minzoom=r||0,this.maxzoom=s||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const r=Math.pow(2,t.z),s=Math.floor(yi(this.bounds.getWest())*r),c=Math.floor(Oo(this.bounds.getNorth())*r),d=Math.ceil(yi(this.bounds.getEast())*r),f=Math.ceil(Oo(this.bounds.getSouth())*r);return t.x>=s&&t.x<d&&t.y>=c&&t.y<f}}class UO{constructor(t,r){this.width=t,this.height=r,this.nextRow=0,this.image=new cf({width:t,height:r}),this.positions={},this.uploaded=!1}getDash(t,r){const s=this.getKey(t,r);return this.positions[s]}trim(){const t=this.width,r=this.height=Co(this.nextRow);this.image.resize({width:t,height:r})}getKey(t,r){return t.join(",")+r}getDashRanges(t,r,s){const c=[];let d=t.length%2==1?-t[t.length-1]*s:0,f=t[0]*s,g=!0;c.push({left:d,right:f,isDash:g,zeroLength:0===t[0]});let y=t[0];for(let b=1;b<t.length;b++){g=!g;const C=t[b];d=y*s,y+=C,f=y*s,c.push({left:d,right:f,isDash:g,zeroLength:0===C})}return c}addRoundDash(t,r,s){const c=r/2;for(let d=-s;d<=s;d++){const f=this.width*(this.nextRow+s+d);let g=0,y=t[g];for(let b=0;b<this.width;b++){b/y.right>1&&(y=t[++g]);const C=Math.abs(b-y.left),P=Math.abs(b-y.right),E=Math.min(C,P);let I;const A=d/s*(c+1);if(y.isDash){const l=c-Math.abs(A);I=Math.sqrt(E*E+l*l)}else I=c-Math.sqrt(E*E+A*A);this.image.data[f+b]=Math.max(0,Math.min(255,I+128))}}}addRegularDash(t,r){for(let y=t.length-1;y>=0;--y){const b=t[y],C=t[y+1];b.zeroLength?t.splice(y,1):C&&C.isDash===b.isDash&&(C.left=b.left,t.splice(y,1))}const s=t[0],c=t[t.length-1];s.isDash===c.isDash&&(s.left=c.left-this.width,c.right=s.right+this.width);const d=this.width*this.nextRow;let f=0,g=t[f];for(let y=0;y<this.width;y++){y/g.right>1&&(g=t[++f]);const b=Math.abs(y-g.left),C=Math.abs(y-g.right),P=Math.min(b,C);this.image.data[d+y]=Math.max(0,Math.min(255,(g.isDash?P:-P)+r+128))}}addDash(t,r){const s=this.getKey(t,r);if(this.positions[s])return this.positions[s];const c="round"===r,d=c?7:0,f=2*d+1;if(this.nextRow+f>this.height)return gt("LineAtlas out of space"),null;0===t.length&&t.push(1);let g=0;for(let C=0;C<t.length;C++)t[C]<0&&(gt("Negative value is found in line dasharray, replacing values with 0"),t[C]=0),g+=t[C];if(0!==g){const C=this.width/g,P=this.getDashRanges(t,this.width,C);c?this.addRoundDash(P,C,d):this.addRegularDash(P,"square"===r?.5*C:0)}const y=this.nextRow+d;this.nextRow+=f;const b={tl:[y,d],br:[g,0]};return this.positions[s]=b,b}}De(UO,"LineAtlas");const wx=1*Ti;class VO{constructor(t){const r={},s=[];for(const g in t){const y=t[g],b=r[g]={};for(const C in y.glyphs){const P=y.glyphs[+C];if(!P||0===P.bitmap.width||0===P.bitmap.height)continue;const E=P.metrics.localGlyph?wx:1,I={x:0,y:0,w:P.bitmap.width+2*E,h:P.bitmap.height+2*E};s.push(I),b[C]=I}}const{w:c,h:d}=S1(s),f=new cf({width:c||1,height:d||1});for(const g in t){const y=t[g];for(const b in y.glyphs){const C=y.glyphs[+b];if(!C||0===C.bitmap.width||0===C.bitmap.height)continue;const P=r[g][b],E=C.metrics.localGlyph?wx:1;cf.copy(C.bitmap,f,{x:0,y:0},{x:P.x+E,y:P.y+E},C.bitmap)}}this.image=f,this.positions=r}}De(VO,"GlyphAtlas");class Cx{constructor(t){this.tileID=new Ir(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.scope=t.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.promoteId=t.promoteId,this.isSymbolTile=t.isSymbolTile,this.tileTransform=Yu(t.tileID.canonical,t.projection),this.projection=t.projection,this.brightness=t.brightness,this.extraShadowCaster=!!t.extraShadowCaster}parse(t,r,s,c,d){this.status="parsing",this.data=t,this.collisionBoxArray=new t0;const f=new C1(Object.keys(t.layers).sort()),g=new z0(this.tileID,this.promoteId);g.bucketLayerIDs=[];const y={},b=new UO(256,256),C={featureIndex:g,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:b,availableImages:s,brightness:this.brightness},P=r.familiesBySource[this.source];for(const m in P){const v=t.layers[m];if(!v)continue;let M=!1,O=!1,T=!1;for(const F of P[m])"symbol"===F[0].type?M=!0:O=!0,F[0].is3D()&&"model"!==F[0].type&&(T=!0);if(this.extraShadowCaster&&!T||!0===this.isSymbolTile&&!M||!1===this.isSymbolTile&&!O)continue;1===v.version&&gt(`Vector tile source "${this.source}" layer "${m}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const k=f.encode(m),N=[];for(let F=0;F<v.length;F++){const $=v.feature(F),q=g.getId($,m);N.push({feature:$,id:q,index:F,sourceLayerIndex:k})}for(const F of P[m]){const $=F[0];(!this.extraShadowCaster||$.is3D()&&"model"!==$.type)&&(void 0!==this.isSymbolTile&&"symbol"===$.type!==this.isSymbolTile||$.minzoom&&this.zoom<Math.floor($.minzoom)||$.maxzoom&&this.zoom>=$.maxzoom||"none"!==$.visibility&&(jO(F,this.zoom,C.brightness,s),(y[$.id]=$.createBucket({index:g.bucketLayerIDs.length,layers:F,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:k,sourceID:this.source,projection:this.projection.spec})).populate(N,C,this.tileID.canonical,this.tileTransform),g.bucketLayerIDs.push(F.map(q=>q.id))))}}let E,I,A,l;b.trim();const u={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},p=()=>{if(E)return this.status="done",d(E);if(this.extraShadowCaster)this.status="done",d(null,{buckets:pe(y).filter(m=>!m.isEmpty()),featureIndex:g,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:C.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(I&&A&&l){const m=new VO(I),v=new A1(A,l);for(const M in y){const O=y[M];O instanceof xf?(jO(O.layers,this.zoom,C.brightness,s),hc(O,I,m.positions,A,v.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):O.hasPattern&&(O instanceof jp||O instanceof E0||O instanceof gm)&&(jO(O.layers,this.zoom,C.brightness,s),O.addFeatures(C,this.tileID.canonical,v.patternPositions,s,this.tileTransform,this.brightness))}this.status="done",d(null,{buckets:pe(y).filter(M=>!M.isEmpty()),featureIndex:g,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:m.image,lineAtlas:b,imageAtlas:v,brightness:C.brightness})}};if(!this.extraShadowCaster){const m=fo(C.glyphDependencies,O=>Object.keys(O).map(Number));Object.keys(m).length?c.send("getGlyphs",{uid:this.uid,stacks:m,scope:this.scope},(O,T)=>{E||(E=O,I=T,p())},void 0,!1,u):I={};const v=Object.keys(C.iconDependencies);v.length?c.send("getImages",{icons:v,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(O,T)=>{E||(E=O,A=T,p())},void 0,!1,u):A={};const M=Object.keys(C.patternDependencies);M.length?c.send("getImages",{icons:M,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(O,T)=>{E||(E=O,l=T,p())},void 0,!1,u):l={}}p()}}function jO(e,t,r,s){const c=new Lo(t,{brightness:r});for(const d of e)d.recalculate(c,s)}class Av{constructor(t){this.entries={},this.scheduler=t}request(t,r,s,c){const d=this.entries[t]=this.entries[t]||{callbacks:[]};if(d.result){const[f,g]=d.result;return this.scheduler?this.scheduler.add(()=>{c(f,g)},r):c(f,g),()=>{}}return d.callbacks.push(c),d.cancel||(d.cancel=s((f,g)=>{d.result=[f,g];for(const y of d.callbacks)this.scheduler?this.scheduler.add(()=>{y(f,g)},r):y(f,g);setTimeout(()=>delete this.entries[t],3e3)})),()=>{d.result||(d.callbacks=d.callbacks.filter(f=>f!==c),d.callbacks.length||(d.cancel(),delete this.entries[t]))}}}function zC(e,t,r){const s=JSON.stringify(e.request);return e.data&&(this.deduped.entries[s]={result:[null,e.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom},c=>{const d=ve(e.request,(f,g,y,b)=>{f?c(f):g&&c(null,{vectorTile:r?void 0:new w1(new k0(g)),rawData:g,cacheControl:y,expires:b})});return()=>{d.cancel(),c()}},t)}class Mx extends Ro{constructor(t,r,s,c){if(super(),this.id=t,this.dispatcher=s,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,_t(this,he(r,["url","scheme","tileSize","promoteId"])),this._options=_t({type:"vector"},r),this._collectResourceTiming=!!r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(c),this._tileWorkers={},this._deduped=new Av}load(t){this._loaded=!1,this.fire(new de("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,s=this.map._worldview;this._tileJSONRequest=xx(this._options,this.map._requestManager,r,s,(c,d)=>{this._tileJSONRequest=null,this._loaded=!0,c?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),s&&2!==s.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${s}`),this.fire(new Cn(c))):d&&(_t(this,d),d.bounds&&(this.tileBounds=new _y(d.bounds,this.minzoom,this.maxzoom)),Re(d.tiles,this.map._requestManager._customAccessToken),this.fire(new de("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new de("data",{dataType:"source",sourceDataType:"content"}))),t&&t(c)})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=sn(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return _t({},this._options)}loadTile(t,r){const s=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),c={request:this.map._requestManager.transformRequest(s,Ft.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:Mn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:t.isExtraShadowCaster};if(c.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state)"loading"===t.state?t.reloadCallback=r:t.request=t.actor.send("reloadTile",c,d.bind(this));else if(t.actor=this._tileWorkers[s]=this._tileWorkers[s]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",c,d.bind(this),void 0,!0);else{const f=zC.call({deduped:this._deduped},c,(g,y)=>{g||!y?d.call(this,g):(c.data={cacheControl:y.cacheControl,expires:y.expires,rawData:y.rawData.slice(0)},t.actor&&t.actor.send("loadTile",c,d.bind(this),void 0,!0))},!0);t.request={cancel:f}}function d(f,g){return delete t.request,t.aborted?r(null):f&&404!==f.status?r(f):(g&&g.resourceTiming&&(t.resourceTiming=g.resourceTiming),this.map._refreshExpiredTiles&&g&&t.setExpiryData(g),t.loadVectorData(g,this.map.painter),ds(this.dispatcher),r(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t){t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope}),t.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Px extends Ro{constructor(t,r,s,c){super(),this.id=t,this.dispatcher=s,this.setEventedParent(c),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=_t({type:"raster"},r),_t(this,he(r,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new de("dataloading",{dataType:"source"})),this._tileJSONRequest=xx(this._options,this.map._requestManager,null,null,(r,s)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new Cn(r)):s&&(_t(this,s),s.bounds&&(this.tileBounds=new _y(s.bounds,this.minzoom,this.maxzoom)),Re(s.tiles),this.fire(new de("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new de("data",{dataType:"source",sourceDataType:"content"}))),t&&t(r)})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=sn(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return _t({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,r){const s=Mn.devicePixelRatio>=2,c=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),s,this.tileSize);t.request=Bt(this.map._requestManager.transformRequest(c,Ft.Tile),(d,f,g,y)=>(delete t.request,t.aborted?(t.state="unloaded",r(null)):d?(t.state="errored",r(d)):f?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:g,expires:y}),t.setTexture(f,this.map.painter),t.state="loaded",ds(this.dispatcher),void r(null)):r(null)))}abortTile(t,r){t.request&&(t.request.cancel(),delete t.request),r()}unloadTile(t,r){t.texture&&t.texture instanceof xo?(t.destroy(!0),t.texture&&t.texture instanceof xo&&this.map.painter.saveTileTexture(t.texture)):t.destroy(),r()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function BC(){return null!=zM.workerClass?new zM.workerClass:new lt.Worker(zM.workerUrl)}const Xp="mapboxgl_preloaded_worker_pool";class yc{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<yc.workerCount;)this.workers.push(new BC);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&0===this.numActive()&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Xp]}numActive(){return Object.keys(this.active).length}}let Qp;function dh(){return Qp||(Qp=new yc),Qp}yc.workerCount=2;let Sf,Ox,za,UC=null;function $O(){return ae()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:Ox||ue.DRACO_URL}const Dv=5123,kv=5126,Af={5120:Int8Array,5121:Uint8Array,5122:Int16Array,[Dv]:Uint16Array,5125:Uint32Array,[kv]:Float32Array},Ex={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",[Dv]:"DT_UINT16",5125:"DT_UINT32",[kv]:"DT_FLOAT32"},Tx={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function VC(e,t,r){const s=r.json.bufferViews.length,c=r.buffers.length;t.bufferView=s,r.json.bufferViews[s]={buffer:c,byteLength:e.byteLength},r.buffers[c]=e}const yy="KHR_draco_mesh_compression";function Ix(e,t){const r=e.extensions&&e.extensions[yy];if(!r)return;const s=new za.Decoder,c=$C(t,r.bufferView),d=new za.Mesh;if(!s.DecodeArrayToMesh(c,c.byteLength,d))throw new Error("Failed to decode Draco mesh");const f=t.json.accessors[e.indices],g=Af[f.componentType],y=f.count*g.BYTES_PER_ELEMENT,b=za._malloc(y);g===Uint16Array?s.GetTrianglesUInt16Array(d,y,b):s.GetTrianglesUInt32Array(d,y,b),VC(za.memory.buffer.slice(b,b+y),f,t),za._free(b);for(const C of Object.keys(r.attributes)){const P=s.GetAttributeByUniqueId(d,r.attributes[C]),E=t.json.accessors[e.attributes[C]],I=Ex[E.componentType],A=E.count*Tx[E.type]*Af[E.componentType].BYTES_PER_ELEMENT,l=za._malloc(A);s.GetAttributeDataArrayForAllPoints(d,P,za[I],A,l),VC(za.memory.buffer.slice(l,l+A),E,t),za._free(l)}s.destroy(),d.destroy(),delete e.extensions[yy]}const GO=1179937895,jC=new TextDecoder("utf8");function XT(e,t){return new URL(e,t).href}function QT(e,t,r,s){return fetch(XT(e.uri,s)).then(c=>c.arrayBuffer()).then(c=>{t.buffers[r]=c})}function $C(e,t){const r=e.json.bufferViews[t];return new Uint8Array(e.buffers[r.buffer],r.byteOffset||0,r.byteLength)}function HO(e,t,r,s){if(e.uri){const c=XT(e.uri,s);return fetch(c).then(d=>d.blob()).then(d=>lt.createImageBitmap(d)).then(d=>{t.images[r]=d})}if(void 0!==e.bufferView){const c=$C(t,e.bufferView),d=new lt.Blob([c],{type:e.mimeType});return lt.createImageBitmap(d).then(f=>{t.images[r]=f})}}function GC(e,t=0,r){const s={json:null,images:[],buffers:[]};if(new Uint32Array(e,t,1)[0]===GO){const b=new Uint32Array(e,t);let C=2;const P=(b[C++]>>2)-3,E=b[C++]>>2;if(C++,s.json=JSON.parse(jC.decode(b.subarray(C,C+E))),C+=E,C<P){const I=b[C++];C++;const A=t+(C<<2);s.buffers[0]=e.slice(A,A+I)}}else s.json=JSON.parse(jC.decode(new Uint8Array(e,t)));const{buffers:c,images:d,meshes:f,extensionsUsed:g}=s.json;let y=Promise.resolve();if(c){const b=[];for(let C=0;C<c.length;C++){const P=c[C];P.uri?b.push(QT(P,s,C,r)):s.buffers[C]||(s.buffers[C]=null)}y=Promise.all(b)}return y.then(()=>{const b=[],C=g&&g.includes(yy);if(C&&b.push(function(){if(!za)return Sf||(Sf=function(P){let E,I=null;function A(){E=new Uint8Array(I.buffer)}function l(){throw new Error("Unexpected Draco error.")}const u={a:{a:l,d:function(p,m,v){return E.copyWithin(p,m,m+v)},c:function(p){const m=E.length,v=Math.max(p>>>0,Math.ceil(1.2*m)),M=Math.ceil((v-m)/65536);try{return I.grow(M),A(),!0}catch{return!1}},b:l}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(P,u):P.then(p=>p.arrayBuffer()).then(p=>WebAssembly.instantiate(p,u))).then(p=>{const{Rb:m,Qb:v,P:M,T:O,X:T,Ja:k,La:N,Qa:F,Va:$,Wa:q,eb:Z,jb:X,f:K,e:J,yb:st,zb:it,Ab:rt,Bb:ct,Db:yt,Gb:Et}=p.instance.exports;I=J;const Tt=(()=>{let zt=0,Nt=0,$t=0,Rt=0;return oe=>{$t&&(m(Rt),m(zt),Nt+=$t,$t=zt=0),zt||(Nt+=128,zt=v(Nt));const Oe=oe.length+7&-8;let Ee=zt;Oe>=Nt&&($t=Oe,Ee=Rt=v(Oe));for(let Be=0;Be<oe.length;Be++)E[Ee+Be]=oe[Be];return Ee}})();return A(),K(),{memory:J,_free:m,_malloc:v,Mesh:class{constructor(){this.ptr=M()}destroy(){O(this.ptr)}},Decoder:class{constructor(){this.ptr=k()}destroy(){X(this.ptr)}DecodeArrayToMesh(zt,Nt,$t){const Rt=Tt(zt),oe=N(this.ptr,Rt,Nt,$t.ptr);return!!T(oe)}GetAttributeByUniqueId(zt,Nt){return{ptr:F(this.ptr,zt.ptr,Nt)}}GetTrianglesUInt16Array(zt,Nt,$t){$(this.ptr,zt.ptr,Nt,$t)}GetTrianglesUInt32Array(zt,Nt,$t){q(this.ptr,zt.ptr,Nt,$t)}GetAttributeDataArrayForAllPoints(zt,Nt,$t,Rt,oe){Z(this.ptr,zt.ptr,Nt.ptr,$t,Rt,oe)}},DT_INT8:st(),DT_UINT8:it(),DT_INT16:rt(),DT_UINT16:ct(),DT_UINT32:yt(),DT_FLOAT32:Et()}})}(fetch($O())),Sf.then(P=>{za=P,Sf=void 0}))}()),d)for(let P=0;P<d.length;P++)b.push(HO(d[P],s,P,r));return(b.length?Promise.all(b):Promise.resolve()).then(()=>{if(C&&f)for(const{primitives:P}of f)for(const E of P)Ix(E,s);return s})})}function qO(e){return fetch(e).then(t=>t.arrayBuffer()).then(t=>GC(t,0,e))}class ZO{constructor(t,r,s){if(this.triangleCount=r.length/3,this.min=new tt(0,0),this.max=new tt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],0===this.triangleCount||0===t.length||0===s)return;const c=t.map(C=>C.x),d=t.map(C=>C.y);this.min=new tt(Math.min(...c),Math.min(...d)),this.max=new tt(Math.max(...c),Math.max(...d));const f=this.max.sub(this.min);f.x=Math.max(f.x,1),f.y=Math.max(f.y,1);const g=Math.max(f.x,f.y)/s;this.cellsX=Math.max(1,Math.ceil(f.x/g)),this.cellsY=Math.max(1,Math.ceil(f.y/g)),this.xScale=1/g,this.yScale=1/g;const y=[];for(let C=0;C<this.triangleCount;C++){const P=t[r[3*C+0]].sub(this.min),E=t[r[3*C+1]].sub(this.min),I=t[r[3*C+2]].sub(this.min),A=Jc(Math.floor(Math.min(P.x,E.x,I.x)),this.xScale,this.cellsX),l=Jc(Math.floor(Math.max(P.x,E.x,I.x)),this.xScale,this.cellsX),u=Jc(Math.floor(Math.min(P.y,E.y,I.y)),this.yScale,this.cellsY),p=Jc(Math.floor(Math.max(P.y,E.y,I.y)),this.yScale,this.cellsY),m=new tt(0,0),v=new tt(0,0),M=new tt(0,0),O=new tt(0,0);for(let T=u;T<=p;++T){m.y=v.y=T*g,M.y=O.y=(T+1)*g;for(let k=A;k<=l;++k)m.x=M.x=k*g,v.x=O.x=(k+1)*g,(C0(P,E,I,m,v,O)||C0(P,E,I,m,O,M))&&y.push({cellIdx:T*this.cellsX+k,triIdx:C})}}if(0===y.length)return;y.sort((C,P)=>C.cellIdx-P.cellIdx||C.triIdx-P.triIdx);let b=0;for(;b<y.length;){const C=y[b].cellIdx,P={start:this.payload.length,len:0};for(;b<y.length&&y[b].cellIdx===C;)++P.len,this.payload.push(y[b++].triIdx);this.cells[C]=P}}query(t,r,s){if(0===this.triangleCount||0===this.cells.length||t.x>this.max.x||this.min.x>r.x||t.y>this.max.y||this.min.y>r.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let y=0;y<this.lookup.length;y++)this.lookup[y]=0;const c=Jc(t.x-this.min.x,this.xScale,this.cellsX),d=Jc(r.x-this.min.x,this.xScale,this.cellsX),f=Jc(t.y-this.min.y,this.yScale,this.cellsY),g=Jc(r.y-this.min.y,this.yScale,this.cellsY);for(let y=f;y<=g;y++)for(let b=c;b<=d;b++){const C=this.cells[y*this.cellsX+b];if(C)for(let P=0;P<C.len;P++){const E=this.payload[C.start+P],I=Math.floor(E/8),A=1<<E%8;if(!(this.lookup[I]&A)&&(this.lookup[I]|=A,s.push(E),s.length===this.triangleCount))return}}}}function Jc(e,t,r){return Math.max(0,Math.min(r-1,Math.floor(e*t)))}function vm(e,t){const r=e.json.bufferViews[t.bufferView];return new Af[t.componentType](e.buffers[r.buffer],(t.byteOffset||0)+(r.byteOffset||0),t.count*Tx[t.type])}function Rv(e,t,r){const s=e.indices,c=e.attributes,d={};d.indexArray=new Mi;const f=t.json.accessors[s],g=f.count/3;d.indexArray.reserve(g);const y=vm(t,f);for(let E=0;E<g;E++)d.indexArray.emplaceBack(y[3*E],y[3*E+1],y[3*E+2]);d.indexArray._trim(),d.vertexArray=new Jy;const b=t.json.accessors[c.POSITION];d.vertexArray.reserve(b.count);const C=vm(t,b);for(let E=0;E<b.count;E++)d.vertexArray.emplaceBack(C[3*E],C[3*E+1],C[3*E+2]);if(d.vertexArray._trim(),d.aabb=new yo(b.min,b.max),d.centroid=function(E,I){const A=[0,0,0],l=E.length;if(l>0){for(let u=0;u<l;u++){const p=3*E[u];A[0]+=I[p],A[1]+=I[p+1],A[2]+=I[p+2]}A[0]/=l,A[1]/=l,A[2]/=l}return A}(y,C),void 0!==c.COLOR_0){const E=t.json.accessors[c.COLOR_0],I=Tx[E.type];if(E.componentType===kv){d.colorArray=3===I?new Jy:new ku,d.colorArray.reserve(E.count);const A=vm(t,E);if(3===I)for(let l=0;l<E.count;l++)d.colorArray.emplaceBack(A[3*l],A[3*l+1],A[3*l+2]);else for(let l=0;l<E.count;l++)d.colorArray.emplaceBack(A[4*l],A[4*l+1],A[4*l+2],A[4*l+3]);d.colorArray._trim()}else if(E.componentType===Dv&&4===I){d.colorArray=new ku,d.colorArray.resize(E.count);const A=vm(t,E),l=1/65535,u=d.colorArray.float32;for(let p=0;p<4*A.length;++p)u[p]=A[p]*l}else gt(`glTF color buffer parsing for accessor ${JSON.stringify(E)} is not supported`)}if(void 0!==c.NORMAL){d.normalArray=new Jy;const E=t.json.accessors[c.NORMAL];d.normalArray.reserve(E.count);const I=vm(t,E);for(let A=0;A<E.count;A++)d.normalArray.emplaceBack(I[3*A],I[3*A+1],I[3*A+2]);d.normalArray._trim()}if(void 0!==c.TEXCOORD_0&&r.length>0){d.texcoordArray=new yw;const E=t.json.accessors[c.TEXCOORD_0];d.texcoordArray.reserve(E.count);const I=vm(t,E);for(let A=0;A<E.count;A++)d.texcoordArray.emplaceBack(I[2*A],I[2*A+1]);d.texcoordArray._trim()}const P=e.material;return d.material=function(E,I){const{emissiveFactor:A=[0,0,0],alphaMode:l="OPAQUE",alphaCutoff:u=.5,normalTexture:p,occlusionTexture:m,emissiveTexture:v,doubleSided:M}=E,{baseColorFactor:O=[1,1,1,1],metallicFactor:T=1,roughnessFactor:k=1,baseColorTexture:N,metallicRoughnessTexture:F}=E.pbrMetallicRoughness||{};return{pbrMetallicRoughness:{baseColorFactor:new bn(...O),metallicFactor:T,roughnessFactor:k,baseColorTexture:N?I[N.index]:void 0,metallicRoughnessTexture:F?I[F.index]:void 0},doubleSided:M,emissiveFactor:A,alphaMode:l,alphaCutoff:u,normalTexture:p?I[p.index]:void 0,occlusionTexture:m?I[m.index]:void 0,emissionTexture:v?I[v.index]:void 0,defined:void 0===E.defined}}(void 0!==P?t.json.materials[P]:{defined:!1},r),void 0!==c._FEATURE_RGBA4444&&(d.featureData=new Uint32Array(vm(t,t.json.accessors[c._FEATURE_RGBA4444]).buffer)),d}function Sx(e,t,r){const{matrix:s,rotation:c,translation:d,scale:f,mesh:g,extras:y,children:b}=e,C={};if(C.matrix=s||bt.fromRotationTranslationScale([],c||[0,0,0,1],d||[0,0,0],f||[1,1,1]),void 0!==g){C.meshes=r[g];const P=C.anchor=[0,0];for(const E of C.meshes){const{min:I,max:A}=E.aabb;P[0]+=I[0]+A[0],P[1]+=I[1]+A[1]}P[0]=Math.floor(P[0]/C.meshes.length/2),P[1]=Math.floor(P[1]/C.meshes.length/2)}if(y&&(y.id&&(C.id=y.id),y.lights&&(C.lights=function(P){if(!P.length)return[];const E=function(p){const m=atob(p),v=new Uint8Array(m.length);for(let M=0;M<m.length;M++)v[M]=m.codePointAt(M);return v}(P),I=[],A=E.length/24,l=new Uint16Array(E.buffer),u=new Float32Array(E.buffer);for(let p=0;p<A;p++){const m=l[2*p*6]/30,v=l[2*p*6+1]/30,M=l[2*p*6+10]/100,O=u[6*p+1],T=u[6*p+2],k=u[6*p+3],N=u[6*p+4],F=k-O,$=N-T,q=Math.hypot(F,$);I.push({pos:[O+.5*F,T+.5*$,v],normal:[$/q,-F/q,0],width:q,height:m,depth:M,points:[O,T,k,N]})}return I}(y.lights))),b){const P=[];for(const E of b)P.push(Sx(t.json.nodes[E],t,r));C.children=P}return C}function WO(e){if(0===e.vertices.length||0===e.indices.length)return null;const[t,r]=[e.vertices[0].clone(),e.vertices[0].clone()];for(let f=1;f<e.vertices.length;++f){const g=e.vertices[f];t.x=Math.min(t.x,g.x),t.y=Math.min(t.y,g.y),r.x=Math.max(r.x,g.x),r.y=Math.max(r.y,g.y)}const s=Math.ceil(Math.max(r.x-t.x,r.y-t.y)/256),c=Math.max(8,s),d=new ZO(e.vertices,e.indices,c);return{vertices:e.vertices,indices:e.indices,grid:d,min:t,max:r}}function JT(e){if(!e.extras||!e.extras.ground)return null;const t=e.extras.ground;if(!t||!Array.isArray(t)||0===t.length)return null;const r=t[0];if(!r||!Array.isArray(r)||0===r.length)return null;const s=[];for(const f of r){if(!Array.isArray(f)||2!==f.length)continue;const g=f[0],y=f[1];"number"==typeof g&&"number"==typeof y&&s.push(new tt(g,y))}if(s.length<3)return null;s.length>1&&s[s.length-1].equals(s[0])&&s.pop();let c=0;for(let f=0;f<s.length;f++){const g=s[f],y=s[(f+1)%s.length],b=s[(f+2)%s.length];c+=(g.x-y.x)*(b.y-y.y)-(b.x-y.x)*(g.y-y.y)}c>0&&s.reverse();const d=O0(s.flatMap(f=>[f.x,f.y]),[]);return 0===d.length?null:{vertices:s,indices:d}}function KO(e){const t=[],r=[];let s=0;for(const c of e){s=t.length;const d=c.vertexArray.float32,f=c.indexArray.uint16;for(let g=0;g<c.vertexArray.length;g++)t.push(new tt(d[3*g+0],d[3*g+1]));for(let g=0;g<3*c.indexArray.length;g++)r.push(f[g]+s)}if(r.length%3!=0)return null;for(let c=0;c<r.length;c+=3){const d=t[r[c+0]],f=t[r[c+1]],g=t[r[c+2]];(d.x-f.x)*(g.y-f.y)-(g.x-f.x)*(d.y-f.y)>0&&([r[c+1],r[c+2]]=[r[c+2],r[c+1]])}return{vertices:t,indices:r}}function bm(e){const r=function(y,b){const C=[];for(const P of y.json.meshes){const E=[];for(const I of P.primitives)E.push(Rv(I,y,b));C.push(E)}return C}(e,function(y,b){const C=[],P=lt.WebGL2RenderingContext;if(y.json.textures)for(const E of y.json.textures){const I={magFilter:P.LINEAR,minFilter:P.NEAREST,wrapS:P.REPEAT,wrapT:P.REPEAT};void 0!==E.sampler&&Object.assign(I,y.json.samplers[E.sampler]),C.push({image:b[E.source],sampler:I,uploaded:!1})}return C}(e,e.images)),{scenes:s,scene:c,nodes:d}=e.json,f=s?s[c||0].nodes:d,g=[];for(const y of f)g.push(Sx(d[y],e,r));return function(y,b,C){const P={},E=new Set;for(let I=0;I<y.length;I++){const A=C[b[I]];if(!A.extras)continue;const l=A.extras["mapbox:footprint:version"],u=A.extras["mapbox:footprint:id"];(l||u)&&E.add(I),"1.0.0"===l&&u&&(P[u]=I)}for(let I=0;I<y.length;I++){if(E.has(I))continue;const A=y[I],l=C[b[I]];if(!l.extras)continue;let u=null;A.id in P&&(u=KO(y[P[A.id]].meshes)),u||(u=JT(l)),u&&(A.footprint=WO(u))}if(E.size>0){const I=Array.from(E.values()).sort((A,l)=>A-l);for(let A=I.length-1;A>=0;A--)y.splice(I[A],1)}}(g,f,e.json.nodes),g}function HC(e){e.heightmap=new Float32Array(4096),e.heightmap.fill(-1);const t=e.vertexArray.float32,r=e.aabb.min[0]-1,s=e.aabb.min[1]-1,c=64/(e.aabb.max[0]-r+2),d=64/(e.aabb.max[1]-s+2);for(let f=0;f<t.length;f+=3){const g=t[f+2],y=(t[f+0]-r)*c|0,b=(t[f+1]-s)*d|0;g>e.heightmap[64*b+y]&&(e.heightmap[64*b+y]=g)}}function YO(e,t){const r={};r.indexArray=new Mi,r.indexArray.reserve(4*e.length),r.vertexArray=new Jy,r.vertexArray.reserve(10*e.length),r.colorArray=new ku,r.vertexArray.reserve(10*e.length);let s=0;for(const f of e){const g=Math.min(10,Math.max(4,1.3*f.height))*t,y=[-f.normal[1],f.normal[0],0],b=Math.min(.29,.1*f.width/f.depth),C=f.width-2*f.depth*t*(b+.01),P=dt.scaleAndAdd([],f.pos,y,C/2),E=dt.scaleAndAdd([],f.pos,y,-C/2),I=[P[0],P[1],P[2]+f.height],A=[E[0],E[1],E[2]+f.height],l=dt.scaleAndAdd([],f.normal,y,b);dt.scale(l,l,g);const u=dt.scaleAndAdd([],f.normal,y,-b);dt.scale(u,u,g),dt.add(l,P,l),dt.add(u,E,u),P[2]+=.1,E[2]+=.1,r.vertexArray.emplaceBack(l[0],l[1],l[2]),r.vertexArray.emplaceBack(u[0],u[1],u[2]),r.vertexArray.emplaceBack(P[0],P[1],P[2]),r.vertexArray.emplaceBack(E[0],E[1],E[2]),r.vertexArray.emplaceBack(I[0],I[1],I[2]),r.vertexArray.emplaceBack(A[0],A[1],A[2]),r.vertexArray.emplaceBack(P[0],P[1],P[2]),r.vertexArray.emplaceBack(E[0],E[1],E[2]),r.vertexArray.emplaceBack(l[0],l[1],l[2]),r.vertexArray.emplaceBack(u[0],u[1],u[2]);const p=C/g/2;r.colorArray.emplaceBack(-p-b,-1,p,.8),r.colorArray.emplaceBack(p+b,-1,p,.8),r.colorArray.emplaceBack(-p,0,p,1.3),r.colorArray.emplaceBack(p,0,p,1.3),r.colorArray.emplaceBack(p+b,-.8,p,.7),r.colorArray.emplaceBack(p+b,-.8,p,.7),r.colorArray.emplaceBack(0,0,p,1.3),r.colorArray.emplaceBack(0,0,p,1.3),r.colorArray.emplaceBack(p+b,-1.2,p,.8),r.colorArray.emplaceBack(p+b,-1.2,p,.8),r.indexArray.emplaceBack(6+s,4+s,8+s),r.indexArray.emplaceBack(7+s,9+s,5+s),r.indexArray.emplaceBack(0+s,1+s,2+s),r.indexArray.emplaceBack(1+s,3+s,2+s),s+=10}const c={defined:!0,emissiveFactor:[0,0,0]},d={};return d.baseColorFactor=bn.white,c.pbrMetallicRoughness=d,r.material=c,r.aabb=new yo([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),r}De(ZO,"TriangleGridIndex");const Lv={vector:Mx,raster:Px,"raster-dem":class extends Px{constructor(e,t,r,s){super(e,t,r,s),this.type="raster-dem",this.maxzoom=22,this._options=_t({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(e,t){const r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function s(c,d){c&&(e.state="errored",t(c)),d&&(e.dem=d,e.dem.onDeserialize(),e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0,e.state="loaded",t(null))}e.request=Bt(this.map._requestManager.transformRequest(r,Ft.Tile),function(c,d,f,g){if(delete e.request,e.aborted)e.state="unloaded",t(null);else if(c)e.state="errored",t(c);else if(d){this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:f,expires:g});const b=lt.ImageBitmap&&d instanceof lt.ImageBitmap&&hd(),C=1-(d.width-((y=d.width)<=1?1:Math.pow(2,Math.floor(Math.log(y)/Math.LN2))))/2;C<1||e.neighboringTiles||(e.neighboringTiles=this._getNeighboringTiles(e.tileID));const P=b?d:Mn.getImageData(d,C),E={uid:e.uid,coord:e.tileID,source:this.id,scope:this.scope,rawImageData:P,encoding:this.encoding,padding:C};e.actor&&"expired"!==e.state||(e.actor=this.dispatcher.getActor(),e.actor.send("loadDEMTile",E,s.bind(this),void 0,!0))}var y}.bind(this))}_getNeighboringTiles(e){const t=e.canonical,r=Math.pow(2,t.z),s=(t.x-1+r)%r,c=0===t.x?e.wrap-1:e.wrap,d=(t.x+1+r)%r,f=t.x+1===r?e.wrap+1:e.wrap,g={};return g[new Ir(e.overscaledZ,c,t.z,s,t.y).key]={backfilled:!1},g[new Ir(e.overscaledZ,f,t.z,d,t.y).key]={backfilled:!1},t.y>0&&(g[new Ir(e.overscaledZ,c,t.z,s,t.y-1).key]={backfilled:!1},g[new Ir(e.overscaledZ,e.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},g[new Ir(e.overscaledZ,f,t.z,d,t.y-1).key]={backfilled:!1}),t.y+1<r&&(g[new Ir(e.overscaledZ,c,t.z,s,t.y+1).key]={backfilled:!1},g[new Ir(e.overscaledZ,e.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},g[new Ir(e.overscaledZ,f,t.z,d,t.y+1).key]={backfilled:!1}),g}},geojson:class extends Ro{constructor(e,t,r,s){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(s),this._data=t.data,this._options=_t({},t),this._collectResourceTiming=t.collectResourceTiming,void 0!==t.maxzoom&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const c=Dt/this.tileSize;this.workerOptions=_t({source:this.id,scope:this.scope,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(void 0!==t.buffer?t.buffer:128)*c,tolerance:(void 0!==t.tolerance?t.tolerance:.375)*c,extent:Dt,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:void 0!==t.clusterMaxZoom?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:Dt,radius:(void 0!==t.clusterRadius?t.clusterRadius:50)*c,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(e){this.map=e,this.setData(this._data)}setData(e){return this._data=e,this._updateWorkerData(),this}getClusterExpansionZoom(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id,scope:this.scope},t),this}getClusterChildren(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id,scope:this.scope},t),this}getClusterLeaves(e,t,r,s){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:e,limit:t,offset:r},s),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new de("dataloading",{dataType:"source"})),this._loaded=!1;const e=_t({},this.workerOptions);e.scope=this.scope;const t=this._data;"string"==typeof t?(e.request=this.map._requestManager.transformRequest(Mn.resolveURL(t),Ft.Source),e.request.collectResourceTiming=this._collectResourceTiming):e.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,e,(r,s)=>{if(this._loaded=!0,this._pendingLoad=null,r)this.fire(new Cn(r));else{const c={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&s&&s.resourceTiming&&s.resourceTiming[this.id]&&(c.resourceTiming=s.resourceTiming[this.id]),this.fire(new de("data",c)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(e,t){const r=e.actor?"reloadTile":"loadTile";e.actor=this.actor;const s={type:this.type,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:Mn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};e.request=this.actor.send(r,s,(c,d)=>(delete e.request,e.destroy(),e.aborted?t(null):c?t(c):(e.loadVectorData(d,this.map.painter,"reloadTile"===r),t(null))),void 0,"loadTile"===r)}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}unloadTile(e){this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope}),e.destroy()}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return _t({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Qc{constructor(e,t,r,s){super(e,t,r,s),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const e=this.options;this.urls=[];for(const t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,Ft.Source).url);!function(t,r){const s=lt.document.createElement("video");s.muted=!0,s.onloadstart=function(){r(null,s)};for(let c=0;c<t.length;c++){const d=lt.document.createElement("source");xe(t[c])||(s.crossOrigin="Anonymous"),d.src=t[c],s.appendChild(d)}}(this.urls,(t,r)=>{this._loaded=!0,t?this.fire(new Cn(t)):r&&(this.video=r,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const t=this.video.seekable;e<t.start(0)||e>t.end(0)?this.fire(new Cn(new Fe(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,t=e.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new xo(e,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(e)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Qc,model:class extends Ro{constructor(e,t,r,s){super(),this.id=e,this.type="model",this.models=[],this._loaded=!1,this._options=t}load(){const e=[];for(const t in this._options.models){const r=this._options.models[t],s=qO(this.map._requestManager.transformRequest(r.uri,Ft.Model).url).then(c=>{if(!c)return;const d=bm(c),f=new pl(t,r.position,r.orientation,d);f.computeBoundsAndApplyParent(),this.models.push(f)}).catch(c=>{this.fire(new Cn(new Error(`Could not load model ${t} from ${r.uri}: ${c.message}`)))});e.push(s)}return Promise.allSettled(e).then(()=>{this._loaded=!0,this.fire(new de("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(t=>{this.fire(new Cn(new Error(`Could not load models: ${t.message}`)))})}onAdd(e){this.map=e,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(e,t){}serialize(){return{type:"model"}}},"batched-model":class extends Ro{constructor(e,t,r,s){super(),this.type="batched-model",this.id=e,this.tileSize=512,this._options=t,this.tiles=this._options.tiles,this.maxzoom=t.maxzoom||19,this.minzoom=t.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=r,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(s)}onAdd(e){this.map=e,this.load()}load(e){this._loaded=!1,this.fire(new de("dataloading",{dataType:"source"}));const t=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map._worldview;this._tileJSONRequest=xx(this._options,this.map._requestManager,t,r,(s,c)=>{this._tileJSONRequest=null,this._loaded=!0,s?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${t}`),r&&2!==r.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${r}`),this.fire(new Cn(s))):c&&(_t(this,c),c.bounds&&(this.tileBounds=new _y(c.bounds,this.minzoom,this.maxzoom)),Re(c.tiles,this.map._requestManager._customAccessToken),this.fire(new de("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new de("data",{dataType:"source",sourceDataType:"content"}))),e&&e(s)})}hasTransition(){return!1}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loaded(){return this._loaded}loadTile(e,t){const r=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),s={request:this.map._requestManager.transformRequest(r,Ft.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:e.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(e.actor&&"expired"!==e.state)if("loading"===e.state)e.reloadCallback=t;else{if(e.buckets){const d=Object.values(e.buckets);for(const f of d)f.dirty=!0;return void(e.state="loaded")}e.request=e.actor.send("reloadTile",s,c.bind(this))}else e.actor=this.dispatcher.getActor(),e.request=e.actor.send("loadTile",s,c.bind(this),void 0,!0);function c(d,f){return e.aborted?t(null):d&&404!==d.status?t(d):(f&&(f.resourceTiming&&(e.resourceTiming=f.resourceTiming),this.map._refreshExpiredTiles&&e.setExpiryData(f),e.buckets={...e.buckets,...f.buckets}),e.state="loaded",void t(null))}}serialize(){return _t({},this._options)}},canvas:class extends Qc{constructor(e,t,r,s){super(e,t,r,s),t.coordinates?Array.isArray(t.coordinates)&&4===t.coordinates.length&&!t.coordinates.some(c=>!Array.isArray(c)||2!==c.length||c.some(d=>"number"!=typeof d))||this.fire(new Cn(new Fe(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new Cn(new Fe(`sources.${e}`,null,'missing required property "coordinates"'))),t.animate&&"boolean"!=typeof t.animate&&this.fire(new Cn(new Fe(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),t.canvas?"string"==typeof t.canvas||t.canvas instanceof lt.HTMLCanvasElement||this.fire(new Cn(new Fe(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new Cn(new Fe(`sources.${e}`,null,'missing required property "canvas"'))),this.options=t,this.animate=void 0===t.animate||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof lt.HTMLCanvasElement?this.options.canvas:lt.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new Cn(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const t=this.map.painter.context;this.texture?!e&&!this._playing||this.texture instanceof pc||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new xo(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}},custom:class extends Ro{constructor(e,t,r,s){super(),this.id=e,this.type="custom",this._dataType="raster",this._dispatcher=r,this._implementation=t,this.setEventedParent(s),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new Cn(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new Cn(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new _y(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.clearTiles=this._clearTiles.bind(this),t.coveringTiles=this._coveringTiles.bind(this),_t(this,he(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return he(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new de("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new de("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(e){this._map=e,this._loaded=!1,this.fire(new de("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(e),this.load()}onRemove(e){this._implementation.onRemove&&this._implementation.onRemove(e)}hasTile(e){if(this._implementation.hasTile){const{x:t,y:r,z:s}=e.canonical;return this._implementation.hasTile({x:t,y:r,z:s})}return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e,t){const{x:r,y:s,z:c}=e.tileID.canonical,d=new lt.AbortController;e.request=Promise.resolve(this._implementation.loadTile({x:r,y:s,z:c},{signal:d.signal})).then(function(f){return delete e.request,e.aborted?(e.state="unloaded",t(null)):void 0===f?(e.state="errored",t(null)):null===f?(this.loadTileData(e,{width:this.tileSize,height:this.tileSize,data:null}),e.state="loaded",t(null)):(g=f)instanceof lt.ImageData||g instanceof lt.HTMLCanvasElement||g instanceof lt.ImageBitmap||g instanceof lt.HTMLImageElement?(this.loadTileData(e,f),e.state="loaded",void t(null)):(e.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var g}.bind(this)).catch(f=>{20!==f.code&&(e.state="errored",t(f))}),e.request.cancel=()=>d.abort()}loadTileData(e,t){e.setTexture(t,this._map.painter)}unloadTile(e,t){if(e.texture&&e.texture instanceof xo?(e.destroy(!0),e.texture&&e.texture instanceof xo&&this._map.painter.saveTileTexture(e.texture)):e.destroy(),this._implementation.unloadTile){const{x:r,y:s,z:c}=e.tileID.canonical;this._implementation.unloadTile({x:r,y:s,z:c})}t()}abortTile(e,t){e.request&&e.request.cancel&&(e.request.cancel(),delete e.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(e=>({x:e.canonical.x,y:e.canonical.y,z:e.canonical.z}))}_clearTiles(){const e=sn(this.id,this.scope);this._map.style.clearSource(e)}_update(){this.fire(new de("data",{dataType:"source",sourceDataType:"content"}))}}},xm=function(e,t,r,s){const c=new Lv[t.type](e,t,r,s);if(c.id!==e)throw new Error(`Expected Source id to be ${e} instead of ${c.id}`);return Tn(["load","abort","unload","serialize","prepare"],c),c};function XO(e,t){const r=bt.identity([]);return bt.scale(r,r,[.5*e.width,.5*-e.height,1]),bt.translate(r,r,[1,-1,0]),bt.multiply(r,r,e.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(r)}function qC(e,t,r,s,c,d,f,g=!1){const y=e.tilesIn(s,f,g);y.sort(wm);const b=[];for(const P of y)b.push({wrappedTileID:P.tile.tileID.wrapped().key,queryResults:P.tile.queryRenderedFeatures(t,r,e._state,P,c,d,XO(e.transform,P.tile.tileID),g)});const C=function(P){const E={},I={};for(const A of P){const l=A.queryResults,u=A.wrappedTileID,p=I[u]=I[u]||{};for(const m in l){const v=l[m],M=p[m]=p[m]||{},O=E[m]=E[m]||[];for(const T of v)M[T.featureIndex]||(M[T.featureIndex]=!0,O.push(T))}}return E}(b);for(const P in C)C[P].forEach(E=>{const I=E.feature,A=I.layer;A&&"background"!==A.type&&"sky"!==A.type&&"slot"!==A.type&&(I.source=A.source,A["source-layer"]&&(I.sourceLayer=A["source-layer"]),I.state=void 0!==I.id?e.getFeatureState(A["source-layer"],I.id):{})});return C}function QO(e,t){const r=e.getRenderableIds().map(d=>e.getTileByID(d)),s=[],c={};for(let d=0;d<r.length;d++){const f=r[d],g=f.tileID.canonical.key;c[g]||(c[g]=!0,f.querySourceFeatures(s,t))}return s}function wm(e,t){const r=e.tileID,s=t.tileID;return r.overscaledZ-s.overscaledZ||r.canonical.y-s.canonical.y||r.wrap-s.wrap||r.canonical.x-s.canonical.x}class t2{constructor(t){this.style=t}processLayersChanged(){this.layers=[];for(const t in this.style._mergedLayers){const r=this.style._mergedLayers[t];if("fill-extrusion"===r.type)this.layers.push(r);else if("model"===r.type){const s=this.style.getLayerSource(r);s&&"batched-model"===s.type&&this.layers.push(r)}}}updateZOffset(t,r){this.currentBuildingBuckets=[];for(let c=0;c<this.layers.length;++c){const d=this.layers[c],f=this.style.getLayerSourceCache(d);let g=1;"fill-extrusion"===d.type&&(g=d.paint.get("fill-extrusion-opacity")>0?d.paint.get("fill-extrusion-vertical-scale"):0);let y=f?f.getTile(r):null;if(!y&&f&&r.canonical.z>f.getSource().minzoom){let b=r.scaledTo(Math.min(f.getSource().maxzoom,r.overscaledZ-1));for(;b.overscaledZ>=f.getSource().minzoom&&(y=f.getTile(b),!y&&0!==b.overscaledZ);)b=b.scaledTo(b.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:y?y.getBucket(d):null,tileID:y?y.tileID:r,verticalScale:g})}t.hasAnyZOffset=!1;let s=!1;for(let c=0;c<t.symbolInstances.length;c++){const d=t.symbolInstances.get(c),f=d.zOffset,g=this._getHeightAtTileOffset(r,d.tileAnchorX,d.tileAnchorY);d.zOffset=-1!==g?g:f,s||f===d.zOffset||(s=!0),t.hasAnyZOffset||0===d.zOffset||(t.hasAnyZOffset=!0)}s&&(t.zOffsetBuffersNeedUpload=!0,t.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(t,r,s,c){let d=r,f=s;if(t.canonical.z!==c.canonical.z){const g=c.canonical,y=1/(1<<t.canonical.z-g.z);d=(r+t.canonical.x*Dt)*y-g.x*Dt|0,f=(s+t.canonical.y*Dt)*y-g.y*Dt|0}return{tileX:d,tileY:f}}_getHeightAtTileOffset(t,r,s){let c;for(let d=0;d<this.layers.length;++d){if("fill-extrusion"!==this.layers[d].type)continue;const{bucket:f,tileID:g,verticalScale:y}=this.currentBuildingBuckets[d];if(!f)continue;const{tileX:b,tileY:C}=this._mapCoordToOverlappingTile(t,r,s,g),P=f.getHeightAtTileCoord(b,C);if(P&&void 0!==P.height){if(!P.hidden)return P.height*y;c=P.height}}for(let d=0;d<this.layers.length;++d){if("model"!==this.layers[d].type)continue;const{bucket:f,tileID:g}=this.currentBuildingBuckets[d];if(!f)continue;const{tileX:y,tileY:b}=this._mapCoordToOverlappingTile(t,r,s,g),C=f.getHeightAtTileCoord(y,b);if(C&&!C.hidden)return void 0===C.height&&void 0!==c?Math.min(C.maxHeight,c)*C.verticalScale:(C.height||0)*C.verticalScale}return-1}}var Ax=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function JO(e,t){const r={};for(const s in e)"ref"!==s&&(r[s]=e[s]);return Ax.forEach(s=>{s in t&&(r[s]=t[s])}),r}function Dx(e){e=e.slice();const t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=JO(e[r],t[e[r].ref]));return e}const Vr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",setImportUrl:"setImportUrl",setImportData:"setImportData",setImportConfig:"setImportConfig"};function Nv(e,t,r){r.push({command:Vr.addSource,args:[e,t[e]]})}function hh(e,t,r){t.push({command:Vr.removeSource,args:[e]}),r[e]=!0}function tE(e,t,r,s){hh(e,r,s),Nv(e,t,r)}function ZC(e,t,r){let s;for(s in e[r])if(e[r].hasOwnProperty(s)&&"data"!==s&&!Xt(e[r][s],t[r][s]))return!1;for(s in t[r])if(t[r].hasOwnProperty(s)&&"data"!==s&&!Xt(e[r][s],t[r][s]))return!1;return!0}function Fv(e,t,r,s,c,d){let f;for(f in t=t||{},e=e||{})e.hasOwnProperty(f)&&(Xt(e[f],t[f])||r.push({command:d,args:[s,f,t[f],c]}));for(f in t)t.hasOwnProperty(f)&&!e.hasOwnProperty(f)&&(Xt(e[f],t[f])||r.push({command:d,args:[s,f,t[f],c]}))}function Cm(e){return e.id}function Rl(e,t){return e[t.id]=t,e}class kx{constructor(t,r){this.reset(t,r)}reset(t,r){this.points=t||[],this._distances=[0];for(let s=1;s<this.points.length;s++)this._distances[s]=this._distances[s-1]+this.points[s].dist(this.points[s-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=Ne(t,0,1);let r=1,s=this._distances[r];const c=t*this.paddedLength+this.padding;for(;s<c&&r<this._distances.length;)s=this._distances[++r];const d=r-1,f=this._distances[d],g=s-f,y=g>0?(c-f)/g:0;return this.points[d].mult(1-y).add(this.points[r].mult(y))}}class eE{constructor(t,r,s){const c=this.boxCells=[],d=this.circleCells=[];this.xCellCount=Math.ceil(t/s),this.yCellCount=Math.ceil(r/s);for(let f=0;f<this.xCellCount*this.yCellCount;f++)c.push([]),d.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=r,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,r,s,c,d){this._forEachCell(r,s,c,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(d)}insertCircle(t,r,s,c){this._forEachCell(r-c,s-c,r+c,s+c,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(r),this.circles.push(s),this.circles.push(c)}_insertBoxCell(t,r,s,c,d,f){this.boxCells[d].push(f)}_insertCircleCell(t,r,s,c,d,f){this.circleCells[d].push(f)}_query(t,r,s,c,d,f){if(s<0||t>this.width||c<0||r>this.height)return!d&&[];const g=[];if(t<=0&&r<=0&&this.width<=s&&this.height<=c){if(d)return!0;for(let y=0;y<this.boxKeys.length;y++)g.push({key:this.boxKeys[y],x1:this.bboxes[4*y],y1:this.bboxes[4*y+1],x2:this.bboxes[4*y+2],y2:this.bboxes[4*y+3]});for(let y=0;y<this.circleKeys.length;y++){const b=this.circles[3*y],C=this.circles[3*y+1],P=this.circles[3*y+2];g.push({key:this.circleKeys[y],x1:b-P,y1:C-P,x2:b+P,y2:C+P})}return f?g.filter(f):g}return this._forEachCell(t,r,s,c,this._queryCell,g,{hitTest:d,seenUids:{box:{},circle:{}}},f),d?g.length>0:g}_queryCircle(t,r,s,c,d){const f=t-s,g=t+s,y=r-s,b=r+s;if(g<0||f>this.width||b<0||y>this.height)return!c&&[];const C=[];return this._forEachCell(f,y,g,b,this._queryCellCircle,C,{hitTest:c,circle:{x:t,y:r,radius:s},seenUids:{box:{},circle:{}}},d),c?C.length>0:C}query(t,r,s,c,d){return this._query(t,r,s,c,!1,d)}hitTest(t,r,s,c,d){return this._query(t,r,s,c,!0,d)}hitTestCircle(t,r,s,c){return this._queryCircle(t,r,s,!0,c)}_queryCell(t,r,s,c,d,f,g,y){const b=g.seenUids,C=this.boxCells[d];if(null!==C){const E=this.bboxes;for(const I of C)if(!b.box[I]){b.box[I]=!0;const A=4*I;if(t<=E[A+2]&&r<=E[A+3]&&s>=E[A+0]&&c>=E[A+1]&&(!y||y(this.boxKeys[I]))){if(g.hitTest)return f.push(!0),!0;f.push({key:this.boxKeys[I],x1:E[A],y1:E[A+1],x2:E[A+2],y2:E[A+3]})}}}const P=this.circleCells[d];if(null!==P){const E=this.circles;for(const I of P)if(!b.circle[I]){b.circle[I]=!0;const A=3*I;if(this._circleAndRectCollide(E[A],E[A+1],E[A+2],t,r,s,c)&&(!y||y(this.circleKeys[I]))){if(g.hitTest)return f.push(!0),!0;{const l=E[A],u=E[A+1],p=E[A+2];f.push({key:this.circleKeys[I],x1:l-p,y1:u-p,x2:l+p,y2:u+p})}}}}}_queryCellCircle(t,r,s,c,d,f,g,y){const b=g.circle,C=g.seenUids,P=this.boxCells[d];if(null!==P){const I=this.bboxes;for(const A of P)if(!C.box[A]){C.box[A]=!0;const l=4*A;if(this._circleAndRectCollide(b.x,b.y,b.radius,I[l+0],I[l+1],I[l+2],I[l+3])&&(!y||y(this.boxKeys[A])))return f.push(!0),!0}}const E=this.circleCells[d];if(null!==E){const I=this.circles;for(const A of E)if(!C.circle[A]){C.circle[A]=!0;const l=3*A;if(this._circlesCollide(I[l],I[l+1],I[l+2],b.x,b.y,b.radius)&&(!y||y(this.circleKeys[A])))return f.push(!0),!0}}}_forEachCell(t,r,s,c,d,f,g,y){const b=this._convertToXCellCoord(t),C=this._convertToYCellCoord(r),P=this._convertToXCellCoord(s),E=this._convertToYCellCoord(c);for(let I=b;I<=P;I++)for(let A=C;A<=E;A++)if(d.call(this,t,r,s,c,this.xCellCount*A+I,f,g,y))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,r,s,c,d,f){const g=c-t,y=d-r,b=s+f;return b*b>g*g+y*y}_circleAndRectCollide(t,r,s,c,d,f,g){const y=(f-c)/2,b=Math.abs(t-(c+y));if(b>y+s)return!1;const C=(g-d)/2,P=Math.abs(r-(d+C));if(P>C+s)return!1;if(b<=y||P<=C)return!0;const E=b-y,I=P-C;return E*E+I*I<=s*s}}const vc=100;class nE{constructor(t,r,s=new eE(t.width+200,t.height+200,25),c=new eE(t.width+200,t.height+200,25)){this.transform=t,this.grid=s,this.ignoredGrid=c,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+vc,this.screenBottomBoundary=t.height+vc,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=r}placeCollisionBox(t,r,s,c,d,f,g,y){let b=s.projectedAnchorX,C=s.projectedAnchorY,P=s.projectedAnchorZ;const E=s.elevation,I=s.tileID,A=t.getProjection();if(E&&I){const[T,k,N]=A.upVector(I.canonical,s.tileAnchorX,s.tileAnchorY),F=A.upVectorScale(I.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;b+=T*E*F,C+=k*E*F,P+=N*E*F}const l=this.projectAndGetPerspectiveRatio(g,b,C,P,s.tileID,"globe"===A.name||!!E||this.transform.pitch>0,A),u=f*l.perspectiveRatio,p=(s.x1*r+c.x-s.padding)*u+l.point.x,m=(s.y1*r+c.y-s.padding)*u+l.point.y,v=(s.x2*r+c.x+s.padding)*u+l.point.x,M=(s.y2*r+c.y+s.padding)*u+l.point.y,O=l.perspectiveRatio<=.55||l.occluded;return!this.isInsideGrid(p,m,v,M)||!d&&this.grid.hitTest(p,m,v,M,y)||O?{box:[],offscreen:!1,occluded:l.occluded}:{box:[p,m,v,M],offscreen:this.isOffscreen(p,m,v,M),occluded:!1}}placeCollisionCircles(t,r,s,c,d,f,g,y,b,C,P,E,I,A,l){const u=[],p=this.transform.elevation,m=t.getProjection(),v=p?p.getAtTileOffsetFunc(l,this.transform.center.lat,this.transform.worldSize,m):null,M=new tt(s.tileAnchorX,s.tileAnchorY);let{x:O,y:T,z:k}=m.projectTilePoint(M.x,M.y,l.canonical);if(v){const[it,rt,ct]=v(M);O+=it,T+=rt,k+=ct}const N="globe"===m.name,F=this.projectAndGetPerspectiveRatio(g,O,T,k,l,N||!!p||this.transform.pitch>0,m),{perspectiveRatio:$}=F,q=(P?f/$:f*$)/os,Z=mc(O,T,k,y),X=F.signedDistanceFromCamera>0?lv(q,d,s.lineOffsetX*q,s.lineOffsetY*q,!1,Z,M,s,c,y,{},p&&!P?v:null,P&&!!p,m,l,P):null;let K=!1,J=!1,st=!0;if(X&&!F.occluded){const it=.5*I*$+A,rt=new tt(-100,-100),ct=new tt(this.screenRightBoundary,this.screenBottomBoundary),yt=new kx,{first:Et,last:Tt}=X,zt=Et.path.length;let Nt=[];for(let oe=zt-1;oe>=1;oe--)Nt.push(Et.path[oe]);for(let oe=1;oe<Tt.path.length;oe++)Nt.push(Tt.path[oe]);const $t=2.5*it;b&&(Nt=Nt.map(([oe,Oe,Ee],Be)=>(v&&!N&&(Ee=v(Be<zt-1?Et.tilePath[zt-1-Be]:Tt.tilePath[Be-zt+2])[2]),mc(oe,Oe,Ee,b))),Nt.some(oe=>oe[3]<=0)&&(Nt=[]));let Rt=[];if(Nt.length>0){let oe=1/0,Oe=-1/0,Ee=1/0,Be=-1/0;for(const je of Nt)oe=Math.min(oe,je[0]),Ee=Math.min(Ee,je[1]),Oe=Math.max(Oe,je[0]),Be=Math.max(Be,je[1]);Oe>=rt.x&&oe<=ct.x&&Be>=rt.y&&Ee<=ct.y&&(Rt=[Nt.map(je=>new tt(je[0],je[1]))],(oe<rt.x||Oe>ct.x||Ee<rt.y||Be>ct.y)&&(Rt=yf(Rt,rt.x,rt.y,ct.x,ct.y)))}for(const oe of Rt){yt.reset(oe,.25*it);let Oe=0;Oe=yt.length<=.5*it?1:Math.ceil(yt.paddedLength/$t)+1;for(let Ee=0;Ee<Oe;Ee++){const Be=Ee/Math.max(Oe-1,1),je=yt.lerp(Be),On=je.x+vc,Qe=je.y+vc;u.push(On,Qe,it,0);const nr=On-it,ln=Qe-it,Ln=On+it,En=Qe+it;if(st=st&&this.isOffscreen(nr,ln,Ln,En),J=J||this.isInsideGrid(nr,ln,Ln,En),!r&&this.grid.hitTestCircle(On,Qe,it,E)&&(K=!0,!C))return{circles:[],offscreen:!1,collisionDetected:K,occluded:!1}}}}return{circles:!C&&K||!J?[]:u,offscreen:st,collisionDetected:K,occluded:F.occluded}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const r=[];let s=1/0,c=1/0,d=-1/0,f=-1/0;for(const C of t){const P=new tt(C.x+vc,C.y+vc);s=Math.min(s,P.x),c=Math.min(c,P.y),d=Math.max(d,P.x),f=Math.max(f,P.y),r.push(P)}const g=this.grid.query(s,c,d,f).concat(this.ignoredGrid.query(s,c,d,f)),y={},b={};for(const C of g){const P=C.key;void 0===y[P.bucketInstanceId]&&(y[P.bucketInstanceId]={}),y[P.bucketInstanceId][P.featureIndex]||Bw(r,[new tt(C.x1,C.y1),new tt(C.x2,C.y1),new tt(C.x2,C.y2),new tt(C.x1,C.y2)])&&(y[P.bucketInstanceId][P.featureIndex]=!0,void 0===b[P.bucketInstanceId]&&(b[P.bucketInstanceId]=[]),b[P.bucketInstanceId].push(P.featureIndex))}return b}insertCollisionBox(t,r,s,c,d){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:s,featureIndex:c,collisionGroupID:d},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,r,s,c,d){const f=r?this.ignoredGrid:this.grid,g={bucketInstanceId:s,featureIndex:c,collisionGroupID:d};for(let y=0;y<t.length;y+=4)f.insertCircle(g,t[y],t[y+1],t[y+2])}projectAndGetPerspectiveRatio(t,r,s,c,d,f,g){const y=[r,s,c,1];let b=!1;c||this.transform.pitch>0?(kr.transformMat4(y,y,t),this.fogState&&d&&"globe"!==g.name&&(b=function(E,I,A,l,u,p){const m=p.calculateFogTileMatrix(u),v=[I,A,l];return dt.transformMat4(v,v,m),od(E,dt.length(v),p.pitch,p._fov)}(this.fogState,r,s,c,d.toUnwrapped(),this.transform)>.9)):$T(y,y,t);const C=y[3];return{point:new tt((y[0]/C+1)/2*this.transform.width+vc,(-y[1]/C+1)/2*this.transform.height+vc),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(g)/C*.5,1.5),signedDistanceFromCamera:C,occluded:f&&y[2]>C||b}}isOffscreen(t,r,s,c){return s<vc||t>=this.screenRightBoundary||c<vc||r>this.screenBottomBoundary}isInsideGrid(t,r,s,c){return s>=0&&t<this.gridRightBoundary&&c>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const t=bt.identity([]);return bt.translate(t,t,[-100,-100,0]),t}}function WC(e,t,r){const s=t.createTileMatrix(e,e.worldSize,r.toUnwrapped());return bt.multiply(new Float32Array(16),e.projMatrix,s)}function KC(e,t,r){if(t.projection.name===r.projection.name)return e.projMatrix;const s=r.clone();return s.setProjection(t.projection),WC(s,t.getProjection(),e)}function zv(e,t,r){return t.name===r.projection.name?e.projMatrix:WC(r,t,e)}class vy{constructor(t,r,s,c){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?r:-r))):c&&s?1:0,this.placed=s}isHidden(){return 0===this.opacity&&!this.placed}}class by{constructor(t,r,s,c,d,f=!1){this.text=new vy(t?t.text:null,r,s,d),this.icon=new vy(t?t.icon:null,r,c,d),this.clipped=f}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Mm{constructor(t,r,s,c=!1){this.text=t,this.icon=r,this.skipFade=s,this.clipped=c}}class YC{constructor(){this.invProjMatrix=bt.create(),this.viewportMatrix=bt.create(),this.circles=[]}}class XC{constructor(t,r,s,c,d){this.bucketInstanceId=t,this.featureIndex=r,this.sourceLayerIndex=s,this.bucketIndex=c,this.tileID=d}}class rE{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const r=++this.maxGroupID;this.collisionGroups[t]={ID:r,predicate:s=>s.collisionGroupID===r}}return this.collisionGroups[t]}}function Rx(e,t,r,s,c){const{horizontalAlign:d,verticalAlign:f}=U0(e),g=-(d-.5)*t,y=-(f-.5)*r,b=em(e,s);return new tt(g+b[0]*c,y+b[1]*c)}function Lx(e,t,r,s,c){const d=new tt(e,t);return r&&d._rotate(s?c:-c),d}class oE{constructor(t,r,s,c,d,f){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new nE(this.transform,d),this.buildingIndex=f,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new rE(s),this.collisionCircleArrays={},this.prevPlacement=c,c&&(c.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,r,s,c){const d=s.getBucket(r),f=s.latestFeatureIndex;if(!d||!f||r.fqid!==d.layerIds[0])return;const g=d.layers[0].layout,y=s.collisionBoxArray,b=Math.pow(2,this.transform.zoom-s.tileID.overscaledZ),C=s.tileSize/Dt,P=s.tileID.toUnwrapped();this.transform.setProjection(d.projection);const E=(I=s.tileID,A=d.getProjection(),l=this.transform,A.name===this.projection?l.calculateProjMatrix(I.toUnwrapped()):WC(l,A,I));var I,A,l;const u="map"===g.get("text-pitch-alignment"),p="map"===g.get("text-rotation-alignment");r.compileFilter();const m=r.dynamicFilter(),v=r.dynamicFilterNeedsFeature(),M=this.transform.calculatePixelsToTileUnitsMatrix(s),O=iy(E,s.tileID.canonical,u,p,this.transform,d.getProjection(),M);let T=null;if(u){const F=dm(E,s.tileID.canonical,u,p,this.transform,d.getProjection(),M);T=bt.multiply([],this.transform.labelPlaneMatrix,F)}let k=null;m&&s.latestFeatureIndex&&(k={unwrappedTileID:P,dynamicFilter:m,dynamicFilterNeedsFeature:v,featureIndex:s.latestFeatureIndex}),this.retainedQueryData[d.bucketInstanceId]=new XC(d.bucketInstanceId,f,d.sourceLayerIndex,d.index,s.tileID);const N={bucket:d,layout:g,posMatrix:E,textLabelPlaneMatrix:O,labelToScreenMatrix:T,clippingData:k,scale:b,textPixelRatio:C,holdingForFade:s.holdingForFade(),collisionBoxArray:y,partiallyEvaluatedTextSize:ui(d.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:ui(d.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(d.sourceID)};if(c)for(const F of d.sortKeyRanges){const{sortKey:$,symbolInstanceStart:q,symbolInstanceEnd:Z}=F;t.push({sortKey:$,symbolInstanceStart:q,symbolInstanceEnd:Z,parameters:N})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:d.symbolInstances.length,parameters:N})}attemptAnchorPlacement(t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p,m){const{textOffset0:v,textOffset1:M,crossTileID:O}=E,T=[v,M],k=Rx(t,s,c,T,d),N=this.collisionIndex.placeCollisionBox(A,d,r,Lx(k.x,k.y,f,g,this.transform.angle),P,y,b,C.predicate);if(u){const F=A.getSymbolInstanceIconSize(m,this.transform.zoom,E.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(A,F,u,Lx(k.x,k.y,f,g,this.transform.angle),P,y,b,C.predicate).box.length)return}if(N.box.length>0){let F;return this.prevPlacement&&this.prevPlacement.variableOffsets[O]&&this.prevPlacement.placements[O]&&this.prevPlacement.placements[O].text&&(F=this.prevPlacement.variableOffsets[O].anchor),this.variableOffsets[O]={textOffset:T,width:s,height:c,anchor:t,textScale:d,prevAnchor:F},this.markUsedJustification(A,t,E,l),A.allowVerticalPlacement&&(this.markUsedOrientation(A,l,E),this.placedOrientations[O]=l),{shift:k,placedGlyphBoxes:N}}}placeLayerBucketPart(t,r,s,c){const{bucket:d,layout:f,posMatrix:g,textLabelPlaneMatrix:y,labelToScreenMatrix:b,clippingData:C,textPixelRatio:P,holdingForFade:E,collisionBoxArray:I,partiallyEvaluatedTextSize:A,partiallyEvaluatedIconSize:l,collisionGroup:u}=t.parameters,p=f.get("text-optional"),m=f.get("icon-optional"),v=f.get("text-allow-overlap"),M=f.get("icon-allow-overlap"),O="map"===f.get("text-rotation-alignment"),T="map"===f.get("text-pitch-alignment"),k="viewport-y"===f.get("symbol-z-order"),N=f.get("symbol-z-elevate");this.transform.setProjection(d.projection);let F=v&&(M||!d.hasIconData()||m),$=M&&(v||!d.hasTextData()||p);!d.collisionArrays&&I&&d.deserializeCollisionBoxes(I),s&&c&&d.updateCollisionDebugBuffers(this.transform.zoom,I);const q=(Z,X,K)=>{const{crossTileID:J,numVerticalGlyphVertices:st}=Z;if(C){const Ln={zoom:this.transform.zoom,pitch:this.transform.pitch};let En=null;if(C.dynamicFilterNeedsFeature){const mn=this.retainedQueryData[d.bucketInstanceId];En=C.featureIndex.loadFeature({featureIndex:Z.featureIndex,bucketIndex:mn.bucketIndex,sourceLayerIndex:mn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,C.dynamicFilter)(Ln,En,this.retainedQueryData[d.bucketInstanceId].tileID.canonical,new tt(Z.tileAnchorX,Z.tileAnchorY),this.transform.calculateDistanceTileData(C.unwrappedTileID)))return this.placements[J]=new Mm(!1,!1,!1,!0),void r.add(J)}if(r.has(J))return;if(E)return void(this.placements[J]=new Mm(!1,!1,!1));let it=!1,rt=!1,ct=!0,yt=!1,Et=!1,Tt=null,zt={box:null,offscreen:null,occluded:null},Nt={box:null,offscreen:null,occluded:null},$t=null,Rt=null,oe=null,Oe=0,Ee=0,Be=0;K.textFeatureIndex?Oe=K.textFeatureIndex:Z.useRuntimeCollisionCircles&&(Oe=Z.featureIndex),K.verticalTextFeatureIndex&&(Ee=K.verticalTextFeatureIndex);const je=Ln=>{Ln.tileID=this.retainedQueryData[d.bucketInstanceId].tileID;const En=this.transform.elevation;Ln.elevation=Z.zOffset+(En?En.getAtTileOffset(Ln.tileID,Ln.tileAnchorX,Ln.tileAnchorY):0)},On=K.textBox;if(On){je(On);const Ln=mn=>{let wr=so.horizontal;if(d.allowVerticalPlacement&&!mn&&this.prevPlacement){const Lr=this.prevPlacement.placedOrientations[J];Lr&&(this.placedOrientations[J]=Lr,wr=Lr,this.markUsedOrientation(d,wr,Z))}return wr},En=(mn,wr)=>{if(d.allowVerticalPlacement&&st>0&&K.verticalTextBox){for(const Lr of d.writingModes)if(Lr===so.vertical?(zt=wr(),Nt=zt):zt=mn(),zt&&zt.box&&zt.box.length)break}else zt=mn()};if(f.get("text-variable-anchor")){let mn=f.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[J]){const rr=this.prevPlacement.variableOffsets[J];mn.indexOf(rr.anchor)>0&&(mn=mn.filter(Kr=>Kr!==rr.anchor),mn.unshift(rr.anchor))}const wr=(rr,Kr,Ao)=>{const mo=d.getSymbolInstanceTextSize(A,Z,this.transform.zoom,X),Fo=(rr.x2-rr.x1)*mo+2*rr.padding,$i=(rr.y2-rr.y1)*mo+2*rr.padding,Ii=Z.hasIconTextFit&&!M?Kr:null;Ii&&je(Ii);let Ho={box:[],offscreen:!1,occluded:!1};const Gr=v?2*mn.length:mn.length;for(let Si=0;Si<Gr;++Si){const zf=this.attemptAnchorPlacement(mn[Si%mn.length],rr,Fo,$i,mo,O,T,P,g,u,Si>=mn.length,Z,X,d,Ao,Ii,A,l);if(zf&&(Ho=zf.placedGlyphBoxes,Ho&&Ho.box&&Ho.box.length)){it=!0,Tt=zf.shift;break}}return Ho};En(()=>wr(On,K.iconBox,so.horizontal),()=>{const rr=K.verticalTextBox;return rr&&je(rr),d.allowVerticalPlacement&&!(zt&&zt.box&&zt.box.length)&&st>0&&rr?wr(rr,K.verticalIconBox,so.vertical):{box:null,offscreen:null,occluded:null}}),zt&&(it=zt.box,ct=zt.offscreen,yt=zt.occluded);const Lr=Ln(!(!zt||!zt.box));if(!it&&this.prevPlacement){const rr=this.prevPlacement.variableOffsets[J];rr&&(this.variableOffsets[J]=rr,this.markUsedJustification(d,rr.anchor,Z,Lr))}}else{const mn=(wr,Lr)=>{const rr=d.getSymbolInstanceTextSize(A,Z,this.transform.zoom,X),Kr=this.collisionIndex.placeCollisionBox(d,rr,wr,new tt(0,0),v,P,g,u.predicate);return Kr&&Kr.box&&Kr.box.length&&(this.markUsedOrientation(d,Lr,Z),this.placedOrientations[J]=Lr),Kr};En(()=>mn(On,so.horizontal),()=>{const wr=K.verticalTextBox;return d.allowVerticalPlacement&&st>0&&wr?(je(wr),mn(wr,so.vertical)):{box:null,offscreen:null,occluded:null}}),Ln(!!(zt&&zt.box&&zt.box.length))}}if($t=zt,it=$t&&$t.box&&$t.box.length>0,ct=$t&&$t.offscreen,yt=$t&&$t.occluded,Z.useRuntimeCollisionCircles){const Ln=d.text.placedSymbolArray.get(Z.centerJustifiedTextSymbolIndex>=0?Z.centerJustifiedTextSymbolIndex:Z.verticalPlacedTextSymbolIndex),En=Wg(d.textSizeData,A,Ln),mn=f.get("text-padding");Rt=this.collisionIndex.placeCollisionCircles(d,v,Ln,d.lineVertexArray,d.glyphOffsetArray,En,g,y,b,s,T,u.predicate,Z.collisionCircleDiameter*En/os,mn,this.retainedQueryData[d.bucketInstanceId].tileID),it=v||Rt.circles.length>0&&!Rt.collisionDetected,ct=ct&&Rt.offscreen,yt=Rt.occluded}if(K.iconFeatureIndex&&(Be=K.iconFeatureIndex),K.iconBox){const Ln=En=>{je(En);const mn=Z.hasIconTextFit&&Tt?Lx(Tt.x,Tt.y,O,T,this.transform.angle):new tt(0,0),wr=d.getSymbolInstanceIconSize(l,this.transform.zoom,Z.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(d,wr,En,mn,M,P,g,u.predicate)};Nt&&Nt.box&&Nt.box.length&&K.verticalIconBox?(oe=Ln(K.verticalIconBox),rt=oe.box.length>0):(oe=Ln(K.iconBox),rt=oe.box.length>0),ct=ct&&oe.offscreen,Et=oe.occluded}const Qe=p||0===Z.numHorizontalGlyphVertices&&0===st,nr=m||0===Z.numIconVertices;if(Qe||nr?nr?Qe||(rt=rt&&it):it=rt&&it:rt=it=rt&&it,it&&$t&&$t.box&&this.collisionIndex.insertCollisionBox($t.box,f.get("text-ignore-placement"),d.bucketInstanceId,Nt&&Nt.box&&Ee?Ee:Oe,u.ID),rt&&oe&&this.collisionIndex.insertCollisionBox(oe.box,f.get("icon-ignore-placement"),d.bucketInstanceId,Be,u.ID),Rt&&(it&&this.collisionIndex.insertCollisionCircles(Rt.circles,f.get("text-ignore-placement"),d.bucketInstanceId,Oe,u.ID),s)){const Ln=d.bucketInstanceId;let En=this.collisionCircleArrays[Ln];void 0===En&&(En=this.collisionCircleArrays[Ln]=new YC);for(let mn=0;mn<Rt.circles.length;mn+=4)En.circles.push(Rt.circles[mn+0]),En.circles.push(Rt.circles[mn+1]),En.circles.push(Rt.circles[mn+2]),En.circles.push(Rt.collisionDetected?1:0)}const ln="globe"!==d.projection.name;F=F&&(ln||!yt),$=$&&(ln||!Et),this.placements[J]=new Mm(it||F,rt||$,ct||d.justReloaded),r.add(J)};if(N&&this.buildingIndex&&(this.buildingIndex.updateZOffset(d,this.retainedQueryData[d.bucketInstanceId].tileID),d.updateZOffset()),k){const Z=d.getSortedSymbolIndexes(this.transform.angle);for(let X=Z.length-1;X>=0;--X){const K=Z[X];q(d.symbolInstances.get(K),K,d.collisionArrays[K])}d.hasAnyZOffset&&gt(`${d.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(d.hasAnyZOffset){const Z=d.getSortedIndexesByZOffset();for(let X=0;X<Z.length;++X){const K=Z[X];q(d.symbolInstances.get(K),K,d.collisionArrays[K])}}else for(let Z=t.symbolInstanceStart;Z<t.symbolInstanceEnd;Z++)q(d.symbolInstances.get(Z),Z,d.collisionArrays[Z]);if(s&&d.bucketInstanceId in this.collisionCircleArrays){const Z=this.collisionCircleArrays[d.bucketInstanceId];bt.invert(Z.invProjMatrix,g),Z.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}markUsedJustification(t,r,s,c){const{leftJustifiedTextSymbolIndex:d,centerJustifiedTextSymbolIndex:f,rightJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:y,crossTileID:b}=s,C=nC(r),P=c===so.vertical?y:"left"===C?d:"center"===C?f:"right"===C?g:-1;d>=0&&(t.text.placedSymbolArray.get(d).crossTileID=P>=0&&d!==P?0:b),f>=0&&(t.text.placedSymbolArray.get(f).crossTileID=P>=0&&f!==P?0:b),g>=0&&(t.text.placedSymbolArray.get(g).crossTileID=P>=0&&g!==P?0:b),y>=0&&(t.text.placedSymbolArray.get(y).crossTileID=P>=0&&y!==P?0:b)}markUsedOrientation(t,r,s){const c=r===so.horizontal||r===so.horizontalOnly?r:0,d=r===so.vertical?r:0,{leftJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:g,rightJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:b}=s,C=t.text.placedSymbolArray;f>=0&&(C.get(f).placedOrientation=c),g>=0&&(C.get(g).placedOrientation=c),y>=0&&(C.get(y).placedOrientation=c),b>=0&&(C.get(b).placedOrientation=d)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let s=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const c=r?r.symbolFadeChange(t):1,d=r?r.opacities:{},f=r?r.variableOffsets:{},g=r?r.placedOrientations:{};for(const y in this.placements){const b=this.placements[y],C=d[y];C?(this.opacities[y]=new by(C,c,b.text,b.icon,null,b.clipped),s=s||b.text!==C.text.placed||b.icon!==C.icon.placed):(this.opacities[y]=new by(null,c,b.text,b.icon,b.skipFade,b.clipped),s=s||b.text||b.icon)}for(const y in d){const b=d[y];if(!this.opacities[y]){const C=new by(b,c,!1,!1);C.isHidden()||(this.opacities[y]=C,s=s||b.text.placed||b.icon.placed)}}for(const y in f)this.variableOffsets[y]||!this.opacities[y]||this.opacities[y].isHidden()||(this.variableOffsets[y]=f[y]);for(const y in g)this.placedOrientations[y]||!this.opacities[y]||this.opacities[y].isHidden()||(this.placedOrientations[y]=g[y]);s?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:t)}updateLayerOpacities(t,r){const s=new Set;for(const c of r){const d=c.getBucket(t);d&&c.latestFeatureIndex&&t.fqid===d.layerIds[0]&&(this.updateBucketOpacities(d,s,c.collisionBoxArray),d.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(d,c.tileID),d.updateZOffset()))}}updateBucketOpacities(t,r,s){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const c=t.layers[0].layout,d=!!t.layers[0].dynamicFilter(),f=new by(null,0,!1,!1,!0),g=c.get("text-allow-overlap"),y=c.get("icon-allow-overlap"),b=c.get("text-variable-anchor"),C="map"===c.get("text-rotation-alignment"),P="map"===c.get("text-pitch-alignment"),E=new by(null,0,g&&(y||!t.hasIconData()||c.get("icon-optional")),y&&(g||!t.hasTextData()||c.get("text-optional")),!0);!t.collisionArrays&&s&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(s);const I=(l,u,p)=>{for(let m=0;m<u/4;m++)l.opacityVertexArray.emplaceBack(p)};let A=0;for(let l=0;l<t.symbolInstances.length;l++){const u=t.symbolInstances.get(l),{numHorizontalGlyphVertices:p,numVerticalGlyphVertices:m,crossTileID:v,numIconVertices:M}=u,O=r.has(v);let T=this.opacities[v];O?T=f:T||(T=E,this.opacities[v]=T),r.add(v);const k=p>0||m>0,N=M>0,F=this.placedOrientations[v],$=F===so.vertical,q=F===so.horizontal||F===so.horizontalOnly;if(!k&&!N||T.isHidden()||A++,k){const Z=aE(T.text);I(t.text,p,$?wy:Z),I(t.text,m,q?wy:Z);const X=T.text.isHidden(),{leftJustifiedTextSymbolIndex:K,centerJustifiedTextSymbolIndex:J,rightJustifiedTextSymbolIndex:st,verticalPlacedTextSymbolIndex:it}=u,rt=t.text.placedSymbolArray,ct=X||$?1:0;K>=0&&(rt.get(K).hidden=ct),J>=0&&(rt.get(J).hidden=ct),st>=0&&(rt.get(st).hidden=ct),it>=0&&(rt.get(it).hidden=X||q?1:0);const yt=this.variableOffsets[v];yt&&this.markUsedJustification(t,yt.anchor,u,F);const Et=this.placedOrientations[v];Et&&(this.markUsedJustification(t,"left",u,Et),this.markUsedOrientation(t,Et,u))}if(N){const Z=aE(T.icon),{placedIconSymbolIndex:X,verticalPlacedIconSymbolIndex:K}=u,J=t.icon.placedSymbolArray,st=T.icon.isHidden()?1:0;X>=0&&(I(t.icon,M,$?wy:Z),J.get(X).hidden=st),K>=0&&(I(t.icon,u.numVerticalIconVertices,q?wy:Z),J.get(K).hidden=st)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Z=t.collisionArrays[l];if(Z){let X=new tt(0,0),K=!0;if(Z.textBox||Z.verticalTextBox){if(b){const st=this.variableOffsets[v];st?(X=Rx(st.anchor,st.width,st.height,st.textOffset,st.textScale),C&&X._rotate(P?this.transform.angle:-this.transform.angle)):K=!1}d&&(K=!T.clipped),Z.textBox&&xy(t.textCollisionBox.collisionVertexArray,T.text.placed,!K||$,X.x,X.y),Z.verticalTextBox&&xy(t.textCollisionBox.collisionVertexArray,T.text.placed,!K||q,X.x,X.y)}const J=K&&!(q||!Z.verticalIconBox);Z.iconBox&&xy(t.iconCollisionBox.collisionVertexArray,T.icon.placed,J,u.hasIconTextFit?X.x:0,u.hasIconTextFit?X.y:0),Z.verticalIconBox&&xy(t.iconCollisionBox.collisionVertexArray,T.icon.placed,!J,u.hasIconTextFit?X.x:0,u.hasIconTextFit?X.y:0)}}}if(t.fullyClipped=0===A,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const l=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=l.invProjMatrix,t.placementViewportMatrix=l.viewportMatrix,t.collisionCircleArray=l.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,r){const s=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*s>t}setStale(){this.stale=!0}}function xy(e,t,r,s,c){e.emplaceBack(t?1:0,r?1:0,s||0,c||0),e.emplaceBack(t?1:0,r?1:0,s||0,c||0),e.emplaceBack(t?1:0,r?1:0,s||0,c||0),e.emplaceBack(t?1:0,r?1:0,s||0,c||0)}const Nx=Math.pow(2,25),iE=Math.pow(2,24),Fx=Math.pow(2,17),zx=Math.pow(2,16),QC=Math.pow(2,9),sE=Math.pow(2,8),Bv=Math.pow(2,1);function aE(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,r=Math.floor(127*e.opacity);return r*Nx+t*iE+r*Fx+t*zx+r*QC+t*sE+r*Bv+t}const wy=0;class JC{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,r,s,c,d){const f=this._bucketParts;for(;this._currentTileIndex<t.length;)if(r.getBucketParts(f,c,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,d())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,f.sort((g,y)=>g.sortKey-y.sortKey));this._currentPartIndex<f.length;){const g=f[this._currentPartIndex];if(r.placeLayerBucketPart(g,this._seenCrossTileIDs,s,0===g.symbolInstanceStart),this._currentPartIndex++,d())return!0}return!1}}class As{constructor(t,r,s,c,d,f,g,y,b){this.placement=new oE(t,d,f,g,y,b),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=s,this._showCollisionBoxes=c,this._done=!1}isDone(){return this._done}continuePlacement(t,r,s,c){const d=Mn.now(),f=()=>{const g=Mn.now()-d;return!this._forceFullPlacement&&g>2};for(;this._currentPlacementIndex>=0;){const g=r[t[this._currentPlacementIndex]],y=this.placement.collisionIndex.transform.zoom;if("symbol"===g.type&&(!g.minzoom||g.minzoom<=y)&&(!g.maxzoom||g.maxzoom>y)){const b=g,C=b.layout.get("symbol-z-elevate"),P=this._inProgressLayer=this._inProgressLayer||new JC(b),E=sn(g.source,g.scope);if(P.continuePlacement(C?c[E]:s[E],this.placement,this._showCollisionBoxes,g,f))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Jp=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Pm{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,s]=new Uint8Array(t,0,2);if(219!==r)throw new Error("Data does not appear to be in a KDBush format.");const c=s>>4;if(1!==c)throw new Error(`Got v${c} data when expected v1.`);const d=Jp[15&s];if(!d)throw new Error("Unrecognized array type.");const[f]=new Uint16Array(t,2,1),[g]=new Uint32Array(t,4,1);return new Pm(g,f,d,t)}constructor(t,r=64,s=Float64Array,c){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const d=Jp.indexOf(this.ArrayType),f=2*t*this.ArrayType.BYTES_PER_ELEMENT,g=t*this.IndexArrayType.BYTES_PER_ELEMENT,y=(8-g%8)%8;if(d<0)throw new Error(`Unexpected typed array class: ${s}.`);c&&c instanceof ArrayBuffer?(this.data=c,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+y,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+f+g+y),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+y,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+d]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=r,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return tM(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,s,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:f,nodeSize:g}=this,y=[0,d.length-1,0],b=[];for(;y.length;){const C=y.pop()||0,P=y.pop()||0,E=y.pop()||0;if(P-E<=g){for(let u=E;u<=P;u++){const p=f[2*u],m=f[2*u+1];p>=t&&p<=s&&m>=r&&m<=c&&b.push(d[u])}continue}const I=E+P>>1,A=f[2*I],l=f[2*I+1];A>=t&&A<=s&&l>=r&&l<=c&&b.push(d[I]),(0===C?t<=A:r<=l)&&(y.push(E),y.push(I-1),y.push(1-C)),(0===C?s>=A:c>=l)&&(y.push(I+1),y.push(P),y.push(1-C))}return b}within(t,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:c,coords:d,nodeSize:f}=this,g=[0,c.length-1,0],y=[],b=s*s;for(;g.length;){const C=g.pop()||0,P=g.pop()||0,E=g.pop()||0;if(P-E<=f){for(let u=E;u<=P;u++)Om(d[2*u],d[2*u+1],t,r)<=b&&y.push(c[u]);continue}const I=E+P>>1,A=d[2*I],l=d[2*I+1];Om(A,l,t,r)<=b&&y.push(c[I]),(0===C?t-s<=A:r-s<=l)&&(g.push(E),g.push(I-1),g.push(1-C)),(0===C?t+s>=A:r+s>=l)&&(g.push(I+1),g.push(P),g.push(1-C))}return y}}function tM(e,t,r,s,c,d){if(c-s<=r)return;const f=s+c>>1;e2(e,t,f,s,c,d),tM(e,t,r,s,f-1,1-d),tM(e,t,r,f+1,c,1-d)}function e2(e,t,r,s,c,d){for(;c>s;){if(c-s>600){const b=c-s+1,C=r-s+1,P=Math.log(b),E=.5*Math.exp(2*P/3),I=.5*Math.sqrt(P*E*(b-E)/b)*(C-b/2<0?-1:1);e2(e,t,r,Math.max(s,Math.floor(r-C*E/b+I)),Math.min(c,Math.floor(r+(b-C)*E/b+I)),d)}const f=t[2*r+d];let g=s,y=c;for(Bx(e,t,s,r),t[2*c+d]>f&&Bx(e,t,s,c);g<y;){for(Bx(e,t,g,y),g++,y--;t[2*g+d]<f;)g++;for(;t[2*y+d]>f;)y--}t[2*s+d]===f?Bx(e,t,s,y):(y++,Bx(e,t,y,c)),y<=r&&(s=y+1),r<=y&&(c=y-1)}}function Bx(e,t,r,s){Ux(e,r,s),Ux(t,2*r,2*s),Ux(t,2*r+1,2*s+1)}function Ux(e,t,r){const s=e[t];e[t]=e[r],e[r]=s}function Om(e,t,r,s){const c=e-r,d=t-s;return c*c+d*d}const Vx=512/Dt/2;class lE{constructor(t,r,s){this.tileID=t,this.bucketInstanceId=s,this.index=new Pm(r.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const c=t.canonical.x*Dt,d=t.canonical.y*Dt;for(let f=0;f<r.length;f++){const{key:g,crossTileID:y,tileAnchorX:b,tileAnchorY:C}=r.get(f),P=Math.floor((c+b)*Vx),E=Math.floor((d+C)*Vx);this.index.add(P,E),this.keys.push(g),this.crossTileIDs.push(y)}this.index.finish()}findMatches(t,r,s){const c=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z),d=Vx/Math.pow(2,r.canonical.z-this.tileID.canonical.z),f=r.canonical.x*Dt,g=r.canonical.y*Dt;for(let y=0;y<t.length;y++){const b=t.get(y);if(b.crossTileID)continue;const{key:C,tileAnchorX:P,tileAnchorY:E}=b,I=Math.floor((f+P)*d),A=Math.floor((g+E)*d),l=this.index.range(I-c,A-c,I+c,A+c);for(const u of l){const p=this.crossTileIDs[u];if(this.keys[u]===C&&!s.has(p)){s.add(p),b.crossTileID=p;break}}}}}class cE{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Cy{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const r=Math.round((t-this.lng)/360);if(0!==r)for(const s in this.indexes){const c=this.indexes[s],d={};for(const f in c){const g=c[f];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+r),d[g.tileID.key]=g}this.indexes[s]=d}this.lng=t}addBucket(t,r,s){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let d=0;d<r.symbolInstances.length;d++)r.symbolInstances.get(d).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const c=this.usedCrossTileIDs[t.overscaledZ];for(const d in this.indexes){const f=this.indexes[d];if(Number(d)>t.overscaledZ)for(const g in f){const y=f[g];y.tileID.isChildOf(t)&&y.findMatches(r.symbolInstances,t,c)}else{const g=f[t.scaledTo(Number(d)).key];g&&g.findMatches(r.symbolInstances,t,c)}}for(let d=0;d<r.symbolInstances.length;d++){const f=r.symbolInstances.get(d);f.crossTileID||(f.crossTileID=s.generate(),c.add(f.crossTileID))}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new lE(t,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(t,r){for(const s of r.crossTileIDs)this.usedCrossTileIDs[t].delete(s)}removeStaleBuckets(t){let r=!1;for(const s in this.indexes){const c=this.indexes[s];for(const d in c)t[c[d].bucketInstanceId]||(this.removeBucketCrossTileIDs(s,c[d]),delete c[d],r=!0)}return r}}class eM{constructor(){this.layerIndexes={},this.crossTileIDs=new cE,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,r,s,c){let d=this.layerIndexes[t.fqid];void 0===d&&(d=this.layerIndexes[t.fqid]=new Cy);let f=!1;const g={};"globe"!==c.name&&d.handleWrapJump(s);for(const y of r){const b=y.getBucket(t);b&&t.fqid===b.layerIds[0]&&(b.bucketInstanceId||(b.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(y.tileID,b,this.crossTileIDs)&&(f=!0),g[b.bucketInstanceId]=!0)}return d.removeStaleBuckets(g)&&(f=!0),f}pruneUnusedLayers(t){const r={};t.forEach(s=>{r[s]=!0});for(const s in this.layerIndexes)r[s]||delete this.layerIndexes[s]}}var My="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef RENDER_CUTOFF\nfloat cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w-0.0001;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}\n#endif",Uv="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Vv="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture(u_depth,uv-df.xz)),unpack_depth(texture(u_depth,uv+df.xz)),unpack_depth(texture(u_depth,uv-df.zy)),unpack_depth(texture(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",nM="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",jv="highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {\n#ifdef FOG_DITHERING\nvec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);\n#else\nreturn color;\n#endif\n}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",rM="#ifdef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);vec4 _raTexLinearCoord(vec2 texCoord,vec2 texResolution,out vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return (texCoord.xxyy+vec2(1.5,0.5).xyxy)/texResolution.xxyy;}vec2 _raTexLinearMix(vec2 fxy,vec4 colorMix,float colorOffset,vec4 t00,vec4 t10,vec4 t01,vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image0,c.yz),texture(u_image0,c.xz),texture(u_image0,c.yw),texture(u_image0,c.xw)\n);}vec2 raTexture2D_image1_linear(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec2 fxy;vec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texture(u_image1,c.yz),texture(u_image1,c.xz),texture(u_image1,c.yw),texture(u_image1,c.xw)\n);}vec2 raTexture2D_image0_nearest(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec4 t=texture(u_image0,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(vec2 texCoord,vec2 texResolution,vec4 colorMix,float colorOffset) {vec4 t=texture(u_image1,texCoord);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}\n#endif",Py="#ifdef RENDER_SHADOWS\nuniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}\n#endif//RENDER_SHADOWS",jx="#ifdef RENDER_SHADOWS\n#ifdef DEPTH_TEXTURE\nuniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;\n#else\nuniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;\n#endif\nuniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_1,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_0,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;\n#ifdef NATIVE\nhighp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));\n#else\nhighp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(\nshadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)\n);\n#endif\nvec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {\n#ifdef SHADOWS_SINGLE_CASCADE\nlight_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);\n#else\nlight_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));\n#endif\n}highp float calculate_shadow_bias(float NDotL) {\n#ifdef NORMAL_OFFSET\nreturn 0.5*u_shadow_bias.x;\n#else\nreturn 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));\n#endif\n}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}\n#endif";const Em=[];$v(My,Em);const Df={"_prelude_fog.vertex.glsl":nM,"_prelude_terrain.vertex.glsl":Vv,"_prelude_shadow.vertex.glsl":Py,"_prelude_fog.fragment.glsl":jv,"_prelude_shadow.fragment.glsl":jx,"_prelude_lighting.glsl":"\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}\n#endif//LIGHTING_3D_MODE","_prelude_raster_array.glsl":rM},Oy={};Rr("",Vv),Rr(jv,nM),Rr(jx,Py),Rr(rM,"");const n2=Rr("\nout vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#ifdef INDICATOR_CUTOUT\nuniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;\n#endif\nvec4 applyCutout(vec4 color) {\n#ifdef INDICATOR_CUTOUT\nfloat holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);\n#else\nreturn color;\n#endif\n}\n#ifdef DEBUG_WIREFRAME\n#define HANDLE_WIREFRAME_DEBUG \\\nglFragColor=vec4(0.7,0.0,0.0,0.7); \\\ngl_FragDepth=gl_FragCoord.z-0.0001;\n#else\n#define HANDLE_WIREFRAME_DEBUG\n#endif\n#ifdef RENDER_CUTOFF\nuniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;\n#endif","\n#define EXTENT 8192.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}\n#ifdef RENDER_CUTOFF\nuniform vec4 u_cutoff_params;out float v_cutoff_opacity;\n#endif\nconst vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}"),oM=My;var iM={background:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nin vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),backgroundPattern:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),circle:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\nglFragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}'),clippingMask:Rr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Rr('#include "_prelude_fog.fragment.glsl"\nuniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),heatmapTexture:Rr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(0.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}","in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Rr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",'#include "_prelude_terrain.vertex.glsl"\nin vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in float a_size_scale;in vec2 a_padding;in float a_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(a_z_offset+elevation(a_anchor_pos)),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}'),collisionCircle:Rr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}","in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Rr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",'#include "_prelude_terrain.vertex.glsl"\nin vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;\n#endif\nout vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}'),fill:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutline:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;out vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutlinePattern:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in vec2 v_pos;in vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;out vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillPattern:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;in vec2 v_pos;uniform float u_emissive_strength;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillExtrusion:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec4 v_color;in vec4 v_flat;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;\n#endif\nuniform lowp float u_opacity;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec2 v_ao;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nin vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nin highp vec3 v_normal;\n#endif\nuniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nin float v_flood_radius;in float v_has_floodlight;\n#endif\nuniform float u_emissive_strength;in float v_height;void main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nvec3 normal=normalize(v_normal);\n#endif\nfloat z;vec4 color=v_color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);\n#ifdef LIGHTING_3D_MODE\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#else\ncolor=mix(v_color,v_roof_color,z);\n#endif\n#endif\nfloat h=max(0.0,v_height);float ao_shade=1.0;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\ncolor.rgb*=mix(ao_shade,1.0,v_has_floodlight);\n#else\ncolor.rgb*=ao_shade;\n#endif\n#else\ncolor.rgb*=ao_shade;\n#endif\n#endif\n#ifdef LIGHTING_3D_MODE\nfloat flood_radiance=0.0;\n#ifdef FLOOD_LIGHT\nflood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef FLOOD_LIGHT\nfloat ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);\n#else\nfloat shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);\n#endif\n#else\ncolor.rgb=apply_lighting(color.rgb,normal);\n#ifdef FLOOD_LIGHT\ncolor.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);\n#endif\n#endif\ncolor.rgb=mix(color.rgb,v_flat.rgb,u_emissive_strength);color*=u_opacity;\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));\n#endif\n#ifdef RENDER_CUTOFF\ncolor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_lighting.glsl"\n#ifdef RENDER_CUTOFF\ninvariant gl_Position;\n#endif\nuniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nuniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nout vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nout highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec2 v_ao;\n#endif\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nout float v_flood_radius;out float v_has_floodlight;\n#endif\nout float v_height;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define highp float flood_light_wall_radius\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize highp float flood_light_wall_radius\nbase*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);h=h-ele;v_height=h;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=pos;vec3 shd_pos1=pos;\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifndef LIGHTING_3D_MODE\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#endif\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\nfloat is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;\n#endif\nv_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);\n#else\nv_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),fillExtrusionDepth:Rr("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\nout highp float v_depth;void main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\nbase*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nvec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);\n#else\npos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}'),fillExtrusionPattern:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nin vec3 v_normal;\n#endif\nin vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nout vec2 v_pos;out vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nout vec3 v_normal;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_normal=normal;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}'),groundShadow:Rr('#include "_prelude_shadow.fragment.glsl"\nprecision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\nvoid main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);\n#ifdef RENDER_CUTOFF\nshadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,v_depth));\n#endif\n#ifdef FOG\nshadow=mix(shadow,vec3(1.0),v_fog_opacity);\n#endif\n#ifdef INDICATOR_CUTOUT\nshadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);\n#endif\nglFragColor=vec4(shadow,1.0);}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);\n#endif\n}'),fillExtrusionGroundEffect:Rr("uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;\n#ifdef SDF_SUBPASS\nin highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}\n#ifdef FOG\nin highp float v_fog;\n#endif\n#endif\nvoid main() {\n#ifdef CLEAR_SUBPASS\nvec4 color=vec4(1.0);\n#ifdef CLEAR_FROM_TEXTURE\ncolor=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));\n#endif\nglFragColor=color;\n#else\n#ifdef SDF_SUBPASS\nhighp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;\n#ifdef FOG\nfog=v_fog;\n#endif\n#ifdef RENDER_CUTOFF\nfog*=v_cutoff_opacity;\n#endif\nglFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));\n#else\nvec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);\n#ifdef OVERDRAW_INSPECTOR\ncolor=vec4(1.0);\n#endif\nglFragColor=color;HANDLE_WIREFRAME_DEBUG;\n#endif\n#endif\n}",'#include "_prelude_fog.vertex.glsl"\nin highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;\n#ifdef SDF_SUBPASS\nout highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;\n#ifdef FOG\nout highp float v_fog;\n#endif\n#endif\nuniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;\n#pragma mapbox: define highp float flood_light_ground_radius\nconst float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {\n#pragma mapbox: initialize highp float flood_light_ground_radius\nvec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;\n#ifdef FORCE_ABS_FL_GROUND_RADIUS\nfl_ground_radius=abs(flood_light_ground_radius);\n#endif\nfloat flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;\n#ifdef SDF_SUBPASS\nv_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);\n#ifdef FOG\nv_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);\n#endif\n#endif\nfloat hidden_by_landmark=0.0;\n#ifdef HAS_CENTROID\nhidden_by_landmark=a_hidden_by_landmark;\n#endif\nfloat isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),hillshadePrepare:Rr("precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\nglFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);\n#endif\n#ifdef FOG\nglFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),line:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;in vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nfloat luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\nif (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    \nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#define EXTRUDE_SCALE 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nin highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nin float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),linePattern:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting_ground(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;in float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),raster:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_raster_array.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;\n#ifndef RASTER_ARRAY\nuniform sampler2D u_image0;uniform sampler2D u_image1;\n#endif\n#ifdef RASTER_COLOR\nuniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;\n#endif\nvoid main() {vec4 color0,color1,color;vec2 value;\n#ifdef RASTER_COLOR\n#ifdef RASTER_ARRAY\n#ifdef RASTER_ARRAY_LINEAR\nvalue=mix(\nraTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#else\nvalue=mix(\nraTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#endif\nif (value.y > 0.0) value.x/=value.y;\n#else\ncolor=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);\n#endif\ncolor=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;\n#else\ncolor0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);\n#endif\ncolor.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef RENDER_CUTOFF\nglFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform vec4 u_tl_br;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#elif defined(PROJECTION_GLOBE_VIEW)\nin vec2 a_pos;\n#else\nin vec2 a_pos;in vec2 a_texture_pos;\n#endif\nout vec2 v_pos0;out vec2 v_pos1;out float v_depth;void main() {vec2 uv;\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);\n#endif\n#else\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec2 globe_tl=vec2(u_tl_br.x,u_tl_br.y);vec2 globe_br=vec2(u_tl_br.z,u_tl_br.w);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=1.0-((mercatorY-globe_br.y)/(globe_tl.y-globe_br.y));float mercatorX=mercatorXfromLng(latLng[1]);float uvX=(mercatorX-globe_br.x)/(globe_tl.x-globe_br.x);vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);uv=vec2(uvX,uvY);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\nfloat w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\nuv=a_texture_pos/8192.0;\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;\n#ifdef RENDER_CUTOFF\nv_depth=gl_Position.z;\n#endif\n}'),symbolIcon:Rr('#include "_prelude_lighting.glsl"\nuniform sampler2D u_texture;\n#ifdef ICON_TRANSITION\nuniform float u_icon_transition;\n#endif\nin float v_fade_opacity;in vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nin vec2 v_tex_b;\n#endif\nuniform mediump float u_icon_saturation;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nlowp float alpha=opacity*v_fade_opacity;vec4 out_color;\n#ifdef ICON_TRANSITION\nvec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;\n#else\nout_color=texture(u_texture,v_tex_a)*alpha;\n#endif\n#ifdef SATURATION\nvec3 luma=vec3(dot(out_color.rgb,vec3(0.2126,0.7152,0.0722)));out_color.rgb=mix(luma,out_color.rgb,u_icon_saturation);\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef ICON_TRANSITION\nin vec2 a_texb;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nout vec2 v_tex_b;\n#endif\nout float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nv_tex_a=a_tex/u_texsize;\n#ifdef ICON_TRANSITION\nv_tex_b=a_texb/u_texsize;\n#endif\nv_fade_opacity=out_fade_opacity;}'),symbolSDF:Rr('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\nuniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;in float v_draw_halo;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}'),symbolTextAndIcon:Rr('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;in float v_draw_halo;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout float v_draw_halo;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nfloat out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}'),terrainRaster:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth;\n#endif\nuniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;\n#ifdef LIGHTING_3D_MODE\nconst vec3 normal=vec3(0.0,0.0,1.0);\n#ifdef RENDER_SHADOWS\nfloat cutoffOpacity=1.0;\n#ifdef RENDER_CUTOFF\ncutoffOpacity=cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nvec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;\n#else\nfloat lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));\n#endif\n#else\nfloat lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;\n#endif\n#endif\n#else\ncolor=image_color;\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#endif\nvoid main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}'),terrainDepth:Rr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}'),skybox:Rr('#include "_prelude_fog.fragment.glsl"\nin lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Uv),skyboxGradient:Rr('#include "_prelude_fog.fragment.glsl"\nin highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Uv),skyboxCapture:Rr("\nin highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}","in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nraster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);\n#else\nraster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;\n#else\ncolor=apply_lighting_ground(color);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;\n#endif\nout vec2 v_pos0;void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);globe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}'),globeAtmosphere:Rr('#include "_prelude_fog.fragment.glsl"\nuniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {\n#ifdef ALPHA_PASS\nglFragColor=vec4(0,0,0,0);return;\n#else\n#ifdef NATIVE\nglFragColor=vec4(1,1,1,1);\n#else\nglFragColor=vec4(0,0,0,1);\n#endif\nreturn;\n#endif\n}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;\n#ifdef ALPHA_PASS\nfloat a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);\n#else\nvec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;\n#ifndef NATIVE\nc=dither(c,gl_FragCoord.xy+u_temporal_offset);\n#endif\nglFragColor=vec4(c*t,t);\n#endif\n}',"in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}"),model:Rr('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;in float v_depth_shadows;\n#endif\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#ifdef HAS_ATTRIBUTE_a_pbr\nin lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;\n#endif\n#ifdef HAS_TEXTURE_u_baseColorTexture\nuniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;\n#endif\n#ifdef HAS_TEXTURE_u_metallicRoughnessTexture\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\n#ifdef HAS_TEXTURE_u_occlusionTexture\nuniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;\n#endif\n#ifdef HAS_TEXTURE_u_normalTexture\nuniform sampler2D u_normalTexture;\n#endif\n#ifdef HAS_TEXTURE_u_emissionTexture\nuniform sampler2D u_emissionTexture;\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nin highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture(u_depthTexture,coord));return v_depth > depth+0.0005;}\n#endif\n#define saturate(_x) clamp(_x,0.,1.)\nvec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)\n{\n#ifdef LIGHTING_3D_MODE\nvec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));\n#endif\nreturn apply_lighting(albedo,transformed_normal,lighting_factor);\n#else\nvec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;\n#endif\n}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;\n#ifdef HAS_ATTRIBUTE_a_color_3f\nalbedo*=vec4(color_3f,1.0);\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#else\n#ifdef HAS_ATTRIBUTE_a_color_4f\nalbedo*=color_4f;\n#endif\n#endif\n#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)\nvec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}\n#ifdef UNPREMULT_TEXTURE_IN_SHADER\nif(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;\n#endif\ntexColor.rgb=sRGBToLinear(texColor.rgb);if(u_baseTextureIsAlpha) {if (texColor.w < 0.5) {discard;}albedo*=mix(vec4(texColor.rgb,texColor.a),vec4(texColor.a),float(u_baseTextureIsAlpha));} else {albedo*=texColor;}\n#endif\nreturn vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {\n#ifdef HAS_TEXTURE_u_normalTexture\nhighp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;\n#else\nreturn mat3(1.0);\n#endif\n}highp vec3 getNormal(){highp vec3 n;\n#ifdef HAS_ATTRIBUTE_a_normal_3f\nn=normalize(normal_3f);\n#else\nhighp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;\n#endif\n#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nvec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);\n#endif\nreturn n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;\n#ifdef HAS_ATTRIBUTE_a_pbr\nmat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;\n#endif\n#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) \nvec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;\n#endif\nconst float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)\n{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)\n{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)\n{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)\n{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)\n{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)\n{\n#ifdef LIGHTING_3D_MODE\nreturn mat.diffuseColor;\n#else\nreturn mat.diffuseColor/PI;\n#endif\n}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)\n{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)\n{vec3 env_light=vec3(0.65,0.65,0.65);\n#ifdef LIGHTING_3D_MODE\nfloat ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;\n#endif\nvec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)\n{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=NdotL;\n#endif\nvec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;\n#if !defined(LIGHTING_3D_MODE)\nconst vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);\n#endif\ncolor*=intensityFactor;return color;}void main() {\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nif (isOccluded()) {discard;}\n#endif\nvec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;\n#ifdef LIGHTING_3D_MODE\nlightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;\n#endif\nvec4 finalColor;\n#ifdef DIFFUSE_SHADED\nvec3 N=getNormal();vec3 diffuse=getDiffuseShadedColor(getBaseColor().rgb,N,lightDir,lightColor);\n#ifdef HAS_TEXTURE_u_occlusionTexture\nfloat ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;\n#endif\nfinalColor=vec4(diffuse,1.0)*u_opacity;\n#else\nMaterial mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;\n#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nao=(texture(u_occlusionTexture,uv_2f).x-1.0)*u_aoIntensity+1.0;color*=ao;\n#endif\nvec4 emissive=u_emissiveFactor;\n#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nemissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);\n#endif\ncolor+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;\n#ifdef HAS_ATTRIBUTE_a_pbr\nfloat resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));\n#ifdef HAS_ATTRIBUTE_a_color_4f\nfloat distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);\n#endif\n#endif\nvec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);\n#endif\n#ifdef FOG\nfinalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));\n#endif\n#ifdef RENDER_CUTOFF\nfinalColor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nfinalColor=applyCutout(finalColor);\n#endif\nglFragColor=finalColor;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec3 a_pos_3f;\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr\n#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength\nuniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_normal_matrix;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth_shadows;\n#endif\nout vec4 v_position_height;out lowp vec4 v_color_mix;\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nout highp float v_depth;\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\nout lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;\n#endif\nvec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute-custom highp vec4 pbr\n#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength\nhighp mat4 normal_matrix;\n#ifdef INSTANCED_ARRAYS\nnormal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\nnormal_matrix=u_normal_matrix;\n#endif\nvec3 local_pos;mat3 rs;\n#ifdef MODEL_POSITION_ON_GPU\nvec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;\n#else\nlocal_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);\n#endif\nv_position_height.w=a_pos_3f.z;\n#ifdef HAS_ATTRIBUTE_a_pbr\nvec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(local_pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nfloat x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);\n#else\nnormal_3f=vec3(normal_matrix*vec4(normal_3f,0));\n#endif\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#ifdef HAS_ATTRIBUTE_a_color_4f\nv_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 shadow_pos=local_pos;\n#ifdef NORMAL_OFFSET\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nvec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();\n#else\nvec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();\n#endif\n#endif\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;\n#endif\n}'),modelDepth:Rr("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}","in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;\n#ifdef MODEL_POSITION_ON_GPU\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_instance;\n#endif\nuniform highp mat4 u_node_matrix;\n#endif\nvoid main() {\n#ifdef MODEL_POSITION_ON_GPU\nhighp mat4 instance;\n#ifdef INSTANCED_ARRAYS\ninstance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\ninstance=u_instance;\n#endif\nvec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;\n#else\ngl_Position=u_matrix*vec4(a_pos_3f,1);\n#endif\nv_depth=gl_Position.z/gl_Position.w;}"),stars:Rr("in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)\n{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}","\nin vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}")};function $v(e,t){const r=e.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let s of r)if(s=s.trim(),"#"===s[0]&&s.includes("if")&&!s.includes("endif")){s=s.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const c=s.split(" ");for(const d of c)t.includes(d)||t.push(d)}}function Rr(e,t){const r=/#include\s+"([^"]+)"/g,s=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let c=t.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);c&&(c=c.map(b=>{const C=b.split(" ");return C[C.length-1]}),c=[...new Set(c)]);const d={},f=[],g=[];e=e.replace(r,(b,C)=>(g.push(C),"")),t=t.replace(r,(b,C)=>(f.push(C),""));let y=[...Em];$v(e,y),$v(t,y);for(const b of[...f,...g])Df[b]||console.error(`Undefined include: ${b}`),Oy[b]||(Oy[b]=[],$v(Df[b],Oy[b])),y=[...y,...Oy[b]];return{fragmentSource:e=e.replace(s,(b,C,P,E,I)=>(d[I]=!0,"define"===C?`\n#ifndef HAS_UNIFORM_u_${I}\nin ${P} ${E} ${I};\n#else\nuniform ${P} ${E} u_${I};\n#endif\n`:"initialize"===C?`\n#ifdef HAS_UNIFORM_u_${I}\n    ${P} ${E} ${I} = u_${I};\n#endif\n`:"define-attribute"===C?`\n#ifdef HAS_ATTRIBUTE_a_${I}\n    in ${P} ${E} ${I};\n#endif\n`:"initialize-attribute"===C?"":void 0)),vertexSource:t=t.replace(s,(b,C,P,E,I)=>{const A="float"===E?"vec2":E,l=I.match(/color/)?"color":A;return"define-attribute-vertex-shader-only"===C?`\n#ifdef HAS_ATTRIBUTE_a_${I}\nin ${P} ${E} a_${I};\n#endif\n`:d[I]?"define"===C?`\n#ifndef HAS_UNIFORM_u_${I}\nuniform lowp float u_${I}_t;\nin ${P} ${A} a_${I};\nout ${P} ${E} ${I};\n#else\nuniform ${P} ${E} u_${I};\n#endif\n`:"initialize"===C?"vec4"===l?`\n#ifndef HAS_UNIFORM_u_${I}\n    ${I} = a_${I};\n#else\n    ${P} ${E} ${I} = u_${I};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${I}\n    ${I} = unpack_mix_${l}(a_${I}, u_${I}_t);\n#else\n    ${P} ${E} ${I} = u_${I};\n#endif\n`:"define-attribute"===C?`\n#ifdef HAS_ATTRIBUTE_a_${I}\n    in ${P} ${E} a_${I};\n    out ${P} ${E} ${I};\n#endif\n`:"initialize-attribute"===C?`\n#ifdef HAS_ATTRIBUTE_a_${I}\n    ${I} = a_${I};\n#endif\n`:void 0:"define"===C?`\n#ifndef HAS_UNIFORM_u_${I}\nuniform lowp float u_${I}_t;\nin ${P} ${A} a_${I};\n#else\nuniform ${P} ${E} u_${I};\n#endif\n`:"define-instanced"===C?"mat4"===l?`\n#ifdef INSTANCED_ARRAYS\nin vec4 a_${I}0;\nin vec4 a_${I}1;\nin vec4 a_${I}2;\nin vec4 a_${I}3;\n#else\nuniform ${P} ${E} u_${I};\n#endif\n`:`\n#ifdef INSTANCED_ARRAYS\nin ${P} ${A} a_${I};\n#else\nuniform ${P} ${E} u_${I};\n#endif\n`:"initialize-attribute-custom"===C?`\n#ifdef HAS_ATTRIBUTE_a_${I}\n    ${P} ${E} ${I} = a_${I};\n#endif\n`:"vec4"===l?`\n#ifndef HAS_UNIFORM_u_${I}\n    ${P} ${E} ${I} = a_${I};\n#else\n    ${P} ${E} ${I} = u_${I};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${I}\n    ${P} ${E} ${I} = unpack_mix_${l}(a_${I}, u_${I}_t);\n#else\n    ${P} ${E} ${I} = u_${I};\n#endif\n`}),staticAttributes:c,usedDefines:y,vertexIncludes:f,fragmentIncludes:g}}class r2{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,r,s,c,d,f,g,y){this.context=t;let b=this.boundPaintVertexBuffers.length!==c.length;for(let P=0;!b&&P<c.length;P++)this.boundPaintVertexBuffers[P]!==c[P]&&(b=!0);let C=this.boundDynamicVertexBuffers.length!==g.length;for(let P=0;!C&&P<g.length;P++)this.boundDynamicVertexBuffers[P]!==g[P]&&(C=!0);if(!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==s||b||C||this.boundIndexBuffer!==d||this.boundVertexOffset!==f)this.freshBind(r,s,c,d,f,g,y);else{t.bindVertexArrayOES.set(this.vao);for(const P of g)P&&(P.bind(),y&&P.instanceCount&&P.setVertexAttribDivisor(t.gl,r,y));d&&d.dynamicDraw&&d.bind()}}freshBind(t,r,s,c,d,f,g){const y=t.numAttributes,b=this.context,C=b.gl;this.vao&&this.destroy(),this.vao=b.gl.createVertexArray(),b.bindVertexArrayOES.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=s,this.boundIndexBuffer=c,this.boundVertexOffset=d,this.boundDynamicVertexBuffers=f,r.enableAttributes(C,t),r.bind(),r.setVertexAttribPointers(C,t,d);for(const P of s)P.enableAttributes(C,t),P.bind(),P.setVertexAttribPointers(C,t,d);for(const P of f)P&&(P.enableAttributes(C,t),P.bind(),P.setVertexAttribPointers(C,t,d),g&&P.instanceCount&&P.setVertexAttribDivisor(C,t,g));c&&c.bind(),b.currentNumAttributes=y}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function uE(e,t){const r=Math.pow(2,t.canonical.z),s=t.canonical.y;return[new Xn(0,s/r).toLngLat().lat,new Xn(0,(s+1)/r).toLngLat().lat]}function sM(e,t,r,s,c,d,f){const g=e.context,y=g.gl,b=r.hillshadeFBO;if(!b)return;e.prepareDrawTile();const C=e.isTileAffectedByFog(t),P=e.getOrCreateProgram("hillshade",{overrideFog:C});g.activeTexture.set(y.TEXTURE0),y.bindTexture(y.TEXTURE_2D,b.colorAttachment.get());const E=((u,p,m,v)=>{const M=m.paint.get("hillshade-shadow-color"),O=m.paint.get("hillshade-highlight-color"),T=m.paint.get("hillshade-accent-color"),k=m.paint.get("hillshade-emissive-strength");let N=Ct(m.paint.get("hillshade-illumination-direction"));if("viewport"===m.paint.get("hillshade-illumination-anchor"))N-=u.transform.angle;else if(u.style&&u.style.enable3dLights()&&u.style.directionalLight){const $=u.style.directionalLight.properties.get("direction");N=Ct(Ge($.x,$.y,$.z)[1])}const F=!u.options.moving;return{u_matrix:v||u.transform.calculateProjMatrix(p.tileID.toUnwrapped(),F),u_image:0,u_latrange:uE(0,p.tileID),u_light:[m.paint.get("hillshade-exaggeration"),N],u_shadow:M,u_highlight:O,u_emissive_strength:k,u_accent:T}})(e,r,s,e.terrain?t.projMatrix:null);e.uploadCommonUniforms(g,P,t.toUnwrapped());const{tileBoundsBuffer:I,tileBoundsIndexBuffer:A,tileBoundsSegments:l}=e.getTileBoundsBuffers(r);P.draw(e,y.TRIANGLES,c,d,f,Jn.disabled,E,s.id,I,A,l)}function o2(e,t,r){if(!t.needsDEMTextureUpload)return;const s=e.context,c=s.gl;s.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||e.getTileTexture(r.stride);const d=r.getPixels();t.demTexture?t.demTexture.update(d,{premultiply:!1}):t.demTexture=new xo(s,d,c.R32F,{premultiply:!1}),t.needsDEMTextureUpload=!1}function dE(e,t,r){const s=e.context,c=s.gl;if(!t.dem)return;const d=t.dem;if(s.activeTexture.set(c.TEXTURE1),o2(e,t,d),!t.demTexture)return;t.demTexture.bind(c.NEAREST,c.CLAMP_TO_EDGE);const f=d.dim;s.activeTexture.set(c.TEXTURE0);let g=t.hillshadeFBO;if(!g){const E=new xo(s,{width:f,height:f,data:null},c.RGBA);E.bind(c.LINEAR,c.CLAMP_TO_EDGE),g=t.hillshadeFBO=s.createFramebuffer(f,f,!0,"renderbuffer"),g.colorAttachment.set(E.texture)}s.bindFramebuffer.set(g.framebuffer),s.viewport.set([0,0,f,f]);const{tileBoundsBuffer:y,tileBoundsIndexBuffer:b,tileBoundsSegments:C}=e.getMercatorTileBoundsBuffers(),P=[];e.linearFloatFilteringSupported()&&P.push("TERRAIN_DEM_FLOAT_FORMAT"),e.getOrCreateProgram("hillshadePrepare",{defines:P}).draw(e,c.TRIANGLES,Pn.disabled,Gn.disabled,Sr.unblended,Jn.disabled,((E,I)=>{const A=I.stride,l=bt.create();return bt.ortho(l,0,Dt,-Dt,0,0,1),bt.translate(l,l,[0,-Dt,0]),{u_matrix:l,u_image:1,u_dimension:[A,A],u_zoom:E.overscaledZ}})(t.tileID,d),r.id,y,b,C),t.needsHillshadePrepare=!1}const hE=e=>({u_matrix:new Vn(e),u_image0:new cr(e),u_skirt_height:new fe(e),u_ground_shadow_factor:new Kn(e)}),$x=(e,t,r)=>({u_matrix:e,u_image0:0,u_skirt_height:t,u_ground_shadow_factor:r}),fE=(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A)=>({u_proj_matrix:Float32Array.from(e),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(s),u_merc_matrix:r,u_zoom_transition:c,u_merc_center:d,u_image0:0,u_frustum_tl:f,u_frustum_tr:g,u_frustum_br:y,u_frustum_bl:b,u_globe_pos:C,u_globe_radius:P,u_viewport:E,u_grid_matrix:A?Float32Array.from(A):new Float32Array(9),u_skirt_height:I}),Tm=(e,t)=>{if(t>0&&e.terrain&&gt("Cutoff is currently disabled on terrain"),t<=0||e.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,0]}};const r=e.transform,s=Math.max(Math.abs(r._zoom-(e.minCutoffZoom-1)),1),c=r.isLODDisabled(!1)?vs(60,45,r.pitch):vs(30,15,r.pitch),d=r._farZ-r._nearZ,f=t*r.height,g=((1-(y=c))*(.75*r.cameraToCenterDistance)+y*(r._farZ+f))*s;var y;return{shouldRenderCutoff:c<1,uniformValues:{u_cutoff_params:[r._nearZ,r._farZ,(g-r._nearZ)/d,(g-f-r._nearZ)/d]}}};function Gx(e,t){return null!=e&&null!=t&&!(!e.hasData()||!t.hasData())&&null!=e.demTexture&&null!=t.demTexture&&e.tileID.key!==t.tileID.key}const fh=new class{constructor(){this.operations={}}newMorphing(e,t,r,s,c){if(e in this.operations){const d=this.operations[e];d.to.tileID.key!==r.tileID.key&&(d.queued=r)}else this.operations[e]={startTime:s,phase:0,duration:c,from:t,to:r,queued:null}}getMorphValuesForProxy(e){if(!(e in this.operations))return null;const t=this.operations[e];return{from:t.from,to:t.to,phase:t.phase}}update(e){for(const t in this.operations){const r=this.operations[t];for(r.phase=(e-r.startTime)/r.duration;r.phase>=1||!this._validOp(r);)if(!this._nextOp(r,e)){delete this.operations[t];break}}}_nextOp(e,t){return!!e.queued&&(e.from=e.to,e.to=e.queued,e.queued=null,e.phase=0,e.startTime=t,!0)}_validOp(e){return e.from.hasData()&&e.to.hasData()}},wo={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Hx(e,t,r){if(0===t)return 0;const s=t<1&&514===r?.25/t:1;return 6*Math.pow(1.5,22-e)*Math.max(t,1)*s}function aM(e,t){const r=1<<e.z;return!t&&(0===e.x||e.x===r-1)||0===e.y||e.y===r-1}const Im=e=>({u_matrix:e});function pE(e,t,r,s,c){if(c>0){const d=Mn.now(),f=(d-e.timeAdded)/c,g=t?(d-t.timeAdded)/c:-1,y=r.getSource(),b=s.coveringZoomLevel({tileSize:y.tileSize,roundZoom:y.roundZoom}),C=!t||Math.abs(t.tileID.overscaledZ-b)>Math.abs(e.tileID.overscaledZ-b),P=C&&e.refreshedUponExpiration?1:Ne(C?f:1-g,0,1);return e.refreshedUponExpiration&&f>=1&&(e.refreshedUponExpiration=!1),t?{opacity:1,mix:1-P}:{opacity:P,mix:0}}return{opacity:1,mix:0}}class as extends Fa{constructor(t){const r={type:"raster-dem",maxzoom:t.transform.maxZoom},s=new _m(dh(),null),c=xm("mock-dem",r,s,t.style);super("mock-dem",c,!1),c.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,r){t.state="loaded",r(null)}}class va extends Fa{constructor(t){const r=xm("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new _m(dh(),null),t.style);super("proxy",r,!1),r.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,r,s){if(t.freezeTileCoverage)return;this.transform=t;const c=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((d,f)=>{if(d[f.key]="",!this._tiles[f.key]){const g=new Ki(f,this._source.tileSize*f.overscaleFactor(),t.tileZoom);g.state="loaded",this._tiles[f.key]=g}return d},{});for(const d in this._tiles)d in c||(this.freeFBO(d),this._tiles[d].unloadVectorData(),delete this._tiles[d])}freeFBO(t){const r=this.proxyCachedFBO[t];if(void 0!==r){const s=Object.values(r);this.renderCachePool.push(...s),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class tu extends Ir{constructor(t,r,s){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=r,this.projMatrix=s}}class gE extends F0{constructor(t,r){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[s,c,d]=function(y){const b=new pa,C=new Mi,P=131;b.reserve(17161),C.reserve(33800);const E=Dt/128,I=Dt+E/2,A=I+E;for(let u=-E;u<A;u+=E)for(let p=-E;p<A;p+=E){const m=p<0||p>I||u<0||u>I?24575:0,v=Ne(Math.round(p),0,Dt),M=Ne(Math.round(u),0,Dt);b.emplaceBack(v+m,M)}const l=(u,p)=>{const m=p*P+u;C.emplaceBack(m+1,m,m+P),C.emplaceBack(m+P,m+P+1,m+1)};for(let u=1;u<129;u++)for(let p=1;p<129;p++)l(p,u);return[0,129].forEach(u=>{for(let p=0;p<130;p++)l(p,u),l(u,p)}),[b,C,32768]}(),f=t.context;this.gridBuffer=f.createVertexBuffer(s,Cp.members),this.gridIndexBuffer=f.createIndexBuffer(c),this.gridSegments=lo.simpleSegment(0,0,s.length,c.length),this.gridNoSkirtSegments=lo.simpleSegment(0,0,s.length,d),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new va(r.map),this.orthoMatrix=bt.create(),bt.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,Dt,0,Dt,0,1);const g=f.gl;this._overlapStencilMode=new Gn({func:g.GEQUAL,mask:255},0,255,g.KEEP,g.KEEP,g.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=r,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new as(r.map),this._pendingGroundEffectLayers=[]}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),this._style=t,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(t,r,s){if(t&&t.terrain){this._style!==t&&(this.style=t,this._evaluationZoom=void 0);const c=t.terrain.properties,d=0===t.terrain.drapeRenderMode,f=t.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=Mn.now();const g=t.terrain&&t.terrain.scope,y=c.get("source"),b=d?this._mockSourceCache:t.getSourceCache(y,g);if(!b)return void gt(`Couldn't find terrain source "${y}".`);if(this.sourceCache=b,this._exaggeration=f?this.calculateExaggeration(r):c.get("exaggeration"),!r.projection.requiresDraping&&f&&0===this._exaggeration)return void this._disable();this.enabled=!0;const C=()=>{this.sourceCache.used&&gt(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const P=this.getScaledDemTileSize();this.sourceCache.update(r,P,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,C(),this._initializing=!0),C(),r.updateElevation(!0,s),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(r),this._emptyDEMTextureDirty=!0,this._previousZoom=r.zoom}else this._disable()}calculateExaggeration(t){const r=this._previousCameraAltitude,s=t.getFreeCameraOptions().position.z/t.pixelsPerMeter*t.worldSize;this._previousCameraAltitude=s;const c=null!=r?s-r:Number.MAX_VALUE;if(Math.abs(c)<2)return this._exaggeration;const d=t.zoom,f=this._style.terrain;if(!this._previousUpdateTimestamp)return f.getExaggeration(d);let g=d-this._previousZoom;const y=this._previousUpdateTimestamp;let b=d;null!=this._evaluationZoom&&(b=this._evaluationZoom,Math.abs(d-b)>.5&&(g=.5*(d-b+g)),g*c<0&&(b+=g)),this._evaluationZoom=b;const C=f.getExaggeration(b),P=C===f.getExaggeration(Math.max(0,b-.1));if(P&&Math.abs(C-this._exaggeration)<.01)return C;let E=Math.min(.1,.00375*(this._updateTimestamp-y));return(P||C<.1||Math.abs(g)<1e-4)&&(E=Math.min(.2,4*E)),vn(this._exaggeration,C,E)}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._mergedSourceCaches)this._style._mergedSourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const r=this.proxySourceCache,s=this.painter.transform;this._initializing&&(this._initializing=0===s._centerAltitude&&-1===this.getAtPointOrZero(Xn.fromLngLat(s.center),-1),this._emptyDEMTextureDirty=!this._initializing);const c=this.proxyCoords=r.getIds().map(y=>{const b=r.getTileByID(y).tileID;return b.projMatrix=s.calculateProjMatrix(b.toUnwrapped()),b});!function(y,b){const C=b.transform.pointCoordinate(b.transform.getCameraPoint()),P=new tt(C.x,C.y);y.sort((E,I)=>{if(I.overscaledZ-E.overscaledZ)return I.overscaledZ-E.overscaledZ;const A=new tt(E.canonical.x+(1<<E.canonical.z)*E.wrap,E.canonical.y),l=new tt(I.canonical.x+(1<<I.canonical.z)*I.wrap,I.canonical.y),u=P.mult(1<<E.canonical.z);return u.x-=.5,u.y-=.5,u.distSqr(A)-u.distSqr(l)})}(c,this.painter);const d=this.proxyToSource||{};this.proxyToSource={},c.forEach(y=>{this.proxyToSource[y.key]={}}),this.terrainTileForTile={};const f=this._style._mergedSourceCaches;for(const y in f){const b=f[y];if(!b.used||(b!==this.sourceCache&&this.resetTileLookupCache(b.id),this._setupProxiedCoordsForOrtho(b,t[y],d),b.usedForTerrain))continue;const C=t[y];b.getSource().reparseOverscaled&&this._assignTerrainTiles(C)}this.proxiedCoords[r.id]=c.map(y=>new tu(y,y.key,this.orthoMatrix)),this._assignTerrainTiles(c),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(d),this.renderingToTexture=!1;const g={};this._visibleDemTiles=[];for(const y of this.proxyCoords){const b=this.terrainTileForTile[y.key];if(!b)continue;const C=b.tileID.key;C in g||(this._visibleDemTiles.push(b),g[C]=C)}}_assignTerrainTiles(t){this._initializing||t.forEach(r=>{if(this.terrainTileForTile[r.key])return;const s=this._findTileCoveringTileID(r,this.sourceCache);s&&(this.terrainTileForTile[r.key]=s)})}_prepareDEMTextures(){const t=this.painter.context,r=t.gl;for(const s in this.terrainTileForTile){const c=this.terrainTileForTile[s],d=c.dem;!d||c.demTexture&&!c.needsDEMTextureUpload||(t.activeTexture.set(r.TEXTURE1),o2(this.painter,c,d))}}_prepareDemTileUniforms(t,r,s,c){if(!r||null==r.demTexture)return!1;const d=t.tileID.canonical,f=Math.pow(2,r.tileID.canonical.z-d.z),g=c||"";return s[`u_dem_tl${g}`]=[d.x*f%1,d.y*f%1],s[`u_dem_scale${g}`]=f,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,r=t.gl;if(!this._emptyDepthBufferTexture){const s=new Ui({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new xo(t,s,r.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const r=this._visibleDemTiles.reduce((s,c)=>{if(!c.dem)return s;const d=c.dem.tree.minimums[0];return d>0&&t++,s+d},0);return t?r/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,r=t.gl;t.activeTexture.set(r.TEXTURE2);const s=this._getLoadedAreaMinimum(),[c,d]=(()=>{const g=new TT({width:1,height:1},new Float32Array([s]));return[r.R32F,g]})();this._emptyDEMTextureDirty=!1;let f=this._emptyDEMTexture;return f?f.update(d,{premultiply:!1}):f=this._emptyDEMTexture=new xo(t,d,c,{premultiply:!1}),f}setupElevationDraw(t,r,s){const c=this.painter.context,d=c.gl,f={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0};f.u_exaggeration=this.exaggeration();let g=null,y=null,b=1;if(s&&s.morphing&&this._useVertexMorphing){const E=s.morphing.srcDemTile,I=s.morphing.dstDemTile;b=s.morphing.phase,E&&I&&(this._prepareDemTileUniforms(t,E,f,"_prev")&&(y=E),this._prepareDemTileUniforms(t,I,f)&&(g=I))}const C=E=>E&&E.demTexture&&this.painter.linearFloatFilteringSupported()?d.LINEAR:d.NEAREST,P=E=>{f.u_dem_size=1===E.size[0]?1:E.size[0]-2};if(y&&g)c.activeTexture.set(d.TEXTURE2),g.demTexture.bind(C(g),d.CLAMP_TO_EDGE),c.activeTexture.set(d.TEXTURE4),y.demTexture.bind(C(y),d.CLAMP_TO_EDGE),g.demTexture&&P(g.demTexture),f.u_dem_lerp=b;else{g=this.terrainTileForTile[t.tileID.key],c.activeTexture.set(d.TEXTURE2);const E=this._prepareDemTileUniforms(t,g,f)?g.demTexture:this.emptyDEMTexture;E.bind(C(g),d.CLAMP_TO_EDGE),P(E)}if(c.activeTexture.set(d.TEXTURE3),s&&s.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(d.NEAREST,d.CLAMP_TO_EDGE),this._depthFBO&&(f.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(d.NEAREST,d.CLAMP_TO_EDGE),f.u_depth_size_inv=[1,1]),s&&s.useMeterToDem&&g){const E=(1<<g.tileID.canonical.z)*oo(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;f.u_meter_to_dem=E}if(s&&s.labelPlaneMatrixInv&&(f.u_label_plane_matrix_inv=s.labelPlaneMatrixInv),r.setTerrainUniformValues(c,f),"globe"===this.painter.transform.projection.name){const E=this.globeUniformValues(this.painter.transform,t.tileID.canonical,s&&s.useDenormalizedUpVectorScale);r.setGlobeUniformValues(c,E)}}globeUniformValues(t,r,s){const c=t.projection;return{u_tile_tl_up:c.upVector(r,0,0),u_tile_tr_up:c.upVector(r,Dt,0),u_tile_br_up:c.upVector(r,Dt,Dt),u_tile_bl_up:c.upVector(r,0,Dt),u_tile_up_scale:s?i1(1):c.upVectorScale(r,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const r=this.painter,s=this.painter.context;0!==t.length&&(s.bindFramebuffer.set(null),s.viewport.set([0,0,r.width,r.height]),r.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(c,d,f,g,y){if("globe"===c.transform.projection.name)!function(b,C,P,E,I){const A=b.context,l=A.gl;let u,p;const m=b.transform,v=m0(b,A,m),M=(X,K)=>{if(p===K)return;const J=[wo[K],"PROJECTION_GLOBE_VIEW"];v&&J.push("CUSTOM_ANTIALIASING");const st=b.isTileAffectedByFog(X);u=b.getOrCreateProgram("globeRaster",{defines:J,overrideFog:st}),p=K},O=b.colorModeForRenderPass(),T=new Pn(l.LEQUAL,Pn.ReadWrite,b.depthRangeFor3D);fh.update(I);const k=u1(m),N=[yi(m.center.lng),Oo(m.center.lat)],F=b.globeSharedBuffers,$=[m.width*Mn.devicePixelRatio,m.height*Mn.devicePixelRatio],q=Float32Array.from(m.globeMatrix),Z={useDenormalizedUpVectorScale:!0};{const X=b.transform,K=Hx(X.zoom,C.exaggeration(),C.sourceCache._source.tileSize);p=-1;const J=l.TRIANGLES;for(const st of E){const it=P.getTile(st),rt=Gn.disabled,ct=C.prevTerrainTileForTile[st.key],yt=C.terrainTileForTile[st.key];Gx(ct,yt)&&fh.newMorphing(st.key,ct,yt,I,250),A.activeTexture.set(l.TEXTURE0),it.texture&&it.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE);const Et=fh.getMorphValuesForProxy(st.key),Tt=Et?1:0;Et&&Zs(Z,{morphing:{srcDemTile:Et.from,dstDemTile:Et.to,phase:Vo(Et.phase)}});const zt=g0(st.canonical),Nt=kP(zt.getCenter().lat),$t=_0(st.canonical,zt,Nt,X.worldSize/X._pixelsPerMercatorPixel),Rt=lf(Po(st.canonical)),oe=fE(X.expandedFarZProjMatrix,q,k,Rt,Pi(X.zoom),N,X.frustumCorners.TL,X.frustumCorners.TR,X.frustumCorners.BR,X.frustumCorners.BL,X.globeCenterInViewSpace,X.globeRadius,$,K,$t);if(M(st,Tt),u&&(C.setupElevationDraw(it,u,Z),b.uploadCommonUniforms(A,u,st.toUnwrapped()),F)){const[Oe,Ee,Be]=F.getGridBuffers(Nt,0!==K);u.draw(b,J,T,rt,O,Jn.backCCW,oe,"globe_raster",Oe,Ee,Be)}}}if(F&&(b.renderDefaultNorthPole||b.renderDefaultSouthPole)){const X=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];v&&X.push("CUSTOM_ANTIALIASING"),u=b.getOrCreateProgram("globeRaster",{defines:X});for(const K of E){const{x:J,y:st,z:it}=K.canonical,rt=0===st,ct=st===(1<<it)-1,[yt,Et,Tt,zt]=F.getPoleBuffers(it,!1);if(zt&&(rt||ct)){const Nt=P.getTile(K);A.activeTexture.set(l.TEXTURE0),Nt.texture&&Nt.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE);let $t=DP(it,J,m);const Rt=lf(Po(K.canonical)),oe=(Oe,Ee)=>Oe.draw(b,l.TRIANGLES,T,Gn.disabled,O,Jn.disabled,fE(m.expandedFarZProjMatrix,$t,$t,Rt,0,N,m.frustumCorners.TL,m.frustumCorners.TR,m.frustumCorners.BR,m.frustumCorners.BL,m.globeCenterInViewSpace,m.globeRadius,$,0),"globe_pole_raster",Ee,Tt,zt);C.setupElevationDraw(Nt,u,Z),b.uploadCommonUniforms(A,u,K.toUnwrapped()),rt&&b.renderDefaultNorthPole&&oe(u,yt),ct&&b.renderDefaultSouthPole&&($t=bt.scale(bt.create(),$t,[1,-1,1]),oe(u,Et))}}}}(c,d,f,g,y);else{const b=c.context,C=b.gl;let P,E;const I=c.shadowRenderer,A=Tm(c,c.longestCutoffRange),l=O=>{if(E===O)return;const T=[];T.push(wo[O]),A.shouldRenderCutoff&&T.push("RENDER_CUTOFF"),P=c.getOrCreateProgram("terrainRaster",{defines:T}),E=O},u=c.colorModeForRenderPass(),p=new Pn(C.LEQUAL,Pn.ReadWrite,c.depthRangeFor3D);fh.update(y);const m=c.transform,v=Hx(m.zoom,d.exaggeration(),d.sourceCache._source.tileSize);let M=[0,0,0];if(I){const O=c.style.directionalLight,T=c.style.ambientLight;O&&T&&(M=wM(O,T))}{E=-1;const O=C.TRIANGLES,[T,k]=[d.gridIndexBuffer,d.gridSegments];for(const N of g){const F=f.getTile(N),$=Gn.disabled,q=d.prevTerrainTileForTile[N.key],Z=d.terrainTileForTile[N.key];Gx(q,Z)&&fh.newMorphing(N.key,q,Z,y,250),b.activeTexture.set(C.TEXTURE0),F.texture&&F.texture.bind(C.LINEAR,C.CLAMP_TO_EDGE);const X=fh.getMorphValuesForProxy(N.key),K=X?1:0;let J;X&&(J={morphing:{srcDemTile:X.from,dstDemTile:X.to,phase:Vo(X.phase)}});const st=$x(N.projMatrix,aM(N.canonical,m.renderWorldCopies)?v/10:v,M);if(l(K),!P)continue;d.setupElevationDraw(F,P,J);const it=N.toUnwrapped();I&&I.setupShadows(it,P),c.uploadCommonUniforms(b,P,it,null,A),P.draw(c,O,p,$,u,Jn.backCCW,st,"terrain_raster",d.gridBuffer,T,k)}}}}(r,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,r.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;const r=this.painter,s=this.painter.context,c=this.proxySourceCache,d=this.proxiedCoords[c.id],f=this._drapedRenderBatches.shift(),g=r.style.order,y=[];let b=0;for(const C of d){const P=c.getTileByID(C.proxyTileKey),E=c.proxyCachedFBO[C.key]?c.proxyCachedFBO[C.key][t]:void 0,I=void 0!==E?c.renderCache[E]:this.pool[b++],A=void 0!==E;if(P.texture=I.tex,A&&!I.dirty){y.push(P.tileID);continue}let l;s.bindFramebuffer.set(I.fb.framebuffer),this.renderedToTile=!1,I.dirty&&(s.clear({color:bn.transparent,stencil:0}),I.dirty=!1);for(let u=f.start;u<=f.end;++u){const p=r.style._mergedLayers[g[u]];if(p.isHidden(r.transform.zoom))continue;const m=r.style.getLayerSourceCache(p),v=m?this.proxyToSource[C.key][m.id]:[C];if(!v)continue;const M=v;s.viewport.set([0,0,I.fb.width,I.fb.height]),l!==(m?m.id:null)&&(this._setupStencil(I,v,p,m),l=m?m.id:null),r.renderLayer(r,m,p,M)}if(0===this._drapedRenderBatches.length)for(const u of this._pendingGroundEffectLayers){const p=r.style._mergedLayers[g[u]];if(p.isHidden(r.transform.zoom))continue;const m=r.style.getLayerSourceCache(p),v=m?this.proxyToSource[C.key][m.id]:[C];if(!v)continue;const M=v;s.viewport.set([0,0,I.fb.width,I.fb.height]),l!==(m?m.id:null)&&(this._setupStencil(I,v,p,m),l=m?m.id:null),r.renderLayer(r,m,p,M)}this.renderedToTile?(I.dirty=!0,y.push(P.tileID)):A||--b,5===b&&(b=0,this.renderToBackBuffer(y))}return this.renderToBackBuffer(y),this.renderingToTexture=!1,s.bindFramebuffer.set(null),s.viewport.set([0,0,r.width,r.height]),f.end+1}postRender(){}isLayerOrderingCorrect(t){const r=t.order.length;let s=-1,c=r;for(let d=0;d<r;++d)this._style.isLayerDraped(t._mergedLayers[t.order[d]])?s=Math.max(s,d):c=Math.min(c,d);return c>s}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(r=>r.dem).forEach(r=>{t=Math.min(t,r.dem.tree.minimums[0])}),0===t?t:(t-30)*this._exaggeration}raycast(t,r,s){if(!this._visibleDemTiles)return null;const c=this._visibleDemTiles.filter(d=>d.dem).map(d=>{const f=d.tileID,g=1<<f.overscaledZ,{x:y,y:b}=f.canonical,C=y/g,P=(y+1)/g,E=b/g,I=(b+1)/g;return{minx:C,miny:E,maxx:P,maxy:I,t:d.dem.tree.raycastRoot(C,E,P,I,t,r,s),tile:d}});c.sort((d,f)=>(null!==d.t?d.t:Number.MAX_VALUE)-(null!==f.t?f.t:Number.MAX_VALUE));for(const d of c){if(null==d.t)return null;const f=d.tile.dem.tree.raycast(d.minx,d.miny,d.maxx,d.maxy,t,r,s);if(null!=f)return f}return null}_createFBO(){const t=this.painter.context,r=t.gl,s=this.drapeBufferSize;t.activeTexture.set(r.TEXTURE0);const c=new xo(t,{width:s[0],height:s[1],data:null},r.RGBA);c.bind(r.LINEAR,r.CLAMP_TO_EDGE);const d=t.createFramebuffer(s[0],s[1],!0,null);return d.colorAttachment.set(c.texture),d.depthAttachment=new Hp(t,d.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,s[0],s[1]),this._stencilRef=0,d.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):d.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&r.texParameterf(r.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:d,tex:c,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.hasLightTransitions())return!0;for(const t in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const r=this._style._mergedLayers[t],s=r.isHidden(this.painter.transform.zoom);return"custom"===r.type?!s&&r.shouldRedrape():!s&&r.hasTransition()})}_clearLineLayersFromRenderCache(){let t=!1;for(const s of this._style.getSources())if(s instanceof Mx){t=!0;break}if(!t)return;const r={};for(let s=0;s<this._style.order.length;++s){const c=this._style._mergedLayers[this._style.order[s]],d=this._style.getLayerSourceCache(c);if(d&&!r[d.id]&&!c.isHidden(this.painter.transform.zoom)&&"line"===c.type&&c.widthExpression()instanceof Es){r[d.id]=!0;for(const f of this.proxyCoords){const g=this.proxyToSource[f.key][d.id];if(g)for(const y of g)this._clearRenderCacheForTile(d.id,y)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s]._source instanceof Px){t=!0;break}if(!t)return;const r={};for(let s=0;s<this._style.order.length;++s){const c=this._style._mergedLayers[this._style.order[s]],d=this._style.getLayerSourceCache(c);if(!d||r[d.id]||c.isHidden(this.painter.transform.zoom)||"raster"!==c.type)continue;const f=c.paint.get("raster-fade-duration");for(const g of this.proxyCoords){const y=this.proxyToSource[g.key][d.id];if(y)for(const b of y){const C=pE(d.getTile(b),d.findLoadedParent(b,0),d,this.painter.transform,f);(1!==C.opacity||0!==C.mix)&&this._clearRenderCacheForTile(d.id,b)}}}}_setupDrapedRenderBatches(){const t=this._style.order,r=t.length;if(0===r)return;const s=[];this._pendingGroundEffectLayers=[];let c,d=0,f=this._style._mergedLayers[t[d]];for(;!this._style.isLayerDraped(f)&&f.isHidden(this.painter.transform.zoom)&&++d<r;)f=this._style._mergedLayers[t[d]];for(;d<r;++d){const g=this._style._mergedLayers[t[d]];g.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(g)?void 0===c&&(c=d):("fill-extrusion"===g.type&&this._pendingGroundEffectLayers.push(d),void 0!==c&&(s.push({start:c,end:d-1}),c=void 0)))}if(void 0!==c&&s.push({start:c,end:d-1}),0!==s.length){const g=s[s.length-1];this._pendingGroundEffectLayers.every(b=>b>g.end)||gt("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=s}_setupRenderCache(t){const r=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,r.renderCache.length>r.renderCachePool.length){const f=Object.values(r.proxyCachedFBO);r.proxyCachedFBO={};for(let g=0;g<f.length;++g){const y=Object.values(f[g]);r.renderCachePool.push(...y)}}return}this._clearRasterLayersFromRenderCache();const s=this.proxyCoords,c=this._tilesDirty;for(let f=s.length-1;f>=0;f--){const g=s[f];if(r.getTileByID(g.key),void 0!==r.proxyCachedFBO[g.key]){const y=t[g.key],b=this.proxyToSource[g.key];let C=0;for(const P in b){const E=b[P],I=y[P];if(!I||I.length!==E.length||E.some((A,l)=>A!==I[l]||c[P]&&c[P].hasOwnProperty(A.key))){C=-1;break}++C}for(const P in r.proxyCachedFBO[g.key])r.renderCache[r.proxyCachedFBO[g.key][P]].dirty=C<0||C!==Object.values(y).length}}const d=[...this._drapedRenderBatches];d.sort((f,g)=>g.end-g.start-(f.end-f.start));for(const f of d)for(const g of s){if(r.proxyCachedFBO[g.key])continue;let y=r.renderCachePool.pop();void 0===y&&r.renderCache.length<50&&(y=r.renderCache.length,r.renderCache.push(this._createFBO())),void 0!==y&&(r.proxyCachedFBO[g.key]={},r.proxyCachedFBO[g.key][f.start]=y,r.renderCache[y].dirty=!0)}this._tilesDirty={}}_setupStencil(t,r,s,c){if(!c||!this._sourceTilesOverlap[c.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const d=this.painter.context,f=d.gl;if(r.length<=1)return void(this._overlapStencilType=!1);let g;if(s.isTileClipped())g=r.length,this._overlapStencilMode.test={func:f.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(r[0].overscaledZ>r[r.length-1].overscaledZ))return void(this._overlapStencilType=!1);g=1,this._overlapStencilMode.test={func:f.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+g>255&&(d.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=g,this._overlapStencilMode.ref=this._stencilRef,s.isTileClipped()&&this._renderTileClippingMasks(r,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):Gn.disabled}_renderTileClippingMasks(t,r){const s=this.painter,c=this.painter.context,d=c.gl;s._tileClippingMaskIDs={},c.setColorMode(Sr.disabled),c.setDepthMode(Pn.disabled);const f=s.getOrCreateProgram("clippingMask");for(const g of t){const y=s._tileClippingMaskIDs[g.key]=--r;f.draw(s,d.TRIANGLES,Pn.disabled,new Gn({func:d.ALWAYS,mask:0},y,255,d.KEEP,d.KEEP,d.REPLACE),Sr.disabled,Jn.disabled,Im(g.projMatrix),"$clipping",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments)}}pointCoordinate(t){const r=this.painter.transform;if(t.x<0||t.x>r.width||t.y<0||t.y>r.height)return null;const s=[t.x,t.y,1,1];kr.transformMat4(s,s,r.pixelMatrixInverse),kr.scale(s,s,1/s[3]),s[0]/=r.worldSize,s[1]/=r.worldSize;const c=r._camera.position,d=oo(1,r.center.lat),f=[c[0],c[1],c[2]/d,0],g=dt.subtract([],s.slice(0,3),f);dt.normalize(g,g);const y=this.raycast(f,g,this._exaggeration);return null!==y&&y?(dt.scaleAndAdd(f,f,g,y),f[3]=f[2],f[2]*=d,f):null}drawDepth(){const t=this.painter,r=t.context,s=this.proxySourceCache,c=Math.ceil(t.width),d=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===c&&this._depthFBO.height===d||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const f=r.gl,g=r.createFramebuffer(c,d,!0,"renderbuffer");r.activeTexture.set(f.TEXTURE0);const y=new xo(r,{width:c,height:d,data:null},f.RGBA);y.bind(f.NEAREST,f.CLAMP_TO_EDGE),g.colorAttachment.set(y.texture);const b=r.createRenderbuffer(r.gl.DEPTH_COMPONENT16,c,d);g.depthAttachment.set(b),this._depthFBO=g,this._depthTexture=y}r.bindFramebuffer.set(this._depthFBO.framebuffer),r.viewport.set([0,0,c,d]),function(f,g,y,b){if("globe"===f.transform.projection.name)return;const C=f.context,P=C.gl;C.clear({depth:1});const E=f.getOrCreateProgram("terrainDepth"),I=new Pn(P.LESS,Pn.ReadWrite,f.depthRangeFor3D);for(const A of b){const l=y.getTile(A),u=$x(A.projMatrix,0,[0,0,0]);g.setupElevationDraw(l,E),E.draw(f,P.TRIANGLES,I,Gn.disabled,Sr.unblended,Jn.backCCW,u,"terrain_depth",g.gridBuffer,g.gridIndexBuffer,g.gridNoSkirtSegments)}}(t,this,s,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,r,s){if(t.getSource()instanceof Qc)return this._setupProxiedCoordsForImageSource(t,r,s);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const c=this.proxiedCoords[t.id]=[],d=this.proxyCoords;for(let g=0;g<d.length;g++){const y=d[g],b=this._findTileCoveringTileID(y,t);if(b){const C=this._createProxiedId(y,b,s[y.key]&&s[y.key][t.id]);c.push(C),this.proxyToSource[y.key][t.id]=[C]}}let f=!1;for(let g=0;g<r.length;g++){const y=t.getTile(r[g]);if(!y||!y.hasData())continue;const b=this._findTileCoveringTileID(y.tileID,this.proxySourceCache);if(b&&b.tileID.canonical.z!==y.tileID.canonical.z){const C=this.proxyToSource[b.tileID.key][t.id],P=this._createProxiedId(b.tileID,y,s[b.tileID.key]&&s[b.tileID.key][t.id]);C?C.splice(C.length-1,0,P):this.proxyToSource[b.tileID.key][t.id]=[P],c.push(P),f=!0}}this._sourceTilesOverlap[t.id]=f}_setupProxiedCoordsForImageSource(t,r,s){if(!t.getSource().loaded())return;const c=this.proxiedCoords[t.id]=[],d=this.proxyCoords,f=t.getSource(),g=f.tileID;if(!g)return;const y=new tt(g.x,g.y)._div(1<<g.z),b=f.coordinates.map(Xn.fromLngLat).reduce((P,E)=>(P.min.x=Math.min(P.min.x,E.x-y.x),P.min.y=Math.min(P.min.y,E.y-y.y),P.max.x=Math.max(P.max.x,E.x-y.x),P.max.y=Math.max(P.max.y,E.y-y.y),P),{min:new tt(Number.MAX_VALUE,Number.MAX_VALUE),max:new tt(-Number.MAX_VALUE,-Number.MAX_VALUE)}),C=(P,E)=>{const I=P.wrap+P.canonical.x/(1<<P.canonical.z),A=P.canonical.y/(1<<P.canonical.z),l=Dt/(1<<P.canonical.z),u=E.wrap+E.canonical.x/(1<<E.canonical.z),p=E.canonical.y/(1<<E.canonical.z);return I+l<u+b.min.x||I>u+b.max.x||A+l<p+b.min.y||A>p+b.max.y};for(let P=0;P<d.length;P++){const E=d[P];for(let I=0;I<r.length;I++){const A=t.getTile(r[I]);if(!A||!A.hasData()||C(E,A.tileID))continue;const l=this._createProxiedId(E,A,s[E.key]&&s[E.key][t.id]),u=this.proxyToSource[E.key][t.id];u?u.push(l):this.proxyToSource[E.key][t.id]=[l],c.push(l)}}}_createProxiedId(t,r,s){let c=this.orthoMatrix;if(s){const d=s.find(f=>f.key===r.tileID.key);if(d)return d}if(r.tileID.key!==t.key){const d=t.canonical.z-r.tileID.canonical.z;let f,g,y;c=bt.create();const b=r.tileID.wrap-t.wrap<<t.overscaledZ;d>0?(f=Dt>>d,g=f*((r.tileID.canonical.x<<d)-t.canonical.x+b),y=f*((r.tileID.canonical.y<<d)-t.canonical.y)):(f=Dt<<-d,g=Dt*(r.tileID.canonical.x-(t.canonical.x+b<<-d)),y=Dt*(r.tileID.canonical.y-(t.canonical.y<<-d))),bt.ortho(c,0,f,0,f,0,1),bt.translate(c,c,[g,y,0])}return new tu(r.tileID,t.key,c)}_findTileCoveringTileID(t,r){let s=r.getTile(t);if(s&&s.hasData())return s;const c=this._findCoveringTileCache[r.id],d=c[t.key];if(s=d?r.getTileByID(d):null,s&&s.hasData()||null===d)return s;let f=s?s.tileID:t,g=f.overscaledZ;const y=r.getSource().minzoom,b=[];if(!d){const P=r.getSource().maxzoom;if(t.canonical.z>=P){const E=t.canonical.z-P;r.getSource().reparseOverscaled?(g=Math.max(t.canonical.z+2,r.transform.tileZoom),f=new Ir(g,t.wrap,P,t.canonical.x>>E,t.canonical.y>>E)):0!==E&&(g=P,f=new Ir(g,t.wrap,P,t.canonical.x>>E,t.canonical.y>>E))}f.key!==t.key&&(b.push(f.key),s=r.getTile(f))}const C=P=>{b.forEach(E=>{c[E]=P}),b.length=0};for(g-=1;g>=y&&(!s||!s.hasData());g--){s&&C(s.tileID.key);const P=f.calculateScaledKey(g);if(s=r.getTileByID(P),s&&s.hasData())break;const E=c[P];if(null===E)break;void 0===E?b.push(P):s=r.getTileByID(E)}return C(s?s.tileID.key:null),s&&s.hasData()?s:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,r){let s=this._tilesDirty[t];s||(s=this._tilesDirty[t]={}),s[r.key]=!0}}function i2(e,t,r){const s=function(g,y,b){const C=dt.dot(y,g),P=dt.dot(b,[.2126,.7152,.0722]),E=(A,l,u)=>(1-u)*A+u*l,I=E(1-.3*Math.min(P,1),1,Math.min(C+1,1));return E(.92,1,Math.asin(Ne(y[2],-1,1))/Math.PI+.5)*I}(e,[0,0,1],t),c=[0,0,0];dt.scale(c,r.slice(0,3),s);const d=[0,0,0];dt.scale(d,t.slice(0,3),e[2]);const f=[0,0,0];return dt.add(f,c,d),Xr(f)}const lM=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],BI=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class cM{static cacheKey(t,r,s,c){let d=`${r}${c?c.cacheKey:""}`;for(const f of s)t.usedDefines.includes(f)&&(d+=`/${f}`);return d}constructor(t,r,s,c,d,f){const g=t.gl;this.program=g.createProgram(),this.configuration=c,this.name=r,this.fixedDefines=[...f];const y=c?c.getBinderAttributes():[],b=(s.staticAttributes||[]).concat(y);let C=c?c.defines():[];C=C.concat(f.map(u=>`#define ${u}`));const P="#version 300 es\n";let E=P+C.concat("precision mediump float;",oM,n2.fragmentSource).join("\n");for(const u of s.fragmentIncludes)E+=`\n${Df[u]}`;E+=`\n${s.fragmentSource}`;let I=P+C.concat("precision highp float;",oM,n2.vertexSource).join("\n");for(const u of s.vertexIncludes)I+=`\n${Df[u]}`;I+=`\n${s.vertexSource}`;const A=g.createShader(g.FRAGMENT_SHADER);if(g.isContextLost())return void(this.failedToCreate=!0);g.shaderSource(A,E),g.compileShader(A),g.attachShader(this.program,A);const l=g.createShader(g.VERTEX_SHADER);if(g.isContextLost())this.failedToCreate=!0;else{g.shaderSource(l,I),g.compileShader(l),g.attachShader(this.program,l),this.attributes={},this.numAttributes=b.length;for(let u=0;u<this.numAttributes;u++)if(b[u]){const p=b[u].startsWith("a_")?b[u]:`a_${b[u]}`;g.bindAttribLocation(this.program,u,p),this.attributes[p]=u}g.linkProgram(this.program),g.deleteShader(l),g.deleteShader(A),this.fixedUniforms=d(t),this.binderUniforms=c?c.getUniforms(t):[],f.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new cr(u=t),u_dem_prev:new cr(u),u_dem_tl:new fr(u),u_dem_scale:new fe(u),u_dem_tl_prev:new fr(u),u_dem_scale_prev:new fe(u),u_dem_size:new fe(u),u_dem_lerp:new fe(u),u_exaggeration:new fe(u),u_depth:new cr(u),u_depth_size_inv:new fr(u),u_meter_to_dem:new fe(u),u_label_plane_matrix_inv:new Vn(u)}),f.includes("GLOBE")&&(this.globeUniforms=(u=>({u_tile_tl_up:new Kn(u),u_tile_tr_up:new Kn(u),u_tile_br_up:new Kn(u),u_tile_bl_up:new Kn(u),u_tile_up_scale:new fe(u)}))(t)),f.includes("FOG")&&(this.fogUniforms=(u=>({u_fog_matrix:new Vn(u),u_fog_range:new fr(u),u_fog_color:new oc(u),u_fog_horizon_blend:new fe(u),u_fog_vertical_limit:new fr(u),u_fog_temporal_offset:new fe(u),u_frustum_tl:new Kn(u),u_frustum_tr:new Kn(u),u_frustum_br:new Kn(u),u_frustum_bl:new Kn(u),u_globe_pos:new Kn(u),u_globe_radius:new fe(u),u_globe_transition:new fe(u),u_is_globe:new cr(u),u_viewport:new fr(u)}))(t)),f.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(u=>({u_cutoff_params:new oc(u)}))(t)),f.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(u=>({u_lighting_ambient_color:new Kn(u),u_lighting_directional_dir:new Kn(u),u_lighting_directional_color:new Kn(u),u_ground_radiance:new Kn(u)}))(t)),f.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(u=>({u_light_matrix_0:new Vn(u),u_light_matrix_1:new Vn(u),u_fade_range:new fr(u),u_shadow_normal_offset:new Kn(u),u_shadow_intensity:new fe(u),u_shadow_texel_size:new fe(u),u_shadow_map_resolution:new fe(u),u_shadow_direction:new Kn(u),u_shadow_bias:new Kn(u),u_shadowmap_0:new cr(u),u_shadowmap_1:new cr(u)}))(t))}var u}setTerrainUniformValues(t,r){if(!this.terrainUniforms)return;const s=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in r)s[c]&&s[c].set(this.program,c,r[c])}}setGlobeUniformValues(t,r){if(!this.globeUniforms)return;const s=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in r)s[c]&&s[c].set(this.program,c,r[c])}}setFogUniformValues(t,r){if(!this.fogUniforms)return;const s=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in r)s[c].set(this.program,c,r[c])}}setCutoffUniformValues(t,r){if(!this.cutoffUniforms)return;const s=this.cutoffUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in r)s[c].set(this.program,c,r[c])}}setLightsUniformValues(t,r){if(!this.lightsUniforms)return;const s=this.lightsUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const c in r)s[c].set(this.program,c,r[c])}}setShadowUniformValues(t,r){if(this.failedToCreate||!this.shadowUniforms)return;const s=this.shadowUniforms;t.program.set(this.program);for(const c in r)s[c].set(this.program,c,r[c])}_drawDebugWireframe(t,r,s,c,d,f,g,y,b,C){const P=t.options.wireframe;if(!1===P.terrain&&!1===P.layers2D&&!1===P.layers3D)return;const E=t.context;if(!(()=>!(!P.terrain||"terrainRaster"!==this.name&&"globeRaster"!==this.name)||!(!P.layers2D||t._terrain&&t._terrain.renderingToTexture||!lM.includes(this.name))||!(!P.layers3D||!BI.includes(this.name)))())return;const I=E.gl,A=t.wireframeDebugCache.getLinesFromTrianglesBuffer(t.frameCounter,d,E);if(!A)return;const l=[...this.fixedDefines];l.push("DEBUG_WIREFRAME");const u=t.getOrCreateProgram(this.name,{config:this.configuration,defines:l});E.program.set(u.program);const p=(M,O,T)=>{if(O[M]&&T[M])for(const k in O[M])T[M][k]&&T[M][k].set(T.program,k,O[M][k].current)};b&&b.setUniforms(u.program,E,u.binderUniforms,g,{zoom:y}),p("fixedUniforms",this,u),p("terrainUniforms",this,u),p("globeUniforms",this,u),p("fogUniforms",this,u),p("lightsUniforms",this,u),p("shadowUniforms",this,u),A.bind(),E.setColorMode(new Sr([I.ONE,I.ONE_MINUS_SRC_ALPHA,I.ZERO,I.ONE],bn.transparent,[!0,!0,!0,!1])),E.setDepthMode(new Pn(r.func===I.LESS?I.LEQUAL:r.func,Pn.ReadOnly,r.range)),E.setStencilMode(Gn.disabled);const m=3*f.primitiveLength*2,v=3*f.primitiveOffset*2*2;C&&C>1?I.drawElementsInstanced(I.LINES,m,I.UNSIGNED_SHORT,v,C):I.drawElements(I.LINES,m,I.UNSIGNED_SHORT,v),d.bind(),E.program.set(this.program),E.setDepthMode(r),E.setStencilMode(s),E.setColorMode(c)}draw(t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u){const p=t.context,m=p.gl;if(this.failedToCreate)return;p.program.set(this.program),p.setDepthMode(s),p.setStencilMode(c),p.setColorMode(d),p.setCullFace(f);for(const O of Object.keys(this.fixedUniforms))this.fixedUniforms[O].set(this.program,O,g[O]);A&&A.setUniforms(this.program,p,this.binderUniforms,E,{zoom:I});const v={[m.LINES]:2,[m.TRIANGLES]:3,[m.LINE_STRIP]:1}[r],M=u&&u>0?1:void 0;for(const O of P.get()){const T=O.vaos||(O.vaos={});(T[y]||(T[y]=new r2)).bind(p,this,b,A?A.getPaintVertexBuffers():[],C,O.vertexOffset,l||[],M),u&&u>1?m.drawElementsInstanced(r,O.primitiveLength*v,m.UNSIGNED_SHORT,O.primitiveOffset*v*2,u):m.drawElements(r,O.primitiveLength*v,m.UNSIGNED_SHORT,O.primitiveOffset*v*2),r===m.TRIANGLES&&this._drawDebugWireframe(t,s,c,d,C,O,E,I,A,u)}}}function s2(e,t){const r=Math.pow(2,t.tileID.overscaledZ),s=t.tileSize*Math.pow(2,e.transform.tileZoom)/r,c=s*(t.tileID.canonical.x+t.tileID.wrap*r),d=s*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/td(t,1,e.transform.tileZoom),u_pixel_coord_upper:[c>>16,d>>16],u_pixel_coord_lower:[65535&c,65535&d]}}const qx=bt.create(),a2=(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l)=>{const u=t.style.light,p=u.properties.get("position"),m=[p.x,p.y,p.z],v=al.create();"viewport"===u.properties.get("anchor")&&(al.fromRotation(v,-t.transform.angle),dt.transformMat3(m,m,v));const M=u.properties.get("color"),O=t.transform,T={u_matrix:e,u_lightpos:m,u_lightintensity:u.properties.get("intensity"),u_lightcolor:[M.r,M.g,M.b],u_vertical_gradient:+r,u_opacity:s,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:qx,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:c,u_edge_radius:d,u_flood_light_color:P,u_vertical_scale:E,u_flood_light_intensity:I,u_ground_shadow_factor:A,u_emissive_strength:l};return"globe"===O.projection.name&&(T.u_tile_id=[f.canonical.x,f.canonical.y,1<<f.canonical.z],T.u_zoom_transition=y,T.u_inv_rot_matrix=C,T.u_merc_center=b,T.u_up_dir=O.projection.upVector(new ic(0,0,0),b[0]*Dt,b[1]*Dt),T.u_height_lift=g),T},cA=(e,t,r)=>({u_matrix:e,u_edge_radius:t,u_vertical_scale:r}),ji=(e,t,r,s,c,d,f,g,y,b,C,P,E,I)=>{const A=a2(e,t,r,s,c,d,f,y,b,C,P,E,I,1,[0,0,0],0),l={u_height_factor:-Math.pow(2,f.overscaledZ)/g.tileSize/8};return _t(A,s2(t,g),l)},UI=(e,t)=>({u_matrix:e,u_emissive_strength:t}),l2=(e,t,r,s)=>_t(UI(e,t),s2(r,s)),Vs=(e,t,r)=>({u_matrix:e,u_world:r,u_emissive_strength:t}),c2=(e,t,r,s,c)=>_t(l2(e,t,r,s),{u_world:c}),uA=(e,t,r,s)=>{const c=Dt/r.tileSize;return{u_matrix:e,u_camera_to_center_distance:t.getCameraToCenterDistance(s),u_extrude_scale:[t.pixelsToGLUnits[0]/c,t.pixelsToGLUnits[1]/c]}},VI=(e,t,r=1)=>({u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:r}),uM=bt.create(),mE=(e,t,r,s,c,d,f)=>{const g=e.transform,y="globe"===g.projection.name,b=y?k_(g.zoom,t.canonical)*g._pixelsPerMercatorPixel:td(r,1,d),C={u_matrix:t.projMatrix,u_extrude_scale:b,u_intensity:f,u_inv_rot_matrix:uM,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(y){C.u_inv_rot_matrix=s,C.u_merc_center=c,C.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],C.u_zoom_transition=Pi(g.zoom);const P=c[0]*Dt,E=c[1]*Dt;C.u_up_dir=g.projection.upVector(new ic(0,0,0),P,E)}return C},_E=(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p,m,v,M,O)=>{return{u_matrix:e,u_normalize_matrix:t,u_globe_matrix:r,u_merc_matrix:s,u_grid_matrix:c,u_tl_parent:d,u_scale_parent:C,u_fade_t:P.mix,u_opacity:P.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(k=E.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(T=E.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:jI(E.paint.get("raster-hue-rotate")),u_perspective_transform:I,u_raster_elevation:A,u_tl_br:f,u_zoom_transition:g,u_merc_center:y,u_cutoff_params:b,u_colorization_mix:dM(u,m),u_colorization_offset:$I(p,m),u_color_ramp:l,u_texture_offset:[M/(v+2*M),v/(v+2*M)],u_texture_res:[v+2*M,v+2*M],u_emissive_strength:O};var T,k};function jI(e){e*=Math.PI/180;const t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}function dM([e,t,r,s],[c,d]){if(c===d)return[0,0,0,0];const f=259/257/(d-c);return[e*f,t*f,r*f,s*f]}function $I(e,[t,r]){return t===r?0:((e-t)/(r-t)*259-1)/257}const GI=bt.create(),HI=(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p)=>{const m=c.transform,v={u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:m.getCameraToCenterDistance(l),u_rotate_symbol:+r,u_aspect_ratio:m.width/m.height,u_fade_change:c.options.fadeDuration?c.symbolFadeChange:1,u_matrix:d,u_label_plane_matrix:f,u_coord_matrix:g,u_is_text:+y,u_pitch_with_map:+s,u_texsize:b,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:GI,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:GI,u_up_vector:[0,-1,0],u_icon_transition:p||0,u_icon_saturation:u};return"globe"===l.name&&(v.u_tile_id=[C.canonical.x,C.canonical.y,1<<C.canonical.z],v.u_zoom_transition=P,v.u_inv_rot_matrix=I,v.u_merc_center=E,v.u_camera_forward=m._camera.forward(),v.u_ecef_origin=function(M,O){const T=[0,0,0],k=lf(Po(O.canonical));return dt.transformMat4(T,T,k),dt.transformMat4(T,T,M),T}(m.globeMatrix,C.toUnwrapped()),v.u_tile_matrix=Float32Array.from(m.globeMatrix),v.u_up_vector=A),v},hM=(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u)=>_t(HI(e,t,r,s,c,d,f,g,y,b,P,E,I,A,l,u,1),{u_gamma_scale:s?c.transform.getCameraToCenterDistance(u)*Math.cos(c.terrain?0:c.transform._pitch):1,u_device_pixel_ratio:Mn.devicePixelRatio,u_is_halo:+C,undefined:void 0}),Ey=(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l)=>_t(hM(e,t,r,s,c,d,f,g,!0,y,!0,C,P,E,I,A,l),{u_texsize_icon:b,u_texture_icon:1}),u2=(e,t,r,s)=>({u_matrix:e,u_emissive_strength:t,u_opacity:r,u_color:s}),Sm=(e,t,r,s,c,d,f)=>_t(function(g,y,b,C){const P=b.imageManager.getPattern(g.toString(),y),{width:E,height:I}=b.imageManager.getPixelSize(y),A=Math.pow(2,C.tileID.overscaledZ),l=C.tileSize*Math.pow(2,b.transform.tileZoom)/A,u=l*(C.tileID.canonical.x+C.tileID.wrap*A),p=l*C.tileID.canonical.y;return{u_image:0,u_pattern_tl:P.tl,u_pattern_br:P.br,u_texsize:[E,I],u_pattern_size:P.displaySize,u_tile_units_to_pixels:1/td(C,1,b.transform.tileZoom),u_pixel_coord_upper:[u>>16,p>>16],u_pixel_coord_lower:[65535&u,65535&p]}}(c,d,s,f),{u_matrix:e,u_emissive_strength:t,u_opacity:r}),js={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},d2=(e,t,r,s,c,d,f,g,y,b,C,P,E=[0,0,0])=>{const I=s.style.light,A=I.properties.get("position"),l=[-A.x,-A.y,A.z],u=al.create();"viewport"===I.properties.get("anchor")&&(al.fromRotation(u,-s.transform.angle),dt.transformMat3(l,l,u));const p="MASK"===b.alphaMode,m=I.properties.get("color"),v=P.paint.get("model-ambient-occlusion-intensity"),M=P.paint.get("model-color").constantOr(bn.white),O=P.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:e,u_lighting_matrix:t,u_normal_matrix:r,u_lightpos:l,u_lightintensity:I.properties.get("intensity"),u_lightcolor:[m.r,m.g,m.b],u_camera_pos:E,u_opacity:c,u_baseTextureIsAlpha:0,u_alphaMask:+p,u_alphaCutoff:b.alphaCutoff,u_baseColorFactor:[d.r,d.g,d.b,d.a],u_emissiveFactor:[f[0],f[1],f[2],1],u_metallicFactor:g,u_roughnessFactor:y,u_baseColorTexture:js.BaseColor,u_metallicRoughnessTexture:js.MetallicRoughness,u_normalTexture:js.Normal,u_occlusionTexture:js.Occlusion,u_emissionTexture:js.Emission,u_color_mix:[M.r,M.g,M.b,O],u_aoIntensity:v,u_emissive_strength:C}},fM=new Float32Array(16),tg=(e,t=fM,r=fM)=>({u_matrix:e,u_instance:t,u_node_matrix:r}),Zx={fillExtrusion:e=>({u_matrix:new Vn(e),u_lightpos:new Kn(e),u_lightintensity:new fe(e),u_lightcolor:new Kn(e),u_vertical_gradient:new fe(e),u_opacity:new fe(e),u_edge_radius:new fe(e),u_ao:new fr(e),u_tile_id:new Kn(e),u_zoom_transition:new fe(e),u_inv_rot_matrix:new Vn(e),u_merc_center:new fr(e),u_up_dir:new Kn(e),u_height_lift:new fe(e),u_flood_light_color:new Kn(e),u_vertical_scale:new fe(e),u_flood_light_intensity:new fe(e),u_ground_shadow_factor:new Kn(e),u_emissive_strength:new fe(e)}),fillExtrusionDepth:e=>({u_matrix:new Vn(e),u_edge_radius:new fe(e),u_vertical_scale:new fe(e)}),fillExtrusionPattern:e=>({u_matrix:new Vn(e),u_lightpos:new Kn(e),u_lightintensity:new fe(e),u_lightcolor:new Kn(e),u_vertical_gradient:new fe(e),u_height_factor:new fe(e),u_edge_radius:new fe(e),u_ao:new fr(e),u_tile_id:new Kn(e),u_zoom_transition:new fe(e),u_inv_rot_matrix:new Vn(e),u_merc_center:new fr(e),u_up_dir:new Kn(e),u_height_lift:new fe(e),u_image:new cr(e),u_texsize:new fr(e),u_pixel_coord_upper:new fr(e),u_pixel_coord_lower:new fr(e),u_tile_units_to_pixels:new fe(e),u_opacity:new fe(e)}),fillExtrusionGroundEffect:e=>({u_matrix:new Vn(e),u_opacity:new fe(e),u_ao_pass:new fe(e),u_meter_to_tile:new fe(e),u_ao:new fr(e),u_flood_light_intensity:new fe(e),u_flood_light_color:new Kn(e),u_attenuation:new fe(e),u_edge_radius:new fe(e),u_fb:new cr(e),u_fb_size:new fe(e)}),fill:e=>({u_matrix:new Vn(e),u_emissive_strength:new fe(e)}),fillPattern:e=>({u_matrix:new Vn(e),u_emissive_strength:new fe(e),u_image:new cr(e),u_texsize:new fr(e),u_pixel_coord_upper:new fr(e),u_pixel_coord_lower:new fr(e),u_tile_units_to_pixels:new fe(e)}),fillOutline:e=>({u_matrix:new Vn(e),u_emissive_strength:new fe(e),u_world:new fr(e)}),fillOutlinePattern:e=>({u_matrix:new Vn(e),u_emissive_strength:new fe(e),u_world:new fr(e),u_image:new cr(e),u_texsize:new fr(e),u_pixel_coord_upper:new fr(e),u_pixel_coord_lower:new fr(e),u_tile_units_to_pixels:new fe(e)}),circle:e=>({u_camera_to_center_distance:new fe(e),u_extrude_scale:new Mb(e),u_device_pixel_ratio:new fe(e),u_matrix:new Vn(e),u_inv_rot_matrix:new Vn(e),u_merc_center:new fr(e),u_tile_id:new Kn(e),u_zoom_transition:new fe(e),u_up_dir:new Kn(e),u_emissive_strength:new fe(e)}),collisionBox:e=>({u_matrix:new Vn(e),u_camera_to_center_distance:new fe(e),u_extrude_scale:new fr(e)}),collisionCircle:e=>({u_matrix:new Vn(e),u_inv_matrix:new Vn(e),u_camera_to_center_distance:new fe(e),u_viewport_size:new fr(e)}),debug:e=>({u_color:new h_(e),u_matrix:new Vn(e),u_overlay:new cr(e),u_overlay_scale:new fe(e)}),clippingMask:e=>({u_matrix:new Vn(e)}),heatmap:e=>({u_extrude_scale:new fe(e),u_intensity:new fe(e),u_matrix:new Vn(e),u_inv_rot_matrix:new Vn(e),u_merc_center:new fr(e),u_tile_id:new Kn(e),u_zoom_transition:new fe(e),u_up_dir:new Kn(e)}),heatmapTexture:e=>({u_image:new cr(e),u_color_ramp:new cr(e),u_opacity:new fe(e)}),hillshade:e=>({u_matrix:new Vn(e),u_image:new cr(e),u_latrange:new fr(e),u_light:new fr(e),u_shadow:new h_(e),u_highlight:new h_(e),u_emissive_strength:new fe(e),u_accent:new h_(e)}),hillshadePrepare:e=>({u_matrix:new Vn(e),u_image:new cr(e),u_dimension:new fr(e),u_zoom:new fe(e)}),line:e=>({u_matrix:new Vn(e),u_pixels_to_tile_units:new Mb(e),u_device_pixel_ratio:new fe(e),u_units_to_pixels:new fr(e),u_dash_image:new cr(e),u_gradient_image:new cr(e),u_image_height:new fe(e),u_texsize:new fr(e),u_tile_units_to_pixels:new fe(e),u_alpha_discard_threshold:new fe(e),u_trim_offset:new fr(e),u_emissive_strength:new fe(e)}),linePattern:e=>({u_matrix:new Vn(e),u_texsize:new fr(e),u_pixels_to_tile_units:new Mb(e),u_device_pixel_ratio:new fe(e),u_image:new cr(e),u_units_to_pixels:new fr(e),u_tile_units_to_pixels:new fe(e),u_alpha_discard_threshold:new fe(e)}),raster:e=>({u_matrix:new Vn(e),u_normalize_matrix:new Vn(e),u_globe_matrix:new Vn(e),u_merc_matrix:new Vn(e),u_grid_matrix:new pP(e),u_tl_parent:new fr(e),u_scale_parent:new fe(e),u_fade_t:new fe(e),u_opacity:new fe(e),u_image0:new cr(e),u_image1:new cr(e),u_brightness_low:new fe(e),u_brightness_high:new fe(e),u_saturation_factor:new fe(e),u_contrast_factor:new fe(e),u_spin_weights:new Kn(e),u_perspective_transform:new fr(e),u_raster_elevation:new fe(e),u_tl_br:new oc(e),u_zoom_transition:new fe(e),u_merc_center:new fr(e),u_cutoff_params:new oc(e),u_colorization_mix:new oc(e),u_colorization_offset:new fe(e),u_color_ramp:new cr(e),u_texture_offset:new fr(e),u_texture_res:new fr(e),u_emissive_strength:new fe(e)}),symbolIcon:e=>({u_is_size_zoom_constant:new cr(e),u_is_size_feature_constant:new cr(e),u_size_t:new fe(e),u_size:new fe(e),u_camera_to_center_distance:new fe(e),u_rotate_symbol:new cr(e),u_aspect_ratio:new fe(e),u_fade_change:new fe(e),u_matrix:new Vn(e),u_label_plane_matrix:new Vn(e),u_coord_matrix:new Vn(e),u_is_text:new cr(e),u_pitch_with_map:new cr(e),u_texsize:new fr(e),u_tile_id:new Kn(e),u_zoom_transition:new fe(e),u_inv_rot_matrix:new Vn(e),u_merc_center:new fr(e),u_camera_forward:new Kn(e),u_tile_matrix:new Vn(e),u_up_vector:new Kn(e),u_ecef_origin:new Kn(e),u_texture:new cr(e),u_icon_transition:new fe(e),u_icon_saturation:new fe(e)}),symbolSDF:e=>({u_is_size_zoom_constant:new cr(e),u_is_size_feature_constant:new cr(e),u_size_t:new fe(e),u_size:new fe(e),u_camera_to_center_distance:new fe(e),u_rotate_symbol:new cr(e),u_aspect_ratio:new fe(e),u_fade_change:new fe(e),u_matrix:new Vn(e),u_label_plane_matrix:new Vn(e),u_coord_matrix:new Vn(e),u_is_text:new cr(e),u_pitch_with_map:new cr(e),u_texsize:new fr(e),u_texture:new cr(e),u_gamma_scale:new fe(e),u_device_pixel_ratio:new fe(e),u_tile_id:new Kn(e),u_zoom_transition:new fe(e),u_inv_rot_matrix:new Vn(e),u_merc_center:new fr(e),u_camera_forward:new Kn(e),u_tile_matrix:new Vn(e),u_up_vector:new Kn(e),u_ecef_origin:new Kn(e),u_is_halo:new cr(e)}),symbolTextAndIcon:e=>({u_is_size_zoom_constant:new cr(e),u_is_size_feature_constant:new cr(e),u_size_t:new fe(e),u_size:new fe(e),u_camera_to_center_distance:new fe(e),u_rotate_symbol:new cr(e),u_aspect_ratio:new fe(e),u_fade_change:new fe(e),u_matrix:new Vn(e),u_label_plane_matrix:new Vn(e),u_coord_matrix:new Vn(e),u_is_text:new cr(e),u_pitch_with_map:new cr(e),u_texsize:new fr(e),u_texsize_icon:new fr(e),u_texture:new cr(e),u_texture_icon:new cr(e),u_gamma_scale:new fe(e),u_device_pixel_ratio:new fe(e),u_is_halo:new cr(e)}),background:e=>({u_matrix:new Vn(e),u_emissive_strength:new fe(e),u_opacity:new fe(e),u_color:new h_(e)}),backgroundPattern:e=>({u_matrix:new Vn(e),u_emissive_strength:new fe(e),u_opacity:new fe(e),u_image:new cr(e),u_pattern_tl:new fr(e),u_pattern_br:new fr(e),u_texsize:new fr(e),u_pattern_size:new fr(e),u_pixel_coord_upper:new fr(e),u_pixel_coord_lower:new fr(e),u_tile_units_to_pixels:new fe(e)}),terrainRaster:hE,terrainDepth:hE,skybox:e=>({u_matrix:new Vn(e),u_sun_direction:new Kn(e),u_cubemap:new cr(e),u_opacity:new fe(e),u_temporal_offset:new fe(e)}),skyboxGradient:e=>({u_matrix:new Vn(e),u_color_ramp:new cr(e),u_center_direction:new Kn(e),u_radius:new fe(e),u_opacity:new fe(e),u_temporal_offset:new fe(e)}),skyboxCapture:e=>({u_matrix_3f:new pP(e),u_sun_direction:new Kn(e),u_sun_intensity:new fe(e),u_color_tint_r:new oc(e),u_color_tint_m:new oc(e),u_luminance:new fe(e)}),globeRaster:e=>({u_proj_matrix:new Vn(e),u_globe_matrix:new Vn(e),u_normalize_matrix:new Vn(e),u_merc_matrix:new Vn(e),u_zoom_transition:new fe(e),u_merc_center:new fr(e),u_image0:new cr(e),u_grid_matrix:new pP(e),u_skirt_height:new fe(e),u_frustum_tl:new Kn(e),u_frustum_tr:new Kn(e),u_frustum_br:new Kn(e),u_frustum_bl:new Kn(e),u_globe_pos:new Kn(e),u_globe_radius:new fe(e),u_viewport:new fr(e)}),globeAtmosphere:e=>({u_frustum_tl:new Kn(e),u_frustum_tr:new Kn(e),u_frustum_br:new Kn(e),u_frustum_bl:new Kn(e),u_horizon:new fe(e),u_transition:new fe(e),u_fadeout_range:new fe(e),u_color:new oc(e),u_high_color:new oc(e),u_space_color:new oc(e),u_temporal_offset:new fe(e),u_horizon_angle:new fe(e)}),model:e=>({u_matrix:new Vn(e),u_lighting_matrix:new Vn(e),u_normal_matrix:new Vn(e),u_lightpos:new Kn(e),u_lightintensity:new fe(e),u_lightcolor:new Kn(e),u_camera_pos:new Kn(e),u_opacity:new fe(e),u_baseColorFactor:new oc(e),u_emissiveFactor:new oc(e),u_metallicFactor:new fe(e),u_roughnessFactor:new fe(e),u_baseTextureIsAlpha:new cr(e),u_alphaMask:new cr(e),u_alphaCutoff:new fe(e),u_baseColorTexture:new cr(e),u_metallicRoughnessTexture:new cr(e),u_normalTexture:new cr(e),u_occlusionTexture:new cr(e),u_emissionTexture:new cr(e),u_color_mix:new oc(e),u_aoIntensity:new fe(e),u_emissive_strength:new fe(e)}),modelDepth:e=>({u_matrix:new Vn(e),u_instance:new Vn(e),u_node_matrix:new Vn(e)}),groundShadow:e=>({u_matrix:new Vn(e),u_ground_shadow_factor:new Kn(e)}),stars:e=>({u_matrix:new Vn(e),u_up:new Kn(e),u_right:new Kn(e),u_intensity_multiplier:new fe(e)})};let Wx;function pM(e,t,r,s,c,d,f){const g=e.context,y=g.gl,b=e.transform,C=e.getOrCreateProgram("collisionBox"),P=[];let E=0,I=0;for(let M=0;M<s.length;M++){const O=s[M],T=t.getTile(O),k=T.getBucket(r);if(!k)continue;const N=KC(O,k,b);let F=N;0===c[0]&&0===c[1]||(F=e.translatePosMatrix(N,T,c,d));const $=f?k.textCollisionBox:k.iconCollisionBox,q=k.collisionCircleArray;if(q.length>0){const Z=bt.create(),X=F;bt.mul(Z,k.placementInvProjMatrix,b.glCoordMatrix),bt.mul(Z,Z,k.placementViewportMatrix),P.push({circleArray:q,circleOffset:I,transform:X,invTransform:Z,projection:k.getProjection()}),E+=q.length/4,I=E}$&&(e.terrain&&e.terrain.setupElevationDraw(T,C),C.draw(e,y.LINES,Pn.disabled,Gn.disabled,e.colorModeForRenderPass(),Jn.disabled,uA(F,b,T,k.getProjection()),r.id,$.layoutVertexBuffer,$.indexBuffer,$.segments,null,b.zoom,null,[$.collisionVertexBuffer,$.collisionVertexBufferExt]))}if(!f||!P.length)return;const A=e.getOrCreateProgram("collisionCircle"),l=new yb;l.resize(4*E),l._trim();let u=0;for(const M of P)for(let O=0;O<M.circleArray.length/4;O++){const T=4*O,k=M.circleArray[T+0],N=M.circleArray[T+1],F=M.circleArray[T+2],$=M.circleArray[T+3];l.emplace(u++,k,N,F,$,0),l.emplace(u++,k,N,F,$,1),l.emplace(u++,k,N,F,$,2),l.emplace(u++,k,N,F,$,3)}(!Wx||Wx.length<2*E)&&(Wx=function(M){const O=2*M,T=new Mi;T.resize(O),T._trim();for(let k=0;k<O;k++){const N=6*k;T.uint16[N+0]=4*k+0,T.uint16[N+1]=4*k+1,T.uint16[N+2]=4*k+2,T.uint16[N+3]=4*k+2,T.uint16[N+4]=4*k+3,T.uint16[N+5]=4*k+0}return T}(E));const p=g.createIndexBuffer(Wx,!0),m=g.createVertexBuffer(l,Qw.members,!0);for(const M of P){const O={u_matrix:M.transform,u_inv_matrix:M.invTransform,u_camera_to_center_distance:(v=b).getCameraToCenterDistance(M.projection),u_viewport_size:[v.width,v.height]};A.draw(e,y.TRIANGLES,Pn.disabled,Gn.disabled,e.colorModeForRenderPass(),Jn.disabled,O,r.id,m,p,lo.simpleSegment(0,2*M.circleOffset,M.circleArray.length,M.circleArray.length/2),null,b.zoom)}var v;m.destroy(),p.destroy()}const gM=bt.create();function Kx({width:e,height:t,anchor:r,textOffset:s,textScale:c},d){const{horizontalAlign:f,verticalAlign:g}=U0(r),y=-(f-.5)*e,b=-(g-.5)*t,C=em(r,s);return new tt((y/c+C[0])*d,(b/c+C[1])*d)}function h2(e,t,r,s,c,d,f,g,y,b,C){const P=e.text.placedSymbolArray,E=e.text.dynamicLayoutVertexArray,I=e.icon.dynamicLayoutVertexArray,A={},l=e.getProjection(),u=zv(g,l,d),p=d.elevation,m=l.upVectorScale(g.canonical,d.center.lat,d.worldSize).metersToTile;E.clear();for(let v=0;v<P.length;v++){const M=P.get(v),{tileAnchorX:O,tileAnchorY:T,numGlyphs:k}=M,N=M.hidden||!M.crossTileID||e.allowVerticalPlacement&&!M.placedOrientation?null:s[M.crossTileID];if(N){let F=0,$=0,q=0;if(p){const yt=p?p.getAtTileOffset(g,O,T):0,[Et,Tt,zt]=l.upVector(g.canonical,O,T);F=yt*Et*m,$=yt*Tt*m,q=yt*zt*m}let[Z,X,K,J]=mc(M.projectedAnchorX+F,M.projectedAnchorY+$,M.projectedAnchorZ+q,r?u:f);const st=Q1(d.getCameraToCenterDistance(l),J);let it=c.evaluateSizeForFeature(e.textSizeData,b,M)*st/os;r&&(it*=e.tilePixelRatio/y);const rt=Kx(N,it);r?(({x:Z,y:X,z:K}=l.projectTilePoint(O+rt.x,T+rt.y,g.canonical)),[Z,X,K]=mc(Z+F,X+$,K+q,f)):(t&&rt._rotate(-d.angle),Z+=rt.x,X+=rt.y,K=0);const ct=e.allowVerticalPlacement&&M.placedOrientation===so.vertical?Math.PI/2:0;for(let yt=0;yt<k;yt++)di(E,Z,X,K,ct);C&&M.associatedIconIndex>=0&&(A[M.associatedIconIndex]={x:Z,y:X,z:K,angle:ct})}else _c(k,E)}if(C){I.clear();const v=e.icon.placedSymbolArray;for(let M=0;M<v.length;M++){const O=v.get(M),{numGlyphs:T}=O,k=A[M];if(O.hidden||!k)_c(T,I);else{const{x:N,y:F,z:$,angle:q}=k;for(let Z=0;Z<T;Z++)di(I,N,F,$,q)}}e.icon.dynamicLayoutVertexBuffer.updateData(I)}e.text.dynamicLayoutVertexBuffer.updateData(E)}function Ty(e,t,r){return r.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function Iy(e,t,r,s,c,d,f,g,y,b,C,P,E){const I=e.context,A=I.gl,l=e.transform,u="map"===g,p="map"===y,m=u&&"point"!==r.layout.get("symbol-placement"),v=u&&!p&&!m,M=void 0!==r.layout.get("symbol-sort-key").constantOr(1);let O=!1;const T=e.depthModeForSublayer(0,Pn.ReadOnly),k=[yi(l.center.lng),Oo(l.center.lat)],N=r.layout.get("text-variable-anchor"),F="globe"===l.projection.name,$=[],q=[0,-1,0];let Z=q;!F&&!l.mercatorFromTransition||u||(Z=function(X){const K=X._camera.getWorldToCamera(X.worldSize,1),J=bt.multiply([],K,X.globeMatrix);bt.invert(J,J);const st=[0,0,0],it=[0,1,0,0];return kr.transformMat4(it,it,J),st[0]=it[0],st[1]=it[1],st[2]=it[2],dt.normalize(st,st),st}(l));for(const X of s){const K=t.getTile(X),J=K.getBucket(r);if(!J||"mercator"===J.projection.name&&F)continue;const st=c?J.text:J.icon;if(!st||J.fullyClipped||!st.segments.get().length)continue;const it=st.programConfigurations.get(r.id),rt=c||J.sdfIcons,ct=c?J.textSizeData:J.iconSizeData,yt=p||0!==l.pitch,Et=ui(ct,l.zoom);let Tt,zt,Nt,$t,Rt=[0,0],oe=null;if(c)zt=K.glyphAtlasTexture?K.glyphAtlasTexture:null,Nt=A.LINEAR,Tt=K.glyphAtlasTexture?K.glyphAtlasTexture.size:[0,0],J.iconsInText&&(Rt=K.imageAtlasTexture?K.imageAtlasTexture.size:[0,0],oe=K.imageAtlasTexture?K.imageAtlasTexture:null,$t=yt||e.options.rotating||e.options.zooming||"composite"===ct.kind||"camera"===ct.kind?A.LINEAR:A.NEAREST);else{const Ho=1!==r.layout.get("icon-size").constantOr(0)||J.iconsNeedLinear;zt=K.imageAtlasTexture?K.imageAtlasTexture:null,Nt=rt||e.options.rotating||e.options.zooming||Ho||yt?A.LINEAR:A.NEAREST,Tt=K.imageAtlasTexture?K.imageAtlasTexture.size:[0,0]}const Oe="globe"===J.projection.name,Ee=Oe?Z:q,Be=Oe?Pi(l.zoom):0,je=zv(X,J.getProjection(),l),On=l.calculatePixelsToTileUnitsMatrix(K),Qe=Of(je,K.tileID.canonical,p,u,l,J.getProjection(),On),nr=e.terrain&&p&&m?bt.invert(bt.create(),Qe):gM,ln=dm(je,K.tileID.canonical,p,u,l,J.getProjection(),On),Ln=N&&J.hasTextData(),En=J.hasIconTextFit()&&Ln&&J.hasIconData();if(m){const Ho=l.elevation,Gr=Ho?Ho.getAtTileOffsetFunc(X,l.center.lat,l.worldSize,J.getProjection()):null,Si=iy(je,K.tileID.canonical,p,u,l,J.getProjection(),On);vO(J,je,e,c,Si,ln,p,b,Gr,X)}const mn=m||c&&N||En,wr=e.translatePosMatrix(je,K,d,f),Lr=mn?gM:Qe,rr=e.translatePosMatrix(ln,K,d,f,!0),Kr=J.getProjection().createInversionMatrix(l,X.canonical),Ao=r.paint.get("icon-image-cross-fade").constantOr(0),mo=[];e.terrainRenderModeElevated()&&p&&mo.push("PITCH_WITH_MAP_TERRAIN"),Oe&&(mo.push("PROJECTION_GLOBE_VIEW"),mn&&mo.push("PROJECTED_POS_ON_VIEWPORT")),Ao>0&&mo.push("ICON_TRANSITION"),st.zOffsetVertexBuffer&&mo.push("Z_OFFSET");const Fo=rt&&0!==r.paint.get(c?"text-halo-width":"icon-halo-width").constantOr(1);let $i;rt?$i=J.iconsInText?Ey(ct.kind,Et,v,p,e,wr,Lr,rr,Tt,Rt,X,Be,k,Kr,Ee,J.getProjection()):hM(ct.kind,Et,v,p,e,wr,Lr,rr,c,Tt,!0,X,Be,k,Kr,Ee,J.getProjection()):(C<1&&mo.push("SATURATION"),$i=HI(ct.kind,Et,v,p,e,wr,Lr,rr,c,Tt,X,Be,k,Kr,Ee,J.getProjection(),C,Ao));const Ii={program:e.getOrCreateProgram(Ty(rt,c,J),{config:it,defines:mo}),buffers:st,uniformValues:$i,atlasTexture:zt,atlasTextureIcon:oe,atlasInterpolation:Nt,atlasInterpolationIcon:$t,isSDF:rt,hasHalo:Fo,tile:K,labelPlaneMatrixInv:nr};if(M&&J.canOverlap){O=!0;const Ho=st.segments.get();for(const Gr of Ho)$.push({segments:new lo([Gr]),sortKey:Gr.sortKey,state:Ii})}else $.push({segments:st.segments,sortKey:0,state:Ii})}O&&$.sort((X,K)=>X.sortKey-K.sortKey);for(const X of $){const K=X.state;if(e.terrain&&e.terrain.setupElevationDraw(K.tile,K.program,{useDepthForOcclusion:l.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:K.labelPlaneMatrixInv}),I.activeTexture.set(A.TEXTURE0),K.atlasTexture&&K.atlasTexture.bind(K.atlasInterpolation,A.CLAMP_TO_EDGE),K.atlasTextureIcon&&(I.activeTexture.set(A.TEXTURE1),K.atlasTextureIcon&&K.atlasTextureIcon.bind(K.atlasInterpolationIcon,A.CLAMP_TO_EDGE)),e.uploadCommonLightUniforms(e.context,K.program),K.hasHalo){const J=K.uniformValues;J.u_is_halo=1,Am(K.buffers,X.segments,r,e,K.program,T,P,E,J,2),J.u_is_halo=0}else{if(K.isSDF){const J=K.uniformValues;K.hasHalo&&(J.u_is_halo=1,Am(K.buffers,X.segments,r,e,K.program,T,P,E,J,1)),J.u_is_halo=0}Am(K.buffers,X.segments,r,e,K.program,T,P,E,K.uniformValues,1)}}}function Am(e,t,r,s,c,d,f,g,y,b){const C=[e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer,e.iconTransitioningVertexBuffer,e.globeExtVertexBuffer,e.zOffsetVertexBuffer];c.draw(s,s.context.gl.TRIANGLES,d,f,g,Jn.disabled,y,r.id,e.layoutVertexBuffer,e.indexBuffer,t,r.paint,s.transform.zoom,e.programConfigurations.get(r.id),C,b)}function mM(e,t,r,s,c,d,f){const g=e.context.gl,y=r.paint.get("fill-pattern"),b=y&&y.constantOr(1);let C,P,E,I,A;f?(P=b&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",C=g.LINES):(P=b?"fillPattern":"fill",C=g.TRIANGLES);for(const l of s){const u=t.getTile(l);if(b&&!u.patternsLoaded())continue;const p=u.getBucket(r);if(!p)continue;e.prepareDrawTile();const m=p.programConfigurations.get(r.id),v=e.isTileAffectedByFog(l),M=e.getOrCreateProgram(P,{config:m,overrideFog:v});b&&(e.context.activeTexture.set(g.TEXTURE0),u.imageAtlasTexture&&u.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),m.updatePaintBuffers());const O=y.constantOr(null);if(O&&u.imageAtlas){const N=u.imageAtlas.patternPositions[O.toString()];N&&m.setConstantPatternPositions(N)}const T=e.translatePosMatrix(l.projMatrix,u,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor")),k=r.paint.get("fill-emissive-strength");if(f){I=p.indexBuffer2,A=p.segments2;const N=e.terrain&&e.terrain.renderingToTexture?e.terrain.drapeBufferSize:[g.drawingBufferWidth,g.drawingBufferHeight];E="fillOutlinePattern"===P&&b?c2(T,k,e,u,N):Vs(T,k,N)}else I=p.indexBuffer,A=p.segments,E=b?l2(T,k,e,u):UI(T,k);e.uploadCommonUniforms(e.context,M,l.toUnwrapped()),M.draw(e,C,c,e.stencilModeForClipping(l),d,Jn.disabled,E,r.id,p.layoutVertexBuffer,I,A,r.paint,e.transform.zoom,m,void 0)}}function Sy(e,t,r,s,c,d,f,g){r.resetLayerRenderingStats();const y=e.context,b=y.gl,C=e.transform,P=r.paint.get("fill-extrusion-pattern"),E=P.constantOr(1),I=r.paint.get("fill-extrusion-opacity"),A=e.style.enable3dLights(),l=r.paint.get(A&&!E?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),u=[r.paint.get("fill-extrusion-ambient-occlusion-intensity"),l],p=r.layout.get("fill-extrusion-edge-radius"),m=p>0&&!r.paint.get("fill-extrusion-rounded-roof"),v=m?0:p,M="globe"===C.projection.name?ax():0,O="globe"===C.projection.name,T=O?Pi(C.zoom):0,k=[yi(C.center.lng),Oo(C.center.lat)],N=r.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),F=r.paint.get("fill-extrusion-flood-light-intensity"),$=r.paint.get("fill-extrusion-vertical-scale"),q=Tm(e,r.paint.get("fill-extrusion-cutoff-fade-range")),Z=r.paint.get("fill-extrusion-emissive-strength"),X=[];let K;O&&X.push("PROJECTION_GLOBE_VIEW"),u[0]>0&&X.push("FAUX_AO"),m&&X.push("ZERO_ROOF_RADIUS"),g&&X.push("HAS_CENTROID"),F>0&&X.push("FLOOD_LIGHT"),q.shouldRenderCutoff&&X.push("RENDER_CUTOFF");const J="shadow"===e.renderPass,st=e.shadowRenderer,it=J&&!!st;e.shadowRenderer&&(e.shadowRenderer.useNormalOffset=!0);let rt=[0,0,0];if(st){const Et=e.style.directionalLight,Tt=e.style.ambientLight;Et&&Tt&&(rt=wM(Et,Tt)),K=X.concat(["SHADOWS_SINGLE_CASCADE"])}const ct=it?"fillExtrusionDepth":E?"fillExtrusionPattern":"fillExtrusion",yt=r.getLayerRenderingStats();for(const Et of s){const Tt=t.getTile(Et),zt=Tt.getBucket(r);if(!zt||zt.projection.name!==C.projection.name)continue;let Nt=!1;st&&(Nt=0===st.getMaxCascadeForTile(Et.toUnwrapped()));const $t=e.isTileAffectedByFog(Et),Rt=zt.programConfigurations.get(r.id),oe=e.getOrCreateProgram(ct,{config:Rt,defines:Nt?K:X,overrideFog:$t});if(e.terrain&&e.terrain.setupElevationDraw(Tt,oe,{useMeterToDem:!0}),!zt.centroidVertexBuffer){const Qe=oe.attributes.a_centroid_pos;void 0!==Qe&&b.vertexAttrib2f(Qe,0,0)}!J&&st&&st.setupShadows(Tt.tileID.toUnwrapped(),oe,"vector-tile",Tt.tileID.overscaledZ),E&&(e.context.activeTexture.set(b.TEXTURE0),Tt.imageAtlasTexture&&Tt.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),Rt.updatePaintBuffers());const Oe=P.constantOr(null);if(Oe&&Tt.imageAtlas){const Qe=Tt.imageAtlas.patternPositions[Oe.toString()];Qe&&Rt.setConstantPatternPositions(Qe)}const Ee=r.paint.get("fill-extrusion-vertical-gradient");let Be;if(J&&st){if(bE(Tt.tileID,zt,e))continue;const Qe=st.calculateShadowPassMatrixFromTile(Tt.tileID.toUnwrapped());Be=cA(Qe,v,$)}else{const Qe=e.translatePosMatrix(Et.expandedProjMatrix,Tt,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),nr=C.projection.createInversionMatrix(C,Et.canonical);Be=E?ji(Qe,e,Ee,I,u,v,Et,Tt,M,T,k,nr,N,$):a2(Qe,e,Ee,I,u,v,Et,M,T,k,nr,N,$,F,rt,Z)}e.uploadCommonUniforms(y,oe,Et.toUnwrapped(),null,q);let je=zt.segments;if("mercator"===C.projection.name&&!J&&(je=zt.getVisibleSegments(Tt.tileID,e.terrain,e.transform.getFrustum(0)),!je.get().length))continue;if(yt)if(J)for(const Qe of je.get())yt.numRenderedVerticesInShadowPass+=Qe.primitiveLength;else for(const Qe of je.get())yt.numRenderedVerticesInTransparentPass+=Qe.primitiveLength;const On=[];(e.terrain||g)&&On.push(zt.centroidVertexBuffer),O&&On.push(zt.layoutVertexExtBuffer),oe.draw(e,y.gl.TRIANGLES,c,d,f,Jn.backCCW,Be,r.id,zt.layoutVertexBuffer,zt.indexBuffer,je,r.paint,e.transform.zoom,Rt,On)}e.shadowRenderer&&(e.shadowRenderer.useNormalOffset=!1)}function Ay(e,t,r,s,c,d,f,g,y,b,C,P,E,I,A,l,u,p,m){const v=e.context,M=v.gl,O=e.transform,T=e.transform.zoom,k=[],N=Tm(e,r.paint.get("fill-extrusion-cutoff-fade-range"));"clear"===b?(k.push("CLEAR_SUBPASS"),m&&(k.push("CLEAR_FROM_TEXTURE"),v.activeTexture.set(M.TEXTURE0),m.bind(M.LINEAR,M.CLAMP_TO_EDGE))):"sdf"===b&&k.push("SDF_SUBPASS"),u&&k.push("HAS_CENTROID"),N.shouldRenderCutoff&&k.push("RENDER_CUTOFF");const F=r.layout.get("fill-extrusion-edge-radius"),$=(q,Z,X,K,J)=>{const st=Z.programConfigurations.get(r.id),it=e.isTileAffectedByFog(q),rt=e.getOrCreateProgram("fillExtrusionGroundEffect",{config:st,defines:k,overrideFog:it}),ct={u_matrix:K,u_opacity:C,u_ao_pass:y?1:0,u_meter_to_tile:J,u_ao:[P,E*J],u_flood_light_intensity:I,u_flood_light_color:A,u_attenuation:l,u_edge_radius:T>=17?0:F*J,u_fb:0,u_fb_size:m?m.size[0]:0},yt=[];u&&yt.push(Z.hiddenByLandmarkVertexBuffer),e.uploadCommonUniforms(v,rt,q.toUnwrapped(),null,N),rt.draw(e,v.gl.TRIANGLES,c,d,f,g,ct,r.id,Z.vertexBuffer,Z.indexBuffer,X,r.paint,T,st,yt)};for(const q of s){const Z=t.getTile(q),X=Z.getBucket(r);if(!X||X.projection.name!==O.projection.name||!X.groundEffect||X.groundEffect&&!X.groundEffect.hasData())continue;const K=X.groundEffect,J=1/X.tileToMeter;{const st=e.translatePosMatrix(q.projMatrix,Z,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),it=K.getDefaultSegment();$(q,K,it,st,J)}if(p)for(let st=0;st<4;st++){const it=IP[st](q),rt=t.getTile(it);if(!rt)continue;const ct=rt.getBucket(r);if(!ct||ct.projection.name!==O.projection.name||!ct.groundEffect||ct.groundEffect&&!ct.groundEffect.hasData())continue;const yt=ct.groundEffect;let Et,Tt;0===st?(Et=[-Dt,0,0],Tt=1):1===st?(Et=[Dt,0,0],Tt=0):2===st?(Et=[0,-Dt,0],Tt=3):(Et=[0,Dt,0],Tt=2);const zt=yt.regionSegments[Tt];if(!zt)continue;const Nt=new Float32Array(16);bt.translate(Nt,q.projMatrix,Et),$(q,yt,zt,e.translatePosMatrix(Nt,Z,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),J)}}}function f2(e,t,r,s,c,d,f){0===s.centroidVertexArray.length&&s.createCentroidsBuffer();const g=d?d.findDEMTileFor(r):null;if(!(g&&g.dem||f))return;const y=p=>{const m=t.getSource().minzoom,v=O=>{const T=t.getTileByID(O);if(T&&T.hasData())return T.getBucket(c)},M=[0,-1,1];for(const O of M){if(p.overscaledZ+O<m)continue;const T=v(p.calculateScaledKey(p.overscaledZ+O));if(T)return T}},b=[0,0,0],C=(p,m)=>(b[0]=Math.min(p.min.y,m.min.y),b[1]=Math.max(p.max.y,m.max.y),b[2]=Dt-m.min.x>p.max.x?m.min.x-Dt:p.max.x,b),P=(p,m)=>(b[0]=Math.min(p.min.x,m.min.x),b[1]=Math.max(p.max.x,m.max.x),b[2]=Dt-m.min.y>p.max.y?m.min.y-Dt:p.max.y,b),E=[(p,m)=>C(p,m),(p,m)=>C(m,p),(p,m)=>P(p,m),(p,m)=>P(m,p)],I=(p,m,v,M,O,T,k)=>{if(!d)return 0;const N=[[T?v:p,T?p:v,0],[T?v:m,T?m:v,0]],F=k<0?Dt+k:k,$=[T?F:(p+m)/2,T?(p+m)/2:F,0];return 0===v&&k<0||0!==v&&k>0?d.getForTilePoints(O,[$],!0,M):N.push($),d.getForTilePoints(r,N,!0,g),Math.max(N[0][2],N[1][2],$[2])/d.exaggeration()};for(let p=0;p<4;p++){const m=s.borderFeatureIndices[p];if(0===m.length)continue;const v=IP[p](r),M=y(v);if(!(M&&M instanceof gm)||s.borderDoneWithNeighborZ[p]===M.canonical.z)continue;0===M.centroidVertexArray.length&&M.createCentroidsBuffer();const O=d?d.findDEMTileFor(v):null;if(!(O&&O.dem||f))continue;const T=(p<2?1:5)-p,k=M.borderDoneWithNeighborZ[T]!==s.canonical.z,N=M.borderFeatureIndices[T];let F=0;if(s.canonical.z!==M.canonical.z){for(const $ of m)s.showCentroid(s.featuresOnBorder[$]);if(k)for(const $ of N)M.showCentroid(M.featuresOnBorder[$]);s.borderDoneWithNeighborZ[p]=M.canonical.z,M.borderDoneWithNeighborZ[T]=s.canonical.z}for(const $ of m){const q=s.featuresOnBorder[$],Z=s.centroidData[q.centroidDataIndex],X=q.borders[p];let K;for(;F<N.length;){K=M.featuresOnBorder[N[F]];const J=K.borders[T];if(J[1]>X[0]+3||J[0]>X[0]-3)break;M.showCentroid(K),F++}if(K&&F<N.length){const J=F;let st=0;for(;!(K.borders[T][0]>X[1]-3)&&(st++,++F!==N.length);)K=M.featuresOnBorder[N[F]];if(K=M.featuresOnBorder[N[J]],st>1){const ct=K.borders[T];Math.abs(X[0]-ct[0])<3&&Math.abs(X[1]-ct[1])<3&&(st=1,F=J+1)}else if(0===st){s.showCentroid(q);continue}const it=M.centroidData[K.centroidDataIndex];f&&1===st&&(((l=Z).flags|(u=it).flags)&If?(l.flags|=If,u.flags|=If):(l.flags&=2147483647,u.flags&=2147483647));let rt=new tt(0,0);if(st>1)F=J;else if(O&&O.dem&&!(q.intersectsCount()>1||K.intersectsCount()>1)){const ct=E[p](Z,it),yt=p%2?Dt-1:0;A=I(ct[0],Math.min(Dt-1,ct[1]),yt,O,v,p<2,ct[2]),rt=new tt(Math.ceil(7*(A+450)),0)}Z.centroidXY=it.centroidXY=rt,s.writeCentroidToBuffer(Z),M.writeCentroidToBuffer(it)}else s.showCentroid(q)}s.borderDoneWithNeighborZ[p]=M.canonical.z,M.borderDoneWithNeighborZ[T]=s.canonical.z}var A,l,u;(s.needsCentroidUpdate||!s.centroidVertexBuffer&&0!==s.centroidVertexArray.length)&&s.uploadCentroid(e)}const p2=[1,0,0],yE=[0,1,0],vE=[0,0,1];function bE(e,t,r){const s=r.transform,c=r.shadowRenderer;if(!c)return!0;const d=e.toUnwrapped(),f=s.tileSize*c._cascades[r.currentShadowCascade].scale;let g=t.maxHeight;if(s.elevation){const l=s.elevation.getMinMaxForTile(e);l&&(g+=l.max)}const y=[...c.shadowDirection];y[2]=-y[2];const b=c.computeSimplifiedTileShadowVolume(d,g,f,y);if(!b)return!1;const C=[p2,yE,vE,y,[y[0],0,y[2]],[0,y[1],y[2]]],P="globe"===s.projection.name,E=s.scaleZoom(f),I=sc.fromInvProjectionMatrix(s.invProjMatrix,s.worldSize,E,!P),A=c.getCurrentCascadeFrustum();return 0===I.intersectsPrecise(b.vertices,b.planes,C)||0===A.intersectsPrecise(b.vertices,b.planes,C)}function Dm(e){const t=e._nearZ,r=e.projection.farthestPixelDistance(e),s=r-t,c=.2*e.height,d=t+c;return[t,r,(d-c-t)/s,(d-t)/s]}const xE=new bn(1,0,0,1),_M=new bn(0,1,0,1),Gv=new bn(0,0,1,1),Hv=new bn(1,0,1,1),g2=new bn(0,1,1,1);function qv(e,t,r){const s=e.context,c=e.transform,d=s.gl,f="globe"===c.projection.name,g=f?["PROJECTION_GLOBE_VIEW"]:[];let y=r.projMatrix;if(f&&Pi(c.zoom)>0){const $=D_(AP(r.canonical,c));y=bt.multiply(new Float32Array(16),c.globeMatrix,$),bt.multiply(y,c.projMatrix,y)}const b=e.getOrCreateProgram("debug",{defines:g}),C=t.getTileByID(r.key);e.terrain&&e.terrain.setupElevationDraw(C,b);const P=Pn.disabled,E=Gn.disabled,I=e.colorModeForRenderPass(),A="$debug";s.activeTexture.set(d.TEXTURE0),e.emptyTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE),f?C._makeGlobeTileDebugBuffers(e.context,c):C._makeDebugTileBoundsBuffers(e.context,c.projection);const l=C._tileDebugBuffer||e.debugBuffer,u=C._tileDebugIndexBuffer||e.debugIndexBuffer,p=C._tileDebugSegments||e.debugSegments;b.draw(e,d.LINE_STRIP,P,E,I,Jn.disabled,VI(y,bn.red),A,l,u,p,null,null,null,[C._globeTileDebugBorderBuffer]);const m=C.latestRawTileData,v=Math.floor((m&&m.byteLength||0)/1024),M=t.getTile(r).tileSize,O=512/Math.min(M,512)*(r.overscaledZ/c.zoom)*.5;let T=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(T+=` => ${r.overscaledZ}`),T+=` ${v}kb`,function($,q){$.initDebugOverlayCanvas();const Z=$.debugOverlayCanvas,X=$.context.gl,K=$.debugOverlayCanvas.getContext("2d");K.clearRect(0,0,Z.width,Z.height),K.shadowColor="white",K.shadowBlur=2,K.lineWidth=1.5,K.strokeStyle="white",K.textBaseline="top",K.font="bold 36px Open Sans, sans-serif",K.fillText(q,5,5),K.strokeText(q,5,5),$.debugOverlayTexture.update(Z),$.debugOverlayTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE)}(e,T);const k=C._tileDebugTextBuffer||e.debugBuffer,N=C._tileDebugTextIndexBuffer||e.quadTriangleIndexBuffer,F=C._tileDebugTextSegments||e.debugSegments;b.draw(e,d.TRIANGLES,P,E,Sr.alphaBlended,Jn.disabled,VI(y,bn.transparent,O),A,k,N,F,null,null,null,[C._globeTileDebugTextBuffer])}function Dy(e,t,r,s){$s(e,0,t+r/2,e.transform.width,r,s)}function wE(e,t,r,s){$s(e,t-r/2,0,r,e.transform.height,s)}function $s(e,t,r,s,c,d){const f=e.context,g=f.gl;g.enable(g.SCISSOR_TEST),g.scissor(t*Mn.devicePixelRatio,r*Mn.devicePixelRatio,s*Mn.devicePixelRatio,c*Mn.devicePixelRatio),f.clear({color:d}),g.disable(g.SCISSOR_TEST)}const CE=Dr([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Zv}=CE;function kf(e,t,r,s){e.emplaceBack(t,r,s)}class yM{constructor(t){this.vertexArray=new Jy,this.indices=new Mi,kf(this.vertexArray,-1,-1,1),kf(this.vertexArray,1,-1,1),kf(this.vertexArray,-1,1,1),kf(this.vertexArray,1,1,1),kf(this.vertexArray,-1,-1,-1),kf(this.vertexArray,1,-1,-1),kf(this.vertexArray,-1,1,-1),kf(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Zv),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=lo.simpleSegment(0,0,36,12)}}function Wv(e,t,r,s,c,d){const f=e.context.gl,g=t.paint.get("sky-atmosphere-color"),y=t.paint.get("sky-atmosphere-halo-color"),b=t.paint.get("sky-atmosphere-sun-intensity"),C={u_matrix_3f:al.fromMat4(al.create(),s),u_sun_direction:c,u_sun_intensity:b,u_color_tint_r:[(A=g).r,A.g,A.b,A.a],u_color_tint_m:[(l=y).r,l.g,l.b,l.a],u_luminance:5e-5};var A,l;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+d,t.skyboxTexture,0),r.draw(e,f.TRIANGLES,Pn.disabled,Gn.disabled,Sr.unblended,Jn.frontCW,C,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const ME=Dr([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class eu{constructor(t){const r=new pp;r.emplaceBack(-1,1,1,0,0),r.emplaceBack(1,1,1,1,0),r.emplaceBack(1,-1,1,1,1),r.emplaceBack(-1,-1,1,0,1);const s=new Mi;s.emplaceBack(0,1,2),s.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(r,ME.members),this.indexBuffer=t.createIndexBuffer(s),this.segments=lo.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const m2=Dr([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class eg{constructor(){this.colorModeAlphaBlendedWriteRGB=new Sr([1,771,1,771],bn.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Sr([1,0,1,0],bn.transparent,[!1,!1,!1,!0])}update(t){const r=t.context;if(!this.atmosphereBuffer){this.atmosphereBuffer=new eu(r);const s=100,c=200,d=function(C){const P=Rh(30),E=[];for(let I=0;I<16e3;++I){const A=2*Math.PI*P(),l=Math.acos(1-2*P())-.5*Math.PI;E.push(dt.fromValues(Math.cos(l)*Math.cos(A),Math.cos(l)*Math.sin(A),Math.sin(l)))}return E}(),f=Rh(300),g=new mT,y=new Mi;let b=0;for(let C=0;C<d.length;++C){const P=dt.scale([],d[C],200),E=Math.max(0,1+.01*s*(1*f()-.5)),I=Math.max(0,1+.01*c*(1*f()-.5));g.emplaceBack(P[0],P[1],P[2],-1,-1,E,I),g.emplaceBack(P[0],P[1],P[2],1,-1,E,I),g.emplaceBack(P[0],P[1],P[2],1,1,E,I),g.emplaceBack(P[0],P[1],P[2],-1,1,E,I),y.emplaceBack(b+0,b+1,b+2),y.emplaceBack(b+0,b+2,b+3),b+=4}this.starsVx=r.createVertexBuffer(g,m2.members),this.starsIdx=r.createIndexBuffer(y),this.starsSegments=lo.simpleSegment(0,0,g.length,y.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(t,r){const s=t.context,c=s.gl,d=t.transform,f=new Pn(c.LEQUAL,Pn.ReadOnly,[0,1]),g=Pi(d.zoom),y=r.properties.get("color").toArray01(),b=r.properties.get("high-color").toArray01(),C=r.properties.get("space-color").toArray01PremultipliedAlpha(),P=5e-4,E=Ne((r.properties.get("horizon-blend")-0)/1*.2495+P,5e-4,.25),I=m0(t,s,d)&&E===P?d.worldSize/(2*Math.PI*1.025)-1:d.globeRadius,A=t.frameCounter/1e3%1,l=dt.length(d.globeCenterInViewSpace),u=Math.sqrt(Math.pow(l,2)-Math.pow(I,2)),p=Math.acos(u/l),m=v=>{const M="globe"===d.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];v&&M.push("ALPHA_PASS");const O=t.getOrCreateProgram("globeAtmosphere",{defines:M}),T={u_frustum_tl:d.frustumCorners.TL,u_frustum_tr:d.frustumCorners.TR,u_frustum_br:d.frustumCorners.BR,u_frustum_bl:d.frustumCorners.BL,u_horizon:d.frustumCorners.horizon,u_transition:g,u_fadeout_range:E,u_color:y,u_high_color:b,u_space_color:C,u_temporal_offset:A,u_horizon_angle:p};t.uploadCommonUniforms(s,O);const k=this.atmosphereBuffer;k&&O.draw(t,c.TRIANGLES,f,Gn.disabled,v?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Jn.backCW,T,v?"atmosphere_glow_alpha":"atmosphere_glow",k.vertexBuffer,k.indexBuffer,k.segments)};m(!1),m(!0)}drawStars(t,r){const s=Ne(r.properties.get("star-intensity"),0,1);if(0===s)return;const c=t.context,d=c.gl,f=t.transform,g=t.getOrCreateProgram("stars"),y=Bi.identity([]);Bi.rotateX(y,y,-f._pitch),Bi.rotateZ(y,y,-f.angle),Bi.rotateX(y,y,Ct(f._center.lat)),Bi.rotateY(y,y,-Ct(f._center.lng));const b=bt.fromQuat(new Float32Array(16),y),C=bt.multiply([],f.starsProjMatrix,b),P=al.fromMat4([],b),E=al.invert([],P),I=[0,1,0];dt.transformMat3(I,I,E),dt.scale(I,I,.15);const A=[1,0,0];dt.transformMat3(A,A,E),dt.scale(A,A,.15);const l=(p=I,m=A,v=s,{u_matrix:Float32Array.from(C),u_up:p,u_right:m,u_intensity_multiplier:v});var p,m,v;t.uploadCommonUniforms(c,g),this.starsVx&&this.starsIdx&&g.draw(t,d.TRIANGLES,Pn.disabled,Gn.disabled,this.colorModeAlphaBlendedWriteRGB,Jn.disabled,l,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function vM(e,t){const r=[...e],s=t.cameraWorldSizeForFog/t.worldSize,c=bt.identity([]);return bt.scale(c,c,[s,s,1]),bt.multiply(r,c,r),bt.multiply(r,t.worldToFogMatrix,r),r}function PE(e,t,r,s){const c=r.material,d=s.context,{baseColorTexture:f,metallicRoughnessTexture:g}=c.pbrMetallicRoughness,{normalTexture:y,occlusionTexture:b,emissionTexture:C}=c;function P(E,I,A){if(E&&(e.push(I),d.activeTexture.set(d.gl.TEXTURE0+A),E.gfxTexture)){const{minFilter:l,magFilter:u,wrapS:p,wrapT:m}=E.sampler;E.gfxTexture.bindExtraParam(l,u,p,m)}}P(f,"HAS_TEXTURE_u_baseColorTexture",js.BaseColor),P(g,"HAS_TEXTURE_u_metallicRoughnessTexture",js.MetallicRoughness),P(y,"HAS_TEXTURE_u_normalTexture",js.Normal),P(b,"HAS_TEXTURE_u_occlusionTexture",js.Occlusion),P(C,"HAS_TEXTURE_u_emissionTexture",js.Emission),r.texcoordBuffer&&(e.push("HAS_ATTRIBUTE_a_uv_2f"),t.push(r.texcoordBuffer)),r.colorBuffer&&(e.push(12===r.colorBuffer.itemSize?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),t.push(r.colorBuffer)),r.normalBuffer&&(e.push("HAS_ATTRIBUTE_a_normal_3f"),t.push(r.normalBuffer)),r.pbrBuffer&&(e.push("HAS_ATTRIBUTE_a_pbr"),e.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),t.push(r.pbrBuffer)),"OPAQUE"!==c.alphaMode&&"MASK"!==c.alphaMode||e.push("UNPREMULT_TEXTURE_IN_SHADER"),c.defined||e.push("DIFFUSE_SHADED"),e.push("USE_STANDARD_DERIVATIVES")}function Kv(e,t,r,s,c,d){const f=r.paint.get("model-opacity"),g=t.context,y=new Pn(t.context.gl.LEQUAL,Pn.ReadWrite,t.depthRangeFor3D),b=t.transform,C=e.mesh,P=C.material,E=P.pbrMetallicRoughness,I=t.style.fog;let A;A="pixels"===t.transform.projection.zAxisUnit?[...e.nodeModelMatrix]:bt.multiply([],s.zScaleMatrix,e.nodeModelMatrix),bt.multiply(A,s.negCameraPosMatrix,A);const l=bt.invert([],A);bt.transpose(l,l);const u=r.paint.get("model-emissive-strength").constantOr(0),p=d2(new Float32Array(e.worldViewProjection),new Float32Array(A),new Float32Array(l),t,f,E.baseColorFactor,P.emissiveFactor,E.metallicFactor,E.roughnessFactor,P,u,r),m={defines:[]},v=[];PE(m.defines,v,C,t);const M=t.shadowRenderer;M&&(M.useNormalOffset=!1);let O=null;if(I){const N=vM(e.nodeModelMatrix,t.transform);if(O=new Float32Array(N),"globe"!==b.projection.name){const F=C.aabb.min,$=C.aabb.max,[q,Z]=I.getOpacityForBounds(N,F[0],F[1],$[0],$[1]);m.overrideFog=q>=rd||Z>=rd}}const T=Tm(t,r.paint.get("model-cutoff-fade-range"));T.shouldRenderCutoff&&m.defines.push("RENDER_CUTOFF");const k=t.getOrCreateProgram("model",m);t.uploadCommonUniforms(g,k,null,O,T),"shadow"!==t.renderPass&&M&&M.setupShadowsFromMatrix(e.nodeModelMatrix,k),k.draw(t,g.gl.TRIANGLES,y,c,d,C.material.doubleSided?Jn.disabled:Jn.backCCW,p,r.id,C.vertexBuffer,C.indexBuffer,C.segments,r.paint,t.transform.zoom,void 0,v)}function OE(e,t,r,s,c,d,f){let g;g="globe"===e.projection.name?OC(r,e):[...r],bt.multiply(g,g,t.matrix);const y=bt.multiply([],s,g);if(t.meshes)for(const b of t.meshes){if("BLEND"!==b.material.alphaMode){f.push({mesh:b,depth:0,modelIndex:c,worldViewProjection:y,nodeModelMatrix:g});continue}const C=dt.transformMat4([],b.centroid,y);C[2]>0&&d.push({mesh:b,depth:C[2],modelIndex:c,worldViewProjection:y,nodeModelMatrix:g})}if(t.children)for(const b of t.children)OE(e,b,r,s,c,d,f)}function ky(e,t,r,s){const c=r.shadowRenderer;if(!c)return;const d=c.getShadowPassDepthMode(),f=c.getShadowPassColorMode(),g=c.calculateShadowPassMatrixFromMatrix(t),y=tg(g);r.getOrCreateProgram("modelDepth",{defines:["DEPTH_TEXTURE"]}).draw(r,r.context.gl.TRIANGLES,d,Gn.disabled,f,Jn.backCCW,y,s.id,e.vertexBuffer,e.indexBuffer,e.segments,s.paint,r.transform.zoom,void 0,void 0)}function qI(e,t,r){const s=t.updateZoomBasedPaintProperties(),c=function(d,f,g){let y,b,C,P=d.terrain?d.terrain.exaggeration():0;if(d.terrain&&P>0){const E=d.terrain,I=E.findDEMTileFor(g);I&&I.dem?y=dc.create(E,g,I):P=0}if(0===P&&(f.terrainElevationMin=0,f.terrainElevationMax=0),P===f.validForExaggeration&&(0===P||y&&y._demTile&&y._demTile.tileID===f.validForDEMTile.id&&y._dem._timestamp===f.validForDEMTile.timestamp))return!1;for(const E in f.instancesPerModel){const I=f.instancesPerModel[E];for(let A=0;A<I.instancedDataArray.length;++A){const l=(y?P*y.getElevationAt(0|I.instancedDataArray.float32[16*A],0|I.instancedDataArray.float32[16*A+1],!0,!0):0)+I.instancesEvaluatedElevation[A];I.instancedDataArray.float32[16*A+6]=l,b=b?Math.min(f.terrainElevationMin,l):l,C=C?Math.max(f.terrainElevationMax,l):l}}return f.terrainElevationMin=b||0,f.terrainElevationMax=C||0,f.validForExaggeration=P,f.validForDEMTile=y&&y._demTile?{id:y._demTile.tileID,timestamp:y._dem._timestamp}:{id:void 0,timestamp:0},!0}(e,t,r);(s||c)&&(t.uploaded=!1,t.upload(e.context))}const Rf={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new yo([0,0,0],[Dt,Dt,0])};function Yx(e,t){const r=1<<e.canonical.z,s=t.getFreeCameraOptions().position,c=t.elevation,d=e.canonical.x/r,f=(e.canonical.x+1)/r,g=e.canonical.y/r,y=(e.canonical.y+1)/r;let b=t._centerAltitude;if(c){const I=c.getMinMaxForTile(e);I&&I.max>b&&(b=I.max)}const C=Ne(s.x,d,f)-s.x,P=Ne(s.y,g,y)-s.y,E=oo(b,t.center.lat)-s.z;return t._zoomFromMercatorZ(Math.sqrt(C*C+P*P+E*E))}function EE(e,t,r,s,c,d,f){const g=e.context,y="shadow"===e.renderPass,b=e.shadowRenderer,C=y&&b?b.getShadowPassDepthMode():new Pn(g.gl.LEQUAL,Pn.ReadWrite,e.depthRangeFor3D),P=e.isTileAffectedByFog(d);if(r.meshes)for(const E of r.meshes){const I=["MODEL_POSITION_ON_GPU"],A=[];let l,u,p;s.instancedDataArray.length>20&&I.push("INSTANCED_ARRAYS");const m=Tm(e,t.paint.get("model-cutoff-fade-range"));if(m.shouldRenderCutoff&&I.push("RENDER_CUTOFF"),y&&b)l=e.getOrCreateProgram("modelDepth",{defines:I}),u=tg(f.shadowTileMatrix,f.shadowTileMatrix,Float32Array.from(r.matrix)),p=b.getShadowPassColorMode();else{PE(I,A,E,e),l=e.getOrCreateProgram("model",{defines:I,overrideFog:P});const M=E.material,O=M.pbrMetallicRoughness,T=t.paint.get("model-opacity"),k=t.paint.get("model-emissive-strength").constantOr(0);u=d2(d.expandedProjMatrix,Float32Array.from(r.matrix),new Float32Array(16),e,T,O.baseColorFactor,M.emissiveFactor,O.metallicFactor,O.roughnessFactor,M,k,t,c),b&&(f.shadowUniformsInitialized?l.setShadowUniformValues(g,b.getShadowUniformValues()):(b.setupShadows(d.toUnwrapped(),l,"model-tile",d.overscaledZ),f.shadowUniformsInitialized=!0)),p=m.shouldRenderCutoff||T<1||"OPAQUE"!==M.alphaMode?Sr.alphaBlended:Sr.unblended}e.uploadCommonUniforms(g,l,d.toUnwrapped(),null,m);const v=E.material.doubleSided?Jn.disabled:Jn.backCCW;if(s.instancedDataArray.length>20)A.push(s.instancedDataBuffer),l.draw(e,g.gl.TRIANGLES,C,Gn.disabled,p,v,u,t.id,E.vertexBuffer,E.indexBuffer,E.segments,t.paint,e.transform.zoom,void 0,A,s.instancedDataArray.length);else{const M=y?"u_instance":"u_normal_matrix";for(let O=0;O<s.instancedDataArray.length;++O)u[M]=new Float32Array(s.instancedDataArray.arrayBuffer,64*O,16),l.draw(e,g.gl.TRIANGLES,C,Gn.disabled,p,v,u,t.id,E.vertexBuffer,E.indexBuffer,E.segments,t.paint,e.transform.zoom,void 0,A)}}if(r.children)for(const E of r.children)EE(e,t,E,s,c,d,f)}const dA=[1,-1,1];function Yv(e,t,r,s){if(!r.modelManager)return!0;const c=r.modelManager;if(!r.shadowRenderer)return!0;const d=r.shadowRenderer,f=t.aabb;let g=!0,y=e.maxHeight;if(0===y){let C=0;for(const P in e.instancesPerModel){const E=c.getModel(P,s);E?C=Math.max(C,Math.max(Math.max(E.aabb.max[0],E.aabb.max[1]),E.aabb.max[2])):g=!1}y=e.maxScale*C*1.41+e.maxVerticalOffset,g&&(e.maxHeight=y)}f.max[2]=y,f.min[2]+=e.terrainElevationMin,f.max[2]+=e.terrainElevationMax,dt.transformMat4(f.min,f.min,t.tileMatrix),dt.transformMat4(f.max,f.max,t.tileMatrix);const b=f.intersects(d.getCurrentCascadeFrustum());return 0===r.currentShadowCascade&&(e.isInsideFirstShadowMapFrustum=2===b),0===b}class ZI{}class _2{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(t,r,s){{const P=this._storage.get(r.id);if(P)return P.lastUsedFrameIdx=t,P.buf}const c=s.gl,d=c.getBufferParameter(c.ELEMENT_ARRAY_BUFFER,c.BUFFER_SIZE),f=new ArrayBuffer(d),g=new Int16Array(f);c.getBufferSubData(c.ELEMENT_ARRAY_BUFFER,0,new Int16Array(f));const y=new Ru;for(let P=0;P<d/2;P+=3){const E=g[P],I=g[P+1],A=g[P+2];y.emplaceBack(E,I),y.emplaceBack(I,A),y.emplaceBack(A,E)}const b=s.bindVertexArrayOES.current,C=new ZI;return C.buf=new im(s,y),C.lastUsedFrameIdx=t,this._storage.set(r.id,C),s.bindVertexArrayOES.set(b),C.buf}update(t){for(const[r,s]of this._storage)t-s.lastUsedFrameIdx>30&&(s.buf.destroy(),this._storage.delete(r))}destroy(){for(const[t,r]of this._storage)r.buf.destroy(),this._storage.delete(t)}}const TE={symbol:function(e,t,r,s,c){if("translucent"!==e.renderPass)return;const d=Gn.disabled,f=e.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(g,y,b,C,P,E,I){const A=y.transform,l="map"===P,u="map"===E;for(const p of g){const m=C.getTile(p),v=m.getBucket(b);if(!v||!v.text||!v.text.segments.get().length)continue;const M=ui(v.textSizeData,A.zoom),O=zv(p,v.getProjection(),A),T=A.calculatePixelsToTileUnitsMatrix(m),k=Of(O,m.tileID.canonical,u,l,A,v.getProjection(),T),N=v.hasIconTextFit()&&v.hasIconData();if(M){const F=Math.pow(2,A.zoom-m.tileID.overscaledZ);h2(v,l,u,I,kT,A,k,p,F,M,N)}}}(s,e,r,t,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),c),0!==r.paint.get("icon-opacity").constantOr(1)&&Iy(e,t,r,s,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),r.paint.get("icon-color-saturation"),d,f),0!==r.paint.get("text-opacity").constantOr(1)&&Iy(e,t,r,s,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),r.paint.get("icon-color-saturation"),d,f),t.map.showCollisionBoxes&&(pM(e,t,r,s,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),pM(e,t,r,s,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))},circle:function(e,t,r,s){if("translucent"!==e.renderPass)return;const c=r.paint.get("circle-opacity"),d=r.paint.get("circle-stroke-width"),f=r.paint.get("circle-stroke-opacity"),g=void 0!==r.layout.get("circle-sort-key").constantOr(1),y=r.paint.get("circle-emissive-strength");if(0===c.constantOr(1)&&(0===d.constantOr(1)||0===f.constantOr(1)))return;const b=e.context,C=b.gl,P=e.transform,E=e.depthModeForSublayer(0,Pn.ReadOnly),I=Gn.disabled,A=e.colorModeForDrapableLayerRenderPass(y),l="globe"===P.projection.name,u=[yi(P.center.lng),Oo(P.center.lat)],p=[];for(let v=0;v<s.length;v++){const M=s[v],O=t.getTile(M),T=O.getBucket(r);if(!T||T.projection.name!==P.projection.name)continue;const k=T.programConfigurations.get(r.id),N=Sp(r),F=e.isTileAffectedByFog(M);l&&N.push("PROJECTION_GLOBE_VIEW");const $=e.getOrCreateProgram("circle",{config:k,defines:N,overrideFog:F}),q=T.layoutVertexBuffer,Z=T.globeExtVertexBuffer,X=T.indexBuffer,K=P.projection.createInversionMatrix(P,M.canonical),J={programConfiguration:k,program:$,layoutVertexBuffer:q,globeExtVertexBuffer:Z,indexBuffer:X,uniformValues:lc(e,M,O,K,u,r),tile:O};if(g){const st=T.segments.get();for(const it of st)p.push({segments:new lo([it]),sortKey:it.sortKey,state:J})}else p.push({segments:T.segments,sortKey:0,state:J})}g&&p.sort((v,M)=>v.sortKey-M.sortKey);const m={useDepthForOcclusion:P.depthOcclusionForSymbolsAndCircles};for(const v of p){const{programConfiguration:M,program:O,layoutVertexBuffer:T,globeExtVertexBuffer:k,indexBuffer:N,uniformValues:F,tile:$}=v.state,q=v.segments;e.terrain&&e.terrain.setupElevationDraw($,O,m),e.uploadCommonUniforms(b,O,$.tileID.toUnwrapped()),O.draw(e,C.TRIANGLES,E,I,A,Jn.disabled,F,r.id,T,N,q,r.paint,P.zoom,M,[k])}},heatmap:function(e,t,r,s){if(0!==r.paint.get("heatmap-opacity"))if("offscreen"===e.renderPass){const c=e.context,d=c.gl,f=Gn.disabled,g=new Sr([d.ONE,d.ONE,d.ONE,d.ONE],bn.transparent,[!0,!0,!0,!0]);(function(I,A,l,u){const p=I.gl,m=A.width*u,v=A.height*u;I.activeTexture.set(p.TEXTURE1),I.viewport.set([0,0,m,v]);let M=l.heatmapFbo;if(!M||M&&(M.width!==m||M.height!==v)){M&&M.destroy();const O=p.createTexture();p.bindTexture(p.TEXTURE_2D,O),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR),M=l.heatmapFbo=I.createFramebuffer(m,v,!0,null),function(T,k,N,F,$,q){const Z=T.gl;Z.texImage2D(Z.TEXTURE_2D,0,T.extRenderToTextureHalfFloat?Z.RGBA16F:Z.RGBA,$,q,0,Z.RGBA,T.extRenderToTextureHalfFloat?Z.HALF_FLOAT:Z.UNSIGNED_BYTE,null),F.colorAttachment.set(N)}(I,0,O,M,m,v)}else p.bindTexture(p.TEXTURE_2D,M.colorAttachment.get()),I.bindFramebuffer.set(M.framebuffer)})(c,e,r,"globe"===e.transform.projection.name?.5:.25),c.clear({color:bn.transparent});const y=e.transform,b="globe"===y.projection.name,C=b?["PROJECTION_GLOBE_VIEW"]:[],P=b?Jn.frontCCW:Jn.disabled,E=[yi(y.center.lng),Oo(y.center.lat)];for(let I=0;I<s.length;I++){const A=s[I];if(t.hasRenderableParent(A))continue;const l=t.getTile(A),u=l.getBucket(r);if(!u||u.projection.name!==y.projection.name)continue;const p=e.isTileAffectedByFog(A),m=u.programConfigurations.get(r.id),v=e.getOrCreateProgram("heatmap",{config:m,defines:C,overrideFog:p}),{zoom:M}=e.transform;e.terrain&&e.terrain.setupElevationDraw(l,v),e.uploadCommonUniforms(c,v,A.toUnwrapped());const O=y.projection.createInversionMatrix(y,A.canonical);v.draw(e,d.TRIANGLES,Pn.disabled,f,g,P,mE(e,A,l,O,E,M,r.paint.get("heatmap-intensity")),r.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,r.paint,e.transform.zoom,m,b?[u.globeExtVertexBuffer]:null)}c.viewport.set([0,0,e.width,e.height])}else"translucent"===e.renderPass&&(e.context.setColorMode(e.colorModeForRenderPass()),function(c,d){const f=c.context,g=f.gl,y=d.heatmapFbo;if(!y)return;f.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,y.colorAttachment.get()),f.activeTexture.set(g.TEXTURE1);let b=d.colorRampTexture;b||(b=d.colorRampTexture=new xo(f,d.colorRamp,g.RGBA)),b.bind(g.LINEAR,g.CLAMP_TO_EDGE),c.getOrCreateProgram("heatmapTexture").draw(c,g.TRIANGLES,Pn.disabled,Gn.disabled,c.colorModeForRenderPass(),Jn.disabled,{u_image:0,u_color_ramp:1,u_opacity:d.paint.get("heatmap-opacity")},d.id,c.viewportBuffer,c.quadTriangleIndexBuffer,c.viewportSegments,d.paint,c.transform.zoom)}(e,r))},line:function(e,t,r,s){if("translucent"!==e.renderPass)return;const c=r.paint.get("line-opacity"),d=r.paint.get("line-width");if(0===c.constantOr(1)||0===d.constantOr(1))return;const f=r.paint.get("line-emissive-strength"),g=e.depthModeForSublayer(0,Pn.ReadOnly),y=e.colorModeForDrapableLayerRenderPass(f),b=e.terrain&&e.terrain.renderingToTexture?1:Mn.devicePixelRatio,C=r.paint.get("line-dasharray"),P=C.constantOr(1),E=r.layout.get("line-cap"),I=r.paint.get("line-pattern"),A=I.constantOr(1),l=r.paint.get("line-pattern").constantOr(1),u=1!==r.paint.get("line-opacity").constantOr(1);let p=!l&&u;const m=r.paint.get("line-gradient"),v=A?"linePattern":"line",M=e.context,O=M.gl,T=kO(r);e.terrain&&e.terrain.clipOrMaskOverlapStencilType()&&(p=!1);for(const k of s){const N=t.getTile(k);if(A&&!N.patternsLoaded())continue;const F=N.getBucket(r);if(!F)continue;e.prepareDrawTile();const $=F.programConfigurations.get(r.id),q=e.isTileAffectedByFog(k),Z=e.getOrCreateProgram(v,{config:$,defines:T,overrideFog:q}),X=I.constantOr(null);if(X&&N.imageAtlas){const Et=N.imageAtlas.patternPositions[X.toString()];Et&&$.setConstantPatternPositions(Et)}const K=C.constantOr(null),J=E.constantOr(null);if(!A&&K&&J&&N.lineAtlas){const Et=N.lineAtlas.getDash(K,J);Et&&$.setConstantPatternPositions(Et)}let[st,it]=r.paint.get("line-trim-offset");("round"===J||"square"===J)&&st!==it&&(0===st&&(st-=1),1===it&&(it+=1));const rt=e.terrain?k.projMatrix:null,ct=A?DO(e,N,r,rt,b):ZT(e,N,r,rt,F.lineClipsArray.length,b,[st,it]);if(m){const Et=F.gradients[r.id];let Tt=Et.texture;if(r.gradientVersion!==Et.version){let zt=256;if(r.stepInterpolant){const Nt=t.getSource().maxzoom,$t=k.canonical.z===Nt?Math.ceil(1<<e.transform.maxZoom-k.canonical.z):1;zt=Ne(Co(F.maxLineLength/Dt*1024*$t),256,M.maxTextureSize)}Et.gradient=$w({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:zt,image:Et.gradient||void 0,clips:F.lineClipsArray}),Et.texture?Et.texture.update(Et.gradient):Et.texture=new xo(M,Et.gradient,O.RGBA),Et.version=r.gradientVersion,Tt=Et.texture}M.activeTexture.set(O.TEXTURE1),Tt.bind(r.stepInterpolant?O.NEAREST:O.LINEAR,O.CLAMP_TO_EDGE)}P&&(M.activeTexture.set(O.TEXTURE0),N.lineAtlasTexture&&N.lineAtlasTexture.bind(O.LINEAR,O.REPEAT),$.updatePaintBuffers()),A&&(M.activeTexture.set(O.TEXTURE0),N.imageAtlasTexture&&N.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),$.updatePaintBuffers()),e.uploadCommonUniforms(M,Z,k.toUnwrapped());const yt=Et=>{Z.draw(e,O.TRIANGLES,g,Et,y,Jn.disabled,ct,r.id,F.layoutVertexBuffer,F.indexBuffer,F.segments,r.paint,e.transform.zoom,$,[F.layoutVertexBuffer2])};if(p){const Et=e.stencilModeForClipping(k).ref;0===Et&&e.terrain&&M.clear({stencil:0});const Tt={func:O.EQUAL,mask:255};ct.u_alpha_discard_threshold=.8,yt(new Gn(Tt,Et,255,O.KEEP,O.KEEP,O.INVERT)),ct.u_alpha_discard_threshold=0,yt(new Gn(Tt,Et,255,O.KEEP,O.KEEP,O.KEEP))}else yt(e.stencilModeForClipping(k))}p&&(e.resetStencilClippingMasks(),e.terrain&&M.clear({stencil:0}))},fill:function(e,t,r,s){const c=r.paint.get("fill-color"),d=r.paint.get("fill-opacity");if(0===d.constantOr(1))return;const f=r.paint.get("fill-emissive-strength"),g=e.colorModeForDrapableLayerRenderPass(f),y=r.paint.get("fill-pattern"),b=e.opaquePassEnabledForLayer()&&!y.constantOr(1)&&1===c.constantOr(bn.transparent).a&&1===d.constantOr(0)?"opaque":"translucent";if(e.renderPass===b){const C=e.depthModeForSublayer(1,"opaque"===e.renderPass?Pn.ReadWrite:Pn.ReadOnly);mM(e,t,r,s,C,g,!1)}if("translucent"===e.renderPass&&r.paint.get("fill-antialias")){const C=e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Pn.ReadOnly);mM(e,t,r,s,C,g,!0)}},"fill-extrusion":function(e,t,r,s){const c=r.paint.get("fill-extrusion-opacity"),d=e.context,f=d.gl,g=e.terrain,y=g&&g.renderingToTexture,b=r.paint.get("fill-extrusion-cutoff-fade-range");if(0===c)return;const C=e.conflationActive&&e.layerUsedInConflation(r,t.getSource());if(C&&function(P,E,I,A){for(const l of A){const u=E.getTile(l).getBucket(I);u&&(u.updateReplacement(l,P.replacementSource),u.uploadCentroid(P.context))}}(e,t,r,s),g||C)for(const P of s){const E=t.getTile(P).getBucket(r);E&&f2(e.context,t,P,E,r,g,C)}if("shadow"===e.renderPass&&e.shadowRenderer){const P=e.shadowRenderer;if(g&&c<.65&&r._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof Es)return;const E=P.getShadowPassDepthMode(),I=P.getShadowPassColorMode();Sy(e,t,r,s,E,Gn.disabled,I,C)}else if("translucent"===e.renderPass){const P=!r.paint.get("fill-extrusion-pattern").constantOr(1);if(!y){const E=new Pn(e.context.gl.LEQUAL,Pn.ReadWrite,e.depthRangeFor3D);0===b&&1===c&&P?Sy(e,t,r,s,E,Gn.disabled,Sr.unblended,C):(Sy(e,t,r,s,E,Gn.disabled,Sr.disabled,C),Sy(e,t,r,s,E,e.stencilModeFor3D(),e.colorModeForRenderPass(),C),e.resetStencilClippingMasks())}if(e.style.enable3dLights()&&P&&(!g&&"globe"!==e.transform.projection.name||y)){const E=r.paint.get("fill-extrusion-opacity"),I=r.paint.get("fill-extrusion-ambient-occlusion-intensity"),A=r.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),l=r.paint.get("fill-extrusion-flood-light-intensity"),u=r.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),p=I>0&&A>0,m=l>0,v=(O,T,k)=>(1-k)*O+k*T,M=O=>{const T=e.depthModeForSublayer(1,Pn.ReadOnly,f.LEQUAL,!0),k=r.paint.get(O?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),N=v(.1,3,k),F=e._showOverdrawInspector;if(!F){const $=new Gn({func:f.ALWAYS,mask:255},255,255,f.KEEP,f.KEEP,f.REPLACE),q=new Sr([f.ONE,f.ONE,f.ONE,f.ONE],bn.transparent,[!1,!1,!1,!0],f.MIN);Ay(e,t,r,s,T,$,q,Jn.disabled,O,"sdf",E,I,A,l,u,N,C,!1)}{const $=F?Gn.disabled:new Gn({func:f.EQUAL,mask:255},255,255,f.KEEP,f.DECR,f.DECR),q=F?e.colorModeForRenderPass():new Sr([f.ONE_MINUS_DST_ALPHA,f.DST_ALPHA,f.ONE,f.ONE],bn.transparent,[!0,!0,!0,!0]);Ay(e,t,r,s,T,$,q,Jn.disabled,O,"color",E,I,A,l,u,N,C,!1)}};if(y){const O=(T,k,N)=>{const F=e.depthModeForSublayer(1,Pn.ReadOnly,f.LEQUAL,!1),$=r.paint.get(T?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),q=v(.1,3,$);{const Z=new Sr([f.ONE,f.ONE,f.ONE,f.ONE],bn.transparent,[!1,!1,!1,!0]);Ay(e,t,r,s,F,Gn.disabled,Z,Jn.disabled,T,"clear",E,I,A,l,u,q,C,k)}{const Z=new Gn({func:f.ALWAYS,mask:255},255,255,f.KEEP,f.KEEP,f.REPLACE),X=new Sr([f.ONE,f.ONE,f.ONE,f.ONE],bn.transparent,[!1,!1,!1,!0],f.MIN);Ay(e,t,r,s,F,Z,X,Jn.disabled,T,"sdf",E,I,A,l,u,q,C,k)}{const Z=T?f.ZERO:f.ONE_MINUS_DST_ALPHA,X=new Gn({func:f.EQUAL,mask:255},255,255,f.KEEP,f.DECR,f.DECR),K=new Sr([Z,f.DST_ALPHA,f.ONE_MINUS_DST_ALPHA,f.ZERO],bn.transparent,[!0,!0,!0,!0]);Ay(e,t,r,s,F,X,K,Jn.disabled,T,"color",E,I,A,l,u,q,C,k)}{const Z=new Sr([f.ONE,f.ONE,f.ONE,T?f.ZERO:f.ONE],bn.transparent,[!1,!1,!1,!0],T?f.FUNC_ADD:f.MAX);Ay(e,t,r,s,F,Gn.disabled,Z,Jn.disabled,T,"clear",E,I,A,l,u,q,C,k,N)}};if(p||m){let T;if(e.prepareDrawTile(),g){const k=g.drapeBufferSize[0],N=g.drapeBufferSize[1];T=g.framebufferCopyTexture,T&&(!T||T.size[0]===k&&T.size[1]===N)||(T&&T.destroy(),T=g.framebufferCopyTexture=new xo(d,new Ui({width:k,height:N}),f.RGBA)),T.bind(f.LINEAR,f.CLAMP_TO_EDGE),f.copyTexImage2D(f.TEXTURE_2D,0,f.RGBA,0,0,k,N,0)}p&&O(!0,!1,T),m&&O(!1,!0,T)}}else p&&M(!0),m&&M(!1)}}},hillshade:function(e,t,r,s){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass||e.style.disableElevatedTerrain)return;const c=e.context,d=e.terrain&&e.terrain.renderingToTexture,[f,g]="translucent"!==e.renderPass||d?[{},s]:e.stencilConfigForOverlap(s);for(const y of g){const b=t.getTile(y);if(b.needsHillshadePrepare&&"offscreen"===e.renderPass)dE(e,b,r);else if("translucent"===e.renderPass){const C=e.depthModeForSublayer(0,Pn.ReadOnly),P=r.paint.get("hillshade-emissive-strength"),E=e.colorModeForDrapableLayerRenderPass(P),I=d&&e.terrain?e.terrain.stencilModeForRTTOverlap(y):f[y.overscaledZ];sM(e,y,b,r,C,I,E)}}c.viewport.set([0,0,e.width,e.height]),e.resetStencilClippingMasks()},raster:function(e,t,r,s,c,d){if("translucent"!==e.renderPass||0===r.paint.get("raster-opacity"))return;const f=e.context,g=f.gl,y=t.getSource(),b=function(k,N,F){const $=k.paint.get("raster-color"),q=[],Z=k.paint.get("raster-resampling"),X=k.paint.get("raster-color-mix"),K=k.paint.get("raster-color-range"),J=[X[0],X[1],X[2],0],st=X[3],it="nearest"===Z?F.NEAREST:F.LINEAR;if($&&q.push("RASTER_COLOR"),$){N.activeTexture.set(F.TEXTURE2);let rt=k.colorRampTexture;rt||(rt=k.colorRampTexture=new xo(N,k.colorRamp,F.RGBA)),rt.bind(F.LINEAR,F.CLAMP_TO_EDGE)}return{mix:J,range:K,offset:st,defines:q,resampling:it}}(r,f,g),C=b.defines,P="globe"===e.transform.projection.name;let E=!1;if(y instanceof Qc&&!s.length){if(!P)return;if(y.onNorthPole)E=!0,C.push("GLOBE_POLES");else{if(!y.onSouthPole)return;E=!0,C.push("GLOBE_POLES")}}const I=r.paint.get("raster-emissive-strength"),A=e.colorModeForDrapableLayerRenderPass(I),l=e.terrain&&e.terrain.renderingToTexture,u=y instanceof Qc&&0!==r.paint.get("raster-elevation"),p=!e.options.moving,m="nearest"===r.paint.get("raster-resampling")?g.NEAREST:g.LINEAR;if(E){const k=t.getSource();if(!(k instanceof Qc))return;const N=k.texture;if(!N)return;const F=e.globeSharedBuffers;if(!F)return;const $=new Pn(g.LEQUAL,Pn.ReadWrite,e.depthRangeFor3D),q=Float32Array.from(e.transform.expandedFarZProjMatrix);let Z=DP(0,0,e.transform);const X=Float32Array.from(lf(Po(new ic(0,0,0)))),K={opacity:1,mix:0};e.terrain&&e.terrain.prepareDrawTile(),f.activeTexture.set(g.TEXTURE0),N.bind(m,g.CLAMP_TO_EDGE),f.activeTexture.set(g.TEXTURE1),N.bind(m,g.CLAMP_TO_EDGE),N.useMipmap&&f.extTextureFilterAnisotropic&&e.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f.extTextureFilterAnisotropicMax);const[J,st,it,rt]=F.getPoleBuffers(0,!0);let ct;k.onNorthPole?(ct=J,e.renderDefaultNorthPole=!1):(Z=bt.scale(bt.create(),Z,[1,-1,1]),ct=st,e.renderDefaultSouthPole=!1);const yt=(Tt=q,zt=X,Nt=Z,$t=K,Rt=r,oe=k.perspectiveTransform||[0,0],Oe=r.paint.get("raster-elevation"),Be=b.mix,je=b.offset,On=b.range,Qe=I,_E(Tt,zt,Nt,new Float32Array(16),new Float32Array(9),[0,0],[0,0,0,0],0,[0,0],[0,0,0,0],1,$t,Rt,oe||[0,0],Oe,2,Be,je,On,1,0,Qe)),Et=e.getOrCreateProgram("raster",{defines:b.defines});return e.uploadCommonUniforms(f,Et,null),void Et.draw(e,g.TRIANGLES,$,Gn.disabled,A,Jn.disabled,yt,r.id,ct,it,rt)}var Tt,zt,Nt,$t,Rt,oe,Oe,Be,je,On,Qe;if(!s.length)return;const[v,M]=y instanceof Qc||l?[{},s]:e.stencilConfigForOverlap(s),O=M[M.length-1].overscaledZ,T=u&&P;T&&b.defines.push("PROJECTION_GLOBE_VIEW"),u&&b.defines.push("RENDER_CUTOFF");for(const k of M){const N=k.toUnwrapped(),F=t.getTile(k);if(l&&(!F||!F.hasData())||!F.texture)continue;let $,q;l?($=Pn.disabled,q=k.projMatrix):u?($=new Pn(g.LEQUAL,Pn.ReadWrite,e.depthRangeFor3D),q=P?Float32Array.from(e.transform.expandedFarZProjMatrix):e.transform.calculateProjMatrix(N,p)):($=e.depthModeForSublayer(k.overscaledZ-O,1===r.paint.get("raster-opacity")?Pn.ReadWrite:Pn.ReadOnly,g.LESS),q=e.transform.calculateProjMatrix(N,p));const Z=e.terrain&&l?e.terrain.stencilModeForRTTOverlap(k):v[k.overscaledZ],X=d?0:r.paint.get("raster-fade-duration");F.registerFadeDuration(X);const K=t.findLoadedParent(k,0),J=pE(F,K,t,e.transform,X);let st,it;e.terrain&&e.terrain.prepareDrawTile(),f.activeTexture.set(g.TEXTURE0),F.texture&&F.texture.bind(m,g.CLAMP_TO_EDGE),f.activeTexture.set(g.TEXTURE1),K?(K.texture&&K.texture.bind(m,g.CLAMP_TO_EDGE),st=Math.pow(2,K.tileID.overscaledZ-F.tileID.overscaledZ),it=[F.tileID.canonical.x*st%1,F.tileID.canonical.y*st%1]):F.texture&&F.texture.bind(m,g.CLAMP_TO_EDGE),F.texture&&F.texture.useMipmap&&f.extTextureFilterAnisotropic&&e.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f.extTextureFilterAnisotropicMax);const rt=e.transform,ct=y instanceof Qc?y.perspectiveTransform:[0,0],yt=u?Dm(rt):[0,0,0,0];let Et,Tt,zt,Nt,$t,Rt;if(T&&y instanceof Qc&&y.coordinates.length>3){Et=Float32Array.from(lf(Po(new ic(0,0,0)))),Tt=Float32Array.from(rt.globeMatrix),zt=Float32Array.from(u1(rt)),Nt=[yi(rt.center.lng),Oo(rt.center.lat)],Rt=[yi(y.coordinates[1][0]),Oo(y.coordinates[1][1]),yi(y.coordinates[3][0]),Oo(y.coordinates[3][1])];const Be=new Qo(y.coordinates[1],y.coordinates[3]);$t=Float32Array.from(_0(new ic(0,0,0),Be,0,rt.worldSize/e.transform._pixelsPerMercatorPixel))}else Et=new Float32Array(16),Tt=new Float32Array(9),zt=new Float32Array(16),Nt=[0,0],$t=new Float32Array(16),Rt=[0,0,0,0];const oe=_E(q,Et,Tt,zt,$t,it||[0,0],Rt,Pi(e.transform.zoom),Nt,yt,st||1,J,r,ct,u?r.paint.get("raster-elevation"):0,2,b.mix,b.offset,b.range,1,0,I),Oe=e.isTileAffectedByFog(k),Ee=e.getOrCreateProgram("raster",{defines:b.defines,overrideFog:Oe});if(e.uploadCommonUniforms(f,Ee,N),y instanceof Qc){if(l||!P)y.boundsBuffer&&y.boundsSegments&&Ee.draw(e,g.TRIANGLES,$,Gn.disabled,A,Jn.disabled,oe,r.id,y.boundsBuffer,e.quadTriangleIndexBuffer,y.boundsSegments);else if(e.globeSharedBuffers){const[Be,je,On]=e.globeSharedBuffers.getGridBuffers(0,!1);Ee.draw(e,g.TRIANGLES,$,Gn.disabled,A,Jn.frontCCW,oe,r.id,Be,je,On),Ee.draw(e,g.TRIANGLES,$,Gn.disabled,A,Jn.backCCW,oe,r.id,Be,je,On)}}else{const{tileBoundsBuffer:Be,tileBoundsIndexBuffer:je,tileBoundsSegments:On}=e.getTileBoundsBuffers(F);Ee.draw(e,g.TRIANGLES,$,Z,A,Jn.disabled,oe,r.id,Be,je,On)}}e.resetStencilClippingMasks()},background:function(e,t,r,s){const c=r.paint.get("background-color"),d=r.paint.get("background-opacity"),f=r.paint.get("background-emissive-strength");if(0===d)return;const g=e.context,y=g.gl,b=e.transform,C=b.tileSize,P=r.paint.get("background-pattern");if(e.isPatternMissing(P,r.scope))return;const E=!P&&1===c.a&&1===d&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==E)return;const I=Gn.disabled,A=e.depthModeForSublayer(0,"opaque"===E?Pn.ReadWrite:Pn.ReadOnly),l=e.colorModeForDrapableLayerRenderPass(f),u=P?"backgroundPattern":"background";let p,m=s;m||(p=e.getBackgroundTiles(),m=Object.values(p).map(v=>v.tileID)),P&&(g.activeTexture.set(y.TEXTURE0),e.imageManager.bind(e.context,r.scope));for(const v of m){const M=e.isTileAffectedByFog(v),O=e.getOrCreateProgram(u,{overrideFog:M}),T=v.toUnwrapped(),k=s?v.projMatrix:e.transform.calculateProjMatrix(T);e.prepareDrawTile();const N=t?t.getTile(v):p?p[v.key]:new Ki(v,C,b.zoom,e),F=P?Sm(k,f,d,e,P,r.scope,{tileID:v,tileSize:C}):u2(k,f,d,c);e.uploadCommonUniforms(g,O,T);const{tileBoundsBuffer:$,tileBoundsIndexBuffer:q,tileBoundsSegments:Z}=e.getTileBoundsBuffers(N);O.draw(e,y.TRIANGLES,A,I,l,Jn.disabled,F,r.id,$,q,Z)}},sky:function(e,t,r){const s=e._atmosphere?Pi(e.transform.zoom):1,c=r.paint.get("sky-opacity")*s;if(0===c)return;const d=e.context,f=r.paint.get("sky-type"),g=new Pn(d.gl.LEQUAL,Pn.ReadOnly,[0,1]),y=e.frameCounter/1e3%1;"atmosphere"===f?"offscreen"===e.renderPass?r.needsSkyboxCapture(e)&&(function(b,C,P,E){const I=b.context,A=I.gl;let l=C.skyboxFbo;if(!l){l=C.skyboxFbo=I.createFramebuffer(32,32,!0,null),C.skyboxGeometry=new yM(I),C.skyboxTexture=I.gl.createTexture(),A.bindTexture(A.TEXTURE_CUBE_MAP,C.skyboxTexture),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_CUBE_MAP,A.TEXTURE_MAG_FILTER,A.LINEAR);for(let v=0;v<6;++v)A.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,A.RGBA,32,32,0,A.RGBA,A.UNSIGNED_BYTE,null)}I.bindFramebuffer.set(l.framebuffer),I.viewport.set([0,0,32,32]);const u=C.getCenter(b,!0),p=b.getOrCreateProgram("skyboxCapture"),m=new Float64Array(16);bt.identity(m),bt.rotateY(m,m,.5*-Math.PI),Wv(b,C,p,m,u,0),bt.identity(m),bt.rotateY(m,m,.5*Math.PI),Wv(b,C,p,m,u,1),bt.identity(m),bt.rotateX(m,m,.5*-Math.PI),Wv(b,C,p,m,u,2),bt.identity(m),bt.rotateX(m,m,.5*Math.PI),Wv(b,C,p,m,u,3),bt.identity(m),Wv(b,C,p,m,u,4),bt.identity(m),bt.rotateY(m,m,Math.PI),Wv(b,C,p,m,u,5),I.viewport.set([0,0,b.width,b.height])}(e,r),r.markSkyboxValid(e)):"sky"===e.renderPass&&function(b,C,P,E,I){const A=b.context,l=A.gl,u=b.transform,p=b.getOrCreateProgram("skybox");A.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_CUBE_MAP,C.skyboxTexture);const m={u_matrix:u.skyboxMatrix,u_sun_direction:C.getCenter(b,!1),u_cubemap:0,u_opacity:E,u_temporal_offset:I};b.uploadCommonUniforms(A,p),p.draw(b,l.TRIANGLES,P,Gn.disabled,b.colorModeForRenderPass(),Jn.backCW,m,"skybox",C.skyboxGeometry.vertexBuffer,C.skyboxGeometry.indexBuffer,C.skyboxGeometry.segment)}(e,r,g,c,y):"gradient"===f&&"sky"===e.renderPass&&function(b,C,P,E,I){const A=b.context,l=A.gl,u=b.transform,p=b.getOrCreateProgram("skyboxGradient");C.skyboxGeometry||(C.skyboxGeometry=new yM(A)),A.activeTexture.set(l.TEXTURE0);let m=C.colorRampTexture;m||(m=C.colorRampTexture=new xo(A,C.colorRamp,l.RGBA)),m.bind(l.LINEAR,l.CLAMP_TO_EDGE);const v=(k=E,N=I,{u_matrix:u.skyboxMatrix,u_color_ramp:0,u_center_direction:C.getCenter(b,!1),u_radius:Ct(C.paint.get("sky-gradient-radius")),u_opacity:k,u_temporal_offset:N});var k,N;b.uploadCommonUniforms(A,p),p.draw(b,l.TRIANGLES,P,Gn.disabled,b.colorModeForRenderPass(),Jn.backCW,v,"skyboxGradient",C.skyboxGeometry.vertexBuffer,C.skyboxGeometry.indexBuffer,C.skyboxGeometry.segment)}(e,r,g,c,y)},debug:function(e,t,r){for(let s=0;s<r.length;s++)qv(e,t,r[s])},custom:function(e,t,r,s){const c=e.context,d=r.implementation;if(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes("custom")||e.terrain&&(e.terrain.renderingToTexture||"offscreen"===e.renderPass)&&r.isLayerDraped(t)){if("offscreen"===e.renderPass){const f=d.prerender;if(f){if(e.setCustomLayerDefaults(),c.setColorMode(e.colorModeForRenderPass()),"globe"===e.transform.projection.name){const g=e.transform.pointMerc;f.call(d,c.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),Pi(e.transform.zoom),[g.x,g.y],e.transform.pixelsPerMeterRatio)}else f.call(d,c.gl,e.transform.customLayerMatrix());c.setDirty(),e.setBaseState()}}else if("translucent"===e.renderPass){if(e.terrain&&e.terrain.renderingToTexture){const g=d.renderToTile;if(g){const y=s[0].canonical,b=new Xn(y.x+s[0].wrap*(1<<y.z),y.y,y.z);c.setDepthMode(Pn.disabled),c.setStencilMode(Gn.disabled),c.setColorMode(e.colorModeForRenderPass()),e.setCustomLayerDefaults(),g.call(d,c.gl,b),c.setDirty(),e.setBaseState()}return}e.setCustomLayerDefaults(),c.setColorMode(e.colorModeForRenderPass()),c.setStencilMode(Gn.disabled);const f="3d"===d.renderingMode?new Pn(e.context.gl.LEQUAL,Pn.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,Pn.ReadOnly);if(c.setDepthMode(f),"globe"===e.transform.projection.name){const g=e.transform.pointMerc;d.render(c.gl,e.transform.customLayerMatrix(),e.transform.getProjection(),e.transform.globeToMercatorMatrix(),Pi(e.transform.zoom),[g.x,g.y],e.transform.pixelsPerMeterRatio)}else d.render(c.gl,e.transform.customLayerMatrix());c.setDirty(),e.setBaseState(),c.bindFramebuffer.set(null)}}else gt("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(e,t,r,s){if("opaque"===e.renderPass)return;const c=r.paint.get("model-opacity");if(0===c)return;const d=r.paint.get("model-cast-shadows");if("shadow"===e.renderPass&&(!d||e.terrain&&c<.65&&r._transitionablePaint._values["model-opacity"].value.expression instanceof Es))return;const f=e.shadowRenderer,g=r.paint.get("model-receive-shadows");f&&(f.useNormalOffset=!0,g||(f.enabled=!1));const y=()=>{f&&(f.useNormalOffset=!0,g||(f.enabled=!0))},b=t.getSource();if("light-beam"===e.renderPass&&"batched-model"!==b.type)return;if("vector"===b.type||"geojson"===b.type)return function(p,m,v,M){const O=p.transform;if("mercator"!==O.projection.name)return void gt(`Drawing 3D models for ${O.projection.name} projection is not yet implemented`);const T=O.getFreeCameraOptions().position;if(!p.modelManager)return;const k=p.modelManager,N=p.shadowRenderer;if(!v._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const F=v._unevaluatedLayout._values["model-id"],$={...v.layout.get("model-id").parameters};for(const q of M){const Z=m.getTile(q).getBucket(v);if(!Z||Z.projection.name!==O.projection.name)continue;const X=Yx(q,O);$.zoom=X;const K=F.possiblyEvaluate($);if(qI(p,Z,q),Rf.shadowUniformsInitialized=!1,Rf.useSingleShadowCascade=!!N&&0===N.getMaxCascadeForTile(q.toUnwrapped()),"shadow"===p.renderPass&&N){if(1===p.currentShadowCascade&&Z.isInsideFirstShadowMapFrustum)continue;const it=O.calculatePosMatrix(q.toUnwrapped(),O.worldSize);if(Rf.tileMatrix.set(it),Rf.shadowTileMatrix=Float32Array.from(N.calculateShadowPassMatrixFromMatrix(it)),Rf.aabb.min.fill(0),Rf.aabb.max[0]=Rf.aabb.max[1]=Dt,Rf.aabb.max[2]=0,Yv(Z,Rf,p,v.scope))continue}const J=1<<q.canonical.z,st=[((T.x-q.wrap)*J-q.canonical.x)*Dt,(T.y*J-q.canonical.y)*Dt,T.z*J*Dt];for(let it in Z.instancesPerModel){const rt=Z.instancesPerModel[it];rt.features.length>0&&(it=K.evaluate(rt.features[0].feature,{}));const ct=k.getModel(it,v.scope);if(ct&&ct.uploaded)for(const yt of ct.nodes)EE(p,v,yt,rt,st,q,Rf)}}}(e,t,r,s),void y();if(!b.loaded())return;if("batched-model"===b.type)return function(p,m,v,M){const O=p.context,T=p.transform,k=p.style.fog,N=p.shadowRenderer;if("mercator"!==T.projection.name)return void gt(`Drawing 3D landmark models for ${T.projection.name} projection is not yet implemented`);const F=p.transform.getFreeCameraOptions().position,$=dt.scale([],[F.x,F.y,F.z],p.transform.worldSize);dt.negate($,$);const q=bt.identity([]),Z=go(T.center.lat,T.zoom),X=bt.fromScaling([],[1,1,1/Z]);bt.translate(q,q,$);const K=v.paint.get("model-opacity"),J=new Pn(O.gl.LEQUAL,Pn.ReadWrite,p.depthRangeFor3D),st=new Pn(O.gl.LEQUAL,Pn.ReadOnly,p.depthRangeFor3D),it=function(rt,ct){for(const yt of M){const Et=m.getTile(yt).getBucket(v);if(!Et||!Et.uploaded)continue;let Tt=!1;N&&(Tt=0===N.getMaxCascadeForTile(yt.toUnwrapped()));const zt=T.calculatePosMatrix(yt.toUnwrapped(),T.worldSize),Nt=Et.modelTraits;for(const $t of Et.getNodesInfo()){if($t.hiddenByReplacement||!$t.node.meshes)continue;const Rt=$t.node,oe="light-beam"===p.renderPass,Oe=[...zt],Ee=$t.evaluatedScale;let Be=0;p.terrain&&Rt.elevation&&(Be=Rt.elevation*p.terrain.exaggeration()),bt.translate(Oe,Oe,[(Rt.anchor?Rt.anchor[0]:0)*(Ee[0]-1),(Rt.anchor?Rt.anchor[1]:0)*(Ee[1]-1),Be]),Ee!==cv&&bt.scale(Oe,Oe,Ee),bt.multiply(Oe,Oe,Rt.matrix);const je=bt.multiply([],X,Oe);bt.multiply(je,q,je);const On=bt.invert([],je);bt.transpose(On,On),bt.scale(On,On,dA);const Qe=bt.multiply([],T.expandedFarZProjMatrix,Oe);for(let nr=0;nr<Rt.meshes.length;++nr){const ln=Rt.meshes[nr],Ln=nr===Rt.lightMeshIndex;if(Ln){if(!oe&&!p.terrain&&p.shadowRenderer){p.currentLayer<p.firstLightBeamLayer&&(p.firstLightBeamLayer=p.currentLayer);continue}}else if(oe)continue;const En={defines:[]},mn=[];PE(En.defines,mn,ln,p),4&Nt||En.defines.push("DIFFUSE_SHADED"),Tt&&En.defines.push("SHADOWS_SINGLE_CASCADE");const wr="shadow"===p.renderPass;if(wr){ky(ln,Oe,p,v);continue}let Lr=null;if(k){const $i=vM(Oe,p.transform);if(Lr=new Float32Array($i),"globe"!==T.projection.name){const Ii=ln.aabb.min,Ho=ln.aabb.max,[Gr,Si]=k.getOpacityForBounds($i,Ii[0],Ii[1],Ho[0],Ho[1]);En.overrideFog=Gr>=rd||Si>=rd}}const rr=p.getOrCreateProgram("model",En);!wr&&N&&(N.useNormalOffset=!!ln.normalBuffer,N.setupShadowsFromMatrix(Oe,rr,N.useNormalOffset)),p.uploadCommonUniforms(O,rr,yt.toUnwrapped(),Lr);const Kr=ln.material,Ao=Kr.pbrMetallicRoughness;Ao.metallicFactor=.9,Ao.roughnessFactor=.5;const mo=0,Fo=d2(new Float32Array(Qe),new Float32Array(je),new Float32Array(On),p,K,Ao.baseColorFactor,Kr.emissiveFactor,Ao.metallicFactor,Ao.roughnessFactor,Kr,mo,v);rr.draw(p,O.gl.TRIANGLES,ct&&!Ln?J:st,Gn.disabled,rt?Ln||K<1||$t.hasTranslucentParts?Sr.alphaBlended:Sr.unblended:Sr.disabled,Jn.backCCW,Fo,v.id,ln.vertexBuffer,ln.indexBuffer,ln.segments,v.paint,p.transform.zoom,void 0,mn)}}}};(function(rt,ct,yt,Et){const Tt=rt.terrain?rt.terrain.exaggeration():0,zt=rt.transform.zoom;for(const Nt of Et){const $t=ct.getTile(Nt).getBucket(yt);$t&&(rt.conflationActive&&$t.updateReplacement(Nt,rt.replacementSource),$t.evaluateScale(rt,yt),rt.terrain&&Tt>0&&$t.elevationUpdate(rt.terrain,Tt,Nt,yt.source),$t.needsReEvaluation(rt,zt,yt)&&$t.evaluate(yt))}})(p,m,v,M),1===K?it(!0,!0):(it(!1,!0),it(!0,!1))}(e,t,r,s),void y();const C=b.getModels(),P=[],E=e.transform.getFreeCameraOptions().position,I=dt.scale([],[E.x,E.y,E.z],e.transform.worldSize);dt.negate(I,I);const A=[],l=[];let u=0;for(const p of C){const m=r.paint.get("model-rotation").constantOr(null),v=r.paint.get("model-scale").constantOr(null),M=r.paint.get("model-translation").constantOr(null);p.computeModelMatrix(e,m,v,M,!0,!0,!1);const O=bt.identity([]),T=go(p.position.lat,e.transform.zoom),k=bt.fromScaling([],[1,1,1/T]);bt.translate(O,O,I),P.push({zScaleMatrix:k,negCameraPosMatrix:O});for(const N of p.nodes)OE(e.transform,N,p.matrix,e.transform.expandedFarZProjMatrix,u,A,l);u++}if(A.sort((p,m)=>m.depth-p.depth),"shadow"!==e.renderPass){if(1===c)for(const p of l)Kv(p,e,r,P[p.modelIndex],Gn.disabled,e.colorModeForRenderPass());else{for(const p of l)Kv(p,e,r,P[p.modelIndex],Gn.disabled,Sr.disabled);for(const p of l)Kv(p,e,r,P[p.modelIndex],e.stencilModeFor3D(),e.colorModeForRenderPass());e.resetStencilClippingMasks()}for(const p of A)Kv(p,e,r,P[p.modelIndex],Gn.disabled,e.colorModeForRenderPass());y()}else{for(const p of l)ky(p.mesh,p.nodeModelMatrix,e,r);for(const p of A)ky(p.mesh,p.nodeModelMatrix,e,r);y()}}},Xv={modelUpload:function(e,t,r){const s=t.getSource();if(!s.loaded())return;if("vector"===s.type||"geojson"===s.type)return void(e.modelManager&&e.modelManager.upload(e,r));if("batched-model"===s.type)return;const c=s.getModels();for(const d of c)d.upload(e.context)}};class bM{constructor(t,r,s){this.context=new ov(t,r),this.transform=s,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=Fa.maxUnderzooming+Fa.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new GT,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new SE(this),this._wireframeDebugCache=new _2,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(t,r){const s=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(s||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new gE(this,t));const c=this._terrain;this.transform.elevation=s?c:null,c.update(t,this.transform,r),this.transform.elevation&&!c.enabled&&(this.transform.elevation=null)}_updateFog(t){const r=t.fog;if(!r||"globe"===this.transform.projection.name||r.getOpacity(this.transform.pitch)<1||r.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[s,c]=r.getFovAdjustedRange(this.transform._fov);if(s>c)return void(this.transform.fogCullDistSq=null);const d=s+.78*(c-s);this.transform.fogCullDistSq=d*d}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(t,r){if(this.width=t*Mn.devicePixelRatio,this.height=r*Mn.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const s of this.style.order)this.style._mergedLayers[s].resize()}setup(){const t=this.context,r=new pa;r.emplaceBack(0,0),r.emplaceBack(Dt,0),r.emplaceBack(0,Dt),r.emplaceBack(Dt,Dt),this.tileExtentBuffer=t.createVertexBuffer(r,Cp.members),this.tileExtentSegments=lo.simpleSegment(0,0,4,2);const s=new pa;s.emplaceBack(0,0),s.emplaceBack(Dt,0),s.emplaceBack(0,Dt),s.emplaceBack(Dt,Dt),this.debugBuffer=t.createVertexBuffer(s,Cp.members),this.debugSegments=lo.simpleSegment(0,0,4,5);const c=new pa;c.emplaceBack(-1,-1),c.emplaceBack(1,-1),c.emplaceBack(-1,1),c.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(c,Cp.members),this.viewportSegments=lo.simpleSegment(0,0,4,2);const d=new nl;d.emplaceBack(0,0,0,0),d.emplaceBack(Dt,0,Dt,0),d.emplaceBack(0,Dt,0,Dt),d.emplaceBack(Dt,Dt,Dt,Dt),this.mercatorBoundsBuffer=t.createVertexBuffer(d,$1.members),this.mercatorBoundsSegments=lo.simpleSegment(0,0,4,2);const f=new Mi;f.emplaceBack(0,1,2),f.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(f);const g=new c_;for(const b of[0,1,3,2,0])g.emplaceBack(b);this.debugIndexBuffer=t.createIndexBuffer(g),this.emptyTexture=new xo(t,new Ui({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=bt.create();const y=this.context.gl;this.stencilClearMode=new Gn({func:y.ALWAYS,mask:0},0,255,y.ZERO,y.ZERO,y.ZERO),this.loadTimeStamps.push(lt.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,t.TRIANGLES,Pn.disabled,this.stencilClearMode,Sr.disabled,Jn.disabled,Im(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,r,s){if(!r||this.currentStencilSource===r.id||!t.isTileClipped()||!s||0===s.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let g=!1;for(const y of s)if(void 0===this._tileClippingMaskIDs[y.key]){g=!0;break}if(!g)return}this.currentStencilSource=r.id;const c=this.context,d=c.gl;this.nextStencilID+s.length>256&&this.clearStencil(),c.setColorMode(Sr.disabled),c.setDepthMode(Pn.disabled);const f=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const g of s){const y=r.getTile(g),b=this._tileClippingMaskIDs[g.key]=this.nextStencilID++,{tileBoundsBuffer:C,tileBoundsIndexBuffer:P,tileBoundsSegments:E}=this.getTileBoundsBuffers(y);f.draw(this,d.TRIANGLES,Pn.disabled,new Gn({func:d.ALWAYS,mask:0},b,255,d.KEEP,d.KEEP,d.REPLACE),Sr.disabled,Jn.disabled,Im(g.projMatrix),"$clipping",C,P,E)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,r=this.context.gl;return new Gn({func:r.NOTEQUAL,mask:255},t,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const r=this.context.gl;return new Gn({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,r.KEEP,r.KEEP,r.REPLACE)}stencilConfigForOverlap(t){const r=this.context.gl,s=t.sort((f,g)=>g.overscaledZ-f.overscaledZ),c=s[s.length-1].overscaledZ,d=s[0].overscaledZ-c+1;if(d>1){this.currentStencilSource=void 0,this.nextStencilID+d>256&&this.clearStencil();const f={};for(let g=0;g<d;g++)f[g+c]=new Gn({func:r.GEQUAL,mask:255},g+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=d,[f,s]}return[{[c]:Gn.disabled},s]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Sr([t.CONSTANT_COLOR,t.ONE,t.CONSTANT_COLOR,t.ONE],new bn(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Sr.unblended:Sr.alphaBlended}colorModeForDrapableLayerRenderPass(t){const r=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&"translucent"===this.renderPass?new Sr([r.ONE,r.ONE_MINUS_SRC_ALPHA,r.CONSTANT_ALPHA,r.ONE_MINUS_SRC_ALPHA],new bn(0,0,0,void 0===t?0:t),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(t,r,s,c=!1){if(!this.opaquePassEnabledForLayer()&&!c)return Pn.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Pn(s||this.context.gl.LEQUAL,r,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,r){this._wireframeDebugCache.update(this.frameCounter),this.style=t,this.options=r;const s=this.style._mergedLayers,c=this.style.order,d=c.map(O=>s[O]),f=this.style._mergedSourceCaches;this.imageManager=t.imageManager,this.modelManager=t.modelManager,this.symbolFadeChange=t.placement.symbolFadeChange(Mn.now()),this.imageManager.beginFrame();let g=0,y=!1;for(const O in f){const T=f[O];T.used&&(T.prepare(this.context),T.getSource().usedInConflation&&++g)}const b={},C={},P={},E={},I={};for(const O in f){const T=f[O];b[O]=T.getVisibleCoordinates(),C[O]=b[O].slice().reverse(),P[O]=T.getVisibleCoordinates(!0).reverse(),E[O]=T.getShadowCasterCoordinates(),I[O]=T.sortCoordinatesByDistance(b[O])}const A=O=>{const T=this.style.getLayerSourceCache(O);return T&&T.used?T.getSource():null};if(g){const O=[];for(const T of d)this.layerUsedInConflation(T,A(T))&&O.push(T);if(O&&O.length>1){const T=[];for(const k of O){const N=this.style.getLayerSourceCache(k);N&&N.used&&N.getSource().usedInConflation&&T.push({layer:k.fqid,cache:N})}this.replacementSource.setSources(T),y=!0}}y||this.replacementSource.clear(),this.conflationActive=y,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const O of d){const T=O.cutoffRange();if(this.longestCutoffRange=Math.max(T,this.longestCutoffRange),T>0){const k=A(O);k&&(this.minCutoffZoom=Math.max(k.minzoom,this.minCutoffZoom)),O.minzoom&&(this.minCutoffZoom=Math.max(O.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let O=0;O<d.length;O++)if(d[O].is3D()){this.opaquePassCutoff=O;break}const l=this.style&&this.style.fog;l?(this._fogVisible=0!==l.getOpacity(this.transform.pitch),this._fogVisible&&"globe"!==this.transform.projection.name&&(this._fogVisible=l.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(P),this.opaquePassCutoff=0);const u=this._shadowRenderer;if(u){u.updateShadowParameters(this.transform,this.style.directionalLight);for(const O in f)for(const T of b[O]){let k={min:0,max:0};this.terrain&&(k=this.terrain.getMinMaxForTile(T)||k),u.addShadowReceiver(T.toUnwrapped(),k.min,k.max)}}"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new d1(this.context));for(const O of d){if(O.isHidden(this.transform.zoom))continue;const T=t.getLayerSourceCache(O);this.uploadLayer(this,O,T)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new eg),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!zr.has(this.context.gl))return;this.renderPass="offscreen";for(const O of d){const T=t.getLayerSourceCache(O);if(!O.hasOffscreenPass()||O.isHidden(this.transform.zoom))continue;const k=T?C[T.id]:void 0;("custom"===O.type||"raster"===O.type||O.isSky()||k&&k.length)&&this.renderLayer(this,T,O,k)}this.depthRangeFor3D=[0,1-(d.length+2)*this.numSublayers*this.depthEpsilon];const p=this.terrain;p&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&p.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,E)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const m="globe"===this.transform.projection.name||this.transform.isHorizonVisible(),v=(()=>{if(r.showOverdrawInspector)return bn.black;if(this.style.fog&&this.transform.projection.supportsFog&&!m){const O=this.style.fog.properties.get("color").toArray01();return new bn(...O)}if(this.style.fog&&this.transform.projection.supportsFog&&m){const O=this.style.fog.properties.get("space-color").toArray01();return new bn(...O)}return bn.transparent})();if(this.context.clear({color:v,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&m&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const O=d[this.currentLayer],T=t.getLayerSourceCache(O);if(O.isSky())continue;const k=T?(O.is3D()?I:C)[T.id]:void 0;this._renderTileClippingMasks(O,T,k),this.renderLayer(this,T,O,k)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&m&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||Pi(this.transform.zoom)>0)&&("globe"===this.transform.projection.name||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const O=d[this.currentLayer],T=t.getLayerSourceCache(O);O.isSky()&&this.renderLayer(this,T,O,T?C[T.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let M=0;for(u&&(M=u.getShadowCastingLayerCount());this.currentLayer<c.length;){const O=d[this.currentLayer],T=t.getLayerSourceCache(O);if(O.isSky()){++this.currentLayer;continue}if(p&&this.style.isLayerDraped(O)){if(O.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=p.renderBatch(this.currentLayer);continue}let k;if(T&&(k=("symbol"===O.type?P:O.is3D()?I:C)[T.id]),this._renderTileClippingMasks(O,T,T?b[T.id]:void 0),this.renderLayer(this,T,O,k),!p&&u&&M>0&&O.hasShadowPass()&&0==--M&&(u.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const N=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=N;this.currentLayer++){const F=d[this.currentLayer];if(!F.hasLightBeamPass())continue;const $=t.getLayerSourceCache(F);this.renderLayer(this,$,F,$?C[$.id]:void 0)}this.currentLayer=N,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let O=null;d.forEach(T=>{const k=t.getLayerSourceCache(T);k&&!T.isHidden(this.transform.zoom)&&k.getVisibleCoordinates().length&&(!O||O.getSource().maxzoom<k.getSource().maxzoom)&&(O=k)}),O&&this.options.showTileBoundaries&&TE.debug(this,O,O.getVisibleCoordinates())}this.options.showPadding&&function(O){const T=O.transform.padding;Dy(O,O.transform.height-(T.top||0),3,xE),Dy(O,T.bottom||0,3,_M),wE(O,T.left||0,3,Gv),wE(O,O.transform.width-(T.right||0),3,Hv);const k=O.transform.centerPoint;var N,F,$,q;$s(N=O,(F=k.x)-1,($=O.transform.height-k.y)-10,2,20,q=g2),$s(N,F-10,$-1,20,2,q)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(lt.performance.now()),this.saveCanvasCopy()),y||(this.conflationActive=!1)}uploadLayer(t,r,s){this.gpuTimingStart(r),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(r.type)||t.terrain&&"custom"===r.type)&&Xv[`${r.type}Upload`]&&Xv[`${r.type}Upload`](t,s,r.scope),this.gpuTimingEnd()}renderLayer(t,r,s,c){s.isHidden(this.transform.zoom)||("background"===s.type||"sky"===s.type||"custom"===s.type||"model"===s.type||"raster"===s.type||c&&c.length)&&(this.id=s.id,this.gpuTimingStart(s),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(s.type)||t.terrain&&"custom"===s.type)&&TE[s.type](t,r,s,c,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery,s=this.context.gl;let c=this.gpuTimers[t.id];c||(c=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:s.createQuery()}),c.calls++,s.beginQuery(r.TIME_ELAPSED_EXT,c.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,r=this.context.gl,s=r.createQuery();this.deferredRenderGpuTimeQueries.push(s),r.beginQuery(t.TIME_ELAPSED_EXT,s)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const r={};for(const s in t){const c=t[s],d=this.context.extTimerQuery,f=d.getQueryParameter(c.query,this.context.gl.QUERY_RESULT)/1e6;d.deleteQueryEXT(c.query),r[s]=f}return r}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const r=this.context.extTimerQuery,s=this.context.gl;let c=0;for(const d of t)c+=r.getQueryParameter(d,s.QUERY_RESULT)/1e6,r.deleteQueryEXT(d);return c}translatePosMatrix(t,r,s,c,d){if(!s[0]&&!s[1])return t;const f=d?"map"===c?this.transform.angle:0:"viewport"===c?-this.transform.angle:0;if(f){const b=Math.sin(f),C=Math.cos(f);s=[s[0]*C-s[1]*b,s[0]*b+s[1]*C]}const g=[d?s[0]:td(r,s[0],this.transform.zoom),d?s[1]:td(r,s[1],this.transform.zoom),0],y=new Float32Array(16);return bt.translate(y,t,g),y}saveTileTexture(t){const r=t.size[0],s=this._tileTextures[r];s?s.push(t):this._tileTextures[r]=[t]}getTileTexture(t){const r=this._tileTextures[t];return r&&r.length>0?r.pop():null}isPatternMissing(t,r){return null===t||void 0!==t&&!this.imageManager.getPattern(t.toString(),r)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}linearFloatFilteringSupported(){return null!=this.context.extTextureFloatLinear}currentGlobalDefines(t,r,s){const c=void 0===s?this.terrain&&this.terrain.renderingToTexture:s,d=this.terrain&&0===this.terrain.exaggeration(),f=[];return this.style&&this.style.enable3dLights()&&("globeRaster"===t||"terrainRaster"===t?(f.push("LIGHTING_3D_MODE"),f.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):c||f.push("LIGHTING_3D_MODE")),"shadow"===this.renderPass?this._shadowMapDebug||f.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?f.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):f.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(f.push("TERRAIN"),this.linearFloatFilteringSupported()&&f.push("TERRAIN_DEM_FLOAT_FORMAT"),d&&f.push("ZERO_EXAGGERATION")),"globe"===this.transform.projection.name&&f.push("GLOBE"),!this._fogVisible||c||void 0!==r&&!r||f.push("FOG","FOG_DITHERING"),c&&f.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&f.push("OVERDRAW_INSPECTOR"),f}getOrCreateProgram(t,r){this.cache=this.cache||{};const s=r&&r.defines||[],c=r&&r.config,d=this.currentGlobalDefines(t,r&&r.overrideFog,r&&r.overrideRtt).concat(s),f=cM.cacheKey(iM[t],t,d,c);return this.cache[f]||(this.cache[f]=new cM(this.context,t,iM[t],c,Zx[t],d)),this.cache[f]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=lt.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new xo(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(t,r){if(this.style.enable3dLights()){const s=this.style.directionalLight,c=this.style.ambientLight;if(s&&c){const d=((f,g)=>{const y=f.properties.get("direction"),b=f.properties.get("color").toArray01(),C=f.properties.get("intensity"),P=g.properties.get("color").toArray01(),E=g.properties.get("intensity"),I=[y.x,y.y,y.z],A=Fr(P,E),l=Fr(b,C);return{u_lighting_ambient_color:A,u_lighting_directional_dir:I,u_lighting_directional_color:l,u_ground_radiance:i2(I,l,A)}})(s,c);r.setLightsUniformValues(t,d)}}}uploadCommonUniforms(t,r,s,c,d){if(this.uploadCommonLightUniforms(t,r),this.terrain&&this.terrain.renderingToTexture)return;const f=this.style.fog;if(f){const g=f.getOpacity(this.transform.pitch),y=((b,C,P,E,I,A,l,u,p,m,v,M)=>{const O=b.transform,T=C.properties.get("color").toArray01();T[3]=E;const k=b.frameCounter/1e3%1,[N,F]=C.properties.get("vertical-range");return{u_fog_matrix:P?O.calculateFogTileMatrix(P):M||b.identityMat,u_fog_range:C.getFovAdjustedRange(O._fov),u_fog_color:T,u_fog_horizon_blend:C.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(N,F),F],u_fog_temporal_offset:k,u_frustum_tl:I,u_frustum_tr:A,u_frustum_br:l,u_frustum_bl:u,u_globe_pos:p,u_globe_radius:m,u_viewport:v,u_globe_transition:Pi(O.zoom),u_is_globe:+("globe"===O.projection.name)}})(this,f,s,g,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*Mn.devicePixelRatio,this.transform.height*Mn.devicePixelRatio],c);r.setFogUniformValues(t,y)}d&&r.setCutoffUniformValues(t,d.uniformValues)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),r}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&0!==t.getOpacity(this.transform.pitch)}getBackgroundTiles(){const t=this._backgroundTiles,r=this._backgroundTiles={},s=this.transform.coveringTiles({tileSize:512});for(const c of s)r[c.key]=t[c.key]||new Ki(c,512,this.transform.tileZoom,this);return r}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(t,r){return!(!t.is3D()||t.minzoom&&t.minzoom>this.transform.zoom||"building"!==t.sourceLayer&&(!r||"batched-model"!==r.type))}isTileAffectedByFog(t){if(!this.style||!this.style.fog)return!1;if("globe"===this.transform.projection.name)return!0;let r=this._cachedTileFogOpacities[t.key];return r||(this._cachedTileFogOpacities[t.key]=r=this.style.fog.getOpacityForTile(t)),r[0]>=rd||r[1]>=rd}}const Lf=2048;class IE{constructor(t,r){this.aabb=t,this.lastCascade=r}}class xM{add(t,r){const s=this.receivers[t.key];void 0!==s?(s.aabb.min[0]=Math.min(s.aabb.min[0],r.min[0]),s.aabb.min[1]=Math.min(s.aabb.min[1],r.min[1]),s.aabb.min[2]=Math.min(s.aabb.min[2],r.min[2]),s.aabb.max[0]=Math.max(s.aabb.max[0],r.max[0]),s.aabb.max[1]=Math.max(s.aabb.max[1],r.max[1]),s.aabb.max[2]=Math.max(s.aabb.max[2],r.max[2])):this.receivers[t.key]=new IE(r,null)}clear(){this.receivers={}}get(t){return this.receivers[t.key]}computeRequiredCascades(t,r,s){const c=yo.fromPoints(t.points);let d=0;for(const f in this.receivers){const g=this.receivers[f];if(!g||!c.intersectsAabb(g.aabb))continue;g.aabb.min=c.closestPoint(g.aabb.min),g.aabb.max=c.closestPoint(g.aabb.max);const y=g.aabb.getCorners();for(let b=0;b<s.length;b++){let C=!0;for(const P of y){const E=[P[0]*r,P[1]*r,P[2]];if(dt.transformMat4(E,E,s[b].matrix),E[0]<-1||E[0]>1||E[1]<-1||E[1]>1){C=!1;break}}if(g.lastCascade=b,d=Math.max(d,b),C)break}}return d+1}}class SE{constructor(t){this.painter=t,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new xM,this._depthMode=new Pn(t.context.gl.LEQUAL,Pn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1}destroy(){for(const t of this._cascades)t.texture.destroy(),t.framebuffer.destroy();this._cascades=[]}updateShadowParameters(t,r){const s=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!r||!r.properties)return;const c=r.properties.get("shadow-intensity");if(!r.shadowsEnabled()||c<=0||(this._shadowLayerCount=s.style.order.reduce((I,A)=>{const l=s.style._mergedLayers[A];return I+(l.hasShadowPass()&&!l.isHidden(t.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const d=s.context,f=Lf,g=Lf;if(0===this._cascades.length)for(let I=0;I<2;++I){const A=s._shadowMapDebug,l=d.gl,u=d.createFramebuffer(f,g,A,"texture"),p=new xo(d,{width:f,height:g,data:null},l.DEPTH_COMPONENT);if(u.depthAttachment.set(p.texture),A){const m=new xo(d,{width:f,height:g,data:null},l.RGBA);u.colorAttachment.set(m.texture)}this._cascades.push({framebuffer:u,texture:p,matrix:[],far:0,boundingSphereRadius:0,frustum:new sc,scale:0})}this.shadowDirection=Xx(r);let y=0;if(t.elevation){const I=t.elevation,A=[1e4,-1e4];I.visibleDemTiles.filter(l=>l.dem).forEach(l=>{const u=l.dem.tree;A[0]=Math.min(A[0],u.minimums[0]),A[1]=Math.max(A[1],u.maximums[0])}),1e4!==A[0]&&(y=(A[1]-A[0])*I.exaggeration())}const b=1.5*t.cameraToCenterDistance,C=3*b,P=new Float64Array(16);for(let I=0;I<2;++I){const A=this._cascades[I];let l=t.height/50,u=1;0===I?u=b:(l=b,u=C);const[p,m]=y2(t,this.shadowDirection,l,u,Lf,y);A.scale=t.scale,A.matrix=p,A.boundingSphereRadius=m,bt.invert(P,A.matrix),A.frustum=sc.fromInvProjectionMatrix(P,1,0,!0),A.far=u}this._uniformValues.u_fade_range=[.75*this._cascades[1].far,this._cascades[1].far],this._uniformValues.u_shadow_intensity=c,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=.00048828125,this._uniformValues.u_shadow_map_resolution=Lf,this._uniformValues.u_shadowmap_0=js.ShadowMap0,this._uniformValues.u_shadowmap_1=js.ShadowMap0+1,this._groundShadowTiles=s.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const E=s.transform.elevation;for(const I of this._groundShadowTiles){let A={min:0,max:0};if(E){const l=E.getMinMaxForTile(I);l&&(A=l)}this.addShadowReceiver(I.toUnwrapped(),A.min,A.max)}}get enabled(){return this._enabled}set enabled(t){this._enabled=t}drawShadowPass(t,r){if(!this._enabled)return;const s=this.painter,c=s.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(s.transform.getFrustum(0),s.transform.worldSize,this._cascades),c.viewport.set([0,0,Lf,Lf]);for(let d=0;d<this._numCascadesToRender;++d){s.currentShadowCascade=d,c.bindFramebuffer.set(this._cascades[d].framebuffer.framebuffer),c.clear({color:bn.white,depth:1});for(const f of t.order){const g=t._mergedLayers[f];if(!g.hasShadowPass()||g.isHidden(s.transform.zoom))continue;const y=t.getLayerSourceCache(g),b=y?r[y.id]:void 0;("model"===g.type||b&&b.length)&&s.renderLayer(s,y,g,b)}}s.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const t=this.painter,r=t.style,s=t.context,c=r.directionalLight,d=r.ambientLight;if(!c||!d)return;const f=[],g=Tm(t,t.longestCutoffRange);g.shouldRenderCutoff&&f.push("RENDER_CUTOFF");const y=wM(c,d),b=new Pn(s.gl.LEQUAL,Pn.ReadOnly,t.depthRangeFor3D);for(const C of this._groundShadowTiles){const P=C.toUnwrapped(),E=t.isTileAffectedByFog(C),I=t.getOrCreateProgram("groundShadow",{defines:f,overrideFog:E});this.setupShadows(P,I),t.uploadCommonUniforms(s,I,P,null,g);const A={u_matrix:t.transform.calculateProjMatrix(P),u_ground_shadow_factor:y};I.draw(t,s.gl.TRIANGLES,b,Gn.disabled,Sr.multiply,Jn.disabled,A,"ground_shadow",t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments,{},t.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Sr.unblended:Sr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(t){const r=this.painter.transform,s=r.calculatePosMatrix(t,r.worldSize);return bt.multiply(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}calculateShadowPassMatrixFromMatrix(t){return bt.multiply(t,this._cascades[this.painter.currentShadowCascade].matrix,t),Float32Array.from(t)}setupShadows(t,r,s,c=0){if(!this._enabled)return;const d=this.painter.transform,f=this.painter.context,g=f.gl,y=this._uniformValues,b=new Float64Array(16),C=d.calculatePosMatrix(t,d.worldSize);for(let P=0;P<2;P++)bt.multiply(b,this._cascades[P].matrix,C),y[0===P?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(b),f.activeTexture.set(g.TEXTURE0+js.ShadowMap0+P),this._cascades[P].texture.bind(g.NEAREST,g.CLAMP_TO_EDGE);if(this.useNormalOffset=!!s,this.useNormalOffset){const P=Tp(t.canonical),E=2/d.tileSize*Dt/Lf,I=E*this._cascades[0].boundingSphereRadius,A=E*this._cascades[1].boundingSphereRadius,l=("vector-tile"===s?1:3)/Math.pow(2,c-t.canonical.z-(1-d.zoom+Math.floor(d.zoom)));y.u_shadow_normal_offset=[P,I*l,A*l],y.u_shadow_bias=[6e-5,.0012,.012]}else y.u_shadow_bias=[36e-5,.0012,.012];r.setShadowUniformValues(f,y)}setupShadowsFromMatrix(t,r,s=!1){if(!this._enabled)return;const c=this.painter.context,d=c.gl,f=this._uniformValues,g=new Float64Array(16);for(let y=0;y<2;y++)bt.multiply(g,this._cascades[y].matrix,t),f[0===y?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(g),c.activeTexture.set(d.TEXTURE0+js.ShadowMap0+y),this._cascades[y].texture.bind(d.NEAREST,d.CLAMP_TO_EDGE);this.useNormalOffset=s,s?(f.u_shadow_normal_offset=[1,5,5],f.u_shadow_bias=[6e-5,.0012,.012]):f.u_shadow_bias=[36e-5,.0012,.012],r.setShadowUniformValues(c,f)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(t,r,s,c){if(c[2]>=0)return{};const d=function(y,b,C){const P=C/(1<<y.canonical.z);return new yo([y.canonical.x*P+y.wrap*C,y.canonical.y*P+y.wrap*C,0],[(y.canonical.x+1)*P+y.wrap*C,(y.canonical.y+1)*P+y.wrap*C,b])}(t,r,s).getCorners(),f=r/-c[2];c[0]<0?(dt.add(d[0],d[0],[c[0]*f,0,0]),dt.add(d[3],d[3],[c[0]*f,0,0])):c[0]>0&&(dt.add(d[1],d[1],[c[0]*f,0,0]),dt.add(d[2],d[2],[c[0]*f,0,0])),c[1]<0?(dt.add(d[0],d[0],[0,c[1]*f,0]),dt.add(d[1],d[1],[0,c[1]*f,0])):c[1]>0&&(dt.add(d[2],d[2],[0,c[1]*f,0]),dt.add(d[3],d[3],[0,c[1]*f,0]));const g={};return g.vertices=d,g.planes=[id(d[1],d[0],d[4]),id(d[2],d[1],d[5]),id(d[3],d[2],d[6]),id(d[0],d[3],d[7])],g}addShadowReceiver(t,r,s){this._receivers.add(t,yo.fromTileIdAndHeight(t,r,s))}getMaxCascadeForTile(t){const r=this._receivers.get(t);return r&&r.lastCascade?r.lastCascade:0}}function id(e,t,r){const s=dt.sub([],r,t),c=dt.sub([],e,t),d=dt.cross([],s,c),f=dt.length(d);return 0===f?[0,0,1,0]:(dt.scale(d,d,1/f),[d[0],d[1],d[2],-dt.dot(d,t)])}function Xx(e){const t=e.properties.get("direction"),r=Ge(t.x,t.y,t.z);r[2]=Ne(r[2],0,75);const s=Pe([r[0],r[1],r[2]]);return dt.fromValues(s.x,s.y,s.z)}function wM(e,t){const r=e.properties.get("color"),s=e.properties.get("intensity"),c=e.properties.get("direction"),d=[c.x,c.y,c.z],f=t.properties.get("color"),g=t.properties.get("intensity"),y=Math.max(dt.dot([0,0,1],d),0),b=[0,0,0];dt.scale(b,f.toArray01Linear().slice(0,3),g);const C=[0,0,0];return dt.scale(C,r.toArray01Linear().slice(0,3),y*s),Xr([b[0]>0?b[0]/(b[0]+C[0]):0,b[1]>0?b[1]/(b[1]+C[1]):0,b[2]>0?b[2]/(b[2]+C[2]):0])}function y2(e,t,r,s,c,d){const f=e.zoom,g=e.scale,y=e.worldSize,b=1/y,C=e.aspect,P=Math.sqrt(1+C*C)*Math.tan(.5*e.fovX),E=P*P,I=s-r,A=s+r;let l,u;E>I/A?(l=s,u=s*P):(l=.5*A*(1+E),u=.5*Math.sqrt(I*I+2*(s*s+r*r)*E+A*A*E*E));const p=e.projection.pixelsPerMeter(e.center.lat,y),m=e._camera.getCameraToWorldMercator(),v=[0,0,-l*b];dt.transformMat4(v,v,m);let M=u*b;const O=e._edgeInsets;if(!(0===O.left&&0===O.top&&0===O.right&&0===O.bottom||O.left===O.right&&O.top===O.bottom)){const Et=e._camera.getWorldToCamera(e.worldSize,"meters"===e.projection.zAxisUnit?p:1),Tt=e._camera.getCameraToClipPerspective(e._fov,e.width/e.height,r,s);Tt[8]=2*-e.centerOffset.x/e.width,Tt[9]=2*e.centerOffset.y/e.height;const zt=new Float64Array(16);bt.mul(zt,Tt,Et);const Nt=new Float64Array(16);bt.invert(Nt,zt);const $t=sc.fromInvProjectionMatrix(Nt,y,f,!0);for(const Rt of $t.points){const oe=((T=Rt)[0]/=g,T[1]/=g,T[2]=oo(T[2],e._center.lat),T);M=Math.max(M,dt.len(dt.subtract([],v,oe)))}}var T;M*=c/(c-1);const k=Math.acos(t[2]),N=Math.atan2(-t[0],-t[1]),F=new sv;F.position=v,F.setPitchBearing(k,N);const $=F.getWorldToCamera(y,p),q=M*y,Z=Math.min(e._mercatorZfromZoom(17)*y*-2,-2*q),X=F.getCameraToClipOrthographic(-q,q,-q,q,Z,(q+d*p)/t[2]),K=new Float64Array(16);bt.multiply(K,X,$);const J=dt.fromValues(Math.floor(1e6*v[0])/1e6*y,Math.floor(1e6*v[1])/1e6*y,0),st=.5*c,it=[0,0,0];dt.transformMat4(it,J,K),dt.scale(it,it,st);const rt=[Math.floor(it[0]),Math.floor(it[1]),Math.floor(it[2])],ct=[0,0,0];dt.sub(ct,it,rt),dt.scale(ct,ct,-1/st);const yt=new Float64Array(16);return bt.identity(yt),bt.translate(yt,yt,ct),bt.multiply(K,yt,K),[K,q]}class v2 extends Ro{constructor(t){super(),this.requestManager=t,this.models={"":{}},this.numModelsLoading={}}loadModel(t,r){return qO(this.requestManager.transformRequest(r,Ft.Model).url).then(s=>{if(!s)return;const c=bm(s),d=new pl(t,void 0,void 0,c);return d.computeBoundsAndApplyParent(),d}).catch(s=>{this.fire(new Cn(new Error(`Could not load model ${t} from ${r}: ${s.message}`)))})}load(t,r){this.models[r]||(this.models[r]={});const s=Object.keys(t);this.numModelsLoading[r]=(this.numModelsLoading[r]||0)+s.length;const c=[];for(const d of s)c.push(this.loadModel(d,t[d]));Promise.allSettled(c).then(d=>{for(let f=0;f<d.length;f++){const{status:g,value:y}=d[f];"fulfilled"===g&&y&&(this.models[r][s[f]]=y)}this.numModelsLoading[r]-=s.length,this.fire(new de("data",{dataType:"style"}))}).catch(d=>{this.fire(new Cn(new Error(`Could not load models: ${d.message}`)))})}isLoaded(){for(const t in this.numModelsLoading)if(this.numModelsLoading[t]>0)return!1;return!0}hasModel(t,r){return!!this.getModel(t,r)}getModel(t,r){return this.models[r]||(this.models[r]={}),this.models[r][t]}addModel(t,r,s){this.models[s]||(this.models[s]={}),this.hasModel(t,s)&&this.removeModel(t,s),this.load({[t]:this.requestManager.normalizeModelURL(r)},s)}addModels(t,r){const s={};for(const c in t)s[c]=this.requestManager.normalizeModelURL(t[c]);this.load(s,r)}removeModel(t,r){this.models[r]||(this.models[r]={});const s=this.models[r][t];delete this.models[r][t],s.destroy()}listModels(t){return this.models[t]||(this.models[t]={}),Object.keys(this.models[t])}upload(t,r){this.models[r]||(this.models[r]={});for(const s in this.models[r])this.models[r][s].upload(t.context)}}const Qx=(e,t)=>Uh(e,t&&t.filter(r=>"source.canvas"!==r.identifier)),hA=he(Vr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","setImportUrl","setImportData","setImportConfig"]),ng=he(Vr,["setCenter","setZoom","setBearing","setPitch"]),km={version:8,layers:[],sources:{}},Qv={duration:300,delay:0},Jv=new Set(["fill","line","background","hillshade","raster"]);class ph extends Ro{constructor(t,r={}){super(),this.map=t,this.scope=r.scope||"",this.fragments=[],this.importDepth=r.importDepth||0,this.importsCache=r.importsCache||new Map,this.resolvedImports=r.resolvedImports||new Set,this.transition=_t({},Qv),this._buildingIndex=new t2(this),this.crossTileSymbolIndex=new eM,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=r.styleChanges||new jh,this.dispatcher=r.dispatcher?r.dispatcher:new _m(dh(),this),r.imageManager?this.imageManager=r.imageManager:(this.imageManager=new py,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=r.glyphManager?r.glyphManager:new Xd(t._requestManager,r.localFontFamily?2:r.localIdeographFontFamily?1:0,r.localFontFamily||r.localIdeographFontFamily),r.modelManager?this.modelManager=r.modelManager:(this.modelManager=new v2(t._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=new Map,this._configDependentLayers=new Set,this._config=r.config,this.dispatcher.broadcast("setReferrer",te());const s=this;this._rtlTextPluginCallback=ph.registerForPluginStateChange(c=>{s.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:c.pluginStatus,pluginURL:c.pluginURL},(d,f)=>{if(_i(d),f&&f.every(g=>g))for(const g in s._sourceCaches){const y=s._sourceCaches[g],b=y.getSource().type;"vector"!==b&&"geojson"!==b||y.reload()}})}),this.on("data",c=>{if("source"!==c.dataType||"metadata"!==c.sourceDataType)return;const d=this.getOwnSource(c.sourceId);if(d&&d.vectorLayerIds)for(const f in this._layers){const g=this._layers[f];g.source===d.id&&this._validateLayer(g)}})}loadURL(t,r={}){this.fire(new de("dataloading",{dataType:"style"}));const s="boolean"==typeof r.validate?r.validate:!Ke(t);t=this.map._requestManager.normalizeStyleURL(t,r.accessToken),this.resolvedImports.add(t);const c=this.importsCache.get(t);if(c)return this._load(c,s);const d=this.map._requestManager.transformRequest(t,Ft.Style);this._request=_e(d,(f,g)=>{if(this._request=null,f)this.fire(new Cn(f));else if(g)return this.importsCache.set(t,g),this._load(g,s)})}loadJSON(t,r={}){this.fire(new de("dataloading",{dataType:"style"})),this._request=Mn.frame(()=>{this._request=null,this._load(t,!1!==r.validate)})}loadEmpty(){this.fire(new de("dataloading",{dataType:"style"})),this._load(km,!1)}_loadImports(t,r){if(this.importDepth>=4)return gt("Style doesn't support nesting deeper than 5"),Promise.resolve();const s=[];for(const c of t){const d=this._createFragmentStyle(c),f=new Promise(y=>{d.once("style.import.load",y),d.once("error",y)}).then(()=>this.mergeAll());if(s.push(f),this.resolvedImports.has(c.url)){d.loadEmpty();continue}const g=c.data||this.importsCache.get(c.url);g?d.loadJSON(g,{validate:r}):c.url?d.loadURL(c.url,{validate:r}):d.loadEmpty(),this.fragments.push({style:d,id:c.id,config:c.config})}return Promise.allSettled(s)}_createFragmentStyle(t){const r=this.scope?sn(t.id,this.scope):t.id,s=new ph(this.map,{scope:r,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:t.config});return s.setEventedParent(this.map,{style:s}),s}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options});const t=this.isRootStyle();this._shouldPrecompile=t,this.fire(new de(t?"style.load":"style.import.load"))}_load(t,r){const s=t.schema;if(this.isRootStyle()&&(t.fragment||s&&!1!==t.fragment)){const f=_t({},km,{imports:[{id:"basemap",data:t,url:""}]});return void this._load(f,r)}if(this.setConfig(this._config,s),r&&Qx(this,Ea(t)))return;this._loaded=!0,this.stylesheet=et(t);for(const f in t.sources)this.addSource(f,t.sources[f],{validate:!1,isInitialLoad:!0});t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(t.glyphs,this.scope);const c=Dx(this.stylesheet.layers);if(this._order=c.map(f=>f.id),this.stylesheet.light&&gt("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(1===this.stylesheet.lights.length&&"flat"===this.stylesheet.lights[0].type){const f=this.stylesheet.lights[0];this.light=new mm(f.properties,f.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new mm(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const f of c){const g=Kp(f,this.options);g.setScope(this.scope),g.isConfigDependent&&this._configDependentLayers.add(g.fqid),g.setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g,this._serializedLayers[g.id]=g.serialize();const y=this.getOwnLayerSourceCache(g),b=!!this.directionalLight&&this.directionalLight.shadowsEnabled();y&&g.canCastShadows()&&b&&(y.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const d=this.stylesheet.terrain;d&&(void 0===this.disableElevatedTerrain&&(this.disableElevatedTerrain=Mn.hasCanvasFingerprintNoise()),this.disableElevatedTerrain?gt("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."):this.terrainSetForDrapingOnly()||this._createTerrain(d,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new de("data",{dataType:"style"})),t.imports?this._loadImports(t.imports,r).then(()=>this._reloadImports()):this._reloadImports()}isRootStyle(){return 0===this.importDepth}mergeAll(){let t,r,s,c,d,f,g,y;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(b=>{if(b.stylesheet){if(null!=b.light&&(t=b.light),b.stylesheet.lights)for(const C of b.stylesheet.lights)"ambient"===C.type&&null!=b.ambientLight&&(r=b.ambientLight),"directional"===C.type&&null!=b.directionalLight&&(s=b.directionalLight);c=this._prioritizeTerrain(c,b.terrain,b.stylesheet.terrain),b.stylesheet.fog&&null!=b.fog&&(d=b.fog),null!=b.stylesheet.camera&&(y=b.stylesheet.camera),null!=b.stylesheet.projection&&(f=b.stylesheet.projection),null!=b.stylesheet.transition&&(g=b.stylesheet.transition)}}),this.light=t,this.ambientLight=r,this.directionalLight=s,this.fog=d,null===c?delete this.terrain:this.terrain=c,this.camera=y||{"camera-projection":"perspective"},this.projection=f||{name:"mercator"},this.transition=_t({},Qv,g),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(t){const r=s=>{for(const c of s.fragments)r(c.style);t(s)};r(this)}_prioritizeTerrain(t,r,s){const c=t&&0===t.drapeRenderMode;return null===s?r&&0===r.drapeRenderMode?r:c?t:null:null!=r&&(!t||c||r&&1===r.drapeRenderMode)?r:t}mergeTerrain(){let t;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(r=>{t=this._prioritizeTerrain(t,r.terrain,r.stylesheet.terrain)}),null===t?delete this.terrain:this.terrain=t}mergeProjection(){let t;this.forEachFragmentStyle(r=>{null!=r.stylesheet.projection&&(t=r.stylesheet.projection)}),this.projection=t||{name:"mercator"}}mergeSources(){const t={},r={},s={};this.forEachFragmentStyle(c=>{for(const d in c._sourceCaches){const f=sn(d,c.scope);t[f]=c._sourceCaches[d]}for(const d in c._otherSourceCaches){const f=sn(d,c.scope);r[f]=c._otherSourceCaches[d]}for(const d in c._symbolSourceCaches){const f=sn(d,c.scope);s[f]=c._symbolSourceCaches[d]}}),this._mergedSourceCaches=t,this._mergedOtherSourceCaches=r,this._mergedSymbolSourceCaches=s}mergeLayers(){const t={},r=[],s={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(d=>{for(const f of d._order){const g=d._layers[f];if("slot"===g.type){const y=to(f);if(t[y])continue;t[y]=[]}g.slot&&t[g.slot]?t[g.slot].push(g):r.push(g)}}),this._mergedOrder=[];const c=(d=[])=>{for(const f of d)if("slot"===f.type){const g=to(f.id);t[g]&&c(t[g])}else{const g=sn(f.id,f.scope);this._mergedOrder.push(g),s[g]=f,f.is3D()&&(this._has3DLayers=!0),"circle"===f.type&&(this._hasCircleLayers=!0),"symbol"===f.type&&(this._hasSymbolLayers=!0)}};c(r),this._mergedLayers=s,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}getCamera(){return this.stylesheet.camera}setCamera(t){return this.stylesheet.camera=_t({},this.stylesheet.camera,t),this.camera=this.stylesheet.camera,this}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(t){this._spriteRequest=function(r,s,c){let d,f,g;const y=Mn.devicePixelRatio>1?"@2x":"";let b=_e(s.transformRequest(s.normalizeSpriteURL(r,y,".json"),Ft.SpriteJSON),(E,I)=>{b=null,g||(g=E,d=I,P())}),C=Bt(s.transformRequest(s.normalizeSpriteURL(r,y,".png"),Ft.SpriteImage),(E,I)=>{C=null,g||(g=E,f=I,P())});function P(){if(g)c(g);else if(d&&f){const E=Mn.getImageData(f),I={};for(const A in d){const{width:l,height:u,x:p,y:m,sdf:v,pixelRatio:M,stretchX:O,stretchY:T,content:k}=d[A],N=new Ui({width:l,height:u});Ui.copy(E,N,{x:p,y:m},{x:0,y:0},{width:l,height:u}),I[A]={data:N,pixelRatio:M,sdf:v,stretchX:O,stretchY:T,content:k}}c(null,I)}}return{cancel(){b&&(b.cancel(),b=null),C&&(C.cancel(),C=null)}}}(t,this.map._requestManager,(r,s)=>{if(this._spriteRequest=null,r)this.fire(new Cn(r));else if(s)for(const c in s)this.imageManager.addImage(c,this.scope,s[c]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new de("data",{dataType:"style"}))})}_validateLayer(t){const r=this.getOwnSource(t.source);if(!r)return;const s=t.sourceLayer;s&&("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(s))&&this.fire(new Cn(new Error(`Source layer "${s}" does not exist on source "${r.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:t}of this.fragments)if(!t.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((t,r)=>{const s=this.fragments[r];return s&&s.style&&(t.data=s.style.serialize()),t})}_serializeSources(){const t={};for(const r in this._sourceCaches){const s=this._sourceCaches[r].getSource();t[s.id]||(t[s.id]=s.serialize())}return t}_serializeLayers(t){const r=[];for(const s of t){const c=this._layers[s];c&&"custom"!==c.type&&r.push(c.serialize())}return r}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(t){return!!this.terrain&&("function"==typeof t.isLayerDraped?t.isLayerDraped(this.getLayerSourceCache(t)):Jv.has(t.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(t){const r=this.getOwnLayer(t);if(r)return r;this.fire(new Cn(new Error(`The layer '${t}' does not exist in the map's style.`)))}_checkSource(t){const r=this.getOwnSource(t);if(r)return r;this.fire(new Cn(new Error(`The source '${t}' does not exist in the map's style.`)))}update(t){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(t),this.directionalLight&&this.directionalLight.recalculate(t);const r=this.calculateLightsBrightness();t.brightness=r||0,r!==this._brightness&&(this._brightness=r,this.dispatcher.broadcast("setBrightness",r));const s=this._changes.isDirty();if(this._changes.isDirty()){const d=this._changes.getLayerUpdatesByScope();for(const f in d){const{updatedIds:g,removedIds:y}=d[f];(g||y)&&this._updateWorkerLayers(f,g,y)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(t),this.light&&this.light.updateTransitions(t),this.ambientLight&&this.ambientLight.updateTransitions(t),this.directionalLight&&this.directionalLight.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._changes.reset()}const c={};for(const d in this._mergedSourceCaches){const f=this._mergedSourceCaches[d];c[d]=f.used,f.used=!1}for(const d of this._mergedOrder){const f=this._mergedLayers[d];if(f.recalculate(t,this._availableImages),!f.isHidden(t.zoom)){const g=this.getLayerSourceCache(f);g&&(g.used=!0)}if(!this._precompileDone&&this._shouldPrecompile)for(let g=f.minzoom||0;g<(f.maxzoom||25.5);g++){const y=this.map.painter;if(y){const b=f.getProgramIds();if(!b)continue;for(const C of b){const P=f.getDefaultProgramParams(C,t.zoom);P&&(y.style=this,this.fog&&(y._fogVisible=!0,P.overrideFog=!0,y.getOrCreateProgram(C,P)),y._fogVisible=!1,P.overrideFog=!1,y.getOrCreateProgram(C,P),(this.stylesheet.terrain||this.stylesheet.projection&&"globe"===this.stylesheet.projection.name)&&(P.overrideRtt=!0,y.getOrCreateProgram(C,P)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const d in c){const f=this._mergedSourceCaches[d];c[d]!==f.used&&f.getSource().fire(new de("data",{sourceDataType:"visibility",dataType:"source",sourceId:f.getSource().id}))}this.light&&this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),s&&this.fire(new de("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=this._changes.getUpdatedImages();if(t.length){for(const r in this._sourceCaches)this._sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],t);this._changes.resetUpdatedImages()}}_updateWorkerLayers(t,r,s){const c=this.getFragmentStyle(t);c&&this.dispatcher.broadcast("updateLayers",{layers:r?c._serializeLayers(r):[],scope:t,removedIds:s||[],options:c.options})}setState(t){if(this._checkLoaded(),Qx(this,Ea(t)))return!1;(t=et(t)).layers=Dx(t.layers);const r=function(c,d){if(!c)return[{command:Vr.setStyle,args:[d]}];let f=[];try{if(!Xt(c.version,d.version))return[{command:Vr.setStyle,args:[d]}];Xt(c.center,d.center)||f.push({command:Vr.setCenter,args:[d.center]}),Xt(c.zoom,d.zoom)||f.push({command:Vr.setZoom,args:[d.zoom]}),Xt(c.bearing,d.bearing)||f.push({command:Vr.setBearing,args:[d.bearing]}),Xt(c.pitch,d.pitch)||f.push({command:Vr.setPitch,args:[d.pitch]}),Xt(c.sprite,d.sprite)||f.push({command:Vr.setSprite,args:[d.sprite]}),Xt(c.glyphs,d.glyphs)||f.push({command:Vr.setGlyphs,args:[d.glyphs]}),Xt(c.imports,d.imports)||function(P=[],E=[],I){E=E||[];const A=(P=P||[]).map(Cm),l=E.map(Cm),u=P.reduce(Rl,{}),p=E.reduce(Rl,{}),m=A.slice();let v,M,O,T;for(v=0,M=0;v<A.length;v++)O=A[v],p.hasOwnProperty(O)?M++:(I.push({command:Vr.removeImport,args:[O]}),m.splice(m.indexOf(O,M),1));for(v=0,M=0;v<l.length;v++)O=l[l.length-1-v],m[m.length-1-v]!==O&&(u.hasOwnProperty(O)?(I.push({command:Vr.removeImport,args:[O]}),m.splice(m.lastIndexOf(O,m.length-M),1)):M++,T=m[m.length-v],I.push({command:Vr.addImport,args:[p[O],T]}),m.splice(m.length-v,0,O));for(const k of E){const N=u[k.id];if(!N||Xt(N,k))continue;Xt(N.config,k.config)||I.push({command:Vr.setImportConfig,args:[k.id,k.config]}),Xt(N.url,k.url)||I.push({command:Vr.setImportUrl,args:[k.id,k.url]});const F=k.data;Xt(N&&N.data,F)||I.push({command:Vr.setImportData,args:[k.id,F]})}}(c.imports,d.imports,f),Xt(c.transition,d.transition)||f.push({command:Vr.setTransition,args:[d.transition]}),Xt(c.light,d.light)||f.push({command:Vr.setLight,args:[d.light]}),Xt(c.fog,d.fog)||f.push({command:Vr.setFog,args:[d.fog]}),Xt(c.projection,d.projection)||f.push({command:Vr.setProjection,args:[d.projection]}),Xt(c.lights,d.lights)||f.push({command:Vr.setLights,args:[d.lights]}),Xt(c.camera,d.camera)||f.push({command:Vr.setCamera,args:[d.camera]});const g={},y=[];!function(P,E,I,A){let l;for(l in E=E||{},P=P||{})P.hasOwnProperty(l)&&(E.hasOwnProperty(l)||hh(l,I,A));for(l in E){if(!E.hasOwnProperty(l))continue;const u=E[l];P.hasOwnProperty(l)?Xt(P[l],u)||("geojson"===P[l].type&&"geojson"===u.type&&ZC(P,E,l)?I.push({command:Vr.setGeoJSONSourceData,args:[l,u.data]}):tE(l,E,I,A)):Nv(l,E,I)}}(c.sources,d.sources,y,g);const b=[];c.layers&&c.layers.forEach(P=>{P.source&&g[P.source]?f.push({command:Vr.removeLayer,args:[P.id]}):b.push(P)});let C=c.terrain;C&&g[C.source]&&(f.push({command:Vr.setTerrain,args:[void 0]}),C=void 0),f=f.concat(y),Xt(C,d.terrain)||f.push({command:Vr.setTerrain,args:[d.terrain]}),function(P,E,I){E=E||[];const A=(P=P||[]).map(Cm),l=E.map(Cm),u=P.reduce(Rl,{}),p=E.reduce(Rl,{}),m=A.slice(),v=Object.create(null);let M,O,T,k,N,F,$;for(M=0,O=0;M<A.length;M++)T=A[M],p.hasOwnProperty(T)?O++:(I.push({command:Vr.removeLayer,args:[T]}),m.splice(m.indexOf(T,O),1));for(M=0,O=0;M<l.length;M++)T=l[l.length-1-M],m[m.length-1-M]!==T&&(u.hasOwnProperty(T)?(I.push({command:Vr.removeLayer,args:[T]}),m.splice(m.lastIndexOf(T,m.length-O),1)):O++,F=m[m.length-M],I.push({command:Vr.addLayer,args:[p[T],F]}),m.splice(m.length-M,0,T),v[T]=!0);for(M=0;M<l.length;M++)if(T=l[M],k=u[T],N=p[T],!v[T]&&!Xt(k,N))if(Xt(k.source,N.source)&&Xt(k["source-layer"],N["source-layer"])&&Xt(k.type,N.type)){for($ in Fv(k.layout,N.layout,I,T,null,Vr.setLayoutProperty),Fv(k.paint,N.paint,I,T,null,Vr.setPaintProperty),Xt(k.slot,N.slot)||I.push({command:Vr.setSlot,args:[T,N.slot]}),Xt(k.filter,N.filter)||I.push({command:Vr.setFilter,args:[T,N.filter]}),Xt(k.minzoom,N.minzoom)&&Xt(k.maxzoom,N.maxzoom)||I.push({command:Vr.setLayerZoomRange,args:[T,N.minzoom,N.maxzoom]}),k)k.hasOwnProperty($)&&"layout"!==$&&"paint"!==$&&"filter"!==$&&"metadata"!==$&&"minzoom"!==$&&"maxzoom"!==$&&"slot"!==$&&(0===$.indexOf("paint.")?Fv(k[$],N[$],I,T,$.slice(6),Vr.setPaintProperty):Xt(k[$],N[$])||I.push({command:Vr.setLayerProperty,args:[T,$,N[$]]}));for($ in N)N.hasOwnProperty($)&&!k.hasOwnProperty($)&&"layout"!==$&&"paint"!==$&&"filter"!==$&&"metadata"!==$&&"minzoom"!==$&&"maxzoom"!==$&&"slot"!==$&&(0===$.indexOf("paint.")?Fv(k[$],N[$],I,T,$.slice(6),Vr.setPaintProperty):Xt(k[$],N[$])||I.push({command:Vr.setLayerProperty,args:[T,$,N[$]]}))}else I.push({command:Vr.removeLayer,args:[T]}),F=m[m.lastIndexOf(T)+1],I.push({command:Vr.addLayer,args:[N,F]})}(b,d.layers,f)}catch(g){console.warn("Unable to compute style diff:",g),f=[{command:Vr.setStyle,args:[d]}]}return f}(this.serialize(),t).filter(c=>!(c.command in ng));if(0===r.length)return!1;const s=r.filter(c=>!(c.command in hA));if(s.length>0)throw new Error(`Unimplemented: ${s.map(c=>c.command).join(", ")}.`);return r.forEach(c=>{this[c.command].apply(this,c.args)}),this.stylesheet=t,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(t,r){return this.getImage(t)?this.fire(new Cn(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,this.scope,r),this._afterImageUpdated(t),this)}updateImage(t,r){this.imageManager.updateImage(t,this.scope,r)}getImage(t){return this.imageManager.getImage(t,this.scope)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t,this.scope),this._afterImageUpdated(t),this):this.fire(new Cn(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(t),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new de("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(t,r,s={}){return this._checkLoaded(),this._validate(es,`models.${t}`,r,null,s)||(this.modelManager.addModel(t,r,this.scope),this._changes.setDirty()),this}hasModel(t){return this.modelManager.hasModel(t,this.scope)}removeModel(t){return this.hasModel(t)?(this.modelManager.removeModel(t,this.scope),this):this.fire(new Cn(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(t,r,s={}){if(this._checkLoaded(),void 0!==this.getOwnSource(t))throw new Error(`There is already a source with ID "${t}".`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(Nd,`sources.${t}`,r,null,s))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const c=xm(t,r,this.dispatcher,this);c.scope=this.scope,c.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(c.id),source:c.serialize(),sourceId:c.id}));const d=f=>{const g=(f?"symbol:":"other:")+c.id,y=sn(g,this.scope),b=this._sourceCaches[g]=new Fa(y,c,f);(f?this._symbolSourceCaches:this._otherSourceCaches)[c.id]=b,b.onAdd(this.map)};d(!1),"vector"!==r.type&&"geojson"!==r.type||d(!0),c.onAdd&&c.onAdd(this.map),s.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(t){this._checkLoaded();const r=this.getOwnSource(t);if(!r)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new Cn(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===t)return this.fire(new Cn(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const s=this.getOwnSourceCaches(t);for(const c of s){const d=to(c.id);delete this._sourceCaches[d],this._changes.discardSourceCacheUpdate(c.id),c.fire(new de("data",{sourceDataType:"metadata",dataType:"source",sourceId:c.getSource().id})),c.setEventedParent(null),c.clearTiles()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],this.mergeSources(),r.setEventedParent(null),r.onRemove&&r.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(t,r){this._checkLoaded(),this.getOwnSource(t).setData(r),this._changes.setDirty()}getOwnSource(t){const r=this.getOwnSourceCache(t);return r&&r.getSource()}getOwnSources(){const t=[];for(const r in this._otherSourceCaches){const s=this.getOwnSourceCache(r);s&&t.push(s.getSource())}return t}setLights(t){if(this._checkLoaded(),!t)return delete this.ambientLight,void delete this.directionalLight;const r=this._getTransitionParameters();for(const c of t){if(this._validate(tl,"lights",c))return;switch(c.type){case"ambient":if(this.ambientLight){const d=this.ambientLight;d.set(c),d.updateTransitions(r)}else this.ambientLight=new _x(c,my,this.scope,this.options);break;case"directional":if(this.directionalLight){const d=this.directionalLight;d.set(c),d.updateTransitions(r)}else this.directionalLight=new _x(c,yx,this.scope,this.options)}}const s=new Lo(this.z||0,r);this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const t=this.directionalLight,r=this.ambientLight;if(!t||!r)return;const s=P=>.2126*(P[0]<=.03928?P[0]/12.92:Math.pow((P[0]+.055)/1.055,2.4))+.7152*(P[1]<=.03928?P[1]/12.92:Math.pow((P[1]+.055)/1.055,2.4))+.0722*(P[2]<=.03928?P[2]/12.92:Math.pow((P[2]+.055)/1.055,2.4)),c=t.properties.get("color").toArray01(),d=t.properties.get("intensity"),f=t.properties.get("direction"),g=1-Ge(f.x,f.y,f.z)[2]/90,y=s(c)*d*g,b=r.properties.get("color").toArray01(),C=r.properties.get("intensity");return(y+s(b)*C)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const t=[];return this.directionalLight&&t.push(this.directionalLight.get()),this.ambientLight&&t.push(this.ambientLight.get()),t}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(t){if(!t)return this;if(un(t)){const r=function(d){const f=d.indexOf("\x1f");return f>=0?d.slice(f+1):""}(t),s=this.fragments.find(({id:d})=>d===r);if(!s)throw new Error(`Style import not found: ${t}`);const c=to(t);return s.style.getFragmentStyle(c)}{const r=this.fragments.find(({id:s})=>s===t);if(!r)throw new Error(`Style import not found: ${t}`);return r.style}}getConfigProperty(t,r){const s=this.getFragmentStyle(t);if(!s)return null;const c=s.options.get(r),d=c?c.value||c.default:null;return d?d.serialize():null}setConfigProperty(t,r,s){const c=Wl(s);if("success"!==c.result)return void Qx(this,c.value);const d=c.value.expression,f=this.getFragmentStyle(t);if(!f)return;const g=f.options.get(r);g&&(f.options.set(r,{...g,value:d}),f.updateConfigDependencies())}setConfig(t,r){if(this._config=t,t||r)if(r){this.options.clear();for(const s in r){let c,d;const f=Wl(r[s].default);if("success"===f.result&&(c=f.value.expression),t&&void 0!==t[s]){const E=Wl(t[s]);"success"===E.result&&(d=E.value.expression)}const{minValue:g,maxValue:y,stepValue:b,type:C,values:P}=r[s];c?this.options.set(s,{default:c,value:d,minValue:g,maxValue:y,stepValue:b,type:C,values:P}):this.fire(new Cn(new Error(`No schema defined for config option "${s}".`)))}}else this.fire(new Cn(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(){for(const t of this._configDependentLayers){const r=this.getLayer(t);r&&(r.possiblyEvaluateVisibility(),this._updateLayer(r))}this.ambientLight&&this.ambientLight.scope===this.scope&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.scope===this.scope&&this.directionalLight.updateConfig(this.options),this._changes.setDirty()}addLayer(t,r,s={}){this._checkLoaded();const c=t.id;if(this._layers[c])return void this.fire(new Cn(new Error(`Layer with id "${c}" already exists on this map`)));let d;if("custom"===t.type){if(Qx(this,function(C){const P=[],E=C.id;return void 0===E&&P.push({message:`layers.${E}: missing required property "id"`}),void 0===C.render&&P.push({message:`layers.${E}: missing required method "render"`}),C.renderingMode&&"2d"!==C.renderingMode&&"3d"!==C.renderingMode&&P.push({message:`layers.${E}: property "renderingMode" must be either "2d" or "3d"`}),P}(t)))return;d=Kp(t,this.options)}else{if("object"==typeof t.source&&(this.addSource(c,t.source),t=_t(t=et(t),{source:c})),this._validate(Pg,`layers.${c}`,t,{arrayIndex:-1},s))return;d=Kp(t,this.options),this._validateLayer(d),d.setEventedParent(this,{layer:{id:c}}),this._serializedLayers[d.id]=d.serialize()}d.isConfigDependent&&this._configDependentLayers.add(d.fqid),d.setScope(this.scope);let f=this._order.length;if(r){const C=this._order.indexOf(r);if(-1===C)return void this.fire(new Cn(new Error(`Layer with id "${r}" does not exist on this map.`)));d.slot===this._layers[r].slot?f=C:gt(`Layer with id "${r}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(f,0,c),this._layerOrderChanged=!0,this._layers[c]=d;const g=this.getOwnLayerSourceCache(d),y=!!this.directionalLight&&this.directionalLight.shadowsEnabled();g&&d.canCastShadows()&&y&&(g.castsShadows=!0);const b=this._changes.getRemovedLayer(d);if(b&&d.source&&g&&"custom"!==d.type){this._changes.discardLayerRemoval(d);const C=sn(d.source,d.scope);b.type!==d.type?this._changes.updateSourceCache(C,"clear"):(this._changes.updateSourceCache(C,"reload"),g.pause())}this._updateLayer(d),d.onAdd&&d.onAdd(this.map),d.scope=this.scope,this.mergeLayers()}moveLayer(t,r){this._checkLoaded();const s=this._checkLayer(t);if(!s||t===r)return;const c=this._order.indexOf(t);this._order.splice(c,1);let d=this._order.length;if(r){const f=this._order.indexOf(r);if(-1===f)return void this.fire(new Cn(new Error(`Layer with id "${r}" does not exist on this map.`)));s.slot===this._layers[r].slot?d=f:gt(`Layer with id "${r}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(d,0,t),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(t){this._checkLoaded();const r=this._checkLayer(t);if(!r)return;r.setEventedParent(null);const s=this._order.indexOf(t);this._order.splice(s,1),delete this._layers[t],delete this._serializedLayers[t],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(r.fqid),this._changes.removeLayer(r);const c=this.getOwnLayerSourceCache(r);if(c&&c.castsShadows){let d=!1;for(const f in this._layers)if(this._layers[f].source===r.source&&this._layers[f].canCastShadows()){d=!0;break}c.castsShadows=d}r.onRemove&&r.onRemove(this.map),this.mergeLayers()}getOwnLayer(t){return this._layers[t]}hasLayer(t){return t in this._mergedLayers}hasLayerType(t){for(const r in this._layers)if(this._layers[r].type===t)return!0;return!1}setLayerZoomRange(t,r,s){this._checkLoaded();const c=this._checkLayer(t);c&&(c.minzoom===r&&c.maxzoom===s||(null!=r&&(c.minzoom=r),null!=s&&(c.maxzoom=s),this._updateLayer(c)))}setSlot(t,r){this._checkLoaded();const s=this._checkLayer(t);s&&s.slot!==r&&(s.slot=r,this._updateLayer(s))}setFilter(t,r,s={}){this._checkLoaded();const c=this._checkLayer(t);if(c&&!Xt(c.filter,r))return null==r?(c.filter=void 0,void this._updateLayer(c)):void(this._validate(fp,`layers.${c.id}.filter`,r,{layerType:c.type},s)||(c.filter=et(r),this._updateLayer(c)))}getFilter(t){const r=this._checkLayer(t);if(r)return et(r.filter)}setLayoutProperty(t,r,s,c={}){this._checkLoaded();const d=this._checkLayer(t);d&&(Xt(d.getLayoutProperty(r),s)||(d.setLayoutProperty(r,s,c),d.isConfigDependent&&this._configDependentLayers.add(d.fqid),this._updateLayer(d)))}getLayoutProperty(t,r){const s=this._checkLayer(t);if(s)return s.getLayoutProperty(r)}setPaintProperty(t,r,s,c={}){this._checkLoaded();const d=this._checkLayer(t);if(!d||Xt(d.getPaintProperty(r),s))return;const f=d.setPaintProperty(r,s,c);d.isConfigDependent&&this._configDependentLayers.add(d.fqid),f&&this._updateLayer(d),this._changes.updatePaintProperties(d)}getPaintProperty(t,r){const s=this._checkLayer(t);if(s)return s.getPaintProperty(r)}setFeatureState(t,r){this._checkLoaded();const s=t.source,c=t.sourceLayer,d=this._checkSource(s);if(!d)return;const f=d.type;if("geojson"===f&&c)return void this.fire(new Cn(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===f&&!c)return void this.fire(new Cn(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===t.id&&this.fire(new Cn(new Error("The feature id parameter must be provided.")));const g=this.getOwnSourceCaches(s);for(const y of g)y.setFeatureState(c,t.id,r)}removeFeatureState(t,r){this._checkLoaded();const s=t.source,c=this._checkSource(s);if(!c)return;const d=c.type,f="vector"===d?t.sourceLayer:void 0;if("vector"===d&&!f)return void this.fire(new Cn(new Error("The sourceLayer parameter must be provided for vector source types.")));if(r&&"string"!=typeof t.id&&"number"!=typeof t.id)return void this.fire(new Cn(new Error("A feature id is required to remove its specific state property.")));const g=this.getOwnSourceCaches(s);for(const y of g)y.removeFeatureState(f,t.id,r)}getFeatureState(t){this._checkLoaded();const r=t.source,s=t.sourceLayer,c=this._checkSource(r);if(c){if("vector"!==c.type||s)return void 0===t.id&&this.fire(new Cn(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(r)[0].getFeatureState(s,t.id);this.fire(new Cn(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(t){return this.stylesheet.transition=_t({},this.stylesheet.transition,t),this.transition=this.stylesheet.transition,this}getTransition(){return _t({},this.stylesheet.transition)}serialize(){this._checkLoaded();const t=this.getTerrain(),r=t&&this.terrain&&this.terrain.scope===this.scope?t:this.stylesheet.terrain;return ce({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:r,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},s=>void 0!==s)}_updateLayer(t){this._changes.updateLayer(t);const r=this.getLayerSourceCache(t),s=sn(t.source,t.scope),c=this._changes.getUpdatedSourceCaches();t.source&&!c[s]&&r&&"raster"!==r.getSource().type&&(this._changes.updateSourceCache(s,"reload"),r.pause()),t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const r=g=>"fill-extrusion"===this._mergedLayers[g].type,s=this.order,c={},d=[];for(let g=s.length-1;g>=0;g--){const y=s[g];if(r(y)){c[y]=g;for(const b of t){const C=b[y];if(C)for(const P of C)d.push(P)}}}d.sort((g,y)=>y.intersectionZ-g.intersectionZ);const f=[];for(let g=s.length-1;g>=0;g--){const y=s[g];if(r(y))for(let b=d.length-1;b>=0;b--){const C=d[b].feature;if(c[C.layer.id]<g)break;f.push(C),d.pop()}else for(const b of t){const C=b[y];if(C)for(const P of C)f.push(P.feature)}}return f}queryRenderedFeatures(t,r,s){r&&r.filter&&this._validate(fp,"queryRenderedFeatures.filter",r.filter,null,r),r.scope=this.scope,r.availableImages=this._availableImages,r.serializedLayers=this._serializedLayers;const c={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new Cn(new Error("parameters.layers must be an Array."))),[];for(const b of r.layers){const C=this._mergedLayers[b];if(!C)return this.fire(new Cn(new Error(`The layer '${b}' does not exist in the map's style and cannot be queried for features.`))),[];c[C.source]=!0}}const d=[],f=r.serializedLayers||{},g=r&&r.layers?r.layers.some(b=>{const C=this.getLayer(b);return C&&C.is3D()}):this.has3DLayers(),y=Sv.createFromScreenPoints(t,s);for(const b in this._mergedSourceCaches){const C=this._mergedSourceCaches[b].getSource();if(!C||C.scope!==r.scope)continue;const P=this._mergedSourceCaches[b].getSource().id;r.layers&&!c[P]||d.push(qC(this._mergedSourceCaches[b],this._mergedLayers,f,y,r,s,g,!!this.map._showQueryGeometry))}return this.placement&&d.push(function(b,C,P,E,I,A,l){const u={},p=A.queryRenderedSymbols(E),m=[];for(const v of Object.keys(p).map(Number))m.push(l[v]);m.sort(wm);for(const v of m){const M=v.featureIndex.lookupSymbolFeatures(p[v.bucketInstanceId],C,v.bucketIndex,v.sourceLayerIndex,I.filter,I.layers,I.availableImages,b);for(const O in M){const T=u[O]=u[O]||[],k=M[O];k.sort((N,F)=>{const $=v.featureSortOrder;if($){const q=$.indexOf(N.featureIndex);return $.indexOf(F.featureIndex)-q}return F.featureIndex-N.featureIndex});for(const N of k)T.push(N)}}for(const v in u)u[v].forEach(M=>{const O=M.feature,T=P(b[v]);if(!T)return;const k=T.getFeatureState(O.layer["source-layer"],O.id);O.source=O.layer.source,O.layer["source-layer"]&&(O.sourceLayer=O.layer["source-layer"]),O.state=k});return u}(this._mergedLayers,f,this.getLayerSourceCache.bind(this),y.screenGeometry,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(d)}querySourceFeatures(t,r){r&&r.filter&&this._validate(fp,"querySourceFeatures.filter",r.filter,null,r);const s=this.getOwnSourceCaches(t);let c=[];for(const d of s)c=c.concat(QO(d,r));return c}addSourceType(t,r,s){return ph.getSourceType(t)?s(new Error(`A source type called "${t}" already exists.`)):(ph.setSourceType(t,r),r.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:r.workerSourceURL},s):s(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,r,s={}){this._checkLoaded();const c=this.light.getLight();let d=!1;for(const g in t)if(!Xt(t[g],c[g])){d=!0;break}if(!d)return;const f=this._getTransitionParameters();this.light.setLight(t,r,s),this.light.updateTransitions(f)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,r=1){if(this._checkLoaded(),!t)return delete this.terrain,null===t?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let s=t;const c=null==t.source;if(1===r){if("object"==typeof s.source){const g="terrain-dem-src";this.addSource(g,s.source),s=et(s),s=_t(s,{source:g})}const d=_t({},s),f={};if(this.terrain&&c){d.source=this.terrain.get().source;const g=this.terrain?this.getFragmentStyle(this.terrain.scope):null;g&&(f.style=g.serialize())}if(this._validate(Fd,"terrain",d,f))return}if(!this.terrain||this.terrain.scope!==this.scope&&!c||this.terrain&&r!==this.terrain.drapeRenderMode){if(!s)return;this._createTerrain(s,r),this.fire(new de("data",{dataType:"style"}))}else{const d=this.terrain,f=d.get();for(const g of Object.keys(wt.terrain))!s.hasOwnProperty(g)&&wt.terrain[g].default&&(s[g]=wt.terrain[g].default);for(const g in t)if(!Xt(t[g],f[g])){d.set(t,this.options),this.stylesheet.terrain=t;const y=this._getTransitionParameters({duration:0});d.updateTransitions(y),this.fire(new de("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const r=this.fog=new BO(t,this.map.transform);this.stylesheet.fog=r.get();const s=this._getTransitionParameters({duration:0});r.updateTransitions(s)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const r=this.fog;if(!Xt(r.get(),t)){r.set(t),this.stylesheet.fog=r.get();const s=this._getTransitionParameters({duration:0});r.updateTransitions(s)}}else this._createFog(t);this._markersNeedUpdate=!0}_getTransitionParameters(t){return{now:Mn.now(),transition:_t(this.transition,t)}}updateDrapeFirstLayers(){if(!this.terrain)return;const t=[],r=[];for(const s in this._mergedLayers)this.isLayerDraped(this._mergedLayers[s])?t.push(s):r.push(s);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...r)}_createTerrain(t,r){const s=this.terrain=new Ov(t,r,this.scope,this.options);1===r&&(this.stylesheet.terrain=t),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const c=this._getTransitionParameters({duration:0});s.updateTransitions(c)}_force3DLayerUpdate(){for(const t in this._layers){const r=this._layers[t];"fill-extrusion"===r.type&&this._updateLayer(r)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const r=this._layers[t];"symbol"===r.type&&this._updateLayer(r)}}_validate(t,r,s,c,d={}){if(d&&!1===d.validate)return!1;const f=_t({},this.serialize());return Qx(this,t.call(Ea,_t({key:r,style:f,value:s,styleSpec:wt},c)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),Ia.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._mergedLayers)this._mergedLayers[t].setEventedParent(null);for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles(),this._mergedSourceCaches[t].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(t){const r=this.getSourceCaches(t);for(const s of r)s.clearTiles()}clearSources(){for(const t in this._mergedSourceCaches)this._mergedSourceCaches[t].clearTiles()}reloadSource(t){const r=this.getSourceCaches(t);for(const s of r)s.resume(),s.reload()}reloadSources(){for(const t of this.getSources())t.reload&&t.reload()}updateSources(t){let r;this.directionalLight&&(r=Xx(this.directionalLight));for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].update(t,void 0,void 0,r)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const r=this._sourceCaches[t];r.resume(),r.reload()}}_updatePlacement(t,r,s,c,d=!1){let f=!1,g=!1;const y={},b={};for(const C of this._mergedOrder){const P=this._mergedLayers[C];if("symbol"!==P.type)continue;const E=sn(P.source,P.scope);let I=y[E];if(!I){const l=this.getLayerSourceCache(P);if(!l)continue;const u=l.getRenderableIds(!0).map(p=>l.getTileByID(p));b[E]=u.slice(),I=y[E]=u.sort((p,m)=>m.tileID.overscaledZ-p.tileID.overscaledZ||(p.tileID.isLessThan(m.tileID)?-1:1))}const A=this.crossTileSymbolIndex.addLayer(P,I,t.center.lng,t.projection);f=f||A}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),d=d||this._layerOrderChanged||0===s,this._layerOrderChanged&&this.fire(new de("neworder")),(d||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Mn.now(),t.zoom))&&(this.pauseablePlacement=new As(t,this._mergedOrder,d,r,s,c,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,y,b),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Mn.now()),g=!0),f&&this.pauseablePlacement.placement.setStale()),g||f)for(const C of this._mergedOrder){const P=this._mergedLayers[C];"symbol"===P.type&&this.placement.updateLayerOpacities(P,y[sn(P.source,P.scope)])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Mn.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}addImport(t){this._checkLoaded();const r=this.stylesheet.imports=this.stylesheet.imports||[];return-1!==r.findIndex(({id:c})=>c===t.id)?this.fire(new Cn(new Error(`Import with id '${t.id}' already exists in the map's style.`))):(r.push(t),this._loadImports([t],!0),this)}setImportUrl(t,r){this._checkLoaded();const s=this.stylesheet.imports||[],c=this.getImportIndex(t);if(-1===c)return this;s[c].url=r;const d=this.fragments[c];return d.style=this._createFragmentStyle(s[c]),d.style.on("style.import.load",()=>this.mergeAll()),d.style.loadURL(r),this}setImportData(t,r){this._checkLoaded();const s=this.getImportIndex(t),c=this.stylesheet.imports||[];return-1===s?this:r?(this.fragments[s].style.setState(r),this._reloadImports(),this):(delete c[s].data,this.setImportUrl(t,c[s].url))}setImportConfig(t,r){this._checkLoaded();const s=this.getImportIndex(t),c=this.stylesheet.imports||[];if(-1===s)return this;r?c[s].config=r:delete c[s].config;const d=this.fragments[s],f=d.style.stylesheet&&d.style.stylesheet.schema;return d.config=r,d.style.setConfig(r,f),d.style.updateConfigDependencies(),this}removeImport(t){this._checkLoaded();const r=this.stylesheet.imports||[],s=this.getImportIndex(t);return-1===s||(r.splice(s,1),this.fragments[s].style._remove(),this.fragments.splice(s,1),this._reloadImports()),this}getImportIndex(t){const r=(this.stylesheet.imports||[]).findIndex(s=>s.id===t);return-1===r&&this.fire(new Cn(new Error(`Import '${t}' does not exist in the map's style and cannot be updated.`))),r}getLayer(t){return this._mergedLayers[t]}getSources(){const t=[];for(const r in this._mergedOtherSourceCaches){const s=this._mergedOtherSourceCaches[r];s&&t.push(s.getSource())}return t}getSource(t,r){const s=this.getSourceCache(t,r);return s&&s.getSource()}getLayerSource(t){const r=this.getLayerSourceCache(t);return r&&r.getSource()}getSourceCache(t,r){const s=sn(t,r);return this._mergedOtherSourceCaches[s]}getLayerSourceCache(t){const r=sn(t.source,t.scope);return"symbol"===t.type?this._mergedSymbolSourceCaches[r]:this._mergedOtherSourceCaches[r]}getSourceCaches(t){const r=[];return this._mergedOtherSourceCaches[t]&&r.push(this._mergedOtherSourceCaches[t]),this._mergedSymbolSourceCaches[t]&&r.push(this._mergedSymbolSourceCaches[t]),r}updateSourceCaches(){const t=this._changes.getUpdatedSourceCaches();for(const r in t){const s=t[r];"reload"===s?this.reloadSource(r):"clear"===s&&this.clearSource(r)}}updateLayers(t){const r=this._changes.getUpdatedPaintProperties();for(const s of r){const c=this.getLayer(s);c&&c.updateTransitions(t)}}getImages(t,r,s){this.imageManager.getImages(r.icons,r.scope,s),this._updateTilesForChangedImages();const c=d=>{d&&d.setDependencies(r.tileID.key,r.type,r.icons)};c(this._otherSourceCaches[r.source]),c(this._symbolSourceCaches[r.source])}getGlyphs(t,r,s){this.glyphManager.getGlyphs(r.stacks,r.scope,s)}getResource(t,r,s){return le(r,s)}getOwnSourceCache(t){return this._otherSourceCaches[t]}getOwnLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}getOwnSourceCaches(t){const r=[];return this._otherSourceCaches[t]&&r.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&r.push(this._symbolSourceCaches[t]),r}_isSourceCacheLoaded(t){const r=this.getOwnSourceCaches(t);return 0===r.length?(this.fire(new Cn(new Error(`There is no source with ID '${t}'`))),!1):r.every(s=>s.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function WI(e,t){let r=!1,s=null;const c=()=>{s=null,r&&(e(),s=setTimeout(c,t),r=!1)};return()=>(r=!0,s||c(),s)}ph.getSourceType=function(e){return Lv[e]},ph.setSourceType=function(e,t){Lv[e]=t},ph.registerForPluginStateChange=function(e){return e({pluginStatus:si,pluginURL:Ta}),Ia.on("pluginStateChange",e),e};class b2{constructor(t){this._hashName=t&&encodeURIComponent(t),Tn(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=WI(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,lt.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),lt.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const r=Nf(t);if(this._hashName){const s=this._hashName;let c=!1;const d=lt.location.hash.slice(1).split("&").map(f=>{const g=f.split("=")[0];return g===s?(c=!0,`${g}=${r}`):f}).filter(f=>f);return c||d.push(`${s}=${r}`),`#${d.join("&")}`}return`#${r}`}_getCurrentHash(){const t=lt.location.hash.replace("#","");if(this._hashName){let r;return t.split("&").map(s=>s.split("=")).forEach(s=>{s[0]===this._hashName&&(r=s)}),(r&&r[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const r=this._getCurrentHash();if(r.length>=3&&!r.some(s=>isNaN(s))){const s=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(r[3]||0):t.getBearing();return t.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:s,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=lt.location.href.replace(/(#.+)?$/,this.getHashString());lt.history.replaceState(lt.history.state,null,t)}}function Nf(e,t){const r=e.getCenter(),s=Math.round(100*e.getZoom())/100,c=Math.ceil((s*Math.LN2+Math.log(512/360/.5))/Math.LN10),d=Math.pow(10,c),f=Math.round(r.lng*d)/d,g=Math.round(r.lat*d)/d,y=e.getBearing(),b=e.getPitch();let C=t?`/${f}/${g}/${s}`:`${s}/${g}/${f}`;return(y||b)&&(C+="/"+Math.round(10*y)/10),b&&(C+=`/${Math.round(b)}`),C}const CM={linearity:.3,easing:us(0,0,.3,1)},KI=_t({deceleration:2500,maxSpeed:1400},CM),fA=_t({deceleration:20,maxSpeed:1400},CM),pA=_t({deceleration:1e3,maxSpeed:360},CM),gA=_t({deceleration:1e3,maxSpeed:90},CM);class mA{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Mn.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,r=Mn.now();for(;t.length>0&&r-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const r={zoom:0,bearing:0,pitch:0,pan:new tt(0,0),pinchAround:void 0,around:void 0};for(const{settings:d}of this._inertiaBuffer)r.zoom+=d.zoomDelta||0,r.bearing+=d.bearingDelta||0,r.pitch+=d.pitchDelta||0,d.panDelta&&r.pan._add(d.panDelta),d.around&&(r.around=d.around),d.pinchAround&&(r.pinchAround=d.pinchAround);const s=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,c={};if(r.pan.mag()){const d=Jx(r.pan.mag(),s,_t({},KI,t||{}));c.offset=r.pan.mult(d.amount/r.pan.mag()),c.center=this._map.transform.center,AE(c,d)}if(r.zoom){const d=Jx(r.zoom,s,fA);c.zoom=this._map.transform.zoom+d.amount,AE(c,d)}if(r.bearing){const d=Jx(r.bearing,s,pA);c.bearing=this._map.transform.bearing+Ne(d.amount,-179,179),AE(c,d)}if(r.pitch){const d=Jx(r.pitch,s,gA);c.pitch=this._map.transform.pitch+d.amount,AE(c,d)}if(c.zoom||c.bearing){const d=void 0===r.pinchAround?r.around:r.pinchAround;c.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),c.noMoveStart=!0,c}}function AE(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function Jx(e,t,r){const{maxSpeed:s,linearity:c,deceleration:d}=r,f=Ne(e*c/(t/1e3),-s,s),g=Math.abs(f)/(d*c);return{easing:r.easing,duration:1e3*g,amount:f*(g/2)}}class Ba extends de{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,s,c={}){const d=vi(r.getCanvasContainer(),s);super(t,_t({point:d,lngLat:r.unproject(d),originalEvent:s},c)),this._defaultPrevented=!1,this.target=r}}class tw extends de{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,s){const c="touchend"===t?s.changedTouches:s.touches,d=cu(r.getCanvasContainer(),c),f=d.map(y=>r.unproject(y)),g=d.reduce((y,b,C,P)=>y.add(b.div(P.length)),new tt(0,0));super(t,{points:d,point:g,lngLats:f,lngLat:r.unproject(g),originalEvent:s}),this._defaultPrevented=!1}}class YI extends de{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,s){super(t,{originalEvent:s}),this._defaultPrevented=!1}}class Ry{constructor(t,r){this._map=t,this._clickTolerance=r.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new YI(t.type,this._map,t))}mousedown(t,r){return this._mousedownPos=r,this._firePreventable(new Ba(t.type,this._map,t))}mouseup(t){this._map.fire(new Ba(t.type,this._map,t))}preclick(t){const r=_t({},t);r.type="preclick",this._map.fire(new Ba(r.type,this._map,r))}click(t,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||(this.preclick(t),this._map.fire(new Ba(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new Ba(t.type,this._map,t))}mouseover(t){this._map.fire(new Ba(t.type,this._map,t))}mouseout(t){this._map.fire(new Ba(t.type,this._map,t))}touchstart(t){return this._firePreventable(new tw(t.type,this._map,t))}touchmove(t){this._map.fire(new tw(t.type,this._map,t))}touchend(t){this._map.fire(new tw(t.type,this._map,t))}touchcancel(t){this._map.fire(new tw(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ff{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new Ba(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ba("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Ba(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class x2{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,r){this.isEnabled()&&t.shiftKey&&0===t.button&&($f(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(t,r){if(!this._active)return;const s=r,c=this._startPos,d=this._lastPos;if(!c||!d||d.equals(s)||!this._box&&s.dist(c)<this._clickTolerance)return;this._lastPos=s,this._box||(this._box=eo("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const f=Math.min(c.x,s.x),g=Math.max(c.x,s.x),y=Math.min(c.y,s.y),b=Math.max(c.y,s.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${f}px,${y}px)`,this._box.style.width=g-f+"px",this._box.style.height=b-y+"px")})}mouseupWindow(t,r){if(!this._active)return;const s=this._startPos,c=r;if(s&&0===t.button){if(this.reset(),_h(),s.x!==c.x||s.y!==c.y)return this._map.fire(new de("boxzoomend",{originalEvent:t})),{cameraAnimation:d=>d.fitScreenCoordinates(s,c,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Hy(),delete this._startPos,delete this._lastPos}_fireEvent(t,r){return this._map.fire(new de(t,{originalEvent:r}))}}function tb(e,t){const r={};for(let s=0;s<e.length;s++)r[e[s].identifier]=t[s];return r}class MM{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,r,s){(this.centroid||s.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),s.length===this.numTouches&&(this.centroid=function(c){const d=new tt(0,0);for(const f of c)d._add(f);return d.div(c.length)}(r),this.touches=tb(s,r)))}touchmove(t,r,s){if(this.aborted||!this.centroid)return;const c=tb(s,r);for(const d in this.touches){const f=c[d];(!f||f.dist(this.touches[d])>30)&&(this.aborted=!0)}}touchend(t,r,s){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===s.length){const c=!this.aborted&&this.centroid;if(this.reset(),c)return c}}}class PM{constructor(t){this.singleTap=new MM(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,r,s){this.singleTap.touchstart(t,r,s)}touchmove(t,r,s){this.singleTap.touchmove(t,r,s)}touchend(t,r,s){const c=this.singleTap.touchend(t,r,s);if(c){const d=t.timeStamp-this.lastTime<500,f=!this.lastTap||this.lastTap.dist(c)<30;if(d&&f||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=c,this.count===this.numTaps)return this.reset(),c}}}class OM{constructor(){this._zoomIn=new PM({numTouches:1,numTaps:2}),this._zoomOut=new PM({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,r,s){this._zoomIn.touchstart(t,r,s),this._zoomOut.touchstart(t,r,s)}touchmove(t,r,s){this._zoomIn.touchmove(t,r,s),this._zoomOut.touchmove(t,r,s)}touchend(t,r,s){const c=this._zoomIn.touchend(t,r,s),d=this._zoomOut.touchend(t,r,s);return c?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:f=>f.easeTo({duration:300,zoom:f.getZoom()+1,around:f.unproject(c)},{originalEvent:t})}):d?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:f=>f.easeTo({duration:300,zoom:f.getZoom()-1,around:f.unproject(d)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const EM={0:1,2:2};class eb{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,r){return!1}_move(t,r){return{}}mousedown(t,r){if(this._lastPoint)return;const s=Gf(t);this._correctButton(t,s)&&(this._lastPoint=r,this._eventButton=s)}mousemoveWindow(t,r){const s=this._lastPoint;if(s)if(t.preventDefault(),null!=this._eventButton&&function(c,d){const f=EM[d];return void 0===c.buttons||(c.buttons&f)!==f}(t,this._eventButton))this.reset();else if(this._moved||!(r.dist(s)<this._clickTolerance))return this._moved=!0,this._lastPoint=r,this._move(s,r)}mouseupWindow(t){this._lastPoint&&Gf(t)===this._eventButton&&(this._moved&&_h(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _A extends eb{mousedown(t,r){super.mousedown(t,r),this._lastPoint&&(this._active=!0)}_correctButton(t,r){return 0===r&&!t.ctrlKey}_move(t,r){return{around:r,panDelta:r.sub(t)}}}class XI extends eb{_correctButton(t,r){return 0===r&&t.ctrlKey||2===r}_move(t,r){const s=.8*(r.x-t.x);if(s)return this._active=!0,{bearingDelta:s}}contextmenu(t){t.preventDefault()}}class QI extends eb{_correctButton(t,r){return 0===r&&t.ctrlKey||2===r}_move(t,r){const s=-.5*(r.y-t.y);if(s)return this._active=!0,{pitchDelta:s}}contextmenu(t){t.preventDefault()}}class DE{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=r.clickTolerance||1,this.reset(),Tn(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new tt(0,0)}touchstart(t,r,s){return this._calculateTransform(t,r,s)}touchmove(t,r,s){if(this._active&&!(s.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===s.length&&!Ie())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,r,s)}}touchend(t,r,s){this._calculateTransform(t,r,s),this._active&&s.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,r,s){s.length>0&&(this._active=!0);const c=tb(s,r),d=new tt(0,0),f=new tt(0,0);let g=0;for(const b in c){const C=c[b],P=this._touches[b];P&&(d._add(C),f._add(C.sub(P)),g++,c[b]=C)}if(this._touches=c,g<this._minTouches||!f.mag())return;const y=f.div(g);return this._sum._add(y),this._sum.mag()<this._clickTolerance?void 0:{around:d.div(g),panDelta:y}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=eo("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class TM{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,r,s){return{}}touchstart(t,r,s){this._firstTwoTouches||s.length<2||(this._firstTwoTouches=[s[0].identifier,s[1].identifier],this._start([r[0],r[1]]))}touchmove(t,r,s){const c=this._firstTwoTouches;if(!c)return;t.preventDefault();const[d,f]=c,g=ew(s,r,d),y=ew(s,r,f);if(!g||!y)return;const b=this._aroundCenter?null:g.add(y).div(2);return this._move([g,y],b,t)}touchend(t,r,s){if(!this._firstTwoTouches)return;const[c,d]=this._firstTwoTouches,f=ew(s,r,c),g=ew(s,r,d);f&&g||(this._active&&_h(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ew(e,t,r){for(let s=0;s<e.length;s++)if(e[s].identifier===r)return t[s]}function w2(e,t){return Math.log(e/t)/Math.LN2}class C2 extends TM{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,r){const s=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(w2(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:w2(this._distance,s),pinchAround:r}}}function IM(e,t){return 180*e.angleWith(t)/Math.PI}class nb extends TM{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,r){const s=this._vector;if(this._vector=t[0].sub(t[1]),s&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:IM(this._vector,s),pinchAround:r}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const r=25/(Math.PI*this._minDiameter)*360,s=this._startVector;if(!s)return!1;const c=IM(t,s);return Math.abs(c)<r}}function nw(e){return Math.abs(e.y)>Math.abs(e.x)}class JI extends TM{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,nw(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,r,s){const c=this._lastPoints;if(!c)return;const d=t[0].sub(c[0]),f=t[1].sub(c[1]);return this._map._cooperativeGestures&&!Ie()&&s.touches.length<3||(this._valid=this.gestureBeginsVertically(d,f,s.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(d.y+f.y)/2*-.5})}gestureBeginsVertically(t,r,s){if(void 0!==this._valid)return this._valid;const c=t.mag()>=2,d=r.mag()>=2;if(!c&&!d)return;if(!c||!d)return null==this._firstMove&&(this._firstMove=s),s-this._firstMove<100&&void 0;const f=t.y>0==r.y>0;return nw(t)&&nw(r)&&f}}const tS={panStep:100,bearingStep:15,pitchStep:10};class M2{constructor(){const t=tS;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let r=0,s=0,c=0,d=0,f=0;switch(t.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:t.shiftKey?s=-1:(t.preventDefault(),d=-1);break;case 39:t.shiftKey?s=1:(t.preventDefault(),d=1);break;case 38:t.shiftKey?c=1:(t.preventDefault(),f=-1);break;case 40:t.shiftKey?c=-1:(t.preventDefault(),f=1);break;default:return}return this._rotationDisabled&&(s=0,c=0),{cameraAnimation:g=>{const y=g.getZoom();g.easeTo({duration:300,easeId:"keyboardHandler",easing:kE,zoom:r?Math.round(y)+r*(t.shiftKey?2:1):y,bearing:g.getBearing()+s*this._bearingStep,pitch:g.getPitch()+c*this._pitchStep,offset:[-d*this._panStep,-f*this._panStep],center:g.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function kE(e){return e*(2-e)}const eS=4.000244140625;class P2{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._handler=r,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,Tn(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||Ie()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let r=t.deltaMode===lt.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const s=Mn.now(),c=s-(this._lastWheelEventTime||0);this._lastWheelEventTime=s,0!==r&&r%eS==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":c>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(c*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=vi(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:r,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;"wheel"===this._type&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const r=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(0!==this._delta){const b="wheel"===this._type&&Math.abs(this._delta)>eS?this._wheelZoomRate:this._defaultZoomRate;let C=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&0!==C&&(C=1/C);const P=r(),E=Math.pow(2,P),I="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):E;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(I*C))),"wheel"===this._type&&(this._startZoom=P,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const s="number"==typeof this._targetZoom?this._targetZoom:r(),c=this._startZoom,d=this._easing;let f,g=!1;if("wheel"===this._type&&c&&d){const b=Math.min((Mn.now()-this._lastWheelEventTime)/200,1);f=vn(c,s,d(b)),b<1?this._frameId||(this._frameId=!0):g=!0}else f=s,g=!0;this._active=!0,g&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let y=f-r();return y*this._lastDelta<0&&(y=0),{noInertia:!0,needsRenderFrame:!g,zoomDelta:y,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let r=Yr;if(this._prevEase){const s=this._prevEase,c=(Mn.now()-s.start)/s.duration,d=s.easing(c+.01)-s.easing(c),f=.27/Math.sqrt(d*d+1e-4)*.01;r=us(f,Math.sqrt(.0729-f*f),.25,1)}return this._prevEase={start:Mn.now(),duration:t,easing:r},r}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=eo("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(lt.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class RE{constructor(t,r){this._clickZoom=t,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class nS{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,r){return t.preventDefault(),{cameraAnimation:s=>{s.easeTo({duration:300,zoom:s.getZoom()+(t.shiftKey?-1:1),around:s.unproject(r)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class LE{constructor(){this._tap=new PM({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,r,s){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?s.length>0&&(this._swipePoint=r[0],this._swipeTouch=s[0].identifier):this._tap.touchstart(t,r,s))}touchmove(t,r,s){if(this._tapTime){if(this._swipePoint){if(s[0].identifier!==this._swipeTouch)return;const c=r[0],d=c.y-this._swipePoint.y;return this._swipePoint=c,t.preventDefault(),this._active=!0,{zoomDelta:d/128}}}else this._tap.touchmove(t,r,s)}touchend(t,r,s){this._tapTime?this._swipePoint&&0===s.length&&this.reset():this._tap.touchend(t,r,s)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class SM{constructor(t,r,s){this._el=t,this._mousePan=r,this._touchPan=s}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class O2{constructor(t,r,s){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=r,this._mousePitch=s}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class E2{constructor(t,r,s,c){this._el=t,this._touchZoom=r,this._touchRotate=s,this._tapDragZoom=c,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const AM=e=>e.zoom||e.drag||e.pitch||e.rotate;class DM extends de{}class T2{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,r){const s=dt.sub([],r,t);this.radius=dt.length(s[2]<0?dt.div([],s,this.constants):[s[0],s[1],0])}projectRay(t){dt.div(t,t,this.constants),dt.normalize(t,t),dt.mul(t,t,this.constants);const r=dt.scale([],t,this.radius);if(r[2]>0){const s=dt.scale([],[0,0,1],dt.dot(r,[0,0,1])),c=dt.scale([],dt.normalize([],[r[0],r[1],0]),this.radius),d=dt.add([],r,dt.scale([],dt.sub([],dt.add([],c,s),r),2));r[0]=d[0],r[1]=d[1]}return r}}function rb(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class NE{constructor(t,r){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new mA(t),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new T2,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(r),Tn(["handleEvent","handleWindowEvent"],this);const s=this._el;this._listeners=[[s,"touchstart",{passive:!0}],[s,"touchmove",{passive:!1}],[s,"touchend",void 0],[s,"touchcancel",void 0],[s,"mousedown",void 0],[s,"mousemove",void 0],[s,"mouseup",void 0],[lt.document,"mousemove",{capture:!0}],[lt.document,"mouseup",void 0],[s,"mouseover",void 0],[s,"mouseout",void 0],[s,"dblclick",void 0],[s,"click",void 0],[s,"keydown",{capture:!1}],[s,"keyup",void 0],[s,"wheel",{passive:!1}],[s,"contextmenu",void 0],[lt,"blur",void 0]];for(const[c,d,f]of this._listeners)c.addEventListener(d,c===lt.document?this.handleWindowEvent:this.handleEvent,f)}destroy(){for(const[t,r,s]of this._listeners)t.removeEventListener(r,t===lt.document?this.handleWindowEvent:this.handleEvent,s)}_addDefaultHandlers(t){const r=this._map,s=r.getCanvasContainer();this._add("mapEvent",new Ry(r,t));const c=r.boxZoom=new x2(r,t);this._add("boxZoom",c);const d=new OM,f=new nS;r.doubleClickZoom=new RE(f,d),this._add("tapZoom",d),this._add("clickZoom",f);const g=new LE;this._add("tapDragZoom",g);const y=r.touchPitch=new JI(r);this._add("touchPitch",y);const b=new XI(t),C=new QI(t);r.dragRotate=new O2(t,b,C),this._add("mouseRotate",b,["mousePitch"]),this._add("mousePitch",C,["mouseRotate"]);const P=new _A(t),E=new DE(r,t);r.dragPan=new SM(s,P,E),this._add("mousePan",P),this._add("touchPan",E,["touchZoom","touchRotate"]);const I=new nb,A=new C2;r.touchZoomRotate=new E2(s,A,I,g),this._add("touchRotate",I,["touchPan","touchZoom"]),this._add("touchZoom",A,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ff(r));const l=r.scrollZoom=new P2(r,this);this._add("scrollZoom",l,["mousePan"]);const u=r.keyboard=new M2;this._add("keyboard",u);for(const p of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[p]&&r[p].enable(t[p])}_add(t,r,s){this._handlers.push({handlerName:t,handler:r,allowed:s}),this._handlersById[t]=r}stop(t){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!AM(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,r,s){for(const c in t)if(c!==s&&(!r||r.indexOf(c)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const r=[];for(const s of t)this._el.contains(s.target)&&r.push(s);return r}handleEvent(t,r){this._updatingCamera=!0;const s="renderFrame"===t.type,c=s?void 0:t,d={needsRenderFrame:!1},f={},g={},y=t.touches?this._getMapTouches(t.touches):void 0,b=y?cu(this._el,y):s?void 0:vi(this._el,t);for(const{handlerName:E,handler:I,allowed:A}of this._handlers){if(!I.isEnabled())continue;let l;this._blockedByActive(g,A,E)?I.reset():I[r||t.type]&&(l=I[r||t.type](t,b,y),this.mergeHandlerResult(d,f,l,E,c),l&&l.needsRenderFrame&&this._triggerRenderFrame()),(l||I.isActive())&&(g[E]=I)}const C={};for(const E in this._previousActiveHandlers)g[E]||(C[E]=c);this._previousActiveHandlers=g,(Object.keys(C).length||rb(d))&&(this._changes.push([d,f,C]),this._triggerRenderFrame()),(Object.keys(g).length||rb(d))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:P}=d;P&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],P(this._map))}mergeHandlerResult(t,r,s,c,d){if(!s)return;_t(t,s);const f={handlerName:c,originalEvent:s.originalEvent||d};void 0!==s.zoomDelta&&(r.zoom=f),void 0!==s.panDelta&&(r.drag=f),void 0!==s.pitchDelta&&(r.pitch=f),void 0!==s.bearingDelta&&(r.rotate=f)}_applyChanges(){const t={},r={},s={};for(const[c,d,f]of this._changes)c.panDelta&&(t.panDelta=(t.panDelta||new tt(0,0))._add(c.panDelta)),c.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+c.zoomDelta),c.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+c.bearingDelta),c.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+c.pitchDelta),void 0!==c.around&&(t.around=c.around),void 0!==c.aroundCoord&&(t.aroundCoord=c.aroundCoord),void 0!==c.pinchAround&&(t.pinchAround=c.pinchAround),c.noInertia&&(t.noInertia=c.noInertia),_t(r,d),_t(s,f);this._updateMapTransform(t,r,s),this._changes=[]}_updateMapTransform(t,r,s){const c=this._map,d=c.transform,f=m=>[m.x,m.y,m.z];if((m=>{const v=this._eventsInProgress.drag;return v&&!this._handlersById[v.handlerName].isActive()})()&&!rb(t)){const m=d.zoom;d.cameraElevationReference="sea",null!=this._originalZoom&&d._orthographicProjectionAtLowPitch&&"globe"!==d.projection.name&&0===d.pitch?(d.cameraElevationReference="ground",d.zoom=this._originalZoom):(d.recenterOnTerrain(),d.cameraElevationReference="ground"),m!==d.zoom&&this._map._update(!0)}if(d._isCameraConstrained&&c._stop(!0),!rb(t))return void this._fireEvents(r,s,!0);let{panDelta:g,zoomDelta:y,bearingDelta:b,pitchDelta:C,around:P,aroundCoord:E,pinchAround:I}=t;d._isCameraConstrained&&(y>0&&(y=0),d._isCameraConstrained=!1),void 0!==I&&(P=I),(y||(m=>r[m]&&!this._eventsInProgress[m])("drag"))&&P&&(this._dragOrigin=f(d.pointCoordinate3D(P)),this._originalZoom=d.zoom,this._trackingEllipsoid.setup(d._camera.position,this._dragOrigin)),d.cameraElevationReference="sea",c._stop(!0),P=P||c.transform.centerPoint,b&&(d.bearing+=b),C&&(d.pitch+=C),d._updateCameraState();const A=[0,0,0];if(g)if("mercator"===d.projection.name){const m=this._trackingEllipsoid.projectRay(d.screenPointToMercatorRay(P).dir),v=this._trackingEllipsoid.projectRay(d.screenPointToMercatorRay(P.sub(g)).dir);A[0]=v[0]-m[0],A[1]=v[1]-m[1]}else{const m=d.pointCoordinate(P);if("globe"===d.projection.name){g=g.rotate(-d.angle);const v=d._pixelsPerMercatorPixel/d.worldSize;A[0]=-g.x*ac(ti(m.y))*v,A[1]=-g.y*ac(d.center.lat)*v}else{const v=d.pointCoordinate(P.sub(g));m&&v&&(A[0]=v.x-m.x,A[1]=v.y-m.y)}}const l=d.zoom,u=[0,0,0];if(y){const m=f(E||d.pointCoordinate3D(P)),v={dir:dt.normalize([],dt.sub([],m,d._camera.position))};if(v.dir[2]<0){const M=d.zoomDeltaToMovement(m,y);dt.scale(u,v.dir,M)}}const p=dt.add(A,A,u);d._translateCameraConstrained(p),y&&Math.abs(d.zoom-l)>1e-4&&d.recenterOnTerrain(),d.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(r,s,!0)}_fireEvents(t,r,s){const c=AM(this._eventsInProgress),d=AM(t),f={};for(const C in t){const{originalEvent:P}=t[C];this._eventsInProgress[C]||(f[`${C}start`]=P),this._eventsInProgress[C]=t[C]}!c&&d&&this._fireEvent("movestart",d.originalEvent);for(const C in f)this._fireEvent(C,f[C]);d&&this._fireEvent("move",d.originalEvent);for(const C in t){const{originalEvent:P}=t[C];this._fireEvent(C,P)}const g={};let y;for(const C in this._eventsInProgress){const{handlerName:P,originalEvent:E}=this._eventsInProgress[C];this._handlersById[P].isActive()||(delete this._eventsInProgress[C],y=r[P]||E,g[`${C}end`]=y)}for(const C in g)this._fireEvent(C,g[C]);const b=AM(this._eventsInProgress);if(s&&(c||d)&&!b){this._updatingCamera=!0;const C=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),P=E=>0!==E&&-this._bearingSnap<E&&E<this._bearingSnap;C?(P(C.bearing||this._map.getBearing())&&(C.bearing=0),this._map.easeTo(C,{originalEvent:y})):(this._map.fire(new de("moveend",{originalEvent:y})),P(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,r){this._map.fire(new de(t,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new DM("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const FE="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class zE extends Ro{constructor(t,r){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=r.bearingSnap,this._respectPrefersReducedMotion=!1!==r.respectPrefersReducedMotion,Tn(["_renderFrameCallback"],this)}getCenter(){return new kn(this.transform.center.lng,this.transform.center.lat)}setCenter(t,r){return this.jumpTo({center:t},r)}panBy(t,r,s){return t=tt.convert(t).mult(-1),this.panTo(this.transform.center,_t({offset:t},r),s)}panTo(t,r,s){return this.easeTo(_t({center:t},r),s)}getZoom(){return this.transform.zoom}setZoom(t,r){return this.jumpTo({zoom:t},r),this}zoomTo(t,r,s){return this.easeTo(_t({zoom:t},r),s)}zoomIn(t,r){return this.zoomTo(this.getZoom()+1,t,r),this}zoomOut(t,r){return this.zoomTo(this.getZoom()-1,t,r),this}getBearing(){return this.transform.bearing}setBearing(t,r){return this.jumpTo({bearing:t},r),this}getPadding(){return this.transform.padding}setPadding(t,r){return this.jumpTo({padding:t},r),this}rotateTo(t,r,s){return this.easeTo(_t({bearing:t},r),s)}resetNorth(t,r){return this.rotateTo(0,_t({duration:1e3},t),r),this}resetNorthPitch(t,r){return this.easeTo(_t({bearing:0,pitch:0,duration:1e3},t),r),this}snapToNorth(t,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,r):this}getPitch(){return this.transform.pitch}setPitch(t,r){return this.jumpTo({pitch:t},r),this}cameraForBounds(t,r){t=Qo.convert(t);const s=r&&r.bearing||0,c=r&&r.pitch||0,d=t.getNorthWest(),f=t.getSouthEast();return this._cameraForBounds(this.transform,d,f,s,c,r)}_extendCameraOptions(t){const r={top:0,bottom:0,right:0,left:0};if("number"==typeof(t=_t({padding:r,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding){const s=t.padding;t.padding={top:s,bottom:s,right:s,left:s}}return t.padding=_t(r,t.padding),t}_minimumAABBFrustumDistance(t,r){const s=r.max[0]-r.min[0],c=r.max[1]-r.min[1];return s/c>t.aspect?s/(2*Math.tan(.5*t.fovX)*t.aspect):c/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(t,r,s,c,d,f){const g=t.clone(),y=this._extendCameraOptions(f);g.bearing=c,g.pitch=d;const b=kn.convert(r),C=kn.convert(s),P=.5*(b.lat+C.lat),E=.5*(b.lng+C.lng),I=ra(P,E),A=dt.normalize([],I),l=dt.normalize([],dt.cross([],A,[0,1,0])),u=dt.cross([],l,A),p=[l[0],l[1],l[2],0,u[0],u[1],u[2],0,A[0],A[1],A[2],0,0,0,0,1],m=[I,ra(b.lat,b.lng),ra(C.lat,b.lng),ra(C.lat,C.lng),ra(b.lat,C.lng),ra(P,b.lng),ra(P,C.lng),ra(b.lat,E),ra(C.lat,E)];let v=yo.fromPoints(m.map(ct=>[dt.dot(l,ct),dt.dot(u,ct),dt.dot(A,ct)]));const M=dt.transformMat4([],v.center,p);0===dt.squaredLength(M)&&dt.set(M,0,0,1),dt.normalize(M,M),dt.scale(M,M,ea),g.center=function([ct,yt,Et]){const Tt=Math.hypot(ct,yt,Et),zt=Math.atan2(ct,Et),Nt=.5*Math.PI-Math.acos(-yt/Tt);return new kn(ge(zt),ge(Nt))}(M);const O=g.getWorldToCameraMatrix(),T=bt.invert(new Float64Array(16),O);v=yo.applyTransform(v,bt.multiply([],O,p)),dt.transformMat4(M,M,O);const k=.5*(v.max[2]-v.min[2]),N=this._minimumAABBFrustumDistance(g,v),F=dt.scale([],[0,0,1],k),$=dt.add(F,M,F),q=N+(0===g.pitch?0:dt.distance(M,$)),Z=g.globeCenterInViewSpace,X=dt.sub([],M,[Z[0],Z[1],Z[2]]);dt.normalize(X,X),dt.scale(X,X,q);const K=dt.add([],M,X);dt.transformMat4(K,K,T);const J=Ep/ea,st=dt.length(K),it=oo(Math.max(st*J-Ep,Number.EPSILON),0),rt=Math.min(g.zoomFromMercatorZAdjusted(it),y.maxZoom);return rt>.5*(Bu+Bd)?(g.setProjection({name:"mercator"}),g.zoom=rt,this._cameraForBounds(g,r,s,c,d,f)):{center:g.center,zoom:rt,bearing:c,pitch:d}}queryTerrainElevation(t,r){const s=this.transform.elevation;return s?(r=_t({},{exaggerated:!0},r),s.getAtPoint(Xn.fromLngLat(t),null,r.exaggerated)):null}_cameraForBounds(t,r,s,c,d,f){if("globe"===t.projection.name)return this._cameraForBoundsOnGlobe(t,r,s,c,d,f);const g=t.clone(),y=this._extendCameraOptions(f),b=g.padding;g.bearing=c,g.pitch=d;const C=kn.convert(r),P=kn.convert(s),E=new kn(C.lng,P.lat),I=new kn(P.lng,C.lat),A=g.project(C),l=g.project(P),u=this.queryTerrainElevation(C),p=this.queryTerrainElevation(P),m=this.queryTerrainElevation(E),v=this.queryTerrainElevation(I),M=[[A.x,A.y,Math.min(u||0,p||0,m||0,v||0)],[l.x,l.y,Math.max(u||0,p||0,m||0,v||0)]];let O=yo.fromPoints(M);const T=g.getWorldToCameraMatrix(),k=bt.invert(new Float64Array(16),T);O=yo.applyTransform(O,T);const N=dt.sub([],O.max,O.min),F=b.left||0,$=b.right||0,q=b.bottom||0,Z=b.top||0,{left:X,right:K,top:J,bottom:st}=y.padding,it=.5*(F+$),rt=.5*(Z+q),ct=Math.min(g.scaleZoom(g.scale*Math.min((g.width-(F+$+X+K))/N[0],(g.height-(q+Z+st+J))/N[1])),y.maxZoom),yt=g.scale/g.zoomScale(ct);O=new yo([O.min[0]-(X+it)*yt,O.min[1]-(st+rt)*yt,O.min[2]],[O.max[0]+(K+it)*yt,O.max[1]+(J+rt)*yt,O.max[2]]);const Et=.5*N[2],Tt=this._minimumAABBFrustumDistance(g,O),zt=[0,0,1,0];kr.transformMat4(zt,zt,T),kr.normalize(zt,zt);const Nt=dt.scale([],zt,Tt+Et),$t=dt.add([],O.center,Nt),Rt=("number"==typeof y.offset.x&&"number"==typeof y.offset.y?new tt(y.offset.x,y.offset.y):tt.convert(y.offset)).rotate(-Ct(c));O.center[0]-=Rt.x*yt,O.center[1]+=Rt.y*yt,dt.transformMat4(O.center,O.center,k),dt.transformMat4($t,$t,k);const oe=[O.center[0],O.center[1],$t[2]*g.pixelsPerMeter];dt.scale(oe,oe,1/g.worldSize);const Oe=ka(oe[0]),Ee=ti(oe[1]),Be=Math.min(g._zoomFromMercatorZ(oe[2]),y.maxZoom),je=new kn(Oe,Ee);return g.mercatorFromTransition&&Be<.5*(Bu+Bd)?(g.setProjection({name:"globe"}),g.zoom=Be,this._cameraForBounds(g,r,s,c,d,f)):{center:je,zoom:Be,bearing:c,pitch:d}}fitBounds(t,r,s){const c=this.cameraForBounds(t,r);return this._fitInternal(c,r,s)}fitScreenCoordinates(t,r,s,c,d){const f=tt.convert(t),g=tt.convert(r),y=new tt(Math.min(f.x,g.x),Math.min(f.y,g.y)),b=new tt(Math.max(f.x,g.x),Math.max(f.y,g.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(f,g))return this;const C=this.transform.pointLocation3D(y),P=this.transform.pointLocation3D(b),E=this.transform.pointLocation3D(new tt(y.x,b.y)),I=this.transform.pointLocation3D(new tt(b.x,y.y)),A=[Math.min(C.lng,P.lng,E.lng,I.lng),Math.min(C.lat,P.lat,E.lat,I.lat)],l=[Math.max(C.lng,P.lng,E.lng,I.lng),Math.max(C.lat,P.lat,E.lat,I.lat)],u=c&&c.pitch?c.pitch:this.getPitch(),p=this._cameraForBounds(this.transform,A,l,s,u,c);return this._fitInternal(p,c,d)}_fitInternal(t,r,s){return t?(delete(r=_t(t,r)).padding,r.linear?this.easeTo(r,s):this.flyTo(r,s)):this}jumpTo(t,r){this.stop();const s=t.preloadOnly?this.transform.clone():this.transform;let c=!1,d=!1,f=!1;return"zoom"in t&&s.zoom!==+t.zoom&&(c=!0,s.zoom=+t.zoom),void 0!==t.center&&(s.center=kn.convert(t.center)),"bearing"in t&&s.bearing!==+t.bearing&&(d=!0,s.bearing=+t.bearing),"pitch"in t&&s.pitch!==+t.pitch&&(f=!0,s.pitch=+t.pitch),null==t.padding||s.isPaddingEqual(t.padding)||(s.padding=t.padding),t.preloadOnly?(this._preloadTiles(s),this):(this.fire(new de("movestart",r)).fire(new de("move",r)),c&&this.fire(new de("zoomstart",r)).fire(new de("zoom",r)).fire(new de("zoomend",r)),d&&this.fire(new de("rotatestart",r)).fire(new de("rotate",r)).fire(new de("rotateend",r)),f&&this.fire(new de("pitchstart",r)).fire(new de("pitch",r)).fire(new de("pitchend",r)),this.fire(new de("moveend",r)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||gt(FE),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,r){const s=this.transform;if(!s.projection.supportsFreeCamera)return gt(FE),this;this.stop();const c=s.zoom,d=s.pitch,f=s.bearing;s.setFreeCameraOptions(t);const g=c!==s.zoom,y=d!==s.pitch,b=f!==s.bearing;return this.fire(new de("movestart",r)).fire(new de("move",r)),g&&this.fire(new de("zoomstart",r)).fire(new de("zoom",r)).fire(new de("zoomend",r)),b&&this.fire(new de("rotatestart",r)).fire(new de("rotate",r)).fire(new de("rotateend",r)),y&&this.fire(new de("pitchstart",r)).fire(new de("pitch",r)).fire(new de("pitchend",r)),this.fire(new de("moveend",r)),this}easeTo(t,r){this._stop(!1,t.easeId),(!1===(t=_t({offset:[0,0],duration:500,easing:Yr},t)).animate||this._prefersReducedMotion(t))&&(t.duration=0);const s=this.transform,c=this.getZoom(),d=this.getBearing(),f=this.getPitch(),g=this.getPadding(),y="zoom"in t?+t.zoom:c,b="bearing"in t?this._normalizeBearing(t.bearing,d):d,C="pitch"in t?+t.pitch:f,P="padding"in t?t.padding:s.padding,E=tt.convert(t.offset);let I,A,l;if("globe"===s.projection.name){const F=Xn.fromLngLat(s.center),$=E.rotate(-s.angle);F.x+=$.x/s.worldSize,F.y+=$.y/s.worldSize;const q=F.toLngLat(),Z=kn.convert(t.center||q);this._normalizeCenter(Z),I=s.centerPoint.add($),A=new tt(F.x,F.y).mult(s.worldSize),l=new tt(yi(Z.lng),Oo(Z.lat)).mult(s.worldSize).sub(A)}else{I=s.centerPoint.add(E);const F=s.pointLocation(I),$=kn.convert(t.center||F);this._normalizeCenter($),A=s.project(F),l=s.project($).sub(A)}const u=s.zoomScale(y-c);let p,m;t.around&&(p=kn.convert(t.around),m=s.locationPoint(p));const v=this._zooming||y!==c,M=this._rotating||d!==b,O=this._pitching||C!==f,T=!s.isPaddingEqual(P),k=F=>$=>{if(v&&(F.zoom=vn(c,y,$)),M&&(F.bearing=vn(d,b,$)),O&&(F.pitch=vn(f,C,$)),T&&(F.interpolatePadding(g,P,$),I=F.centerPoint.add(E)),p)F.setLocationAtPoint(p,m);else{const q=F.zoomScale(F.zoom-c),Z=y>c?Math.min(2,u):Math.max(.5,u),X=Math.pow(Z,1-$),K=F.unproject(A.add(l.mult($*X)).mult(q));F.setLocationAtPoint(F.renderWorldCopies?K.wrap():K,I)}return t.preloadOnly||this._fireMoveEvents(r),F};if(t.preloadOnly){const F=this._emulate(k,t.duration,s);return this._preloadTiles(F),this}const N={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=v,this._rotating=M,this._pitching=O,this._padding=T,this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,N),this._ease(k(s),F=>{"sea"===s.cameraElevationReference&&s.recenterOnTerrain(),this._afterEase(r,F)},t),this}_prepareEase(t,r,s={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&0===this.transform.pitch&&"globe"!==this.transform.projection.name&&(this.transform.cameraElevationReference="ground"),r||s.moving||this.fire(new de("movestart",t)),this._zooming&&!s.zooming&&this.fire(new de("zoomstart",t)),this._rotating&&!s.rotating&&this.fire(new de("rotatestart",t)),this._pitching&&!s.pitching&&this.fire(new de("pitchstart",t))}_fireMoveEvents(t){this.fire(new de("move",t)),this._zooming&&this.fire(new de("zoom",t)),this._rotating&&this.fire(new de("rotate",t)),this._pitching&&this.fire(new de("pitch",t))}_afterEase(t,r){if(this._easeId&&r&&this._easeId===r)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const s=this._zooming,c=this._rotating,d=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,s&&this.fire(new de("zoomend",t)),c&&this.fire(new de("rotateend",t)),d&&this.fire(new de("pitchend",t)),this.fire(new de("moveend",t))}flyTo(t,r){if(this._prefersReducedMotion(t)){const ct=he(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ct,r)}this.stop(),t=_t({offset:[0,0],speed:1.2,curve:1.42,easing:Yr},t);const s=this.transform,c=this.getZoom(),d=this.getBearing(),f=this.getPitch(),g=this.getPadding(),y="zoom"in t?Ne(+t.zoom,s.minZoom,s.maxZoom):c,b="bearing"in t?this._normalizeBearing(t.bearing,d):d,C="pitch"in t?+t.pitch:f,P="padding"in t?t.padding:s.padding,E=s.zoomScale(y-c),I=tt.convert(t.offset);let A=s.centerPoint.add(I);const l=s.pointLocation(A),u=kn.convert(t.center||l);this._normalizeCenter(u);const p=s.project(l),m=s.project(u).sub(p);let v=t.curve;const M=Math.max(s.width,s.height),O=M/E,T=m.mag();if("minZoom"in t){const ct=Ne(Math.min(t.minZoom,c,y),s.minZoom,s.maxZoom),yt=M/s.zoomScale(ct-c);v=Math.sqrt(yt/T*2)}const k=v*v;function N(ct){const yt=(O*O-M*M+(ct?-1:1)*k*k*T*T)/(2*(ct?O:M)*k*T);return Math.log(Math.sqrt(yt*yt+1)-yt)}function F(ct){return(Math.exp(ct)-Math.exp(-ct))/2}function $(ct){return(Math.exp(ct)+Math.exp(-ct))/2}const q=N(0);let Z=function(ct){return $(q)/$(q+v*ct)},X=function(ct){return M*(($(q)*(F(yt=q+v*ct)/$(yt))-F(q))/k)/T;var yt},K=(N(1)-q)/v;if(Math.abs(T)<1e-6||!isFinite(K)){if(Math.abs(M-O)<1e-6)return this.easeTo(t,r);const ct=O<M?-1:1;K=Math.abs(Math.log(O/M))/v,X=function(){return 0},Z=function(yt){return Math.exp(ct*v*yt)}}t.duration="duration"in t?+t.duration:1e3*K/("screenSpeed"in t?+t.screenSpeed/v:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const J=d!==b,st=C!==f,it=!s.isPaddingEqual(P),rt=ct=>yt=>{const Et=yt*K,Tt=1/Z(Et);ct.zoom=1===yt?y:c+ct.scaleZoom(Tt),J&&(ct.bearing=vn(d,b,yt)),st&&(ct.pitch=vn(f,C,yt)),it&&(ct.interpolatePadding(g,P,yt),A=ct.centerPoint.add(I));const zt=1===yt?u:ct.unproject(p.add(m.mult(X(Et))).mult(Tt));return ct.setLocationAtPoint(ct.renderWorldCopies?zt.wrap():zt,A),ct._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(r),ct};if(t.preloadOnly){const ct=this._emulate(rt,t.duration,s);return this._preloadTiles(ct),this}return this._zooming=!0,this._rotating=J,this._pitching=st,this._padding=it,this._prepareEase(r,!1),this._ease(rt(s),()=>this._afterEase(r),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,r){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const s=this._onEaseEnd;this._onEaseEnd=void 0,s.call(this,r)}if(!t){const s=this.handlers;s&&s.stop(!1)}return this}_ease(t,r,s){!1===s.animate||0===s.duration?(t(1),r()):(this._easeStart=Mn.now(),this._easeOptions=s,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((Mn.now()-this._easeStart)/this._easeOptions.duration,1),r=this._onEaseFrame;r&&r(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,r){t=Wt(t,-180,180);const s=Math.abs(t-r);return Math.abs(t-360-r)<s&&(t-=360),Math.abs(t+360-r)<s&&(t+=360),t}_normalizeCenter(t){const r=this.transform;if(r.maxBounds||"globe"!==r.projection.name&&!r.renderWorldCopies)return;const s=t.lng-r.center.lng;t.lng+=s>180?-360:s<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&Mn.prefersReducedMotion&&!(t&&t.essential)}_emulate(t,r,s){const c=Math.ceil(15*r/1e3),d=[],f=t(s.clone());for(let g=0;g<=c;g++){const y=f(g/c);d.push(y.clone())}return d}}class kM{constructor(t={}){this.options=t,Tn(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const r=this.options&&this.options.compact;return this._map=t,this._container=eo("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=eo("button","mapboxgl-ctrl-attrib-button",this._container),eo("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=eo("div","mapboxgl-ctrl-attrib-inner",this._container),r&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===r&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,r){const s=this._map._getUIString(`AttributionControl.${r}`);t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",s)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||ue.ACCESS_TOKEN}];if(t){const s=r.reduce((c,d,f)=>(d.value&&(c+=`${d.key}=${d.value}${f<r.length-1?"&":""}`),c),"?");t.href=`${ue.FEEDBACK_URL}/${s}#${Nf(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const c=this._map.style.stylesheet;this.styleOwner=c.owner,this.styleId=c.id}const r=this._map.style._mergedSourceCaches;for(const c in r){const d=r[c];if(d.used){const f=d.getSource();f.attribution&&t.indexOf(f.attribution)<0&&t.push(f.attribution)}}t.sort((c,d)=>c.length-d.length),t=t.filter((c,d)=>{for(let f=d+1;f<t.length;f++)if(t[f].indexOf(c)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const s=t.join(" | ");s!==this._attribHTML&&(this._attribHTML=s,t.length?(this._innerContainer.innerHTML=s,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class rS{constructor(){Tn(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=eo("div","mapboxgl-ctrl");const r=eo("a","mapboxgl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://www.mapbox.com/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const r in t){const s=t[r].getSource();if(s.hasOwnProperty("mapbox_logo")&&!s.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const r=t[0];this._map.getCanvasContainer().offsetWidth<250?r.classList.add("mapboxgl-compact"):r.classList.remove("mapboxgl-compact")}}}class I2{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const r=++this._id;return this._queue.push({callback:t,id:r,cancelled:!1}),r}remove(t){const r=this._currentlyRunning,s=r?this._queue.concat(r):this._queue;for(const c of s)if(c.id===t)return void(c.cancelled=!0)}run(t=0){const r=this._currentlyRunning=this._queue;this._queue=[];for(const s of r)if(!s.cancelled&&(s.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function RM(e,t,r){if(e=new kn(e.lng,e.lat),t){const s=new kn(e.lng-360,e.lat),c=new kn(e.lng+360,e.lat),d=360*Math.ceil(Math.abs(e.lng-r.center.lng)/360),f=r.locationPoint(e).distSqr(t),g=t.x<0||t.y<0||t.x>r.width||t.y>r.height;r.locationPoint(s).distSqr(t)<f&&(g||Math.abs(s.lng-r.center.lng)<d)?e=s:r.locationPoint(c).distSqr(t)<f&&(g||Math.abs(c.lng-r.center.lng)<d)&&(e=c)}for(;Math.abs(e.lng-r.center.lng)>180;){const s=r.locationPoint(e);if(s.x>=0&&s.y>=0&&s.x<=r.width&&s.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}const LM={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class NM extends Ro{constructor(t,r){if(super(),(t instanceof lt.HTMLElement||r)&&(t=_t({element:t},r)),Tn(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=tt.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=eo("div");const d=41,f=27,g=oa("svg",{display:"block",height:d*this._scale+"px",width:f*this._scale+"px",viewBox:`0 0 ${f} ${d}`},this._element),y=oa("radialGradient",{id:"shadowGradient"},oa("defs",{},g));oa("stop",{offset:"10%","stop-opacity":.4},y),oa("stop",{offset:"100%","stop-opacity":.05},y),oa("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},g),oa("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},g),oa("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},g),oa("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},g),this._offset=tt.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()});const s=this._element.classList;for(const d in LM)s.remove(`mapboxgl-marker-anchor-${d}`);s.add(`mapboxgl-marker-anchor-${this._anchor}`);const c=t&&t.className?t.className.trim().split(/\s+/):[];s.add(...c),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=kn.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const c=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[c,-1*(24.6+c)],"bottom-right":[-c,-1*(24.6+c)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const r=t.code,s=t.charCode||t.keyCode;"Space"!==r&&"Enter"!==r&&32!==s&&13!==s||this.togglePopup()}_onMapClick(t){const r=t.originalEvent.target,s=this._element;this._popup&&(r===s||s.contains(r))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,r=this._pos;if(!t||!r)return!1;const s=t.unproject(r),c=t.getFreeCameraOptions();if(!c.position)return!1;const d=c.position.toLngLat();return d.distanceTo(s)<.9*d.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const r=this._pos;if(!r||r.x<0||r.x>t.transform.width||r.y<0||r.y>t.transform.height)return void this._clearFadeTimer();const s=t.unproject(r);let c;t._showingGlobe()&&y0(t.transform,this._lngLat)?c=0:(c=1-t._queryFogOpacity(s),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(c*=this._occludedOpacity)),this._element.style.opacity=`${c}`,this._element.style.pointerEvents=c>0?"auto":"none",this._popup&&this._popup._setOpacity(c),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const r=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${t.x}px,${t.y}px)\n            ${LM[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${r.x}px,${r.y}px)\n        `}_calculateXYTransform(){const t=this._pos,r=this._map,s=this.getPitchAlignment();if(!r||!t||"map"!==s)return"";if(!r._showingGlobe()){const y=r.getPitch();return y?`rotateX(${y}deg)`:""}const c=ge(Lg(r.transform,this._lngLat)),d=t.sub(Vu(r.transform)),f=Math.abs(d.x)+Math.abs(d.y);if(0===f)return"";const g=c/f;return`rotateX(${-d.y*g}deg) rotateY(${d.x*g}deg)`}_calculateZTransform(){const t=this._pos,r=this._map;if(!r||!t)return"";let s=0;const c=this.getRotationAlignment();if("map"===c)if(r._showingGlobe()){const d=r.project(new kn(this._lngLat.lng,this._lngLat.lat+.001)),f=r.project(new kn(this._lngLat.lng,this._lngLat.lat-.001)).sub(d);s=ge(Math.atan2(f.y,f.x))-90}else s=-r.getBearing();else if("horizon"===c){const d=vs(4,6,r.getZoom()),f=Vu(r.transform);f.y+=d*r.transform.height;const g=t.sub(f),y=ge(Math.atan2(g.y,g.x));s=(y>90?y-270:y+90)*(1-d)}return s+=this._rotation,s?`rotateZ(${s}deg)`:""}_update(t){lt.cancelAnimationFrame(this._updateFrameId);const r=this._map;r&&(r.transform.renderWorldCopies&&(this._lngLat=RM(this._lngLat,this._pos,r.transform)),this._pos=r.project(this._lngLat),!0===t?this._updateFrameId=lt.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),r._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(r._showingGlobe()||r.getTerrain()||r.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=tt.convert(t),this._update(),this}addClassName(t){return this._element.classList.add(t),this}removeClassName(t){return this._element.classList.remove(t),this}toggleClassName(t){return this._element.classList.toggle(t)}_onMove(t){const r=this._map;if(!r)return;const s=this._pointerdownPos,c=this._positionDelta;if(s&&c){if(!this._isDragging){const d=this._clickTolerance||r._clickTolerance;if(t.point.dist(s)<d)return;this._isDragging=!0}this._pos=t.point.sub(c),this._lngLat=r.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new de("dragstart"))),this.fire(new de("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new de("dragend")),this._state="inactive"}_addDragHandler(t){const r=this._map,s=this._pos;r&&s&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(s),this._pointerdownPos=t.point,this._state="pending",r.on("mousemove",this._onMove),r.on("touchmove",this._onMove),r.once("mouseup",this._onUp),r.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const r=this._map;return r&&(t?(r.on("mousedown",this._addDragHandler),r.on("touchstart",this._addDragHandler)):(r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const oS={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},FM=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function S2(e=new tt(0,0),t="bottom"){if("number"==typeof e){const r=Math.round(Math.sqrt(.5*Math.pow(e,2)));switch(t){case"top":return new tt(0,e);case"top-left":return new tt(r,r);case"top-right":return new tt(-r,r);case"bottom":return new tt(0,-e);case"bottom-left":return new tt(r,-r);case"bottom-right":return new tt(-r,-r);case"left":return new tt(e,0);case"right":return new tt(-e,0)}return new tt(0,0)}return e instanceof tt||Array.isArray(e)?tt.convert(e):tt.convert(e[t]||[0,0])}class iS{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const r=Vo((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-r)+this._end*r}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,r,s){this._start=this.getValue(r),this._end=t,this._startTime=r,this._endTime=r+s}}const BE={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},A2={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},yA={showCompass:!0,showZoom:!0,visualizePitch:!1};class sS{constructor(t,r,s=!1){this._clickTolerance=10,this.element=r,this.mouseRotate=new XI({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,s&&(this.mousePitch=new QI({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),Tn(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener("mousedown",this.mousedown),r.addEventListener("touchstart",this.touchstart,{passive:!1}),r.addEventListener("touchmove",this.touchmove),r.addEventListener("touchend",this.touchend),r.addEventListener("touchcancel",this.reset)}down(t,r){this.mouseRotate.mousedown(t,r),this.mousePitch&&this.mousePitch.mousedown(t,r),$f()}move(t,r){const s=this.map,c=this.mouseRotate.mousemoveWindow(t,r),d=c&&c.bearingDelta;if(d&&s.setBearing(s.getBearing()+d),this.mousePitch){const f=this.mousePitch.mousemoveWindow(t,r),g=f&&f.pitchDelta;g&&s.setPitch(s.getPitch()+g)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Hy(),lt.removeEventListener("mousemove",this.mousemove),lt.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(_t({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),vi(this.element,t)),lt.addEventListener("mousemove",this.mousemove),lt.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,vi(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=cu(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=cu(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const D2={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},aS={maxWidth:100,unit:"metric"},vA={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},zM={version:ye,supported:lg,setRTLTextPlugin:function(e,t,r=!1){if(si===mr||si===hr||si===_o)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ta=Mn.resolveURL(e),si=mr,Ci=t,Zi(),r||Vh()},getRTLTextPluginStatus:Du,Map:class extends zE{constructor(e){mh.mark(ml.create);const t=e;if(null!=(e=_t({},A2,e)).minZoom&&null!=e.maxZoom&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=e.minPitch&&null!=e.maxPitch&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=e.minPitch&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=e.maxPitch&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(e.antialias&&function(r){const s=r.navigator?r.navigator.userAgent:null;return!!function(c){if(null==Ze){const d=c.navigator?c.navigator.userAgent:null;Ze=!!c.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return Ze}(r)&&s&&(s.match("Version/15.4")||s.match("Version/15.5")||s.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))}(lt)&&(e.antialias=!1,gt("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new lh(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),e),this._interactive=e.interactive,this._minTileCacheSize=e.minTileCacheSize,this._maxTileCacheSize=e.maxTileCacheSize,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=e.crossSourceCollisions,this._collectResourceTiming=e.collectResourceTiming,this._language=this._parseLanguage(e.language),this._worldview=e.worldview,this._renderTaskQueue=new I2,this._domRenderTaskQueue=new I2,this._controls=[],this._markers=[],this._popups=[],this._mapId=In(),this._locale=_t({},BE,e.locale),this._clickTolerance=e.clickTolerance,this._cooperativeGestures=e.cooperativeGestures,this._performanceMetricsCollection=e.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new iS(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new ee(e.transformRequest,e.accessToken,e.testMode),this._silenceAuthErrors=!!e.testMode,this._contextCreateOptions=e.contextCreateOptions?{...e.contextCreateOptions}:{},"string"==typeof e.container){if(this._container=lt.document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container.toString()}' not found.`)}else{if(!(e.container instanceof lt.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(this._container.childNodes.length>0&&gt("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),e.maxBounds&&this.setMaxBounds(e.maxBounds),Tn(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==lt&&(this._fullscreenchangeEvent="onfullscreenchange"in lt.document?"fullscreenchange":"webkitfullscreenchange",lt.addEventListener("online",this._onWindowOnline,!1),lt.addEventListener("resize",this._onWindowResize,!1),lt.addEventListener("orientationchange",this._onWindowResize,!1),lt.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),lt.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new NE(this,e),this._localFontFamily=e.localFontFamily,this._localIdeographFontFamily=e.localIdeographFontFamily,(e.style||!e.testMode)&&this.setStyle(e.style||ue.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),e.projection&&this.setProjection(e.projection),e.hash&&(this._hash=new b2("string"==typeof e.hash&&e.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){null==t.center&&null==t.zoom||(this.transform._unmodified=!1),this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch});const r=e.bounds;r&&(this.resize(),this.fitBounds(r,_t({},e.fitBoundsOptions,{duration:0})))}this.resize(),e.attributionControl&&this.addControl(new kM({customAttribution:e.customAttribution})),this._logoControl=new rS,this.addControl(this._logoControl,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update("style"===r.dataType),this.fire(new de(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new de(`${r.dataType}dataloading`,r))})}_getMapId(){return this._mapId}addControl(e,t){if(void 0===t&&(t=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new Cn(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=e.onAdd(this);this._controls.push(e);const s=this._controlPositions[t];return-1!==t.indexOf("bottom")?s.insertBefore(r,s.firstChild):s.appendChild(r),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new Cn(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(e);return t>-1&&this._controls.splice(t,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(e){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new de("movestart",e)).fire(new de("move",e)),this.fire(new de("resize",e)),t&&this.fire(new de("moveend",e)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(e){return this.transform.setMaxBounds(Qo.convert(e)),this._update()}setMinZoom(e){if((e=e??-2)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e?this.setZoom(e):this.fire(new de("zoomstart")).fire(new de("zoom")).fire(new de("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=e??22)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e?this.setZoom(e):this.fire(new de("zoomstart")).fire(new de("zoom")).fire(new de("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=e??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e?this.setPitch(e):this.fire(new de("pitchstart")).fire(new de("pitch")).fire(new de("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=e??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e?this.setPitch(e):this.fire(new de("pitchstart")).fire(new de("pitch")).fire(new de("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(e){return"auto"===e?lt.navigator.language:Array.isArray(e)?0===e.length?void 0:e.map(t=>"auto"===t?lt.navigator.language:t):e}setLanguage(e){const t=this._parseLanguage(e);if(!this.style||t===this._language)return this;this._language=t,this.style.reloadSources();for(const r of this._controls)r._setLanguage&&r._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(e){return this.style&&e!==this._worldview?(this._worldview=e,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(e){return this._lazyInitEmptyStyle(),e?"string"==typeof e&&(e={name:e}):e=null,this._useExplicitProjection=!!e,this._prioritizeAndUpdateProjection(e,this.style.projection)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const e=this.transform,t=e.projection.name;let r;"globe"===t&&e.zoom>=Bd?(e.setMercatorFromTransition(),r=!0):"mercator"===t&&e.zoom<Bd&&(e.setProjection({name:"globe"}),r=!0),r&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(e,t){return this._updateProjection(e||t||{name:"mercator"})}_updateProjection(e){let t;return t="globe"===e.name&&this.transform.zoom>=Bd?this.transform.setMercatorFromTransition():this.transform.setProjection(e),this.style.applyProjectionUpdate(),t&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(e){return this.transform.locationPoint3D(kn.convert(e))}unproject(e){return this.transform.pointLocation3D(tt.convert(e))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(e,t,r){if("mouseenter"===e||"mouseover"===e){let s=!1;const c=f=>{const g=t.filter(b=>this.getLayer(b)),y=g.length?this.queryRenderedFeatures(f.point,{layers:g}):[];y.length?s||(s=!0,r.call(this,new Ba(e,this,f.originalEvent,{features:y}))):s=!1},d=()=>{s=!1};return{layers:new Set(t),listener:r,delegates:{mousemove:c,mouseout:d}}}if("mouseleave"===e||"mouseout"===e){let s=!1;const c=f=>{const g=t.filter(y=>this.getLayer(y));(g.length?this.queryRenderedFeatures(f.point,{layers:g}):[]).length?s=!0:s&&(s=!1,r.call(this,new Ba(e,this,f.originalEvent)))},d=f=>{s&&(s=!1,r.call(this,new Ba(e,this,f.originalEvent)))};return{layers:new Set(t),listener:r,delegates:{mousemove:c,mouseout:d}}}{const s=c=>{const d=t.filter(g=>this.getLayer(g)),f=d.length?this.queryRenderedFeatures(c.point,{layers:d}):[];f.length&&(c.features=f,r.call(this,c),delete c.features)};return{layers:new Set(t),listener:r,delegates:{[e]:s}}}}on(e,t,r){if(void 0===r)return super.on(e,t);if(Array.isArray(t)||(t=[t]),t)for(const c of t)if(!this._isValidId(c))return this;const s=this._createDelegatedListener(e,t,r);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(s);for(const c in s.delegates)this.on(c,s.delegates[c]);return this}once(e,t,r){if(void 0===r)return super.once(e,t);if(Array.isArray(t)||(t=[t]),t)for(const c of t)if(!this._isValidId(c))return this;const s=this._createDelegatedListener(e,t,r);for(const c in s.delegates)this.once(c,s.delegates[c]);return this}off(e,t,r){if(void 0===r)return super.off(e,t);t=new Set(Array.isArray(t)?t:[t]);for(const d of t)if(!this._isValidId(d))return this;const s=(d,f)=>{if(d.size!==f.size)return!1;for(const g of d)if(!f.has(g))return!1;return!0},c=this._delegatedListeners?this._delegatedListeners[e]:void 0;return c&&(d=>{for(let f=0;f<d.length;f++){const g=d[f];if(g.listener===r&&s(g.layers,t)){for(const y in g.delegates)this.off(y,g.delegates[y]);return d.splice(f,1),this}}})(c),this}queryRenderedFeatures(e,t){if(!this.style)return[];if(void 0!==t||void 0===e||e instanceof tt||Array.isArray(e)||(t=e,e=void 0),e=e||[[0,0],[this.transform.width,this.transform.height]],(t=t||{}).layers&&Array.isArray(t.layers))for(const r of t.layers)if(!this._isValidId(r))return[];return this.style.queryRenderedFeatures(e,t,this.transform)}querySourceFeatures(e,t){return this._isValidId(e)?this.style.querySourceFeatures(e,t):[]}isPointOnSurface(e){const{name:t}=this.transform.projection;return"globe"!==t&&"mercator"!==t&&gt(`${t} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(tt.convert(e))}setStyle(e,t){return!1!==(t=_t({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&e?(this._diffStyle(e,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(e,t))}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),e&&(this.style=new ph(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ph(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,t){if("string"==typeof e){const r=this._requestManager.normalizeStyleURL(e),s=this._requestManager.transformRequest(r,Ft.Style);_e(s,(c,d)=>{c?this.fire(new Cn(c)):d&&this._updateDiff(d,t)})}else"object"==typeof e&&this._updateDiff(e,t)}_updateDiff(e,t){try{this.style.setState(e)&&this._update(!0)}catch(r){gt(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(e,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(gt("There is no style added to the map."),!1)}_isValidId(e){return null==e?(this.fire(new Cn(new Error("IDs can't be empty."))),!1):!un(e)||(this.fire(new Cn(new Error(`IDs can't contain special symbols: "${e}".`))),!1)}addSource(e,t){return this._isValidId(e)?(this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)):this}isSourceLoaded(e){return!!this._isValidId(e)&&!!this.style&&this.style._isSourceCacheLoaded(e)}areTilesLoaded(){const e=this.style&&this.style._sourceCaches;for(const t in e){const r=e[t]._tiles;for(const s in r){const c=r[s];if("loaded"!==c.state&&"errored"!==c.state)return!1}}return!0}addSourceType(e,t,r){this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,r)}removeSource(e){return this._isValidId(e)?(this.style.removeSource(e),this._updateTerrain(),this._update(!0)):this}getSource(e){return this._isValidId(e)?this.style.getOwnSource(e):null}addImage(e,t,{pixelRatio:r=1,sdf:s=!1,stretchX:c,stretchY:d,content:f}={}){if(this._lazyInitEmptyStyle(),t instanceof lt.HTMLImageElement||lt.ImageBitmap&&t instanceof lt.ImageBitmap){const{width:g,height:y,data:b}=Mn.getImageData(t);this.style.addImage(e,{data:new Ui({width:g,height:y},b),pixelRatio:r,stretchX:c,stretchY:d,content:f,sdf:s,version:0})}else if(void 0===t.width||void 0===t.height)this.fire(new Cn(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:g,height:y}=t,b=t;this.style.addImage(e,{data:new Ui({width:g,height:y},new Uint8Array(b.data)),pixelRatio:r,stretchX:c,stretchY:d,content:f,sdf:s,version:0,userImage:b}),b.onAdd&&b.onAdd(this,e)}}updateImage(e,t){this._lazyInitEmptyStyle();const r=this.style.getImage(e);if(!r)return void this.fire(new Cn(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const s=t instanceof lt.HTMLImageElement||lt.ImageBitmap&&t instanceof lt.ImageBitmap?Mn.getImageData(t):t,{width:c,height:d}=s;void 0!==c&&void 0!==d?c===r.data.width&&d===r.data.height?(r.data.replace(s.data,!(t instanceof lt.HTMLImageElement||lt.ImageBitmap&&t instanceof lt.ImageBitmap)),this.style.updateImage(e,r)):this.fire(new Cn(new Error(`The width and height of the updated image (${c}, ${d})\n                must be that same as the previous version of the image\n                (${r.data.width}, ${r.data.height})`))):this.fire(new Cn(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(e){return e?!!this.style&&!!this.style.getImage(e):(this.fire(new Cn(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e,t){Bt(this._requestManager.transformRequest(e,Ft.Image),(r,s)=>{t(r,s instanceof lt.HTMLImageElement?Mn.getImageData(s):s)})}listImages(){return this.style.listImages()}addModel(e,t){this._lazyInitEmptyStyle(),this.style.addModel(e,t)}hasModel(e){return e?this.style.hasModel(e):(this.fire(new Cn(new Error("Missing required model id"))),!1)}removeModel(e){this.style.removeModel(e)}listModels(){return this.style.listModels()}addLayer(e,t){return this._isValidId(e.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)):this}moveLayer(e,t){return this._isValidId(e)?(this.style.moveLayer(e,t),this._update(!0)):this}removeLayer(e){return this._isValidId(e)?(this.style.removeLayer(e),this._update(!0)):this}getLayer(e){return this._isValidId(e)?this.style.getOwnLayer(e):null}setLayerZoomRange(e,t,r){return this._isValidId(e)?(this.style.setLayerZoomRange(e,t,r),this._update(!0)):this}setFilter(e,t,r={}){return this._isValidId(e)?(this.style.setFilter(e,t,r),this._update(!0)):this}getFilter(e){return this._isValidId(e)?this.style.getFilter(e):null}setPaintProperty(e,t,r,s={}){return this._isValidId(e)?(this.style.setPaintProperty(e,t,r,s),this._update(!0)):this}getPaintProperty(e,t){return this._isValidId(e)?this.style.getPaintProperty(e,t):null}setLayoutProperty(e,t,r,s={}){return this._isValidId(e)?(this.style.setLayoutProperty(e,t,r,s),this._update(!0)):this}getLayoutProperty(e,t){return this._isValidId(e)?this.style.getLayoutProperty(e,t):null}getConfigProperty(e,t){return this.style.getConfigProperty(e,t)}setConfigProperty(e,t,r){return this.style.setConfigProperty(e,t,r),this._update(!0)}setLights(e){if(this._lazyInitEmptyStyle(),e&&1===e.length&&"flat"===e[0].type){const t=e[0];t.properties?this.style.setFlatLight(t.properties,t.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(e),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const e=this.style.getLights()||[];return 0===e.length&&e.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),e}setLight(e,t={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:e}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(e){return this._lazyInitEmptyStyle(),!e&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(e),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(e){return this._lazyInitEmptyStyle(),this.style.setFog(e),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(e){return this.style.setCamera(e),this._triggerCameraUpdate(e)}_triggerCameraUpdate(e){return this._update(this.transform.setOrthographicProjectionAtLowPitch("orthographic"===e["camera-projection"]))}getCamera(){return this.style.camera}_queryFogOpacity(e){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(kn.convert(e),this.transform):0}setFeatureState(e,t){return this._isValidId(e.source)?(this.style.setFeatureState(e,t),this._update()):this}removeFeatureState(e,t){return this._isValidId(e.source)?(this.style.removeFeatureState(e,t),this._update()):this}getFeatureState(e){return this._isValidId(e.source)?this.style.getFeatureState(e):null}_updateContainerDimensions(){if(!this._container)return;const e=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let r,s,c,d=this._container;for(;d&&(!s||!c);){const f=lt.getComputedStyle(d).transform;f&&"none"!==f&&(r=f.match(/matrix.*\((.+)\)/)[1].split(", "),r[0]&&"0"!==r[0]&&"1"!==r[0]&&(s=r[0]),r[3]&&"0"!==r[3]&&"1"!==r[3]&&(c=r[3])),d=d.parentElement}this._containerWidth=s?Math.abs(e/s):e,this._containerHeight=c?Math.abs(t/c):t}_detectMissingCSS(){"rgb(250, 128, 114)"!==lt.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&gt("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=eo("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=eo("div","mapboxgl-canvas-container",e);this._canvas=eo("canvas","mapboxgl-canvas",t),this._interactive&&(t.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const r=this._controlContainer=eo("div","mapboxgl-control-container",e),s=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(c=>{s[c]=eo("div",`mapboxgl-ctrl-${c}`,r)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,t){const r=Mn.devicePixelRatio||1;this._canvas.width=r*Math.ceil(e),this._canvas.height=r*Math.ceil(t),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`}_addMarker(e){this._markers.push(e)}_removeMarker(e){const t=this._markers.indexOf(e);-1!==t&&this._markers.splice(t,1)}_addPopup(e){this._popups.push(e)}_removePopup(e){const t=this._popups.indexOf(e);-1!==t&&this._popups.splice(t,1)}_setupPainter(){const e=_t({},lg.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl2",e);t?(gl(t,!0),this.painter=new bM(t,this._contextCreateOptions,this.transform),this.on("data",r=>{"source"===r.dataType&&this.painter.setTileLoadedFlag(!0)}),be.testSupport(t)):this.fire(new Cn(new Error("Failed to initialize WebGL")))}_contextLost(e){e.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new de("webglcontextlost",{originalEvent:e}))}_contextRestored(e){this._setupPainter(),this.resize(),this._update(),this.fire(new de("webglcontextrestored",{originalEvent:e}))}_onMapScroll(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_requestDomTask(e){!this.loaded()||this.loaded()&&!this.isMoving()?e():this._domRenderTaskQueue.add(e)}_render(e){let t;this.fire(new de("renderstart"));const r=this.painter.context.extTimerQuery,s=Mn.now(),c=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(t=c.createQuery(),c.beginQuery(r.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],lt.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],lt.performance.now())),this._renderTaskQueue.run(e),this._domRenderTaskQueue.run(e),this._removed)return;this._updateProjectionTransition();const d=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const y=this.transform.zoom,b=this.transform.pitch,C=Mn.now(),P=new Lo(y,{now:C,fadeDuration:d,pitch:b,transition:this.style.transition});this.style.update(P)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let f=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),f=this._updateAverageElevation(s),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):f=this._updateAverageElevation(s),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,d,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:d,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new de("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new de("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const y=Mn.now()-s;c.endQuery(r.TIME_ELAPSED_EXT),setTimeout(()=>{const b=c.getQueryParameter(t,c.QUERY_RESULT)/1e6;c.deleteQuery(t),this.fire(new de("gpu-timing-frame",{cpuTime:y,gpuTime:b})),lt.performance.mark("frame-gpu",{startTime:s,detail:{gpuTime:b}})},50)}if(this.listens("gpu-timing-layer")){const y=this.painter.collectGpuTimers();setTimeout(()=>{const b=this.painter.queryGpuTimers(y);this.fire(new de("gpu-timing-layer",{layerTimes:b}))},50)}if(this.listens("gpu-timing-deferred-render")){const y=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const b=this.painter.queryGpuTimeDeferredRender(y);this.fire(new de("gpu-timing-deferred-render",{gpuTime:b}))},50)}const g=this._sourcesDirty||this._styleDirty||this._placementDirty||f;if(g||this._repaint)this.triggerRepaint();else{const y=!this.isMoving()&&this.loaded();if(y&&(f=this._updateAverageElevation(s,!0)),f)this.triggerRepaint();else if(this._triggerFrame(!1),y&&(this.fire(new de("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const b=this._calculateSpeedIndex();this.fire(new de("speedindexcompleted",{speedIndex:b})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,mh.mark(ml.fullLoad),this._performanceMetricsCollection&&ao(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(e){for(const t of this._markers)e&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!e||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(e,t=!1){const r=c=>(this.transform.averageElevation=c,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&r(0);const s=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(s||(t||e-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(e)){const c=this.transform.averageElevation;let d=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(d)?d=0:this._averageElevationLastSampledAt=e;const f=Math.abs(c-d);if(f>1){if(this._isInitialLoad||s)return this._averageElevation.jumpTo(d),r(d);this._averageElevation.easeTo(d,e,300)}else if(f>1e-4)return this._averageElevation.jumpTo(d),r(d)}return!!this._averageElevation.isEasing(e)&&r(this._averageElevation.getValue(e))}_authenticate(){Io(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,e=>{if(e&&(e.message===kt||401===e.status)){const t=this.painter.context.gl;gl(t,!1),this._logoControl instanceof rS&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new Cn(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),vr(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const e=this._isDragging();this.painter.updateTerrain(this.style,e)}_calculateSpeedIndex(){const e=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const r=this.painter.context.gl,s=r.createFramebuffer();function c(d){r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,d,0);const f=new Uint8Array(r.drawingBufferWidth*r.drawingBufferHeight*4);return r.readPixels(0,0,r.drawingBufferWidth,r.drawingBufferHeight,r.RGBA,r.UNSIGNED_BYTE,f),f}return r.bindFramebuffer(r.FRAMEBUFFER,s),this._canvasPixelComparison(c(e),t.canvasCopies.map(c),t.timeStamps)}_canvasPixelComparison(e,t,r){let s=r[1]-r[0];const c=e.length/4;for(let d=0;d<t.length;d++){const f=t[d];let g=0;for(let y=0;y<f.length;y+=4)f[y]===e[y]&&f[y+1]===e[y+1]&&f[y+2]===e[y+2]&&f[y+3]===e[y+3]&&(g+=1);s+=(r[d+2]-r[d+1])*(1-g/c)}return s}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==lt&&(lt.removeEventListener("resize",this._onWindowResize,!1),lt.removeEventListener("orientationchange",this._onWindowResize,!1),lt.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),lt.removeEventListener("online",this._onWindowOnline,!1),lt.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e&&e.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),zr.delete(this.painter.context.gl),this._removed=!0,this.fire(new de("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(e){this._renderNextFrame=this._renderNextFrame||e,this.style&&!this._frame&&(this._frame=Mn.frame(t=>{const r=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,r&&this._render(t)}))}_preloadTiles(e){return Kt(this.style?Object.values(this.style._sourceCaches):[],(t,r)=>t._preloadTiles(e,r),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(e){this._trackResize&&this.resize({originalEvent:e})._update()}_onVisibilityChange(){"hidden"===lt.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(e){this._showTerrainWireframe!==e&&(this._showTerrainWireframe=e,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(e){this._showLayers2DWireframe!==e&&(this._showLayers2DWireframe=e,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(e){this._showLayers3DWireframe!==e&&(this._showLayers3DWireframe=e,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(e){this._speedIndexTiming!==e&&(this._speedIndexTiming=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(e){this._showTileAABBs!==e&&(this._showTileAABBs=e,e&&this._update())}_setCacheLimits(e,t){jo=e,Ur=t}get version(){return ye}},NavigationControl:class{constructor(e){this.options=_t({},yA,e),this._container=eo("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(Tn(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),eo("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),eo("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(Tn(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const r=this._map;r&&(this.options.visualizePitch?r.resetNorthPitch({},{originalEvent:t}):r.resetNorth({},{originalEvent:t}))}),this._compassIcon=eo("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const e=this._map;if(!e)return;const t=e.getZoom(),r=t===e.getMaxZoom(),s=t===e.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=s,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",s.toString())}_rotateCompassArrow(){const e=this._map;if(!e)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(e.transform.pitch*(Math.PI/180)),.5)}) rotateX(${e.transform.pitch}deg) rotateZ(${e.transform.angle*(180/Math.PI)}deg)`:`rotate(${e.transform.angle*(180/Math.PI)}deg)`;e._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),e.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&e.on("pitch",this._rotateCompassArrow),e.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new sS(e,this._compass,this.options.visualizePitch)),this._container}onRemove(){const e=this._map;e&&(this._container.remove(),this.options.showZoom&&e.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&e.off("pitch",this._rotateCompassArrow),e.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(e,t){const r=eo("button",e,this._container);return r.type="button",r.addEventListener("click",t),r}_setButtonTitle(e,t){if(!this._map)return;const r=this._map._getUIString(`NavigationControl.${t}`);e.setAttribute("aria-label",r),e.firstElementChild&&e.firstElementChild.setAttribute("title",r)}},GeolocateControl:class extends Ro{constructor(e){super(),this.options=_t({geolocation:lt.navigator.geolocation},D2,e),Tn(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=WI(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(e){return this._map=e,this._container=eo("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(e){const t=(r=!!this.options.geolocation)=>{this._supportsGeolocation=r,e(r)};void 0!==this._supportsGeolocation?e(this._supportsGeolocation):void 0!==lt.navigator.permissions?lt.navigator.permissions.query({name:"geolocation"}).then(r=>t("denied"!==r.state)).catch(()=>t()):t()}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),r=e.coords;return!!t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(e){if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new de("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new de("geolocate",e)),this._finish()}}_updateCamera(e){const t=new kn(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,s=_t({bearing:this._map.getBearing()},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(r),s,{geolocateSource:!0})}_updateMarker(e){if(e){const t=new kn(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const e=this._map.transform,t=oo(1,e._center.lat)*e.worldSize,r=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(e){if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new de("error",e)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(e){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=eo("button","mapboxgl-ctrl-geolocate",this._container),eo("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===e){gt("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=eo("div","mapboxgl-user-location"),this._dotElement.appendChild(eo("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(eo("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new NM({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=eo("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new NM({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new de("trackuserlocationend")))})}}_onDeviceOrientation(e){this._userLocationDotMarker&&(e.webkitCompassHeading?this._heading=e.webkitCompassHeading:!0===e.absolute&&(this._heading=-1*e.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return gt("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new de("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new de("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new de("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(e={maximumAge:6e5,timeout:0},this._noTimeout=!0):(e=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,e),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const e=()=>{lt.addEventListener("ondeviceorientationabsolute"in lt?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==lt.DeviceMotionEvent&&"function"==typeof lt.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(t=>{"granted"===t&&e()}).catch(console.error):e()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),lt.removeEventListener("deviceorientation",this._onDeviceOrientation),lt.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:kM,ScaleControl:class{constructor(e){this.options=_t({},aS,e),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),Tn(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const e=this.options.maxWidth||100,t=this._map,r=t._containerHeight/2,s=t._containerWidth/2-e/2,c=t.unproject([s,r]),d=t.unproject([s+e,r]),f=c.distanceTo(d);if("imperial"===this.options.unit){const g=3.2808*f;g>5280?this._setScale(e,g/5280,"mile"):this._setScale(e,g,"foot")}else"nautical"===this.options.unit?this._setScale(e,f/1852,"nautical-mile"):f>=1e3?this._setScale(e,f/1e3,"kilometer"):this._setScale(e,f,"meter")}_setScale(e,t,r){this._map._requestDomTask(()=>{const s=function(d){const f=Math.pow(10,`${Math.floor(d)}`.length-1);let g=d/f;return g=g>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:function(y){const b=Math.pow(10,Math.ceil(-Math.log(y)/Math.LN10));return Math.round(y*b)/b}(g),f*g}(t),c=s/t;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==r?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:r}).format(s):`${s}&nbsp;${vA[r]}`,this._container.style.width=e*c+"px"})}onAdd(e){return this._map=e,this._language=e.getLanguage(),this._container=eo("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(e){this._language=e,this._update()}setUnit(e){this.options.unit=e,this._update()}},FullscreenControl:class{constructor(e){this._fullscreen=!1,e&&e.container&&(e.container instanceof lt.HTMLElement?this._container=e.container:gt("Full screen control 'container' must be a DOM element.")),Tn(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in lt.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in lt.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=eo("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",gt("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,lt.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!lt.document.fullscreenEnabled&&!lt.document.webkitFullscreenEnabled)}_setupUI(){const e=this._fullscreenButton=eo("button","mapboxgl-ctrl-fullscreen",this._controlContainer);eo("span","mapboxgl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),lt.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",e)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(lt.document.fullscreenElement||lt.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?lt.document.exitFullscreen?lt.document.exitFullscreen():lt.document.webkitCancelFullScreen&&lt.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends Ro{constructor(e){super(),this.options=_t(Object.create(oS),e),Tn(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(e&&e.className?e.className.trim().split(/\s+/):[])}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&e.on("preclick",this._onClose),this.options.closeOnMove&&e.on("move",this._onClose),e.on("remove",this.remove),this._update(),e._addPopup(this),this._focusFirstElement(),this._trackPointer?(e.on("mousemove",this._onMouseEvent),e.on("mouseup",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")):e.on("move",this._update),this.fire(new de("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const e=this._map;return e&&(e.off("move",this._update),e.off("move",this._onClose),e.off("preclick",this._onClose),e.off("click",this._onClose),e.off("remove",this.remove),e.off("mousemove",this._onMouseEvent),e.off("mouseup",this._onMouseEvent),e.off("drag",this._onMouseEvent),e._canvasContainer&&e._canvasContainer.classList.remove("mapboxgl-track-pointer"),e._removePopup(this),this._map=void 0),this.fire(new de("close")),this}getLngLat(){return this._lngLat}setLngLat(e){this._lngLat=kn.convert(e),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const e=this._map;return e&&(e.off("move",this._update),e.on("mousemove",this._onMouseEvent),e.on("drag",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(lt.document.createTextNode(e))}setHTML(e){const t=lt.document.createDocumentFragment(),r=lt.document.createElement("body");let s;for(r.innerHTML=e;s=r.firstChild,s;)t.appendChild(s);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=eo("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(e),this.options.closeButton){const r=this._closeButton=eo("button","mapboxgl-popup-close-button",t);r.type="button",r.setAttribute("aria-label","Close popup"),r.setAttribute("aria-hidden","true"),r.innerHTML="&#215;",r.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(e){return this._classList.add(e),this._updateClassList(),this}removeClassName(e){return this._classList.delete(e),this._updateClassList(),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){let t;return this._classList.delete(e)?t=!1:(this._classList.add(e),t=!0),this._updateClassList(),t}_onMouseEvent(e){this._update(e.point)}_getAnchor(e){if(this.options.anchor)return this.options.anchor;const t=this._map,r=this._container,s=this._pos;if(!t||!r||!s)return"bottom";const c=r.offsetWidth,d=r.offsetHeight,f=s.x<c/2,g=s.x>t.transform.width-c/2;if(s.y+e<d)return f?"top-left":g?"top-right":"top";if(s.y>t.transform.height-d){if(f)return"bottom-left";if(g)return"bottom-right"}return f?"left":g?"right":"bottom"}_updateClassList(){const e=this._container;if(!e)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),e.className=t.join(" ")}_update(e){const t=this._map,r=this._content;if(!t||!this._lngLat&&!this._trackPointer||!r)return;let s=this._container;if(s||(s=this._container=eo("div","mapboxgl-popup",t.getContainer()),this._tip=eo("div","mapboxgl-popup-tip",s),s.appendChild(r)),this.options.maxWidth&&s.style.maxWidth!==this.options.maxWidth&&(s.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=RM(this._lngLat,this._pos,t.transform)),!this._trackPointer||e){const c=this._pos=this._trackPointer&&e?e:t.project(this._lngLat),d=S2(this.options.offset),f=this._anchor=this._getAnchor(d.y),g=S2(this.options.offset,f),y=c.add(g).round();t._requestDomTask(()=>{this._container&&f&&(this._container.style.transform=`${LM[f]} translate(${y.x}px,${y.y}px)`)})}if(!this._marker&&t._showingGlobe()){const c=y0(t.transform,this._lngLat)?0:1;this._setOpacity(c)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(FM);e&&e.focus()}_onClose(){this.remove()}_setOpacity(e){this._container&&(this._container.style.opacity=`${e}`),this._content&&(this._content.style.pointerEvents=e?"auto":"none")}},Marker:NM,Style:ph,LngLat:kn,LngLatBounds:Qo,Point:tt,MercatorCoordinate:Xn,FreeCameraOptions:K1,Evented:Ro,config:ue,prewarm:function(){dh().acquire(Xp)},clearPrewarmedResources:function(){const e=Qp;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(Xp),Qp=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return ue.ACCESS_TOKEN},set accessToken(e){ue.ACCESS_TOKEN=e},get baseApiUrl(){return ue.API_URL},set baseApiUrl(e){ue.API_URL=e},get workerCount(){return yc.workerCount},set workerCount(e){yc.workerCount=e},get maxParallelImageRequests(){return ue.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(e){ue.MAX_PARALLEL_IMAGE_REQUESTS=e},clearStorage(e){!function(t){if(!zl())return;const r=lt.caches.delete(Sn);t&&r.catch(t).then(()=>t())}(e)},workerUrl:"",workerClass:null,get dracoUrl(){return $O()},set dracoUrl(e){Ox=Mn.resolveURL(e),UC||(UC=new _m(dh(),new Ro)),UC.broadcast("setDracoUrl",Ox)},setNow:Mn.setNow,restoreNow:Mn.restoreNow};vt.A=Iv,vt.D=uc,vt.E=Dt,vt.F=z0,vt.K=Pm,vt.O=Ir,vt.P=tt,vt.T=ss,vt.V=S0,vt.a=y1,vt.b=Ww,vt.c=Kp,vt.d=class extends Ro{constructor(e,t,r,s,c,d){super(),this.actor=e,this.layerIndex=t,this.availableImages=r,this.loadVectorData=c||zC,this.loading={},this.loaded={},this.deduped=new Av(e.scheduler),this.isSpriteLoaded=s,this.scheduler=e.scheduler,this.brightness=d}loadTile(e,t){const r=e.uid,s=e&&e.request,c=s&&s.collectResourceTiming,d=this.loading[r]=new Cx(e);d.abort=this.loadVectorData(e,(f,g)=>{const y=!this.loading[r];if(delete this.loading[r],y||f||!g)return d.status="done",y||(this.loaded[r]=d),t(f);const b=g.rawData,C={};g.expires&&(C.expires=g.expires),g.cacheControl&&(C.cacheControl=g.cacheControl),d.vectorTile=g.vectorTile||new w1(new k0(b));const P=()=>{d.parse(d.vectorTile,this.layerIndex,this.availableImages,this.actor,(E,I)=>{if(E||!I)return t(E);const A={};if(c){const l=Ua(s);l.length>0&&(A.resourceTiming=JSON.parse(JSON.stringify(l)))}t(null,_t({rawTileData:b.slice(0)},I,C,A))})};this.isSpriteLoaded?P():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(P,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom}):P()}),this.loaded=this.loaded||{},this.loaded[r]=d})}reloadTile(e,t){const r=this.loaded,s=e.uid,c=this;if(r&&r[s]){const d=r[s];d.showCollisionBoxes=e.showCollisionBoxes,d.projection=e.projection,d.brightness=e.brightness,d.tileTransform=Yu(e.tileID.canonical,e.projection),d.extraShadowCaster=e.extraShadowCaster;const f=(g,y)=>{const b=d.reloadCallback;b&&(delete d.reloadCallback,d.parse(d.vectorTile,c.layerIndex,this.availableImages,c.actor,b)),t(g,y)};"parsing"===d.status?d.reloadCallback=f:"done"===d.status&&(d.vectorTile?d.parse(d.vectorTile,this.layerIndex,this.availableImages,this.actor,f):f())}else t(null,void 0)}abortTile(e,t){const r=e.uid,s=this.loading[r];s&&(s.abort&&s.abort(),delete this.loading[r]),t()}removeTile(e,t){const r=this.loaded,s=e.uid;r&&r[s]&&delete r[s],t()}},vt.e=Wl,vt.f=Ua,vt.g=We,vt.h=_e,vt.i=ve,vt.j=function(e,t){const r=bm(e);for(const s of r){for(const c of s.meshes)HC(c);s.lights&&(s.lightMeshIndex=s.meshes.length,s.meshes.push(YO(s.lights,t)))}return r},vt.k=Lo,vt.l=function(e){let t=0;if(new Uint32Array(e,0,1)[0]!==GO){const r=new Uint32Array(e,0,7),[,,s,c,d,f]=r;t=r.byteLength+c+d+f+d,(s!==e.byteLength||t>=e.byteLength)&&gt("Invalid b3dm header information.")}return GC(e,t)},vt.m=kl,vt.n=el,vt.o=de,vt.p=Ce,vt.q=function(e){er(),Ar&&Ar.then(t=>{t.keys().then(r=>{for(let s=0;s<r.length-e;s++)t.delete(r[s])})})},vt.r=Ax,vt.s=zM,vt.t=Tp,vt.v=pe,vt.w=lt}),mt(0,function(vt){function lt(ce){if("number"==typeof ce||"boolean"==typeof ce||"string"==typeof ce||null==ce)return JSON.stringify(ce);if(Array.isArray(ce)){let nt="[";for(const gt of ce)nt+=`${lt(gt)},`;return`${nt}]`}let et="{";for(const nt of Object.keys(ce).sort())et+=`${nt}:${lt(ce[nt])},`;return`${et}}`}function ye(ce){let et="";for(const nt of vt.r)et+=`/${lt(ce[nt])}`;return et}class ke{constructor(et){this.keyCache={},this._layers={},this._layerConfigs={},et&&this.replace(et)}replace(et,nt){this._layerConfigs={},this._layers={},this.update(et,[],nt)}update(et,nt,gt){this._options=gt;for(const ie of et){this._layerConfigs[ie.id]=ie;const Pe=this._layers[ie.id]=vt.c(ie,this._options);Pe.setScope(this.scope),Pe.compileFilter(),this.keyCache[ie.id]&&delete this.keyCache[ie.id]}for(const ie of nt)delete this.keyCache[ie],delete this._layerConfigs[ie],delete this._layers[ie];this.familiesBySource={};const Qt=function(ie,Pe){const Ge={};for(let Xe=0;Xe<ie.length;Xe++){const Ze=Pe&&Pe[ie[Xe].id]||ye(ie[Xe]);Pe&&(Pe[ie[Xe].id]=Ze);let Ie=Ge[Ze];Ie||(Ie=Ge[Ze]=[]),Ie.push(ie[Xe])}const ae=[];for(const Xe in Ge)ae.push(Ge[Xe]);return ae}(vt.v(this._layerConfigs),this.keyCache);for(const ie of Qt){const Pe=ie.map(gn=>this._layers[gn.id]),Ge=Pe[0];if("none"===Ge.visibility)continue;const ae=Ge.source||"";let Xe=this.familiesBySource[ae];Xe||(Xe=this.familiesBySource[ae]={});const Ze=Ge.sourceLayer||"_geojsonTileLayer";let Ie=Xe[Ze];Ie||(Ie=Xe[Ze]=[]),Ie.push(Pe)}}}class ue{loadTile(et,nt){const{uid:gt,encoding:Qt,rawImageData:ie,padding:Pe}=et,Ge=vt.w.ImageBitmap&&ie instanceof vt.w.ImageBitmap?this.getImageData(ie,Pe):ie;nt(null,new vt.D(gt,Ge,Qt,Pe<1))}getImageData(et,nt){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(et.width,et.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=et.width,this.offscreenCanvas.height=et.height,this.offscreenCanvasContext.drawImage(et,0,0,et.width,et.height);const gt=this.offscreenCanvasContext.getImageData(-nt,-nt,et.width+2*nt,et.height+2*nt);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),gt}}function be(ce,et){if(0!==ce.length){Pt(ce[0],et);for(var nt=1;nt<ce.length;nt++)Pt(ce[nt],!et)}}function Pt(ce,et){for(var nt=0,gt=0,Qt=0,ie=ce.length,Pe=ie-1;Qt<ie;Pe=Qt++){var Ge=(ce[Qt][0]-ce[Pe][0])*(ce[Pe][1]+ce[Qt][1]),ae=nt+Ge;gt+=Math.abs(nt)>=Math.abs(Ge)?nt-ae+Ge:Ge-ae+nt,nt=ae}nt+gt>=0!=!!et&&ce.reverse()}var Ot=vt.g(function ce(et,nt){var gt,Qt=et&&et.type;if("FeatureCollection"===Qt)for(gt=0;gt<et.features.length;gt++)ce(et.features[gt],nt);else if("GeometryCollection"===Qt)for(gt=0;gt<et.geometries.length;gt++)ce(et.geometries[gt],nt);else if("Feature"===Qt)ce(et.geometry,nt);else if("Polygon"===Qt)be(et.coordinates,nt);else if("MultiPolygon"===Qt)for(gt=0;gt<et.coordinates.length;gt++)be(et.coordinates[gt],nt);return et});const Yt=vt.V.prototype.toGeoJSON;var Le={exports:{}},re=vt.p,tn=vt.a.VectorTileFeature,We=rn;function rn(ce,et){this.options=et||{},this.features=ce,this.length=ce.length}function Te(ce,et){this.id="number"==typeof ce.id?ce.id:void 0,this.type=ce.type,this.rawGeometry=1===ce.type?[ce.geometry]:ce.geometry,this.properties=ce.tags,this.extent=et||4096}rn.prototype.feature=function(ce){return new Te(this.features[ce],this.options.extent)},Te.prototype.loadGeometry=function(){var ce=this.rawGeometry;this.geometry=[];for(var et=0;et<ce.length;et++){for(var nt=ce[et],gt=[],Qt=0;Qt<nt.length;Qt++)gt.push(new re(nt[Qt][0],nt[Qt][1]));this.geometry.push(gt)}return this.geometry},Te.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ce=this.geometry,et=1/0,nt=-1/0,gt=1/0,Qt=-1/0,ie=0;ie<ce.length;ie++)for(var Pe=ce[ie],Ge=0;Ge<Pe.length;Ge++){var ae=Pe[Ge];et=Math.min(et,ae.x),nt=Math.max(nt,ae.x),gt=Math.min(gt,ae.y),Qt=Math.max(Qt,ae.y)}return[et,gt,nt,Qt]},Te.prototype.toGeoJSON=tn.prototype.toGeoJSON;var Fn=vt.b,Ce=We;function me(ce){var et=new Fn;return function(nt,gt){for(var Qt in nt.layers)gt.writeMessage(3,tt,nt.layers[Qt])}(ce,et),et.finish()}function tt(ce,et){var nt;et.writeVarintField(15,ce.version||1),et.writeStringField(1,ce.name||""),et.writeVarintField(5,ce.extent||4096);var gt={keys:[],values:[],keycache:{},valuecache:{}};for(nt=0;nt<ce.length;nt++)gt.feature=ce.feature(nt),et.writeMessage(2,Xt,gt);var Qt=gt.keys;for(nt=0;nt<Qt.length;nt++)et.writeStringField(3,Qt[nt]);var ie=gt.values;for(nt=0;nt<ie.length;nt++)et.writeMessage(4,en,ie[nt])}function Xt(ce,et){var nt=ce.feature;void 0!==nt.id&&et.writeVarintField(1,nt.id),et.writeMessage(2,Ve,ce),et.writeVarintField(3,nt.type),et.writeMessage(4,ge,nt)}function Ve(ce,et){var nt=ce.feature,gt=ce.keys,Qt=ce.values,ie=ce.keycache,Pe=ce.valuecache;for(var Ge in nt.properties){var ae=nt.properties[Ge],Xe=ie[Ge];if(null!==ae){void 0===Xe&&(gt.push(Ge),ie[Ge]=Xe=gt.length-1),et.writeVarint(Xe);var Ze=typeof ae;"string"!==Ze&&"boolean"!==Ze&&"number"!==Ze&&(ae=JSON.stringify(ae));var Ie=Ze+":"+ae,gn=Pe[Ie];void 0===gn&&(Qt.push(ae),Pe[Ie]=gn=Qt.length-1),et.writeVarint(gn)}}}function Gt(ce,et){return(et<<3)+(7&ce)}function Ct(ce){return ce<<1^ce>>31}function ge(ce,et){for(var nt=ce.loadGeometry(),gt=ce.type,Qt=0,ie=0,Pe=nt.length,Ge=0;Ge<Pe;Ge++){var ae=nt[Ge],Xe=1;1===gt&&(Xe=ae.length),et.writeVarint(Gt(1,Xe));for(var Ze=3===gt?ae.length-1:ae.length,Ie=0;Ie<Ze;Ie++){1===Ie&&1!==gt&&et.writeVarint(Gt(2,Ze-1));var gn=ae[Ie].x-Qt,ur=ae[Ie].y-ie;et.writeVarint(Ct(gn)),et.writeVarint(Ct(ur)),Qt+=gn,ie+=ur}3===gt&&et.writeVarint(Gt(7,1))}}function en(ce,et){var nt=typeof ce;"string"===nt?et.writeStringField(1,ce):"boolean"===nt?et.writeBooleanField(7,ce):"number"===nt&&(ce%1!=0?et.writeDoubleField(3,ce):ce<0?et.writeSVarintField(6,ce):et.writeVarintField(5,ce))}Le.exports=me,Le.exports.fromVectorTileJs=me,Le.exports.fromGeojsonVt=function(ce,et){et=et||{};var nt={};for(var gt in ce)nt[gt]=new Ce(ce[gt].features,et),nt[gt].name=gt,nt[gt].version=et.version,nt[gt].extent=et.extent;return me({layers:nt})},Le.exports.GeoJSONWrapper=Ce;var Vo=vt.g(Le.exports);const cs={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ce=>ce},Gi=Math.fround||(us=new Float32Array(1),ce=>(us[0]=+ce,us[0]));var us;const Yr=3,Ne=5,vs=6;class Wt{constructor(et){this.options=Object.assign(Object.create(cs),et),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(et){const{log:nt,minZoom:gt,maxZoom:Qt}=this.options;nt&&console.time("total time");const ie=`prepare ${et.length} points`;nt&&console.time(ie),this.points=et;const Pe=[];for(let ae=0;ae<et.length;ae++){const Xe=et[ae];if(!Xe.geometry)continue;const[Ze,Ie]=Xe.geometry.coordinates,gn=Gi(_t(Ze)),ur=Gi(he(Ie));Pe.push(gn,ur,1/0,ae,-1,1),this.options.reduce&&Pe.push(0)}let Ge=this.trees[Qt+1]=this._createTree(Pe);nt&&console.timeEnd(ie);for(let ae=Qt;ae>=gt;ae--){const Xe=+Date.now();Ge=this.trees[ae]=this._createTree(this._cluster(Ge,ae)),nt&&console.log("z%d: %d clusters in %dms",ae,Ge.numItems,+Date.now()-Xe)}return nt&&console.timeEnd("total time"),this}getClusters(et,nt){let gt=((et[0]+180)%360+360)%360-180;const Qt=Math.max(-90,Math.min(90,et[1]));let ie=180===et[2]?180:((et[2]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,et[3]));if(et[2]-et[0]>=360)gt=-180,ie=180;else if(gt>ie){const Ie=this.getClusters([gt,Qt,180,Pe],nt),gn=this.getClusters([-180,Qt,ie,Pe],nt);return Ie.concat(gn)}const Ge=this.trees[this._limitZoom(nt)],ae=Ge.range(_t(gt),he(Pe),_t(ie),he(Qt)),Xe=Ge.data,Ze=[];for(const Ie of ae){const gn=this.stride*Ie;Ze.push(Xe[gn+Ne]>1?Kt(Xe,gn,this.clusterProps):this.points[Xe[gn+Yr]])}return Ze}getChildren(et){const nt=this._getOriginId(et),gt=this._getOriginZoom(et),Qt="No cluster with the specified id.",ie=this.trees[gt];if(!ie)throw new Error(Qt);const Pe=ie.data;if(nt*this.stride>=Pe.length)throw new Error(Qt);const Ge=this.options.radius/(this.options.extent*Math.pow(2,gt-1)),ae=ie.within(Pe[nt*this.stride],Pe[nt*this.stride+1],Ge),Xe=[];for(const Ze of ae){const Ie=Ze*this.stride;Pe[Ie+4]===et&&Xe.push(Pe[Ie+Ne]>1?Kt(Pe,Ie,this.clusterProps):this.points[Pe[Ie+Yr]])}if(0===Xe.length)throw new Error(Qt);return Xe}getLeaves(et,nt,gt){const Qt=[];return this._appendLeaves(Qt,et,nt=nt||10,gt=gt||0,0),Qt}getTile(et,nt,gt){const Qt=this.trees[this._limitZoom(et)],ie=Math.pow(2,et),{extent:Pe,radius:Ge}=this.options,ae=Ge/Pe,Xe=(gt-ae)/ie,Ze=(gt+1+ae)/ie,Ie={features:[]};return this._addTileFeatures(Qt.range((nt-ae)/ie,Xe,(nt+1+ae)/ie,Ze),Qt.data,nt,gt,ie,Ie),0===nt&&this._addTileFeatures(Qt.range(1-ae/ie,Xe,1,Ze),Qt.data,ie,gt,ie,Ie),nt===ie-1&&this._addTileFeatures(Qt.range(0,Xe,ae/ie,Ze),Qt.data,-1,gt,ie,Ie),Ie.features.length?Ie:null}getClusterExpansionZoom(et){let nt=this._getOriginZoom(et)-1;for(;nt<=this.options.maxZoom;){const gt=this.getChildren(et);if(nt++,1!==gt.length)break;et=gt[0].properties.cluster_id}return nt}_appendLeaves(et,nt,gt,Qt,ie){const Pe=this.getChildren(nt);for(const Ge of Pe){const ae=Ge.properties;if(ae&&ae.cluster?ie+ae.point_count<=Qt?ie+=ae.point_count:ie=this._appendLeaves(et,ae.cluster_id,gt,Qt,ie):ie<Qt?ie++:et.push(Ge),et.length===gt)break}return ie}_createTree(et){const nt=new vt.K(et.length/this.stride|0,this.options.nodeSize,Float32Array);for(let gt=0;gt<et.length;gt+=this.stride)nt.add(et[gt],et[gt+1]);return nt.finish(),nt.data=et,nt}_addTileFeatures(et,nt,gt,Qt,ie,Pe){for(const Ge of et){const ae=Ge*this.stride,Xe=nt[ae+Ne]>1;let Ze,Ie,gn;if(Xe)Ze=pe(nt,ae,this.clusterProps),Ie=nt[ae],gn=nt[ae+1];else{const Fr=this.points[nt[ae+Yr]];Ze=Fr.properties;const[Xr,Sn]=Fr.geometry.coordinates;Ie=_t(Xr),gn=he(Sn)}const ur={type:1,geometry:[[Math.round(this.options.extent*(Ie*ie-gt)),Math.round(this.options.extent*(gn*ie-Qt))]],tags:Ze};let yn;yn=Xe||this.options.generateId?nt[ae+Yr]:this.points[nt[ae+Yr]].id,void 0!==yn&&(ur.id=yn),Pe.features.push(ur)}}_limitZoom(et){return Math.max(this.options.minZoom,Math.min(Math.floor(+et),this.options.maxZoom+1))}_cluster(et,nt){const{radius:gt,extent:Qt,reduce:ie,minPoints:Pe}=this.options,Ge=gt/(Qt*Math.pow(2,nt)),ae=et.data,Xe=[],Ze=this.stride;for(let Ie=0;Ie<ae.length;Ie+=Ze){if(ae[Ie+2]<=nt)continue;ae[Ie+2]=nt;const gn=ae[Ie],ur=ae[Ie+1],yn=et.within(ae[Ie],ae[Ie+1],Ge),Fr=ae[Ie+Ne];let Xr=Fr;for(const Sn of yn){const jo=Sn*Ze;ae[jo+2]>nt&&(Xr+=ae[jo+Ne])}if(Xr>Fr&&Xr>=Pe){let Sn,jo=gn*Fr,Ur=ur*Fr,Ar=-1;const dr=((Ie/Ze|0)<<5)+(nt+1)+this.points.length;for(const zl of yn){const er=zl*Ze;if(ae[er+2]<=nt)continue;ae[er+2]=nt;const Rs=ae[er+Ne];jo+=ae[er]*Rs,Ur+=ae[er+1]*Rs,ae[er+4]=dr,ie&&(Sn||(Sn=this._map(ae,Ie,!0),Ar=this.clusterProps.length,this.clusterProps.push(Sn)),ie(Sn,this._map(ae,er)))}ae[Ie+4]=dr,Xe.push(jo/Xr,Ur/Xr,1/0,dr,-1,Xr),ie&&Xe.push(Ar)}else{for(let Sn=0;Sn<Ze;Sn++)Xe.push(ae[Ie+Sn]);if(Xr>1)for(const Sn of yn){const jo=Sn*Ze;if(!(ae[jo+2]<=nt)){ae[jo+2]=nt;for(let Ur=0;Ur<Ze;Ur++)Xe.push(ae[jo+Ur])}}}}return Xe}_getOriginId(et){return et-this.points.length>>5}_getOriginZoom(et){return(et-this.points.length)%32}_map(et,nt,gt){if(et[nt+Ne]>1){const Pe=this.clusterProps[et[nt+vs]];return gt?Object.assign({},Pe):Pe}const Qt=this.points[et[nt+Yr]].properties,ie=this.options.map(Qt);return gt&&ie===Qt?Object.assign({},ie):ie}}function Kt(ce,et,nt){return{type:"Feature",id:ce[et+Yr],properties:pe(ce,et,nt),geometry:{type:"Point",coordinates:[(gt=ce[et],360*(gt-.5)),Ue(ce[et+1])]}};var gt}function pe(ce,et,nt){const gt=ce[et+Ne],Qt=gt>=1e4?`${Math.round(gt/1e3)}k`:gt>=1e3?Math.round(gt/100)/10+"k":gt,ie=ce[et+vs],Pe=-1===ie?{}:Object.assign({},nt[ie]);return Object.assign(Pe,{cluster:!0,cluster_id:ce[et+Yr],point_count:gt,point_count_abbreviated:Qt})}function _t(ce){return ce/360+.5}function he(ce){const et=Math.sin(ce*Math.PI/180),nt=.5-.25*Math.log((1+et)/(1-et))/Math.PI;return nt<0?0:nt>1?1:nt}function Ue(ce){const et=(180-360*ce)*Math.PI/180;return 360*Math.atan(Math.exp(et))/Math.PI-90}var In={exports:{}};In.exports=function(){function ce(Ft,Ht,te,le){for(var _e,ve=le,xe=te-Ht>>1,ot=te-Ht,at=Ft[Ht],ht=Ft[Ht+1],Bt=Ft[te],kt=Ft[te+1],ee=Ht+3;ee<te;ee+=3){var Ke=et(Ft[ee],Ft[ee+1],at,ht,Bt,kt);if(Ke>ve)_e=ee,ve=Ke;else if(Ke===ve){var Nn=Math.abs(ee-xe);Nn<ot&&(_e=ee,ot=Nn)}}ve>le&&(_e-Ht>3&&ce(Ft,Ht,_e,le),Ft[_e+2]=ve,te-_e>3&&ce(Ft,_e,te,le))}function et(Ft,Ht,te,le,_e,ve){var xe=_e-te,ot=ve-le;if(0!==xe||0!==ot){var at=((Ft-te)*xe+(Ht-le)*ot)/(xe*xe+ot*ot);at>1?(te=_e,le=ve):at>0&&(te+=xe*at,le+=ot*at)}return(xe=Ft-te)*xe+(ot=Ht-le)*ot}function nt(Ft,Ht,te,le){var _e={id:void 0===Ft?null:Ft,type:Ht,geometry:te,tags:le,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ve){var xe=ve.geometry,ot=ve.type;if("Point"===ot||"MultiPoint"===ot||"LineString"===ot)gt(ve,xe);else if("Polygon"===ot||"MultiLineString"===ot)for(var at=0;at<xe.length;at++)gt(ve,xe[at]);else if("MultiPolygon"===ot)for(at=0;at<xe.length;at++)for(var ht=0;ht<xe[at].length;ht++)gt(ve,xe[at][ht])}(_e),_e}function gt(Ft,Ht){for(var te=0;te<Ht.length;te+=3)Ft.minX=Math.min(Ft.minX,Ht[te]),Ft.minY=Math.min(Ft.minY,Ht[te+1]),Ft.maxX=Math.max(Ft.maxX,Ht[te]),Ft.maxY=Math.max(Ft.maxY,Ht[te+1])}function Qt(Ft,Ht,te,le){if(Ht.geometry){var _e=Ht.geometry.coordinates,ve=Ht.geometry.type,xe=Math.pow(te.tolerance/((1<<te.maxZoom)*te.extent),2),ot=[],at=Ht.id;if(te.promoteId?at=Ht.properties[te.promoteId]:te.generateId&&(at=le||0),"Point"===ve)ie(_e,ot);else if("MultiPoint"===ve)for(var ht=0;ht<_e.length;ht++)ie(_e[ht],ot);else if("LineString"===ve)Pe(_e,ot,xe,!1);else if("MultiLineString"===ve){if(te.lineMetrics){for(ht=0;ht<_e.length;ht++)Pe(_e[ht],ot=[],xe,!1),Ft.push(nt(at,"LineString",ot,Ht.properties));return}Ge(_e,ot,xe,!1)}else if("Polygon"===ve)Ge(_e,ot,xe,!0);else{if("MultiPolygon"!==ve){if("GeometryCollection"===ve){for(ht=0;ht<Ht.geometry.geometries.length;ht++)Qt(Ft,{id:at,geometry:Ht.geometry.geometries[ht],properties:Ht.properties},te,le);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ht=0;ht<_e.length;ht++){var Bt=[];Ge(_e[ht],Bt,xe,!0),ot.push(Bt)}}Ft.push(nt(at,ve,ot,Ht.properties))}}function ie(Ft,Ht){Ht.push(ae(Ft[0])),Ht.push(Xe(Ft[1])),Ht.push(0)}function Pe(Ft,Ht,te,le){for(var _e,ve,xe=0,ot=0;ot<Ft.length;ot++){var at=ae(Ft[ot][0]),ht=Xe(Ft[ot][1]);Ht.push(at),Ht.push(ht),Ht.push(0),ot>0&&(xe+=le?(_e*ht-at*ve)/2:Math.sqrt(Math.pow(at-_e,2)+Math.pow(ht-ve,2))),_e=at,ve=ht}var Bt=Ht.length-3;Ht[2]=1,ce(Ht,0,Bt,te),Ht[Bt+2]=1,Ht.size=Math.abs(xe),Ht.start=0,Ht.end=Ht.size}function Ge(Ft,Ht,te,le){for(var _e=0;_e<Ft.length;_e++){var ve=[];Pe(Ft[_e],ve,te,le),Ht.push(ve)}}function ae(Ft){return Ft/360+.5}function Xe(Ft){var Ht=Math.sin(Ft*Math.PI/180),te=.5-.25*Math.log((1+Ht)/(1-Ht))/Math.PI;return te<0?0:te>1?1:te}function Ze(Ft,Ht,te,le,_e,ve,xe,ot){if(le/=Ht,ve>=(te/=Ht)&&xe<le)return Ft;if(xe<te||ve>=le)return null;for(var at=[],ht=0;ht<Ft.length;ht++){var Bt=Ft[ht],kt=Bt.geometry,ee=Bt.type,Ke=0===_e?Bt.minX:Bt.minY,Nn=0===_e?Bt.maxX:Bt.maxY;if(Ke>=te&&Nn<le)at.push(Bt);else if(!(Nn<te||Ke>=le)){var yr=[];if("Point"===ee||"MultiPoint"===ee)Ie(kt,yr,te,le,_e);else if("LineString"===ee)gn(kt,yr,te,le,_e,!1,ot.lineMetrics);else if("MultiLineString"===ee)yn(kt,yr,te,le,_e,!1);else if("Polygon"===ee)yn(kt,yr,te,le,_e,!0);else if("MultiPolygon"===ee)for(var Er=0;Er<kt.length;Er++){var Qr=[];yn(kt[Er],Qr,te,le,_e,!0),Qr.length&&yr.push(Qr)}if(yr.length){if(ot.lineMetrics&&"LineString"===ee){for(Er=0;Er<yr.length;Er++)at.push(nt(Bt.id,ee,yr[Er],Bt.tags));continue}"LineString"!==ee&&"MultiLineString"!==ee||(1===yr.length?(ee="LineString",yr=yr[0]):ee="MultiLineString"),"Point"!==ee&&"MultiPoint"!==ee||(ee=3===yr.length?"Point":"MultiPoint"),at.push(nt(Bt.id,ee,yr,Bt.tags))}}}return at.length?at:null}function Ie(Ft,Ht,te,le,_e){for(var ve=0;ve<Ft.length;ve+=3){var xe=Ft[ve+_e];xe>=te&&xe<=le&&(Ht.push(Ft[ve]),Ht.push(Ft[ve+1]),Ht.push(Ft[ve+2]))}}function gn(Ft,Ht,te,le,_e,ve,xe){for(var ot,at,ht=ur(Ft),Bt=0===_e?Xr:Sn,kt=Ft.start,ee=0;ee<Ft.length-3;ee+=3){var Ke=Ft[ee],Nn=Ft[ee+1],yr=Ft[ee+2],Er=Ft[ee+3],Qr=Ft[ee+4],Pr=0===_e?Ke:Nn,or=0===_e?Er:Qr,$o=!1;xe&&(ot=Math.sqrt(Math.pow(Ke-Er,2)+Math.pow(Nn-Qr,2))),Pr<te?or>te&&(at=Bt(ht,Ke,Nn,Er,Qr,te),xe&&(ht.start=kt+ot*at)):Pr>le?or<le&&(at=Bt(ht,Ke,Nn,Er,Qr,le),xe&&(ht.start=kt+ot*at)):Fr(ht,Ke,Nn,yr),or<te&&Pr>=te&&(at=Bt(ht,Ke,Nn,Er,Qr,te),$o=!0),or>le&&Pr<=le&&(at=Bt(ht,Ke,Nn,Er,Qr,le),$o=!0),!ve&&$o&&(xe&&(ht.end=kt+ot*at),Ht.push(ht),ht=ur(Ft)),xe&&(kt+=ot)}var ir=Ft.length-3;Ke=Ft[ir],Nn=Ft[ir+1],yr=Ft[ir+2],(Pr=0===_e?Ke:Nn)>=te&&Pr<=le&&Fr(ht,Ke,Nn,yr),ir=ht.length-3,ve&&ir>=3&&(ht[ir]!==ht[0]||ht[ir+1]!==ht[1])&&Fr(ht,ht[0],ht[1],ht[2]),ht.length&&Ht.push(ht)}function ur(Ft){var Ht=[];return Ht.size=Ft.size,Ht.start=Ft.start,Ht.end=Ft.end,Ht}function yn(Ft,Ht,te,le,_e,ve){for(var xe=0;xe<Ft.length;xe++)gn(Ft[xe],Ht,te,le,_e,ve,!1)}function Fr(Ft,Ht,te,le){Ft.push(Ht),Ft.push(te),Ft.push(le)}function Xr(Ft,Ht,te,le,_e,ve){var xe=(ve-Ht)/(le-Ht);return Ft.push(ve),Ft.push(te+(_e-te)*xe),Ft.push(1),xe}function Sn(Ft,Ht,te,le,_e,ve){var xe=(ve-te)/(_e-te);return Ft.push(Ht+(le-Ht)*xe),Ft.push(ve),Ft.push(1),xe}function jo(Ft,Ht){for(var te=[],le=0;le<Ft.length;le++){var _e,ve=Ft[le],xe=ve.type;if("Point"===xe||"MultiPoint"===xe||"LineString"===xe)_e=Ur(ve.geometry,Ht);else if("MultiLineString"===xe||"Polygon"===xe){_e=[];for(var ot=0;ot<ve.geometry.length;ot++)_e.push(Ur(ve.geometry[ot],Ht))}else if("MultiPolygon"===xe)for(_e=[],ot=0;ot<ve.geometry.length;ot++){for(var at=[],ht=0;ht<ve.geometry[ot].length;ht++)at.push(Ur(ve.geometry[ot][ht],Ht));_e.push(at)}te.push(nt(ve.id,xe,_e,ve.tags))}return te}function Ur(Ft,Ht){var te=[];te.size=Ft.size,void 0!==Ft.start&&(te.start=Ft.start,te.end=Ft.end);for(var le=0;le<Ft.length;le+=3)te.push(Ft[le]+Ht,Ft[le+1],Ft[le+2]);return te}function Ar(Ft,Ht){if(Ft.transformed)return Ft;var te,le,_e,ve=1<<Ft.z,xe=Ft.x,ot=Ft.y;for(te=0;te<Ft.features.length;te++){var at=Ft.features[te],ht=at.geometry,Bt=at.type;if(at.geometry=[],1===Bt)for(le=0;le<ht.length;le+=2)at.geometry.push(dr(ht[le],ht[le+1],Ht,ve,xe,ot));else for(le=0;le<ht.length;le++){var kt=[];for(_e=0;_e<ht[le].length;_e+=2)kt.push(dr(ht[le][_e],ht[le][_e+1],Ht,ve,xe,ot));at.geometry.push(kt)}}return Ft.transformed=!0,Ft}function dr(Ft,Ht,te,le,_e,ve){return[Math.round(te*(Ft*le-_e)),Math.round(te*(Ht*le-ve))]}function zl(Ft,Ht,te,le,_e){for(var ve=Ht===_e.maxZoom?0:_e.tolerance/((1<<Ht)*_e.extent),xe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:te,y:le,z:Ht,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ot=0;ot<Ft.length;ot++){xe.numFeatures++,er(xe,Ft[ot],ve,_e);var at=Ft[ot].minX,ht=Ft[ot].minY,Bt=Ft[ot].maxX,kt=Ft[ot].maxY;at<xe.minX&&(xe.minX=at),ht<xe.minY&&(xe.minY=ht),Bt>xe.maxX&&(xe.maxX=Bt),kt>xe.maxY&&(xe.maxY=kt)}return xe}function er(Ft,Ht,te,le){var _e=Ht.geometry,ve=Ht.type,xe=[];if("Point"===ve||"MultiPoint"===ve)for(var ot=0;ot<_e.length;ot+=3)xe.push(_e[ot]),xe.push(_e[ot+1]),Ft.numPoints++,Ft.numSimplified++;else if("LineString"===ve)Rs(xe,_e,Ft,te,!1,!1);else if("MultiLineString"===ve||"Polygon"===ve)for(ot=0;ot<_e.length;ot++)Rs(xe,_e[ot],Ft,te,"Polygon"===ve,0===ot);else if("MultiPolygon"===ve)for(var at=0;at<_e.length;at++){var ht=_e[at];for(ot=0;ot<ht.length;ot++)Rs(xe,ht[ot],Ft,te,!0,0===ot)}if(xe.length){var Bt=Ht.tags||null;if("LineString"===ve&&le.lineMetrics){for(var kt in Bt={},Ht.tags)Bt[kt]=Ht.tags[kt];Bt.mapbox_clip_start=_e.start/_e.size,Bt.mapbox_clip_end=_e.end/_e.size}var ee={geometry:xe,type:"Polygon"===ve||"MultiPolygon"===ve?3:"LineString"===ve||"MultiLineString"===ve?2:1,tags:Bt};null!==Ht.id&&(ee.id=Ht.id),Ft.features.push(ee)}}function Rs(Ft,Ht,te,le,_e,ve){var xe=le*le;if(le>0&&Ht.size<(_e?xe:le))te.numPoints+=Ht.length/3;else{for(var ot=[],at=0;at<Ht.length;at+=3)(0===le||Ht[at+2]>xe)&&(te.numSimplified++,ot.push(Ht[at]),ot.push(Ht[at+1])),te.numPoints++;_e&&function(ht,Bt){for(var kt=0,ee=0,Ke=ht.length,Nn=Ke-2;ee<Ke;Nn=ee,ee+=2)kt+=(ht[ee]-ht[Nn])*(ht[ee+1]+ht[Nn+1]);if(kt>0===Bt)for(ee=0,Ke=ht.length;ee<Ke/2;ee+=2){var yr=ht[ee],Er=ht[ee+1];ht[ee]=ht[Ke-2-ee],ht[ee+1]=ht[Ke-1-ee],ht[Ke-2-ee]=yr,ht[Ke-1-ee]=Er}}(ot,ve),Ft.push(ot)}}function ri(Ft,Ht){var te=(Ht=this.options=function(_e,ve){for(var xe in ve)_e[xe]=ve[xe];return _e}(Object.create(this.options),Ht)).debug;if(te&&console.time("preprocess data"),Ht.maxZoom<0||Ht.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ht.promoteId&&Ht.generateId)throw new Error("promoteId and generateId cannot be used together.");var _e,ve,xe,ot,at,ht,le=function(_e,ve){var xe=[];if("FeatureCollection"===_e.type)for(var ot=0;ot<_e.features.length;ot++)Qt(xe,_e.features[ot],ve,ot);else Qt(xe,"Feature"===_e.type?_e:{geometry:_e},ve);return xe}(Ft,Ht);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ht.indexMaxZoom,Ht.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(_e=le,ve=Ht,xe=ve.buffer/ve.extent,ot=_e,at=Ze(_e,1,-1-xe,xe,0,-1,2,ve),ht=Ze(_e,1,1-xe,2+xe,0,-1,2,ve),(at||ht)&&(ot=Ze(_e,1,-xe,1+xe,0,-1,2,ve)||[],at&&(ot=jo(at,1).concat(ot)),ht&&(ot=ot.concat(jo(ht,-1)))),le=ot).length&&this.splitTile(le,0,0,0),te&&(le.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ds(Ft,Ht,te){return 32*((1<<Ft)*te+Ht)+Ft}return ri.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ri.prototype.splitTile=function(Ft,Ht,te,le,_e,ve,xe){for(var ot=[Ft,Ht,te,le],at=this.options,ht=at.debug;ot.length;){le=ot.pop(),te=ot.pop(),Ht=ot.pop(),Ft=ot.pop();var Bt=1<<Ht,kt=ds(Ht,te,le),ee=this.tiles[kt];if(!ee&&(ht>1&&console.time("creation"),ee=this.tiles[kt]=zl(Ft,Ht,te,le,at),this.tileCoords.push({z:Ht,x:te,y:le}),ht)){ht>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ht,te,le,ee.numFeatures,ee.numPoints,ee.numSimplified),console.timeEnd("creation"));var Ke="z"+Ht;this.stats[Ke]=(this.stats[Ke]||0)+1,this.total++}if(ee.source=Ft,_e){if(Ht===at.maxZoom||Ht===_e)continue;var Nn=1<<_e-Ht;if(te!==Math.floor(ve/Nn)||le!==Math.floor(xe/Nn))continue}else if(Ht===at.indexMaxZoom||ee.numPoints<=at.indexMaxPoints)continue;if(ee.source=null,0!==Ft.length){ht>1&&console.time("clipping");var yr,Er,Qr,Pr,or,$o,ir=.5*at.buffer/at.extent,qs=.5-ir,ne=.5+ir,Vt=1+ir;yr=Er=Qr=Pr=null,or=Ze(Ft,Bt,te-ir,te+ne,0,ee.minX,ee.maxX,at),$o=Ze(Ft,Bt,te+qs,te+Vt,0,ee.minX,ee.maxX,at),Ft=null,or&&(yr=Ze(or,Bt,le-ir,le+ne,1,ee.minY,ee.maxY,at),Er=Ze(or,Bt,le+qs,le+Vt,1,ee.minY,ee.maxY,at),or=null),$o&&(Qr=Ze($o,Bt,le-ir,le+ne,1,ee.minY,ee.maxY,at),Pr=Ze($o,Bt,le+qs,le+Vt,1,ee.minY,ee.maxY,at),$o=null),ht>1&&console.timeEnd("clipping"),ot.push(yr||[],Ht+1,2*te,2*le),ot.push(Er||[],Ht+1,2*te,2*le+1),ot.push(Qr||[],Ht+1,2*te+1,2*le),ot.push(Pr||[],Ht+1,2*te+1,2*le+1)}}},ri.prototype.getTile=function(Ft,Ht,te){var le=this.options,_e=le.extent,ve=le.debug;if(Ft<0||Ft>24)return null;var xe=1<<Ft,ot=ds(Ft,Ht=(Ht%xe+xe)%xe,te);if(this.tiles[ot])return Ar(this.tiles[ot],_e);ve>1&&console.log("drilling down to z%d-%d-%d",Ft,Ht,te);for(var at,ht=Ft,Bt=Ht,kt=te;!at&&ht>0;)ht--,Bt=Math.floor(Bt/2),kt=Math.floor(kt/2),at=this.tiles[ds(ht,Bt,kt)];return at&&at.source?(ve>1&&console.log("found parent tile z%d-%d-%d",ht,Bt,kt),ve>1&&console.time("drilling down"),this.splitTile(at.source,ht,Bt,kt,Ft,Ht,te),ve>1&&console.timeEnd("drilling down"),this.tiles[ot]?Ar(this.tiles[ot],_e):null):null},function(Ft,Ht){return new ri(Ft,Ht)}}();var qr=vt.g(In.exports);function Co(ce,et){const nt=ce.tileID.canonical;if(!this._geoJSONIndex)return et(null,null);const gt=this._geoJSONIndex.getTile(nt.z,nt.x,nt.y);if(!gt)return et(null,null);const Qt=new class{constructor(Pe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=vt.E,this.length=Pe.length,this._features=Pe}feature(Pe){return new class{constructor(Ge){this._feature=Ge,this.extent=vt.E,this.type=Ge.type,this.properties=Ge.tags,"id"in Ge&&!isNaN(Ge.id)&&(this.id=parseInt(Ge.id,10))}loadGeometry(){if(1===this._feature.type){const Ge=[];for(const ae of this._feature.geometry)Ge.push([new vt.P(ae[0],ae[1])]);return Ge}{const Ge=[];for(const ae of this._feature.geometry){const Xe=[];for(const Ze of ae)Xe.push(new vt.P(Ze[0],Ze[1]));Ge.push(Xe)}return Ge}}toGeoJSON(Ge,ae,Xe){return Yt.call(this,Ge,ae,Xe)}}(this._features[Pe])}}(gt.features);let ie=Vo(Qt);0===ie.byteOffset&&ie.byteLength===ie.buffer.byteLength||(ie=new Uint8Array(ie)),et(null,{vectorTile:Qt,rawData:ie.buffer})}class tr extends vt.d{constructor(et,nt,gt,Qt,ie,Pe){super(et,nt,gt,Qt,Co,Pe),ie&&(this.loadGeoJSON=ie)}loadData(et,nt){const gt=et&&et.request,Qt=gt&&gt.collectResourceTiming;this.loadGeoJSON(et,(ie,Pe)=>{if(ie||!Pe)return nt(ie);if("object"!=typeof Pe)return nt(new Error(`Input data given to '${et.source}' is not a valid GeoJSON object.`));{Ot(Pe,!0);try{if(et.filter){const ae=vt.e(et.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===ae.result)throw new Error(ae.value.map(Ze=>`${Ze.key}: ${Ze.message}`).join(", "));Pe={type:"FeatureCollection",features:Pe.features.filter(Ze=>ae.value.evaluate({zoom:0},Ze))}}this._geoJSONIndex=et.cluster?new Wt(function({superclusterOptions:ae,clusterProperties:Xe}){if(!Xe||!ae)return ae;const Ze={},Ie={},gn={accumulated:null,zoom:0},ur={properties:null},yn=Object.keys(Xe);for(const Fr of yn){const[Xr,Sn]=Xe[Fr],jo=vt.e(Sn),Ur=vt.e("string"==typeof Xr?[Xr,["accumulated"],["get",Fr]]:Xr);Ze[Fr]=jo.value,Ie[Fr]=Ur.value}return ae.map=Fr=>{ur.properties=Fr;const Xr={};for(const Sn of yn)Xr[Sn]=Ze[Sn].evaluate(gn,ur);return Xr},ae.reduce=(Fr,Xr)=>{ur.properties=Xr;for(const Sn of yn)gn.accumulated=Fr[Sn],Fr[Sn]=Ie[Sn].evaluate(gn,ur)},ae}(et)).load(Pe.features):qr(Pe,et.geojsonVtOptions)}catch(ae){return nt(ae)}this.loaded={};const Ge={};if(Qt){const ae=vt.f(gt);ae&&(Ge.resourceTiming={},Ge.resourceTiming[et.source]=JSON.parse(JSON.stringify(ae)))}nt(null,Ge)}})}reloadTile(et,nt){const gt=this.loaded;return gt&&gt[et.uid]?super.reloadTile(et,nt):this.loadTile(et,nt)}loadGeoJSON(et,nt){if(et.request)vt.h(et.request,nt);else{if("string"!=typeof et.data)return nt(new Error(`Input data given to '${et.source}' is not a valid GeoJSON object.`));try{return nt(null,JSON.parse(et.data))}catch{return nt(new Error(`Input data given to '${et.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(et,nt){try{nt(null,this._geoJSONIndex.getClusterExpansionZoom(et.clusterId))}catch(gt){nt(gt)}}getClusterChildren(et,nt){try{nt(null,this._geoJSONIndex.getChildren(et.clusterId))}catch(gt){nt(gt)}}getClusterLeaves(et,nt){try{nt(null,this._geoJSONIndex.getLeaves(et.clusterId,et.limit,et.offset))}catch(gt){nt(gt)}}}class Tn{constructor(et,nt){this.tileID=new vt.O(et.tileID.overscaledZ,et.tileID.wrap,et.tileID.canonical.z,et.tileID.canonical.x,et.tileID.canonical.y),this.tileZoom=et.tileZoom,this.uid=et.uid,this.zoom=et.zoom,this.canonical=et.tileID.canonical,this.pixelRatio=et.pixelRatio,this.tileSize=et.tileSize,this.source=et.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=et.projection,this.brightness=nt}parse(et,nt,gt,Qt){this.status="parsing";const ie=new vt.O(gt.tileID.overscaledZ,gt.tileID.wrap,gt.tileID.canonical.z,gt.tileID.canonical.x,gt.tileID.canonical.y),Pe={},Ge=nt.familiesBySource[gt.source],ae=new vt.F(ie,gt.promoteId);return ae.bucketLayerIDs=[],vt.l(et).then(Xe=>{if(!Xe)return Qt(new Error("Could not parse tile"));const Ze=vt.j(Xe,1/vt.t(gt.tileID.canonical)),Ie=Xe.json.extensionsUsed&&Xe.json.extensionsUsed.includes("MAPBOX_mesh_features"),gn=new vt.k(this.zoom,{brightness:this.brightness});for(const ur in Ge)for(const yn of Ge[ur]){const Fr=yn[0],Xr=Xe.json.extensionsUsed;Fr.recalculate(gn,[]);const Sn=new vt.T(Ze,ie,Xr&&Xr.includes("MAPBOX_mesh_features"),this.brightness);Ie||(Sn.needsUpload=!0),Pe[Fr.fqid]=Sn,Sn.evaluate(Fr)}this.status="done",Qt(null,{buckets:Pe,featureIndex:ae})}).catch(Xe=>Qt(new Error(Xe.message)))}}class pn{constructor(et,nt,gt,Qt,ie,Pe){this.actor=et,this.layerIndex=nt,this.brightness=Pe,this.loading={},this.loaded={}}loadTile(et,nt){const gt=et.uid,Qt=this.loading[gt]=new Tn(et,this.brightness);vt.i(et.request,(ie,Pe)=>{const Ge=!this.loading[gt];return delete this.loading[gt],Ge||ie?(Qt.status="done",Ge||(this.loaded[gt]=Qt),nt(ie)):Pe&&0!==Pe.byteLength?void Qt.parse(Pe,this.layerIndex,et,(ae,Xe)=>{Qt.status="done",this.loaded=this.loaded||{},this.loaded[gt]=Qt,ae||!Xe?nt(ae):nt(null,Xe)}):(Qt.status="done",this.loaded[gt]=Qt,nt())})}reloadTile(et,nt){const gt=this.loaded,Qt=et.uid;if(gt&&gt[Qt]){const ie=gt[Qt];ie.projection=et.projection,ie.brightness=et.brightness;const Pe=(Ge,ae)=>{ie.reloadCallback&&(delete ie.reloadCallback,this.loadTile(et,nt)),nt(Ge,ae)};"parsing"===ie.status?ie.reloadCallback=Pe:"done"===ie.status&&this.loadTile(et,nt)}}abortTile(et,nt){const gt=et.uid;this.loading[gt]&&delete this.loading[gt],nt()}removeTile(et,nt){const gt=this.loaded,Qt=et.uid;gt&&gt[Qt]&&delete gt[Qt],nt()}}class fo{constructor(et){this.self=et,this.actor=new vt.A(et,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=vt.m({name:"mercator"}),this.workerSourceTypes={vector:vt.d,geojson:tr,"batched-model":pn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(nt,gt)=>{if(this.workerSourceTypes[nt])throw new Error(`Worker source with name "${nt}" already registered.`);this.workerSourceTypes[nt]=gt},this.self.registerRTLTextPlugin=nt=>{if(vt.n.isParsed())throw new Error("RTL text plugin already registered.");vt.n.applyArabicShaping=nt.applyArabicShaping,vt.n.processBidirectionalText=nt.processBidirectionalText,vt.n.processStyledBidirectionalText=nt.processStyledBidirectionalText}}clearCaches(et,nt,gt){delete this.layerIndexes[et],delete this.availableImages[et],delete this.workerSources[et],delete this.demWorkerSources[et],gt()}checkIfReady(et,nt,gt){gt()}setReferrer(et,nt){this.referrer=nt}spriteLoaded(et,{scope:nt,isLoaded:gt}){if(this.isSpriteLoaded[et]||(this.isSpriteLoaded[et]={}),this.isSpriteLoaded[et][nt]=gt,this.workerSources[et]&&this.workerSources[et][nt])for(const Qt in this.workerSources[et][nt]){const ie=this.workerSources[et][nt][Qt];for(const Pe in ie)ie[Pe]instanceof vt.d&&(ie[Pe].isSpriteLoaded=gt,ie[Pe].fire(new vt.o("isSpriteLoaded")))}}setImages(et,{scope:nt,images:gt},Qt){if(this.availableImages[et]||(this.availableImages[et]={}),this.availableImages[et][nt]=gt,this.workerSources[et]&&this.workerSources[et][nt]){for(const ie in this.workerSources[et][nt]){const Pe=this.workerSources[et][nt][ie];for(const Ge in Pe)Pe[Ge].availableImages=gt}Qt()}else Qt()}setProjection(et,nt){this.projections[et]=vt.m(nt)}setBrightness(et,nt,gt){this.brightness=nt,gt()}setLayers(et,nt,gt){this.getLayerIndex(et,nt.scope).replace(nt.layers,nt.options),gt()}updateLayers(et,nt,gt){this.getLayerIndex(et,nt.scope).update(nt.layers,nt.removedIds,nt.options),gt()}loadTile(et,nt,gt){nt.projection=this.projections[et]||this.defaultProjection,this.getWorkerSource(et,nt.type,nt.source,nt.scope).loadTile(nt,gt)}loadDEMTile(et,nt,gt){this.getDEMWorkerSource(et,nt.source,nt.scope).loadTile(nt,gt)}reloadTile(et,nt,gt){nt.projection=this.projections[et]||this.defaultProjection,this.getWorkerSource(et,nt.type,nt.source,nt.scope).reloadTile(nt,gt)}abortTile(et,nt,gt){this.getWorkerSource(et,nt.type,nt.source,nt.scope).abortTile(nt,gt)}removeTile(et,nt,gt){this.getWorkerSource(et,nt.type,nt.source,nt.scope).removeTile(nt,gt)}removeSource(et,nt,gt){if(!(this.workerSources[et]&&this.workerSources[et][nt.scope]&&this.workerSources[et][nt.scope][nt.type]&&this.workerSources[et][nt.scope][nt.type][nt.source]))return;const Qt=this.workerSources[et][nt.scope][nt.type][nt.source];delete this.workerSources[et][nt.scope][nt.type][nt.source],void 0!==Qt.removeSource?Qt.removeSource(nt,gt):gt()}loadWorkerSource(et,nt,gt){try{this.self.importScripts(nt.url),gt()}catch(Qt){gt(Qt.toString())}}syncRTLPluginState(et,nt,gt){try{vt.n.setState(nt);const Qt=vt.n.getPluginURL();if(vt.n.isLoaded()&&!vt.n.isParsed()&&null!=Qt){this.self.importScripts(Qt);const ie=vt.n.isParsed();gt(ie?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Qt}`),ie)}}catch(Qt){gt(Qt.toString())}}setDracoUrl(et,nt){this.dracoUrl=nt}getAvailableImages(et,nt){this.availableImages[et]||(this.availableImages[et]={});let gt=this.availableImages[et][nt];return gt||(gt=[]),gt}getLayerIndex(et,nt){this.layerIndexes[et]||(this.layerIndexes[et]={});let gt=this.layerIndexes[et][nt];return gt||(gt=this.layerIndexes[et][nt]=new ke,gt.scope=nt),gt}getWorkerSource(et,nt,gt,Qt){return this.workerSources[et]||(this.workerSources[et]={}),this.workerSources[et][Qt]||(this.workerSources[et][Qt]={}),this.workerSources[et][Qt][nt]||(this.workerSources[et][Qt][nt]={}),this.isSpriteLoaded[et]||(this.isSpriteLoaded[et]={}),this.workerSources[et][Qt][nt][gt]||(this.workerSources[et][Qt][nt][gt]=new this.workerSourceTypes[nt]({send:(Pe,Ge,ae,Xe,Ze,Ie)=>{this.actor.send(Pe,Ge,ae,et,Ze,Ie)},scheduler:this.actor.scheduler},this.getLayerIndex(et,Qt),this.getAvailableImages(et,Qt),this.isSpriteLoaded[et][Qt],void 0,this.brightness)),this.workerSources[et][Qt][nt][gt]}getDEMWorkerSource(et,nt,gt){return this.demWorkerSources[et]||(this.demWorkerSources[et]={}),this.demWorkerSources[et][gt]||(this.demWorkerSources[et][gt]={}),this.demWorkerSources[et][gt][nt]||(this.demWorkerSources[et][gt][nt]=new ue),this.demWorkerSources[et][gt][nt]}enforceCacheSizeLimit(et,nt){vt.q(nt)}getWorkerPerformanceMetrics(et,nt,gt){gt(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new fo(self)),fo}),mt(0,function(vt){return vt.s}),x}()},5619:(Hn,we,ft)=>{"use strict";ft.d(we,{X:()=>mt});var x=ft(8645);class mt extends x.x{constructor(vt){super(),this._value=vt}get value(){return this.getValue()}_subscribe(vt){const lt=super._subscribe(vt);return!lt.closed&&vt.next(this._value),lt}getValue(){const{hasError:vt,thrownError:lt,_value:ye}=this;if(vt)throw lt;return this._throwIfClosed(),ye}next(vt){super.next(this._value=vt)}}},5592:(Hn,we,ft)=>{"use strict";ft.d(we,{y:()=>ue});var x=ft(305),mt=ft(7394),It=ft(4850),vt=ft(8407),lt=ft(2653),ye=ft(4674),ke=ft(1441);let ue=(()=>{class Yt{constructor(re){re&&(this._subscribe=re)}lift(re){const tn=new Yt;return tn.source=this,tn.operator=re,tn}subscribe(re,tn,We){const rn=function Ot(Yt){return Yt&&Yt instanceof x.Lv||function Pt(Yt){return Yt&&(0,ye.m)(Yt.next)&&(0,ye.m)(Yt.error)&&(0,ye.m)(Yt.complete)}(Yt)&&(0,mt.Nn)(Yt)}(re)?re:new x.Hp(re,tn,We);return(0,ke.x)(()=>{const{operator:Te,source:Fn}=this;rn.add(Te?Te.call(rn,Fn):Fn?this._subscribe(rn):this._trySubscribe(rn))}),rn}_trySubscribe(re){try{return this._subscribe(re)}catch(tn){re.error(tn)}}forEach(re,tn){return new(tn=be(tn))((We,rn)=>{const Te=new x.Hp({next:Fn=>{try{re(Fn)}catch(Ce){rn(Ce),Te.unsubscribe()}},error:rn,complete:We});this.subscribe(Te)})}_subscribe(re){var tn;return null===(tn=this.source)||void 0===tn?void 0:tn.subscribe(re)}[It.L](){return this}pipe(...re){return(0,vt.U)(re)(this)}toPromise(re){return new(re=be(re))((tn,We)=>{let rn;this.subscribe(Te=>rn=Te,Te=>We(Te),()=>tn(rn))})}}return Yt.create=Le=>new Yt(Le),Yt})();function be(Yt){var Le;return null!==(Le=Yt??lt.config.Promise)&&void 0!==Le?Le:Promise}},8645:(Hn,we,ft)=>{"use strict";ft.d(we,{x:()=>ke});var x=ft(5592),mt=ft(7394);const vt=(0,ft(2306).d)(be=>function(){be(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var lt=ft(9039),ye=ft(1441);let ke=(()=>{class be extends x.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Ot){const Yt=new ue(this,this);return Yt.operator=Ot,Yt}_throwIfClosed(){if(this.closed)throw new vt}next(Ot){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Yt of this.currentObservers)Yt.next(Ot)}})}error(Ot){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Ot;const{observers:Yt}=this;for(;Yt.length;)Yt.shift().error(Ot)}})}complete(){(0,ye.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Ot}=this;for(;Ot.length;)Ot.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Ot;return(null===(Ot=this.observers)||void 0===Ot?void 0:Ot.length)>0}_trySubscribe(Ot){return this._throwIfClosed(),super._trySubscribe(Ot)}_subscribe(Ot){return this._throwIfClosed(),this._checkFinalizedStatuses(Ot),this._innerSubscribe(Ot)}_innerSubscribe(Ot){const{hasError:Yt,isStopped:Le,observers:re}=this;return Yt||Le?mt.Lc:(this.currentObservers=null,re.push(Ot),new mt.w0(()=>{this.currentObservers=null,(0,lt.P)(re,Ot)}))}_checkFinalizedStatuses(Ot){const{hasError:Yt,thrownError:Le,isStopped:re}=this;Yt?Ot.error(Le):re&&Ot.complete()}asObservable(){const Ot=new x.y;return Ot.source=this,Ot}}return be.create=(Pt,Ot)=>new ue(Pt,Ot),be})();class ue extends ke{constructor(Pt,Ot){super(),this.destination=Pt,this.source=Ot}next(Pt){var Ot,Yt;null===(Yt=null===(Ot=this.destination)||void 0===Ot?void 0:Ot.next)||void 0===Yt||Yt.call(Ot,Pt)}error(Pt){var Ot,Yt;null===(Yt=null===(Ot=this.destination)||void 0===Ot?void 0:Ot.error)||void 0===Yt||Yt.call(Ot,Pt)}complete(){var Pt,Ot;null===(Ot=null===(Pt=this.destination)||void 0===Pt?void 0:Pt.complete)||void 0===Ot||Ot.call(Pt)}_subscribe(Pt){var Ot,Yt;return null!==(Yt=null===(Ot=this.source)||void 0===Ot?void 0:Ot.subscribe(Pt))&&void 0!==Yt?Yt:mt.Lc}}},305:(Hn,we,ft)=>{"use strict";ft.d(we,{Hp:()=>We,Lv:()=>Yt});var x=ft(4674),mt=ft(7394),It=ft(2653),vt=ft(3894),lt=ft(2420);const ye=be("C",void 0,void 0);function be(me,tt,Xt){return{kind:me,value:tt,error:Xt}}var Pt=ft(7599),Ot=ft(1441);class Yt extends mt.w0{constructor(tt){super(),this.isStopped=!1,tt?(this.destination=tt,(0,mt.Nn)(tt)&&tt.add(this)):this.destination=Ce}static create(tt,Xt,Ve){return new We(tt,Xt,Ve)}next(tt){this.isStopped?Fn(function ue(me){return be("N",me,void 0)}(tt),this):this._next(tt)}error(tt){this.isStopped?Fn(function ke(me){return be("E",void 0,me)}(tt),this):(this.isStopped=!0,this._error(tt))}complete(){this.isStopped?Fn(ye,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(tt){this.destination.next(tt)}_error(tt){try{this.destination.error(tt)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Le=Function.prototype.bind;function re(me,tt){return Le.call(me,tt)}class tn{constructor(tt){this.partialObserver=tt}next(tt){const{partialObserver:Xt}=this;if(Xt.next)try{Xt.next(tt)}catch(Ve){rn(Ve)}}error(tt){const{partialObserver:Xt}=this;if(Xt.error)try{Xt.error(tt)}catch(Ve){rn(Ve)}else rn(tt)}complete(){const{partialObserver:tt}=this;if(tt.complete)try{tt.complete()}catch(Xt){rn(Xt)}}}class We extends Yt{constructor(tt,Xt,Ve){let Gt;if(super(),(0,x.m)(tt)||!tt)Gt={next:tt??void 0,error:Xt??void 0,complete:Ve??void 0};else{let Ct;this&&It.config.useDeprecatedNextContext?(Ct=Object.create(tt),Ct.unsubscribe=()=>this.unsubscribe(),Gt={next:tt.next&&re(tt.next,Ct),error:tt.error&&re(tt.error,Ct),complete:tt.complete&&re(tt.complete,Ct)}):Gt=tt}this.destination=new tn(Gt)}}function rn(me){It.config.useDeprecatedSynchronousErrorHandling?(0,Ot.O)(me):(0,vt.h)(me)}function Fn(me,tt){const{onStoppedNotification:Xt}=It.config;Xt&&Pt.z.setTimeout(()=>Xt(me,tt))}const Ce={closed:!0,next:lt.Z,error:function Te(me){throw me},complete:lt.Z}},7394:(Hn,we,ft)=>{"use strict";ft.d(we,{Lc:()=>ye,w0:()=>lt,Nn:()=>ke});var x=ft(4674);const It=(0,ft(2306).d)(be=>function(Ot){be(this),this.message=Ot?`${Ot.length} errors occurred during unsubscription:\n${Ot.map((Yt,Le)=>`${Le+1}) ${Yt.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Ot});var vt=ft(9039);class lt{constructor(Pt){this.initialTeardown=Pt,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Pt;if(!this.closed){this.closed=!0;const{_parentage:Ot}=this;if(Ot)if(this._parentage=null,Array.isArray(Ot))for(const re of Ot)re.remove(this);else Ot.remove(this);const{initialTeardown:Yt}=this;if((0,x.m)(Yt))try{Yt()}catch(re){Pt=re instanceof It?re.errors:[re]}const{_finalizers:Le}=this;if(Le){this._finalizers=null;for(const re of Le)try{ue(re)}catch(tn){Pt=Pt??[],tn instanceof It?Pt=[...Pt,...tn.errors]:Pt.push(tn)}}if(Pt)throw new It(Pt)}}add(Pt){var Ot;if(Pt&&Pt!==this)if(this.closed)ue(Pt);else{if(Pt instanceof lt){if(Pt.closed||Pt._hasParent(this))return;Pt._addParent(this)}(this._finalizers=null!==(Ot=this._finalizers)&&void 0!==Ot?Ot:[]).push(Pt)}}_hasParent(Pt){const{_parentage:Ot}=this;return Ot===Pt||Array.isArray(Ot)&&Ot.includes(Pt)}_addParent(Pt){const{_parentage:Ot}=this;this._parentage=Array.isArray(Ot)?(Ot.push(Pt),Ot):Ot?[Ot,Pt]:Pt}_removeParent(Pt){const{_parentage:Ot}=this;Ot===Pt?this._parentage=null:Array.isArray(Ot)&&(0,vt.P)(Ot,Pt)}remove(Pt){const{_finalizers:Ot}=this;Ot&&(0,vt.P)(Ot,Pt),Pt instanceof lt&&Pt._removeParent(this)}}lt.EMPTY=(()=>{const be=new lt;return be.closed=!0,be})();const ye=lt.EMPTY;function ke(be){return be instanceof lt||be&&"closed"in be&&(0,x.m)(be.remove)&&(0,x.m)(be.add)&&(0,x.m)(be.unsubscribe)}function ue(be){(0,x.m)(be)?be():be.unsubscribe()}},2653:(Hn,we,ft)=>{"use strict";ft.d(we,{config:()=>x});const x={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},6232:(Hn,we,ft)=>{"use strict";ft.d(we,{E:()=>mt});const mt=new(ft(5592).y)(lt=>lt.complete())},2459:(Hn,we,ft)=>{"use strict";ft.d(we,{D:()=>tt});var x=ft(4829),mt=ft(3093),It=ft(5137),ye=ft(5592),ue=ft(4971),be=ft(4674),Pt=ft(7103);function Yt(Xt,Ve){if(!Xt)throw new Error("Iterable cannot be null");return new ye.y(Gt=>{(0,Pt.f)(Gt,Ve,()=>{const Ct=Xt[Symbol.asyncIterator]();(0,Pt.f)(Gt,Ve,()=>{Ct.next().then(ge=>{ge.done?Gt.complete():Gt.next(ge.value)})},0,!0)})})}var Le=ft(8382),re=ft(4026),tn=ft(4266),We=ft(3664),rn=ft(5726),Te=ft(9853),Fn=ft(541);function tt(Xt,Ve){return Ve?function me(Xt,Ve){if(null!=Xt){if((0,Le.c)(Xt))return function vt(Xt,Ve){return(0,x.Xf)(Xt).pipe((0,It.R)(Ve),(0,mt.Q)(Ve))}(Xt,Ve);if((0,tn.z)(Xt))return function ke(Xt,Ve){return new ye.y(Gt=>{let Ct=0;return Ve.schedule(function(){Ct===Xt.length?Gt.complete():(Gt.next(Xt[Ct++]),Gt.closed||this.schedule())})})}(Xt,Ve);if((0,re.t)(Xt))return function lt(Xt,Ve){return(0,x.Xf)(Xt).pipe((0,It.R)(Ve),(0,mt.Q)(Ve))}(Xt,Ve);if((0,rn.D)(Xt))return Yt(Xt,Ve);if((0,We.T)(Xt))return function Ot(Xt,Ve){return new ye.y(Gt=>{let Ct;return(0,Pt.f)(Gt,Ve,()=>{Ct=Xt[ue.h](),(0,Pt.f)(Gt,Ve,()=>{let ge,en;try{({value:ge,done:en}=Ct.next())}catch(Vo){return void Gt.error(Vo)}en?Gt.complete():Gt.next(ge)},0,!0)}),()=>(0,be.m)(Ct?.return)&&Ct.return()})}(Xt,Ve);if((0,Fn.L)(Xt))return function Ce(Xt,Ve){return Yt((0,Fn.Q)(Xt),Ve)}(Xt,Ve)}throw(0,Te.z)(Xt)}(Xt,Ve):(0,x.Xf)(Xt)}},4829:(Hn,we,ft)=>{"use strict";ft.d(we,{Xf:()=>Le});var x=ft(7582),mt=ft(4266),It=ft(4026),vt=ft(5592),lt=ft(8382),ye=ft(5726),ke=ft(9853),ue=ft(3664),be=ft(541),Pt=ft(4674),Ot=ft(3894),Yt=ft(4850);function Le(me){if(me instanceof vt.y)return me;if(null!=me){if((0,lt.c)(me))return function re(me){return new vt.y(tt=>{const Xt=me[Yt.L]();if((0,Pt.m)(Xt.subscribe))return Xt.subscribe(tt);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(me);if((0,mt.z)(me))return function tn(me){return new vt.y(tt=>{for(let Xt=0;Xt<me.length&&!tt.closed;Xt++)tt.next(me[Xt]);tt.complete()})}(me);if((0,It.t)(me))return function We(me){return new vt.y(tt=>{me.then(Xt=>{tt.closed||(tt.next(Xt),tt.complete())},Xt=>tt.error(Xt)).then(null,Ot.h)})}(me);if((0,ye.D)(me))return Te(me);if((0,ue.T)(me))return function rn(me){return new vt.y(tt=>{for(const Xt of me)if(tt.next(Xt),tt.closed)return;tt.complete()})}(me);if((0,be.L)(me))return function Fn(me){return Te((0,be.Q)(me))}(me)}throw(0,ke.z)(me)}function Te(me){return new vt.y(tt=>{(function Ce(me,tt){var Xt,Ve,Gt,Ct;return(0,x.mG)(this,void 0,void 0,function*(){try{for(Xt=(0,x.KL)(me);!(Ve=yield Xt.next()).done;)if(tt.next(Ve.value),tt.closed)return}catch(ge){Gt={error:ge}}finally{try{Ve&&!Ve.done&&(Ct=Xt.return)&&(yield Ct.call(Xt))}finally{if(Gt)throw Gt.error}}tt.complete()})})(me,tt).catch(Xt=>tt.error(Xt))})}},3019:(Hn,we,ft)=>{"use strict";ft.d(we,{T:()=>ye});var x=ft(7537),mt=ft(4829),It=ft(6232),vt=ft(4564),lt=ft(2459);function ye(...ke){const ue=(0,vt.yG)(ke),be=(0,vt._6)(ke,1/0),Pt=ke;return Pt.length?1===Pt.length?(0,mt.Xf)(Pt[0]):(0,x.J)(be)((0,lt.D)(Pt,ue)):It.E}},2096:(Hn,we,ft)=>{"use strict";ft.d(we,{of:()=>It});var x=ft(4564),mt=ft(2459);function It(...vt){const lt=(0,x.yG)(vt);return(0,mt.D)(vt,lt)}},8251:(Hn,we,ft)=>{"use strict";ft.d(we,{x:()=>mt});var x=ft(305);function mt(vt,lt,ye,ke,ue){return new It(vt,lt,ye,ke,ue)}class It extends x.Lv{constructor(lt,ye,ke,ue,be,Pt){super(lt),this.onFinalize=be,this.shouldUnsubscribe=Pt,this._next=ye?function(Ot){try{ye(Ot)}catch(Yt){lt.error(Yt)}}:super._next,this._error=ue?function(Ot){try{ue(Ot)}catch(Yt){lt.error(Yt)}finally{this.unsubscribe()}}:super._error,this._complete=ke?function(){try{ke()}catch(Ot){lt.error(Ot)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var lt;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ye}=this;super.unsubscribe(),!ye&&(null===(lt=this.onFinalize)||void 0===lt||lt.call(this))}}}},7398:(Hn,we,ft)=>{"use strict";ft.d(we,{U:()=>It});var x=ft(9360),mt=ft(8251);function It(vt,lt){return(0,x.e)((ye,ke)=>{let ue=0;ye.subscribe((0,mt.x)(ke,be=>{ke.next(vt.call(lt,be,ue++))}))})}},7537:(Hn,we,ft)=>{"use strict";ft.d(we,{J:()=>It});var x=ft(1631),mt=ft(2737);function It(vt=1/0){return(0,x.z)(mt.y,vt)}},1631:(Hn,we,ft)=>{"use strict";ft.d(we,{z:()=>ue});var x=ft(7398),mt=ft(4829),It=ft(9360),vt=ft(7103),lt=ft(8251),ke=ft(4674);function ue(be,Pt,Ot=1/0){return(0,ke.m)(Pt)?ue((Yt,Le)=>(0,x.U)((re,tn)=>Pt(Yt,re,Le,tn))((0,mt.Xf)(be(Yt,Le))),Ot):("number"==typeof Pt&&(Ot=Pt),(0,It.e)((Yt,Le)=>function ye(be,Pt,Ot,Yt,Le,re,tn,We){const rn=[];let Te=0,Fn=0,Ce=!1;const me=()=>{Ce&&!rn.length&&!Te&&Pt.complete()},tt=Ve=>Te<Yt?Xt(Ve):rn.push(Ve),Xt=Ve=>{re&&Pt.next(Ve),Te++;let Gt=!1;(0,mt.Xf)(Ot(Ve,Fn++)).subscribe((0,lt.x)(Pt,Ct=>{Le?.(Ct),re?tt(Ct):Pt.next(Ct)},()=>{Gt=!0},void 0,()=>{if(Gt)try{for(Te--;rn.length&&Te<Yt;){const Ct=rn.shift();tn?(0,vt.f)(Pt,tn,()=>Xt(Ct)):Xt(Ct)}me()}catch(Ct){Pt.error(Ct)}}))};return be.subscribe((0,lt.x)(Pt,tt,()=>{Ce=!0,me()})),()=>{We?.()}}(Yt,Le,be,Ot)))}},3093:(Hn,we,ft)=>{"use strict";ft.d(we,{Q:()=>vt});var x=ft(7103),mt=ft(9360),It=ft(8251);function vt(lt,ye=0){return(0,mt.e)((ke,ue)=>{ke.subscribe((0,It.x)(ue,be=>(0,x.f)(ue,lt,()=>ue.next(be),ye),()=>(0,x.f)(ue,lt,()=>ue.complete(),ye),be=>(0,x.f)(ue,lt,()=>ue.error(be),ye)))})}},3020:(Hn,we,ft)=>{"use strict";ft.d(we,{B:()=>lt});var x=ft(4829),mt=ft(8645),It=ft(305),vt=ft(9360);function lt(ke={}){const{connector:ue=(()=>new mt.x),resetOnError:be=!0,resetOnComplete:Pt=!0,resetOnRefCountZero:Ot=!0}=ke;return Yt=>{let Le,re,tn,We=0,rn=!1,Te=!1;const Fn=()=>{re?.unsubscribe(),re=void 0},Ce=()=>{Fn(),Le=tn=void 0,rn=Te=!1},me=()=>{const tt=Le;Ce(),tt?.unsubscribe()};return(0,vt.e)((tt,Xt)=>{We++,!Te&&!rn&&Fn();const Ve=tn=tn??ue();Xt.add(()=>{We--,0===We&&!Te&&!rn&&(re=ye(me,Ot))}),Ve.subscribe(Xt),!Le&&We>0&&(Le=new It.Hp({next:Gt=>Ve.next(Gt),error:Gt=>{Te=!0,Fn(),re=ye(Ce,be,Gt),Ve.error(Gt)},complete:()=>{rn=!0,Fn(),re=ye(Ce,Pt),Ve.complete()}}),(0,x.Xf)(tt).subscribe(Le))})(Yt)}}function ye(ke,ue,...be){if(!0===ue)return void ke();if(!1===ue)return;const Pt=new It.Hp({next:()=>{Pt.unsubscribe(),ke()}});return(0,x.Xf)(ue(...be)).subscribe(Pt)}},5137:(Hn,we,ft)=>{"use strict";ft.d(we,{R:()=>mt});var x=ft(9360);function mt(It,vt=0){return(0,x.e)((lt,ye)=>{ye.add(It.schedule(()=>lt.subscribe(ye),vt))})}},4664:(Hn,we,ft)=>{"use strict";ft.d(we,{w:()=>vt});var x=ft(4829),mt=ft(9360),It=ft(8251);function vt(lt,ye){return(0,mt.e)((ke,ue)=>{let be=null,Pt=0,Ot=!1;const Yt=()=>Ot&&!be&&ue.complete();ke.subscribe((0,It.x)(ue,Le=>{be?.unsubscribe();let re=0;const tn=Pt++;(0,x.Xf)(lt(Le,tn)).subscribe(be=(0,It.x)(ue,We=>ue.next(ye?ye(Le,We,tn,re++):We),()=>{be=null,Yt()}))},()=>{Ot=!0,Yt()}))})}},9397:(Hn,we,ft)=>{"use strict";ft.d(we,{b:()=>lt});var x=ft(4674),mt=ft(9360),It=ft(8251),vt=ft(2737);function lt(ye,ke,ue){const be=(0,x.m)(ye)||ke||ue?{next:ye,error:ke,complete:ue}:ye;return be?(0,mt.e)((Pt,Ot)=>{var Yt;null===(Yt=be.subscribe)||void 0===Yt||Yt.call(be);let Le=!0;Pt.subscribe((0,It.x)(Ot,re=>{var tn;null===(tn=be.next)||void 0===tn||tn.call(be,re),Ot.next(re)},()=>{var re;Le=!1,null===(re=be.complete)||void 0===re||re.call(be),Ot.complete()},re=>{var tn;Le=!1,null===(tn=be.error)||void 0===tn||tn.call(be,re),Ot.error(re)},()=>{var re,tn;Le&&(null===(re=be.unsubscribe)||void 0===re||re.call(be)),null===(tn=be.finalize)||void 0===tn||tn.call(be)}))}):vt.y}},4552:(Hn,we,ft)=>{"use strict";ft.d(we,{l:()=>x});const x={now:()=>(x.delegate||Date).now(),delegate:void 0}},7599:(Hn,we,ft)=>{"use strict";ft.d(we,{z:()=>x});const x={setTimeout(mt,It,...vt){const{delegate:lt}=x;return lt?.setTimeout?lt.setTimeout(mt,It,...vt):setTimeout(mt,It,...vt)},clearTimeout(mt){const{delegate:It}=x;return(It?.clearTimeout||clearTimeout)(mt)},delegate:void 0}},4971:(Hn,we,ft)=>{"use strict";ft.d(we,{h:()=>mt});const mt=function x(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(Hn,we,ft)=>{"use strict";ft.d(we,{L:()=>x});const x="function"==typeof Symbol&&Symbol.observable||"@@observable"},4564:(Hn,we,ft)=>{"use strict";ft.d(we,{_6:()=>ye,jO:()=>vt,yG:()=>lt});var x=ft(4674);function It(ke){return ke[ke.length-1]}function vt(ke){return(0,x.m)(It(ke))?ke.pop():void 0}function lt(ke){return function mt(ke){return ke&&(0,x.m)(ke.schedule)}(It(ke))?ke.pop():void 0}function ye(ke,ue){return"number"==typeof It(ke)?ke.pop():ue}},9039:(Hn,we,ft)=>{"use strict";function x(mt,It){if(mt){const vt=mt.indexOf(It);0<=vt&&mt.splice(vt,1)}}ft.d(we,{P:()=>x})},2306:(Hn,we,ft)=>{"use strict";function x(mt){const vt=mt(lt=>{Error.call(lt),lt.stack=(new Error).stack});return vt.prototype=Object.create(Error.prototype),vt.prototype.constructor=vt,vt}ft.d(we,{d:()=>x})},1441:(Hn,we,ft)=>{"use strict";ft.d(we,{O:()=>vt,x:()=>It});var x=ft(2653);let mt=null;function It(lt){if(x.config.useDeprecatedSynchronousErrorHandling){const ye=!mt;if(ye&&(mt={errorThrown:!1,error:null}),lt(),ye){const{errorThrown:ke,error:ue}=mt;if(mt=null,ke)throw ue}}else lt()}function vt(lt){x.config.useDeprecatedSynchronousErrorHandling&&mt&&(mt.errorThrown=!0,mt.error=lt)}},7103:(Hn,we,ft)=>{"use strict";function x(mt,It,vt,lt=0,ye=!1){const ke=It.schedule(function(){vt(),ye?mt.add(this.schedule(null,lt)):this.unsubscribe()},lt);if(mt.add(ke),!ye)return ke}ft.d(we,{f:()=>x})},2737:(Hn,we,ft)=>{"use strict";function x(mt){return mt}ft.d(we,{y:()=>x})},4266:(Hn,we,ft)=>{"use strict";ft.d(we,{z:()=>x});const x=mt=>mt&&"number"==typeof mt.length&&"function"!=typeof mt},5726:(Hn,we,ft)=>{"use strict";ft.d(we,{D:()=>mt});var x=ft(4674);function mt(It){return Symbol.asyncIterator&&(0,x.m)(It?.[Symbol.asyncIterator])}},4674:(Hn,we,ft)=>{"use strict";function x(mt){return"function"==typeof mt}ft.d(we,{m:()=>x})},8382:(Hn,we,ft)=>{"use strict";ft.d(we,{c:()=>It});var x=ft(4850),mt=ft(4674);function It(vt){return(0,mt.m)(vt[x.L])}},3664:(Hn,we,ft)=>{"use strict";ft.d(we,{T:()=>It});var x=ft(4971),mt=ft(4674);function It(vt){return(0,mt.m)(vt?.[x.h])}},4026:(Hn,we,ft)=>{"use strict";ft.d(we,{t:()=>mt});var x=ft(4674);function mt(It){return(0,x.m)(It?.then)}},541:(Hn,we,ft)=>{"use strict";ft.d(we,{L:()=>vt,Q:()=>It});var x=ft(7582),mt=ft(4674);function It(lt){return(0,x.FC)(this,arguments,function*(){const ke=lt.getReader();try{for(;;){const{value:ue,done:be}=yield(0,x.qq)(ke.read());if(be)return yield(0,x.qq)(void 0);yield yield(0,x.qq)(ue)}}finally{ke.releaseLock()}})}function vt(lt){return(0,mt.m)(lt?.getReader)}},9360:(Hn,we,ft)=>{"use strict";ft.d(we,{A:()=>mt,e:()=>It});var x=ft(4674);function mt(vt){return(0,x.m)(vt?.lift)}function It(vt){return lt=>{if(mt(lt))return lt.lift(function(ye){try{return vt(ye,this)}catch(ke){this.error(ke)}});throw new TypeError("Unable to lift unknown Observable type")}}},2420:(Hn,we,ft)=>{"use strict";function x(){}ft.d(we,{Z:()=>x})},8407:(Hn,we,ft)=>{"use strict";ft.d(we,{U:()=>It,z:()=>mt});var x=ft(2737);function mt(...vt){return It(vt)}function It(vt){return 0===vt.length?x.y:1===vt.length?vt[0]:function(ye){return vt.reduce((ke,ue)=>ue(ke),ye)}}},3894:(Hn,we,ft)=>{"use strict";ft.d(we,{h:()=>It});var x=ft(2653),mt=ft(7599);function It(vt){mt.z.setTimeout(()=>{const{onUnhandledError:lt}=x.config;if(!lt)throw vt;lt(vt)})}},9853:(Hn,we,ft)=>{"use strict";function x(mt){return new TypeError(`You provided ${null!==mt&&"object"==typeof mt?"an invalid object":`'${mt}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}ft.d(we,{z:()=>x})},8926:(Hn,we,ft)=>{"use strict";ft.d(we,{QbO:()=>IP,tb:()=>vM,AFp:()=>ef,ip1:()=>uM,hGG:()=>AM,z2F:()=>id,Ojb:()=>e1,sBO:()=>Nf,Sil:()=>Sm,EJc:()=>$I,Xts:()=>Qh,SBq:()=>Lg,lqb:()=>So,qLn:()=>ju,vpe:()=>Eo,XFs:()=>yn,OlP:()=>er,zs3:()=>ac,ZZ4:()=>kE,aQg:()=>RE,soG:()=>dM,YKP:()=>Ev,h0i:()=>Yp,PXZ:()=>qI,R0b:()=>Wi,FiY:()=>ns,Lbi:()=>Ir,g9A:()=>f0,Qsj:()=>Lw,FYo:()=>v0,JOm:()=>vw,tp0:()=>jh,Rgc:()=>bm,dDg:()=>kf,eoX:()=>yM,q4F:()=>b0,GfV:()=>Ep,s_b:()=>hh,ifc:()=>qo,VuI:()=>t,MMx:()=>_x,Lck:()=>YT,eFA:()=>Yv,Gpc:()=>Fn,f3M:()=>ir,X6Q:()=>Qv,$WT:()=>hi,MR2:()=>u0,_c5:()=>E2,qFp:()=>I,rg0:()=>mg,c2e:()=>_E,zSh:()=>Jh,HDt:()=>Ey,wAp:()=>Yc,vHH:()=>Gt,lri:()=>CE,rWj:()=>Zv,cg1:()=>ed,kL8:()=>ay,dqk:()=>Ar,Z0I:()=>Pe,eJc:()=>Om,QGY:()=>Z0,F4k:()=>rm,RDi:()=>Pw,AaK:()=>We,qOj:()=>gf,Xq5:()=>ui,TTD:()=>Ec,_Bn:()=>mx,jDz:()=>yx,xp6:()=>Rn,uIk:()=>mf,ekj:()=>pC,Suo:()=>Fx,Xpm:()=>fd,lG2:()=>wc,Yz7:()=>nt,cJS:()=>Qt,oAB:()=>Ro,Yjl:()=>Zs,Y36:()=>io,_UZ:()=>Vp,qZA:()=>fc,TgZ:()=>bf,EpF:()=>sO,n5z:()=>Uh,LFG:()=>or,$8M:()=>Jl,$Z:()=>GP,NdJ:()=>kl,CRH:()=>zx,kcU:()=>sp,O4$:()=>wl,oxw:()=>V1,Q6J:()=>Na,VKq:()=>Qp,iGM:()=>Nx,MAs:()=>nm,KtG:()=>Ed,Jf7:()=>BP,CHM:()=>yg,P3R:()=>Zn,YNc:()=>oC,W1O:()=>JC,_uU:()=>Gp,Oqu:()=>am,hij:()=>Gn,AsE:()=>lm,Gf:()=>iE});var x=ft(8645),mt=ft(7394),It=ft(5592),vt=ft(3019),lt=ft(5619),ye=ft(2096),ke=ft(3020),ue=ft(4664),be=ft(2737),Pt=ft(9360),Ot=ft(8251);function Le(l,u){return l===u}function re(l){for(let u in l)if(l[u]===re)return u;throw Error("Could not find renamed property on target object.")}function tn(l,u){for(const p in u)u.hasOwnProperty(p)&&!l.hasOwnProperty(p)&&(l[p]=u[p])}function We(l){if("string"==typeof l)return l;if(Array.isArray(l))return"["+l.map(We).join(", ")+"]";if(null==l)return""+l;if(l.overriddenName)return`${l.overriddenName}`;if(l.name)return`${l.name}`;const u=l.toString();if(null==u)return""+u;const p=u.indexOf("\n");return-1===p?u:u.substring(0,p)}function rn(l,u){return null==l||""===l?null===u?"":u:null==u||""===u?l:l+" "+u}const Te=re({__forward_ref__:re});function Fn(l){return l.__forward_ref__=Fn,l.toString=function(){return We(this())},l}function Ce(l){return me(l)?l():l}function me(l){return"function"==typeof l&&l.hasOwnProperty(Te)&&l.__forward_ref__===Fn}function tt(l){return l&&!!l.\u0275providers}const Ve="https://g.co/ng/security#xss";class Gt extends Error{constructor(u,p){super(function Ct(l,u){return`NG0${Math.abs(l)}${u?": "+u:""}`}(u,p)),this.code=u}}function ge(l){return"string"==typeof l?l:null==l?"":String(l)}function us(l,u){throw new Gt(-201,!1)}function Tn(l,u){null==l&&function pn(l,u,p,m){throw new Error(`ASSERTION ERROR: ${l}`+(null==m?"":` [Expected=> ${p} ${m} ${u} <=Actual]`))}(u,l,null,"!=")}function nt(l){return{token:l.token,providedIn:l.providedIn||null,factory:l.factory,value:void 0}}function Qt(l){return{providers:l.providers||[],imports:l.imports||[]}}function ie(l){return Ge(l,Ze)||Ge(l,gn)}function Pe(l){return null!==ie(l)}function Ge(l,u){return l.hasOwnProperty(u)?l[u]:null}function Xe(l){return l&&(l.hasOwnProperty(Ie)||l.hasOwnProperty(ur))?l[Ie]:null}const Ze=re({\u0275prov:re}),Ie=re({\u0275inj:re}),gn=re({ngInjectableDef:re}),ur=re({ngInjectorDef:re});var yn=function(l){return l[l.Default=0]="Default",l[l.Host=1]="Host",l[l.Self=2]="Self",l[l.SkipSelf=4]="SkipSelf",l[l.Optional=8]="Optional",l}(yn||{});let Fr;function Sn(l){const u=Fr;return Fr=l,u}function jo(l,u,p){const m=ie(l);return m&&"root"==m.providedIn?void 0===m.value?m.value=m.factory():m.value:p&yn.Optional?null:void 0!==u?u:void us(We(l))}const Ar=globalThis;class er{constructor(u,p){this._desc=u,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof p?this.__NG_ELEMENT_ID__=p:void 0!==p&&(this.\u0275prov=nt({token:this,providedIn:p.providedIn||"root",factory:p.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const at={},ht="__NG_DI_FLAG__",Bt="ngTempTokenPath",ee=/\n/gm,Nn="__source";let yr;function Qr(l){const u=yr;return yr=l,u}function Pr(l,u=yn.Default){if(void 0===yr)throw new Gt(-203,!1);return null===yr?jo(l,void 0,u):yr.get(l,u&yn.Optional?null:void 0,u)}function or(l,u=yn.Default){return(function Xr(){return Fr}()||Pr)(Ce(l),u)}function ir(l,u=yn.Default){return or(l,qs(u))}function qs(l){return typeof l>"u"||"number"==typeof l?l:0|(l.optional&&8)|(l.host&&1)|(l.self&&2)|(l.skipSelf&&4)}function ne(l){const u=[];for(let p=0;p<l.length;p++){const m=Ce(l[p]);if(Array.isArray(m)){if(0===m.length)throw new Gt(900,!1);let v,M=yn.Default;for(let O=0;O<m.length;O++){const T=m[O],k=Re(T);"number"==typeof k?-1===k?v=T.token:M|=k:v=T}u.push(or(v,M))}else u.push(or(m))}return u}function Vt(l,u){return l[ht]=u,l.prototype[ht]=u,l}function Re(l){return l[ht]}function sr(l){return{toString:l}.toString()}var ao=function(l){return l[l.OnPush=0]="OnPush",l[l.Default=1]="Default",l}(ao||{}),qo=function(l){return l[l.Emulated=0]="Emulated",l[l.None=2]="None",l[l.ShadowDom=3]="ShadowDom",l}(qo||{});const Io={},zr=[],gl=re({\u0275cmp:re}),ml=re({\u0275dir:re}),mh=re({\u0275pipe:re}),su=re({\u0275mod:re}),bs=re({\u0275fac:re}),Ua=re({__NG_ELEMENT_ID__:re}),lg=re({__NG_ENV_ID__:re});function Va(l,u,p){let m=l.length;for(;;){const v=l.indexOf(u,p);if(-1===v)return v;if(0===v||l.charCodeAt(v-1)<=32){const M=u.length;if(v+M===m||l.charCodeAt(v+M)<=32)return v}p=v+1}}function Zo(l,u,p){let m=0;for(;m<p.length;){const v=p[m];if("number"==typeof v){if(0!==v)break;m++;const M=p[m++],O=p[m++],T=p[m++];l.setAttribute(u,O,T,M)}else{const M=v,O=p[++m];ba(M)?l.setProperty(u,M,O):l.setAttribute(u,M,O),m++}}return m}function cg(l){return 3===l||4===l||6===l}function ba(l){return 64===l.charCodeAt(0)}function ud(l,u){if(null!==u&&0!==u.length)if(null===l||0===l.length)l=u.slice();else{let p=-1;for(let m=0;m<u.length;m++){const v=u[m];"number"==typeof v?p=v:0===p||dd(l,p,v,null,-1===p||2===p?u[++m]:null)}}return l}function dd(l,u,p,m,v){let M=0,O=l.length;if(-1===u)O=-1;else for(;M<l.length;){const T=l[M++];if("number"==typeof T){if(T===u){O=-1;break}if(T>u){O=M-1;break}}}for(;M<l.length;){const T=l[M];if("number"==typeof T)break;if(T===p){if(null===m)return void(null!==v&&(l[M+1]=v));if(m===l[M+1])return void(l[M+2]=v)}M++,null!==m&&M++,null!==v&&M++}-1!==O&&(l.splice(O,0,u),M=O+1),l.splice(M++,0,p),null!==m&&l.splice(M++,0,m),null!==v&&l.splice(M++,0,v)}const ja="ng-template";function hd(l,u,p){let m=0,v=!0;for(;m<l.length;){let M=l[m++];if("string"==typeof M&&v){const O=l[m++];if(p&&"class"===M&&-1!==Va(O.toLowerCase(),u,0))return!0}else{if(1===M){for(;m<l.length&&"string"==typeof(M=l[m++]);)if(M.toLowerCase()===u)return!0;return!1}"number"==typeof M&&(v=!1)}}return!1}function Mn(l){return 4===l.type&&l.value!==ja}function eo(l,u,p){return u===(4!==l.type||p?l.value:ja)}function oa(l,u,p){let m=4;const v=l.attrs||[],M=function Hy(l){for(let u=0;u<l.length;u++)if(cg(l[u]))return u;return l.length}(v);let O=!1;for(let T=0;T<u.length;T++){const k=u[T];if("number"!=typeof k){if(!O)if(4&m){if(m=2|1&m,""!==k&&!eo(l,k,p)||""===k&&1===u.length){if(Hi(m))return!1;O=!0}}else{const N=8&m?k:u[++T];if(8&m&&null!==l.attrs){if(!hd(l.attrs,N,p)){if(Hi(m))return!1;O=!0}continue}const $=au(8&m?"class":k,v,Mn(l),p);if(-1===$){if(Hi(m))return!1;O=!0;continue}if(""!==N){let q;q=$>M?"":v[$+1].toLowerCase();const Z=8&m?q:null;if(Z&&-1!==Va(Z,N,0)||2&m&&N!==q){if(Hi(m))return!1;O=!0}}}}else{if(!O&&!Hi(m)&&!Hi(k))return!1;if(O&&Hi(k))continue;O=!1,m=k|1&m}}return Hi(m)||O}function Hi(l){return 0==(1&l)}function au(l,u,p,m){if(null===u)return-1;let v=0;if(m||!p){let M=!1;for(;v<u.length;){const O=u[v];if(O===l)return v;if(3===O||6===O)M=!0;else{if(1===O||2===O){let T=u[++v];for(;"string"==typeof T;)T=u[++v];continue}if(4===O)break;if(0===O){v+=4;continue}}v+=M?1:2}return-1}return function xs(l,u){let p=l.indexOf(4);if(p>-1)for(p++;p<l.length;){const m=l[p];if("number"==typeof m)return-1;if(m===u)return p;p++}return-1}(u,l)}function lu(l,u,p=!1){for(let m=0;m<u.length;m++)if(oa(l,u[m],p))return!0;return!1}function vi(l,u){return l?":not("+u.trim()+")":u}function cu(l){let u=l[0],p=1,m=2,v="",M=!1;for(;p<l.length;){let O=l[p];if("string"==typeof O)if(2&m){const T=l[++p];v+="["+O+(T.length>0?'="'+T+'"':"")+"]"}else 8&m?v+="."+O:4&m&&(v+=" "+O);else""!==v&&!Hi(O)&&(u+=vi(M,v),v=""),m=O,M=M||!Hi(m);p++}return""!==v&&(u+=vi(M,v)),u}function fd(l){return sr(()=>{const u=Vm(l),p={...u,decls:l.decls,vars:l.vars,template:l.template,consts:l.consts||null,ngContentSelectors:l.ngContentSelectors,onPush:l.changeDetection===ao.OnPush,directiveDefs:null,pipeDefs:null,dependencies:u.standalone&&l.dependencies||null,getStandaloneInjector:null,signals:l.signals??!1,data:l.data||{},encapsulation:l.encapsulation||qo.Emulated,styles:l.styles||zr,_:null,schemas:l.schemas||null,tView:null,id:""};ws(p);const m=l.dependencies;return p.directiveDefs=Ae(m,!1),p.pipeDefs=Ae(m,!0),p.id=function Tr(l){let u=0;const p=[l.selectors,l.ngContentSelectors,l.hostVars,l.hostAttrs,l.consts,l.vars,l.decls,l.encapsulation,l.standalone,l.signals,l.exportAs,JSON.stringify(l.inputs),JSON.stringify(l.outputs),Object.getOwnPropertyNames(l.type.prototype),!!l.contentQueries,!!l.viewQuery].join("|");for(const v of p)u=Math.imul(31,u)+v.charCodeAt(0)<<0;return u+=2147483648,"c"+u}(p),p})}function de(l){return Wn(l)||Go(l)}function Cn(l){return null!==l}function Ro(l){return sr(()=>({type:l.type,bootstrap:l.bootstrap||zr,declarations:l.declarations||zr,imports:l.imports||zr,exports:l.exports||zr,transitiveCompileScopes:null,schemas:l.schemas||null,id:l.id||null}))}function Fe(l,u){if(null==l)return Io;const p={};for(const m in l)if(l.hasOwnProperty(m)){let v=l[m],M=v;Array.isArray(v)&&(M=v[1],v=v[0]),p[v]=m,u&&(u[v]=M)}return p}function wc(l){return sr(()=>{const u=Vm(l);return ws(u),u})}function Zs(l){return{type:l.type,name:l.name,factory:null,pure:!1!==l.pure,standalone:!0===l.standalone,onDestroy:l.type.prototype.ngOnDestroy||null}}function Wn(l){return l[gl]||null}function Go(l){return l[ml]||null}function Yi(l){return l[mh]||null}function hi(l){const u=Wn(l)||Go(l)||Yi(l);return null!==u&&u.standalone}function Di(l,u){const p=l[su]||null;if(!p&&!0===u)throw new Error(`Type ${We(l)} does not have '\u0275mod' property.`);return p}function Vm(l){const u={};return{type:l.type,providersResolver:null,factory:null,hostBindings:l.hostBindings||null,hostVars:l.hostVars||0,hostAttrs:l.hostAttrs||null,contentQueries:l.contentQueries||null,declaredInputs:u,inputTransforms:null,inputConfig:l.inputs||Io,exportAs:l.exportAs||null,standalone:!0===l.standalone,signals:!0===l.signals,selectors:l.selectors||zr,viewQuery:l.viewQuery||null,features:l.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Fe(l.inputs,u),outputs:Fe(l.outputs)}}function ws(l){l.features?.forEach(u=>u(l))}function Ae(l,u){if(!l)return null;const p=u?Yi:de;return()=>("function"==typeof l?l():l).map(m=>p(m)).filter(Cn)}const Jr=0,dn=1,Ye=2,Do=3,Cs=4,$a=5,Zr=6,no=7,ki=8,Xi=9,pd=10,ar=11,Ws=12,Cc=13,xa=14,Wo=15,uu=16,Ga=17,fi=18,bn=19,Hf=20,ia=21,pi=22,Ri=23,sa=24,Yn=25,Bl=1,gd=2,Ms=7,Ul=9,zo=11;function bi(l){return Array.isArray(l)&&"object"==typeof l[Bl]}function Un(l){return Array.isArray(l)&&!0===l[Bl]}function hu(l){return 0!=(4&l.flags)}function _l(l){return l.componentOffset>-1}function Ha(l){return 1==(1&l.flags)}function la(l){return!!l.template}function fu(l){return 0!=(512&l[Ye])}function Vl(l,u){return l.hasOwnProperty(bs)?l[bs]:null}let qi=null,_d=!1;function Qi(l){const u=qi;return qi=l,u}const Ch={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function Li(l){if(!Hl(l)||l.dirty){if(!l.producerMustRecompute(l)&&!Pc(l))return void(l.dirty=!1);l.producerRecomputeValue(l),l.dirty=!1}}function Gm(l){l.dirty=!0,function fg(l){if(void 0===l.liveConsumerNode)return;const u=_d;_d=!0;try{for(const p of l.liveConsumerNode)p.dirty||Gm(p)}finally{_d=u}}(l),l.consumerMarkedDirty?.(l)}function jl(l){return l&&(l.nextProducerIndex=0),Qi(l)}function Za(l,u){if(Qi(u),l&&void 0!==l.producerNode&&void 0!==l.producerIndexOfThis&&void 0!==l.producerLastReadVersion){if(Hl(l))for(let p=l.nextProducerIndex;p<l.producerNode.length;p++)Wa(l.producerNode[p],l.producerIndexOfThis[p]);for(;l.producerNode.length>l.nextProducerIndex;)l.producerNode.pop(),l.producerLastReadVersion.pop(),l.producerIndexOfThis.pop()}}function Pc(l){Mh(l);for(let u=0;u<l.producerNode.length;u++){const p=l.producerNode[u],m=l.producerLastReadVersion[u];if(m!==p.version||(Li(p),m!==p.version))return!0}return!1}function $l(l){if(Mh(l),Hl(l))for(let u=0;u<l.producerNode.length;u++)Wa(l.producerNode[u],l.producerIndexOfThis[u]);l.producerNode.length=l.producerLastReadVersion.length=l.producerIndexOfThis.length=0,l.liveConsumerNode&&(l.liveConsumerNode.length=l.liveConsumerIndexOfThis.length=0)}function Wa(l,u){if(function Wf(l){l.liveConsumerNode??=[],l.liveConsumerIndexOfThis??=[]}(l),Mh(l),1===l.liveConsumerNode.length)for(let m=0;m<l.producerNode.length;m++)Wa(l.producerNode[m],l.producerIndexOfThis[m]);const p=l.liveConsumerNode.length-1;if(l.liveConsumerNode[u]=l.liveConsumerNode[p],l.liveConsumerIndexOfThis[u]=l.liveConsumerIndexOfThis[p],l.liveConsumerNode.length--,l.liveConsumerIndexOfThis.length--,u<l.liveConsumerNode.length){const m=l.liveConsumerIndexOfThis[u],v=l.liveConsumerNode[u];Mh(v),v.producerIndexOfThis[m]=u}}function Hl(l){return l.consumerIsAlwaysLive||(l?.liveConsumerNode?.length??0)>0}function Mh(l){l.producerNode??=[],l.producerIndexOfThis??=[],l.producerLastReadVersion??=[]}let Oh=null;function mg(l){const u=Qi(null);try{return l()}finally{Qi(u)}}const _u=()=>{},Ih=(()=>({...Ch,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:l=>{l.schedule(l.ref)},hasRun:!1,cleanupFn:_u}))();class wd{constructor(u,p,m){this.previousValue=u,this.currentValue=p,this.firstChange=m}isFirstChange(){return this.firstChange}}function Ec(){return Cd}function Cd(l){return l.type.prototype.ngOnChanges&&(l.setInput=Ym),Sh}function Sh(){const l=_g(this),u=l?.current;if(u){const p=l.previous;if(p===Io)l.previous=u;else for(let m in u)p[m]=u[m];l.current=null,this.ngOnChanges(u)}}function Ym(l,u,p,m){const v=this.declaredInputs[p],M=_g(l)||function Md(l,u){return l[vn]=u}(l,{previous:Io,current:null}),O=M.current||(M.current={}),T=M.previous,k=T[v];O[v]=new wd(k&&k.currentValue,u,T===Io),l[m]=u}Ec.ngInherit=!0;const vn="__ngSimpleChanges__";function _g(l){return l[vn]||null}const hs=function(l,u,p){},Tc="svg";function Bo(l){for(;Array.isArray(l);)l=l[Jr];return l}function yu(l,u){return Bo(u[l])}function Ji(l,u){return Bo(u[l.index])}function vu(l,u){return l.data[u]}function ua(l,u){const p=u[l];return bi(p)?p:p[Jr]}function Os(l,u){return null==u?null:l[u]}function Jf(l){l[Ga]=0}function tp(l){1024&l[Ye]||(l[Ye]|=1024,Ka(l,1))}function Pd(l){1024&l[Ye]&&(l[Ye]&=-1025,Ka(l,-1))}function Ka(l,u){let p=l[Do];if(null===p)return;p[$a]+=u;let m=p;for(p=p[Do];null!==p&&(1===u&&1===m[$a]||-1===u&&0===m[$a]);)p[$a]+=u,m=p,p=p[Do]}const lr={lFrame:xl(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Od(){return lr.bindingsEnabled}function Me(){return lr.lFrame.lView}function ro(){return lr.lFrame.tView}function yg(l){return lr.lFrame.contextLView=l,l[ki]}function Ed(l){return lr.lFrame.contextLView=null,l}function fs(){let l=t_();for(;null!==l&&64===l.type;)l=l.parent;return l}function t_(){return lr.lFrame.currentTNode}function Ya(l,u){const p=lr.lFrame;p.currentTNode=l,p.isParent=u}function kh(){return lr.lFrame.isParent}function Id(){return lr.lFrame.bindingIndex++}function Ma(l){const u=lr.lFrame,p=u.bindingIndex;return u.bindingIndex=u.bindingIndex+l,p}function Ky(l,u){const p=lr.lFrame;p.bindingIndex=p.bindingRootIndex=l,Dc(u)}function Dc(l){lr.lFrame.currentDirectiveIndex=l}function Wr(){return lr.lFrame.currentQueryIndex}function da(l){lr.lFrame.currentQueryIndex=l}function Ns(l){const u=l[dn];return 2===u.type?u.declTNode:1===u.type?l[Zr]:null}function Mu(l,u,p){if(p&yn.SkipSelf){let v=u,M=l;for(;!(v=v.parent,null!==v||p&yn.Host||(v=Ns(M),null===v||(M=M[xa],10&v.type))););if(null===v)return!1;u=v,l=M}const m=lr.lFrame=Rc();return m.currentTNode=u,m.lView=l,!0}function kc(l){const u=Rc(),p=l[dn];lr.lFrame=u,u.currentTNode=p.firstChild,u.lView=l,u.tView=p,u.contextLView=l,u.bindingIndex=p.bindingStartIndex,u.inI18n=!1}function Rc(){const l=lr.lFrame,u=null===l?null:l.child;return null===u?xl(l):u}function xl(l){const u={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:l,child:null,inI18n:!1};return null!==l&&(l.child=u),u}function n_(){const l=lr.lFrame;return lr.lFrame=l.parent,l.currentTNode=null,l.lView=null,l}const Pu=n_;function Ou(){const l=n_();l.isParent=!0,l.tView=null,l.selectedIndex=-1,l.contextLView=null,l.elementDepthCount=0,l.currentDirectiveIndex=-1,l.currentNamespace=null,l.bindingRootIndex=-1,l.bindingIndex=-1,l.currentQueryIndex=0}function oi(){return lr.lFrame.selectedIndex}function Eu(l){lr.lFrame.selectedIndex=l}function Xo(){const l=lr.lFrame;return vu(l.tView,l.selectedIndex)}function wl(){lr.lFrame.currentNamespace=Tc}function sp(){!function Es(){lr.lFrame.currentNamespace=null}()}let ts=!0;function Oa(){return ts}function $r(l){ts=l}function Yl(l,u){for(let p=u.directiveStart,m=u.directiveEnd;p<m;p++){const M=l.data[p].type.prototype,{ngAfterContentInit:O,ngAfterContentChecked:T,ngAfterViewInit:k,ngAfterViewChecked:N,ngOnDestroy:F}=M;O&&(l.contentHooks??=[]).push(-p,O),T&&((l.contentHooks??=[]).push(p,T),(l.contentCheckHooks??=[]).push(p,T)),k&&(l.viewHooks??=[]).push(-p,k),N&&((l.viewHooks??=[]).push(p,N),(l.viewCheckHooks??=[]).push(p,N)),null!=F&&(l.destroyHooks??=[]).push(p,F)}}function Sd(l,u,p){ap(l,u,3,p)}function Ts(l,u,p,m){(3&l[Ye])===p&&ap(l,u,p,m)}function ii(l,u){let p=l[Ye];(3&p)===u&&(p&=8191,p+=1,l[Ye]=p)}function ap(l,u,p,m){const M=m??-1,O=u.length-1;let T=0;for(let k=void 0!==m?65535&l[Ga]:0;k<O;k++)if("number"==typeof u[k+1]){if(T=u[k],null!=m&&T>=m)break}else u[k]<0&&(l[Ga]+=65536),(T<M||-1==M)&&(Tu(l,p,u,k),l[Ga]=(4294901760&l[Ga])+k+2),k++}function Xa(l,u){hs(4,l,u);const p=Qi(null);try{u.call(l)}finally{Qi(p),hs(5,l,u)}}function Tu(l,u,p,m){const v=p[m]<0,M=p[m+1],T=l[v?-p[m]:p[m]];v?l[Ye]>>13<l[Ga]>>16&&(3&l[Ye])===u&&(l[Ye]+=8192,Xa(T,M)):Xa(T,M)}const Lc=-1;class Lh{constructor(u,p,m){this.factory=u,this.resolving=!1,this.canSeeViewProviders=p,this.injectImpl=m}}function ha(l){return l!==Lc}function Xl(l){return 32767&l}function Qa(l,u){let p=function Dd(l){return l>>16}(l),m=u;for(;p>0;)m=m[xa],p--;return m}let kd=!0;function Ja(l){const u=kd;return kd=l,u}const Cl=255,up=5;let Cg=0;const Ys={};function Ml(l,u){const p=dp(l,u);if(-1!==p)return p;const m=u[dn];m.firstCreatePass&&(l.injectorIndex=u.length,Rd(m.data,l),Rd(u,null),Rd(m.blueprint,null));const v=Iu(l,u),M=l.injectorIndex;if(ha(v)){const O=Xl(v),T=Qa(v,u),k=T[dn].data;for(let N=0;N<8;N++)u[M+N]=T[O+N]|k[O+N]}return u[M+8]=v,M}function Rd(l,u){l.push(0,0,0,0,0,0,0,0,u)}function dp(l,u){return-1===l.injectorIndex||l.parent&&l.parent.injectorIndex===l.injectorIndex||null===u[l.injectorIndex+8]?-1:l.injectorIndex}function Iu(l,u){if(l.parent&&-1!==l.parent.injectorIndex)return l.parent.injectorIndex;let p=0,m=null,v=u;for(;null!==v;){if(m=Fi(v),null===m)return Lc;if(p++,v=v[xa],-1!==m.injectorIndex)return m.injectorIndex|p<<16}return Lc}function Ld(l,u,p){!function Mg(l,u,p){let m;"string"==typeof p?m=p.charCodeAt(0)||0:p.hasOwnProperty(Ua)&&(m=p[Ua]),null==m&&(m=p[Ua]=Cg++);const v=m&Cl;u.data[l+(v>>up)]|=1<<v}(l,u,p)}function zh(l,u,p){if(p&yn.Optional||void 0!==l)return l;us()}function Su(l,u,p,m){if(p&yn.Optional&&void 0===m&&(m=null),!(p&(yn.Self|yn.Host))){const v=l[Xi],M=Sn(void 0);try{return v?v.get(u,m,p&yn.Optional):jo(u,m,p&yn.Optional)}finally{Sn(M)}}return zh(m,0,p)}function Ea(l,u,p,m=yn.Default,v){if(null!==l){if(2048&u[Ye]&&!(m&yn.Self)){const O=function Pl(l,u,p,m,v){let M=l,O=u;for(;null!==M&&null!==O&&2048&O[Ye]&&!(512&O[Ye]);){const T=Nd(M,O,p,m|yn.Self,Ys);if(T!==Ys)return T;let k=M.parent;if(!k){const N=O[Hf];if(N){const F=N.get(p,Ys,m);if(F!==Ys)return F}k=Fi(O),O=O[xa]}M=k}return v}(l,u,p,m,Ys);if(O!==Ys)return O}const M=Nd(l,u,p,m,Ys);if(M!==Ys)return M}return Su(u,p,m,v)}function Nd(l,u,p,m,v){const M=function Bh(l){if("string"==typeof l)return l.charCodeAt(0)||0;const u=l.hasOwnProperty(Ua)?l[Ua]:void 0;return"number"==typeof u?u>=0?u&Cl:fa:u}(p);if("function"==typeof M){if(!Mu(u,l,m))return m&yn.Host?zh(v,0,m):Su(u,p,m,v);try{let O;if(O=M(m),null!=O||m&yn.Optional)return O;us()}finally{Pu()}}else if("number"==typeof M){let O=null,T=dp(l,u),k=Lc,N=m&yn.Host?u[Wo][Zr]:null;for((-1===T||m&yn.SkipSelf)&&(k=-1===T?Iu(l,u):u[T+8],k!==Lc&&fp(m,!1)?(O=u[dn],T=Xl(k),u=Qa(k,u)):T=-1);-1!==T;){const F=u[dn];if(Pg(M,T,F.data)){const $=hp(T,u,p,O,m,N);if($!==Ys)return $}k=u[T+8],k!==Lc&&fp(m,u[dn].data[T+8]===N)&&Pg(M,T,u)?(O=F,T=Xl(k),u=Qa(k,u)):T=-1}}return v}function hp(l,u,p,m,v,M){const O=u[dn],T=O.data[l+8],F=tl(T,O,p,null==m?_l(T)&&kd:m!=O&&0!=(3&T.type),v&yn.Host&&M===T);return null!==F?Fd(u,O,F,T):Ys}function tl(l,u,p,m,v){const M=l.providerIndexes,O=u.data,T=1048575&M,k=l.directiveStart,F=M>>20,q=v?T+F:l.directiveEnd;for(let Z=m?T:T+F;Z<q;Z++){const X=O[Z];if(Z<k&&p===X||Z>=k&&X.type===p)return Z}if(v){const Z=O[k];if(Z&&la(Z)&&Z.type===p)return k}return null}function Fd(l,u,p,m){let v=l[p];const M=u.data;if(function Ad(l){return l instanceof Lh}(v)){const O=v;O.resolving&&function Vo(l,u){const p=u?`. Dependency path: ${u.join(" > ")} > ${l}`:"";throw new Gt(-200,`Circular dependency in DI detected for ${l}${p}`)}(function en(l){return"function"==typeof l?l.name||l.toString():"object"==typeof l&&null!=l&&"function"==typeof l.type?l.type.name||l.type.toString():ge(l)}(M[p]));const T=Ja(O.canSeeViewProviders);O.resolving=!0;const N=O.injectImpl?Sn(O.injectImpl):null;Mu(l,m,yn.Default);try{v=l[p]=O.factory(void 0,M,l,m),u.firstCreatePass&&p>=m.directiveStart&&function Kl(l,u,p){const{ngOnChanges:m,ngOnInit:v,ngDoCheck:M}=u.type.prototype;if(m){const O=Cd(u);(p.preOrderHooks??=[]).push(l,O),(p.preOrderCheckHooks??=[]).push(l,O)}v&&(p.preOrderHooks??=[]).push(0-l,v),M&&((p.preOrderHooks??=[]).push(l,M),(p.preOrderCheckHooks??=[]).push(l,M))}(p,M[p],u)}finally{null!==N&&Sn(N),Ja(T),O.resolving=!1,Pu()}}return v}function Pg(l,u,p){return!!(p[u+(l>>up)]&1<<l)}function fp(l,u){return!(l&yn.Self||l&yn.Host&&u)}class es{constructor(u,p){this._tNode=u,this._lView=p}get(u,p,m){return Ea(this._tNode,this._lView,u,qs(m),p)}}function fa(){return new es(fs(),Me())}function Uh(l){return sr(()=>{const u=l.prototype.constructor,p=u[bs]||Ql(u),m=Object.prototype;let v=Object.getPrototypeOf(l.prototype).constructor;for(;v&&v!==m;){const M=v[bs]||Ql(v);if(M&&M!==p)return M;v=Object.getPrototypeOf(v)}return M=>new M})}function Ql(l){return me(l)?()=>{const u=Ql(Ce(l));return u&&u()}:Vl(l)}function Fi(l){const u=l[dn],p=u.type;return 2===p?u.declTNode:1===p?l[Zr]:null}function Jl(l){return function wi(l,u){if("class"===u)return l.classes;if("style"===u)return l.styles;const p=l.attrs;if(p){const m=p.length;let v=0;for(;v<m;){const M=p[v];if(cg(M))break;if(0===M)v+=2;else if("number"==typeof M)for(v++;v<m&&"string"==typeof p[v];)v++;else{if(M===u)return p[v+1];v+=2}}}return null}(fs(),l)}const De="__parameters__";function U(l,u,p){return sr(()=>{const m=function nc(l){return function(...p){if(l){const m=l(...p);for(const v in m)this[v]=m[v]}}}(u);function v(...M){if(this instanceof v)return m.apply(this,M),this;const O=new v(...M);return T.annotation=O,T;function T(k,N,F){const $=k.hasOwnProperty(De)?k[De]:Object.defineProperty(k,De,{value:[]})[De];for(;$.length<=F;)$.push(null);return($[F]=$[F]||[]).push(O),k}}return p&&(v.prototype=Object.create(p.prototype)),v.prototype.ngMetadataName=l,v.annotationCls=v,v})}function Zi(l,u){l.forEach(p=>Array.isArray(p)?Zi(p,u):u(p))}function Ia(l,u,p){u>=l.length?l.push(p):l.splice(u,0,p)}function Du(l,u){return u>=l.length-1?l.pop():l.splice(u,1)[0]}function Xs(l,u,p){let m=z(l,u);return m>=0?l[1|m]=p:(m=~m,function Og(l,u,p,m){let v=l.length;if(v==u)l.push(p,m);else if(1===v)l.push(m,l[0]),l[0]=p;else{for(v--,l.push(l[v-1],l[v]);v>u;)l[v]=l[v-2],v--;l[u]=p,l[u+1]=m}}(l,m,u,p)),m}function s_(l,u){const p=z(l,u);if(p>=0)return l[1|p]}function z(l,u){return function R(l,u,p){let m=0,v=l.length>>p;for(;v!==m;){const M=m+(v-m>>1),O=l[M<<p];if(u===O)return M<<p;O>u?v=M:m=M+1}return~(v<<p)}(l,u,1)}const ns=Vt(U("Optional"),8),jh=Vt(U("SkipSelf"),4);function xb(l){return 128==(128&l.flags)}var vw=function(l){return l[l.Important=1]="Important",l[l.DashCase=2]="DashCase",l}(vw||{});const dP=new Map;let bw=0;const Cb="__ngContext__";function Qs(l,u){bi(u)?(l[Cb]=u[bn],function DI(l){dP.set(l[bn],l)}(u)):l[Cb]=u}let gP;function Mb(l,u){return gP(l,u)}function Hh(l){const u=l[Do];return Un(u)?u[Do]:u}function Ol(l){return Lu(l[Ws])}function pr(l){return Lu(l[Cs])}function Lu(l){for(;null!==l&&!Un(l);)l=l[Cs];return l}function ga(l,u,p,m,v){if(null!=m){let M,O=!1;Un(m)?M=m:bi(m)&&(O=!0,m=m[Jr]);const T=Bo(m);0===l&&null!==p?null==v?Tb(u,p,T):po(u,p,T,v||null,!0):1===l&&null!==p?po(u,p,T,v||null,!0):2===l?function Wh(l,u,p){const m=Ig(l,u);m&&function Tg(l,u,p,m){l.removeChild(u,p,m)}(l,m,u,p)}(u,T,O):3===l&&u.destroyNode(T),null!=M&&function Ab(l,u,p,m,v){const M=p[Ms];M!==Bo(p)&&ga(u,l,m,M,v);for(let T=zo;T<p.length;T++){const k=p[T];m_(k[dn],k,l,u,m,M)}}(u,l,M,p,v)}}function Eb(l,u,p){return l.createElement(u,p)}function ww(l,u){const p=l[Ul],m=p.indexOf(u);Pd(u),p.splice(m,1)}function f_(l,u){if(l.length<=zo)return;const p=zo+u,m=l[p];if(m){const v=m[uu];null!==v&&v!==l&&ww(v,m),u>0&&(l[p-1][Cs]=m[Cs]);const M=Du(l,zo+u);!function _P(l,u){m_(l,u,u[ar],2,null,null),u[Jr]=null,u[Zr]=null}(m[dn],m);const O=M[fi];null!==O&&O.detachView(M[dn]),m[Do]=null,m[Cs]=null,m[Ye]&=-129}return m}function ko(l,u){if(!(256&u[Ye])){const p=u[ar];u[Ri]&&$l(u[Ri]),u[sa]&&$l(u[sa]),p.destroyNode&&m_(l,u,p,3,null,null),function co(l){let u=l[Ws];if(!u)return Is(l[dn],l);for(;u;){let p=null;if(bi(u))p=u[Ws];else{const m=u[zo];m&&(p=m)}if(!p){for(;u&&!u[Cs]&&u!==l;)bi(u)&&Is(u[dn],u),u=u[Do];null===u&&(u=l),bi(u)&&Is(u[dn],u),p=u&&u[Cs]}u=p}}(u)}}function Is(l,u){if(!(256&u[Ye])){u[Ye]&=-129,u[Ye]|=256,function p_(l,u){let p;if(null!=l&&null!=(p=l.destroyHooks))for(let m=0;m<p.length;m+=2){const v=u[p[m]];if(!(v instanceof Lh)){const M=p[m+1];if(Array.isArray(M))for(let O=0;O<M.length;O+=2){const T=v[M[O]],k=M[O+1];hs(4,T,k);try{k.call(T)}finally{hs(5,T,k)}}else{hs(4,v,M);try{M.call(v)}finally{hs(5,v,M)}}}}}(l,u),function gp(l,u){const p=l.cleanup,m=u[no];if(null!==p)for(let M=0;M<p.length-1;M+=2)if("string"==typeof p[M]){const O=p[M+3];O>=0?m[O]():m[-O].unsubscribe(),M+=2}else p[M].call(m[p[M+1]]);null!==m&&(u[no]=null);const v=u[ia];if(null!==v){u[ia]=null;for(let M=0;M<v.length;M++)(0,v[M])()}}(l,u),1===u[dn].type&&u[ar].destroy();const p=u[uu];if(null!==p&&Un(u[Do])){p!==u[Do]&&ww(p,u);const m=u[fi];null!==m&&m.detachView(l)}!function CT(l){dP.delete(l[bn])}(u)}}function Eg(l,u,p){return function zc(l,u,p){let m=u;for(;null!==m&&40&m.type;)m=(u=m).parent;if(null===m)return p[Jr];{const{componentOffset:v}=m;if(v>-1){const{encapsulation:M}=l.data[m.directiveStart+v];if(M===qo.None||M===qo.Emulated)return null}return Ji(m,p)}}(l,u.parent,p)}function po(l,u,p,m,v){l.insertBefore(u,p,m,v)}function Tb(l,u,p){l.appendChild(u,p)}function Nu(l,u,p,m,v){null!==m?po(l,u,p,m,v):Tb(l,u,p)}function Ig(l,u){return l.parentNode(u)}let g_,Rb,El,e0=function ol(l,u,p){return 40&l.type?Ji(l,p):null};function Bn(l,u,p,m){const v=Eg(l,m,u),M=u[ar],T=function Ib(l,u,p){return e0(l,u,p)}(m.parent||u[Zr],m,u);if(null!=v)if(Array.isArray(p))for(let k=0;k<p.length;k++)Nu(M,v,p[k],T,!1);else Nu(M,v,p,T,!1);void 0!==g_&&g_(M,m,u,p,v)}function Zh(l,u){if(null!==u){const p=u.type;if(3&p)return Ji(u,l);if(4&p)return Sb(-1,l[u.index]);if(8&p){const m=u.child;if(null!==m)return Zh(l,m);{const v=l[u.index];return Un(v)?Sb(-1,v):Bo(v)}}if(32&p)return Mb(u,l)()||Bo(l[u.index]);{const m=Jo(l,u);return null!==m?Array.isArray(m)?m[0]:Zh(Hh(l[Wo]),m):Zh(l,u.next)}}return null}function Jo(l,u){return null!==u?l[Wo][Zr].projection[u.projection]:null}function Sb(l,u){const p=zo+l+1;if(p<u.length){const m=u[p],v=m[dn].firstChild;if(null!==v)return Zh(m,v)}return u[Ms]}function mp(l,u,p,m,v,M,O){for(;null!=p;){const T=m[p.index],k=p.type;if(O&&0===u&&(T&&Qs(Bo(T),m),p.flags|=2),32!=(32&p.flags))if(8&k)mp(l,u,p.child,m,v,M,!1),ga(u,l,v,T,M);else if(32&k){const N=Mb(p,m);let F;for(;F=N();)ga(u,l,v,F,M);ga(u,l,v,T,M)}else 16&k?__(l,u,m,p,v,M):ga(u,l,v,T,M);p=O?p.projectionNext:p.next}}function m_(l,u,p,m,v,M){mp(p,m,l.firstChild,u,v,M,!1)}function __(l,u,p,m,v,M){const O=p[Wo],k=O[Zr].projection[m.projection];if(Array.isArray(k))for(let N=0;N<k.length;N++)ga(u,l,v,k[N],M);else{let N=k;const F=O[Do];xb(m)&&(N.flags|=128),mp(l,u,N,F,v,M,!0)}}function r0(l,u,p){""===p?l.removeAttribute(u,"class"):l.setAttribute(u,"class",p)}function Fu(l,u,p){const{mergedAttrs:m,classes:v,styles:M}=p;null!==m&&Zo(l,u,m),null!==v&&r0(l,u,v),null!==M&&function qn(l,u,p){l.setAttribute(u,"style",p)}(l,u,M)}function Pw(l){Rb=l}function il(l){return function Lb(){if(void 0===El&&(El=null,Ar.trustedTypes))try{El=Ar.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:l=>l,createScript:l=>l,createScriptURL:l=>l})}catch{}return El}()?.createScriptURL(l)||l}class o0{constructor(u){this.changingThisBreaksApplicationSecurity=u}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Ve})`}}function Yh(l){return l instanceof o0?l.changingThisBreaksApplicationSecurity:l}function b_(l,u){const p=function Ow(l){return l instanceof o0&&l.getTypeName()||null}(l);if(null!=p&&p!==u){if("ResourceURL"===p&&"URL"===u)return!0;throw new Error(`Required a safe ${u}, got a ${p} (see ${Ve})`)}return p===u}const Bb=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var bp=function(l){return l[l.NONE=0]="NONE",l[l.HTML=1]="HTML",l[l.STYLE=2]="STYLE",l[l.SCRIPT=3]="SCRIPT",l[l.URL=4]="URL",l[l.RESOURCE_URL=5]="RESOURCE_URL",l}(bp||{});function Zb(l){const u=xp();return u?u.sanitize(bp.URL,l)||"":b_(l,"URL")?Yh(l):function C_(l){return(l=String(l)).match(Bb)?l:"unsafe:"+l}(ge(l))}function Sg(l){const u=xp();if(u)return il(u.sanitize(bp.RESOURCE_URL,l)||"");if(b_(l,"ResourceURL"))return il(Yh(l));throw new Gt(904,!1)}function Zn(l,u,p){return function Ag(l,u){return"src"===u&&("embed"===l||"frame"===l||"iframe"===l||"media"===l||"script"===l)||"href"===u&&("base"===l||"link"===l)?Sg:Zb}(u,p)(l)}function xp(){const l=Me();return l&&l[pd].sanitizer}const Qh=new er("ENVIRONMENT_INITIALIZER"),l0=new er("INJECTOR",-1),Xb=new er("INJECTOR_DEF_TYPES");class c0{get(u,p=at){if(p===at){const m=new Error(`NullInjectorError: No provider for ${We(u)}!`);throw m.name="NullInjectorError",m}return p}}function u0(l){return{\u0275providers:l}}function OP(...l){return{\u0275providers:Dg(0,l),\u0275fromNgModule:!0}}function Dg(l,...u){const p=[],m=new Set;let v;const M=O=>{p.push(O)};return Zi(u,O=>{const T=O;kg(T,M,[],m)&&(v||=[],v.push(T))}),void 0!==v&&Qb(v,M),p}function Qb(l,u){for(let p=0;p<l.length;p++){const{ngModule:m,providers:v}=l[p];kr(v,M=>{u(M,m)})}}function kg(l,u,p,m){if(!(l=Ce(l)))return!1;let v=null,M=Xe(l);const O=!M&&Wn(l);if(M||O){if(O&&!O.standalone)return!1;v=l}else{const k=l.ngModule;if(M=Xe(k),!M)return!1;v=k}const T=m.has(v);if(O){if(T)return!1;if(m.add(v),O.dependencies){const k="function"==typeof O.dependencies?O.dependencies():O.dependencies;for(const N of k)kg(N,u,p,m)}}else{if(!M)return!1;{if(null!=M.imports&&!T){let N;m.add(v);try{Zi(M.imports,F=>{kg(F,u,p,m)&&(N||=[],N.push(F))})}finally{}void 0!==N&&Qb(N,u)}if(!T){const N=Vl(v)||(()=>new v);u({provide:v,useFactory:N,deps:zr},v),u({provide:Xb,useValue:v,multi:!0},v),u({provide:Qh,useValue:()=>or(v),multi:!0},v)}const k=M.providers;if(null!=k&&!T){const N=l;kr(k,F=>{u(F,N)})}}}return v!==l&&void 0!==l.providers}function kr(l,u){for(let p of l)tt(p)&&(p=p.\u0275providers),Array.isArray(p)?kr(p,u):u(p)}const Sw=re({provide:String,useValue:re});function Aw(l){return null!==l&&"object"==typeof l&&Sw in l}function wp(l){return"function"==typeof l}const Jh=new er("Set Injector scope."),bt={},Jb={};let Bi;function d0(){return void 0===Bi&&(Bi=new c0),Bi}class So{}class tf extends So{get destroyed(){return this._destroyed}constructor(u,p,m,v){super(),this.parent=p,this.source=m,this.scopes=v,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Mp(u,O=>this.processProvider(O)),this.records.set(l0,T_(void 0,this)),v.has("environment")&&this.records.set(So,T_(void 0,this));const M=this.records.get(Jh);null!=M&&"string"==typeof M.value&&this.scopes.add(M.value),this.injectorDefTypes=new Set(this.get(Xb.multi,zr,yn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const p of this._ngOnDestroyHooks)p.ngOnDestroy();const u=this._onDestroyHooks;this._onDestroyHooks=[];for(const p of u)p()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(u){return this.assertNotDestroyed(),this._onDestroyHooks.push(u),()=>this.removeOnDestroy(u)}runInContext(u){this.assertNotDestroyed();const p=Qr(this),m=Sn(void 0);try{return u()}finally{Qr(p),Sn(m)}}get(u,p=at,m=yn.Default){if(this.assertNotDestroyed(),u.hasOwnProperty(lg))return u[lg](this);m=qs(m);const M=Qr(this),O=Sn(void 0);try{if(!(m&yn.SkipSelf)){let k=this.records.get(u);if(void 0===k){const N=function Cp(l){return"function"==typeof l||"object"==typeof l&&l instanceof er}(u)&&ie(u);k=N&&this.injectableDefInScope(N)?T_(dt(u),bt):null,this.records.set(u,k)}if(null!=k)return this.hydrate(u,k)}return(m&yn.Self?d0():this.parent).get(u,p=m&yn.Optional&&p===at?null:p)}catch(T){if("NullInjectorError"===T.name){if((T[Bt]=T[Bt]||[]).unshift(We(u)),M)throw T;return function zn(l,u,p,m){const v=l[Bt];throw u[Nn]&&v.unshift(u[Nn]),l.message=function vr(l,u,p,m=null){l=l&&"\n"===l.charAt(0)&&"\u0275"==l.charAt(1)?l.slice(2):l;let v=We(u);if(Array.isArray(u))v=u.map(We).join(" -> ");else if("object"==typeof u){let M=[];for(let O in u)if(u.hasOwnProperty(O)){let T=u[O];M.push(O+":"+("string"==typeof T?JSON.stringify(T):We(T)))}v=`{${M.join(", ")}}`}return`${p}${m?"("+m+")":""}[${v}]: ${l.replace(ee,"\n  ")}`}("\n"+l.message,v,p,m),l.ngTokenPath=v,l[Bt]=null,l}(T,u,"R3InjectorError",this.source)}throw T}finally{Sn(O),Qr(M)}}resolveInjectorInitializers(){const u=Qr(this),p=Sn(void 0);try{const v=this.get(Qh.multi,zr,yn.Self);for(const M of v)M()}finally{Qr(u),Sn(p)}}toString(){const u=[],p=this.records;for(const m of p.keys())u.push(We(m));return`R3Injector[${u.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Gt(205,!1)}processProvider(u){let p=wp(u=Ce(u))?u:Ce(u&&u.provide);const m=function EP(l){return Aw(l)?T_(void 0,l.useValue):T_(Vc(l),bt)}(u);if(wp(u)||!0!==u.multi)this.records.get(p);else{let v=this.records.get(p);v||(v=T_(void 0,bt,!0),v.factory=()=>ne(v.multi),this.records.set(p,v)),p=u,v.multi.push(u)}this.records.set(p,m)}hydrate(u,p){return p.value===bt&&(p.value=Jb,p.value=p.factory()),"object"==typeof p.value&&p.value&&function TP(l){return null!==l&&"object"==typeof l&&"function"==typeof l.ngOnDestroy}(p.value)&&this._ngOnDestroyHooks.add(p.value),p.value}injectableDefInScope(u){if(!u.providedIn)return!1;const p=Ce(u.providedIn);return"string"==typeof p?"any"===p||this.scopes.has(p):this.injectorDefTypes.has(p)}removeOnDestroy(u){const p=this._onDestroyHooks.indexOf(u);-1!==p&&this._onDestroyHooks.splice(p,1)}}function dt(l){const u=ie(l),p=null!==u?u.factory:Vl(l);if(null!==p)return p;if(l instanceof er)throw new Gt(204,!1);if(l instanceof Function)return function h0(l){const u=l.length;if(u>0)throw function Vh(l,u){const p=[];for(let m=0;m<l;m++)p.push(u);return p}(u,"?"),new Gt(204,!1);const p=function ae(l){return l&&(l[Ze]||l[gn])||null}(l);return null!==p?()=>p.factory(l):()=>new l}(l);throw new Gt(204,!1)}function Vc(l,u,p){let m;if(wp(l)){const v=Ce(l);return Vl(v)||dt(v)}if(Aw(l))m=()=>Ce(l.useValue);else if(function Dw(l){return!(!l||!l.useFactory)}(l))m=()=>l.useFactory(...ne(l.deps||[]));else if(function Rg(l){return!(!l||!l.useExisting)}(l))m=()=>or(Ce(l.useExisting));else{const v=Ce(l&&(l.useClass||l.provide));if(!function t1(l){return!!l.deps}(l))return Vl(v)||dt(v);m=()=>new v(...ne(l.deps))}return m}function T_(l,u,p=!1){return{factory:l,value:u,multi:p?[]:void 0}}function Mp(l,u){for(const p of l)Array.isArray(p)?Mp(p,u):p&&tt(p)?Mp(p.\u0275providers,u):u(p)}const ef=new er("AppId",{providedIn:"root",factory:()=>ic}),ic="ng",f0=new er("Platform Initializer"),Ir=new er("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),IP=new er("AnimationModuleType"),e1=new er("CSP nonce",{providedIn:"root",factory:()=>function yp(){if(void 0!==Rb)return Rb;if(typeof document<"u")return document;throw new Gt(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Po=(l,u,p)=>null;function s1(l,u,p=!1){return Po(l,u,p)}class k_{}class c1{}class m0{resolveComponentFactory(u){throw function u1(l){const u=Error(`No component factory found for ${We(l)}.`);return u.ngComponent=l,u}(u)}}let _0=(()=>{class l{static#t=this.NULL=new m0}return l})();function kP(){return Vu(fs(),Me())}function Vu(l,u){return new Lg(Ji(l,u))}let Lg=(()=>{class l{constructor(p){this.nativeElement=p}static#t=this.__NG_ELEMENT_ID__=kP}return l})();function y0(l){return l instanceof Lg?l.nativeElement:l}class v0{}let Lw=(()=>{class l{constructor(){this.destroyNode=null}static#t=this.__NG_ELEMENT_ID__=()=>function RP(){const l=Me(),p=ua(fs().index,l);return(bi(p)?p:l)[ar]}()}return l})(),d1=(()=>{class l{static#t=this.\u0275prov=nt({token:l,providedIn:"root",factory:()=>null})}return l})();class Ep{constructor(u){this.full=u,this.major=u.split(".")[0],this.minor=u.split(".")[1],this.patch=u.split(".").slice(2).join(".")}}const b0=new Ep("16.2.12"),Da={};function w0(l,u=null,p=null,m){const v=go(l,u,p,m);return v.resolveInjectorInitializers(),v}function go(l,u=null,p=null,m,v=new Set){const M=[p||zr,OP(l)];return m=m||("object"==typeof l?void 0:We(l)),new tf(M,u||d0(),m||null,v)}let ac=(()=>{class l{static#t=this.THROW_IF_NOT_FOUND=at;static#e=this.NULL=new c0;static create(p,m){if(Array.isArray(p))return w0({name:""},m,p,"");{const v=p.name??"";return w0({name:v},p.parent,p.providers,v)}}static#n=this.\u0275prov=nt({token:l,providedIn:"any",factory:()=>or(l0)});static#r=this.__NG_ELEMENT_ID__=-1}return l})();function R_(l){return l.ngOriginalError}class ju{constructor(){this._console=console}handleError(u){const p=this._findOriginalError(u);this._console.error("ERROR",u),p&&this._console.error("ORIGINAL ERROR",p)}_findOriginalError(u){let p=u&&R_(u);for(;p&&R_(p);)p=R_(p);return p||null}}function Tl(l){return u=>{setTimeout(l,void 0,u)}}const Eo=class jd extends x.x{constructor(u=!1){super(),this.__isAsync=u}emit(u){super.next(u)}subscribe(u,p,m){let v=u,M=p||(()=>null),O=m;if(u&&"object"==typeof u){const k=u;v=k.next?.bind(k),M=k.error?.bind(k),O=k.complete?.bind(k)}this.__isAsync&&(M=Tl(M),v&&(v=Tl(v)),O&&(O=Tl(O)));const T=super.subscribe({next:v,error:M,complete:O});return u instanceof mt.w0&&u.add(T),T}};function jc(...l){}class Wi{constructor({enableLongStackTrace:u=!1,shouldCoalesceEventChangeDetection:p=!1,shouldCoalesceRunChangeDetection:m=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Eo(!1),this.onMicrotaskEmpty=new Eo(!1),this.onStable=new Eo(!1),this.onError=new Eo(!1),typeof Zone>"u")throw new Gt(908,!1);Zone.assertZonePatched();const v=this;v._nesting=0,v._outer=v._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(v._inner=v._inner.fork(new Zone.TaskTrackingZoneSpec)),u&&Zone.longStackTraceZoneSpec&&(v._inner=v._inner.fork(Zone.longStackTraceZoneSpec)),v.shouldCoalesceEventChangeDetection=!m&&p,v.shouldCoalesceRunChangeDetection=m,v.lastRequestAnimationFrameId=-1,v.nativeRequestAnimationFrame=function Ng(){const l="function"==typeof Ar.requestAnimationFrame;let u=Ar[l?"requestAnimationFrame":"setTimeout"],p=Ar[l?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&u&&p){const m=u[Zone.__symbol__("OriginalDelegate")];m&&(u=m);const v=p[Zone.__symbol__("OriginalDelegate")];v&&(p=v)}return{nativeRequestAnimationFrame:u,nativeCancelAnimationFrame:p}}().nativeRequestAnimationFrame,function ET(l){const u=()=>{!function NP(l){l.isCheckStableRunning||-1!==l.lastRequestAnimationFrameId||(l.lastRequestAnimationFrameId=l.nativeRequestAnimationFrame.call(Ar,()=>{l.fakeTopEventTask||(l.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{l.lastRequestAnimationFrameId=-1,zg(l),l.isCheckStableRunning=!0,Ip(l),l.isCheckStableRunning=!1},void 0,()=>{},()=>{})),l.fakeTopEventTask.invoke()}),zg(l))}(l)};l._inner=l._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(p,m,v,M,O,T)=>{if(function zP(l){return!(!Array.isArray(l)||1!==l.length)&&!0===l[0].data?.__ignore_ng_zone__}(T))return p.invokeTask(v,M,O,T);try{return FP(l),p.invokeTask(v,M,O,T)}finally{(l.shouldCoalesceEventChangeDetection&&"eventTask"===M.type||l.shouldCoalesceRunChangeDetection)&&u(),f1(l)}},onInvoke:(p,m,v,M,O,T,k)=>{try{return FP(l),p.invoke(v,M,O,T,k)}finally{l.shouldCoalesceRunChangeDetection&&u(),f1(l)}},onHasTask:(p,m,v,M)=>{p.hasTask(v,M),m===v&&("microTask"==M.change?(l._hasPendingMicrotasks=M.microTask,zg(l),Ip(l)):"macroTask"==M.change&&(l.hasPendingMacrotasks=M.macroTask))},onHandleError:(p,m,v,M)=>(p.handleError(v,M),l.runOutsideAngular(()=>l.onError.emit(M)),!1)})}(v)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Wi.isInAngularZone())throw new Gt(909,!1)}static assertNotInAngularZone(){if(Wi.isInAngularZone())throw new Gt(909,!1)}run(u,p,m){return this._inner.run(u,p,m)}runTask(u,p,m,v){const M=this._inner,O=M.scheduleEventTask("NgZoneEvent: "+v,u,Bw,jc,jc);try{return M.runTask(O,p,m)}finally{M.cancelTask(O)}}runGuarded(u,p,m){return this._inner.runGuarded(u,p,m)}runOutsideAngular(u){return this._outer.run(u)}}const Bw={};function Ip(l){if(0==l._nesting&&!l.hasPendingMicrotasks&&!l.isStable)try{l._nesting++,l.onMicrotaskEmpty.emit(null)}finally{if(l._nesting--,!l.hasPendingMicrotasks)try{l.runOutsideAngular(()=>l.onStable.emit(null))}finally{l.isStable=!0}}}function zg(l){l.hasPendingMicrotasks=!!(l._hasPendingMicrotasks||(l.shouldCoalesceEventChangeDetection||l.shouldCoalesceRunChangeDetection)&&-1!==l.lastRequestAnimationFrameId)}function FP(l){l._nesting++,l.isStable&&(l.isStable=!1,l.onUnstable.emit(null))}function f1(l){l._nesting--,Ip(l)}class Uw{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Eo,this.onMicrotaskEmpty=new Eo,this.onStable=new Eo,this.onError=new Eo}run(u,p,m){return u.apply(p,m)}runGuarded(u,p,m){return u.apply(p,m)}runOutsideAngular(u){return u()}runTask(u,p,m,v){return u.apply(p,m)}}const Vw=new er("",{providedIn:"root",factory:$c});function $c(){const l=ir(Wi);let u=!0;const p=new It.y(v=>{u=l.isStable&&!l.hasPendingMacrotasks&&!l.hasPendingMicrotasks,l.runOutsideAngular(()=>{v.next(u),v.complete()})}),m=new It.y(v=>{let M;l.runOutsideAngular(()=>{M=l.onStable.subscribe(()=>{Wi.assertNotInAngularZone(),queueMicrotask(()=>{!u&&!l.hasPendingMacrotasks&&!l.hasPendingMicrotasks&&(u=!0,v.next(!0))})})});const O=l.onUnstable.subscribe(()=>{Wi.assertInAngularZone(),u&&(u=!1,l.runOutsideAngular(()=>{v.next(!1)}))});return()=>{M.unsubscribe(),O.unsubscribe()}});return(0,vt.T)(p,m.pipe((0,ke.B)()))}function BP(l){return l.ownerDocument.defaultView}function _a(l){return l instanceof Function?l():l}let lc=(()=>{class l{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static#t=this.\u0275prov=nt({token:l,providedIn:"root",factory:()=>new l})}return l})();function Sp(l){for(;l;){l[Ye]|=64;const u=Hh(l);if(fu(l)&&!u)return l;l=u}return null}const UP=new er("",{providedIn:"root",factory:()=>!1});let Gw=null;function $P(l,u){return l[u]??L_()}function Hw(l,u){const p=L_();p.producerNode?.length&&(l[u]=Gw,p.lView=l,Gw=uf())}const Br={...Ch,consumerIsAlwaysLive:!0,consumerMarkedDirty:l=>{Sp(l.lView)},lView:null};function uf(){return Object.create(Br)}function L_(){return Gw??=uf(),Gw}const An={};function Rn(l){$d(ro(),Me(),oi()+l,!1)}function $d(l,u,p,m){if(!m)if(3==(3&u[Ye])){const M=l.preOrderCheckHooks;null!==M&&Sd(u,M,p)}else{const M=l.preOrderHooks;null!==M&&Ts(u,M,0,p)}Eu(p)}function io(l,u=yn.Default){const p=Me();return null===p?or(l,u):Ea(fs(),p,Ce(l),u)}function GP(){throw new Error("invalid")}function hn(l,u,p,m,v,M,O,T,k,N,F){const $=u.blueprint.slice();return $[Jr]=v,$[Ye]=140|m,(null!==N||l&&2048&l[Ye])&&($[Ye]|=2048),Jf($),$[Do]=$[xa]=l,$[ki]=p,$[pd]=O||l&&l[pd],$[ar]=T||l&&l[ar],$[Xi]=k||l&&l[Xi]||null,$[Zr]=M,$[bn]=function wT(){return bw++}(),$[pi]=F,$[Hf]=N,$[Wo]=2==u.type?l[Wo]:$,$}function df(l,u,p,m,v){let M=l.data[u];if(null===M)M=function M0(l,u,p,m,v){const M=t_(),O=kh(),k=l.data[u]=function B_(l,u,p,m,v,M){let O=u?u.injectorIndex:-1,T=0;return function Cu(){return null!==lr.skipHydrationRootTNode}()&&(T|=128),{type:p,index:m,insertBeforeIndex:null,injectorIndex:O,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:T,providerIndexes:0,value:v,attrs:M,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:u,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,O?M:M&&M.parent,p,u,m,v);return null===l.firstChild&&(l.firstChild=k),null!==M&&(O?null==M.child&&null!==k.parent&&(M.child=k):null===M.next&&(M.next=k,k.prev=M)),k}(l,u,p,m,v),function e_(){return lr.lFrame.inI18n}()&&(M.flags|=32);else if(64&M.type){M.type=p,M.value=m,M.attrs=v;const O=function rp(){const l=lr.lFrame,u=l.currentTNode;return l.isParent?u:u.parent}();M.injectorIndex=null===O?-1:O.injectorIndex}return Ya(M,!0),M}function Gu(l,u,p,m){if(0===p)return-1;const v=u.length;for(let M=0;M<p;M++)u.push(m),l.blueprint.push(m),l.data.push(null);return v}function m1(l,u,p,m,v){const M=$P(u,Ri),O=oi(),T=2&m;try{Eu(-1),T&&u.length>Yn&&$d(l,u,Yn,!1),hs(T?2:0,v);const N=T?M:null,F=jl(N);try{null!==N&&(N.dirty=!1),p(m,v)}finally{Za(N,F)}}finally{T&&null===u[Ri]&&Hw(u,Ri),Eu(O),hs(T?3:1,v)}}function N_(l,u,p){if(hu(u)){const m=Qi(null);try{const M=u.directiveEnd;for(let O=u.directiveStart;O<M;O++){const T=l.data[O];T.contentQueries&&T.contentQueries(1,p[O],O)}}finally{Qi(m)}}}function Ap(l,u,p){Od()&&(function I0(l,u,p,m){const v=p.directiveStart,M=p.directiveEnd;_l(p)&&function IT(l,u,p){const m=Ji(u,l),v=Oi(p);let O=16;p.signals?O=4096:p.onPush&&(O=64);const T=$g(l,hn(l,v,null,O,m,u,null,l[pd].rendererFactory.createRenderer(m,p),null,null,null));l[u.index]=T}(u,p,l.data[v+p.componentOffset]),l.firstCreatePass||Ml(p,u),Qs(m,u);const O=p.initialInputs;for(let T=v;T<M;T++){const k=l.data[T],N=Fd(u,l,T,p);Qs(N,u),null!==O&&ST(0,T-v,N,k,0,O),la(k)&&(ua(p.index,u)[ki]=Fd(u,l,T,p))}}(l,u,p,Ji(p,u)),64==(64&p.flags)&&Zw(l,u,p))}function Bg(l,u,p=Ji){const m=u.localNames;if(null!==m){let v=u.index+1;for(let M=0;M<m.length;M+=2){const O=m[M+1],T=-1===O?p(u,l):l[O];l[v++]=T}}}function Oi(l){const u=l.tView;return null===u||u.incompleteFirstPass?l.tView=Ug(1,null,l.template,l.decls,l.vars,l.directiveDefs,l.pipeDefs,l.viewQuery,l.schemas,l.consts,l.id):u}function Ug(l,u,p,m,v,M,O,T,k,N,F){const $=Yn+m,q=$+v,Z=function Sl(l,u){const p=[];for(let m=0;m<u;m++)p.push(m<l?null:An);return p}($,q),X="function"==typeof N?N():N;return Z[dn]={type:l,blueprint:Z,template:p,queries:null,viewQuery:T,declTNode:u,data:Z.slice().fill(null,$),bindingStartIndex:$,expandoStartIndex:q,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof M?M():M,pipeRegistry:"function"==typeof O?O():O,firstChild:null,schemas:k,consts:X,incompleteFirstPass:!1,ssrId:F}}let z_=l=>null;function Al(l,u,p,m){for(let v in l)if(l.hasOwnProperty(v)){p=null===p?{}:p;const M=l[v];null===m?O0(p,u,v,M):m.hasOwnProperty(v)&&O0(p,u,m[v],M)}return p}function O0(l,u,p,m){l.hasOwnProperty(p)?l[p].push(u,m):l[p]=[u,m]}function qw(l,u,p,m){if(Od()){const v=null===m?null:{"":-1},M=function y1(l,u){const p=l.directiveRegistry;let m=null,v=null;if(p)for(let M=0;M<p.length;M++){const O=p[M];if(lu(u,O.selectors,!1))if(m||(m=[]),la(O))if(null!==O.findHostDirectiveDefs){const T=[];v=v||new Map,O.findHostDirectiveDefs(O,T,v),m.unshift(...T,O),v1(l,u,T.length)}else m.unshift(O),v1(l,u,0);else v=v||new Map,O.findHostDirectiveDefs?.(O,m,v),m.push(O)}return null===m?null:[m,v]}(l,p);let O,T;null===M?O=T=null:[O,T]=M,null!==O&&qP(l,u,p,O,v,T),v&&function Hu(l,u,p){if(u){const m=l.localNames=[];for(let v=0;v<u.length;v+=2){const M=p[u[v+1]];if(null==M)throw new Gt(-301,!1);m.push(u[v],M)}}}(p,m,v)}p.mergedAttrs=ud(p.mergedAttrs,p.attrs)}function qP(l,u,p,m,v,M){for(let N=0;N<m.length;N++)Ld(Ml(p,u),l,m[N].type);!function b1(l,u,p){l.flags|=1,l.directiveStart=u,l.directiveEnd=u+p,l.providerIndexes=u}(p,l.data.length,m.length);for(let N=0;N<m.length;N++){const F=m[N];F.providersResolver&&F.providersResolver(F)}let O=!1,T=!1,k=Gu(l,u,m.length,null);for(let N=0;N<m.length;N++){const F=m[N];p.mergedAttrs=ud(p.mergedAttrs,F.hostAttrs),ZP(l,p,u,k,F),jg(k,F,v),null!==F.contentQueries&&(p.flags|=4),(null!==F.hostBindings||null!==F.hostAttrs||0!==F.hostVars)&&(p.flags|=64);const $=F.type.prototype;!O&&($.ngOnChanges||$.ngOnInit||$.ngDoCheck)&&((l.preOrderHooks??=[]).push(p.index),O=!0),!T&&($.ngOnChanges||$.ngDoCheck)&&((l.preOrderCheckHooks??=[]).push(p.index),T=!0),k++}!function Vg(l,u,p){const v=u.directiveEnd,M=l.data,O=u.attrs,T=[];let k=null,N=null;for(let F=u.directiveStart;F<v;F++){const $=M[F],q=p?p.get($):null,X=q?q.outputs:null;k=Al($.inputs,F,k,q?q.inputs:null),N=Al($.outputs,F,N,X);const K=null===k||null===O||Mn(u)?null:AT(k,F,O);T.push(K)}null!==k&&(k.hasOwnProperty("class")&&(u.flags|=8),k.hasOwnProperty("style")&&(u.flags|=16)),u.initialInputs=T,u.inputs=k,u.outputs=N}(l,p,M)}function Zw(l,u,p){const m=p.directiveStart,v=p.directiveEnd,M=p.index,O=function Ac(){return lr.lFrame.currentDirectiveIndex}();try{Eu(M);for(let T=m;T<v;T++){const k=l.data[T],N=u[T];Dc(T),(null!==k.hostBindings||0!==k.hostVars||null!==k.hostAttrs)&&Ra(k,N)}}finally{Eu(-1),Dc(O)}}function Ra(l,u){null!==l.hostBindings&&l.hostBindings(1,u)}function v1(l,u,p){u.componentOffset=p,(l.components??=[]).push(u.index)}function jg(l,u,p){if(p){if(u.exportAs)for(let m=0;m<u.exportAs.length;m++)p[u.exportAs[m]]=l;la(u)&&(p[""]=l)}}function ZP(l,u,p,m,v){l.data[m]=v;const M=v.factory||(v.factory=Vl(v.type)),O=new Lh(M,la(v),io);l.blueprint[m]=O,p[m]=O,function cc(l,u,p,m,v){const M=v.hostBindings;if(M){let O=l.hostBindingOpCodes;null===O&&(O=l.hostBindingOpCodes=[]);const T=~u.index;(function T0(l){let u=l.length;for(;u>0;){const p=l[--u];if("number"==typeof p&&p<0)return p}return 0})(O)!=T&&O.push(T),O.push(p,m,M)}}(l,u,m,Gu(l,p,v.hostVars,An),v)}function qu(l,u,p,m,v,M){const O=Ji(l,u);!function x1(l,u,p,m,v,M,O){if(null==M)l.removeAttribute(u,v,p);else{const T=null==O?ge(M):O(M,m||"",v);l.setAttribute(u,v,T,p)}}(u[ar],O,M,l.value,p,m,v)}function ST(l,u,p,m,v,M){const O=M[u];if(null!==O)for(let T=0;T<O.length;)WP(m,p,O[T++],O[T++],O[T++])}function WP(l,u,p,m,v){const M=Qi(null);try{const O=l.inputTransforms;null!==O&&O.hasOwnProperty(m)&&(v=O[m].call(u,v)),null!==l.setInput?l.setInput(u,v,p,m):u[m]=v}finally{Qi(M)}}function AT(l,u,p){let m=null,v=0;for(;v<p.length;){const M=p[v];if(0!==M)if(5!==M){if("number"==typeof M)break;if(l.hasOwnProperty(M)){null===m&&(m=[]);const O=l[M];for(let T=0;T<O.length;T+=2)if(O[T]===u){m.push(M,O[T+1],p[v+1]);break}}v+=2}else v+=2;else v+=4}return m}function w1(l,u,p,m){return[l,!0,!1,u,null,0,m,p,null,null,null]}function S0(l,u){const p=l.contentQueries;if(null!==p)for(let m=0;m<p.length;m+=2){const M=p[m+1];if(-1!==M){const O=l.data[M];da(p[m]),O.contentQueries(2,u[M],M)}}}function $g(l,u){return l[Ws]?l[Cc][Cs]=u:l[Ws]=u,l[Cc]=u,u}function C1(l,u,p){da(0);const m=Qi(null);try{u(l,p)}finally{Qi(m)}}function Ww(l){return l[no]||(l[no]=[])}function A0(l){return l.cleanup||(l.cleanup=[])}function M1(l,u){const p=l[Xi],m=p?p.get(ju,null):null;m&&m.handleError(u)}function D0(l,u,p,m,v){for(let M=0;M<p.length;){const O=p[M++],T=p[M++];WP(l.data[O],u[O],m,T,v)}}function Gd(l,u,p){const m=yu(u,l);!function Ob(l,u,p){l.setValue(u,p)}(l[ar],m,p)}function Hd(l,u){const p=ua(u,l),m=p[dn];!function Gg(l,u){for(let p=u.length;p<l.blueprint.length;p++)u.push(l.blueprint[p])}(m,p);const v=p[Jr];null!==v&&null===p[pi]&&(p[pi]=s1(v,p[Xi])),P1(m,p,p[ki])}function P1(l,u,p){kc(u);try{const m=l.viewQuery;null!==m&&C1(1,m,p);const v=l.template;null!==v&&m1(l,u,v,1,p),l.firstCreatePass&&(l.firstCreatePass=!1),l.staticContentQueries&&S0(l,u),l.staticViewQueries&&C1(2,l.viewQuery,p);const M=l.components;null!==M&&function Kw(l,u){for(let p=0;p<u.length;p++)Hd(l,u[p])}(u,M)}catch(m){throw l.firstCreatePass&&(l.incompleteFirstPass=!0,l.firstCreatePass=!1),m}finally{u[Ye]&=-5,Ou()}}let zs=(()=>{class l{constructor(){this.all=new Set,this.queue=new Map}create(p,m,v){const M=typeof Zone>"u"?null:Zone.current,O=function mu(l,u,p){const m=Object.create(Ih);p&&(m.consumerAllowSignalWrites=!0),m.fn=l,m.schedule=u;const v=O=>{m.cleanupFn=O};return m.ref={notify:()=>Gm(m),run:()=>{if(m.dirty=!1,m.hasRun&&!Pc(m))return;m.hasRun=!0;const O=jl(m);try{m.cleanupFn(),m.cleanupFn=_u,m.fn(v)}finally{Za(m,O)}},cleanup:()=>m.cleanupFn()},m.ref}(p,N=>{this.all.has(N)&&this.queue.set(N,M)},v);let T;this.all.add(O),O.notify();const k=()=>{O.cleanup(),T?.(),this.all.delete(O),this.queue.delete(O)};return T=m?.onDestroy(k),{destroy:k}}flush(){if(0!==this.queue.size)for(const[p,m]of this.queue)this.queue.delete(p),m?m.run(()=>p.run()):p.run()}get isQueueEmpty(){return 0===this.queue.size}static#t=this.\u0275prov=nt({token:l,providedIn:"root",factory:()=>new l})}return l})();function Zu(l,u,p){let m=p?l.styles:null,v=p?l.classes:null,M=0;if(null!==u)for(let O=0;O<u.length;O++){const T=u[O];"number"==typeof T?M=T:1==M?v=rn(v,T):2==M&&(m=rn(m,T+": "+u[++O]+";"))}p?l.styles=m:l.stylesWithoutHost=m,p?l.classes=v:l.classesWithoutHost=v}function U_(l,u,p,m,v=!1){for(;null!==p;){const M=u[p.index];null!==M&&m.push(Bo(M)),Un(M)&&ci(M,m);const O=p.type;if(8&O)U_(l,u,p.child,m);else if(32&O){const T=Mb(p,u);let k;for(;k=T();)m.push(k)}else if(16&O){const T=Jo(u,p);if(Array.isArray(T))m.push(...T);else{const k=Hh(u[Wo]);U_(k[dn],k,T,m,!0)}}p=v?p.projectionNext:p.next}return m}function ci(l,u){for(let p=zo;p<l.length;p++){const m=l[p],v=m[dn].firstChild;null!==v&&U_(m[dn],m,v,u)}l[Ms]!==l[Jr]&&u.push(l[Ms])}function Hg(l,u,p,m=!0){const v=u[pd],M=v.rendererFactory,O=v.afterRenderEventManager;M.begin?.(),O?.begin();try{V_(l,u,l.template,p)}catch(k){throw m&&M1(u,k),k}finally{M.end?.(),v.effectManager?.flush(),O?.end()}}function V_(l,u,p,m){const v=u[Ye];if(256!=(256&v)){u[pd].effectManager?.flush(),kc(u);try{Jf(u),function Td(l){return lr.lFrame.bindingIndex=l}(l.bindingStartIndex),null!==p&&m1(l,u,p,2,m);const O=3==(3&v);if(O){const N=l.preOrderCheckHooks;null!==N&&Sd(u,N,null)}else{const N=l.preOrderHooks;null!==N&&Ts(u,N,0,null),ii(u,0)}if(function ul(l){for(let u=Ol(l);null!==u;u=pr(u)){if(!u[gd])continue;const p=u[Ul];for(let m=0;m<p.length;m++){tp(p[m])}}}(u),Gc(u,2),null!==l.contentQueries&&S0(l,u),O){const N=l.contentCheckHooks;null!==N&&Sd(u,N)}else{const N=l.contentHooks;null!==N&&Ts(u,N,1),ii(u,1)}!function _s(l,u){const p=l.hostBindingOpCodes;if(null===p)return;const m=$P(u,sa);try{for(let v=0;v<p.length;v++){const M=p[v];if(M<0)Eu(~M);else{const O=M,T=p[++v],k=p[++v];Ky(T,O),m.dirty=!1;const N=jl(m);try{k(2,u[O])}finally{Za(m,N)}}}}finally{null===u[sa]&&Hw(u,sa),Eu(-1)}}(l,u);const T=l.components;null!==T&&ys(u,T,0);const k=l.viewQuery;if(null!==k&&C1(2,k,m),O){const N=l.viewCheckHooks;null!==N&&Sd(u,N)}else{const N=l.viewHooks;null!==N&&Ts(u,N,2),ii(u,2)}!0===l.firstUpdatePass&&(l.firstUpdatePass=!1),u[Ye]&=-73,Pd(u)}finally{Ou()}}}function Gc(l,u){for(let p=Ol(l);null!==p;p=pr(p))for(let m=zo;m<p.length;m++)DT(p[m],u)}function k0(l,u,p){DT(ua(u,l),p)}function DT(l,u){if(!function mw(l){return 128==(128&l[Ye])}(l))return;const p=l[dn],m=l[Ye];if(80&m&&0===u||1024&m||2===u)V_(p,l,p.template,l[ki]);else if(l[$a]>0){Gc(l,1);const v=p.components;null!==v&&ys(l,v,1)}}function ys(l,u,p){for(let m=0;m<u.length;m++)k0(l,u[m],p)}class R0{get rootNodes(){const u=this._lView,p=u[dn];return U_(p,u,p.firstChild,[])}constructor(u,p){this._lView=u,this._cdRefInjectingView=p,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[ki]}set context(u){this._lView[ki]=u}get destroyed(){return 256==(256&this._lView[Ye])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const u=this._lView[Do];if(Un(u)){const p=u[8],m=p?p.indexOf(this):-1;m>-1&&(f_(u,m),Du(p,m))}this._attachedToViewContainer=!1}ko(this._lView[dn],this._lView)}onDestroy(u){!function xu(l,u){if(256==(256&l[Ye]))throw new Gt(911,!1);null===l[ia]&&(l[ia]=[]),l[ia].push(u)}(this._lView,u)}markForCheck(){Sp(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ye]&=-129}reattach(){this._lView[Ye]|=128}detectChanges(){Hg(this._lView[dn],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Gt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function zi(l,u){m_(l,u,u[ar],2,null,null)}(this._lView[dn],this._lView)}attachToAppRef(u){if(this._attachedToViewContainer)throw new Gt(902,!1);this._appRef=u}}class pf extends R0{constructor(u){super(u),this._view=u}detectChanges(){const u=this._view;Hg(u[dn],u,u[ki],!1)}checkNoChanges(){}get context(){return null}}class Vi extends _0{constructor(u){super(),this.ngModule=u}resolveComponentFactory(u){const p=Wn(u);return new qd(p,this.ngModule)}}function Wu(l){const u=[];for(let p in l)l.hasOwnProperty(p)&&u.push({propName:l[p],templateName:p});return u}class N0{constructor(u,p){this.injector=u,this.parentInjector=p}get(u,p,m){m=qs(m);const v=this.injector.get(u,Da,m);return v!==Da||p===Da?v:this.parentInjector.get(u,p,m)}}class qd extends c1{get inputs(){const u=this.componentDef,p=u.inputTransforms,m=Wu(u.inputs);if(null!==p)for(const v of m)p.hasOwnProperty(v.propName)&&(v.transform=p[v.propName]);return m}get outputs(){return Wu(this.componentDef.outputs)}constructor(u,p){super(),this.componentDef=u,this.ngModule=p,this.componentType=u.type,this.selector=function Gf(l){return l.map(cu).join(",")}(u.selectors),this.ngContentSelectors=u.ngContentSelectors?u.ngContentSelectors:[],this.isBoundToModule=!!p}create(u,p,m,v){let M=(v=v||this.ngModule)instanceof So?v:v?.injector;M&&null!==this.componentDef.getStandaloneInjector&&(M=this.componentDef.getStandaloneInjector(M)||M);const O=M?new N0(u,M):u,T=O.get(v0,null);if(null===T)throw new Gt(407,!1);const $={rendererFactory:T,sanitizer:O.get(d1,null),effectManager:O.get(zs,null),afterRenderEventManager:O.get(lc,null)},q=T.createRenderer(null,this.componentDef),Z=this.componentDef.selectors[0][0]||"div",X=m?function F_(l,u,p,m){const M=m.get(UP,!1)||p===qo.ShadowDom,O=l.selectRootElement(u,M);return function P0(l){z_(l)}(O),O}(q,m,this.componentDef.encapsulation,O):Eb(q,Z,function L0(l){const u=l.toLowerCase();return"svg"===u?Tc:"math"===u?"math":null}(Z)),st=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let it=null;null!==X&&(it=s1(X,O,!0));const rt=Ug(0,null,null,1,0,null,null,null,null,null,null),ct=hn(null,rt,null,st,null,null,$,q,O,null,it);let yt,Et;kc(ct);try{const Tt=this.componentDef;let zt,Nt=null;Tt.findHostDirectiveDefs?(zt=[],Nt=new Map,Tt.findHostDirectiveDefs(Tt,zt,Nt),zt.push(Tt)):zt=[Tt];const $t=function Dl(l,u){const p=l[dn],m=Yn;return l[m]=u,df(p,m,2,"#host",null)}(ct,X),Rt=function kp(l,u,p,m,v,M,O){const T=v[dn];!function O1(l,u,p,m){for(const v of l)u.mergedAttrs=ud(u.mergedAttrs,v.hostAttrs);null!==u.mergedAttrs&&(Zu(u,u.mergedAttrs,!0),null!==p&&Fu(m,p,u))}(m,l,u,O);let k=null;null!==u&&(k=s1(u,v[Xi]));const N=M.rendererFactory.createRenderer(u,p);let F=16;p.signals?F=4096:p.onPush&&(F=64);const $=hn(v,Oi(p),null,F,v[l.index],l,M,N,null,null,k);return T.firstCreatePass&&v1(T,l,m.length-1),$g(v,$),v[l.index]=$}($t,X,Tt,zt,ct,$,q);Et=vu(rt,Yn),X&&function uc(l,u,p,m){if(m)Zo(l,p,["ng-version",b0.full]);else{const{attrs:v,classes:M}=function Um(l){const u=[],p=[];let m=1,v=2;for(;m<l.length;){let M=l[m];if("string"==typeof M)2===v?""!==M&&u.push(M,l[++m]):8===v&&p.push(M);else{if(!Hi(v))break;v=M}m++}return{attrs:u,classes:p}}(u.selectors[0]);v&&Zo(l,p,v),M&&M.length>0&&r0(l,p,M.join(" "))}}(q,Tt,X,m),void 0!==p&&function F0(l,u,p){const m=l.projection=[];for(let v=0;v<u.length;v++){const M=p[v];m.push(null!=M?Array.from(M):null)}}(Et,this.ngContentSelectors,p),yt=function Rp(l,u,p,m,v,M){const O=fs(),T=v[dn],k=Ji(O,v);qP(T,v,O,p,null,m);for(let F=0;F<p.length;F++)Qs(Fd(v,T,O.directiveStart+F,O),v);Zw(T,v,O),k&&Qs(k,v);const N=Fd(v,T,O.directiveStart+O.componentOffset,O);if(l[ki]=v[ki]=N,null!==M)for(const F of M)F(N,u);return N_(T,O,l),N}(Rt,Tt,zt,Nt,ct,[dc]),P1(rt,ct,null)}finally{Ou()}return new YP(this.componentType,yt,Vu(Et,ct),ct,Et)}}class YP extends k_{constructor(u,p,m,v,M){super(),this.location=m,this._rootLView=v,this._tNode=M,this.previousInputValues=null,this.instance=p,this.hostView=this.changeDetectorRef=new pf(v),this.componentType=u}setInput(u,p){const m=this._tNode.inputs;let v;if(null!==m&&(v=m[u])){if(this.previousInputValues??=new Map,this.previousInputValues.has(u)&&Object.is(this.previousInputValues.get(u),p))return;const M=this._rootLView;D0(M[dn],M,v,u,p),this.previousInputValues.set(u,p),Sp(ua(this._tNode.index,M))}}get injector(){return new es(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(u){this.hostView.onDestroy(u)}}function dc(){const l=fs();Yl(Me()[dn],l)}function gf(l){let u=function z0(l){return Object.getPrototypeOf(l.prototype).constructor}(l.type),p=!0;const m=[l];for(;u;){let v;if(la(l))v=u.\u0275cmp||u.\u0275dir;else{if(u.\u0275cmp)throw new Gt(903,!1);v=u.\u0275dir}if(v){if(p){m.push(v);const O=l;O.inputs=qg(l.inputs),O.inputTransforms=qg(l.inputTransforms),O.declaredInputs=qg(l.declaredInputs),O.outputs=qg(l.outputs);const T=v.hostBindings;T&&B0(l,T);const k=v.viewQuery,N=v.contentQueries;if(k&&Zg(l,k),N&&Xw(l,N),tn(l.inputs,v.inputs),tn(l.declaredInputs,v.declaredInputs),tn(l.outputs,v.outputs),null!==v.inputTransforms&&(null===O.inputTransforms&&(O.inputTransforms={}),tn(O.inputTransforms,v.inputTransforms)),la(v)&&v.data.animation){const F=l.data;F.animation=(F.animation||[]).concat(v.data.animation)}}const M=v.features;if(M)for(let O=0;O<M.length;O++){const T=M[O];T&&T.ngInherit&&T(l),T===gf&&(p=!1)}}u=Object.getPrototypeOf(u)}!function Yw(l){let u=0,p=null;for(let m=l.length-1;m>=0;m--){const v=l[m];v.hostVars=u+=v.hostVars,v.hostAttrs=ud(v.hostAttrs,p=ud(p,v.hostAttrs))}}(m)}function qg(l){return l===Io?{}:l===zr?[]:l}function Zg(l,u){const p=l.viewQuery;l.viewQuery=p?(m,v)=>{u(m,v),p(m,v)}:u}function Xw(l,u){const p=l.contentQueries;l.contentQueries=p?(m,v,M)=>{u(m,v,M),p(m,v,M)}:u}function B0(l,u){const p=l.hostBindings;l.hostBindings=p?(m,v)=>{u(m,v),p(m,v)}:u}function ui(l){const u=l.inputConfig,p={};for(const m in u)if(u.hasOwnProperty(m)){const v=u[m];Array.isArray(v)&&v[2]&&(p[m]=v[2])}l.inputTransforms=p}function li(l){return!!T1(l)&&(Array.isArray(l)||!(l instanceof Map)&&Symbol.iterator in l)}function T1(l){return null!==l&&("function"==typeof l||"object"==typeof l)}function xr(l,u,p){return!Object.is(l[u],p)&&(l[u]=p,!0)}function mf(l,u,p,m){const v=Me();return xr(v,Id(),u)&&(ro(),qu(Xo(),v,l,u,p,m)),mf}function Kd(l,u,p,m,v,M){const T=function bo(l,u,p,m){const v=xr(l,u,p);return xr(l,u+1,m)||v}(l,function bl(){return lr.lFrame.bindingIndex}(),p,v);return Ma(2),T?u+ge(p)+m+ge(v)+M:An}function oC(l,u,p,m,v,M,O,T){const k=Me(),N=ro(),F=l+Yn,$=N.firstCreatePass?function R1(l,u,p,m,v,M,O,T,k){const N=u.consts,F=df(u,l,4,O||null,Os(N,T));qw(u,p,F,Os(N,k)),Yl(u,F);const $=F.tView=Ug(2,F,m,v,M,u.directiveRegistry,u.pipeRegistry,null,u.schemas,N,null);return null!==u.queries&&(u.queries.template(u,F),$.queries=u.queries.embeddedTView(F)),F}(F,N,k,u,p,m,v,M,O):N.data[F];Ya($,!1);const q=L1(N,k,$,l);Oa()&&Bn(N,k,q,$),Qs(q,k),$g(k,k[F]=w1(q,k,q,$)),Ha($)&&Ap(N,k,$),null!=O&&Bg(k,$,T)}let L1=function Yu(l,u,p,m){return $r(!0),u[ar].createComment("")};function nm(l){return function bu(l,u){return l[u]}(function vg(){return lr.lFrame.contextLView}(),Yn+l)}function Na(l,u,p){const m=Me();return xr(m,Id(),u)&&function cl(l,u,p,m,v,M,O,T){const k=Ji(u,p);let F,N=u.inputs;!T&&null!=N&&(F=N[m])?(D0(l,p,F,m,v),_l(u)&&function ff(l,u){const p=ua(u,l);16&p[Ye]||(p[Ye]|=64)}(p,u.index)):3&u.type&&(m=function Dp(l){return"class"===l?"className":"for"===l?"htmlFor":"formaction"===l?"formAction":"innerHtml"===l?"innerHTML":"readonly"===l?"readOnly":"tabindex"===l?"tabIndex":l}(m),v=null!=O?O(v,u.value||"",m):v,M.setProperty(k,m,v))}(ro(),Xo(),m,l,u,m[ar],p,!1),Na}function N1(l,u,p,m,v){const O=v?"class":"style";D0(l,p,u.inputs[O],O,m)}function bf(l,u,p,m){const v=Me(),M=ro(),O=Yn+l,T=v[ar],k=M.firstCreatePass?function Xu(l,u,p,m,v,M){const O=u.consts,k=df(u,l,2,m,Os(O,v));return qw(u,p,k,Os(O,M)),null!==k.attrs&&Zu(k,k.attrs,!1),null!==k.mergedAttrs&&Zu(k,k.mergedAttrs,!0),null!==u.queries&&u.queries.elementStart(u,k),k}(O,M,v,u,p,m):M.data[O],N=Y_(M,v,k,T,u,l);v[O]=N;const F=Ha(k);return Ya(k,!0),Fu(T,N,k),32!=(32&k.flags)&&Oa()&&Bn(M,v,N,k),0===function wu(){return lr.lFrame.elementDepthCount}()&&Qs(N,v),function Dh(){lr.lFrame.elementDepthCount++}(),F&&(Ap(M,v,k),N_(M,k,v)),null!==m&&Bg(v,k),bf}function fc(){let l=fs();kh()?function op(){lr.lFrame.isParent=!1}():(l=l.parent,Ya(l,!1));const u=l;(function Sc(l){return lr.skipHydrationRootTNode===l})(u)&&function np(){lr.skipHydrationRootTNode=null}(),function Wy(){lr.lFrame.elementDepthCount--}();const p=ro();return p.firstCreatePass&&(Yl(p,l),hu(l)&&p.queries.elementEnd(l)),null!=u.classesWithoutHost&&function Nh(l){return 0!=(8&l.flags)}(u)&&N1(p,u,Me(),u.classesWithoutHost,!0),null!=u.stylesWithoutHost&&function Fh(l){return 0!=(16&l.flags)}(u)&&N1(p,u,Me(),u.stylesWithoutHost,!1),fc}function Vp(l,u,p,m){return bf(l,u,p,m),fc(),Vp}let Y_=(l,u,p,m,v,M)=>($r(!0),Eb(m,v,function Je(){return lr.lFrame.currentNamespace}()));function sO(){return Me()}function Z0(l){return!!l&&"function"==typeof l.then}function rm(l){return!!l&&"function"==typeof l.subscribe}function kl(l,u,p,m){const v=Me(),M=ro(),O=fs();return function B1(l,u,p,m,v,M,O){const T=Ha(m),N=l.firstCreatePass&&A0(l),F=u[ki],$=Ww(u);let q=!0;if(3&m.type||O){const K=Ji(m,u),J=O?O(K):K,st=$.length,it=O?ct=>O(Bo(ct[m.index])):m.index;let rt=null;if(!O&&T&&(rt=function z1(l,u,p,m){const v=l.cleanup;if(null!=v)for(let M=0;M<v.length-1;M+=2){const O=v[M];if(O===p&&v[M+1]===m){const T=u[no],k=v[M+2];return T.length>k?T[k]:null}"string"==typeof O&&(M+=2)}return null}(l,u,v,m.index)),null!==rt)(rt.__ngLastListenerFn__||rt).__ngNextListenerFn__=M,rt.__ngLastListenerFn__=M,q=!1;else{M=U1(m,u,F,M,!1);const ct=p.listen(J,v,M);$.push(M,ct),N&&N.push(v,it,st,st+1)}}else M=U1(m,u,F,M,!1);const Z=m.outputs;let X;if(q&&null!==Z&&(X=Z[v])){const K=X.length;if(K)for(let J=0;J<K;J+=2){const yt=u[X[J]][X[J+1]].subscribe(M),Et=$.length;$.push(M,yt),N&&N.push(v,m.index,Et,-(Et+1))}}}(M,v,v[ar],O,l,u,m),kl}function Jd(l,u,p,m){try{return hs(6,u,p),!1!==p(m)}catch(v){return M1(l,v),!1}finally{hs(7,u,p)}}function U1(l,u,p,m,v){return function M(O){if(O===Function)return m;Sp(l.componentOffset>-1?ua(l.index,u):u);let k=Jd(u,p,m,O),N=M.__ngNextListenerFn__;for(;N;)k=Jd(u,p,N,O)&&k,N=N.__ngNextListenerFn__;return v&&!1===k&&O.preventDefault(),k}}function V1(l=1){return function Zl(l){return(lr.lFrame.contextLView=function xg(l,u){for(;l>0;)u=u[xa],l--;return u}(l,lr.lFrame.contextLView))[ki]}(l)}function X0(l,u){return l<<17|u<<2}function th(l){return l>>17&32767}function xo(l){return 2|l}function pc(l){return(131068&l)>>2}function fl(l,u){return-131069&l|u<<2}function Ju(l){return 1|l}function $1(l,u,p,m,v){const M=l[p+1],O=null===u;let T=m?th(M):pc(M),k=!1;for(;0!==T&&(!1===k||O);){const F=l[T+1];cO(l[T],u)&&(k=!0,l[T+1]=m?Ju(F):xo(F)),T=m?th(F):pc(F)}k&&(l[p+1]=m?xo(M):Ju(M))}function cO(l,u){return null===l||null==u||(Array.isArray(l)?l[1]:l)===u||!(!Array.isArray(l)||"string"!=typeof u)&&z(l,u)>=0}function pC(l,u){return function Wc(l,u,p,m){const v=Me(),M=ro(),O=Ma(2);M.firstUpdatePass&&function hO(l,u,p,m){const v=l.data;if(null===v[p+1]){const M=v[oi()],O=function mC(l,u){return u>=l.expandoStartIndex}(l,p);(function Mf(l,u){return 0!=(l.flags&(u?8:16))})(M,m)&&null===u&&!O&&(u=!1),u=function fO(l,u,p,m){const v=function Pa(l){const u=lr.lFrame.currentDirectiveIndex;return-1===u?null:l[u]}(l);let M=m?u.residualClasses:u.residualStyles;if(null===v)0===(m?u.classBindings:u.styleBindings)&&(p=sh(p=ih(null,l,u,p,m),u.attrs,m),M=null);else{const O=u.directiveStylingLast;if(-1===O||l[O]!==v)if(p=ih(v,l,u,p,m),null===M){let k=function FT(l,u,p){const m=p?u.classBindings:u.styleBindings;if(0!==pc(m))return l[th(m)]}(l,u,m);void 0!==k&&Array.isArray(k)&&(k=ih(null,l,u,k[1],m),k=sh(k,u.attrs,m),function zT(l,u,p,m){l[th(p?u.classBindings:u.styleBindings)]=m}(l,u,m,k))}else M=function BT(l,u,p){let m;const v=u.directiveEnd;for(let M=1+u.directiveStylingLast;M<v;M++)m=sh(m,l[M].hostAttrs,p);return sh(m,u.attrs,p)}(l,u,m)}return void 0!==M&&(m?u.residualClasses=M:u.residualStyles=M),p}(v,M,u,m),function J0(l,u,p,m,v,M){let O=M?u.classBindings:u.styleBindings,T=th(O),k=pc(O);l[m]=p;let F,N=!1;if(Array.isArray(p)?(F=p[1],(null===F||z(p,F)>0)&&(N=!0)):F=p,v)if(0!==k){const q=th(l[T+1]);l[m+1]=X0(q,T),0!==q&&(l[q+1]=fl(l[q+1],m)),l[T+1]=function jp(l,u){return 131071&l|u<<17}(l[T+1],m)}else l[m+1]=X0(T,0),0!==T&&(l[T+1]=fl(l[T+1],m)),T=m;else l[m+1]=X0(k,0),0===T?T=m:l[k+1]=fl(l[k+1],m),k=m;N&&(l[m+1]=xo(l[m+1])),$1(l,F,m,!0),$1(l,F,m,!1),function lO(l,u,p,m,v){const M=v?l.residualClasses:l.residualStyles;null!=M&&"string"==typeof u&&z(M,u)>=0&&(p[m+1]=Ju(p[m+1]))}(u,F,l,m,M),O=X0(T,k),M?u.classBindings=O:u.styleBindings=O}(v,M,u,p,O,m)}}(M,l,O,m),u!==An&&xr(v,O,u)&&function _C(l,u,p,m,v,M,O,T){if(!(3&u.type))return;const k=l.data,N=k[T+1],F=function Qu(l){return 1==(1&l)}(N)?_O(k,u,p,v,pc(N),O):void 0;sm(F)||(sm(M)||function Q0(l){return 2==(2&l)}(N)&&(M=_O(k,null,p,v,T,O)),function jn(l,u,p,m,v){if(u)v?l.addClass(p,m):l.removeClass(p,m);else{let M=-1===m.indexOf("-")?void 0:vw.DashCase;null==v?l.removeStyle(p,m,M):("string"==typeof v&&v.endsWith("!important")&&(v=v.slice(0,-10),M|=vw.Important),l.setStyle(p,m,v,M))}}(m,O,yu(oi(),p),v,M))}(M,M.data[oi()],v,v[ar],l,v[O+1]=function q1(l,u){return null==l||""===l||("string"==typeof u?l+=u:"object"==typeof l&&(l=We(Yh(l)))),l}(u,p),m,O)}(l,u,null,!0),pC}function ih(l,u,p,m,v){let M=null;const O=p.directiveEnd;let T=p.directiveStylingLast;for(-1===T?T=p.directiveStart:T++;T<O&&(M=u[T],m=sh(m,M.hostAttrs,v),M!==l);)T++;return null!==l&&(p.directiveStylingLast=T),m}function sh(l,u,p){const m=p?1:2;let v=-1;if(null!==u)for(let M=0;M<u.length;M++){const O=u[M];"number"==typeof O?v=O:v===m&&(Array.isArray(l)||(l=void 0===l?[]:["",l]),Xs(l,O,!!p||u[++M]))}return void 0===l?null:l}function _O(l,u,p,m,v,M){const O=null===u;let T;for(;v>0;){const k=l[v],N=Array.isArray(k),F=N?k[1]:k,$=null===F;let q=p[v+1];q===An&&(q=$?zr:void 0);let Z=$?s_(q,m):F===m?q:void 0;if(N&&!sm(Z)&&(Z=s_(k,m)),sm(Z)&&(T=Z,O))return T;const X=l[v+1];v=O?th(X):pc(X)}if(null!==u){let k=M?u.residualClasses:u.residualStyles;null!=k&&(T=s_(k,m))}return T}function sm(l){return void 0!==l}function Gp(l,u=""){const p=Me(),m=ro(),v=l+Yn,M=m.firstCreatePass?df(m,v,1,u,null):m.data[v],O=Hp(m,p,M,u,l);p[v]=O,Oa()&&Bn(m,p,O,M),Ya(M,!1)}let Hp=(l,u,p,m,v)=>($r(!0),function Pb(l,u){return l.createText(u)}(u[ar],m));function am(l){return Gn("",l,""),am}function Gn(l,u,p){const m=Me(),v=function Wd(l,u,p,m){return xr(l,Id(),p)?u+ge(p)+m:An}(m,l,u,p);return v!==An&&Gd(m,oi(),v),Gn}function lm(l,u,p,m,v){const M=Me(),O=Kd(M,l,u,p,m,v);return O!==An&&Gd(M,oi(),O),lm}const is=void 0;var lv=["en",[["a","p"],["AM","PM"],is],[["AM","PM"],is,is],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],is,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],is,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",is,"{1} 'at' {0}",is],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function vO(l){const p=Math.floor(Math.abs(l)),m=l.toString().replace(/^[^.]*\.?/,"").length;return 1===p&&0===m?1:5}];let ah={};function ed(l){const u=function MC(l){return l.toLowerCase().replace(/_/g,"-")}(l);let p=_c(u);if(p)return p;const m=u.split("-")[0];if(p=_c(m),p)return p;if("en"===m)return lv;throw new Gt(701,!1)}function ay(l){return ed(l)[Yc.PluralCase]}function _c(l){return l in ah||(ah[l]=Ar.ng&&Ar.ng.common&&Ar.ng.common.locales&&Ar.ng.common.locales[l]),ah[l]}var Yc=function(l){return l[l.LocaleId=0]="LocaleId",l[l.DayPeriodsFormat=1]="DayPeriodsFormat",l[l.DayPeriodsStandalone=2]="DayPeriodsStandalone",l[l.DaysFormat=3]="DaysFormat",l[l.DaysStandalone=4]="DaysStandalone",l[l.MonthsFormat=5]="MonthsFormat",l[l.MonthsStandalone=6]="MonthsStandalone",l[l.Eras=7]="Eras",l[l.FirstDayOfWeek=8]="FirstDayOfWeek",l[l.WeekendRange=9]="WeekendRange",l[l.DateFormat=10]="DateFormat",l[l.TimeFormat=11]="TimeFormat",l[l.DateTimeFormat=12]="DateTimeFormat",l[l.NumberSymbols=13]="NumberSymbols",l[l.NumberFormats=14]="NumberFormats",l[l.CurrencyCode=15]="CurrencyCode",l[l.CurrencySymbol=16]="CurrencySymbol",l[l.CurrencyName=17]="CurrencyName",l[l.Currencies=18]="Currencies",l[l.Directionality=19]="Directionality",l[l.PluralCase=20]="PluralCase",l[l.ExtraData=21]="ExtraData",l}(Yc||{});const Ef="en-US";let xO=Ef;function Pv(l,u,p,m,v){if(l=Ce(l),Array.isArray(l))for(let M=0;M<l.length;M++)Pv(l[M],u,p,m,v);else{const M=ro(),O=Me(),T=fs();let k=wp(l)?l:Ce(l.provide);const N=Vc(l),F=1048575&T.providerIndexes,$=T.directiveStart,q=T.providerIndexes>>20;if(wp(l)||!l.multi){const Z=new Lh(N,v,io),X=Ov(k,u,v?F:F+q,$);-1===X?(Ld(Ml(T,O),M,k),mm(M,l,u.length),u.push(k),T.directiveStart++,T.directiveEnd++,v&&(T.providerIndexes+=1048576),p.push(Z),O.push(Z)):(p[X]=Z,O[X]=Z)}else{const Z=Ov(k,u,F+q,$),X=Ov(k,u,F,F+q),J=X>=0&&p[X];if(v&&!J||!v&&!(Z>=0&&p[Z])){Ld(Ml(T,O),M,k);const st=function od(l,u,p,m,v){const M=new Lh(l,p,io);return M.multi=[],M.index=u,M.componentProviders=0,gy(M,v,m&&!p),M}(v?gx:NC,p.length,v,m,N);!v&&J&&(p[X].providerFactory=st),mm(M,l,u.length,0),u.push(k),T.directiveStart++,T.directiveEnd++,v&&(T.providerIndexes+=1048576),p.push(st),O.push(st)}else mm(M,l,Z>-1?Z:X,gy(p[v?X:Z],N,!v&&m));!v&&m&&J&&p[X].componentProviders++}}}function mm(l,u,p,m){const v=wp(u),M=function al(l){return!!l.useClass}(u);if(v||M){const k=(M?Ce(u.useClass):u).prototype.ngOnDestroy;if(k){const N=l.destroyHooks||(l.destroyHooks=[]);if(!v&&u.multi){const F=N.indexOf(p);-1===F?N.push(p,[m,k]):N[F+1].push(m,k)}else N.push(p,k)}}}function gy(l,u,p){return p&&l.componentProviders++,l.multi.push(u)-1}function Ov(l,u,p,m){for(let v=p;v<m;v++)if(u[v]===l)return v;return-1}function NC(l,u,p,m){return rd(this.multi,[])}function gx(l,u,p,m){const v=this.multi;let M;if(this.providerFactory){const O=this.providerFactory.componentProviders,T=Fd(p,p[dn],this.providerFactory.index,m);M=T.slice(0,O),rd(v,M);for(let k=O;k<T.length;k++)M.push(T[k])}else M=[],rd(v,M);return M}function rd(l,u){for(let p=0;p<l.length;p++)u.push((0,l[p])());return u}function mx(l,u=[]){return p=>{p.providersResolver=(m,v)=>function py(l,u,p){const m=ro();if(m.firstCreatePass){const v=la(l);Pv(p,m.data,m.blueprint,v,!0),Pv(u,m.data,m.blueprint,v,!1)}}(m,v?v(l):l,u)}}class Yp{}class Ev{}function YT(l,u){return new FC(l,u??null,[])}class FC extends Yp{constructor(u,p,m){super(),this._parent=p,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Vi(this);const v=Di(u);this._bootstrapComponents=_a(v.bootstrap),this._r3Injector=go(u,p,[{provide:Yp,useValue:this},{provide:_0,useValue:this.componentFactoryResolver},...m],We(u),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(u)}get injector(){return this._r3Injector}destroy(){const u=this._r3Injector;!u.destroyed&&u.destroy(),this.destroyCbs.forEach(p=>p()),this.destroyCbs=null}onDestroy(u){this.destroyCbs.push(u)}}class Tv extends Ev{constructor(u){super(),this.moduleType=u}create(u){return new FC(this.moduleType,u,[])}}class _m extends Yp{constructor(u){super(),this.componentFactoryResolver=new Vi(this),this.instance=null;const p=new tf([...u.providers,{provide:Yp,useValue:this},{provide:_0,useValue:this.componentFactoryResolver}],u.parent||d0(),u.debugName,new Set(["environment"]));this.injector=p,u.runEnvironmentInitializers&&p.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(u){this.injector.onDestroy(u)}}function _x(l,u,p=null){return new _m({providers:l,parent:u,debugName:p,runEnvironmentInitializers:!0}).injector}let my=(()=>{class l{constructor(p){this._injector=p,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(p){if(!p.standalone)return null;if(!this.cachedInjectors.has(p)){const m=Dg(0,p.type),v=m.length>0?_x([m],this._injector,`Standalone[${p.type.name}]`):null;this.cachedInjectors.set(p,v)}return this.cachedInjectors.get(p)}ngOnDestroy(){try{for(const p of this.cachedInjectors.values())null!==p&&p.destroy()}finally{this.cachedInjectors.clear()}}static#t=this.\u0275prov=nt({token:l,providedIn:"environment",factory:()=>new l(or(So))})}return l})();function yx(l){l.getStandaloneInjector=u=>u.get(my).getOrCreateStandaloneInjector(l)}function Qp(l,u,p,m){return function Ex(l,u,p,m,v,M){const O=u+p;return xr(l,O,v)?function Zd(l,u,p){return l[u]=p}(l,O+1,M?m.call(M,v):m(v)):function Af(l,u){const p=l[u];return p===An?void 0:p}(l,O+1)}(Me(),function Ls(){const l=lr.lFrame;let u=l.bindingRootIndex;return-1===u&&(u=l.bindingRootIndex=l.tView.bindingStartIndex),u}(),l,u,p,m)}function vm(){return this._results[Symbol.iterator]()}class Rv{static#t=Symbol.iterator;get changes(){return this._changes||(this._changes=new Eo)}constructor(u=!1){this._emitDistinctChangesOnly=u,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const p=Rv.prototype;p[Symbol.iterator]||(p[Symbol.iterator]=vm)}get(u){return this._results[u]}map(u){return this._results.map(u)}filter(u){return this._results.filter(u)}find(u){return this._results.find(u)}reduce(u,p){return this._results.reduce(u,p)}forEach(u){this._results.forEach(u)}some(u){return this._results.some(u)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(u,p){const m=this;m.dirty=!1;const v=function _i(l){return l.flat(Number.POSITIVE_INFINITY)}(u);(this._changesDetected=!function Ta(l,u,p){if(l.length!==u.length)return!1;for(let m=0;m<l.length;m++){let v=l[m],M=u[m];if(p&&(v=p(v),M=p(M)),M!==v)return!1}return!0}(m._results,v,p))&&(m._results=v,m.length=v.length,m.last=v[this.length-1],m.first=v[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}function JT(l,u,p,m=!0){const v=u[dn];if(function qh(l,u,p,m){const v=zo+m,M=p.length;m>0&&(p[v-1][Cs]=u),m<M-zo?(u[Cs]=p[v],Ia(p,zo+m,u)):(p.push(u),u[Cs]=null),u[Do]=p;const O=u[uu];null!==O&&p!==O&&function yP(l,u){const p=l[Ul];u[Wo]!==u[Do][Do][Wo]&&(l[gd]=!0),null===p?l[Ul]=[u]:p.push(u)}(O,u);const T=u[fi];null!==T&&T.insertView(l),u[Ye]|=128}(v,u,l,p),m){const M=Sb(p,l),O=u[ar],T=Ig(O,l[Ms]);null!==T&&function Qo(l,u,p,m,v,M){m[Jr]=v,m[Zr]=u,m_(l,m,p,1,v,M)}(v,l[Zr],O,u,T,M)}}let bm=(()=>{class l{static#t=this.__NG_ELEMENT_ID__=Lv}return l})();const HC=bm,YO=class extends HC{constructor(u,p,m){super(),this._declarationLView=u,this._declarationTContainer=p,this.elementRef=m}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(u,p){return this.createEmbeddedViewImpl(u,p)}createEmbeddedViewImpl(u,p,m){const v=function Sx(l,u,p,m){const v=u.tView,T=hn(l,v,p,4096&l[Ye]?4096:16,null,u,null,null,null,m?.injector??null,m?.hydrationInfo??null);T[uu]=l[u.index];const N=l[fi];return null!==N&&(T[fi]=N.createEmbeddedView(v)),P1(v,T,p),T}(this._declarationLView,this._declarationTContainer,u,{injector:p,hydrationInfo:m});return new R0(v)}};function Lv(){return xm(fs(),Me())}function xm(l,u){return 4&l.type?new YO(u,l,Vu(l,u)):null}let hh=(()=>{class l{static#t=this.__NG_ELEMENT_ID__=tE}return l})();function tE(){return kx(fs(),Me())}const ZC=hh,Fv=class extends ZC{constructor(u,p,m){super(),this._lContainer=u,this._hostTNode=p,this._hostLView=m}get element(){return Vu(this._hostTNode,this._hostLView)}get injector(){return new es(this._hostTNode,this._hostLView)}get parentInjector(){const u=Iu(this._hostTNode,this._hostLView);if(ha(u)){const p=Qa(u,this._hostLView),m=Xl(u);return new es(p[dn].data[m+8],p)}return new es(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(u){const p=Cm(this._lContainer);return null!==p&&p[u]||null}get length(){return this._lContainer.length-zo}createEmbeddedView(u,p,m){let v,M;"number"==typeof m?v=m:null!=m&&(v=m.index,M=m.injector);const T=u.createEmbeddedViewImpl(p||{},M,null);return this.insertImpl(T,v,false),T}createComponent(u,p,m,v,M){const O=u&&!function si(l){return"function"==typeof l}(u);let T;if(O)T=p;else{const K=p||{};T=K.index,m=K.injector,v=K.projectableNodes,M=K.environmentInjector||K.ngModuleRef}const k=O?u:new qd(Wn(u)),N=m||this.parentInjector;if(!M&&null==k.ngModule){const J=(O?N:this.parentInjector).get(So,null);J&&(M=J)}Wn(k.componentType??{});const Z=k.create(N,v,null,M);return this.insertImpl(Z.hostView,T,false),Z}insert(u,p){return this.insertImpl(u,p,!1)}insertImpl(u,p,m){const v=u._lView;if(function mi(l){return Un(l[Do])}(v)){const k=this.indexOf(u);if(-1!==k)this.detach(k);else{const N=v[Do],F=new Fv(N,N[Zr],N[Do]);F.detach(F.indexOf(u))}}const O=this._adjustIndex(p),T=this._lContainer;return JT(T,v,O,!m),u.attachToViewContainerRef(),Ia(Rl(T),O,u),u}move(u,p){return this.insert(u,p)}indexOf(u){const p=Cm(this._lContainer);return null!==p?p.indexOf(u):-1}remove(u){const p=this._adjustIndex(u,-1),m=f_(this._lContainer,p);m&&(Du(Rl(this._lContainer),p),ko(m[dn],m))}detach(u){const p=this._adjustIndex(u,-1),m=f_(this._lContainer,p);return m&&null!=Du(Rl(this._lContainer),p)?new R0(m):null}_adjustIndex(u,p=0){return u??this.length+p}};function Cm(l){return l[8]}function Rl(l){return l[8]||(l[8]=[])}function kx(l,u){let p;const m=u[l.index];return Un(m)?p=m:(p=w1(m,u,null,l),u[l.index]=p,$g(u,p)),vc(p,u,l,m),new Fv(p,l,u)}let vc=function nE(l,u,p,m){if(l[Ms])return;let v;v=8&p.type?Bo(m):function eE(l,u){const p=l[ar],m=p.createComment(""),v=Ji(u,l);return po(p,Ig(p,v),m,function uo(l,u){return l.nextSibling(u)}(p,v),!1),m}(u,p),l[Ms]=v};class zv{constructor(u){this.queryList=u,this.matches=null}clone(){return new zv(this.queryList)}setDirty(){this.queryList.setDirty()}}class vy{constructor(u=[]){this.queries=u}createEmbeddedView(u){const p=u.queries;if(null!==p){const m=null!==u.contentQueries?u.contentQueries[0]:p.length,v=[];for(let M=0;M<m;M++){const O=p.getByIndex(M);v.push(this.queries[O.indexInDeclarationView].clone())}return new vy(v)}return null}insertView(u){this.dirtyQueriesWithMatches(u)}detachView(u){this.dirtyQueriesWithMatches(u)}dirtyQueriesWithMatches(u){for(let p=0;p<this.queries.length;p++)null!==wy(u,p).matches&&this.queries[p].setDirty()}}class by{constructor(u,p,m=null){this.predicate=u,this.flags=p,this.read=m}}class Mm{constructor(u=[]){this.queries=u}elementStart(u,p){for(let m=0;m<this.queries.length;m++)this.queries[m].elementStart(u,p)}elementEnd(u){for(let p=0;p<this.queries.length;p++)this.queries[p].elementEnd(u)}embeddedTView(u){let p=null;for(let m=0;m<this.length;m++){const v=null!==p?p.length:0,M=this.getByIndex(m).embeddedTView(u,v);M&&(M.indexInDeclarationView=m,null!==p?p.push(M):p=[M])}return null!==p?new Mm(p):null}template(u,p){for(let m=0;m<this.queries.length;m++)this.queries[m].template(u,p)}getByIndex(u){return this.queries[u]}get length(){return this.queries.length}track(u){this.queries.push(u)}}class YC{constructor(u,p=-1){this.metadata=u,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=p}elementStart(u,p){this.isApplyingToNode(p)&&this.matchTNode(u,p)}elementEnd(u){this._declarationNodeIndex===u.index&&(this._appliesToNextNode=!1)}template(u,p){this.elementStart(u,p)}embeddedTView(u,p){return this.isApplyingToNode(u)?(this.crossesNgTemplate=!0,this.addMatch(-u.index,p),new YC(this.metadata)):null}isApplyingToNode(u){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const p=this._declarationNodeIndex;let m=u.parent;for(;null!==m&&8&m.type&&m.index!==p;)m=m.parent;return p===(null!==m?m.index:-1)}return this._appliesToNextNode}matchTNode(u,p){const m=this.metadata.predicate;if(Array.isArray(m))for(let v=0;v<m.length;v++){const M=m[v];this.matchTNodeWithReadOption(u,p,XC(p,M)),this.matchTNodeWithReadOption(u,p,tl(p,u,M,!1,!1))}else m===bm?4&p.type&&this.matchTNodeWithReadOption(u,p,-1):this.matchTNodeWithReadOption(u,p,tl(p,u,m,!1,!1))}matchTNodeWithReadOption(u,p,m){if(null!==m){const v=this.metadata.read;if(null!==v)if(v===Lg||v===hh||v===bm&&4&p.type)this.addMatch(p.index,-2);else{const M=tl(p,u,v,!1,!1);null!==M&&this.addMatch(p.index,M)}else this.addMatch(p.index,m)}}addMatch(u,p){null===this.matches?this.matches=[u,p]:this.matches.push(u,p)}}function XC(l,u){const p=l.localNames;if(null!==p)for(let m=0;m<p.length;m+=2)if(p[m]===u)return p[m+1];return null}function Rx(l,u,p,m){return-1===p?function rE(l,u){return 11&l.type?Vu(l,u):4&l.type?xm(l,u):null}(u,l):-2===p?function Lx(l,u,p){return p===Lg?Vu(u,l):p===bm?xm(u,l):p===hh?kx(u,l):void 0}(l,u,m):Fd(l,l[dn],p,u)}function oE(l,u,p,m){const v=u[fi].queries[m];if(null===v.matches){const M=l.data,O=p.matches,T=[];for(let k=0;k<O.length;k+=2){const N=O[k];T.push(N<0?null:Rx(u,M[N],O[k+1],p.metadata.read))}v.matches=T}return v.matches}function xy(l,u,p,m){const v=l.queries.getByIndex(p),M=v.matches;if(null!==M){const O=oE(l,u,v,p);for(let T=0;T<M.length;T+=2){const k=M[T];if(k>0)m.push(O[T/2]);else{const N=M[T+1],F=u[-k];for(let $=zo;$<F.length;$++){const q=F[$];q[uu]===q[Do]&&xy(q[dn],q,N,m)}if(null!==F[Ul]){const $=F[Ul];for(let q=0;q<$.length;q++){const Z=$[q];xy(Z[dn],Z,N,m)}}}}}return m}function Nx(l){const u=Me(),p=ro(),m=Wr();da(m+1);const v=wy(p,m);if(l.dirty&&function Ic(l){return 4==(4&l[Ye])}(u)===(2==(2&v.metadata.flags))){if(null===v.matches)l.reset([]);else{const M=v.crossesNgTemplate?xy(p,u,m,[]):oE(p,u,v,m);l.reset(M,y0),l.notifyOnChanges()}return!0}return!1}function iE(l,u,p){const m=ro();m.firstCreatePass&&(Bv(m,new by(l,u,p),-1),2==(2&u)&&(m.staticViewQueries=!0)),sE(m,Me(),u)}function Fx(l,u,p,m){const v=ro();if(v.firstCreatePass){const M=fs();Bv(v,new by(u,p,m),M.index),function aE(l,u){const p=l.contentQueries||(l.contentQueries=[]);u!==(p.length?p[p.length-1]:-1)&&p.push(l.queries.length-1,u)}(v,l),2==(2&p)&&(v.staticContentQueries=!0)}sE(v,Me(),p)}function zx(){return function QC(l,u){return l[fi].queries[u].queryList}(Me(),Wr())}function sE(l,u,p){const m=new Rv(4==(4&p));(function qt(l,u,p,m){const v=Ww(u);v.push(p),l.firstCreatePass&&A0(l).push(m,v.length-1)})(l,u,m,m.destroy),null===u[fi]&&(u[fi]=new vy),u[fi].queries.push(new zv(m))}function Bv(l,u,p){null===l.queries&&(l.queries=new Mm),l.queries.track(new YC(u,p))}function wy(l,u){return l.queries.getByIndex(u)}function JC(l,u){return xm(l,u)}function Om(l){return!!Di(l)}const uM=new er("Application Initializer");let mE=(()=>{class l{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((p,m)=>{this.resolve=p,this.reject=m}),this.appInits=ir(uM,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const p=[];for(const v of this.appInits){const M=v();if(Z0(M))p.push(M);else if(rm(M)){const O=new Promise((T,k)=>{M.subscribe({complete:T,error:k})});p.push(O)}}const m=()=>{this.done=!0,this.resolve()};Promise.all(p).then(()=>{m()}).catch(v=>{this.reject(v)}),0===p.length&&m(),this.initialized=!0}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})(),_E=(()=>{class l{log(p){console.log(p)}warn(p){console.warn(p)}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"platform"})}return l})();const dM=new er("LocaleId",{providedIn:"root",factory:()=>ir(dM,yn.Optional|yn.SkipSelf)||function jI(){return typeof $localize<"u"&&$localize.locale||Ef}()}),$I=new er("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let Ey=(()=>{class l{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new lt.X(!1)}add(){this.hasPendingTasks.next(!0);const p=this.taskId++;return this.pendingTasks.add(p),p}remove(p){this.pendingTasks.delete(p),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();class u2{constructor(u,p){this.ngModuleFactory=u,this.componentFactories=p}}let Sm=(()=>{class l{compileModuleSync(p){return new Tv(p)}compileModuleAsync(p){return Promise.resolve(this.compileModuleSync(p))}compileModuleAndAllComponentsSync(p){const m=this.compileModuleSync(p),M=_a(Di(p).declarations).reduce((O,T)=>{const k=Wn(T);return k&&O.push(new qd(k)),O},[]);return new u2(m,M)}compileModuleAndAllComponentsAsync(p){return Promise.resolve(this.compileModuleAndAllComponentsSync(p))}clearCache(){}clearCacheFor(p){}getModuleId(p){}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();const CE=new er(""),Zv=new er("");let ME,kf=(()=>{class l{constructor(p,m,v){this._ngZone=p,this.registry=m,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,ME||(function Wv(l){ME=l}(v),v.addToWindow(m)),this._watchAngularEvents(),p.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Wi.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let p=this._callbacks.pop();clearTimeout(p.timeoutId),p.doneCb(this._didWork)}this._didWork=!1});else{let p=this.getPendingTasks();this._callbacks=this._callbacks.filter(m=>!m.updateCb||!m.updateCb(p)||(clearTimeout(m.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(p=>({source:p.source,creationLocation:p.creationLocation,data:p.data})):[]}addCallback(p,m,v){let M=-1;m&&m>0&&(M=setTimeout(()=>{this._callbacks=this._callbacks.filter(O=>O.timeoutId!==M),p(this._didWork,this.getPendingTasks())},m)),this._callbacks.push({doneCb:p,timeoutId:M,updateCb:v})}whenStable(p,m,v){if(v&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(p,m,v),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(p){this.registry.registerApplication(p,this)}unregisterApplication(p){this.registry.unregisterApplication(p)}findProviders(p,m,v){return[]}static#t=this.\u0275fac=function(m){return new(m||l)(or(Wi),or(yM),or(Zv))};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac})}return l})(),yM=(()=>{class l{constructor(){this._applications=new Map}registerApplication(p,m){this._applications.set(p,m)}unregisterApplication(p){this._applications.delete(p)}unregisterAllApplications(){this._applications.clear()}getTestability(p){return this._applications.get(p)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(p,m=!0){return ME?.findTestabilityInTree(this,p,m)??null}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"platform"})}return l})(),eu=null;const m2=new er("AllowMultipleToken"),eg=new er("PlatformDestroyListeners"),vM=new er("appBootstrapListener");class qI{constructor(u,p){this.name=u,this.token=p}}function Yv(l,u,p=[]){const m=`Platform: ${u}`,v=new er(m);return(M=[])=>{let O=Xv();if(!O||O.injector.get(m2,!1)){const T=[...p,...M,{provide:v,useValue:!0}];l?l(T):function Rf(l){if(eu&&!eu.get(m2,!1))throw new Gt(400,!1);(function OE(){!function Eh(l){Oh=l}(()=>{throw new Gt(600,!1)})})(),eu=l;const u=l.get(bM);(function EE(l){l.get(f0,null)?.forEach(p=>p())})(l)}(function _2(l=[],u){return ac.create({name:u,providers:[{provide:Jh,useValue:"platform"},{provide:eg,useValue:new Set([()=>eu=null])},...l]})}(T,m))}return function ZI(l){const u=Xv();if(!u)throw new Gt(401,!1);return u}()}}function Xv(){return eu?.get(bM)??null}let bM=(()=>{class l{constructor(p){this._injector=p,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(p,m){const v=function IE(l="zone.js",u){return"noop"===l?new Uw:"zone.js"===l?new Wi(u):l}(m?.ngZone,function Lf(l){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:l?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:l?.runCoalescing??!1}}({eventCoalescing:m?.ngZoneEventCoalescing,runCoalescing:m?.ngZoneRunCoalescing}));return v.run(()=>{const M=function Iv(l,u,p){return new FC(l,u,p)}(p.moduleType,this.injector,function ng(l){return[{provide:Wi,useFactory:l},{provide:Qh,multi:!0,useFactory:()=>{const u=ir(Qx,{optional:!0});return()=>u.initialize()}},{provide:y2,useFactory:v2},{provide:Vw,useFactory:$c}]}(()=>v)),O=M.injector.get(ju,null);return v.runOutsideAngular(()=>{const T=v.onError.subscribe({next:k=>{O.handleError(k)}});M.onDestroy(()=>{Xx(this._modules,M),T.unsubscribe()})}),function xM(l,u,p){try{const m=p();return Z0(m)?m.catch(v=>{throw u.runOutsideAngular(()=>l.handleError(v)),v}):m}catch(m){throw u.runOutsideAngular(()=>l.handleError(m)),m}}(O,v,()=>{const T=M.injector.get(mE);return T.runInitializers(),T.donePromise.then(()=>(function J1(l){Tn(l,"Expected localeId to be defined"),"string"==typeof l&&(xO=l.toLowerCase().replace(/_/g,"-"))}(M.injector.get(dM,Ef)||Ef),this._moduleDoBootstrap(M),M))})})}bootstrapModule(p,m=[]){const v=SE({},m);return function PE(l,u,p){const m=new Tv(p);return Promise.resolve(m)}(0,0,p).then(M=>this.bootstrapModuleFactory(M,v))}_moduleDoBootstrap(p){const m=p.injector.get(id);if(p._bootstrapComponents.length>0)p._bootstrapComponents.forEach(v=>m.bootstrap(v));else{if(!p.instance.ngDoBootstrap)throw new Gt(-403,!1);p.instance.ngDoBootstrap(m)}this._modules.push(p)}onDestroy(p){this._destroyListeners.push(p)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Gt(404,!1);this._modules.slice().forEach(m=>m.destroy()),this._destroyListeners.forEach(m=>m());const p=this._injector.get(eg,null);p&&(p.forEach(m=>m()),p.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#t=this.\u0275fac=function(m){return new(m||l)(or(ac))};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"platform"})}return l})();function SE(l,u){return Array.isArray(u)?u.reduce(SE,l):{...l,...u}}let id=(()=>{class l{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ir(y2),this.zoneIsStable=ir(Vw),this.componentTypes=[],this.components=[],this.isStable=ir(Ey).hasPendingTasks.pipe((0,ue.w)(p=>p?(0,ye.of)(!1):this.zoneIsStable),function Yt(l,u=be.y){return l=l??Le,(0,Pt.e)((p,m)=>{let v,M=!0;p.subscribe((0,Ot.x)(m,O=>{const T=u(O);(M||!l(v,T))&&(M=!1,v=T,m.next(O))}))})}(),(0,ke.B)()),this._injector=ir(So)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(p,m){const v=p instanceof c1;if(!this._injector.get(mE).done)throw!v&&hi(p),new Gt(405,!1);let O;O=v?p:this._injector.get(_0).resolveComponentFactory(p),this.componentTypes.push(O.componentType);const T=function ky(l){return l.isBoundToModule}(O)?void 0:this._injector.get(Yp),N=O.create(ac.NULL,[],m||O.selector,T),F=N.location.nativeElement,$=N.injector.get(CE,null);return $?.registerApplication(F),N.onDestroy(()=>{this.detachView(N.hostView),Xx(this.components,N),$?.unregisterApplication(F)}),this._loadComponent(N),N}tick(){if(this._runningTick)throw new Gt(101,!1);try{this._runningTick=!0;for(let p of this._views)p.detectChanges()}catch(p){this.internalErrorHandler(p)}finally{this._runningTick=!1}}attachView(p){const m=p;this._views.push(m),m.attachToAppRef(this)}detachView(p){const m=p;Xx(this._views,m),m.detachFromAppRef()}_loadComponent(p){this.attachView(p.hostView),this.tick(),this.components.push(p);const m=this._injector.get(vM,[]);m.push(...this._bootstrapListeners),m.forEach(v=>v(p))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(p=>p()),this._views.slice().forEach(p=>p.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(p){return this._destroyListeners.push(p),()=>Xx(this._destroyListeners,p)}destroy(){if(this._destroyed)throw new Gt(406,!1);const p=this._injector;p.destroy&&!p.destroyed&&p.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();function Xx(l,u){const p=l.indexOf(u);p>-1&&l.splice(p,1)}const y2=new er("",{providedIn:"root",factory:()=>ir(ju).handleError.bind(void 0)});function v2(){const l=ir(Wi),u=ir(ju);return p=>l.runOutsideAngular(()=>u.handleError(p))}let Qx=(()=>{class l{constructor(){this.zone=ir(Wi),this.applicationRef=ir(id)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#t=this.\u0275fac=function(m){return new(m||l)};static#e=this.\u0275prov=nt({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();function Qv(){return!1}let Nf=(()=>{class l{static#t=this.__NG_ELEMENT_ID__=CM}return l})();function CM(l){return function KI(l,u,p){if(_l(l)&&!p){const m=ua(l.index,u);return new R0(m,m)}return 47&l.type?new R0(u[Wo],u):null}(fs(),Me(),16==(16&l))}class DE{constructor(){}supports(u){return li(u)}create(u){return new ew(u)}}const TM=(l,u)=>u;class ew{constructor(u){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=u||TM}forEachItem(u){let p;for(p=this._itHead;null!==p;p=p._next)u(p)}forEachOperation(u){let p=this._itHead,m=this._removalsHead,v=0,M=null;for(;p||m;){const O=!m||p&&p.currentIndex<nb(m,v,M)?p:m,T=nb(O,v,M),k=O.currentIndex;if(O===m)v--,m=m._nextRemoved;else if(p=p._next,null==O.previousIndex)v++;else{M||(M=[]);const N=T-v,F=k-v;if(N!=F){for(let q=0;q<N;q++){const Z=q<M.length?M[q]:M[q]=0,X=Z+q;F<=X&&X<N&&(M[q]=Z+1)}M[O.previousIndex]=F-N}}T!==k&&u(O,T,k)}}forEachPreviousItem(u){let p;for(p=this._previousItHead;null!==p;p=p._nextPrevious)u(p)}forEachAddedItem(u){let p;for(p=this._additionsHead;null!==p;p=p._nextAdded)u(p)}forEachMovedItem(u){let p;for(p=this._movesHead;null!==p;p=p._nextMoved)u(p)}forEachRemovedItem(u){let p;for(p=this._removalsHead;null!==p;p=p._nextRemoved)u(p)}forEachIdentityChange(u){let p;for(p=this._identityChangesHead;null!==p;p=p._nextIdentityChange)u(p)}diff(u){if(null==u&&(u=[]),!li(u))throw new Gt(900,!1);return this.check(u)?this:null}onDestroy(){}check(u){this._reset();let v,M,O,p=this._itHead,m=!1;if(Array.isArray(u)){this.length=u.length;for(let T=0;T<this.length;T++)M=u[T],O=this._trackByFn(T,M),null!==p&&Object.is(p.trackById,O)?(m&&(p=this._verifyReinsertion(p,M,O,T)),Object.is(p.item,M)||this._addIdentityChange(p,M)):(p=this._mismatch(p,M,O,T),m=!0),p=p._next}else v=0,function JP(l,u){if(Array.isArray(l))for(let p=0;p<l.length;p++)u(l[p]);else{const p=l[Symbol.iterator]();let m;for(;!(m=p.next()).done;)u(m.value)}}(u,T=>{O=this._trackByFn(v,T),null!==p&&Object.is(p.trackById,O)?(m&&(p=this._verifyReinsertion(p,T,O,v)),Object.is(p.item,T)||this._addIdentityChange(p,T)):(p=this._mismatch(p,T,O,v),m=!0),p=p._next,v++}),this.length=v;return this._truncate(p),this.collection=u,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let u;for(u=this._previousItHead=this._itHead;null!==u;u=u._next)u._nextPrevious=u._next;for(u=this._additionsHead;null!==u;u=u._nextAdded)u.previousIndex=u.currentIndex;for(this._additionsHead=this._additionsTail=null,u=this._movesHead;null!==u;u=u._nextMoved)u.previousIndex=u.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(u,p,m,v){let M;return null===u?M=this._itTail:(M=u._prev,this._remove(u)),null!==(u=null===this._unlinkedRecords?null:this._unlinkedRecords.get(m,null))?(Object.is(u.item,p)||this._addIdentityChange(u,p),this._reinsertAfter(u,M,v)):null!==(u=null===this._linkedRecords?null:this._linkedRecords.get(m,v))?(Object.is(u.item,p)||this._addIdentityChange(u,p),this._moveAfter(u,M,v)):u=this._addAfter(new w2(p,m),M,v),u}_verifyReinsertion(u,p,m,v){let M=null===this._unlinkedRecords?null:this._unlinkedRecords.get(m,null);return null!==M?u=this._reinsertAfter(M,u._prev,v):u.currentIndex!=v&&(u.currentIndex=v,this._addToMoves(u,v)),u}_truncate(u){for(;null!==u;){const p=u._next;this._addToRemovals(this._unlink(u)),u=p}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(u,p,m){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(u);const v=u._prevRemoved,M=u._nextRemoved;return null===v?this._removalsHead=M:v._nextRemoved=M,null===M?this._removalsTail=v:M._prevRemoved=v,this._insertAfter(u,p,m),this._addToMoves(u,m),u}_moveAfter(u,p,m){return this._unlink(u),this._insertAfter(u,p,m),this._addToMoves(u,m),u}_addAfter(u,p,m){return this._insertAfter(u,p,m),this._additionsTail=null===this._additionsTail?this._additionsHead=u:this._additionsTail._nextAdded=u,u}_insertAfter(u,p,m){const v=null===p?this._itHead:p._next;return u._next=v,u._prev=p,null===v?this._itTail=u:v._prev=u,null===p?this._itHead=u:p._next=u,null===this._linkedRecords&&(this._linkedRecords=new IM),this._linkedRecords.put(u),u.currentIndex=m,u}_remove(u){return this._addToRemovals(this._unlink(u))}_unlink(u){null!==this._linkedRecords&&this._linkedRecords.remove(u);const p=u._prev,m=u._next;return null===p?this._itHead=m:p._next=m,null===m?this._itTail=p:m._prev=p,u}_addToMoves(u,p){return u.previousIndex===p||(this._movesTail=null===this._movesTail?this._movesHead=u:this._movesTail._nextMoved=u),u}_addToRemovals(u){return null===this._unlinkedRecords&&(this._unlinkedRecords=new IM),this._unlinkedRecords.put(u),u.currentIndex=null,u._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=u,u._prevRemoved=null):(u._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=u),u}_addIdentityChange(u,p){return u.item=p,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=u:this._identityChangesTail._nextIdentityChange=u,u}}class w2{constructor(u,p){this.item=u,this.trackById=p,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class C2{constructor(){this._head=null,this._tail=null}add(u){null===this._head?(this._head=this._tail=u,u._nextDup=null,u._prevDup=null):(this._tail._nextDup=u,u._prevDup=this._tail,u._nextDup=null,this._tail=u)}get(u,p){let m;for(m=this._head;null!==m;m=m._nextDup)if((null===p||p<=m.currentIndex)&&Object.is(m.trackById,u))return m;return null}remove(u){const p=u._prevDup,m=u._nextDup;return null===p?this._head=m:p._nextDup=m,null===m?this._tail=p:m._prevDup=p,null===this._head}}class IM{constructor(){this.map=new Map}put(u){const p=u.trackById;let m=this.map.get(p);m||(m=new C2,this.map.set(p,m)),m.add(u)}get(u,p){const v=this.map.get(u);return v?v.get(u,p):null}remove(u){const p=u.trackById;return this.map.get(p).remove(u)&&this.map.delete(p),u}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function nb(l,u,p){const m=l.previousIndex;if(null===m)return m;let v=0;return p&&m<p.length&&(v=p[m]),m+u+v}class nw{constructor(){}supports(u){return u instanceof Map||T1(u)}create(){return new JI}}class JI{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(u){let p;for(p=this._mapHead;null!==p;p=p._next)u(p)}forEachPreviousItem(u){let p;for(p=this._previousMapHead;null!==p;p=p._nextPrevious)u(p)}forEachChangedItem(u){let p;for(p=this._changesHead;null!==p;p=p._nextChanged)u(p)}forEachAddedItem(u){let p;for(p=this._additionsHead;null!==p;p=p._nextAdded)u(p)}forEachRemovedItem(u){let p;for(p=this._removalsHead;null!==p;p=p._nextRemoved)u(p)}diff(u){if(u){if(!(u instanceof Map||T1(u)))throw new Gt(900,!1)}else u=new Map;return this.check(u)?this:null}onDestroy(){}check(u){this._reset();let p=this._mapHead;if(this._appendAfter=null,this._forEach(u,(m,v)=>{if(p&&p.key===v)this._maybeAddToChanges(p,m),this._appendAfter=p,p=p._next;else{const M=this._getOrCreateRecordForKey(v,m);p=this._insertBeforeOrAppend(p,M)}}),p){p._prev&&(p._prev._next=null),this._removalsHead=p;for(let m=p;null!==m;m=m._nextRemoved)m===this._mapHead&&(this._mapHead=null),this._records.delete(m.key),m._nextRemoved=m._next,m.previousValue=m.currentValue,m.currentValue=null,m._prev=null,m._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(u,p){if(u){const m=u._prev;return p._next=u,p._prev=m,u._prev=p,m&&(m._next=p),u===this._mapHead&&(this._mapHead=p),this._appendAfter=u,u}return this._appendAfter?(this._appendAfter._next=p,p._prev=this._appendAfter):this._mapHead=p,this._appendAfter=p,null}_getOrCreateRecordForKey(u,p){if(this._records.has(u)){const v=this._records.get(u);this._maybeAddToChanges(v,p);const M=v._prev,O=v._next;return M&&(M._next=O),O&&(O._prev=M),v._next=null,v._prev=null,v}const m=new tS(u);return this._records.set(u,m),m.currentValue=p,this._addToAdditions(m),m}_reset(){if(this.isDirty){let u;for(this._previousMapHead=this._mapHead,u=this._previousMapHead;null!==u;u=u._next)u._nextPrevious=u._next;for(u=this._changesHead;null!==u;u=u._nextChanged)u.previousValue=u.currentValue;for(u=this._additionsHead;null!=u;u=u._nextAdded)u.previousValue=u.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(u,p){Object.is(p,u.currentValue)||(u.previousValue=u.currentValue,u.currentValue=p,this._addToChanges(u))}_addToAdditions(u){null===this._additionsHead?this._additionsHead=this._additionsTail=u:(this._additionsTail._nextAdded=u,this._additionsTail=u)}_addToChanges(u){null===this._changesHead?this._changesHead=this._changesTail=u:(this._changesTail._nextChanged=u,this._changesTail=u)}_forEach(u,p){u instanceof Map?u.forEach(p):Object.keys(u).forEach(m=>p(u[m],m))}}class tS{constructor(u){this.key=u,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function M2(){return new kE([new DE])}let kE=(()=>{class l{static#t=this.\u0275prov=nt({token:l,providedIn:"root",factory:M2});constructor(p){this.factories=p}static create(p,m){if(null!=m){const v=m.factories.slice();p=p.concat(v)}return new l(p)}static extend(p){return{provide:l,useFactory:m=>l.create(p,m||M2()),deps:[[l,new jh,new ns]]}}find(p){const m=this.factories.find(v=>v.supports(p));if(null!=m)return m;throw new Gt(901,!1)}}return l})();function P2(){return new RE([new nw])}let RE=(()=>{class l{static#t=this.\u0275prov=nt({token:l,providedIn:"root",factory:P2});constructor(p){this.factories=p}static create(p,m){if(m){const v=m.factories.slice();p=p.concat(v)}return new l(p)}static extend(p){return{provide:l,useFactory:m=>l.create(p,m||P2()),deps:[[l,new jh,new ns]]}}find(p){const m=this.factories.find(v=>v.supports(p));if(m)return m;throw new Gt(901,!1)}}return l})();const E2=Yv(null,"core",[]);let AM=(()=>{class l{constructor(p){}static#t=this.\u0275fac=function(m){return new(m||l)(or(id))};static#e=this.\u0275mod=Ro({type:l});static#n=this.\u0275inj=Qt({})}return l})();function t(l){return"boolean"==typeof l?l:null!=l&&"false"!==l}function I(l){const u=Wn(l);if(!u)return null;const p=new qd(u);return{get selector(){return p.selector},get type(){return p.componentType},get inputs(){return p.inputs},get outputs(){return p.outputs},get ngContentSelectors(){return p.ngContentSelectors},get isStandalone(){return u.standalone},get isSignal(){return u.signals}}}},3399:(Hn,we,ft)=>{"use strict";ft.d(we,{Z:()=>tn});var x=ft(229),mt=ft(6820),It=ft(1571),vt=ft(7879);class lt{constructor(rn,Te){this._delegate=rn,this.firebase=Te,(0,It._addComponent)(rn,new mt.wA("app-compat",()=>this,"PUBLIC")),this.container=rn.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(rn){this._delegate.automaticDataCollectionEnabled=rn}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(rn=>{this._delegate.checkDestroyed(),rn()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,It.deleteApp)(this._delegate)))}_getService(rn,Te=It._DEFAULT_ENTRY_NAME){var Fn;this._delegate.checkDestroyed();const Ce=this._delegate.container.getProvider(rn);return!Ce.isInitialized()&&"EXPLICIT"===(null===(Fn=Ce.getComponent())||void 0===Fn?void 0:Fn.instantiationMode)&&Ce.initialize(),Ce.getImmediate({identifier:Te})}_removeServiceInstance(rn,Te=It._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(rn).clearInstance(Te)}_addComponent(rn){(0,It._addComponent)(this._delegate,rn)}_addOrOverwriteComponent(rn){(0,It._addOrOverwriteComponent)(this._delegate,rn)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const ke=new x.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),Pt=function be(){const We=function ue(We){const rn={},Te={__esModule:!0,initializeApp:function me(Gt,Ct={}){const ge=It.initializeApp(Gt,Ct);if((0,x.r3)(rn,ge.name))return rn[ge.name];const en=new We(ge,Te);return rn[ge.name]=en,en},app:Ce,registerVersion:It.registerVersion,setLogLevel:It.setLogLevel,onLog:It.onLog,apps:null,SDK_VERSION:It.SDK_VERSION,INTERNAL:{registerComponent:function Xt(Gt){const Ct=Gt.name,ge=Ct.replace("-compat","");if(It._registerComponent(Gt)&&"PUBLIC"===Gt.type){const en=(Vo=Ce())=>{if("function"!=typeof Vo[ge])throw ke.create("invalid-app-argument",{appName:Ct});return Vo[ge]()};void 0!==Gt.serviceProps&&(0,x.ZB)(en,Gt.serviceProps),Te[ge]=en,We.prototype[ge]=function(...Vo){return this._getService.bind(this,Ct).apply(this,Gt.multipleInstances?Vo:[])}}return"PUBLIC"===Gt.type?Te[ge]:null},removeApp:function Fn(Gt){delete rn[Gt]},useAsService:function Ve(Gt,Ct){return"serverAuth"===Ct?null:Ct},modularAPIs:It}};function Ce(Gt){if(!(0,x.r3)(rn,Gt=Gt||It._DEFAULT_ENTRY_NAME))throw ke.create("no-app",{appName:Gt});return rn[Gt]}return Te.default=Te,Object.defineProperty(Te,"apps",{get:function tt(){return Object.keys(rn).map(Gt=>rn[Gt])}}),Ce.App=We,Te}(lt);return We.INTERNAL=Object.assign(Object.assign({},We.INTERNAL),{createFirebaseNamespace:be,extendNamespace:function rn(Te){(0,x.ZB)(We,Te)},createSubscribe:x.ne,ErrorFactory:x.LL,deepExtend:x.ZB}),We}(),Ot=new vt.Yd("@firebase/app-compat");if((0,x.jU)()&&void 0!==self.firebase){Ot.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const We=self.firebase.SDK_VERSION;We&&We.indexOf("LITE")>=0&&Ot.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const tn=Pt;!function re(We){(0,It.registerVersion)("@firebase/app-compat","0.2.13",We)}()},1571:(Hn,we,ft)=>{"use strict";ft.r(we),ft.d(we,{FirebaseError:()=>vt.ZR,SDK_VERSION:()=>er,_DEFAULT_ENTRY_NAME:()=>Ze,_addComponent:()=>yn,_addOrOverwriteComponent:()=>Fr,_apps:()=>gn,_clearComponents:()=>Ur,_components:()=>ur,_getProvider:()=>Sn,_registerComponent:()=>Xr,_removeServiceInstance:()=>jo,deleteApp:()=>Ft,getApp:()=>ri,getApps:()=>ds,initializeApp:()=>Rs,onLog:()=>le,registerVersion:()=>te,setLogLevel:()=>_e});var x=ft(5861),mt=ft(6820),It=ft(7879),vt=ft(229);const lt=(ne,Vt)=>Vt.some(Re=>ne instanceof Re);let ye,ke;const Pt=new WeakMap,Ot=new WeakMap,Yt=new WeakMap,Le=new WeakMap,re=new WeakMap;let rn={get(ne,Vt,Re){if(ne instanceof IDBTransaction){if("done"===Vt)return Ot.get(ne);if("objectStoreNames"===Vt)return ne.objectStoreNames||Yt.get(ne);if("store"===Vt)return Re.objectStoreNames[1]?void 0:Re.objectStore(Re.objectStoreNames[0])}return me(ne[Vt])},set:(ne,Vt,Re)=>(ne[Vt]=Re,!0),has:(ne,Vt)=>ne instanceof IDBTransaction&&("done"===Vt||"store"===Vt)||Vt in ne};function Ce(ne){return"function"==typeof ne?function Fn(ne){return ne!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function be(){return ke||(ke=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(ne)?function(...Vt){return ne.apply(tt(this),Vt),me(Pt.get(this))}:function(...Vt){return me(ne.apply(tt(this),Vt))}:function(Vt,...Re){const zn=ne.call(tt(this),Vt,...Re);return Yt.set(zn,Vt.sort?Vt.sort():[Vt]),me(zn)}}(ne):(ne instanceof IDBTransaction&&function We(ne){if(Ot.has(ne))return;const Vt=new Promise((Re,zn)=>{const vr=()=>{ne.removeEventListener("complete",sr),ne.removeEventListener("error",ao),ne.removeEventListener("abort",ao)},sr=()=>{Re(),vr()},ao=()=>{zn(ne.error||new DOMException("AbortError","AbortError")),vr()};ne.addEventListener("complete",sr),ne.addEventListener("error",ao),ne.addEventListener("abort",ao)});Ot.set(ne,Vt)}(ne),lt(ne,function ue(){return ye||(ye=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(ne,rn):ne)}function me(ne){if(ne instanceof IDBRequest)return function tn(ne){const Vt=new Promise((Re,zn)=>{const vr=()=>{ne.removeEventListener("success",sr),ne.removeEventListener("error",ao)},sr=()=>{Re(me(ne.result)),vr()},ao=()=>{zn(ne.error),vr()};ne.addEventListener("success",sr),ne.addEventListener("error",ao)});return Vt.then(Re=>{Re instanceof IDBCursor&&Pt.set(Re,ne)}).catch(()=>{}),re.set(Vt,ne),Vt}(ne);if(Le.has(ne))return Le.get(ne);const Vt=Ce(ne);return Vt!==ne&&(Le.set(ne,Vt),re.set(Vt,ne)),Vt}const tt=ne=>re.get(ne),Gt=["get","getKey","getAll","getAllKeys","count"],Ct=["put","add","delete","clear"],ge=new Map;function en(ne,Vt){if(!(ne instanceof IDBDatabase)||Vt in ne||"string"!=typeof Vt)return;if(ge.get(Vt))return ge.get(Vt);const Re=Vt.replace(/FromIndex$/,""),zn=Vt!==Re,vr=Ct.includes(Re);if(!(Re in(zn?IDBIndex:IDBObjectStore).prototype)||!vr&&!Gt.includes(Re))return;const sr=function(){var ao=(0,x.Z)(function*(qo,...Io){const zr=this.transaction(qo,vr?"readwrite":"readonly");let gl=zr.store;return zn&&(gl=gl.index(Io.shift())),(yield Promise.all([gl[Re](...Io),vr&&zr.done]))[0]});return function(Io){return ao.apply(this,arguments)}}();return ge.set(Vt,sr),sr}!function Te(ne){rn=ne(rn)}(ne=>({...ne,get:(Vt,Re,zn)=>en(Vt,Re)||ne.get(Vt,Re,zn),has:(Vt,Re)=>!!en(Vt,Re)||ne.has(Vt,Re)}));class Vo{constructor(Vt){this.container=Vt}getPlatformInfoString(){return this.container.getProviders().map(Re=>{if(function cs(ne){const Vt=ne.getComponent();return"VERSION"===Vt?.type}(Re)){const zn=Re.getImmediate();return`${zn.library}/${zn.version}`}return null}).filter(Re=>Re).join(" ")}}const Gi="@firebase/app",Yr=new It.Yd("@firebase/app"),Ze="[DEFAULT]",Ie={[Gi]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},gn=new Map,ur=new Map;function yn(ne,Vt){try{ne.container.addComponent(Vt)}catch(Re){Yr.debug(`Component ${Vt.name} failed to register with FirebaseApp ${ne.name}`,Re)}}function Fr(ne,Vt){ne.container.addOrOverwriteComponent(Vt)}function Xr(ne){const Vt=ne.name;if(ur.has(Vt))return Yr.debug(`There were multiple attempts to register component ${Vt}.`),!1;ur.set(Vt,ne);for(const Re of gn.values())yn(Re,ne);return!0}function Sn(ne,Vt){const Re=ne.container.getProvider("heartbeat").getImmediate({optional:!0});return Re&&Re.triggerHeartbeat(),ne.container.getProvider(Vt)}function jo(ne,Vt,Re=Ze){Sn(ne,Vt).clearInstance(Re)}function Ur(){ur.clear()}const dr=new vt.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class zl{constructor(Vt,Re,zn){this._isDeleted=!1,this._options=Object.assign({},Vt),this._config=Object.assign({},Re),this._name=Re.name,this._automaticDataCollectionEnabled=Re.automaticDataCollectionEnabled,this._container=zn,this.container.addComponent(new mt.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Vt){this.checkDestroyed(),this._automaticDataCollectionEnabled=Vt}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Vt){this._isDeleted=Vt}checkDestroyed(){if(this.isDeleted)throw dr.create("app-deleted",{appName:this._name})}}const er="9.23.0";function Rs(ne,Vt={}){let Re=ne;"object"!=typeof Vt&&(Vt={name:Vt});const zn=Object.assign({name:Ze,automaticDataCollectionEnabled:!1},Vt),vr=zn.name;if("string"!=typeof vr||!vr)throw dr.create("bad-app-name",{appName:String(vr)});if(Re||(Re=(0,vt.aH)()),!Re)throw dr.create("no-options");const sr=gn.get(vr);if(sr){if((0,vt.vZ)(Re,sr.options)&&(0,vt.vZ)(zn,sr.config))return sr;throw dr.create("duplicate-app",{appName:vr})}const ao=new mt.H0(vr);for(const Io of ur.values())ao.addComponent(Io);const qo=new zl(Re,zn,ao);return gn.set(vr,qo),qo}function ri(ne=Ze){const Vt=gn.get(ne);if(!Vt&&ne===Ze&&(0,vt.aH)())return Rs();if(!Vt)throw dr.create("no-app",{appName:ne});return Vt}function ds(){return Array.from(gn.values())}function Ft(ne){return Ht.apply(this,arguments)}function Ht(){return(Ht=(0,x.Z)(function*(ne){const Vt=ne.name;gn.has(Vt)&&(gn.delete(Vt),yield Promise.all(ne.container.getProviders().map(Re=>Re.delete())),ne.isDeleted=!0)})).apply(this,arguments)}function te(ne,Vt,Re){var zn;let vr=null!==(zn=Ie[ne])&&void 0!==zn?zn:ne;Re&&(vr+=`-${Re}`);const sr=vr.match(/\s|\//),ao=Vt.match(/\s|\//);if(sr||ao){const qo=[`Unable to register library "${vr}" with version "${Vt}":`];return sr&&qo.push(`library name "${vr}" contains illegal characters (whitespace or "/")`),sr&&ao&&qo.push("and"),ao&&qo.push(`version name "${Vt}" contains illegal characters (whitespace or "/")`),void Yr.warn(qo.join(" "))}Xr(new mt.wA(`${vr}-version`,()=>({library:vr,version:Vt}),"VERSION"))}function le(ne,Vt){if(null!==ne&&"function"!=typeof ne)throw dr.create("invalid-log-argument");(0,It.Am)(ne,Vt)}function _e(ne){(0,It.Ub)(ne)}const ve="firebase-heartbeat-database",xe=1,ot="firebase-heartbeat-store";let at=null;function ht(){return at||(at=function Xt(ne,Vt,{blocked:Re,upgrade:zn,blocking:vr,terminated:sr}={}){const ao=indexedDB.open(ne,Vt),qo=me(ao);return zn&&ao.addEventListener("upgradeneeded",Io=>{zn(me(ao.result),Io.oldVersion,Io.newVersion,me(ao.transaction),Io)}),Re&&ao.addEventListener("blocked",Io=>Re(Io.oldVersion,Io.newVersion,Io)),qo.then(Io=>{sr&&Io.addEventListener("close",()=>sr()),vr&&Io.addEventListener("versionchange",zr=>vr(zr.oldVersion,zr.newVersion,zr))}).catch(()=>{}),qo}(ve,xe,{upgrade:(ne,Vt)=>{0===Vt&&ne.createObjectStore(ot)}}).catch(ne=>{throw dr.create("idb-open",{originalErrorMessage:ne.message})})),at}function kt(){return(kt=(0,x.Z)(function*(ne){try{return yield(yield ht()).transaction(ot).objectStore(ot).get(Nn(ne))}catch(Vt){if(Vt instanceof vt.ZR)Yr.warn(Vt.message);else{const Re=dr.create("idb-get",{originalErrorMessage:Vt?.message});Yr.warn(Re.message)}}})).apply(this,arguments)}function ee(ne,Vt){return Ke.apply(this,arguments)}function Ke(){return(Ke=(0,x.Z)(function*(ne,Vt){try{const zn=(yield ht()).transaction(ot,"readwrite");yield zn.objectStore(ot).put(Vt,Nn(ne)),yield zn.done}catch(Re){if(Re instanceof vt.ZR)Yr.warn(Re.message);else{const zn=dr.create("idb-set",{originalErrorMessage:Re?.message});Yr.warn(zn.message)}}})).apply(this,arguments)}function Nn(ne){return`${ne.name}!${ne.options.appId}`}class Qr{constructor(Vt){this.container=Vt,this._heartbeatsCache=null;const Re=this.container.getProvider("app").getImmediate();this._storage=new $o(Re),this._heartbeatsCachePromise=this._storage.read().then(zn=>(this._heartbeatsCache=zn,zn))}triggerHeartbeat(){var Vt=this;return(0,x.Z)(function*(){const zn=Vt.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),vr=Pr();if(null===Vt._heartbeatsCache&&(Vt._heartbeatsCache=yield Vt._heartbeatsCachePromise),Vt._heartbeatsCache.lastSentHeartbeatDate!==vr&&!Vt._heartbeatsCache.heartbeats.some(sr=>sr.date===vr))return Vt._heartbeatsCache.heartbeats.push({date:vr,agent:zn}),Vt._heartbeatsCache.heartbeats=Vt._heartbeatsCache.heartbeats.filter(sr=>{const ao=new Date(sr.date).valueOf();return Date.now()-ao<=2592e6}),Vt._storage.overwrite(Vt._heartbeatsCache)})()}getHeartbeatsHeader(){var Vt=this;return(0,x.Z)(function*(){if(null===Vt._heartbeatsCache&&(yield Vt._heartbeatsCachePromise),null===Vt._heartbeatsCache||0===Vt._heartbeatsCache.heartbeats.length)return"";const Re=Pr(),{heartbeatsToSend:zn,unsentEntries:vr}=function or(ne,Vt=1024){const Re=[];let zn=ne.slice();for(const vr of ne){const sr=Re.find(ao=>ao.agent===vr.agent);if(sr){if(sr.dates.push(vr.date),ir(Re)>Vt){sr.dates.pop();break}}else if(Re.push({agent:vr.agent,dates:[vr.date]}),ir(Re)>Vt){Re.pop();break}zn=zn.slice(1)}return{heartbeatsToSend:Re,unsentEntries:zn}}(Vt._heartbeatsCache.heartbeats),sr=(0,vt.L)(JSON.stringify({version:2,heartbeats:zn}));return Vt._heartbeatsCache.lastSentHeartbeatDate=Re,vr.length>0?(Vt._heartbeatsCache.heartbeats=vr,yield Vt._storage.overwrite(Vt._heartbeatsCache)):(Vt._heartbeatsCache.heartbeats=[],Vt._storage.overwrite(Vt._heartbeatsCache)),sr})()}}function Pr(){return(new Date).toISOString().substring(0,10)}class $o{constructor(Vt){this.app=Vt,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,x.Z)(function*(){return!!(0,vt.hl)()&&(0,vt.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Vt=this;return(0,x.Z)(function*(){return(yield Vt._canUseIndexedDBPromise)&&(yield function Bt(ne){return kt.apply(this,arguments)}(Vt.app))||{heartbeats:[]}})()}overwrite(Vt){var Re=this;return(0,x.Z)(function*(){var zn;if(yield Re._canUseIndexedDBPromise){const sr=yield Re.read();return ee(Re.app,{lastSentHeartbeatDate:null!==(zn=Vt.lastSentHeartbeatDate)&&void 0!==zn?zn:sr.lastSentHeartbeatDate,heartbeats:Vt.heartbeats})}})()}add(Vt){var Re=this;return(0,x.Z)(function*(){var zn;if(yield Re._canUseIndexedDBPromise){const sr=yield Re.read();return ee(Re.app,{lastSentHeartbeatDate:null!==(zn=Vt.lastSentHeartbeatDate)&&void 0!==zn?zn:sr.lastSentHeartbeatDate,heartbeats:[...sr.heartbeats,...Vt.heartbeats]})}})()}}function ir(ne){return(0,vt.L)(JSON.stringify({version:2,heartbeats:ne})).length}!function qs(ne){Xr(new mt.wA("platform-logger",Vt=>new Vo(Vt),"PRIVATE")),Xr(new mt.wA("heartbeat",Vt=>new Qr(Vt),"PRIVATE")),te(Gi,"0.9.13",ne),te(Gi,"0.9.13","esm2017"),te("fire-js","")}("")},6820:(Hn,we,ft)=>{"use strict";ft.d(we,{H0:()=>ue,wA:()=>It});var x=ft(5861),mt=ft(229);class It{constructor(Pt,Ot,Yt){this.name=Pt,this.instanceFactory=Ot,this.type=Yt,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(Pt){return this.instantiationMode=Pt,this}setMultipleInstances(Pt){return this.multipleInstances=Pt,this}setServiceProps(Pt){return this.serviceProps=Pt,this}setInstanceCreatedCallback(Pt){return this.onInstanceCreated=Pt,this}}const vt="[DEFAULT]";class lt{constructor(Pt,Ot){this.name=Pt,this.container=Ot,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(Pt){const Ot=this.normalizeInstanceIdentifier(Pt);if(!this.instancesDeferred.has(Ot)){const Yt=new mt.BH;if(this.instancesDeferred.set(Ot,Yt),this.isInitialized(Ot)||this.shouldAutoInitialize())try{const Le=this.getOrInitializeService({instanceIdentifier:Ot});Le&&Yt.resolve(Le)}catch{}}return this.instancesDeferred.get(Ot).promise}getImmediate(Pt){var Ot;const Yt=this.normalizeInstanceIdentifier(Pt?.identifier),Le=null!==(Ot=Pt?.optional)&&void 0!==Ot&&Ot;if(!this.isInitialized(Yt)&&!this.shouldAutoInitialize()){if(Le)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Yt})}catch(re){if(Le)return null;throw re}}getComponent(){return this.component}setComponent(Pt){if(Pt.name!==this.name)throw Error(`Mismatching Component ${Pt.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=Pt,this.shouldAutoInitialize()){if(function ke(be){return"EAGER"===be.instantiationMode}(Pt))try{this.getOrInitializeService({instanceIdentifier:vt})}catch{}for(const[Ot,Yt]of this.instancesDeferred.entries()){const Le=this.normalizeInstanceIdentifier(Ot);try{const re=this.getOrInitializeService({instanceIdentifier:Le});Yt.resolve(re)}catch{}}}}clearInstance(Pt=vt){this.instancesDeferred.delete(Pt),this.instancesOptions.delete(Pt),this.instances.delete(Pt)}delete(){var Pt=this;return(0,x.Z)(function*(){const Ot=Array.from(Pt.instances.values());yield Promise.all([...Ot.filter(Yt=>"INTERNAL"in Yt).map(Yt=>Yt.INTERNAL.delete()),...Ot.filter(Yt=>"_delete"in Yt).map(Yt=>Yt._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(Pt=vt){return this.instances.has(Pt)}getOptions(Pt=vt){return this.instancesOptions.get(Pt)||{}}initialize(Pt={}){const{options:Ot={}}=Pt,Yt=this.normalizeInstanceIdentifier(Pt.instanceIdentifier);if(this.isInitialized(Yt))throw Error(`${this.name}(${Yt}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Le=this.getOrInitializeService({instanceIdentifier:Yt,options:Ot});for(const[re,tn]of this.instancesDeferred.entries())Yt===this.normalizeInstanceIdentifier(re)&&tn.resolve(Le);return Le}onInit(Pt,Ot){var Yt;const Le=this.normalizeInstanceIdentifier(Ot),re=null!==(Yt=this.onInitCallbacks.get(Le))&&void 0!==Yt?Yt:new Set;re.add(Pt),this.onInitCallbacks.set(Le,re);const tn=this.instances.get(Le);return tn&&Pt(tn,Le),()=>{re.delete(Pt)}}invokeOnInitCallbacks(Pt,Ot){const Yt=this.onInitCallbacks.get(Ot);if(Yt)for(const Le of Yt)try{Le(Pt,Ot)}catch{}}getOrInitializeService({instanceIdentifier:Pt,options:Ot={}}){let Yt=this.instances.get(Pt);if(!Yt&&this.component&&(Yt=this.component.instanceFactory(this.container,{instanceIdentifier:(be=Pt,be===vt?void 0:be),options:Ot}),this.instances.set(Pt,Yt),this.instancesOptions.set(Pt,Ot),this.invokeOnInitCallbacks(Yt,Pt),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,Pt,Yt)}catch{}var be;return Yt||null}normalizeInstanceIdentifier(Pt=vt){return this.component?this.component.multipleInstances?Pt:vt:Pt}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class ue{constructor(Pt){this.name=Pt,this.providers=new Map}addComponent(Pt){const Ot=this.getProvider(Pt.name);if(Ot.isComponentSet())throw new Error(`Component ${Pt.name} has already been registered with ${this.name}`);Ot.setComponent(Pt)}addOrOverwriteComponent(Pt){this.getProvider(Pt.name).isComponentSet()&&this.providers.delete(Pt.name),this.addComponent(Pt)}getProvider(Pt){if(this.providers.has(Pt))return this.providers.get(Pt);const Ot=new lt(Pt,this);return this.providers.set(Pt,Ot),Ot}getProviders(){return Array.from(this.providers.values())}}},4097:(Hn,we,ft)=>{"use strict";ft.d(we,{C6:()=>x.getApps,KN:()=>x.registerVersion,Mq:()=>x.getApp,ZF:()=>x.initializeApp});var x=ft(1571);(0,x.registerVersion)("firebase","9.23.0","app")},120:(Hn,we,ft)=>{"use strict";ft.d(we,{Z:()=>x.Z});var x=ft(3399);x.Z.registerVersion("firebase","9.23.0","app-compat")},7879:(Hn,we,ft)=>{"use strict";ft.d(we,{Am:()=>be,Ub:()=>ue,Yd:()=>ke,in:()=>mt});const x=[];var mt=function(Pt){return Pt[Pt.DEBUG=0]="DEBUG",Pt[Pt.VERBOSE=1]="VERBOSE",Pt[Pt.INFO=2]="INFO",Pt[Pt.WARN=3]="WARN",Pt[Pt.ERROR=4]="ERROR",Pt[Pt.SILENT=5]="SILENT",Pt}(mt||{});const It={debug:mt.DEBUG,verbose:mt.VERBOSE,info:mt.INFO,warn:mt.WARN,error:mt.ERROR,silent:mt.SILENT},vt=mt.INFO,lt={[mt.DEBUG]:"log",[mt.VERBOSE]:"log",[mt.INFO]:"info",[mt.WARN]:"warn",[mt.ERROR]:"error"},ye=(Pt,Ot,...Yt)=>{if(Ot<Pt.logLevel)return;const Le=(new Date).toISOString(),re=lt[Ot];if(!re)throw new Error(`Attempted to log a message with an invalid logType (value: ${Ot})`);console[re](`[${Le}]  ${Pt.name}:`,...Yt)};class ke{constructor(Ot){this.name=Ot,this._logLevel=vt,this._logHandler=ye,this._userLogHandler=null,x.push(this)}get logLevel(){return this._logLevel}set logLevel(Ot){if(!(Ot in mt))throw new TypeError(`Invalid value "${Ot}" assigned to \`logLevel\``);this._logLevel=Ot}setLogLevel(Ot){this._logLevel="string"==typeof Ot?It[Ot]:Ot}get logHandler(){return this._logHandler}set logHandler(Ot){if("function"!=typeof Ot)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=Ot}get userLogHandler(){return this._userLogHandler}set userLogHandler(Ot){this._userLogHandler=Ot}debug(...Ot){this._userLogHandler&&this._userLogHandler(this,mt.DEBUG,...Ot),this._logHandler(this,mt.DEBUG,...Ot)}log(...Ot){this._userLogHandler&&this._userLogHandler(this,mt.VERBOSE,...Ot),this._logHandler(this,mt.VERBOSE,...Ot)}info(...Ot){this._userLogHandler&&this._userLogHandler(this,mt.INFO,...Ot),this._logHandler(this,mt.INFO,...Ot)}warn(...Ot){this._userLogHandler&&this._userLogHandler(this,mt.WARN,...Ot),this._logHandler(this,mt.WARN,...Ot)}error(...Ot){this._userLogHandler&&this._userLogHandler(this,mt.ERROR,...Ot),this._logHandler(this,mt.ERROR,...Ot)}}function ue(Pt){x.forEach(Ot=>{Ot.setLogLevel(Pt)})}function be(Pt,Ot){for(const Yt of x){let Le=null;Ot&&Ot.level&&(Le=It[Ot.level]),Yt.userLogHandler=null===Pt?null:(re,tn,...We)=>{const rn=We.map(Te=>{if(null==Te)return null;if("string"==typeof Te)return Te;if("number"==typeof Te||"boolean"==typeof Te)return Te.toString();if(Te instanceof Error)return Te.message;try{return JSON.stringify(Te)}catch{return null}}).filter(Te=>Te).join(" ");tn>=(Le??re.logLevel)&&Pt({level:mt[tn].toLowerCase(),message:rn,args:We,type:re.name})}}}},5861:(Hn,we,ft)=>{"use strict";function x(It,vt,lt,ye,ke,ue,be){try{var Pt=It[ue](be),Ot=Pt.value}catch(Yt){return void lt(Yt)}Pt.done?vt(Ot):Promise.resolve(Ot).then(ye,ke)}function mt(It){return function(){var vt=this,lt=arguments;return new Promise(function(ye,ke){var ue=It.apply(vt,lt);function be(Ot){x(ue,ye,ke,be,Pt,"next",Ot)}function Pt(Ot){x(ue,ye,ke,be,Pt,"throw",Ot)}be(void 0)})}}ft.d(we,{Z:()=>mt})},7582:(Hn,we,ft)=>{"use strict";function vt(Wt,Kt){var pe={};for(var _t in Wt)Object.prototype.hasOwnProperty.call(Wt,_t)&&Kt.indexOf(_t)<0&&(pe[_t]=Wt[_t]);if(null!=Wt&&"function"==typeof Object.getOwnPropertySymbols){var he=0;for(_t=Object.getOwnPropertySymbols(Wt);he<_t.length;he++)Kt.indexOf(_t[he])<0&&Object.prototype.propertyIsEnumerable.call(Wt,_t[he])&&(pe[_t[he]]=Wt[_t[he]])}return pe}function Yt(Wt,Kt,pe,_t){return new(pe||(pe=Promise))(function(Ue,In){function qr(Tn){try{tr(_t.next(Tn))}catch(pn){In(pn)}}function Co(Tn){try{tr(_t.throw(Tn))}catch(pn){In(pn)}}function tr(Tn){Tn.done?Ue(Tn.value):function he(Ue){return Ue instanceof pe?Ue:new pe(function(In){In(Ue)})}(Tn.value).then(qr,Co)}tr((_t=_t.apply(Wt,Kt||[])).next())})}function me(Wt){return this instanceof me?(this.v=Wt,this):new me(Wt)}function tt(Wt,Kt,pe){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var he,_t=pe.apply(Wt,Kt||[]),Ue=[];return he={},In("next"),In("throw"),In("return"),he[Symbol.asyncIterator]=function(){return this},he;function In(fo){_t[fo]&&(he[fo]=function(ce){return new Promise(function(et,nt){Ue.push([fo,ce,et,nt])>1||qr(fo,ce)})})}function qr(fo,ce){try{!function Co(fo){fo.value instanceof me?Promise.resolve(fo.value.v).then(tr,Tn):pn(Ue[0][2],fo)}(_t[fo](ce))}catch(et){pn(Ue[0][3],et)}}function tr(fo){qr("next",fo)}function Tn(fo){qr("throw",fo)}function pn(fo,ce){fo(ce),Ue.shift(),Ue.length&&qr(Ue[0][0],Ue[0][1])}}function Ve(Wt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var pe,Kt=Wt[Symbol.asyncIterator];return Kt?Kt.call(Wt):(Wt=function We(Wt){var Kt="function"==typeof Symbol&&Symbol.iterator,pe=Kt&&Wt[Kt],_t=0;if(pe)return pe.call(Wt);if(Wt&&"number"==typeof Wt.length)return{next:function(){return Wt&&_t>=Wt.length&&(Wt=void 0),{value:Wt&&Wt[_t++],done:!Wt}}};throw new TypeError(Kt?"Object is not iterable.":"Symbol.iterator is not defined.")}(Wt),pe={},_t("next"),_t("throw"),_t("return"),pe[Symbol.asyncIterator]=function(){return this},pe);function _t(Ue){pe[Ue]=Wt[Ue]&&function(In){return new Promise(function(qr,Co){!function he(Ue,In,qr,Co){Promise.resolve(Co).then(function(tr){Ue({value:tr,done:qr})},In)}(qr,Co,(In=Wt[Ue](In)).done,In.value)})}}}ft.d(we,{FC:()=>tt,KL:()=>Ve,_T:()=>vt,mG:()=>Yt,qq:()=>me}),"function"==typeof SuppressedError&&SuppressedError}},Hn=>{Hn(Hn.s=2310)}]);